.head 0 +  Application Description: ! /////////////////////////////////////////////////////////////////////////////////////////////////

.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000050100 002C000000030000 0003000000730000 000C010000FCFFFF
0040: FFD4FFFFFF200000 00150000008D0200 00D7010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773077461
0080: 625F64696E
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001C51 3A5C424152533938 5C4C494252415259 5C4162736170692E
0020: 646C6C1C513A5C42 41525339385C4C49 42524152595C4162 736170692E617063
0040: 00000101011C513A 5C4241525339385C 4C4942524152595C 4162736170692E72
0060: 756E1C513A5C4241 525339385C4C4942 524152595C416273 6170692E646C6C1C
0080: 513A5C4241525339 385C4C4942524152 595C416273617069 2E61706300000101
00A0: 0116633A5C424152 5339385C42494E5C 677261662E617064 18633A5C42415253
00C0: 39385C42494E5C41 62736170692E646C 6C18633A5C424152 5339385C42494E5C
00E0: 4162736170692E61 7063000001010100 1C513A5C42415253 39385C4C49425241
0100: 52595C4162736170 692E646C6C1C513A 5C4241525339385C 4C4942524152595C
0120: 4162736170692E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  !
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Vtcal.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  !
.head 2 -  File Include: qckdvc.apl
.head 2 -  File Include: qcktabs.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Input: 99/99/99
.head 3 -  Number: ###00000
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Date/Time: dd/MM/yy
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 858981241
0000: 1E00000011000000 0000000000000000 02000001000000AF 000000E0010D0000
0020: 00FF3F
.enddata
.head 3 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 -  String: strFileName
.head 3 -  String: strRepDate
.head 3 -  String: strBankDate
.head 3 -  !
.head 3 -  Boolean: bTblLicSep
.head 3 -  Boolean: bTblLicOdb
.head 3 -  Boolean: bTblLicIsp
.head 3 -  !
.head 3 -  Boolean: bFrmBalans
.head 3 -  Boolean: bFrmBalansS
.head 3 -  Boolean: bSKP
.head 3 -  Boolean: bFrmMonth
.head 3 -  Boolean: bFrmSaldo
.head 3 -  !
.head 3 -  String: strBind
.head 3 -  String: strInput
.head 3 -  String: strDir
.head 3 -  !
.head 3 -  Window Handle: hWndLicParent
.head 3 -  !
.head 3 -  Number: nRowType
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 2 +  Internal Functions
.head 3 +  Function: ShowBal            ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 5 -  Number: nMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalModalDialog( dlg_bal, hW, nMode  )
.head 3 +  Function: ShowDin            ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SalModalDialog( dlg_din, hW, 0 )  !STA
.head 5 -  Call SalCreateWindow( tab_din, hW, 0  )  !MIK
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 110281853
0000: 1102000001010000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 -  Application Actions
.head 1 -  !
.head 1 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 1 -  !
.head 1 +  Dialog Box: dlg_bal !   Просмотр балансов
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Анализ  балансов банка
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.26"
.head 4 -  Top:    0.308"
.head 4 -  Width:  14.129"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.167"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: 0.24"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  Background Text: Активы
.head 4 -  Resource Id: 18434
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    1.01"
.head 5 -  Width:  6.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 -  Background Text: Пассивы
.head 4 -  Resource Id: 18435
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.871"
.head 5 -  Top:    1.052"
.head 5 -  Width:  6.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.99"
.head 6 -  Width:  13.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 16535
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: BS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Дебет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DOSs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Дебет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Кредит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOSs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Кредит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AKT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Активы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AKTs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Активы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AKT1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Активы(гр)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PAS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Пассивы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PASs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Пассивы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PAS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Пассивы(гр)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование.................................................................................................................
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 60
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  7.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DIG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTmp
.head 5 -  Number: nMaxDig
.head 4 +  Message Actions
.head 5 +  On SAM_User
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If glub = 1 !! спрятать или показать нужные кнопки экрана
.head 7 -  Call SalDisableWindow( pbPrev )
.head 7 -  Call SalEnableWindow( pbNext )
.head 7 -  Call SalEnableWindow( rbBal )
.head 7 -  Call SalEnableWindow( rbBal8 )
.head 7 -  Call SalEnableWindow( rbBal9 )
.head 7 +  If rbBal
.head 8 -  Set ss = " < '8' "
.head 8 -  Call SalGetWindowText( rbBal, st[1], 20 )
.head 7 +  If rbBal8
.head 8 -  Set ss =  "  = '8' "
.head 8 -  Call SalGetWindowText( rbBal8, st[1], 20 )
.head 7 +  If rbBal9
.head 8 -  Set ss = " = '9' "
.head 8 -  Call SalGetWindowText( rbBal9, st[1], 20 )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pbPrev )
.head 7 -  Call SalDisableWindow( rbBal )
.head 7 -  Call SalDisableWindow( rbBal8 )
.head 7 -  Call SalDisableWindow( rbBal9 )
.head 7 +  If glub = 5
.head 8 -  Call SalDisableWindow( pbNext )
.head 7 +  Else
.head 8 -  Call SalEnableWindow( pbNext )
.head 6 -  Set dfTitle = st[glub]
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If nMode = 1 !! по ВАЛ
.head 7 -  Call SalHideWindow( tbl.AKT )
.head 7 -  Call SalHideWindow( tbl.PAS )
.head 7 -  Call SalHideWindow( tbl.AKTs )
.head 7 -  Call SalHideWindow( tbl.PASs )
.head 7 +  If glub=1
.head 8 +  If rbBal
.head 9 -  Set ss="<'8'"
.head 8 +  If rbBal8
.head 9 -  Set ss="='8'"
.head 8 +  If rbBal9
.head 9 -  Set ss="='9'"
.head 8 -  Set ss= "SELECT nbs,name FROM Ps
 INTO :tbl.BS,:tbl.NN 
 WHERE  nbs[2,4] ='   '  and  nbs[1,1] "||ss
.head 7 +  If glub=2
.head 8 -  Set ss= "SELECT nbs,name FROM Ps
 INTO :tbl.BS,:tbl.NN 
 WHERE nbs[2,2] <>' ' and  nbs[3,4] ='  ' and  nbs[1,1] =:bb1 " 
.head 7 +  If glub=3
.head 8 -  Set ss= "SELECT nbs,name FROM Ps
 INTO :tbl.BS,:tbl.NN 
 WHERE  nbs[3,3] <>' ' and nbs[4,4] =' ' and  nbs[1,2] =:bb2 " 
.head 7 +  If glub=4
.head 8 -  Set ss= "SELECT nbs,name FROM Ps
 INTO :tbl.BS,:tbl.NN 
 WHERE nbs[4,4] <>' ' and  nbs[1,3] =:bb3 " 
.head 7 +  If glub=5
.head 8 -  Set ss= "SELECT c.nls,max(c.nms) FROM accounts c
INTO :tbl.BS,:tbl.NN 
WHERE c.nbs=:bb4 GROUP BY c.nls " 
.head 7 -  Set ss=ss || " ORDER BY 1" 
.head 6 +  Else !! по БАЛ
.head 7 -  Call SalShowWindow( tbl.AKT)
.head 7 -  Call SalShowWindow( tbl.PAS)
.head 7 +  If glub=5
.head 8 -  Set ss="
SELECT s.nls,s.kv,(t.LCV||':'||s.nms), s.dos/100, s.kos/100, 
 - decode(sign(s.ost),-1,s.ost,0)/100,
   decode(sign(s.ost), 1,s.ost,0)/100, 
 - decode(sign(s.ost),-1, gl.p_icurval(s.kv,s.ost,s.fdat),0)/100000, 
   decode(sign(s.ost), 1, gl.p_icurval(s.kv,s.ost,s.fdat),0)/100000, t.dig  
INTO :tbl.BS,:tbl.KV,:tbl.NN,:tbl.DOS,:tbl.KOS,:tbl.AKT,:tbl.PAS,:tbl.AKT1,:tbl.PAS1,:tbl.DIG 
FROM  sal s,tabval t 
WHERE ost<>0 and s.nbs=:bb4 AND s.kv=t.kv AND s.fdat= :sDat 
ORDER BY 1,2" 
.head 8 -  !
.head 8 -  Call SalHideWindow( tbl.DOS )
.head 8 -  Call SalHideWindow( tbl.KOS )
.head 8 -  Call SalHideWindow( tbl.AKT )
.head 8 -  Call SalHideWindow( tbl.PAS )
.head 8 -  Call SalShowWindow( tbl.DOSs )
.head 8 -  Call SalShowWindow( tbl.KOSs )
.head 8 -  Call SalShowWindow( tbl.AKTs )
.head 8 -  Call SalShowWindow( tbl.PASs )
.head 7 +  Else
.head 8 -  Set ss="
SELECT p.nbs,p.name,sum(s.dos),sum(s.kos),sum(s.isd),sum(s.isk)  
  FROM tmp_bal s,Ps p
  INTO :tbl.BS,:tbl.NN,:tbl.DOS,:tbl.KOS,:tbl.AKT,:tbl.PAS 
 WHERE p.nbs= "  
.head 8 +  If glub=1
.head 9 -  Set ss=ss||"s.nbs[1,1]||'   ' AND s.nbs[1,1] "  
.head 9 +  If rbBal
.head 10 -  Set ss=ss||"<'8' "
.head 9 +  If rbBal8
.head 10 -  Set ss=ss||"='8' "
.head 9 +  If rbBal9
.head 10 -  Set ss=ss||"='9' "
.head 8 +  If glub=2
.head 9 -  Set ss=ss||"s.nbs[1,2]||'  ' and s.nbs[1,1] =:bb1 "
.head 8 +  If glub=3
.head 9 -  Set ss=ss||"s.nbs[1,3]||' '  and s.nbs[1,2] =:bb2 "
.head 8 +  If glub=4
.head 9 -  Set ss=ss||"s.nbs and s.nbs[1,3] =:bb3 "
.head 8 -  Set ss=ss||" GROUP BY p.nbs,p.name ORDER BY 1"
.head 8 -  !
.head 8 -  Call SalHideWindow( tbl.DOSs )
.head 8 -  Call SalHideWindow( tbl.KOSs )
.head 8 -  Call SalHideWindow( tbl.AKTs )
.head 8 -  Call SalHideWindow( tbl.PASs )
.head 8 -  Call SalShowWindow( tbl.DOS )
.head 8 -  Call SalShowWindow( tbl.KOS )
.head 8 -  Call SalShowWindow( tbl.AKT )
.head 8 -  Call SalShowWindow( tbl.PAS )
.head 6 -  ! Set nRowCount = 0
.head 6 -  Set nKA= 0
.head 6 -  Set nKP= 0
.head 6 -  Set ss=T(ss)
.head 6 -  Call SalTblPopulate( tbl, hSql(), ss, TBL_FillAll )
.head 6 +  If nKA > 1 or nKP > 1
.head 7 -  Call SalEnableWindow( obActive )
.head 7 -  ! Call SalEnableWindow( obPassive )
.head 7 +  If obActive !!  or obPassive
.head 8 -  ! Call Redraw("")
.head 8 -  Call Redraw2()
.head 6 -  Call SalWaitCursor( FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbNext, SAM_Click, 0, 0 )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If nMode = 0 and glub < 5
.head 7 -  Set AKT1 = SalNumberRound ( AKT / 1000 )
.head 7 -  Set PAS1 = SalNumberRound ( PAS / 1000 )
.head 6 +  Else
.head 7 -  Set AKT1 = SalNumberRound ( AKT1 )
.head 7 -  Set PAS1 = SalNumberRound ( PAS1 )
.head 6 -  ! Set nRowCount = nRowCount + 1
.head 6 +  If AKT1 >0
.head 7 -  Set nKA =nKA +1
.head 6 +  If PAS1 >0
.head 7 -  Set nKP =nKP +1
.head 6 -  ! Относится к проверке значности
.head 6 +  If nMode=0
.head 7 +  If glub=5
.head 8 -  ! проверка на 3 знака
.head 8 -  ! Call SqlPrepareAndExecute( hSqlAux(), "
SELECT dig INTO :nDig
FROM tabval
WHERE kv=:KV" )
.head 8 +  ! If not SqlFetchNext( hSqlAux(), nFetchRes )
.head 9 -  Return FALSE
.head 8 -  ! Set DOSs = SalNumberToStrX( DOS*SalNumberPower( 10, 2-nDig ), nDig )
.head 8 -  ! Set KOSs = SalNumberToStrX( KOS*SalNumberPower( 10, 2-nDig ), nDig )
.head 8 -  ! Set AKTs = SalNumberToStrX( AKT*SalNumberPower( 10, 2-nDig ), nDig )
.head 8 -  ! Set PASs = SalNumberToStrX( PAS*SalNumberPower( 10, 2-nDig ), nDig )
.head 8 -  Set DOSs = Dig4( DOS, DIG, nMaxDig )
.head 8 -  Set KOSs = Dig4( KOS, DIG, nMaxDig )
.head 8 -  Set AKTs = Dig4( AKT, DIG, nMaxDig )
.head 8 -  Set PASs = Dig4( PAS, DIG, nMaxDig )
.head 8 -  !
.head 6 +  Else If nMode=1
.head 7 -  ! Call SqlPrepareAndExecute( hSqlAux(), "
SELECT dig INTO :nDig
FROM tabval
WHERE lcv=:BS" )
.head 7 +  ! If not SqlFetchNext( hSqlAux(), nFetchRes )
.head 8 -  Return FALSE
.head 7 -  ! Set AKTs = SalNumberToStrX( AKT*SalNumberPower( 10, 2-nDig ), nDig )
.head 7 -  ! Set PASs = SalNumberToStrX( PAS*SalNumberPower( 10, 2-nDig ), nDig )
.head 7 -  Set AKTs = Dig4( AKT, DIG, nMaxDig )
.head 7 -  Set PASs = Dig4( PAS, DIG, nMaxDig )
.head 7 -  !
.head 5 +  On SAM_Create
.head 6 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 7 -  Call SalTblSetColumnFlags( BS, COL_RightJustify, TRUE )
.head 6 +  If DigInit()!=-1
.head 7 -  Set nMaxDig=DigInit()
.head 6 +  Else
.head 7 -  ! ?
.head 3 -  !
.head 3 +  Radio Button: rbBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Балансовый учет
.head 4 -  Window Location and Size
.head 5 -  Left:   0.986"
.head 5 -  Top:    0.073"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +  Radio Button: rbBal8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Управленческий учет
.head 4 -  Window Location and Size
.head 5 -  Left:   0.986"
.head 5 -  Top:    0.323"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +  Radio Button: rbBal9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Внебалансовый учет
.head 4 -  Window Location and Size
.head 5 -  Left:   0.986"
.head 5 -  Top:    0.573"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 -  Background Text: Дата:
.head 4 -  Resource Id: 40753
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.086"
.head 5 -  Top:    0.094"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: lbVedo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.686"
.head 5 -  Top:    0.323"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.094"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set sDat='**'
.head 6 -  Call SqlPrepareAndExecute( hSql(), 
T("SELECT fdat  FROM fdat INTO :dtFdat ORDER BY fdat DESC" ) )
.head 6 +  While SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalListAdd( lbVedo, SalFmtFormatDateTime( dtFdat, ddMMyyyy() ) )
.head 6 -  Call SalListSetSelect( hWndItem, 0 )
.head 6 -  Call SalSendMsg( lbVedo, SAM_Click, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set strRepDate = SalListQueryTextX( hWndItem, SalListQuerySelection( hWndItem ) )
.head 6 -  Set sFdat=SalStrMidX( strRepDate, 3, 2 ) || '-' || SalStrLeftX( strRepDate, 2 ) || '-' || SalStrRightX( strRepDate, 4 )
.head 6 +  If sDat != sFdat
.head 7 -  Set sDat=sFdat
.head 7 +  If nMode=0
.head 8 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 9 -  Call SqlPrepareAndExecute( hSql(),"DELETE FROM tmp_bal")
.head 9 -  Call SqlPrepareAndExecute( hSql(),T( 
"INSERT INTO tmp_bal (nbs,dos,kos,isd,isk) SELECT b.nbs,
  sum( gl.p_icurval(b.kv,b.dos, :sDat ))/100,
  sum( gl.p_icurval(b.kv,b.kos, :sDat ))/100, 
 -sum( gl.p_icurval(b.kv,b.isd, :sDat ))/100, 
  sum( gl.p_icurval(b.kv,b.isk, :sDat ))/100 
FROM (SELECT s.nbs nbs, s.kv kv,
             sum(s.dos) dos, sum(s.kos) kos, 
             sum(decode(sign(s.ost),-1,s.ost,0)) isd, 
             sum(decode(sign(s.ost), 1,s.ost,0)) isk
      FROM sal s   
      WHERE s.ost<>0 and s.fdat= :sDat 
      GROUP BY s.nbs,s.kv) b
GROUP BY b.nbs "))
.head 8 -  Call SqlCommit( hSql())
.head 6 -  !
.head 6 -  Set glub=1
.head 6 -  Call SalDisableWindow( pbPrev )
.head 6 -  Call SalEnableWindow( pbNext )
.head 6 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText( hWndForm, 'Выберите дату.' )
.head 3 +  Pushbutton: pbPrev
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назад
.head 4 -  Window Location and Size
.head 5 -  Left:   6.486"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Prevrec.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set glub=glub-1
.head 6 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbNext
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вперед
.head 4 -  Window Location and Size
.head 5 -  Left:   7.586"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Nextrec.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If glub < 5
.head 7 +  If glub=1
.head 8 -  Set bb1=SalStrMidX( tbl.BS, 0, 1 )
.head 7 +  If glub=2
.head 8 -  Set bb2=SalStrMidX( tbl.BS, 0, 2 )
.head 7 +  If glub=3
.head 8 -  Set bb3=SalStrMidX( tbl.BS, 0, 3)
.head 7 +  If glub>3
.head 8 -  Set bb4=tbl.BS
.head 7 -  Set glub=glub+1
.head 7 -  Set st[glub] = tbl.BS || ":" || tbl.NN
.head 7 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +  Option Button: obTable
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Таб.по БАЛ
.head 4 -  Window Location and Size
.head 5 -  Left:   9.486"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Button Style: Radio
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalHideWindow( ccGraf )
.head 6 -  Call SalHideWindow( ccGraf1 )
.head 6 +  If glub=1 !! только вперед
.head 7 -  Call SalDisableWindow( pbPrev )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pbPrev )
.head 6 +  If glub=5  !! только назад
.head 7 -  Call SalDisableWindow( pbNext )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pbNext)
.head 6 -  Call SalShowWindow( tbl )
.head 6 +  If nMode=1
.head 7 -  Call SalHideWindow( obActive )
.head 7 -  ! Call SalHideWindow( obPassive )
.head 7 -  Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 6 +  Else
.head 7 -  Call SalShowWindow( obActive )
.head 7 -  ! Call SalShowWindow( obPassive )
.head 3 +  Option Button: obTableV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Таб.по ВАЛ
.head 4 -  Window Location and Size
.head 5 -  Left:   9.486"
.head 5 -  Top:    0.405"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Button Style: Radio
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalShowWindow( obActive )
.head 6 -  ! Call SalShowWindow( obPassive )
.head 6 -  Call SalHideWindow( ccGraf )
.head 6 -  Call SalHideWindow( ccGraf1 )
.head 6 -  Call SalDisableWindow( pbPrev )
.head 6 -  Call SalDisableWindow( pbNext )
.head 6 -  Call SalShowWindow( obTable )
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  ! Set ss="SELECT t.LCV,t.name, 
  -SUM(decode(sign(s.ost),-1,s.ost,0))/100,
   SUM(decode(sign(s.ost), 1,s.ost,0))/100,    
  -SUM( gl.p_icurval(s.kv,s.ost, :sDat ))/100000,
   SUM( gl.p_icurval(s.kv,s.ost, :sDat ))/100000, t.dig 
INTO :tbl.BS,:tbl.NN,:tbl.AKT,:tbl.PAS,:tbl.AKT1,:tbl.PAS1,:tbl.DIG 
FROM  sal s, tabval t
 WHERE s.ost<>0  and  
       s.kv=t.kv AND 
       s.fdat=  :sDat  AND "
.head 6 -  Set ss = "
  SELECT t.LCV,t.name, 
    -SUM(decode(sign(s.ost),-1,s.ost,0))/100,
     SUM(decode(sign(s.ost), 1,s.ost,0))/100,    
    -SUM( gl.p_icurval(s.kv,decode(sign(s.ost),-1,s.ost,0), :sDat ))/100000,
     SUM( gl.p_icurval(s.kv,decode(sign(s.ost), 1,s.ost,0), :sDat ))/100000, t.dig 
  INTO :tbl.BS,:tbl.NN,:tbl.AKT,:tbl.PAS,:tbl.AKT1,:tbl.PAS1,:tbl.DIG 
  FROM  sal s, tabval t
  WHERE s.ost<>0  and  
        s.kv=t.kv AND 
        s.fdat=  :sDat  AND "
.head 6 +  If glub=1
.head 7 +  If rbBal
.head 8 -  Set ss=ss||" s.nbs[1,1] < '8' "
.head 7 +  If rbBal8
.head 8 -  Set ss=ss||" s.nbs[1,1] = '8' "
.head 7 +  If rbBal9
.head 8 -  Set ss=ss||" s.nbs[1,1] = '9' "
.head 6 +  If glub=2
.head 7 -  Set ss=ss||" s.nbs[1,1] = :bb1 "
.head 6 +  If glub=3
.head 7 -  Set ss=ss||" s.nbs[1,2] = :bb2 "
.head 6 +  If glub=4
.head 7 -  Set ss=ss||" s.nbs[1,3] = :bb3 "
.head 6 +  If glub=5
.head 7 -  Set ss=ss||" s.nbs = :bb4 "
.head 6 -  ! Set ss=ss || " GROUP BY  t.LCV,t.name  ORDER BY 1"
.head 6 -  Set ss=ss || " GROUP BY  t.LCV,t.name,t.dig  ORDER BY 1"
.head 6 -  Set ss=T(ss)
.head 6 -  Call SalTblPopulate(tbl, hSql(), ss, TBL_FillAll )
.head 6 -  ! Call SalShowWindow( tbl.AKT )
.head 6 -  ! Call SalShowWindow( tbl.PAS )
.head 6 -  Call SalShowWindow( tbl.AKTs )
.head 6 -  Call SalShowWindow( tbl.PASs )
.head 6 -  ! Call SalShowWindow( tbl.AKT1)
.head 6 -  ! Call SalShowWindow( tbl.PAS1)
.head 6 -  Call SalShowWindow( tbl )
.head 6 +  If nKA + nKP = 0
.head 7 -  Call SalDisableWindow( pbNext )
.head 6 +  If nKA > 1 or  nKP > 1 
.head 7 -  Call SalEnableWindow( obTable )
.head 7 -  Call SalEnableWindow( obActive )
.head 7 -  ! Call SalEnableWindow( obPassive )
.head 7 +  If obActive !! or obPassive
.head 8 -  ! Call Redraw("")
.head 8 -  Call Redraw2()
.head 6 +  Else
.head 7 -  Set obTable = TRUE
.head 7 -  Call SalDisableWindow( obTable )
.head 7 -  Call SalDisableWindow( obActive )
.head 7 -  ! Call SalDisableWindow( obPassive )
.head 7 -  Call SalSendMsg( obTable, SAM_Click, 0, 0 )
.head 7 -  Call SalWaitCursor( FALSE)
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE)
.head 3 +  Option Button: obActive
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Графики
.head 4 -  Window Location and Size
.head 5 -  Left:   10.686"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Chart.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Button Style: Radio
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nKA >1
.head 7 -  Call SalShowWindow( ccGraf )
.head 6 +  If nKP >1
.head 7 -  Call SalShowWindow( ccGraf1 )
.head 6 -  Call Redraw2()
.head 6 -  ! Call Redraw( "AKT1" )
.head 6 -  ! Call Redraw( "PAS1" )
.head 3 +  ! Option Button: obPassive
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пассивы
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Chart.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Button Style: Radio
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +   Message Actions 
.head 5 +   On SAM_Click
.head 6 -   Call SalShowWindow( ccGraf )
.head 6 -   Call SalShowWindow( ccGraf1 )
.head 6 -   Call Redraw( "PAS1" )
.head 3 +  Pushbutton: pbQuit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   11.986"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText( hWndForm, 'Завершить просмотр.' )
.head 3 +  Data Field: dfTitle
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.738"
.head 6 -  Width:  13.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: ccGraf1
.data CLASSPROPSSIZE
0000: 7A19
.enddata
.data CLASSPROPS
0000: 4954454D00050041 4B54310000477261 706853706563004C 1990010000000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000020000 0032000000000000 0003000000010000
0180: 0000000000000000 0001000000020000 0003000000417269 616C000000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000417269 616C000000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000417269 616C000000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000417269 616C000000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000C80000 0096000000640000
02E0: 00B5FFFFFF000000 0000000000000000 0000000000000000 0006000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000010000 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000010000
0560: 0001000000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0005000000010000 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000320000 00000000001E0000 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0064000000010000 0001000000010000 0001000000010000
06A0: 0000000000000000 0000000000000000 0001000000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 000000000074626C
06E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000010000 00414B5431000000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 00414B5431000000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 004E4E0000000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0001000000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0007000000FFFFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFF100000 0010000000100000 0010000000100000
15C0: 0010000000100000 0010000000100000 0010000000100000 0010000000100000
15E0: 0010000000000000 0000000000000000 0000000000000000 0000000000000000
1600: 0000000000010000 0001000000000000 0000000000000000 0000000000000000
1620: 0000000000000000 00FFFFFFFF000000 00FFFFFFFF000000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000475241 50485050522E484C
1660: 5000000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000010000 0047726170682043 6F6E74726F6C0000 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0001000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 000F000000000000 0008000000640000
1940: 0014000000140000 0000000000000000 0000000000000000 0000000000000000
1960: 000100000000534F 5552434500040074 626C000000000000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGraph
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.986"
.head 6 -  Top:    1.24"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.583"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: ccGraf
.data CLASSPROPSSIZE
0000: 7A19
.enddata
.data CLASSPROPS
0000: 534F555243450004 0074626C00004772 6170685370656300 4C19900100000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000200 0000320000000000 0000030000000100
0180: 0000000000000000 0000010000000200 0000030000004172 69616C0000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000004172 69616C0000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 000000000000C800 0000960000006400
02E0: 0000B5FFFFFF0000 0000000000000000 0000000000000000 0000060000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000100 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
0560: 0000010000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000050000000100 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000003200 0000000000001E00 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000640000000100 0000010000000100 0000010000000100
06A0: 0000000000000000 0000000000000000 0000010000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 0000000000007462
06E0: 6C00000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000100 0000414B54310000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000414B54310000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 00004E4E00000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000010000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 000007000000FFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFF1000 0000100000001000 0000100000001000
15C0: 0000100000001000 0000100000001000 0000100000001000 0000100000001000
15E0: 0000100000000000 0000000000000000 0000000000000000 0000000000000000
1600: 0000000000000100 0000010000000000 0000000000000000 0000000000000000
1620: 0000000000000000 0000FFFFFFFF0000 0000FFFFFFFF0000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000004752 4150485050522E48
1660: 4C50000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000100 0000477261706820 436F6E74726F6C00 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000010000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 00000F0000000000 0000080000006400
1940: 0000140000001400 0000000000000000 0000000000000000 0000000000000000
1960: 0000010000000049 54454D000500414B 5431000000000000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGraph
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    1.24"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.583"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Horizontal Scroll Bar: hsb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   14.086"
.head 5 -  Top:    2.823"
.head 5 -  Width:  1.114"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.208"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: Redraw
.head 4 -   Description: 
.head 4 -   Returns 
.head 4 +   Parameters 
.head 5 -   String: strColumn
.head 4 +   Static Variables 
.head 5 -   String: strPrevColumn
.head 4 -   Local variables 
.head 4 +   Actions 
.head 5 -   Call WaitCursorOn( )
.head 5 -   Call SalHideWindow( tbl )
.head 5 -   Call SalEnableWindow( obTable )
.head 5 -   Call SalDisableWindow(  pbPrev )
.head 5 -   Call SalDisableWindow(  pbNext )
.head 5 +   If strColumn = ""
.head 6 +   If strPrevColumn = ""
.head 7 -   Set strPrevColumn = "AKT1"
.head 7 -   Call SalSendMsg( obActive, SAM_Click, 0, 0 )
.head 6 -   Set strColumn = strPrevColumn
.head 5 +   Else 
.head 6 -   Set strPrevColumn = strColumn
.head 5 -   Set ccGraf.Graph.DataSource = "tbl"
.head 5 -   Set ccGraf.Graph.DataField[0] = strColumn
.head 5 -   Set ccGraf.Graph.LegendField = "NN"
.head 5 -   Set ccGraf.Graph.NumDataFields = 1
.head 5 -   Set ccGraf.Graph.Background[0] = 7
.head 5 -   Set ccGraf.Graph.Background[1] = 7
.head 5 -   Set ccGraf.Graph.Background[6] = 7
.head 5 -   Set ccGraf.Graph.DrawMode = 2
.head 5 -   Call ccGraf.Draw()
.head 5 -   Call WaitCursorOff( )
.head 3 +  Function: Redraw2
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call WaitCursorOn( )
.head 5 -  Call SalHideWindow( tbl )
.head 5 -  Call SalEnableWindow( obTable )
.head 5 -  Call SalDisableWindow(  pbPrev )
.head 5 -  Call SalDisableWindow(  pbNext )
.head 5 -  !
.head 5 +  If nKA >1
.head 6 -  Set ccGraf.Graph.DataSource = "tbl"
.head 6 -  Set ccGraf.Graph.DataField[0] ="AKT1"
.head 6 -  Set ccGraf.Graph.LegendField = "NN"
.head 6 -  Set ccGraf.Graph.NumDataFields = 1
.head 6 -  Set ccGraf.Graph.Background[0] = 7
.head 6 -  Set ccGraf.Graph.Background[1] = 7
.head 6 -  Set ccGraf.Graph.Background[6] = 7
.head 6 -  Set ccGraf.Graph.DrawMode = 2
.head 6 -  Call ccGraf.Draw()
.head 5 -  !
.head 5 +  If nKP >1
.head 6 -  Set ccGraf1.Graph.DataSource = "tbl"
.head 6 -  Set ccGraf1.Graph.DataField[0] = "PAS1"
.head 6 -  Set ccGraf1.Graph.LegendField = "NN"
.head 6 -  Set ccGraf1.Graph.NumDataFields = 1
.head 6 -  Set ccGraf1.Graph.Background[0] = 7
.head 6 -  Set ccGraf1.Graph.Background[1] = 7
.head 6 -  Set ccGraf1.Graph.Background[6] = 7
.head 6 -  Set ccGraf1.Graph.DrawMode = 2
.head 6 -  Call ccGraf1.Draw()
.head 5 -  !
.head 5 -  Call WaitCursorOff( )
.head 2 +  Window Parameters
.head 3 -  Number: nMode !! 1- по валюте: 0 - по бал.ед
.head 2 +  Window Variables
.head 3 -  Number: nKA
.head 3 -  Number: nKP
.head 3 -  Number: glub
.head 3 -  String: sFdat
.head 3 -  String: bb1
.head 3 -  String: bb2
.head 3 -  String: bb3
.head 3 -  String: bb4
.head 3 -  String: st[7]
.head 3 -  String: ss
.head 3 -  String: sDat  !! для трансляции даты
.head 3 -  Date/Time: dtFdat
.head 3 -  ! Number: nRowCount
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call WaitCursorOff( )
.head 4 +  If nMode=0
.head 5 -  Call SalHideWindow( obTableV )
.head 5 -  ! Set sTmp='B_'||Str(GetSessionId())
.head 4 +  Else
.head 5 -  Call SalHideWindow( obActive )
.head 5 -  ! Call SalHideWindow( obPassive )
.head 5 -  Call SalHideWindow( tbl.KV )
.head 5 -  Call SalHideWindow( tbl.DOS )
.head 5 -  Call SalHideWindow( tbl.KOS )
.head 5 -  Call SalHideWindow( tbl.AKT1)
.head 5 -  Call SalHideWindow( tbl.AKT)
.head 5 -  Call SalHideWindow( tbl.PAS1)
.head 5 -  Call SalHideWindow( tbl.PAS)
.head 5 -  !
.head 5 -  Call SalHideWindow( tbl.DOSs )
.head 5 -  Call SalHideWindow( tbl.KOSs )
.head 5 -  Call SalHideWindow( tbl.AKTs )
.head 5 -  Call SalHideWindow( tbl.PASs )
.head 4 -  Set obTable = TRUE
.head 4 -  Set glub = 1
.head 4 -  Call SalDisableWindow( pbPrev )
.head 4 -  Call SalDisableWindow( obTable )
.head 4 -  Call SalDisableWindow( obActive )
.head 4 -  ! Call SalDisableWindow( obPassive )
.head 4 -  Call SalHideWindow( ccGraf )
.head 4 -  Call SalHideWindow( ccGraf1 )
.head 3 +  On SAM_Help
.head 4 +  If nMode = 0
.head 5 -  Call SalLoadApp ( "WinHlp32.exe", "-wWin1 -i Fi_010 " || GetHelpFile () )
.head 4 +  Else If nMode = 1
.head 5 -  Call SalLoadApp ( "WinHlp32.exe", "-wWin1 -i Fi_012 " || GetHelpFile () )
.head 1 +  ! Dialog Box: dlg_VAL   !   Просмотр балансов
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Анализ  балансов банка
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.175"
.head 4 -  Top:    0.177"
.head 4 -  Width:  11.871"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.438"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -             Description: 
.head 2 +             Tool Bar 
.head 3 -             Contents 
.head 2 +             Contents 
.head 3 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 +             Radio Button: rbBal
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +             Radio Button: rbBal8
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +             Radio Button: rbBal9
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 -             Background Text: Дата:
.head 3 +             Combo Box: lbVedo
.head 4 -             List Initialization 
.head 4 +             Message Actions 
.head 5 +             On SAM_Create
.head 6 -             Set strBankDate=GetBankDateEx()
.head 6 -             Set sDat=GetBankDateEx()
.head 6 -             Call SqlPrepareAndExecute( hSql(), 
T("SELECT fdat FROM Saldoa INTO :dtFdat 
      WHERE fdat<=:sDat  GROUP BY fdat ORDER BY 1 DESC" ) )
.head 6 +             While SqlFetchNext( hSql(), nFetchRes )
.head 7 -             Call SalListAdd( lbVedo, SalFmtFormatDateTime( dtFdat, ddMMyyyy() ) )
.head 6 -             Call SalListSetSelect( hWndItem, 0 )
.head 6 -             Call SalSendMsg( lbVedo, SAM_Click, 0, 0 )
.head 5 +             On SAM_Click
.head 6 -             Set strRepDate = SalListQueryTextX( hWndItem, SalListQuerySelection( hWndItem ) )
.head 6 -             Set sFdat=SalStrMidX( strRepDate, 3, 2 ) || '-' || SalStrLeftX( strRepDate, 2 ) || '-' || SalStrRightX( strRepDate, 4 )
.head 6 -  !
.head 6 -             Set glub=1
.head 6 -             Call SalDisableWindow( pbPrev )
.head 6 -             Call SalEnableWindow( pbNext )
.head 6 -             Call SalWaitCursor( TRUE )
.head 6 -             Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 5 +             On SAM_SetFocus
.head 6 -             Call SalStatusSetText( hWndForm, 'Выберите дату.' )
.head 3 +             Pushbutton: pbPrev
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 +             If glub>2
.head 7 -             Set glub=glub-2
.head 7 -             Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 6 +             Else 
.head 7 -             Set glub=1
.head 7 -             Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 3 +             Pushbutton: pbNext
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 3 +             Option Button: obTable
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalHideWindow( dfTitle )
.head 6 -             Call SalHideWindow( ccGraf )
.head 6 -             Call SalShowWindow( tbl )
.head 3 +             Option Button: obActive
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalHideWindow( tbl )
.head 6 -             Call SalShowWindow( dfTitle )
.head 6 -             Call SalShowWindow( ccGraf )
.head 6 -             Call Redraw( "AKT1" )
.head 3 +             Option Button: obPassive
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalHideWindow( tbl )
.head 6 -             Call SalShowWindow( dfTitle )
.head 6 -             Call SalShowWindow( ccGraf )
.head 6 -             Call Redraw( "PAS1" )
.head 3 +             Pushbutton: pbQuit
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalEndDialog( hWndForm, FALSE )
.head 5 +             On SAM_SetFocus
.head 6 -             Call SalStatusSetText( hWndForm, 'Завершить просмотр.' )
.head 3 +             Child Table: tbl
.head 4 +             Contents 
.head 5 +             Column: BS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: KV
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: DOS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: KOS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: AKT
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: AKT1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: PAS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: PAS1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: NN
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 4 -             Functions 
.head 4 -             Window Variables 
.head 4 +             Message Actions 
.head 5 +             On SAM_User
.head 6 -             Call SalWaitCursor( TRUE )
.head 6 -  !
.head 6 +             If glub = 1 
.head 7 -             Call SalDisableWindow( pbPrev )
.head 7 -             Call SalEnableWindow( rbBal )
.head 7 -             Call SalEnableWindow( rbBal8 )
.head 7 -             Call SalEnableWindow( rbBal9 )
.head 6 +             Else 
.head 7 -             Call SalEnableWindow( pbPrev )
.head 7 -             Call SalDisableWindow( rbBal )
.head 7 -             Call SalDisableWindow( rbBal8 )
.head 7 -             Call SalDisableWindow( rbBal9 )
.head 6 +             If glub = 5
.head 7 -             Call SalDisableWindow( pbNext )
.head 6 +             Else 
.head 7 -             Call SalEnableWindow( pbNext )
.head 6 -  !
.head 6 +             If glub=5
.head 7 -             Set ss="
SELECT c.nls, c.kv, c.nms, a.dos/100, a.kos/100, 
   - IIF_N ( a.ostf - a.dos + a.kos, 0, a.ostf - a.dos + a.kos, 0, 0 )/100,
    IIF_N ( a.ostf - a.dos + a.kos, 0, 0, 0,  a.ostf - a.dos + a.kos )/100, 
 - IIF_N ( a.ostf - a.dos + a.kos, 0, gl.p_icurval(c.kv,a.ostf - a.dos + a.kos,a.fdat ), 0, 0 )/100000, 
   IIF_N ( a.ostf - a.dos + a.kos, 0, 0, 0, GL.p_icurval(c.kv,a.ostf - a.dos + a.kos,a.fdat )  )/100000  
INTO :tbl.BS, :tbl.KV, :tbl.NN ,  :tbl.DOS,  :tbl.KOS,  :tbl.AKT,  :tbl.PAS, :tbl.AKT1, :tbl.PAS1
FROM  saldoa a, accounts c
WHERE   c.nbs = :bb4  AND c.acc=a.acc  AND  a.fdat = :sDat   
UNION ALL
SELECT cc.nls, cc.kv, cc.nms, 0, 0, 
 - IIF_N ( aa.ostf - aa.dos + aa.kos, 0, aa.ostf - aa.dos + aa.kos, 0, 0 )/100,
   IIF_N ( aa.ostf - aa.dos + aa.kos, 0, 0,  aa.ostf - aa.dos + aa.kos,  0 )/100, 
 - IIF_N ( aa.ostf - aa.dos + aa.kos, 0, gl.p_icurval(cc.kv,aa.ostf - aa.dos + aa.kos,aa.fdat ), 0, 0 )/100000,
   IIF_N ( aa.ostf - aa.dos + aa.kos, 0, 0, 0, gl.p_icurval(cc.kv,aa.ostf - aa.dos + aa.kos,aa.fdat ) )/100000    
 FROM  saldoa aa, accounts cc
 WHERE cc.nbs = :bb4  AND 
                   cc.acc = aa.acc   AND  
                   aa.ostf - aa.dos +aa.kos <> 0     AND  
                   aa.acc  NOT  IN 
      ( SELECT  dd.acc  FROM  saldoa dd  WHERE dd.fdat = :sDat  )  AND
                   aa.fdat IN 
     ( SELECT max( bb.fdat )  FROM  saldoa bb 
   WHERE aa.acc = bb.acc   AND bb.fdat  <  :sDat   GROUP BY bb.acc ) 
 ORDER BY 1, 2" 
.head 6 +             Else 
.head 7 -             Set ss= "SELECT  p.nbs,  p.name, 
 sum(c.dos)/100, sum(c.kos)/100, 
  0  - sum( c.ostf  *  IIF_N( c.ostf, 0, 1, 0, 0 ) )/100, 
 sum( c.ostf  *  IIF_N (0, c.ostf, 1, 0,  0 ) )/100 
 FROM  TMP_BAL c,  Ps p
INTO :tbl.BS,  :tbl.NN ,  :tbl.DOS,  :tbl.KOS,  :tbl.AKT,  :tbl.PAS 
WHERE p.nbs =  "  
.head 7 +             If glub=1
.head 8 -             Set ss= ss ||  " c.nbs[1,1] || '   ' AND "  
.head 8 +             If rbBal
.head 9 -             Set ss = ss || " c.nbs[1,1] < '8' "
.head 8 +             If rbBal8
.head 9 -             Set ss = ss || " c.nbs[1,1] = '8' "
.head 8 +             If rbBal9
.head 9 -             Set ss = ss || " c.nbs[1,1] = '9' "
.head 7 +             If glub=2
.head 8 -             Set ss= ss ||  " c.nbs[1,2] || '  '  and c.nbs[1,1] = :bb1 "
.head 7 +             If glub=3
.head 8 -             Set ss= ss ||  " c.nbs[1,3] || ' '   and c.nbs[1,2] = :bb2 "
.head 7 +             If glub=4
.head 8 -             Set ss= ss ||  " c.nbs  and c.nbs[1,3] = :bb3 "
.head 7 -             Set ss=ss || " GROUP BY p.nbs, p.name ORDER BY 1"
.head 6 -  !
.head 6 -             Set ss=T(ss)
.head 6 -             Set nRowCount = 0
.head 6 -  ! Call Debug(ss)
.head 6 -             Call SalTblPopulate( hWndForm, hSql(), ss, TBL_FillAll )
.head 6 +             If nRowCount = 0
.head 7 -             Call SalDisableWindow( pbNext )
.head 6 +             If nRowCount > 1
.head 7 -             Call SalEnableWindow( obTable )
.head 7 -             Call SalEnableWindow( obActive )
.head 7 -             Call SalEnableWindow( obPassive )
.head 7 +             If obActive or obPassive
.head 8 -             Call Redraw("")
.head 6 +             Else 
.head 7 -             Set obTable = TRUE
.head 7 -             Call SalDisableWindow( obTable )
.head 7 -             Call SalDisableWindow( obActive )
.head 7 -             Call SalDisableWindow( obPassive )
.head 7 -             Call SalSendMsg( obTable, SAM_Click, 0, 0 )
.head 6 -  !
.head 6 -             Call SalWaitCursor( FALSE)
.head 5 +             On SAM_DoubleClick
.head 6 +             If glub < 5
.head 7 -             Set dfTitle = BS || ":" || NN
.head 7 +             If glub=1
.head 8 -             Set bb1=SalStrMidX( tbl.BS, 0, 1 )
.head 7 +             If glub=2
.head 8 -             Set bb2=SalStrMidX( tbl.BS, 0, 2 )
.head 7 +             If glub=3
.head 8 -             Set bb3=SalStrMidX( tbl.BS, 0, 3)
.head 7 +             If glub=4
.head 8 -             Set bb4=tbl.BS
.head 7 -             Set glub=glub+1
.head 7 -             Call SalSendMsg( tbl, SAM_User, 0, 0 )
.head 5 +             On SAM_FetchRowDone
.head 6 +             If glub < 5
.head 7 -             Set AKT1 = SalNumberRound ( AKT / 1000 )
.head 7 -             Set PAS1 = SalNumberRound ( PAS / 1000 )
.head 6 +             Else 
.head 7 -             Set AKT1 = SalNumberRound ( AKT1 )
.head 7 -             Set PAS1 = SalNumberRound ( PAS1 )
.head 6 -             Set nRowCount = nRowCount + 1
.head 3 +             Data Field: dfTitle
.head 4 -             Message Actions 
.head 3 +             Custom Control: ccGraf
.data CLASSPROPSSIZE
0000: 7A19
.enddata
.data CLASSPROPS
0000: 534F555243450004 0074626C00004772 6170685370656300 4C19900100000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000200 0000320000000000 0000030000000100
0180: 0000000000000000 0000010000000200 0000030000004172 69616C0000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000004172 69616C0000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 000000000000C800 0000960000006400
02E0: 0000B5FFFFFF0000 0000000000000000 0000000000000000 0000060000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000100 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
0560: 0000010000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000050000000100 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000003200 0000000000001E00 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000640000000100 0000010000000100 0000030000000100
06A0: 0000000000000000 0000000000000000 0000010000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 0000000000007462
06E0: 6C00000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000100 0000414B54310000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000414B54310000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 00004E4E00000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000010000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 000007000000FFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFF1000 0000100000001000 0000100000001000
15C0: 0000100000001000 0000100000001000 0000100000001000 0000100000001000
15E0: 0000100000000000 0000000000000000 0000000000000000 0000000000000000
1600: 0000000000000100 0000010000000000 0000000000000000 0000000000000000
1620: 0000000000000000 0000FFFFFFFF0000 0000FFFFFFFF0000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000004752 4150485050522E48
1660: 4C50000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000100 0000477261706820 436F6E74726F6C00 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 00000F0000000000 0000080000006400
1940: 0000140000001400 0000000000000000 0000000000000000 0000000000000000
1960: 0000010000000049 54454D000500414B 5431000000000000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -             Message Actions 
.head 2 +             Functions 
.head 3 +             Function: Redraw
.head 4 -             Description: 
.head 4 -             Returns 
.head 4 +             Parameters 
.head 5 -             String: strColumn
.head 4 +             Static Variables 
.head 5 -             String: strPrevColumn
.head 4 -             Local variables 
.head 4 +             Actions 
.head 5 +             If strColumn = ""
.head 6 +             If strPrevColumn = ""
.head 7 -             Set strPrevColumn = "AKT1"
.head 7 -             Call SalSendMsg( obActive, SAM_Click, 0, 0 )
.head 6 -             Set strColumn = strPrevColumn
.head 5 +             Else 
.head 6 -             Set strPrevColumn = strColumn
.head 5 -             Set ccGraf.Graph.DataSource = "tbl"
.head 5 -             Set ccGraf.Graph.DataField[0] = strColumn
.head 5 -             Set ccGraf.Graph.LegendField = "NN"
.head 5 -             Set ccGraf.Graph.NumDataFields = 1
.head 5 -             Set ccGraf.Graph.Background[0] = 7
.head 5 -             Set ccGraf.Graph.Background[1] = 7
.head 5 -             Set ccGraf.Graph.Background[6] = 7
.head 5 -             Set ccGraf.Graph.DrawMode = 2
.head 5 -             Call ccGraf.Draw()
.head 2 +             Window Parameters 
.head 3 -             Number: nMode
.head 2 +             Window Variables 
.head 3 -             Number: glub
.head 3 -             String: sFdat
.head 3 -             String: bb1
.head 3 -             String: bb2
.head 3 -             String: bb3
.head 3 -             String: bb4
.head 3 -             String: ss
.head 3 -             String: sDat  !! для трансляции даты
.head 3 -             Date/Time: dtFdat
.head 3 -             Number: nRowCount
.head 2 +             Message Actions 
.head 3 +             On SAM_Create
.head 4 -             Call SalCenterWindow( hWndForm )
.head 4 -             Call SalDisableWindow( pbPrev )
.head 4 -             Set obTable = TRUE
.head 4 -             Set glub = 1
.head 4 -             Call SalDisableWindow( obTable )
.head 4 -             Call SalDisableWindow( obActive )
.head 4 -             Call SalDisableWindow( obPassive )
.head 4 -             Call SalHideWindow( ccGraf )
.head 4 -             Call SalHideWindow( dfTitle )
.head 3 +             On SAM_CreateComplete
.head 4 -             Call WaitCursorOff( )
.head 1 +  ! Dialog Box: dlg_din          !   Просмотр балансов c графиком  (STA)
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Анализ  балансов банка в динамике
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.138"
.head 4 -  Top:    -0.125"
.head 4 -  Width:  13.443"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.448"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -             Description: 
.head 2 +             Tool Bar 
.head 3 -             Contents 
.head 2 +             Contents 
.head 3 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 +             Pushbutton: pbPrev
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 +             If glub>2
.head 7 -             Set glub=glub-2
.head 7 -             Call SalSendMsg( tba, SAM_DoubleClick, 0, 0 )
.head 6 +             Else 
.head 7 -             Set glub=1
.head 7 -             Call SalSendMsg( tba, SAM_User, 0, 0 )
.head 3 +             Pushbutton: pbNext
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalSendMsg( tba, SAM_DoubleClick, 0, 0 )
.head 3 +             Pushbutton: pbDynamics
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Set DAN=tba.BS || ": " || SalNumberToStrX(tba.KV,0 ) || ": " || tba.NN
.head 6 -             Set Z1=SalStrMidX( tba.BS, 0, 1)
.head 6 -             Set Z234=SalStrMidX( tba.BS, 1, glub-1)
.head 6 +  ! If glub<5  MIK
.head 7 -             Set bb=SalStrMidX( tba.BS, 0, glub ) 
.head 7 -             Set ss=" SELECT to_char(c.fdat,'DD-MM-YYYY'), 
 - SUM ( gl.p_icurval ( a.kv, c.dos, c.fdat) )/100, 
 SUM ( gl.p_icurval ( a.kv, c.kos, c.fdat) )/100,
 SUM ( gl.p_icurval(a.kv,c.ostf-c.dos+c.kos, c.fdat)  * 
             IIF_N(c.ostf-c.dos+c.kos,0,1,0,0) )/100,
 SUM( gl.p_icurval(a.kv,c.ostf-c.dos+c.kos,c.fdat)  * 
             IIF_N(c.ostf-c.dos+c.kos,0, 0,0,1) ) /100
INTO :tbb.DAT, :tbb.DOS1, :tbb.KOS1, :tbb.AKT1, :tbb.PAS1 
FROM saldoa c, accounts a 
WHERE c.fdat >= :sdat  AND c.fdat <= :sdat2 
      AND a.acc=c.acc AND  "
.head 7 +             If glub=1
.head 8 -             Set ss=ss|| IifS( Z1='D',
" substr(a.nbs,1,1) in ('6','7') ",
" substr(a.nbs,1,1)=:bb ")
.head 7 +             If glub=2
.head 8 -             Set ss=ss || IifS(Z1='D',
" substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,1)='"||Z234||"'", 
" substr(a.nbs,1,2)=:bb ")
.head 7 +             If glub=3
.head 8 -             Set ss=ss || IifS(Z1='D',
" substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,2)='"||Z234||"'",
" substr(a.nbs,1,3)=:bb ")
.head 7 +             If glub=4
.head 8 -             Set ss=ss ||IifS(Z1='D',
"substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,3)='"||Z234||"'",
 " a.nbs=:bb ")
.head 7 -             Set ss=T(ss || " GROUP BY to_char(c.fdat,'DD-MM-YYYY')  ORDER BY 1 " )  !!!! DESC " )
.head 6 +             If glub<5
.head 7 -             Set bb=SalStrMidX( tba.BS, 0, glub ) 
.head 7 -             Set ss=" SELECT c.fdat,to_char(c.fdat,'DD-MM-YYYY'), 
 - SUM ( gl.p_icurval ( a.kv, c.dos, c.fdat) )/100, 
 SUM ( gl.p_icurval ( a.kv, c.kos, c.fdat) )/100,
 SUM ( gl.p_icurval(a.kv,c.ostf-c.dos+c.kos, c.fdat)  * 
             IIF_N(c.ostf-c.dos+c.kos,0,1,0,0) )/100,
 SUM( gl.p_icurval(a.kv,c.ostf-c.dos+c.kos,c.fdat)  * 
             IIF_N(c.ostf-c.dos+c.kos,0, 0,0,1) ) /100
INTO :dTmp,:tbb.DAT, :tbb.DOS1, :tbb.KOS1, :tbb.AKT1, :tbb.PAS1 
FROM saldoa c, accounts a 
WHERE c.fdat >= :sdat  AND c.fdat <= :sdat2 
      AND a.acc=c.acc AND  "
.head 7 +             If glub=1
.head 8 -             Set ss=ss|| IifS( Z1='D',
" substr(a.nbs,1,1) in ('6','7') ",
" substr(a.nbs,1,1)=:bb ")
.head 7 +             If glub=2
.head 8 -             Set ss=ss || IifS(Z1='D',
" substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,1)='"||Z234||"'", 
" substr(a.nbs,1,2)=:bb ")
.head 7 +             If glub=3
.head 8 -             Set ss=ss || IifS(Z1='D',
" substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,2)='"||Z234||"'",
" substr(a.nbs,1,3)=:bb ")
.head 7 +             If glub=4
.head 8 -             Set ss=ss ||IifS(Z1='D',
"substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,3)='"||Z234||"'",
 " a.nbs=:bb ")
.head 7 -             Set ss=T(ss || " GROUP BY c.fdat,to_char(c.fdat,'DD-MM-YYYY') ORDER BY 1 " )  !!!! DESC " )
.head 6 +             Else 
.head 7 -             Set ss=T("SELECT c.fdat, -c.dos/100,  c.kos/100,
   DECODE(SIGN(c.ostf-c.dos+c.kos),-1,(c.ostf-c.dos+c.kos),0)/100,
   DECODE(SIGN(c.ostf-c.dos+c.kos), 1,(c.ostf-c.dos+c.kos),0)/100
   INTO :dTmp, :tbb.DOS1, :tbb.KOS1, :tbb.AKT1, :tbb.PAS1 
   FROM saldoa c, accounts a 
   WHERE c.fdat >= :sdat AND c.fdat <= :sdat2 AND 
         a.acc=c.acc AND a.nls=:tba.BS AND a.kv=:tba.KV 
   ORDER BY c.fdat DESC ")
.head 7 -             Call Debug(ss)
.head 6 -             Call SalWaitCursor( TRUE )
.head 6 -             Call Debug(sdat||'-'||sdat2)
.head 6 -             Call Debug(tba.BS)
.head 6 -             Call DebugN(tba.KV)
.head 6 -             Set nRowCount = 0
.head 6 -             Call SalTblPopulate( tbb, hSql(), ss, TBL_FillAll )
.head 6 +             If nRowCount = 0
.head 7 -             Call SalDisableWindow( pbNext )
.head 6 +             If nRowCount > 1
.head 7 -             Call SalEnableWindow( obTable )
.head 7 -             Call SalEnableWindow( obGraph )
.head 7 +             If obGraph
.head 8 -             Call Redraw()
.head 6 +             Else 
.head 7 -             Set obTable = TRUE
.head 7 -             Call SalDisableWindow( obTable )
.head 7 -             Call SalDisableWindow( obGraph )
.head 7 -             Call SalSendMsg( obTable, SAM_Click, 0, 0 )
.head 6 -             Call SalWaitCursor( FALSE)
.head 3 +             Pushbutton: pbQuit
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalEndDialog( hWndForm, FALSE )
.head 5 +             On SAM_SetFocus
.head 6 -             Call SalStatusSetText( hWndForm, 'Завершить просмотр.' )
.head 3 +             Option Button: obTable
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalHideWindow( ccGraf )
.head 6 -             Call SalShowWindow( tbb )
.head 3 +             Option Button: obGraph
.head 4 +             Message Actions 
.head 5 +             On SAM_Click
.head 6 -             Call SalHideWindow( tbb )
.head 6 -             Call SalShowWindow( ccGraf )
.head 6 -             Call Redraw()
.head 3 +             Data Field: DAN
.head 4 -             Message Actions 
.head 3 +             Child Table: tba
.head 4 +             Contents 
.head 5 +             Column: BS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: KV
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: NN
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 4 -             Functions 
.head 4 +             Window Variables 
.head 5 -             Number: nTmp
.head 4 +             Message Actions 
.head 5 +             On SAM_User
.head 6 -             Call SalWaitCursor( TRUE )
.head 6 -  !
.head 6 +             If glub = 1 
.head 7 -             Call SalDisableWindow( pbPrev )
.head 6 +             Else 
.head 7 -             Call SalEnableWindow( pbPrev )
.head 6 +             If glub = 5
.head 7 -             Call SalDisableWindow( pbNext )
.head 6 +             Else 
.head 7 -             Call SalEnableWindow( pbNext )
.head 6 -  !
.head 6 +             If glub=5
.head 7 -             Set ss="
SELECT c.nls, c.kv, c.nms, a.dos/100, a.kos/100, 
    IIF_N ( a.ostf - a.dos + a.kos, 0, -( a.ostf - a.dos + a.kos), 0, 0 )/100,
    IIF_N ( a.ostf - a.dos + a.kos, 0, 0, 0, ( a.ostf - a.dos + a.kos) )/100, 
    IIF_N ( a.ostf - a.dos + a.kos, 0, gl.p_icurval( c.kv, a.fdat, -( a.ostf - a.dos + a.kos), 0, 0 ))/100000, 
    IIF_N ( a.ostf - a.dos + a.kos, 0, 0, 0, gl.p_icurval( c.kv, a.fdat, (a.ostf - a.dos + a.kos) ) )/100000
FROM saldoa a, accounts c
INTO :tbl.BS, :tbl.KV, :tbl.NN ,  :tbl.DOS,  :tbl.KOS,  :tbl.AKT,  :tbl.PAS, :tbl.AKT1, :tbl.PAS1
WHERE   c.nbs = :bb4  AND c.acc=a.acc  AND  a.fdat = :sDat 
UNION 
SELECT c.nls, c.kv, c.nms, 0, 0, 
 IIF_N ( a.ostf - a.dos + a.kos, 0, -( a.ostf - a.dos + a.kos), 0, 0 )/100,
 IIF_N ( a.ostf - a.dos + a.kos, 0, 0, ( a.ostf - a.dos + a.kos),  0 )/100 
 IIF_N ( a.ostf - a.dos + a.kos, 0, gl.p_icurval( c.kv, a.fdat, -( a.ostf - a.dos + a.kos)), 0, 0 )/100000,
 IIF_N ( a.ostf - a.dos + a.kos, 0, 0, gl.p_icurval( c.kv, a.fdat, (a.ostf - a.dos + a.kos)),  0 )/100000 
 FROM saldoa a, accounts c
 WHERE c.nbs = :bb4  AND c.acc=a.acc   AND  a.ostf - a.dos + a.kos <> 0     AND  
         a.acc NOT IN 
 ( SELECT  d.acc FROM saldoa d  WHERE d.fdat = :sDat ) AND
         a.fdat IN 
 ( SELECT max(b.fdat) FROM saldoa b 
   WHERE a.acc=b.acc  AND b.fdat < :sDat   GROUP BY b.acc )
 ORDER BY 1, 2" 
.head 6 +             Else 
.head 7 -             Set ss= "SELECT  p.nbs,  p.name, 
 sum(c.dos)/100, sum(c.kos)/100, 
  0  - sum( c.ostf  *  IIF_N( c.ostf, 0, 1, 0, 0 ) )/100, 
 sum( c.ostf  *  IIF_N (0, c.ostf, 1, 0,  0 ) )/100 
 FROM  TMP_BAL c,  Ps p
INTO :tbl.BS,  :tbl.NN ,  :tbl.DOS,  :tbl.KOS,  :tbl.AKT,  :tbl.PAS 
WHERE p.nbs =  "  
.head 7 +             If glub=1
.head 8 -             Set ss= ss ||  " c.nbs[1,1] || '   ' AND "  
.head 7 +             If glub=2
.head 8 -             Set ss= ss ||  " c.nbs[1,2] || '  '  and c.nbs[1,1] = :bb1 "
.head 7 +             If glub=3
.head 8 -             Set ss= ss ||  " c.nbs[1,3] || ' '   and c.nbs[1,2] = :bb2 "
.head 7 +             If glub=4
.head 8 -             Set ss= ss ||  " c.nbs  and c.nbs[1,3] = :bb3 "
.head 7 -             Set ss=ss || " GROUP BY p.nbs, p.name ORDER BY 1"
.head 6 -  !
.head 6 +             If glub=5
.head 7 +             If bb1='D'
.head 8 -             Set XX = SalStrMidX( bb4,1,3)
.head 8 -             Set ss="
SELECT c.nls, c.kv, c.nms FROM  accounts c
INTO :tba.BS, :tba.KV, :tba.NN
WHERE   c.nbs[2,4] = :XX and  (c.nbs[1,1] = '6' or  c.nbs[1,1] = '7') 
 ORDER BY 1, 2" 
.head 7 +             Else 
.head 8 -             Set ss="
SELECT c.nls, c.kv, c.nms FROM  accounts c
INTO :tba.BS, :tba.KV, :tba.NN
WHERE   c.nbs = :bb4  ORDER BY 1, 2" 
.head 6 +             Else 
.head 7 +             If glub=1
.head 8 -             Set ss= "SELECT nbs,name FROM Psk
 INTO :tba.BS,:tba.NN
 UNION  SELECT 'D',' ' FROM DUAL "  
.head 7 +             If glub=2
.head 8 +             If bb1 ='D'
.head 9 -             Set ss= "SELECT 'D'||substr(nbs,2,1), max(name) FROM Psr
 INTO :tba.BS,:tba.NN 
 WHERE substr(nbs,1,1)='6' or substr(nbs,1,1)='7' 
 GROUP BY 'D'||substr(nbs,2,1) "  
.head 8 +             Else 
.head 9 -             Set ss= "SELECT  nbs, name   FROM   Psr
 INTO :tba.BS,  :tba.NN 
 WHERE  nbs[1,1] = :bb1 " 
.head 7 +             If glub=3
.head 8 +             If bb1 ='D'
.head 9 -             Set XX = SalStrMidX( bb2,1,1)
.head 9 -             Set ss= "SELECT 'D'||substr(nbs,2,2), max(name) FROM Psg
 INTO :tba.BS,:tba.NN 
 WHERE substr(nbs,1,2)='6"||XX||"' or substr(nbs,1,2)='7"||XX||"'
GROUP BY 'D'||substr(nbs,2,2)"
.head 8 +             Else 
.head 9 -             Set ss= "SELECT  nbs, name   FROM   Psg
 INTO :tba.BS,  :tba.NN 
 WHERE  nbs[1,2] = :bb2 " 
.head 7 +             If glub=4
.head 8 +             If bb1 ='D'
.head 9 -             Set XX = SalStrMidX( bb3,1,2)
.head 9 -             Set ss= "SELECT 'D'||substr(nbs,2,3), max(name) FROM Psb
 INTO :tba.BS,:tba.NN 
 WHERE substr(nbs,1,3)='6"||XX||"' or substr(nbs,1,3)='7"||XX||"'
GROUP BY 'D'||substr(nbs,2,3)"  
.head 8 +             Else 
.head 9 -             Set ss= "SELECT  nbs, name   FROM   Psb
 INTO :tba.BS,  :tba.NN 
 WHERE  nbs[1,3] = :bb3  " 
.head 7 -             Set ss=ss || " ORDER BY 1"
.head 6 -             Call SalTblPopulate( tba, hSqlAux(), T(ss), TBL_FillAll )
.head 6 -             Call SalWaitCursor( FALSE)
.head 5 +             On SAM_DoubleClick
.head 6 +             If glub < 5
.head 7 +             If glub=1
.head 8 -             Set bb1=SalStrMidX( tba.BS, 0, 1 )
.head 7 +             If glub=2
.head 8 -             Set bb2=SalStrMidX( tba.BS, 0, 2 )
.head 7 +             If glub=3
.head 8 -             Set bb3=SalStrMidX( tba.BS, 0, 3)
.head 7 +             If glub=4
.head 8 -             Set bb4=tba.BS
.head 7 -             Set glub=glub+1
.head 7 -             Call SalSendMsg( tba, SAM_User, 0, 0 )
.head 5 +             On SAM_FetchRowDone
.head 6 +             If SalStrMidX(BS,0,1)='D'
.head 7 +             If glub=1  !! D
.head 8 -             Set NN =' Чистый доход (6-7)'
.head 7 +  ! If glub=2  !! Dx
.head 8 -             Set XX=SalStrMidX(BS,1,1)
.head 8 -             Call SqlPrepareAndExecute( hSql(), "
SELECT name into :NN 
FROM Psr WHERE substr(nbs,1,2)='6"||XX||"' or substr(nbs,1,2)='7"||XX||"'")
.head 8 -             Call SqlFetchNext( hSql(), nI )
.head 7 +  ! If glub=3  !! Dxx
.head 8 -             Set XX=SalStrMidX(BS,1,2)
.head 8 -             Call SqlPrepareAndExecute( hSql(), "SELECT name into :NN 
FROM Psg  WHERE substr(nbs,1,3)='6"||XX||"' or substr(nbs,1,3)='7"||XX||"'")
.head 8 -             Call SqlFetchNext( hSql(), nI )
.head 7 +  ! If glub=4  !! Dxxx
.head 8 -             Set XX=SalStrMidX(BS,1,3)
.head 8 -             Call SqlPrepareAndExecute( hSql(), "SELECT name into :NN 
FROM Psb  WHERE nbs='6"||XX||"' or nbs='7"||XX||"'")
.head 8 -             Call SqlFetchNext( hSql(), nI )
.head 5 +             On SAM_Create
.head 6 +             If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 7 -             Call SalTblSetColumnFlags( BS, COL_RightJustify, TRUE )
.head 3 +             Child Table: tbb
.head 4 +             Contents 
.head 5 +             Column: DAT
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: DOS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: DOS1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: KOS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: KOS1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: AKT
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: AKT1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: PAS
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: PAS1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: SAL
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 5 +             Column: SAL1
.head 6 -             List Values 
.head 6 -             Message Actions 
.head 4 -             Functions 
.head 4 -             Window Variables 
.head 4 +             Message Actions 
.head 5 +             On SAM_FetchRowDone
.head 6 -             Set SAL1 =  PAS1  + AKT1
.head 6 -             Set DAT = SalFmtFormatDateTime( dTmp, 'dd-MM-yyyy' )
.head 6 -             Set DOS = SalNumberRound ( DOS1 / 1000 )
.head 6 -             Set KOS = SalNumberRound ( KOS1 / 1000 )
.head 6 -             Set AKT = SalNumberRound ( AKT1 / 1000 )
.head 6 -             Set PAS = SalNumberRound ( PAS1 / 1000 )
.head 6 -             Set SAL = SalNumberRound ( SAL1 / 1000 )
.head 6 -             Set nRowCount = nRowCount + 1
.head 5 +             On SAM_Create
.head 6 -             Set nRowCount = 0
.head 5 -             On SAM_CountRows
.head 3 +             Custom Control: ccGraf                !!! GGGGGG это графики
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4954454D00140044 4F532C4B4F532C41 4B542C5041532C53 414C000047726170
0020: 6853706563004C19 9001000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000000 0000000000000000 0000000002000000
0180: 3200000000000000 0300000001000000 0000000000000000 0100000002000000
01A0: 0300000041726961 6C20437972000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000000000 0000000000000000 0000000041726961 6C20437972000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0240: 0000000041726961 6C20437972000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000000000 0000000000000000 0000000041726961 6C20437972000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02E0: 00000000C8000000 9600000064000000 6400000000000000 0000000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000000 0000000000000000 0000000006000000
0360: 0300000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0560: 0000000000000000 0000000001000000 0100000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000000000000000 0000000000000000 0500000005000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000000000 0000000000000000 0000000032000000 000000001E000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000000000000000 0000000000000000 6400000001000000
06A0: 0100000001000000 0300000001000000 0000000000000000 0000000000000000
06C0: 0100000000000000 0000000000000000 0000000000000000 0000000000000000
06E0: 0000000000000000 0000000074626200 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000000 0000000000000000 0000000005000000
0740: 444F530000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 4B4F530000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 414B540000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 5041530000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 53414C0000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D80: CEE12EC4E5E1E5F2 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 CEE12ECAF0E5E4E8 F200000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: D1E0EBFCE4EE2DC0 EAF2000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 D1E0EBFCE4EE2DCF E0F1000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: D1E0EBFCE4EE2028 C0EAF22BCFE0F129 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 4441540000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000000000000000 0000000000000000 0100000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
15A0: 07000000FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF10000000
15C0: 1000000010000000 1000000010000000 1000000010000000 1000000010000000
15E0: 1000000010000000 1000000010000000 1000000000000000 0000000000000000
1600: 0000000001000000 0000000000000000 0000000001000000 0100000000000000
1620: 0000000000000000 0000000000000000 0000000000000000 FFFFFFFF00000000
1640: FFFFFFFF00000000 0000000000000000 0000000000000000 0000000000000000
1660: 0000000047524150 485050522E484C50 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000001000000 0000000000000000 0000000000000000
1880: 0000000000000000 0000000000000000 0000000001000000 477261706820436F
18A0: 6E74726F6C000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1940: 0F00000000000000 0800000064000000 1400000014000000 0100000001000000
1960: 0000000000000000 0000000000000000 0100000000534F55 5243450004007462
1980: 6200000000000000 00
.enddata
.data CLASSPROPSSIZE
0000: 8919
.enddata
.head 4 +             Message Actions 
.head 5 +  ! On SAM_Create
.head 6 -             Call SalMessageBox("!", "!", MB_Ok)
.head 6 -             Call ccGraf.Reset(  )
.head 3 +             Combo Box: dat
.head 4 -             List Initialization 
.head 4 +             Message Actions 
.head 5 +             On SAM_Create
.head 6 -             Call SqlPrepareAndExecute( hSql(), 
  T("SELECT fdat INTO :dTmp FROM saldoa GROUP BY fdat ORDER BY fdat ") )
.head 6 -             Set nTmp=0
.head 6 -             Call SalArraySetUpperBound( mDat1,1,-1 )
.head 6 -             Call SalListClear( hWndItem )
.head 6 +             While SqlFetchNext( hSql(), nFetchRes )
.head 7 -             Call SalListAdd( hWndItem, SalFmtFormatDateTime( dTmp, 'dd-MM-yyyy' ) )
.head 7 -             Set mDat1[nTmp] = dTmp
.head 7 -             Set nTmp=nTmp+1
.head 6 -             Call SalListSetSelect( hWndItem, 0 )
.head 6 -             Call SalSendMsg(dat,SAM_Click,0,0)
.head 5 +             On SAM_Click
.head 6 -             Set nTmp=SalListQuerySelection( hWndItem )
.head 6 +             If nTmp>=0
.head 7 -             Set sdat = SalFmtFormatDateTime( mDat1[nTmp], 'MM-dd-yyyy' ) 
.head 6 +             Else 
.head 7 -             Set sdat = GetBankDateEx()
.head 3 +             Combo Box: dat2
.head 4 -             List Initialization 
.head 4 +             Message Actions 
.head 5 +             On SAM_Create
.head 6 -             Call SqlPrepareAndExecute( hSql(), 
  T("SELECT fdat INTO :dTmp FROM saldoa GROUP BY fdat ORDER BY fdat DESC") )
.head 6 -             Set nTmp=0
.head 6 -             Call SalArraySetUpperBound( mDat2,1,-1 )
.head 6 -             Call SalListClear( hWndItem )
.head 6 +             While SqlFetchNext( hSql(), nFetchRes )
.head 7 -             Call SalListAdd( hWndItem, SalFmtFormatDateTime( dTmp, 'dd-MM-yyyy' ) )
.head 7 -             Set mDat2[nTmp] = dTmp
.head 7 -             Set nTmp=nTmp+1
.head 6 -             Call SalListSetSelect( hWndItem, 0 )
.head 6 -             Call SalSendMsg(dat2,SAM_Click,0,0)
.head 5 +             On SAM_Click
.head 6 -             Set nTmp=SalListQuerySelection( hWndItem )
.head 6 +             If nTmp>=0
.head 7 -             Set sdat2 = SalFmtFormatDateTime( mDat2[nTmp], 'MM-dd-yyyy' ) 
.head 6 +             Else 
.head 7 -             Set sdat2 = GetBankDateEx()
.head 2 +             Functions 
.head 3 +             Function: Redraw
.head 4 -             Description: 
.head 4 -             Returns 
.head 4 -             Parameters 
.head 4 -             Static Variables 
.head 4 -             Local variables 
.head 4 +             Actions 
.head 5 -             Set ccGraf.Graph.DataSource = "tbb"
.head 5 -             Set ccGraf.Graph.Background[0] = 7
.head 5 -             Set ccGraf.Graph.Background[1] = 7
.head 5 -             Set ccGraf.Graph.Background[6] = 7
.head 5 -             Set ccGraf.Graph.DrawMode = 2
.head 5 -             Call ccGraf.Draw()
.head 2 +             Window Parameters 
.head 3 -             Number: nMode
.head 2 +             Window Variables 
.head 3 -             Number: glub
.head 3 -             Number: nI
.head 3 -             String: ddd
.head 3 -             String: sdat
.head 3 -             String: sdat2
.head 3 -             String: bb1
.head 3 -             String: Z1
.head 3 -             String: Z234
.head 3 -             String: bb2
.head 3 -             String: bb3
.head 3 -             String: bb4
.head 3 -             String: ss
.head 3 -             String: sDat  !! для трансляции даты
.head 3 -             Date/Time: dtFdat
.head 3 -             String: bb
.head 3 -             Number: nRowCount
.head 3 -             String: XX
.head 3 -             Date/Time: dTmp
.head 3 -             Number: nTmp
.head 3 -             Date/Time: mDat1[*]
.head 3 -             Date/Time: mDat2[*]
.head 2 +             Message Actions 
.head 3 +             On SAM_Create
.head 4 -             Call WaitCursorOn()
.head 4 -             Call SalCenterWindow( hWndForm )
.head 4 -             Set obTable = TRUE
.head 4 -             Call SalDisableWindow( obTable )
.head 4 -             Call SalDisableWindow( obGraph )
.head 4 -  ! Call PrepareWindow( hWndForm )
.head 3 +             On SAM_CreateComplete
.head 4 -             Set glub=1
.head 4 -             Call SalSendMsg( tba, SAM_User, 0, 0 )
.head 4 -             Call SalHideWindow( ccGraf )       !!! GGGGGG это графики
.head 4 -             Call WaitCursorOff()
.head 1 +  Form Window: tab_din   !   Просмотр балансов c графиком  (MIK)
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр разрезов баланса банка 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.088"
.head 4 -  Top:    0.781"
.head 4 -  Width:  11.9"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.619"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162466F6E7453 697A650002003800 005461624C656674 4D617267696E0002
0020: 0030000054616243 757272656E740005 0054616232000054 6162426F74746F6D
0040: 4D617267696E0002 0030000054616250 616765436F756E74 0002003100005461
0060: 624C6162656C7300 2700202020C2FBE1 EEF0202020092020 20D2E0E1EBE8F6E0
0080: 20202009202020C3 F0E0F4E8EA202020 00005461624E616D 6573000F00546162
00A0: 3009546162310954 6162320000546162 52696768744D6172 67696E0002003000
00C0: 0054616244726177 5374796C65000B00 57696E3935537479 6C65000054616246
00E0: 6F726D5061676573 0003000909000054 6162546F704D6172 67696E0002003000
0100: 00546162466F6E74 4E616D65000E004D 532053616E732053 6572696600005461
0120: 62557365466F6E74 000700437573746F 6D00000000000000 0000000000000000
0140: 0000000000000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 4D01
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbPrev
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назад
.head 4 -  Window Location and Size
.head 5 -  Left:   9.733"
.head 5 -  Top:    0.81"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Prevrec.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If glub>2
.head 7 -  Set glub=glub-2
.head 7 -  Call SalSendMsg( tba, SAM_DoubleClick, 0, 0 )
.head 6 +  Else
.head 7 -  Set glub=1
.head 7 -  Call SalSendMsg( tba, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbNext
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вперед
.head 4 -  Window Location and Size
.head 5 -  Left:   9.733"
.head 5 -  Top:    1.452"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Nextrec.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tba, SAM_DoubleClick, 0, 0 )
.head 3 +  Pushbutton: pbQuit
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   9.733"
.head 5 -  Top:    4.095"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 3 +  Data Field: DAN
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 5461623109546162 3200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.56"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Child Table: tba
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623000000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.56"
.head 6 -  Width:  5.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 16535
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: BS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование..........................................................................................................................................................................
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 60
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  10.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTmp
.head 4 +  Message Actions
.head 5 +  On SAM_User
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If glub = 1 
.head 7 -  Call SalDisableWindow( pbPrev )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pbPrev )
.head 6 +  If glub = 5
.head 7 -  Call SalDisableWindow( pbNext )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pbNext )
.head 6 +  If glub=5
.head 7 +  If bb1='D'
.head 8 -  Set XX = SalStrMidX( bb4,1,3)
.head 8 -  Set sSql="
SELECT c.nls, t.lcv, c.nms FROM accounts c, tabval t
INTO :tba.BS, :tba.KV, :tba.NN
WHERE c.kv=t.kv AND c.nbs[2,4] = :XX and (c.nbs[1,1] = '6' or c.nbs[1,1] = '7') 
ORDER BY 1, 2" 
.head 7 +  Else
.head 8 -  Set sSql="
SELECT c.nls, t.lcv, c.nms FROM accounts c, tabval t
INTO :tba.BS, :tba.KV, :tba.NN
WHERE c.kv=t.kv AND c.nbs = :bb4 ORDER BY 1, 2" 
.head 6 +  Else
.head 7 +  If glub=1
.head 8 -  Set sSql= "SELECT nbs,name FROM Psk INTO :tba.BS,:tba.NN
    UNION  SELECT 'D',' ' FROM DUAL "  
.head 7 +  If glub=2
.head 8 +  If bb1 ='D'
.head 9 -  Set sSql= "SELECT 'D'||substr(nbs,2,1), max(name) FROM Psr
 INTO :tba.BS,:tba.NN 
 WHERE substr(nbs,1,1)='6' or substr(nbs,1,1)='7' 
 GROUP BY 'D'||substr(nbs,2,1) "  
.head 8 +  Else
.head 9 -  Set sSql= "SELECT  nbs, name   FROM   Psr
 INTO :tba.BS,  :tba.NN 
 WHERE  nbs[1,1] = :bb1 " 
.head 7 +  If glub=3
.head 8 +  If bb1 ='D'
.head 9 -  Set XX = SalStrMidX( bb2,1,1)
.head 9 -  Set sSql= "SELECT 'D'||substr(nbs,2,2), max(name) FROM Psg
 INTO :tba.BS,:tba.NN 
 WHERE substr(nbs,1,2)='6"||XX||"' or substr(nbs,1,2)='7"||XX||"'
GROUP BY 'D'||substr(nbs,2,2)"
.head 8 +  Else
.head 9 -  Set sSql= "SELECT  nbs, name   FROM   Psg
 INTO :tba.BS,  :tba.NN 
 WHERE  nbs[1,2] = :bb2 " 
.head 7 +  If glub=4
.head 8 +  If bb1 ='D'
.head 9 -  Set XX = SalStrMidX( bb3,1,2)
.head 9 -  Set sSql= "SELECT 'D'||substr(nbs,2,3), max(name) FROM Psb
 INTO :tba.BS,:tba.NN 
 WHERE substr(nbs,1,3)='6"||XX||"' or substr(nbs,1,3)='7"||XX||"'
GROUP BY 'D'||substr(nbs,2,3)"  
.head 8 +  Else
.head 9 -  Set sSql= "SELECT  nbs, name   FROM   Psb
 INTO :tba.BS,  :tba.NN 
 WHERE  nbs[1,3] = :bb3  " 
.head 7 -  Set sSql=sSql || " ORDER BY 1"
.head 6 -  Call SalTblPopulate( tba, hSqlAux(), T(sSql), TBL_FillAll )
.head 6 -  ! Call SalTblSetFocusRow( tba, 0 )
.head 6 -  Call SalWaitCursor( FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 +  If glub < 5
.head 7 +  If glub=1
.head 8 -  Set bb1=SalStrMidX( tba.BS, 0, 1 )
.head 7 +  If glub=2
.head 8 -  Set bb2=SalStrMidX( tba.BS, 0, 2 )
.head 7 +  If glub=3
.head 8 -  Set bb3=SalStrMidX( tba.BS, 0, 3)
.head 7 +  If glub=4
.head 8 -  Set bb4=tba.BS
.head 7 -  Set glub=glub+1
.head 7 -  Call SalSendMsg( tba, SAM_User, 0, 0 )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SalStrMidX(BS,0,1)='D'
.head 7 +  If glub=1  !! D
.head 8 -  Set NN =' Чистый доход (6-7)'
.head 7 +  ! If glub=2  !! Dx
.head 8 -             Set XX=SalStrMidX(BS,1,1)
.head 8 -             Call SqlPrepareAndExecute( hSql(), "
SELECT name into :NN 
FROM Psr WHERE substr(nbs,1,2)='6"||XX||"' or substr(nbs,1,2)='7"||XX||"'")
.head 8 -             Call SqlFetchNext( hSql(), nI )
.head 7 +  ! If glub=3  !! Dxx
.head 8 -             Set XX=SalStrMidX(BS,1,2)
.head 8 -             Call SqlPrepareAndExecute( hSql(), "SELECT name into :NN 
FROM Psg  WHERE substr(nbs,1,3)='6"||XX||"' or substr(nbs,1,3)='7"||XX||"'")
.head 8 -             Call SqlFetchNext( hSql(), nI )
.head 7 +  ! If glub=4  !! Dxxx
.head 8 -             Set XX=SalStrMidX(BS,1,3)
.head 8 -             Call SqlPrepareAndExecute( hSql(), "SELECT name into :NN 
FROM Psb  WHERE nbs='6"||XX||"' or nbs='7"||XX||"'")
.head 8 -             Call SqlFetchNext( hSql(), nI )
.head 5 +  On SAM_Create
.head 6 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 7 -  Call SalTblSetColumnFlags( BS, COL_RightJustify, TRUE )
.head 3 +  Child Table: tbb
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.952"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.929"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 16535
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Дебет
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DOS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Дебет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Кредит
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты-Кредит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AKT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Активы
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AKT1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Активы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PAS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Пассивы
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PAS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатки-Пассивы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SAL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сальдо
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SAL1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сальдо
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set SAL1 =  PAS1  + AKT1
.head 6 -  Set DAT = SalFmtFormatDateTime( dTmp, 'dd-MM-yyyy' )
.head 6 -  Set DOS = SalNumberRound ( DOS1 / 1000 )
.head 6 -  Set KOS = SalNumberRound ( KOS1 / 1000 )
.head 6 -  Set AKT = SalNumberRound ( AKT1 / 1000 )
.head 6 -  Set PAS = SalNumberRound ( PAS1 / 1000 )
.head 6 -  Set SAL = SalNumberRound ( SAL1 / 1000 )
.head 6 -  Set nRowCount = nRowCount + 1
.head 5 +  On SAM_Create
.head 6 -  Set nRowCount = 0
.head 5 -  On SAM_CountRows
.head 3 +  Custom Control: ccGraf                !!! GGGGGG это графики
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000534F 5552434500040074
0020: 6262000047726170 6853706563004C19 9001000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0180: 0000000002000000 3200000000000000 0300000001000000 0000000000000000
01A0: 0100000002000000 0300000041726961 6C20437972000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000000000 0000000000000000 0000000000000000 0000000041726961
0200: 6C20437972000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0240: 0000000000000000 0000000041726961 6C20437972000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000000000 0000000000000000 0000000000000000 0000000041726961
02A0: 6C20437972000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02E0: 0000000000000000 00000000C8000000 9600000064000000 6400000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0360: 0000000006000000 0300000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0560: 0000000000000000 0000000000000000 0000000001000000 0100000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000000000000000 0000000000000000 0000000000000000 0500000005000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000000000 0000000000000000 0000000000000000 0000000032000000
0640: 000000001E000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
06A0: 6400000001000000 0100000001000000 0100000001000000 0000000000000000
06C0: 0000000000000000 0100000000000000 0000000000000000 0000000000000000
06E0: 0000000000000000 0000000000000000 0000000074626200 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0740: 0000000005000000 444F530000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 4B4F530000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 414B540000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 5041530000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 53414C0000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D80: 0000000000000000 CEE12EC4E5E1E5F2 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 CEE12ECAF0E5E4E8
0DE0: F200000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 D1E0EBFCE4EE2DC0 EAF2000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 D1E0EBFCE4EE2DCF
0E80: E0F1000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 D1E0EBFCE4EE2028 C0EAF22BCFE0F129 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 4441540000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14A0: 0100000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
15A0: 0000000000000000 07000000FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
15C0: FFFFFFFF10000000 1000000010000000 1000000010000000 1000000010000000
15E0: 1000000010000000 1000000010000000 1000000010000000 1000000000000000
1600: 0000000000000000 0000000001000000 0000000000000000 0000000001000000
1620: 0100000000000000 0000000000000000 0000000000000000 0000000000000000
1640: FFFFFFFF00000000 FFFFFFFF00000000 0000000000000000 0000000000000000
1660: 0000000000000000 0000000047524150 485050522E484C50 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000001000000 0000000000000000
1880: 0000000000000000 0000000000000000 0000000000000000 0000000001000000
18A0: 477261706820436F 6E74726F6C000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0100000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1940: 0000000000000000 0F00000000000000 0800000064000000 1400000014000000
1960: 0100000001000000 0000000000000000 0000000000000000 0100000000495445
1980: 4D001400444F532C 4B4F532C414B542C 5041532C53414C00 0000000000000000
19A0: 00
.enddata
.data CLASSPROPSSIZE
0000: A119
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGraph
.head 4 -  Property Template:
.head 4 -  Class DLL Name: qgphi11.dll
.head 4 -  Display Settings
.head 5 -  DLL Name: qgphi11.dll
.head 5 -  MS Windows Class Name: cQuickGraph
.head 5 -  Style:  0x00000000
.head 5 -  ExStyle:  0x00000000
.head 5 -  Title: График
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.952"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.929"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Etched Border? Yes
.head 5 -  Hollow? No
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -             Call SalMessageBox("!", "!", MB_Ok)
.head 6 -             Call ccGraf.Reset(  )
.head 5 +  ! On WM_Size
.head 6 -             Call SalGetWindowSize ( hWndForm, nWidth, nHeight )
.head 6 -             Call SalSetWindowSize ( ccGraf,   nWidth , nHeight )
.head 6 -  ! Call SalSetWindowLoc ( ccGraf, nWidth, nHeight )
.head 6 -  ! Call SalSetWindowSize ( ccGraf, nWidth, nHeight )
.head 3 +  List Box: lbDat1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.783"
.head 5 -  Top:    0.821"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.786"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SqlPrepareAndExecute( hSql(), 
  T("SELECT fdat INTO :dTmp FROM saldoa GROUP BY fdat ORDER BY fdat ") )
.head 6 -  Set nTmp=0
.head 6 -  Call SalArraySetUpperBound( mDat1,1,-1 )
.head 6 -  Call SalListClear( hWndItem )
.head 6 +  While SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalListAdd( hWndItem, SalFmtFormatDateTime( dTmp, 'dd-MM-yyyy' ) )
.head 7 -  Set mDat1[nTmp] = dTmp
.head 7 -  Set nTmp=nTmp+1
.head 6 -  Call SalListSetSelect( hWndItem, 0 )
.head 6 -  Call SalSendMsg(hWndItem,SAM_Click,0,0)
.head 5 +  On SAM_Click
.head 6 -  Set nTmp=SalListQuerySelection( hWndItem )
.head 6 +  If nTmp>=0
.head 7 -  Set sdat = SalFmtFormatDateTime( mDat1[nTmp], 'MM-dd-yyyy' ) 
.head 6 +  Else
.head 7 -  Set sdat = GetBankDateEx()
.head 3 +  List Box: lbDat2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.483"
.head 5 -  Top:    0.81"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.786"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SqlPrepareAndExecute( hSql(), 
  T("SELECT fdat INTO :dTmp FROM saldoa GROUP BY fdat ORDER BY fdat DESC") )
.head 6 -  Set nTmp=0
.head 6 -  Call SalArraySetUpperBound( mDat2,1,-1 )
.head 6 -  Call SalListClear( hWndItem )
.head 6 +  While SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalListAdd( hWndItem, SalFmtFormatDateTime( dTmp, 'dd-MM-yyyy' ) )
.head 7 -  Set mDat2[nTmp] = dTmp
.head 7 -  Set nTmp=nTmp+1
.head 6 -  Call SalListSetSelect( hWndItem, 0 )
.head 6 -  Call SalSendMsg(hWndItem,SAM_Click,0,0)
.head 5 +  On SAM_Click
.head 6 -  Set nTmp=SalListQuerySelection( hWndItem )
.head 6 +  If nTmp>=0
.head 7 -  Set sdat2 = SalFmtFormatDateTime( mDat2[nTmp], 'MM-dd-yyyy' ) 
.head 6 +  Else
.head 7 -  Set sdat2 = GetBankDateEx()
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 39000
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.683"
.head 5 -  Top:    0.56"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: С
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 39001
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.783"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: По
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623000000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 39002
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.483"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 39003
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.333"
.head 5 -  Top:    0.56"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: Redraw
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set ccGraf.Graph.DataSource = "tbb"
.head 5 -  Set ccGraf.Graph.Background[0] = 7
.head 5 -  Set ccGraf.Graph.Background[1] = 7
.head 5 -  Set ccGraf.Graph.Background[6] = 7
.head 5 -  Set ccGraf.Graph.DrawMode = 2
.head 5 -  Call ccGraf.Draw()
.head 3 +  Function: TabActivateStart
.head 4 -  Description: Indicates that a tab has been activated.
This function is called before the child windows have been shown
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nTab=1 or nTab=2
.head 6 -  Set DAN=tba.BS || ": " || tba.KV || ": " || tba.NN
.head 6 -  Set Z1=SalStrMidX( tba.BS, 0, 1)
.head 6 -  Set Z234=SalStrMidX( tba.BS, 1, glub-1)
.head 6 +  If glub<5
.head 7 -  Set bb=SalStrMidX( tba.BS, 0, glub ) 
.head 7 -  Set sSql="SELECT c.fdat, 
 - SUM ( gl.p_icurval ( a.kv, c.dos, c.fdat) )/100, 
   SUM ( gl.p_icurval ( a.kv, c.kos, c.fdat) )/100,
   SUM ( gl.p_icurval ( a.kv, c.ostf-c.dos+c.kos, c.fdat) * 
           DECODE( SIGN(c.ostf-c.dos+c.kos),-1,1,0) ) /100,
   SUM ( gl.p_icurval (a.kv, c.ostf-c.dos+c.kos, c.fdat)  * 
           DECODE( SIGN(c.ostf-c.dos+c.kos), 1,1,0) ) /100
INTO :dTmp, :tbb.DOS1, :tbb.KOS1, :tbb.AKT1, :tbb.PAS1  
FROM saldoa c, accounts a 
WHERE c.fdat >= :sdat AND c.fdat <= :sdat2 AND a.acc=c.acc AND "
.head 7 +  If glub=1
.head 8 -  Set sSql=sSql|| IifS( Z1='D',
" substr(a.nbs,1,1) in ('6','7') "," substr(a.nbs,1,1)=:bb ")
.head 7 +  If glub=2
.head 8 -  Set sSql=sSql || IifS(Z1='D',
" substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,1)='"||Z234||"'", 
" substr(a.nbs,1,2)=:bb ")
.head 7 +  If glub=3
.head 8 -  Set sSql=sSql || IifS(Z1='D',
" substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,2)='"||Z234||"'",
" substr(a.nbs,1,3)=:bb ")
.head 7 +  If glub=4
.head 8 -  Set sSql=sSql ||IifS(Z1='D',
"substr(a.nbs,1,1) in ('6','7') and substr(a.nbs,2,3)='"||Z234||"'",
 " a.nbs=:bb ")
.head 7 -  Set sSql=sSql || " GROUP BY c.fdat ORDER BY c.fdat " 
.head 6 +  Else
.head 7 -  Set sSql="SELECT c.fdat, -c.dos/100,  c.kos/100,
   DECODE(SIGN(c.ostf-c.dos+c.kos),-1,(c.ostf-c.dos+c.kos),0)/100,
   DECODE(SIGN(c.ostf-c.dos+c.kos), 1,(c.ostf-c.dos+c.kos),0)/100
   INTO :dTmp, :tbb.DOS1, :tbb.KOS1, :tbb.AKT1, :tbb.PAS1 
   FROM saldoa c, accounts a, tabval t 
   WHERE c.fdat >= :sdat AND c.fdat <= :sdat2 AND 
         a.acc=c.acc AND a.nls=:tba.BS AND a.kv=t.kv AND t.lcv=:tba.KV  
   ORDER BY c.fdat "
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set nRowCount = 0
.head 6 +  If nTab=1
.head 7 -  Set sSql=sSql||'DESC'
.head 6 -  Call SalTblPopulate( tbb, hSql(), T(sSql), TBL_FillAll )
.head 6 +  If nRowCount = 0
.head 7 -  Call SalDisableWindow( pbNext )
.head 6 -  If nRowCount > 1
.head 6 -  Call SalWaitCursor( FALSE)
.head 5 +  If nTab=2
.head 6 -  Call Redraw()
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 2 +  Window Variables
.head 3 -  Number: glub
.head 3 -  Number: nWidth
.head 3 -  Number: nHeight
.head 3 -  Number: nI
.head 3 -  String: ddd
.head 3 -  String: sdat
.head 3 -  String: sdat2
.head 3 -  String: bb1
.head 3 -  String: Z1
.head 3 -  String: Z234
.head 3 -  String: bb2
.head 3 -  String: bb3
.head 3 -  String: bb4
.head 3 -  String: sSql
.head 3 -  String: sDat  !! для трансляции даты
.head 3 -  Date/Time: dtFdat
.head 3 -  String: bb
.head 3 -  Number: nRowCount
.head 3 -  String: XX
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nTmp
.head 3 -  Date/Time: mDat1[*]
.head 3 -  Date/Time: mDat2[*]
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call WaitCursorOn()
.head 4 -  Call PrepareWindowEx( hWndForm  )
.head 3 +  On SAM_CreateComplete
.head 4 -  Set glub=1
.head 4 -  Call SalSendMsg( tba, SAM_User, 0, 0 )
.head 4 -  Call SalHideWindow( ccGraf )       !!! GGGGGG это графики
.head 4 -  Call WaitCursorOff()
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize ( hWndForm, nWidth, nHeight )
.head 4 -  Call SalSetWindowSize ( ccGraf, nWidth * 0.9, nHeight * 0.7 )
.head 4 -  Call SalSetWindowSize ( tbb, nWidth * 0.9, nHeight * 0.7 )
.head 4 -  Call SalGetWindowSize ( DAN, nTmp, nTmp )
.head 4 -  Call SalSetWindowSize ( DAN, nWidth * 0.9, nTmp )
.head 3 +  On SAM_Help
.head 4 -  Call SalLoadApp ( "WinHlp32.exe", "-wWin1 -i Fi_011 " || GetHelpFile () )
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation of  function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' ShowDin(hWndMDI,'||SalNumberToStrX(nMode,0)||')')
