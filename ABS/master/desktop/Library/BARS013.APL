Application Description: Оплата SWIFT-сообщений  (MIK 12-09-2000)
		Доработка распределения (DEN permanent)
		Формирование реестра ОБ (DEN 22-11-2001)
		Просмотр архива сообщ.  (DEN 23-11-2001)
		Перераспределение сооб. (DEN 29-01-2002)
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000003000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000000100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFF000000 0000000000CD0300 0038010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000000001 8002000200000000
0080: 000000000000002C 0000000000000001 000000FFFFFFFFFF FFFFFFF8FFFFFFE2
00A0: FFFFFF4B0000004B 0000001F040000A7 0200000000000000 000000030000000F
00C0: 4170706C69636174 696F6E4974656D12 496E7465726E616C 2046756E6374696F
00E0: 6E730C4261727330 31335F496E697400 000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533031332E 415044175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: GENTBLD.APL
		File Include: GENTBLS.APL
		File Include: GENTBLF.APL
		File Include: Docwis6.apl
		File Include: Genlabel.apl
		File Include: vtsplit.apl
		File Include: Winapi.apl
		File Include: Gentimer.apl
		File Include: Genctl.apl
		File Include: xsalspl.apl
		File Include: xsalcpt.apl
		File Include: vtcal.apl
		File Include: vtmeter.apl
		Dynalib: DOCVIEW.APD
		Dynalib: custacnt.apd
		Dynalib: NsiApi.apd
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: dd.mm.yyyy
			Date/Time: dd-MM-yyyy
			Number: ########000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				!
				String: DocWMesNomerPachki = 'Пачка №'
				Number: BICDirectoryRecLen = 856
				String: ApdNum   =  '13'
				String: ApdVer   =  '11'
				! История изменений:
				! 02 25-06-03  MIK     Допустима отправка свифтовок в СЕП
				! 03 05-01-06  MIK     Переделал отправку свифтовок в СЕП или ВПС с новым подходом к записи БИС
				! 04 27-02-06  MIK     В разборе свифтовок свифтовые теги писала, а простые - нет
				! 05 03-03-06  MIK     Выполняется подбор реквизитов получателя по ф-ии p_getrcvr
				! 06 24-03-06  MIK     Захайдил кнопку "вернуть" из подбора коррсчета для чужих документов
				! 07 07-04-06  MIK     Перенес вызов ф-ии определения реквизитов получателя в форму ввода докум 
				! 08 03-07-06  MIK     Исключил передачу СВИФТОВОК в СЕП НБУ
				! 10 04-09-12  MIK     При передаче свифтовок в ВПС терялись допреквизиты
				! 11 07-12-12  MIK     По параметру SWTDVCUR='1' встан. дати валютування = gl.bd при розборі свіфтовок.
		Resources
		Variables
.data RESOURCE 0 0 1 3339356269
0000: 1E00000010000000 0000000000000000 020080010000003B 0100E00304000000
0020: FF3F
.enddata
			Boolean: fInitLib		! Флаг инициализации библиотеки
			Boolean: bStart
			Boolean: bNBUBANK
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin5
			Window Handle: hWin6
			Window Handle: hWin7
			Window Handle: hWin8
			Window Handle: hWin9
			Window Handle: hWin10
			Window Handle: hWin14
			Window Handle: hWin15
			Window Handle: hWin16
			Window Handle: hWin17
			Window Handle: hWin18
			Window Handle: hWin19
			Window Handle: hWin20
			Number: nFetchRes
			!
			Boolean: fKeepAttributes
			String: strLast_TT
			String: strLast_Nazn
			String: strLast_Dp[*]
		Internal Functions
			Function: ShowApdVersion
				Description:
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			Function: Bars013_Init
				Description: Инициализация лингвистической таблицы и прочего
						для библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					!
					String: strFileName
				Actions
					If NOT fInitLib
						! Признак НБУ
						Set bNBUBANK = GetGlobalOptionEx('NBUBANK') = 1
						!
						Set bStaticsAsWindows = TRUE
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars013.lng"
						!
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							! error text
							Call CurrentLangTable.AddAtom('cTErr', 'Ошибка!')
							! constants
							Call CurrentLangTable.AddAtom('cTAt',  'Внимание!')
							Call CurrentLangTable.AddAtom('cTExec','Выполнено!')
							Call CurrentLangTable.AddAtom('cTQuestion','Вопрос')
							Call CurrentLangTable.AddAtom('cTMess','Сообщение')
							Call CurrentLangTable.AddAtom('cTMessBlockFunction','Работа функции временно заблокирована')
							! ====================================================
							! dlg_PickUpDoc
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.cTWndTitle','Подбор документа для квитовки...')
							! column
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colRef','Референс')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colVDat','Дата~валютир.')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colNlsA','Счет А')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colSum','Сумма')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colCcy','Валюта')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colNlsB','Cчет Б')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colDK','Д/К')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.tbl.colNazn','Назначение платежа')
							! button strTip
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.cBTipViewDoc','Просмотреть реквизиты документа')
							Call CurrentLangTable.AddAtom('dlg_PickUpDoc.cBTipPreFilter','Включить/выключить фильтр по сумме и счетам')
							! ====================================================
							! dlg_PickUpTT
							Call CurrentLangTable.AddAtom('dlg_PickUpTT.cTWndTitle','Выберите банковскую операцию...')
							! column
							Call CurrentLangTable.AddAtom('dlg_PickUpTT.tblSWTT.colTT','Код~оп.')
							Call CurrentLangTable.AddAtom('dlg_PickUpTT.tblSWTT.colTTName','Наименование')
							! button
							Call CurrentLangTable.AddAtom('dlg_PickUpTT.pbOk','Выбрать')
							Call CurrentLangTable.AddAtom('dlg_PickUpTT.pbCancel','Отменить')
							! ====================================================
							! dlg_PickUpUser
							Call CurrentLangTable.AddAtom('dlg_PickUpUser.cTWndTitle','Выберите пользователя...')
							! column
							Call CurrentLangTable.AddAtom('dlg_PickUpUser.tblSWUsers.colId','Код~пол.')
							Call CurrentLangTable.AddAtom('dlg_PickUpUser.tblSWUsers.colName','Ф.И.О.')
							! button
							Call CurrentLangTable.AddAtom('dlg_PickUpUser.pbOk','Выбрать')
							Call CurrentLangTable.AddAtom('dlg_PickUpUser.pbCancel','Отменить')
							! ====================================================
							! dlgDocMatch
							Call CurrentLangTable.AddAtom('dlgDocMatch.cTWndTitle','Подбор документов для "квитовки"')
							! ====================================================
							! dlgSelMsg
							Call CurrentLangTable.AddAtom('dlgSelMsg.cTWndTitle','Выбор сообщения...')
							! column
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwRef', 'Реф~сообщ.')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwMT', 'Тип~сообщ.')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwIO', 'Направ.~сообщ.')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwTrn', 'SWIFT-реф.~сообщ.')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwSender', 'Отправитель')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwReceiver', 'Получатель')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwValueDate','Дата~валют.')
							Call CurrentLangTable.AddAtom('dlgSelMsg.tbl.colSwDateIn', 'Дата~поступл.')
							! button strTip
							Call CurrentLangTable.AddAtom('dlgSelMsg.cBTipRefresh', 'Обновить')
							Call CurrentLangTable.AddAtom('dlgSelMsg.cBTipSearch','Поиск')
							Call CurrentLangTable.AddAtom('dlgSelMsg.cBTipFilter','Фильтр')
							Call CurrentLangTable.AddAtom('dlgSelMsg.cBTipViewDoc', 'Просмотр документа')
							Call CurrentLangTable.AddAtom('dlgSelMsg.cBTipOk','Выбрать сообщение')
							Call CurrentLangTable.AddAtom('dlgSelMsg.cBTipExit','Выйти')
							! ====================================================
							! frm_BIC_Import
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTWndTitle','Импорт справочника BIC')
							! field
							Call CurrentLangTable.AddAtom('frm_BIC_Import.bgFileName','Источник:')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cbInitialImport','Режим первичного импорта (добавление недостающих)')
							! button
							Call CurrentLangTable.AddAtom('frm_BIC_Import.pbBrowse','Искать...')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.pbAction','Старт')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.pbExit','Выйти')
							! error text
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTErrFileOpen','Невозможно открыть файл')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTErrFile','Файл')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTErrFileStrukt','неверной структуры!')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTErrImportBIC','Ошибка при импорте справочника BICов.')
							! message text
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTMessImportOK','Импорт справочника BIC успешно завершен')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTMessImportNO','Импорт справочника BIC отменен')
							! constants
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTBrowse','Выбор файла обновления справочника')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTStart','Старт')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTExit','Прервать')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTImport','Импорт')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTSaveBIC','Промежуточное сохранение импортированых BIC')
							Call CurrentLangTable.AddAtom('frm_BIC_Import.cTImpBIC','Завершение импорта BIC')
							! ====================================================
							! frm_SWIFTDoc
							Call CurrentLangTable.AddAtom('frm_SWIFTDoc.cTWndTitle','SWIFT сообщение')
							! button strTip
							Call CurrentLangTable.AddAtom('frm_SWIFTDoc.cBTipPrint','Распечатать документ')
							Call CurrentLangTable.AddAtom('frm_SWIFTDoc.cBTipExit','Закрыть окно просмотра')
							! ====================================================
							! frm_SWIFTMsgList
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTWndTitle','Реестр SWIFT сообщений')
							! columns
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colSwRef','N~п/п')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colIO','I/O')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colMT','MT')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colSwID','SWIFT~референс')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colSndr','Отправитель')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colSndrName','Наименование~отправителя')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colPayer','Плательщик')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colAmnt','Amount~(original)')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colAmntFace','Сумма')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colCcy','Валюта~(ISO)')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colRcvr','Получатель~(Банк)')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colRcvrName','Наименование~получателя')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colPayee','Получатель~средств')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colToAlien','Конечный~получатель')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colAccA','Acc-A')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colAccAName','Счета А (АБС)')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colAccB','Acc-B')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colAccBName','Счет Б (АБС)')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colDateIn','Принято')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colDateOut','Отправлено')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colDatePay','Обработано~в АБС')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colOwnerID','OwnerID')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colOwnerName','Поручено')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colOperID','OperID')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colOperName','Обработано')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.colRef','Референс~док-та в АБС')
							! button strTip
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cBTipShowExtraFields','Показать дополнительные поля таблицы')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cBTipFindMatch','"Сквитовать" с документом в АБС')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cBTipShowMsg','Просмотреть сообщение')
							! error text
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTErrFileOpen','Ошибка открытия файла')
							! constants
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTMess1','Вы действительно хотите связать SWIFT сообщение с выбраным документом?')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTMess2','Связано SWIFT сообщение')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTMess3','с платежным документом')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTStText','Отобрано записей')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTPrint','Печатается сообщение')
							Call CurrentLangTable.AddAtom('frm_SWIFTMsgList.cTDocSave','Документы сохранены в каталоге')
							! ====================================================
							! frm_SwMakeStmt
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.cTWndTitle','Формирование выписок (MT-950)')
							! field
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.bgPeriod','Период формирования выписки')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.bgCC1','Начало:')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.bgCC2','Окончание:')
							! columns
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.colBIC','BIC')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.colName','Наименование')
							! button
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.pbRefresh','Обновить')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.pbSelectAll','Выбрать всех')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.pbExecute','Сформировать')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.pbExit','Завершить')
							! message text
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.cTMess1','Обрабатывается контрагент')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.cTMess2','Формируется SWIFT выписка для контрагента')
							Call CurrentLangTable.AddAtom('frm_SwMakeStmt.cTMess3','Сформирована SWIFT выписка для контрагента')
							! ====================================================
							! frm_SwReestr
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTWndTitle','Формирование реестра сообщений')
							! field
							Call CurrentLangTable.AddAtom('frm_SwReestr.bgReeDate','Дата формирования:')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cbFull','Переформировать ВСЕ сообщения')
							! columns
							Call CurrentLangTable.AddAtom('frm_SwReestr.tblOblUpr.colRnk','Ид.~Управления')
							Call CurrentLangTable.AddAtom('frm_SwReestr.tblOblUpr.colName','Наименование')
							! button
							Call CurrentLangTable.AddAtom('frm_SwReestr.pbAll','Для ВСЕХ')
							Call CurrentLangTable.AddAtom('frm_SwReestr.pbSelected','Для ВЫБРАННЫХ')
							Call CurrentLangTable.AddAtom('frm_SwReestr.pbExit','Отменить')
							! button strTip
							Call CurrentLangTable.AddAtom('frm_SwReestr.cBTipEditDirs','Редактировать справочник каталогов реестра')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cBTipRefresh','Перечитать таблицу')
							! field strTip
							Call CurrentLangTable.AddAtom('frm_SwReestr.cFTip','Включить в выборку все сообщения за дату...')
							! error text
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTErrConnect','Не удается сформировать дополнительный коннект')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTErrFileCreate','Ошибка при создании файла')
							! message text
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMess1','В реестр будут включены все сообщения с начала дня!')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessDel','Удаление информации о телексовках для')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessForDat','за дату')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessOtm1','Отметка об обработке телексовку для')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessOtm2','Отметки о телексовках для')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessForKlient','Для клиента')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessForKlient1','cформировано')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessForKlient2','сообщений')
							Call CurrentLangTable.AddAtom('frm_SwReestr.cTMessForKlient3','нет сообщений для формирования')
							! ====================================================
							! frmDoc
							! error text
							Call CurrentLangTable.AddAtom('frmDoc.cTErrTT','Не описана операция')
							Call CurrentLangTable.AddAtom('frmDoc.cTErrKV','Не найдена валюта')
							! constants
							Call CurrentLangTable.AddAtom('frmDoc.cTMess','сообщение')
							Call CurrentLangTable.AddAtom('frmDoc.cTTitle','Ввод документа - Операция')
							! ====================================================
							! KS
							Call CurrentLangTable.AddAtom('KS.cTWndTitle','Справочние корсчетов банка (для SWIFT)')
							! columns
							Call CurrentLangTable.AddAtom('KS.colKv','Код~вал')
							Call CurrentLangTable.AddAtom('KS.colLcv','ISO~вал')
							Call CurrentLangTable.AddAtom('KS.colNls','Корр.счет')
							Call CurrentLangTable.AddAtom('KS.colBic','BIC')
							Call CurrentLangTable.AddAtom('KS.colBankName','Наименование банка')
							Call CurrentLangTable.AddAtom('KS.colVostroAcc','Счет VOSTRO')
							Call CurrentLangTable.AddAtom('KS.colNlsTran','Транзитный счет')
							! error text
							Call CurrentLangTable.AddAtom('KS.cTErrBIC','Незарегистрированный BIC код банка! (См. справочник банков SWIFT)')
							Call CurrentLangTable.AddAtom('KS.cTErrKV','Недопустимая валюта!')
							Call CurrentLangTable.AddAtom('KS.cTErrNLS','Незарегистрированный в АБС счет!')
							! ====================================================
							! splKS
							Call CurrentLangTable.AddAtom('splKS.cTWndTitle','Подбор коррсчета')
							! button strTip
							Call CurrentLangTable.AddAtom('splKS.cBTipReject','Вернуть отправителю')
							Call CurrentLangTable.AddAtom('splKS.cBTipRun', 'Оплатить отмеченные документы')
							Call CurrentLangTable.AddAtom('splKS.cBTipStop','Без коррсчета')
							Call CurrentLangTable.AddAtom('splKS.cBTipPap', 'Пассивные счета')
							Call CurrentLangTable.AddAtom('splKS.cBTipRun2', 'Оплатить документы с покрытием')
							! field
							Call CurrentLangTable.AddAtom('splKS.bgSumSelect','Отмечено:')
							! columns
							Call CurrentLangTable.AddAtom('splKS.tbl.InvS','Сумма~проплаты')
							Call CurrentLangTable.AddAtom('splKS.tbl.colRef','Реф док')
							Call CurrentLangTable.AddAtom('splKS.tbl.colTt','Тип~опер')
							Call CurrentLangTable.AddAtom('splKS.tbl.colMFOA','МФО~А')
							Call CurrentLangTable.AddAtom('splKS.tbl.colNLSA','Счет~ДТ')
							Call CurrentLangTable.AddAtom('splKS.tbl.colNLSB','Счёт КТ')
							Call CurrentLangTable.AddAtom('splKS.tbl.colLCVD','Вал.~ДТ')
							Call CurrentLangTable.AddAtom('splKS.tbl.colLCV','Вал.~КТ')
							Call CurrentLangTable.AddAtom('splKS.tbl.colDateV','Дата вал.')
							Call CurrentLangTable.AddAtom('splKS.tbl.colSs','Сумма~документа')
							Call CurrentLangTable.AddAtom('splKS.tbl.colBank','Код Банка~получателя')
							Call CurrentLangTable.AddAtom('splKS.tbl.colBankName','Наименование Банка~получателя')
							Call CurrentLangTable.AddAtom('splKS.tbl.colDK','Д/К')
							!
							Call CurrentLangTable.AddAtom('splKS.tbl2.colNLS','Номер~КС')
							Call CurrentLangTable.AddAtom('splKS.tbl2.colNMS','Номер~КС')
							Call CurrentLangTable.AddAtom('splKS.tbl2.colLCV','Вал.')
							Call CurrentLangTable.AddAtom('splKS.tbl2.colOstCs','Остаток~фактический')
							Call CurrentLangTable.AddAtom('splKS.tbl2.colOstBs','Остаток~плановый')
							Call CurrentLangTable.AddAtom('splKS.tbl2.colNosBic','Код Банка~корреспондента')
							! error text
							Call CurrentLangTable.AddAtom('splKS.cTErrPayBck','Ош. при вызове')
							Call CurrentLangTable.AddAtom('splKS.cTErrDataFormat','Неверный формат даты')
							Call CurrentLangTable.AddAtom('splKS.cTErrVDat','Недопустимая дата валютирования')
							Call CurrentLangTable.AddAtom('splKS.cTErrNazn','Невозможно изменить назначение платежа')
							Call CurrentLangTable.AddAtom('splKS.cTErrUpdate','Невозможно обновить')
							Call CurrentLangTable.AddAtom('splKS.cTErrVisa','Невозможно поставить визу')
							Call CurrentLangTable.AddAtom('splKS.cTErrExec','Невозможно выполнить')
							Call CurrentLangTable.AddAtom('splKS.cTErrDocVisa1','Не удалось подписать операцию!')
							Call CurrentLangTable.AddAtom('splKS.cTErrDocVisa2','Неверная подпись на документе')
							Call CurrentLangTable.AddAtom('splKS.cTErrDocVisa3','Неверная подпись предыдущей группы визирования')
							Call CurrentLangTable.AddAtom('splKS.cTErrKod','Нерасчетный код возврата!')
							Call CurrentLangTable.AddAtom('splKS.cTErr1','Ошибка')
							Call CurrentLangTable.AddAtom('splKS.cTErr2','Невозможно')
							Call CurrentLangTable.AddAtom('splKS.cTErrExecTT','выполнить проводку')
							Call CurrentLangTable.AddAtom('splKS.cTErrInsert','вставить')
							Call CurrentLangTable.AddAtom('splKS.cTErr21','проставить номер счета')
							Call CurrentLangTable.AddAtom('splKS.cTErr22','проставить дату валютирования')
							Call CurrentLangTable.AddAtom('splKS.cTErr23','поставить визу')
							Call CurrentLangTable.AddAtom('splKS.cTErr24','выполнить')
							Call CurrentLangTable.AddAtom('splKS.cTErrTT','Не описана транзакция')
							! message text
							Call CurrentLangTable.AddAtom('splKS.cTMessQuestionBack','Снять с подбора К/С ?')
							Call CurrentLangTable.AddAtom('splKS.cTMessBack','Вернуть')
							Call CurrentLangTable.AddAtom('splKS.cTMessBack1','плательщику')
							Call CurrentLangTable.AddAtom('splKS.cTMessBACKR','Повернено відділом коррахунків.')
							Call CurrentLangTable.AddAtom('splKS.cTMessBackKS','Возврат с подбора коррсчета.')
							Call CurrentLangTable.AddAtom('splKS.cTMessVisaGrp','Виза группы')
							Call CurrentLangTable.AddAtom('splKS.cTMessDocRef','Док Реф')
							Call CurrentLangTable.AddAtom('splKS.cTMessDocRefBack','возвращен')
							Call CurrentLangTable.AddAtom('splKS.cTMess1','Через')
							Call CurrentLangTable.AddAtom('splKS.cTMessSign1','Подпись предыдущей группы визирования неверна!')
							Call CurrentLangTable.AddAtom('splKS.cTMessSign2','Возвратить документ на повторное визирование?')
							Call CurrentLangTable.AddAtom('splKS.cTMessSign3','Возврат документа на повторное визирование')
							Call CurrentLangTable.AddAtom('splKS.cTMessKS','Подбор коррсчета')
							! ====================================================
							! splSwtMsgJrn
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTWndTitle','Журнал необработанных принятых/отправленных SWIFT сообщений')
							! button strTip
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipIns','Добавить новую запись')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipDel','Пометить/Снять пометку на удаление')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipRefresh','Перечитать записи в таблице')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipUpdate','Внести изменения в Базу Данных')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipSearch','Поиск строки по значению поля')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipFilter','Установить фильтр...')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipDetails','Обработать сообщение...')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipPrint','Печать содержания таблицы')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipExit','Завершить работу и выйти')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipSwitchIn','Выбрать входящие')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipSwitchOut','Выбрать исходящие')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipFindMatch','"Сквитовать" с документом в АБС')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipReject','Отказаться от распределенного сообщения(ий)')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipApplyToAll','Распределить все в таблице...')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipUserList','Редактировать список пользователей работающих со SWIFT')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cBTipTimerOn','Включить/выключить периодическое обновление записей')
							! columns
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cSwRef','№ п/п')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cMT','Тип')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cIoInd','Вх-~Исх')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cSndr','Отправитель')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cTrn','SWIFT~референция')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cRcvr','Получатель')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cPayer','Плательщик')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cPayee','Получатель')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cCurr','Вал')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cAmntFase','Сумма')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cAccD','Счет~Деб')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cAccK','Счет~Кре')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cDatI','Дата~поступл')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cDatV','Дата~валютир')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cUser','Исп.')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cId','Номер~исп')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cDatO','Дата~отправки')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cDatR','Дата~регистр')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.cDatP','Дата~оплаты')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.tbl.colToAlien','Кому...')
							! error text
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTErrFileOpen','Невозможно открыть файл')
							! message text
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessQuest1','Вы действительно хотите связать SWIFT сообщение с выбраным документом?')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMess11',    'Связано SWIFT сообщение')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMess12',    'с платежным документом')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessQuest2','Распределить все отобранные сообщения пользователю')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessReread','Перечитывание')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessRereadOff','включено!')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessRereadOn', 'выключено!')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessUserTT','Пользователю не даны права на банковские операции для SWIFT!')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTMessQuest3','Вы дейсвительно хотите поставить (снять) отметку об удалении?')
							! constants
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTWTitle',    'Обработка распределенных сообщений.')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTBeginFunc1','Начало работы функции "Обработка SWIFT сообщений".')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTBeginFunc2','Начало работы функции "Обработка/Распределение SWIFT сообщений".')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTEndFunc',   'Завершение работы функции "Обработка/Распределение SWIFT сообщений".')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTBack',      'Возврат на распределение сообщения')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTStText',    'Отобрано записей')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTSwR',       'Распредление SWIFT сообщений')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTSwD',       'Удаление SWIFT сообщений')
							Call CurrentLangTable.AddAtom('splSwtMsgJrn.cTFileSave',  'Документы сохранены в файле')
							! ====================================================
							! SWJ
							Call CurrentLangTable.AddAtom('SWJ.cTWndTitle','Журнал принятых(O) и отправленных (I) SWIFT- сообщений')
							! button strTip
							Call CurrentLangTable.AddAtom('SWJ.cBTipDetails','Оригинал SWIFT-сообщения /Одна стр.')
							Call CurrentLangTable.AddAtom('SWJ.cBTipAll','Оригинал SWIFT-сообщения /Все стр.')
							Call CurrentLangTable.AddAtom('SWJ.cBTipAbs','Документ в АБС (для первичных МТ)')
							! columns
							Call CurrentLangTable.AddAtom('SWJ.REF','Реф АБС')
							Call CurrentLangTable.AddAtom('SWJ.MT','MT')
							Call CurrentLangTable.AddAtom('SWJ.TRN','Реф сообщ')
							Call CurrentLangTable.AddAtom('SWJ.IO_IND','Тип')
							Call CurrentLangTable.AddAtom('SWJ.CURRENCY','Вал')
							Call CurrentLangTable.AddAtom('SWJ.SENDER','BIC отправ')
							Call CurrentLangTable.AddAtom('SWJ.RECEIVER','BIC получ')
							Call CurrentLangTable.AddAtom('SWJ.PAYER','Плательщик')
							Call CurrentLangTable.AddAtom('SWJ.PAYEE','Получатель')
							Call CurrentLangTable.AddAtom('SWJ.AMOUNT','Сумма')
							Call CurrentLangTable.AddAtom('SWJ.NLSD','Счет Д')
							Call CurrentLangTable.AddAtom('SWJ.NLSK','Счет К')
							Call CurrentLangTable.AddAtom('SWJ.DATE_IN','Дата вх')
							Call CurrentLangTable.AddAtom('SWJ.DATE_OUT','Дата исх')
							Call CurrentLangTable.AddAtom('SWJ.DATE_PAY','Дата опл')
							Call CurrentLangTable.AddAtom('SWJ.DATE_REC','Дата REC')
							Call CurrentLangTable.AddAtom('SWJ.VDAT','Дата VDAT')
							Call CurrentLangTable.AddAtom('SWJ.ID','ID')
							Call CurrentLangTable.AddAtom('SWJ.MTREF','MTREF')
							Call CurrentLangTable.AddAtom('SWJ.PAGE','PAGE')
							Call CurrentLangTable.AddAtom('SWJ.TRANSIT','TRANSIT')
							! ====================================================
							! SWJ1
							! columns
							Call CurrentLangTable.AddAtom('SWJ1.colN','№ пп')
							Call CurrentLangTable.AddAtom('SWJ1.colSeq', 'Sequence')
							Call CurrentLangTable.AddAtom('SWJ1.colTag', 'Поле')
							Call CurrentLangTable.AddAtom('SWJ1.colOpt', 'Опция')
							Call CurrentLangTable.AddAtom('SWJ1.colValue', 'Значение')
							! constants
							Call CurrentLangTable.AddAtom('SWJ1.cTWTitle', 'SWIFT - сообщение РЕФ')
							! ====================================================
							! frm_TBK
							Call CurrentLangTable.AddAtom('frm_TBK.cTWndTitle','Обработка выпискок')
							! button strTip
							Call CurrentLangTable.AddAtom('frm_TBK.cTBGetNosro', 'Указать НОСТРО счет...')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipSWDetails','Оригинал SWIFT-сообщения /Одна стр.')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipAbs','Документ в АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipKWT1','Посмотреть похожий Документ в АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipOPL','Обработать сообщение...')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipKWT','Сквитовать...')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipSetSrcMsg','Привязать сообщение')
							Call CurrentLangTable.AddAtom('frm_TBK.cBTipUnlinkSrcMsg','Отвязать сообщение')
							! Table: StmtHdr
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtRef','Реф.~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtSender', 'Отправитель~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtTrn', 'SWIFT реф.~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtPage', '№ страницы~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtAccNum', 'Номер счета~выписки (LORO)')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtCurrCode', 'Код валюты~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtCurrency', 'Валюта~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtBegDate', 'Нач. дата~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtEndDate', 'Кон. дата~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtRestIn', 'Входящий остаток~по выписке')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtDebitTurn', 'Дебетовые обороты~по выписке')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtCreditTurn', 'Кредитовые обороты~по выписке')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtRestOut', 'Исходящий остаток~по выписке')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtCntLines', 'Кол-во строк~в выписке')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colStmtState','Состояние~выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colNosAccCode', 'Ид. счета~в АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colNosAccNum', 'Номер счета~в АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colNosRestIn', 'Входящий остаток~на счете АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colNosRestOut', 'Исходящий остаток~на счете АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtHdr.colNosCntTrn', 'Кол-во операций~по счету АБС')
							! Table: StmtDetail
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colN', '№~п/п')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colVDate','Дата~валютирования~транзакции')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colDebitSum','Дебет')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colCreditSum','Кредит')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colSwTT','Тип~транзакции~SWIFT')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colMt','Тип~сообщения~SWIFT')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colTheirRef','Реф.~транзакции~SWIFT')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colDetail','Детали')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colSrcSwRef','Реф.~исходного~сообщения')
							Call CurrentLangTable.AddAtom('frm_TBK.StmtDetail.colDocRef','Реф~документа~АБС')
							! Table: Docs
							Call CurrentLangTable.AddAtom('frm_TBK.Docs.colFDat', 'Дата~валютирования~документа')
							Call CurrentLangTable.AddAtom('frm_TBK.Docs.colRef', 'Реф~документа')
							Call CurrentLangTable.AddAtom('frm_TBK.Docs.colDetail', 'Подробности~документа,~проведенного в АБС')
							! constants
							Call CurrentLangTable.AddAtom('frm_TBK.cTTmp1','НЕ НАЙДЕНО первичное МТ-сообщение')
							Call CurrentLangTable.AddAtom('frm_TBK.cTTmp2','БЕЗАКЦЕПТНО')
							Call CurrentLangTable.AddAtom('frm_TBK.cTKwt','Доквитован')
							Call CurrentLangTable.AddAtom('frm_TBK.cTKwtRef','Сквитован реф.')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMBLTitle','Детальные строки выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMBRTitle','Похожие документы в АБС')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMsgStmt', 'Обработка выписки')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMsgChgStmtState', 'Все строки выписки обработаны.~Установить статус "Выписка обработана"?')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMsgChgStmtStateEx', 'Не все строки выписки обработаны.~Отменить операцию изменения статуса выписки?')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMsgDocLink', 'Привязка документа')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMsgDocLinked', 'К документу привязано сообщение отличное от исходного сообщения строки выписки.~Выполнять привязку данного документа?')
							Call CurrentLangTable.AddAtom('frm_TBK.cTMsgUserConfirmDocLinkEx', 'Пользователь подтвердил привязку к строке выписки документа с отличным от строки выписки сообщением')
							! ====================================================
							! tblShowUBM
							Call CurrentLangTable.AddAtom('tblShowUBM.cTWndTitle','Просмотр неразобранных и необработанных SWIFT сообщений')
							! button strTip
							Call CurrentLangTable.AddAtom('tblShowUBM.cBTipReDistrib','Перераспределить сообщения на другого пользователя')
							! columns
							Call CurrentLangTable.AddAtom('tblShowUBM.colId','Код~пользователя')
							Call CurrentLangTable.AddAtom('tblShowUBM.colLog','Рабочее имя')
							Call CurrentLangTable.AddAtom('tblShowUBM.colFIO','ФИО')
							Call CurrentLangTable.AddAtom('tblShowUBM.colMes','Неразобранных сообщений~всего')
							! message text
							Call CurrentLangTable.AddAtom('tblShowUBM.cTMess1','Не выбрано ни одной записи!')
							! constants
							Call CurrentLangTable.AddAtom('tblShowUBM.cTPMess','Перераспределение необработанных сообщений')
							Call CurrentLangTable.AddAtom('tblShowUBM.cTItog','Итого')
							! ====================================================
							! tblWaitDK
							Call CurrentLangTable.AddAtom('tblWaitDK.cTWndTitle','Прогноз состояния НОСТРО-счетов')
							! columns
							Call CurrentLangTable.AddAtom('tblWaitDK.colNLS','Номер ЛС')
							Call CurrentLangTable.AddAtom('tblWaitDK.colNMS','Наименование ЛС')
							Call CurrentLangTable.AddAtom('tblWaitDK.colKV','Валюта')
							Call CurrentLangTable.AddAtom('tblWaitDK.colOst','Остаток')
							Call CurrentLangTable.AddAtom('tblWaitDK.colDob','Обороты~дебет')
							Call CurrentLangTable.AddAtom('tblWaitDK.colDog','Обороты~дебет~ожидаемые')
							Call CurrentLangTable.AddAtom('tblWaitDK.colKob','Обороты~кредит')
							Call CurrentLangTable.AddAtom('tblWaitDK.colKog','Обороты~кредит~ожидаемые')
							Call CurrentLangTable.AddAtom('tblWaitDK.colOstog','Ожидаемый~остаток')
							! ====================================================
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTWndTitle','Управление формированием сообщений')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTBeginFunc','Старт управления формированием сообщений')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTEndFunc','Завершение функции управления формированием сообщений')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTStText','')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipTimerOn','Обновлять состояние')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTMessReread','Обновление состояния ')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTMessRereadOn','включено')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTMessRereadOff','выключено')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTMsgUnLockMsg','Вы действительно хотите разблокировать сообщения?')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cTMsgRejectMsg','Вы действительно хотите удалить сообщения?')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipExit','Выход')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipDetail','Показать сообщение')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipFilter','Фильтр')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipRefresh','Обновить')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipAccept','Разблокировать')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipReturn','Удалить')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.cBTipUpdate','Изменить сообщение')
							! columns
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cSwRef','Реф.')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cMT','Тип')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cSndr','Отправитель')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cTrn','SWIFT~референция')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cRcvr','Получатель')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cCurr','Вал')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cAmnt','Сумма')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cDatV','Дата~валютир')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cDatR','Дата~регистр')
							Call CurrentLangTable.AddAtom('splLockSwtMsg.tbl.cDatP','Дата~оплаты')
							! ====================================================
							Call CurrentLangTable.AddAtom('frmMT.cTTitle','Ввод/редактирование сообщения [')
							Call CurrentLangTable.AddAtom('frmMT.cTMsgSaveMsgErr','Ошибка при сохранении сообщения')
							Call CurrentLangTable.AddAtom('frmMT.cTMsgSaveMsg','Сообщение сохранено')
							Call CurrentLangTable.AddAtom('frmMT.cBTipExit','Выход')
							Call CurrentLangTable.AddAtom('frmMT.cBTipChangeMT','Изменить тип сообщения')
							Call CurrentLangTable.AddAtom('frmMT.cBTipSaveMsg','Сохранить сообщение')
							Call CurrentLangTable.AddAtom('frmMT.cBTipNewMsg','Новое сообщение')
							Call CurrentLangTable.AddAtom('frmMT.cBTipHelp','Справочники')
							!
							Call CurrentLangTable.AddAtom('frmMT.tblFields.colSeq', 'Блок')
							Call CurrentLangTable.AddAtom('frmMT.tblFields.colSubSeq', 'Подблок')
							Call CurrentLangTable.AddAtom('frmMT.tblFields.colTag', 'Таг')
							Call CurrentLangTable.AddAtom('frmMT.tblFields.colOpt', 'Опц')
							Call CurrentLangTable.AddAtom('frmMT.tblFields.colValue', 'Значение')
							! ====================================================
							! tblChkLAU
							Call CurrentLangTable.AddAtom('tblChkLAU.cTWndTitle','Импортированные сообщения без аутентификации')
							! columns
							Call CurrentLangTable.AddAtom('tblChkLAU.cLAUAct','Разрешить')
							Call CurrentLangTable.AddAtom('tblChkLAU.cLAURej','Запретить')
							Call CurrentLangTable.AddAtom('tblChkLAU.cSwRef','SWREF')
							Call CurrentLangTable.AddAtom('tblChkLAU.cMT','MT')
							Call CurrentLangTable.AddAtom('tblChkLAU.cTrn','Реф сообщ')
							Call CurrentLangTable.AddAtom('tblChkLAU.cIO','Тип')
							Call CurrentLangTable.AddAtom('tblChkLAU.cCurr','Вал')
							Call CurrentLangTable.AddAtom('tblChkLAU.cSender','BIC отправ')
							Call CurrentLangTable.AddAtom('tblChkLAU.cReceiver','BIC получ')
							Call CurrentLangTable.AddAtom('tblChkLAU.cAmnt','Сумма')
							Call CurrentLangTable.AddAtom('tblChkLAU.cDateIn','Дата вх')
							! ====================================================
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTWndTitle','Список сообщений')
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTMsgNotChkGrp','Недоступна или не выбрана группа контроля')
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTMessQuestionVisa','Выполнять визирование выделенных сообщений?')
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTMessQuestionBack','Выполнять возврат выделенных сообщений?')
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTErrReason','Причина отказа не была выбрана или пуста! Повторите операцию.')
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTErrStorno','Ошибка сторнирования сообщений')
							Call CurrentLangTable.AddAtom('frmCheckMsg.cTErrEditDisabled','Редактирование запрещено, наложена виза')
							! tblCheckMsg
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cSwRef','Референс~сообщения')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cMT','Тип~сообщения')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cSndr','Отправитель')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cRcvr','Получатель')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cTrn','Референс~SWIFT')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cCurr','Валюта')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cAmnt','Сумма')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMsg.cDocRef','Референс~документа')
							! tblCheckMarks
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMarks.cChkGrp','Группа контроля')
							Call CurrentLangTable.AddAtom('frmCheckMsg.tblCheckMarks.cChkUsr','Исполнитель')
							! ====================================================
							! splSearchMsg
							Call CurrentLangTable.AddAtom('splSearchMsg.cTWndTitle','Поиск сообщений')
							Call CurrentLangTable.AddAtom('splSearchMsg.cTBegFunc','Вызвана функция: Поиск сообщений')
							Call CurrentLangTable.AddAtom('splSearchMsg.cTEndFunc','Завершена функция: Поиск сообщений')
							! ToolBar
							Call CurrentLangTable.AddAtom('splSearchMsg.cBTipRefresh','Обновить')
							Call CurrentLangTable.AddAtom('splSearchMsg.cBTipFilter','Фильтр')
							Call CurrentLangTable.AddAtom('splSearchMsg.cBTipDetail','Сообщение')
							Call CurrentLangTable.AddAtom('splSearchMsg.cBTipExit','Выход')
							! Columns
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cSwRef','Референс')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cMT','Тип~сообщения')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cIO','Вх/Исх')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cSndr','Отправитель')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cRcvr','Получатель')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cTrn','SWIFT~референс')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cCurr','Валюта')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cAmnt','Сумма')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cDatV','Дата~валютирования')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cDatO','Дата~оплаты')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cDatP','Дата~поступления')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cDatR','Дата~записи')
							Call CurrentLangTable.AddAtom('splSearchMsg.tbl.cDocRef','Реф~документа')
							! ====================================================
							! frm_SWBack
							Call CurrentLangTable.AddAtom('frm_SWBack.cTWndTitle','Удаление привязки документа')
							Call CurrentLangTable.AddAtom('frm_SWBack.bgRef','Референс:')
							Call CurrentLangTable.AddAtom('frm_SWBack.pbSearch','Искать')
							Call CurrentLangTable.AddAtom('frm_SWBack.pbBack','Отвязать')
							! message text
							Call CurrentLangTable.AddAtom('frm_SWBack.cTMessDocNotFound','Документ не найден!')
							Call CurrentLangTable.AddAtom('frm_SWBack.cTMessDel','Удалить привязку документа')
							Call CurrentLangTable.AddAtom('frm_SWBack.cTMessForMessage','к сообщению')
							Call CurrentLangTable.AddAtom('frm_SWBack.cTMessCommit','Удалена привязка документа')
							Call CurrentLangTable.AddAtom('frm_SWBack.cTMessRollback','Не удалось удалить привязку документа')
							! ====================================================
							! dlgSwtCov
							Call CurrentLangTable.AddAtom('dlgSwtCov.cTWndTitle','Формирование сообщения с покрытием')
						! Инициализация языковой таблицы ввода документов
						Call DocWisInit('frmDoc.')
						!
						Set fInitLib = TRUE
					Return fInitLib
			Function: SetStartFlag
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWin17
						Set bStart = FALSE
					Else
						Set bStart = TRUE
			Function: Sel013	! __exported
				Description: Bars013_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					String: strMT
				Actions
					If NOT fInitLib
						Set bStart = IifN(nMode=17, FALSE, TRUE)
					Call Bars013_Init()
					If NOT bStart AND nMode != 17
						! Call MessageInfo("Работа функции временно заблокирована")
						Call MessageInfo(CurrentLangTable.GetAtomTitle('cTMessBlockFunction'))
						Return FALSE
					Select Case nMode
						Case 0	! Разбор принятых SWIFT сообщений.
							If not IsWindow(hWin0)
								Set hWin0 = SalCreateWindow(splSwtMsgJrn, hWndParent, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop( hWin0 )
							Break
						Case 1	! Просмотр состояния НОСТРО-счетов.
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow(tblWaitDK, hWndParent)
							Else
								Call SalBringWindowToTop( hWin1 )
							Break
						Case 2	! Просмотр неразобранных и необработанных сообщений.
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(tblShowUBM, hWndParent)
							Else
								Call SalBringWindowToTop( hWin2 )
							Break
						Case 3	! Разбор/квитовка выписок.
						Case 13	! Разбор/квитовка выписок. (Сухова)
							If not IsWindow(hWin3)
								Set hWin3 = SalCreateWindow(frm_TBK, hWndParent, nPar, strPar01, strPar02 ) 
							Else
								Call SalBringWindowToTop( hWin3 )
							Break
						Case 4  ! Журнал сообщений
							If not IsWindow(hWin4)
								Set hWin4 = SalCreateWindow(SWJ, hWndParent, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop( hWin4 )
							Break
						Case 5  ! Справочник КС
							If not IsWindow(hWin5)
								Set hWin5 = SalCreateWindow(KS, hWndParent, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop( hWin5 )
							Break
						Case 6  ! Подбор КС
							If not IsWindow(hWin6)
								Set hWin6 = SalCreateWindow(splKS, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin6)
							Break
						Case 7	! Формирование реестра свифтовок
							If not IsWindow(hWin7)
								Set hWin7 = SalCreateWindow(frm_SwReestr, hWndParent)
							Else
								Call SalBringWindowToTop( hWin7 )
							Break
						Case 8  ! Просмотр архива свифтовок
							If not IsWindow(hWin8)
								Set hWin8 = SalCreateWindow(frm_SWIFTMsgList, hWndParent, strPar01, strPar02)
							Else
								Call SalBringWindowToTop( hWin8 )
							Break
						Case 9  ! Формирование SWIFT выписок.
							If not IsWindow(hWin9)
								Set hWin9 = SalCreateWindow(frm_SwMakeStmt, hWndParent)
							Else
								Call SalBringWindowToTop( hWin9 )
							Break
						Case 10	! Импорт SWIFT участников.
							If not IsWindow(hWin10)
								Set hWin10 = SalCreateWindow(frm_BIC_Import, hWndParent)
							Else
								Call SalBringWindowToTop( hWin10 )
							Break
						Case 14	! Ввод сообщения
							If not IsWindow(hWin14)
								Set hWin14 = SalCreateWindow(frmMT, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin14)
							Break
						Case 16	! Блокированные сообщения
							If not IsWindow(hWin16)
								Set hWin16 = SalCreateWindow(splLockSwtMsg, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin16)
							Break
						Case 17	! Импортированные сообщения без аутентификации
							If IsWindow(hWin0)  OR IsWindow(hWin1)  OR IsWindow(hWin2) OR IsWindow(hWin3) 
									OR IsWindow(hWin4)  OR IsWindow(hWin5)  OR IsWindow(hWin6) 
									OR IsWindow(hWin7)  OR IsWindow(hWin8)  OR IsWindow(hWin9) 
									OR IsWindow(hWin10) OR IsWindow(hWin14) OR IsWindow(hWin16)
								Call MessageInfo("Работа функции временно заблокирована")
								Break
							Set bStart = FALSE
							If not IsWindow(hWin17)
								Set hWin2 = SalCreateWindow(tblChkLAU, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin17)
							Break
						Case 18	! Визирование сообщений
							If not IsWindow(hWin18)
								Set hWin18 = SalCreateWindow(frmCheckMsg, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin18)
							Break
						Case 19	! Поиск сообщений
							If not IsWindow(hWin19)
								Set hWin19 = SalCreateWindow(splSearchMsg, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin19)
							Break
						Case 20	! BACK
							If not IsWindow(hWin20)
								Set hWin19 = SalCreateWindow(frm_SWBack, hWndParent)
							Else
								Call SalBringWindowToTop(hWin20)
							Break
						Default
							Break
			Function: SWIFTMsgView	! __exported
				Description: Просмотр SWIFT сообщения
				Returns
					Window Handle:
				Parameters
					Window Handle: hWndParent
					Number: nSwRef
				Static Variables
				Local variables
				Actions
					Call Bars013_Init()
					Return SalCreateWindow( frm_SWIFTDoc, hWndParent, nSwRef )
			Function: f_DecTo36
				Description: Преобразование 10тичных в 36-ричные
				Returns
					String:
				Parameters
					Number: nSrc
				Static Variables
				Local variables
					Number: nRmd
					Number: nDiv
					String: sMask
					String: sTrg
				Actions
					Set sMask = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'
					Set sTrg  = ''
					Set nDiv = nSrc
					While nDiv >= 36
						Set nRmd = SalNumberMod( nDiv, 36 )
						Set nDiv = (nDiv-nRmd)/36
						Set sTrg = SalStrMidX( sMask, nRmd, 1 ) || sTrg
					Set sTrg = SalStrMidX( sMask, nDiv, 1 ) || sTrg
					Return sTrg
			Function: f_36ToDec
				Description: Преобразование 36-ричных в 10тичные
				Returns
					Number:
				Parameters
					String: sSrc
				Static Variables
				Local variables
					String: sDiv
					String: sMask
					Number: nTrg
					Number: nI
				Actions
					Set sMask = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'
					Set nTrg  = 0
					Set nI    = 0
					Set sDiv = SalStrRightX( sSrc, 1 )
					Set sSrc = SalStrLeftX( sSrc, SalStrLength( sSrc )-1 )
					While sDiv
						Set nTrg = nTrg + SalStrScan( sMask, sDiv ) * SalNumberPower( 36, nI )
						Set nI = nI + 1
						Set sDiv = SalStrRightX( sSrc, 1 )
						Set sSrc = SalStrLeftX( sSrc, SalStrLength( sSrc )-1 )
					Return nTrg
			Function: SWIFTMsgSel	! __exported
				Description: Выбор SWIFT сообщения для обработки
				Returns
					Number:
				Parameters
					Window Handle: hWndParent
					String: strViewName
					String: strFilter
				Static Variables
				Local variables
					Number: nRetCode
				Actions
					Call Bars013_Init()
					Set nRetCode = SalModalDialog(dlgSelMsg, hWndParent, strViewName, strFilter)
					Return nRetCode
			Function: SwiftPrint	! __exported
				Description: Печать сообщения SWIFT
				Returns
					Boolean:
				Parameters
					Number: nSwRef
					String: strFileName
				Static Variables
				Local variables
					File Handle: hFile
					Number: nDummy
					Boolean: bExistFlag
				Actions
					! Проверяем наличие сообщения
					Set bExistFlag = FALSE
					If SqlPrepareAndExecute(hSql(), 'select 1 into :nDummy from sw_journal where swref = :nSwRef')
						While SqlFetchNext(hSql(), nFetchRes)
							If NOT bExistFlag
								If NOT SalFileOpen(hFile, strFileName, OF_Create | OF_Write | OF_Text | OF_Append)
									Return bExistFlag
								Set bExistFlag = TRUE
							! Файл открыли, пишем сообщение
							Call SalFilePutStr(hFile, '')
							Call SalFilePutStr(hFile, StrWinToDosX( Sw_MtAsTextEx( hSqlAux2(), nSwRef, NUMBER_Null ) ))
						If bExistFlag
							Call SalFileClose(hFile)
					Return bExistFlag
			Function: SignMT900
				Description: Печать сообщения SWIFT
				Returns
					Boolean:
				Parameters
					Number: nRef
					Number: nMt
				Static Variables
				Local variables
					Boolean: flOK
					Number: nUSERID2
					Number: nGrp
					String: strKeyId
					Number: nFlg
					String: sErrTxt
					String: sNextVisa
					: cDoc
						Class: cDoc
					Date/Time: dBankdate
					Number: nTmp
					String: sTt
					Number: nGrp900
					Number: nGrp910
					String: sVisaHex900
					String: sVisaHex910
				Actions
					! Проверяем наличие сообщения
					Set flOK = FALSE
					Call SqlPrepareAndExecute(hSql(), T(
							"SELECT nextvisagrp, tt FROM oper WHERE ref=:nRef INTO :sNextVisa, :sTt "))
					Call SqlFetchNext(hSql(), nFetchRes) 
					Set nGrp900 = SalStrToNumber(GetGlobalOption('SW_VISA900'))
					Set nGrp910 = SalStrToNumber(GetGlobalOption('SW_VISA910'))
					Set sVisaHex900 =  NumberToHexSX(nGrp900)
					Set sVisaHex910 =  NumberToHexSX(nGrp910)
					If nMt=900 and sNextVisa=sVisaHex900
						Call SqlPrepareAndExecute(hSql(), T(
								"SELECT flags[38,38] FROM tts WHERE tt='NOS' INTO :nFlg "))
						Call SqlFetchNext(hSql(), nFetchRes) 
						! Номер визы из параметров
						Set nGrp = nGrp900
						Set strKeyId = GetIdOper()
						Set nUSERID2 = GetUserId()
						Set dBankdate = GetBankDate()
						Set nTmp=nFlg+1
						Set flOK = TRUE
						Set sErrTxt = STRING_Null
						If not SqlPLSQLCommand(hSql(),"gl.PAY(2, nRef, dBankdate,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null)")
							Set sErrTxt = 'Не удалось доплатить реф№'||SalNumberToStrX(nRef, 0)
							Set flOK = FALSE
						If not SqlPLSQLCommand(hSql(),"CHK.PUT_NOS(nRef, nGrp)")
							Set sErrTxt = 'Не удалось проставить NextVisaGrp для реф№'||SalNumberToStrX(nRef, 0)
							Set flOK = FALSE
						If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! подпись 
							If NOT cDoc.SetDocR(nRef, TRUE)
								! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
								Set sErrTxt = 'Не удалось подписать операцию '||sTt||' референс '||Str(nRef)
								Set flOK = FALSE
							! Подписываем...
							Set strKeyId = GetIdOper( )
							If GetGlobalOptionEx('INTSIGN') = 2 		 !-- новая внутрення подпись
								If NOT cDoc.sDocInt(99,nGrp)
									Set sErrTxt = "Невозможно подписать документ (cDoc.sDocInt)"
									Set flOK = FALSE
								If NOT cDoc.PutVis(nGrp,nTmp)
									Set sErrTxt = "Невозможно подписать документ (cDoc.PutVis)"
									Set flOK = FALSE
							Else
								If NOT cDoc.sDocVisa()
									! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
									Set sErrTxt = 'Виза группы ' || SalNumberToStrX(nGrp,0) || ': Не удалось подписать операцию!'
									Set flOK = FALSE
								Call SqlSetLongBindDatatype(6, BLOB_BYTE)
								If NOT SqlPrepareAndExecute(hSql(), 
										"INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
										 VALUES(:nRef, sysdate, :nUSERID2, :nGrp, :nTmp, :strKeyId, :cDoc.m_lsSign)")
									! 'Невозможно выполнить INSERT INTO oper_visa'
									Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
									Set flOK = FALSE
						Else
							If NOT SqlPrepareAndExecute(hSql(), 
									"INSERT INTO oper_visa(ref, dat, userid, groupid, status) 
									 VALUES(:nRef, sysdate, :nUSERID2, :nGrp, :nTmp)")
								Set sErrTxt = 'Невозможно вставить в OPER_VISA'
								Set flOK = FALSE
						If flOK = FALSE
							Call MessageErrorEx(sErrTxt)
					If sTt!='NOS' and nMt=910 and sNextVisa=sVisaHex910
						Call SqlPrepareAndExecute(hSql(), T(
								"SELECT flags[38,38] FROM tts WHERE tt=:sTt INTO :nFlg "))
						Call SqlFetchNext(hSql(), nFetchRes) 
						Set nGrp = nGrp910
						Set strKeyId = GetIdOper()
						Set nUSERID2 = GetUserId()
						Set dBankdate = GetBankDate()
						Set nTmp=nFlg+1
						Set flOK = TRUE
						Set sErrTxt = STRING_Null
						If not SqlPLSQLCommand(hSql(),"gl.PAY(2, nRef, dBankdate,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null)")
							Set sErrTxt = 'Не удалось доплатить реф№'||SalNumberToStrX(nRef, 0)
							Set flOK = FALSE
						If not SqlPLSQLCommand(hSql(),"CHK.PUT_NOS(nRef, nGrp)")
							Set sErrTxt = 'Не удалось проставить NextVisaGrp для реф№'||SalNumberToStrX(nRef, 0)
							Set flOK = FALSE
						If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! подпись 
							If NOT cDoc.SetDocR(nRef, TRUE)
								! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
								Set sErrTxt = 'Не удалось подписать операцию '||sTt||' референс '||Str(nRef)
								Set flOK = FALSE
							! Подписываем...
							Set strKeyId = GetIdOper( )
							If GetGlobalOptionEx('INTSIGN') = 2 		 !-- новая внутрення подпись
								If NOT cDoc.sDocInt(99,nGrp)
									Set sErrTxt = "Невозможно подписать документ (cDoc.sDocInt)"
									Set flOK = FALSE
								If NOT cDoc.PutVis(nGrp,nTmp)
									Set sErrTxt = "Невозможно подписать документ (cDoc.PutVis)"
									Set flOK = FALSE
							Else
								If NOT cDoc.sDocVisa()
									! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
									Set sErrTxt = 'Виза группы ' || SalNumberToStrX(nGrp,0) || ': Не удалось подписать операцию!'
									Set flOK = FALSE
								Call SqlSetLongBindDatatype(6, BLOB_BYTE)
								If NOT SqlPrepareAndExecute(hSql(), 
										"INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
										 VALUES(:nRef, sysdate, :nUSERID2, :nGrp, :nTmp, :strKeyId, :cDoc.m_lsSign)")
									! 'Невозможно выполнить INSERT INTO oper_visa'
									Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
									Set flOK = FALSE
						Else
							If NOT SqlPrepareAndExecute(hSql(), 
									"INSERT INTO oper_visa(ref, dat, userid, groupid, status) 
									 VALUES(:nRef, sysdate, :nUSERID2, :nGrp, :nTmp)")
								Set sErrTxt = 'Невозможно вставить в OPER_VISA'
								Set flOK = FALSE
						If flOK = FALSE
							Call MessageErrorEx(sErrTxt)
					Return flOK
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 432033439
0000: 8D010000D4000000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F11003C00 000F63006C734572
0040: 726F7243006F6E74 726F6C3800C00000 0200000083020400 0000FFFF04040000
0060: 010D0000FE00FF03 0180220000000001 0000000A63476500 6E46696C74657274
0080: B000000004007702 00F601000F800100 00FE008D0400010D FD00FF2711000002
00A0: F700FF1F150000DC 000100FF7F018C80 2200020030000B63 474446FE69EC0004
00C0: 00190204000100FD 0093800100007F04 6300010D00FFFFCD 110002FD00FF3715
00E0: 0001F700FF1F
.enddata
			!
			Functional Class: cBicDirectoryRecord
				Description: Структура записи справочника BIC кодов
				Derived From
				Class Variables
				Instance Variables
					String: strFIMark
					String: strOperation
					String: strBIC
					String: strIName
					String: strBranchName
					String: strHQCity
					String: strSybInd
					String: strAddServices
					String: strExtInfo
					String: strAddress
					String: strLocation
					String: strCountry
					String: strPOBCode
					String: strPOBLocation
					String: strPOBCountry
					String: strNote
				Functions
					Function: setRecord
						Description: Разобрать запись по запчастям
						Returns
							Boolean:
						Parameters
							String: strSource
						Static Variables
						Local variables
						Actions
							Set strFIMark = SalStrLeftX(strSource, 2)
							If strFIMark != "FI"
								Return FALSE
							Set strOperation   = SalStrTrimX( SalStrMidX(strSource,   2,   1))
							Set strBIC         = SalStrTrimX( SalStrMidX(strSource,   3,  11))
							Set strIName       = SalStrTrimX( SalStrMidX(strSource,  14, 105))
							Set strBranchName  = SalStrTrimX( SalStrMidX(strSource, 119,  70))
							Set strHQCity      = SalStrTrimX( SalStrMidX(strSource, 189,  35))
							Set strSybInd      = SalStrTrimX( SalStrMidX(strSource, 224,   4))
							Set strAddServices = SalStrTrimX( SalStrMidX(strSource, 228,  60))
							Set strExtInfo     = SalStrTrimX( SalStrMidX(strSource, 288,  35))
							Set strAddress     = SalStrTrimX( SalStrMidX(strSource, 323, 140))
							Set strLocation    = SalStrTrimX( SalStrMidX(strSource, 463, 105))
							Set strCountry     = SalStrTrimX( SalStrMidX(strSource, 568,  70))
							Set strPOBCode     = SalStrTrimX( SalStrMidX(strSource, 638,  35))
							Set strPOBLocation = SalStrTrimX( SalStrMidX(strSource, 673, 105))
							Set strPOBCountry  = SalStrTrimX( SalStrMidX(strSource, 778,  70))
							Set strNote        = SalStrTrimX( SalStrMidX(strSource, 848,   8))
							Return TRUE
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbChilds
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cXSalVSplitterInvisible
		Application Actions
	Form Window: splSwtMsgJrn		! 01
.data CLASSPROPSSIZE
0000: 3A00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 000000000000C0C0 C000FFFFFF008080
0020: 8000020000000000 0000010000000100 0000000000000001 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
		Class: cSplitterWindow
		Property Template:
		Class DLL Name:
		Title: Журнал необработанных принятых/отправленных SWIFT сообщений
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.146"
				Width:  10.0"
				Width Editable? Class Default
				Height: 4.893"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: каталог проимпортированных SWIFT сообщений
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.429"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipIns')
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Insert, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipDel')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Delete, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.933"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipRefresh')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipUpdate')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Update, 0, 0)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Line
					Resource Id: 44928
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.557"
						Begin Y:  -0.01"
						End X:  4.557"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSearch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipSearch')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Search, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipFilter')
						On SAM_Click
							If SetQueryFilter(tbl.F)
								Call SalPostMsg(hWndForm.splSwtMsgJrn.tbl, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.933"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipDetails')
						On SAM_Click
							Call SalSendMsg(hWndForm.splSwtMsgJrn.tbl, UM_DoubleClick, 0, 0)
				Pushbutton: pbPrint
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipPrint')
						On SAM_Click
							Call SalSendMsg(hWndForm.splSwtMsgJrn.tbl, UM_Print, 0, 0)
				Line
					Resource Id: 44929
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  3.917"
						Begin Y:  -0.01"
						End X:  3.917"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Esc
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipExit')
						On SAM_Click
							Call SalSendMsg( hWndForm, UM_Close, 0, 0)
				Line
					Resource Id: 44930
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  1.9"
						Begin Y:  -0.01"
						End X:  1.9"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSwitch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Class Default
						Height: 0.317"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Switch.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipSwitchIn')
							Set strIoInd = 'O'
							Call SalSendMsg(hWndItem, SAM_User, 0, 0)
						On SAM_Click
							Set bType= not bType
							If bType
								Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipSwitchOut')
								Set strIoInd = 'I'
							Else
								Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipSwitchIn')
								Set strIoInd = 'O'
							!
							! Перечитываем список операций, доступных для обработки
							!
							Call SalSendMsg(hWndItem, SAM_User, 0, 0)
							!
							Call SalTblSetContext( hWndForm.splSwtMsgJrn.tbl, 0 )
							Call SalSendMsg(hWndForm.splSwtMsgJrn.tbl, UM_Populate, 0, 0)
						On SAM_User
							! Созданием списка операций для обработки
							If SqlPrepareAndExecute( hSql(), 
									"SELECT t.tt, t.name INTO :strTT, :strTTName
									   FROM tts t, staff_tts s, sw_tt_import w
									  WHERE t.tt = s.tt and s.id = :nUserId
									    AND t.tt = w.tt and w.io_ind = :strIoInd " || strSecure || 
									" order by w.ord")
								Set nTTArr = 0
								While SqlFetchNext( hSql(), nFetchRes )
									Set strTTArr[nTTArr, 0] = strTT
									Set strTTArr[nTTArr, 1] = strTTName
									Set nTTArr = nTTArr + 1
				Pushbutton: pbFindMatch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.267"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipFindMatch')
						On SAM_Click
							If tbl.cSwRef
								Set nSwRef = tbl.cSwRef
								Set nTmp = SalModalDialog( dlg_PickUpDoc, hWndForm, tbl.cAccD, tbl.cAccK, tbl.cAmnt, tbl.cCurr, strTTArr, tbl.cDatV, tbl.cTag20, tbl.cMT)
								If nTmp > 0
									If SalMessageBox( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessQuest1'),
											  CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion ) = IDNO
										Return FALSE
									! Вызов доплаты 900/910
									If GetGlobalOption('SW_NR20')='1'
										Call SignMT900(nTmp, tbl.cMT)
									!
									! DG: Заменил на вызов функции IMPMSG_DOCUMENT_LINK
									!
									If SqlPLSQLCommand(hSql(), "bars_swift.impmsg_document_link(nTmp, tbl.cSwRef)")
										Call SqlCommitEx(hSql(), "Документ привязан к сообщению")
									Call SalSendMsg(hWndForm.splSwtMsgJrn.tbl, UM_Populate, 0, 0)
									! If not SqlPrepareAndExecute(hSql(),
											"SELECT vdat INTO :dOperDat FROM oper WHERE ref=:nTmp")
										                                                                                                             Return FALSE
									! If NOT SqlFetchNext( hSql(), nFetchRes )
										                                                                                                             Return FALSE
									! If not SqlPrepareAndExecute(hSql(),
											"UPDATE sw_journal SET date_pay=:dOperDat WHERE swref=:nSwRef")
										                                                                                                             Return FALSE 
									! If not SqlPrepareAndExecute(hSql(),
											"INSERT INTO sw_oper (ref,swref) VALUES (:nTmp,:nSwRef)")
										                                                                                                             Return FALSE 
									! Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMess11') || ' ' || SalNumberToStrX(nSwRef, 0) ||
											  CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMess12') || ' ' || ' ' || SalNumberToStrX( nTmp, 0) )
				Pushbutton: pbReject
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.7"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Class Default
						Height: 0.317"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipReject')
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 )
								Set nRow = TBL_MinRow
								While SalTblFindNextRow( tbl, nRow, ROW_Selected, 0 )
									Call SalTblSetContext( tbl, nRow )
									!
									! DG: Заменил вызов прямого UPDATE на функцию IMPMSG_SET_STAFF()
									!
									If SqlPLSQLCommand(hSql(), "bars_swift.impmsg_message_changeuser(tbl.cSwRef, tbl.cId, NUMBER_Null)")
										Call SqlCommitEx(hSql(), "Сообщение распределено.")
									Else
										Call SqlRollbackEx(hSql(), "Сообщение не распределено.")
									! If SqlPrepareAndExecute( hSqlAux(), 'UPDATE sw_journal SET id=NULL WHERE swref=:tbl.cSwRef' )
										                                                                                                                        Call SqlCommitEx( hSqlAux(), CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTBack') || ' SwRef: ' || SalNumberToStrX( tbl.cSwRef, 0 ) )
								Call SalPostMsg( tbl, UM_Populate, 0, 0 )
				Pushbutton: pbApplyToAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.133"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipApplyToAll')
						On SAM_Click
							If SalTblAnyRows( tbl, ROW_Selected, 0 )
								Call SalMessageBeep ( MB_IconAsterisk )
								If SalMessageBox( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessQuest2') || ' ' || 
										tbl.cUser || '?', 
										CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion ) = IDYES
									Call SalWaitCursor( TRUE )
									Set nRow = TBL_MinRow
									Set sTmp = tbl.cUser
									Set nTmp = tbl.cId
									While SalTblFindNextRow( tbl, nRow, 0, 0 )
										Call SalTblSetContext(tbl, nRow)
										Set tbl.cId = nTmp
										Set tbl.cUser = sTmp
										Call SalTblSetRowFlags( tbl, nRow, ROW_Edited, TRUE)
									Call SalWaitCursor( FALSE )
				Pushbutton: pbUserList
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.567"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Class Default
						Height: 0.317"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CUSTPERS.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipUserList')
						On SAM_Click
							Call FunNSIEditControlled( 'SW_STAFF_LIST', tbl.cUser, SAM_Create )
				Option Button: pbTimerOn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.2"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\CLOCK.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							If nIsp
								Set MyValue = FALSE
							Else
								Set MyValue = TRUE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cBTipTimerOn') )
						On SAM_Click
							Call SalMessageBeep ( MB_IconAsterisk )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessReread') || ' ' || IifS( MyValue, CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessRereadOff'), CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessRereadOn') ),   
									CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
				Pushbutton: cpb_Timer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.986"
						Top:    0.083"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.292"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On UM_TimerFired
							If NOT SalTblAnyRows( hWndForm, ROW_Edited | ROW_MarkDeleted, 0 ) AND pbTimerOn
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cSplitterWindow
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    3.323"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Gray
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? No
				Contents
					Column: cSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № п/п
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип
								
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cIoInd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вх-
								Исх
						Visible? Yes
						Editable? No
						Maximum Data Length: 1
						Data Type: String
						Justify: Center
						Width:  0.417"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cSndr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отправитель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.814"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cSndrName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: SWIFT
								референция
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.257"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cRcvr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Получатель
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cRcvrName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cPayer
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Плательщик
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cPayee
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Получатель
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCurr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCurrCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCurDig
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cAmnt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cAmntFace
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cAccD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счет
								Деб
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.75"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cAccK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счет
								Кре
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatI
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								поступл
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.083"
						Width Editable? Yes
						Format: DateTime
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								валютир
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.083"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cUser
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Исп.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? No
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Create
								Call SqlPrepareAndExecute(hSql(), 
										 "select distinct id, fio
										      into :nId, :sTmp
										     from v_sw_staff
										  where io = :strIoInd
										     and io is not null
										  order by 1")
								Set nTmp=0
								Call SalArraySetUpperBound(mId,1,-1)
								Call SalListClear(hWndItem)
								While SqlFetchNext(hSql(), nFetchRes)
									Call SalListAdd(hWndItem, sTmp)
									Set mId[nTmp] = nId
									Set nTmp=nTmp+1
							On SAM_Validate
								Set nId=SalListQuerySelection(hWndItem)
								If nId>=0
									Set cId = mId[nId]
					Column: cId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер
								исп
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								отправки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								регистр
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								оплаты
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colToAlien
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кому...
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cTag20
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Поле 21
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.257"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlUpdate
					String: strSqlPopulate
					String: strSqlDelete
					: Q
						Class: cGenQuery
					: F
						Class: cGenFilter
					!
					String: sNlsA
					String: sNlsB
					!
					String: sUserF
					String: sCurTT
					!
					Number: nRowFlags
					String: strPrintPath
					File Handle: hFile
					Boolean: bSortOrd
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						!
						Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
						!
						! Если функция вызвана в режиме разбора распределенных на пользователя,
						! то добавляем фильтр по пользователю (поле ID)
						!
						If nIsp
							Set sUserF=' AND j.id=:splSwtMsgJrn.nIsp '
							Call SalHideWindow( cUser )
						Else
							Set sUserF=' AND j.id IS NULL '
						Set strSqlPopulate="
								SELECT j.swref, j.mt, j.trn, j.sender, j.sender_name, j.receiver, j.receiver_name,
								j.payer, j.payee, j.currency, j.kv, j.dig, j.amount, 
								j.accd, j.acck, j.io_ind, j.date_in, j.date_out, j.date_rec, j.date_pay, j.vdate, 
								j.id, j.fio, j.transit, j.tag20  
								 INTO  :splSwtMsgJrn.tbl.cSwRef,  :splSwtMsgJrn.tbl.cMT,   :splSwtMsgJrn.tbl.cTrn,
								       :splSwtMsgJrn.tbl.cSndr,   :splSwtMsgJrn.tbl.cSndrName,
								       :splSwtMsgJrn.tbl.cRcvr,   :splSwtMsgJrn.tbl.cRcvrName,
								       :splSwtMsgJrn.tbl.cPayer,  :splSwtMsgJrn.tbl.cPayee,
								       :splSwtMsgJrn.tbl.cCurr,   :splSwtMsgJrn.tbl.cCurrCode, :splSwtMsgJrn.tbl.cCurDig,
								       :splSwtMsgJrn.tbl.cAmnt,
								       :splSwtMsgJrn.tbl.cAccD,   :splSwtMsgJrn.tbl.cAccK, :splSwtMsgJrn.tbl.cIoInd,
								       :splSwtMsgJrn.tbl.cDatI,   :splSwtMsgJrn.tbl.cDatO, 
								       :splSwtMsgJrn.tbl.cDatR,   :splSwtMsgJrn.tbl.cDatP, :splSwtMsgJrn.tbl.cDatV,
								       :splSwtMsgJrn.tbl.cId,     :splSwtMsgJrn.tbl.cUser, :splSwtMsgJrn.tbl.colToAlien, :splSwtMsgJrn.tbl.cTag20  
								 FROM v_sw_impmsg j  
								 WHERE j.io_ind=:strIoInd " || sUserF || sFILTR || 
								 " ORDER BY j.swref"
						Call Q.Init( strSqlPopulate )
						Call F.Init( "SW_JOURNAL", "j" )
						Call SalPostMsg( hWndItem, UM_Populate, 0, 0)
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set nFRef = cSwRef
						Set nCount = 0
						Call SalTblPopulate(hWndItem, hSql(), T(Q.GetFullSQLString( F )), TBL_FillAll)
						Call SalStatusSetText( SalParentWindow( hWndItem), CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTStText') || ': ' || SalNumberToStrX(nCount,0) )
						Call VisTblAutoSizeColumn( hWndItem, cSwRef )
						Call VisTblAutoSizeColumn( hWndItem, cMT )
						Call VisTblAutoSizeColumn( hWndItem, cIoInd )
						Call VisTblAutoSizeColumn( hWndItem, cTrn )
						Call VisTblAutoSizeColumn( hWndItem, cCurr )
						Call VisTblAutoSizeColumn( hWndItem, cAmnt )
						Call VisTblAutoSizeColumn( hWndItem, cDatI )
						Set nFRow = VisTblFindString( hWndItem, 0, cSwRef, SalNumberToStrX( nFRef, 0 ))
						If nFRow = -1
							Set nFRow = 0
						Call SalTblSetContext( hWndItem, nFRow )
						Call SalTblSetFocusRow( hWndItem, nFRow )
						Call SalTblSetRowFlags( hWndItem, nFRow, ROW_Selected, TRUE )
						Call SalSendMsg(hWndItem, SAM_TblDoDetails, 0, 0)
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						If NOT SalIsNull( cCurDig )
							Set cAmntFace = cAmnt/SalNumberPower( 10, cCurDig )
						Else
							Set cAmntFace = cAmnt
						If NOT SalIsNull ( colToAlien )
							Call XSalTblSetRowBackColor( hWndItem, lParam, COLOR_LightPeriwinkle )
						Set nCount = nCount + 1
					On SAM_DoubleClick
						Set sCurTT = ''
						If nTTArr < 1
							Call SalMessageBeep( MB_IconStop )
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessUserTT'), 
									  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconStop )
							Return FALSE
						Else
							If nTTArr = 1
								Set sCurTT = strTTArr[0,0]
							Else
								If NOT SalModalDialog( dlg_PickUpTT, hWndForm, strTTArr, nTTArr, sCurTT )
									Return FALSE
							Call SalDisableWindow(tbl)
							If cAccD
								Call SqlPrepareAndExecute(hSql(),"SELECT nls INTO :sNlsA FROM accounts WHERE acc=:cAccD")
								Call SqlFetchNext(hSql(),nFetchRes)
							Else
								Set sNlsA=STRING_Null
							If cAccK
								Call SqlPrepareAndExecute(hSql(),"SELECT nls INTO :sNlsB FROM accounts WHERE acc=:cAccK")
								Call SqlFetchNext(hSql(),nFetchRes)
							Else
								Set sNlsB=STRING_Null
							Call SalCreateWindow( frmDoc, hWndForm,
									     tbl, cSwRef, cMT, cTrn, sCurTT, cCurr, cAmnt, cSndr, cRcvr, sNlsA, sNlsB, cDatV, strPar02, nIsp )
					On UM_Delete
						If SalTblAnyRows( hWndItem, ROW_Selected, 0 )
							Call SalMessageBeep( MB_IconQuestion )
							If SalMessageBox(CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessQuest3'),
									  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
								Set nRow = TBL_MinRow
								While SalTblFindNextRow( hWndItem, nRow, ROW_Selected, 0 )
									If SalTblQueryRowFlags( hWndItem, nRow, ROW_MarkDeleted ) 
										Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, FALSE )
									Else
										Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, TRUE )
					On UM_Update
						! Обрабатываем распределенные и удаленные строки
						! Выполняем распределение
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndItem, nRow, ROW_Edited, 0)
							Call SalTblSetContext(hWndItem, nRow)
							If SqlPLSQLCommand(hSql(), "bars_swift.impmsg_message_changeuser(splSwtMsgJrn.tbl.cSwRef, NUMBER_Null, splSwtMsgJrn.tbl.cId)")
								Call SqlCommitEx(hSql(), "Сообщение распределено.")
							Else
								Call SqlRollbackEx(hSql(), "Сообщение не распределено.")
						! Выполняем удаление сообщений
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndItem, nRow, ROW_MarkDeleted, 0)
							Call SalTblSetContext(hWndItem, nRow)
							If SqlPLSQLCommand(hSql(), "bars_swift.impmsg_message_delete(splSwtMsgJrn.tbl.cSwRef)")
								Call SqlCommitEx(hSql(), "Сообщение удалено.")
							Else
								Call SqlRollbackEx(hSql(), "Сообщение не удалено.")
						! If SalTblAnyRows( hWndItem, ROW_Edited | ROW_MarkDeleted, 0 )
							                                                                                                                        If SqlPrepare( hSql(), T(strSqlUpdate) )
								                                                                                                                        If SalTblDoUpdates( hWndItem, hSql(), TRUE )
									                                                                                                                        Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTSwR') )
							                                                                                                                        If SqlPrepare( hSql(), T(strSqlDelete) )
								                                                                                                                        If SalTblDoDeletes( hWndItem, hSql(), ROW_MarkDeleted )
									                                                                                                                        Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTSwD') )
					On UM_Search
						Call TblFindString( hWndItem, DFIND_First )
					On UM_Print
						Set nRowFlags = 0
						Select Case GetTablePrintOpt(  )
							Case 2		! Only selected documents
								Set nRowFlags = ROW_Selected
								Break
							Default
								Break
						If SalTblAnyRows( hWndForm, nRowFlags, 0 )
							Call SalWaitCursor( TRUE )
							Set strPrintPath = GetPrnDir(  ) || '\\' || 'sw' || SalFmtFormatDateTime( SalDateCurrent(), 'hhhhmmss' ) || '.txt'
							! Call Debug( strPrintPath )
							If NOT SalFileOpen(hFile, strPrintPath, OF_Write | OF_Text | OF_Create)
								Call SalWaitCursor( FALSE )
								Call MessageError( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTErrFileOpen') || ' ' || strPrintPath )
								Return FALSE
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nRow, nRowFlags, 0 )
								Call SalTblSetContext( hWndForm, nRow )
								Call SalFilePutStr(hFile, '')
								!
								Call SalFilePutStr(hFile, Sw_MtAsText( hSql(), cSwRef ) )
							Call SalFileClose(hFile)
							Call MessageInfo( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTFileSave') || ' ' || strPrintPath )
							Call DosDirectPrint( strPrintPath )
							Call SalWaitCursor( FALSE )
					On SAM_TblDoDetails
						If cSwRef
							Set mlBody = 'From: ' || cSndr 
							If cSndrName
								Set mlBody = mlBody || ' - ' || cSndrName
							Set mlBody = mlBody || PutCrLf() || 'To  : ' || cRcvr
							If cRcvrName
								Set mlBody = mlBody || ' - ' || cRcvrName
							Set mlBody = mlBody || PutCrLf()
							!
							If SqlPrepareAndExecute(hSqlAux(),T("SELECT tag,opt,value INTO :sTag,:sOpt,:sValu 
									 FROM sw_operw WHERE swref=:cSwRef ORDER BY n"))
								While SqlFetchNext(hSqlAux(),nFetchRes)
									Set sFldTmp=SalStrRightX('  '||sTag||sOpt||': ', 6)
									! DG (16/02/2006): Убрал вставку переноса строк,
									! на данный момент вертушка при загрузке не убирает символы
									! форматирования и поля имеют оригинальный формат
									!
									! While SalStrLength( sValu ) > 40
										                                                                                                                        Set sTmp = sTmp || SalStrLeftX( VisStrSubstitute(sValu, PutCrLf(), PutCrLf()||'      '), 40 ) || PutCrLf() || '      '
										                                                                                                                        Set sValu = SalStrMidX( sValu, 40, SalStrLength( sValu )-40 )
									Set sFldTmp = sFldTmp || VisStrSubstitute(sValu, PutCrLf(), PutCrLf()||'      ')
									! Неверно обрабатываются, из-за того что может быть еще и счет
									! If sTag = '57' AND sOpt = 'A' ! Look for transit bank name
										                                                                                                                        If SqlPrepareAndExecute( hSqlAux2(), 
												"SELECT name INTO :sTrnsName FROM sw_banks WHERE bic='" || SalStrLeftX( sValu || 'XXXX', 11 )|| "'")
											                                                                                                                        If SqlFetchNext( hSqlAux2(), nFetchRes )
												                                                                                                                        Set sTmp = sTmp || ' - ' || sTrnsName
									Set mlBody=mlBody || PutCrLf() || sFldTmp
						Else
							Set mlBody = ''
						! (место 3 из 3х)Mik убрал (15-02-2006), подумал, что с EN никогда не вызывается
						! If SalStrScan(strPar02,'E')>=0
							                                                                                                                         Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(tbl, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			Multiline Field: mlBody
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10000
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.033"
						Top:    3.393"
						Width:  9.8"
						Width Editable? Yes
						Height: 0.464"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 10
					Font Enhancement: None
					Text Color: Default
					Background Color: Sky
				Message Actions
					On UM_NoFontChange
						Return TRUE
		Functions
		Window Parameters
			Number: nIsp     !! N для EN (dg: идентификатор пользователя при разборе распределенных)
			String: sFILTR
			String: strPar02 !! = 'E' - с автовходом и автовыходом,
					                      'N' - нет первички,  ACCD,ACCK
					                      'F' - есть функция определения получателя
		Window Variables
			String: strFileName
			Number: i
			Date/Time: dOperDat
			String: sTmp
			String: sTag
			String: sTrnsName
			String: sOpt
			Long String: sValu
			String: sFilt
			Number: nId
			Number: mId[*]
			Number: nTmp
			Number: nBound
			Number: nRow
			Number: nFRow
			Number: nFRef
			Number: nCount
			Number: nSwRef
			!
			Boolean: bType
			Number: nInterval
			!
			String: strTTArr[*,2]
			Number: nTTArr
			Number: nUserId
			String: strSecure
			String: strTT
			String: strTTName
			String: strIoInd
			String: sMfoB
			Long String: sFldTmp
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTWndTitle'))
				Call ShowApdVersion('01')
				Call PrepareWindow(hWndForm)
				!
				Call SalTblSetTableFlags(tbl, TBL_Flag_SingleSelection, TRUE)
				Call SalDisableWindow(pbIns)
				If nIsp
					Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTBeginFunc1') )
					If SqlPrepareAndExecute( hSql(), 'SELECT fio INTO :sTmp FROM staff WHERE id=:nIsp' )
						If SqlFetchNext( hSql(), nFetchRes )
							Call SalSetWindowText( hWndForm, sTmp || ': ' || CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTWTitle') )
					Call SalDisableWindow( pbUserList )
					Call SalDisableWindow( pbApplyToAll )
				Else
					Call SalDisableWindow( pbReject )
					Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTBeginFunc2') )
				Call XSalTooltipSetUserDefault()
				Set nInterval=300
				Call cpb_Timer.Init(nInterval, 0, TRUE)
				!
				Set nUserId = GetUserId()
				Set strIoInd='O'
				Set strSecure = ''
				If EnhancedSecurity(  )
					Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
			On SAM_CreateComplete
				Call SalSendClassMessage(SAM_CreateComplete, wParam, lParam)
				! Call SalSendMsg(hWndForm.splSwtMsgJrn.pbSwitch, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Close
				Call SalDestroyWindow(hWndForm)
			On SAM_Destroy
				Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTEndFunc') )
	Dialog Box: dlg_PickUpDoc		! 02
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Подбор документа для квитовки...
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.5"
				Width Editable? Class Default
				Height: 5.274"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Выбрать документ для квитовки
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44145
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44146
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44147
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbViewDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.667"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Просмотреть реквизиты документа
							Set strTip = CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cBTipViewDoc')
						On SAM_Click
							Call DocViewContentsEx( hWndForm, tbl.colRef )
				Option Button: pbPreFilter
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.117"
						Top:    0.048"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\NEWREC.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set MyValue = FALSE
						On SAM_TooltipSetText
							! Включить/выключить фильтр по сумме и счетам
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cBTipPreFilter') )
						On SAM_Click
							! If MyValue
								                           Call SalSendMsg( tbl, UM_Populate, 0, 0 )
							! Else
								                           Call SalPostMsg( pbFilter, SAM_Click, 0, 0 )
							Call SalSendMsg( tbl, UM_Populate, 0, 0 )
				Option Button: pbFilterSwRef
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.071"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\HORSE2.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set MyValue = TRUE
						On SAM_TooltipSetText
							! Включить/выключить фильтр по сумме и счетам
							Return XSalTooltipSetText( lParam, 'Знайти по полю 20!' )
						On SAM_Click
							Call SalSendMsg( tbl, UM_Populate, 0, 0 )
				! If MyValue
					                           Call SalSendMsg( tbl, UM_Populate, 0, 0 )
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  10.417"
						Width Editable? Class Default
						Height: 4.357"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Референс
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.017"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colVDat
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								валютир.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.117"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNlsA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счет А
						Visible? Yes
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col11
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.667"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCcy
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Валюта
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNlsB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Cчет Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Д/К
						Visible? Yes
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Center
						Width:  0.433"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNazn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назначение платежа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDig
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colTag20
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Поле20
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colTt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код оп.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNextVisa
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наступна віза
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						!
						Call SalSendClassMessage( UM_Create, 0, 0 )
					On UM_Populate
						If dlg_PickUpDoc.strSqlPopulate != ''
							If pbFilterSwRef
								If pbPreFilter
									Call cQ.Init( dlg_PickUpDoc.strSqlPopulate || ' where ' || strAddWhere || strOutFilter||strOutFilter20)
								Else
									Call cQ.Init( dlg_PickUpDoc.strSqlPopulate || ' where ' || strAddWhere||strOutFilter20)
							Else
								If pbPreFilter
									Call cQ.Init( dlg_PickUpDoc.strSqlPopulate || ' where ' || strAddWhere || strOutFilter)
								Else
									Call cQ.Init( dlg_PickUpDoc.strSqlPopulate || ' where ' || strAddWhere)
							Call SalWaitCursor( TRUE )
							Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
							Set strDSql = cQ.GetFullSQLString( cF )
							Call SalTblPopulate( hWndForm, cMain.hSql(), T(strDSql), TBL_FillNormal )
							Call SalTblSetContext( hWndForm, 0 )
							Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor( FALSE )
					On SAM_FetchRowDone
						Set colSum = colSum / SalNumberPower( 10, colDig )
						If dlg_PickUpDoc.Tag20=tbl.colTag20
							Call XSalTblSetRowBackColor( tbl, lParam, COLOR_LightGreen)
		Functions
			Function: ReturnValue
				Description:
				Returns
					Number: nRes
				Parameters
				Static Variables
				Local variables
				Actions
					Return tbl.colRef
		Window Parameters
			Number: AccDb
			Number: AccKr
			Number: Amnt
			String: Ccy
			String: TTArr[*,2]
			Date/Time: MsgDt
			String: Tag20
			Number: Mt
		Window Variables
			String: strAddWhere
			String: strOutFilter
			String: strOutFilter20
			String: strAccDWhere
			String: strAccKWhere
			String: strNlsA
			String: strNlsB
			String: TTList
			!
			Number: i
			!
			Number: nVDocMin
			Number: nVDocMax
			!
			String: strVDocMin
			String: strVDocMax
			String: strMsgDate
			Number: nCnt
			String: sSqlTmp
			!
			Number: nTmp
			Number: nRow
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Set nVDocMin = Val(GetGlobalOption('SWTDVMNI'))
				Set nVDocMax = Val(GetGlobalOption('SWTDVMAX'))
				Set strMsgDate = SalFmtFormatDateTime(MsgDt, 'dd-MM-yyyy')
				If SqlPrepareAndExecute(hSql(), "select to_char(to_date(:strMsgDate, 'dd-mm-yyyy') - nvl(:nVDocMax, 0), 'ddmmyyyy'), to_char(to_date(:strMsgDate, 'dd-mm-yyyy') + nvl(:nVDocMin, 0), 'ddmmyyyy') into :strVDocMin, :strVDocMax from dual")
					Call SqlFetchNext(hSql(), nFetchRes)
				!
				Set dlg_PickUpDoc.nFlags = GT_ReadOnly
				Set dlg_PickUpDoc.strFilterTblName = 'V_SW_IMPMSG_DOC'
				!
				! Set strAddWhere = 'fdat between :dlg_PickUpDoc.MsgDt - :nVDocMax and :dlg_PickUpDoc.MsgDt + :nVDocMin'
				Set strAddWhere = "fdat between to_date(:strVDocMin, 'ddmmyyyy') and to_date(:strVDocMax, 'ddmmyyyy') and lcv = :dlg_PickUpDoc.Ccy"
				Set strOutFilter = ' and s = :dlg_PickUpDoc.Amnt'
				Set strOutFilter20 = ' and (tag20 = :dlg_PickUpDoc.Tag20 or s = :dlg_PickUpDoc.Amnt)'
				If AccDb
					Set strOutFilter = strOutFilter || ' and accd = :dlg_PickUpDoc.AccDb'
				If AccKr
					Set strOutFilter = strOutFilter || ' and acck =  :dlg_PickUpDoc.AccKr'
				!
				! Set strAddWhere  = 'OPER.ref IN (SELECT ref FROM OPLDOK WHERE OPLDOK.fdat BETWEEN SYSDATE-10 AND SYSDATE+10 '
				! Set strAccDWhere = ''
				! Set strAccKWhere = ''
				! Set strOutFilter = 'AND OPLDOK.s = :dlg_PickUpDoc.Amnt'
				! If AccDb
					! Set strAccDWhere = '(OPLDOK.acc = :dlg_PickUpDoc.AccDb AND OPLDOK.dk = 0)'
				! If AccKr
					! Set strAccKWhere = '(OPLDOK.acc = :dlg_PickUpDoc.AccKr AND OPLDOK.dk = 1)'
				! If strAccDWhere OR strAccKWhere
					! Set strOutFilter = strOutFilter || ' AND ('
					! If strAccDWhere
						! Set strOutFilter = strOutFilter || strAccDWhere
					! If strAccKWhere
						! If strAccDWhere
							                                      Set strOutFilter = strOutFilter || ' OR '
						! Set strOutFilter = strOutFilter || strAccKWhere
					! Set strOutFilter = strOutFilter || ')'
				! Call SalArrayGetUpperBound( TTArr, 1, i )
				! While i >= 0
					! If TTList
						                                      Set TTList = TTList || ','
					! Set TTList = TTList || "'" || TTArr[i,0] || "'"
					! Set i = i - 1
				! If TTList
					! Set strOutFilter = strOutFilter || ' AND OPLDOK.tt IN (' || TTList || ')'
				!
				Set dlg_PickUpDoc.strSqlPopulate = 
						'select ref, vdat, nlsa, nlsb, amount, lcv, dig, dk, nazn, tag20, tt, nextvisagrp 
						 into :tbl.colRef, :tbl.colVDat, :tbl.colNlsA, :tbl.colNlsB, :tbl.colSum,
						      :tbl.colCcy, :tbl.colDig, :tbl.colDK, :tbl.colNazn, :tbl.colTag20, :tbl.colTt, :tbl.colNextVisa 
						 from v_sw_impmsg_doc '
				Call SalSendClassMessage( UM_Create, 0, 0 )
	Dialog Box: dlg_PickUpTT		! 03	
		Class:
		Property Template:
		Class DLL Name:
		Title: Выберите банковскую операцию...
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.017"
				Width Editable? Yes
				Height: 3.488"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Выбрать операцию для обработки SWIFT сообщения.
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblSWTT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.017"
						Top:    0.024"
						Width:  6.867"
						Width Editable? Yes
						Height: 2.274"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colTT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								оп.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Right
						Width:  0.683"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTTName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nIterator
					Number: nRow
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						!
						Set nIterator = 0
						While nIterator < nBound
							Set nRow = SalTblInsertRow( hWndItem, TBL_MaxRow )
							If nRow != TBL_Error
								Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
								Call SalTblSetContext( hWndItem, nRow )
								Set colTT     = strArr[nIterator, 0]
								Set colTTName = strArr[nIterator, 1]
								Set nIterator = nIterator + 1
					On SAM_DoubleClick
						Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
			! cPushButtonLabeled:
.winattr class Pushbutton:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:  
					Top:   
					Width:  Default
					Width Editable? Yes
					Height: Default
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				                                                                                                                                                                                                                Message Actions 
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: В&ыбрать
				Window Location and Size
					Left:   1.1"
					Top:    2.512"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set strTT = tblSWTT.colTT
						Call SalEndDialog( hWndForm, 1 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: О&тменить
				Window Location and Size
					Left:   3.917"
					Top:    2.512"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 0 )
		Functions
		Window Parameters
			String: strArr[*,2]
			Number: nBound
			Receive String: strTT
		Window Variables
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
			On SAM_CreateComplete
				Call SalWaitCursor( FALSE )
			On SAM_Close
				Call SalEndDialog( hWndForm, 0 )
	Form Window: frmDoc				! 04
		Class: cDocW
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Yes
			Window Location and Size
				Left:   2.49"
				Top:    1.267"
				Width:  9.771"
				Width Editable? Class Default
				Height: 7.354"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbPayDoc
					Class Child Ref Key: 27
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 29
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrtDoc
					Class Child Ref Key: 30
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 36417
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text:
					Resource Id: 36418
					Class Child Ref Key: 75
					Class ChildKey: 0
					Class: cDocW
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Justify: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Line
					Resource Id: 36419
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 36420
					Class Child Ref Key: 59
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfZn
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfOst
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pbNewDoc
					Class Child Ref Key: 53
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbNewTTs
					Class Child Ref Key: 60
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call SalDisableWindow(hWndItem)
				Pushbutton: pbDocBal
					Class Child Ref Key: 72
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHelp
					Class Child Ref Key: 62
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSaveKor
					Class Child Ref Key: 64
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 36421
					Class Child Ref Key: 77
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbHotVytyag
					Class Child Ref Key: 138
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotName
					Class Child Ref Key: 137
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotFio
					Class Child Ref Key: 141
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbLocalD
					Class Child Ref Key: 148
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotOstat
					Class Child Ref Key: 150
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Data Field: dfValD1
				Class Child Ref Key: 25
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   7.486"
						Top:    4.49"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On UM_ParentSize
						Call SalGetWindowLoc ( hWndItem , nX, nY )
						Call SalSetWindowLoc ( hWndItem, wParam-0.85-1.65, nY )
			Combo Box: cmbVob
				Class Child Ref Key: 39
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text:
				Resource Id: 36412
				Class Child Ref Key: 36
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfNd
				Class Child Ref Key: 23
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDateFrom
				Class Child Ref Key: 155
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDocD
				Class Child Ref Key: 22
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankA
				Class Child Ref Key: 4
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvA
				Class Child Ref Key: 50
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On UM_Update
						Call SalSendClassMessage(UM_Update, 0, 0)
						If GetGlobalOption('SW_D07') = '1' AND frmDoc.sTT='D07'
							Set frmDoc.nS = nTmpS/SalNumberPower(10, frmDoc.nDigA)
			Data Field: dfNlsA
				Class Child Ref Key: 2
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call frmDoc.UnHideIt(hWndItem)
						If frmDoc.sNlsA
							Set dfNlsA=frmDoc.sNlsA
							If SalSendMsg(hWndItem, SAM_Validate, 0, 0)=VALIDATE_Ok
								If frmDoc.sTT='SWO'
									Call frmDoc.HideIt(hWndItem)
			Data Field: dfPlat
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamA
				Class Child Ref Key: 7
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfOkpoA
				Class Child Ref Key: 139
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPlatB
				Class Child Ref Key: 9
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbA
				Class Child Ref Key: 6
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankB
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPoluB
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbB
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvB
				Class Child Ref Key: 51
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On UM_Update
						Call SalSendClassMessage(UM_Update, 0, 0)
						If GetGlobalOption('SW_D07') = '1' AND frmDoc.sTT='D07'
							Set frmDoc.nS = nTmpS/SalNumberPower(10, frmDoc.nDigA)
			Data Field: dfNlsB
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call frmDoc.UnHideIt(hWndItem)
						If frmDoc.sNlsB
							Set dfNlsB=frmDoc.sNlsB
							If SalSendMsg(hWndItem, SAM_Validate, 0, 0)=VALIDATE_Ok
								If frmDoc.sTT='SWI'
									Call frmDoc.HideIt(hWndItem)
			Data Field: dfPolu
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamB
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						If strNamB
							Set dfNamB=strNamB
			Data Field: dfOkpoB
				Class Child Ref Key: 140
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						If strOkpoB
							Set dfOkpoB = strOkpoB
			Data Field: dfSumA
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSendClassMessage( SAM_Create, 0, 0 )
						! If hWndForm.frmDoc.nDk = 1 OR hWndForm.frmDoc.nDk = 3
							                                                                                                                                                                                                                Set MyValue = hWndForm.frmDoc.nS
						Set MyValue = hWndForm.frmDoc.nS
						If MyValue != NUMBER_Null
							Call SalSendClassMessage( SAM_Validate, 0, 0 )
					On SAM_Validate 
						If SalSendClassMessage(SAM_Validate,0,0)=VALIDATE_Ok
							If GetGlobalOption('SW_D07') = '1' AND frmDoc.sTT='D07'
								If nTmpSa*SalNumberPower(10, frmDoc.nDigB)=frmDoc.dfSumB
									Set frmDoc.dfSumA=frmDoc.nS
								If nTmpS*SalNumberPower(10, frmDoc.nDigA)=frmDoc.dfSumA
									Set frmDoc.dfSumB=nTmpSa
						Return VALIDATE_Ok
			Data Field: dfSumB
				Class Child Ref Key: 21
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					! On SAM_Create
						                                                                                                                                                                                                                Call SalSendClassMessage( SAM_Create, 0, 0 )
						                                                                                                                                                                                                                If hWndForm.frmDoc.nDk = 0 OR hWndForm.frmDoc.nDk = 2
							                                                                                                                                                                                                                Set MyValue = hWndForm.frmDoc.nS
					On SAM_Validate 
						If SalSendClassMessage(SAM_Validate,0,0)=VALIDATE_Ok
							If GetGlobalOption('SW_D07') = '1' AND frmDoc.sTT='D07'
								If nTmpSa*SalNumberPower(10, frmDoc.nDigB)=frmDoc.dfSumB
									Set frmDoc.dfSumA=frmDoc.nS
								If nTmpS*SalNumberPower(10, frmDoc.nDigA)=frmDoc.dfSumA
									Set frmDoc.dfSumB=nTmpSa
						Return VALIDATE_Ok
			Data Field: dfRatNom
				Class Child Ref Key: 57
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumC
				Class Child Ref Key: 44
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			List Box: lb1
				Class Child Ref Key: 85
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalSendClassMessage( SAM_Create, 0, 0 )
						Call SalArrayGetUpperBound( frmDoc.aTag, 1, nNDpc )
						Call SalArrayGetUpperBound( strLast_Dp, 1, nLDpc )
						If nLDpc AND nNDpc = nLDpc
							While nLDpc > 0
								Set frmDoc.aVal[nLDpc]=strLast_Dp[nLDpc]
								Set nLDpc = nLDpc - 1
			Multiline Field: dfNazn
				Class Child Ref Key: 24
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					String Type: Class Default
					Editable? Class Default
				Display Settings
					Border? Class Default
					Word Wrap? Class Default
					Vertical Scroll? Class Default
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Message Actions
			Data Field: dfSkN
				Class Child Ref Key: 115
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSk
				Class Child Ref Key: 48
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   6.586"
						Top:    5.323"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD1N
				Class Child Ref Key: 160
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   7.486"
						Top:    4.26"
						Width:  1.6"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On UM_ParentSize
						Call SalGetWindowLoc ( hWndItem , nX, nY )
						Call SalSetWindowLoc ( hWndItem, wParam-0.85-1.65, nY )
			Data Field: dfValD2N
				Class Child Ref Key: 131
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   7.486"
						Top:    4.844"
						Width:  1.6"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On UM_ParentSize
						Call SalGetWindowLoc ( hWndItem , nX, nY )
						Call SalSetWindowLoc ( hWndItem, wParam-0.85-1.65, nY )
			Data Field: dfValD2
				Class Child Ref Key: 66
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   7.486"
						Top:    5.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On UM_ParentSize
						Call SalGetWindowLoc ( hWndItem , nX, nY )
						Call SalSetWindowLoc ( hWndItem, wParam-0.85-1.65, nY )
			Data Field: dfD
				Class Child Ref Key: 132
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfK
				Class Child Ref Key: 133
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfLocDat
				Class Child Ref Key: 149
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNB
				Class Child Ref Key: 122
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNomN
				Class Child Ref Key: 123
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNC
				Class Child Ref Key: 125
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbUgrnt
				Class Child Ref Key: 130
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.117"
					Top:    3.857"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfSumNA
				Class Child Ref Key: 135
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfVytyagN
				Class Child Ref Key: 142
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquivN
				Class Child Ref Key: 144
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquiv
				Class Child Ref Key: 145
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Picture: pic1f
				Class Child Ref Key: 156
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Picture: pic2f
				Class Child Ref Key: 157
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Picture: pic3f
				Class Child Ref Key: 158
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call SalGetWindowLoc ( dfSwtMes , nX, nY )
						Call SalSetWindowLoc ( hWndItem , nX, nY )
						Call SalGetWindowSize ( dfSwtMes , nX, nY )
						Call SalSetWindowSize ( hWndItem , wParam-0.85, nY+0.018 )
			Data Field: dfMTN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.086"
						Top:    3.844"
						Width:  3.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Blue
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set dfMTN='SWIFT ' || CurrentLangTable.GetAtomTitle('cTMess') || ' MT'||SalNumberToStrX(nMt,0)
			Multiline Field: dfSwtMes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.083"
						Top:    4.073"
						Width:  7.3"
						Width Editable? Yes
						Height: 1.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
					On SAM_Create
						Call frmDoc.UnHideIt(hWndItem)
						If strLast_Nazn
							Set dfNazn = strLast_Nazn
						Else
							Set dfNazn=''
						Set dfSwtMes='From: ' || sSndr ||', '||'To: '||sRcvr||SalNumberToChar(13)||SalNumberToChar(10)
						Call SqlPrepareAndExecute(hSql(),T(
								"SELECT tag,opt,value INTO :sTag,:sOpt,:sValu
								 FROM sw_operw WHERE swref=:nSwRef ORDER BY n"))
						While SqlFetchNext(hSql(), nInd)
							Set sTmp=':'||sTag||sOpt||':'||VisStrSubstitute(sValu, SalNumberToChar(13)||SalNumberToChar(10),' ')
							Set dfSwtMes=dfSwtMes||SalNumberToChar(13)||SalNumberToChar(10)||sTmp
							If sTag = '32' and sOpt = 'A' ! VDate+KV+Summa
								Set sTmp = Subs(sValu, 1, 6)
								Set dfValD1 = SalDateConstruct(2000+Val(Subs(sTmp,1,2)), Val(Subs(sTmp,3,2)), Val(Subs(sTmp,5,2)), 0, 0, 0)
							If sTag = '50' ! Ordering Customer
								Set sTmp = SalStrTrimX( VisStrSubstitute(sValu, SalNumberToChar(13)||SalNumberToChar(10),' '))
								If fCanTranslit
									Call SqlSetLongBindDatatype( 2, 22 )
									If SqlPrepareAndExecute( hSqlAux(), "SELECT SWIFT.SWIFTTOSTR(:sTmp, 'RUR6') INTO :lsTmp FROM DUAL")
										If SqlFetchNext( hSqlAux(), nInd )
											Set sValu = lsTmp
								If GetGlobalOption('SWT_DESC') = '1'
									Set dfNazn = dfNazn || sValu || '  '
							If sTag = '70' ! Remittance Information
								Set sTmp = SalStrTrimX( VisStrSubstitute(sValu, SalNumberToChar(13)||SalNumberToChar(10),' '))
								If fCanTranslit
									Call SqlSetLongBindDatatype( 2, 22 )
									If SqlPrepareAndExecute( hSqlAux(), "SELECT SWIFT.SWIFTTOSTR(:sTmp, 'RUR6') INTO :lsTmp FROM DUAL")
										If SqlFetchNext( hSqlAux(), nInd )
											Set sValu = lsTmp
								If GetGlobalOption('SWT_DESC') = '1'
									Set dfNazn=dfNazn || sValu
						If SalStrScan(strPar02,'E')>=0 and SalStrScan(strPar02,'N')>=0
							Set strSwTTName = ''
							If GetGlobalOption('SWT_DESC') = '1'
								If SqlPrepareAndExecute( hSql(), 
										  "SELECT t.TTNAME from SW_TT t, sw_950d d INTO :strSwTTName
										   WHERE t.SWTT=d.swtt and d.swref=:nSwRef and n=:nN " ) 
										and SqlFetchNext(hSql(), nInd )
								Set dfNazn=dfNazn || strSwTTName || ' '
					On SAM_Validate
						Return VALIDATE_Ok
			Check Box: cbKeepAttributes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наследовать атрибуты платежа для следующих операций
				Window Location and Size
					Left:   0.117"
					Top:    5.833"
					Width:  7.883"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set MyValue = fKeepAttributes
					On SAM_Click
						Set fKeepAttributes = MyValue
			Data Field: dfSub
				Class Child Ref Key: 167
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSubN
				Class Child Ref Key: 166
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
			Function: oDoc
				Description: Оплатить  документ с прибамбасами
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					! String: FN_
					! Date/Time: DAT_
					! String: sTmp
					! Number: N_
					Number: MT_
					! Number: BIS_
					! String: TAG_   
					! String: TAG5_   
					! String: OPT_
					! String: VALUE_
					! Number: nVAL_
					! Number: REC_
					Number: nTmp
				Actions
					While TRUE
						! Лочим запись
						! DG: Блокировка вынесена в процедуру
						! If SalStrScan(strPar02,'E')>=0 and SalStrScan(strPar02,'N')>=0
							                                                                                                             If not SqlPrepareAndExecute( hSqlAux(),
									  "SELECT 950 INTO :MT_ FROM sw_950d WHERE checked_ind IS NULL AND swref=:nSwRef and n=:nN FOR UPDATE OF checked_ind NOWAIT")
								                                                                                                             Break 
						! Else 
							                                                                                                             If not SqlPrepareAndExecute( hSqlAux(),
									  "SELECT NVL(mt,103) INTO :MT_ FROM sw_journal WHERE date_pay IS NULL AND swref=:nSwRef FOR UPDATE OF date_pay NOWAIT")
								                                                                                                             Break 
						! If not SqlFetchNext(hSqlAux(),nFetchRes)
							                                                                                                             Call Debug('Нет записи')
						! для отв.провода по ВПС и СЕП
						If frmDoc.nFli = 1   ! Межбанк
							Call SqlPrepareAndExecute( hSqlAux(),
									"SELECT 1 INTO :nTmp FROM banks WHERE mfo=:frmDoc.B.Bank AND
									  (kodn=3 AND mfop=:frmDoc.A.Bank
									   OR mfop IN (SELECT mfo FROM banks WHERE kodn=3 AND mfop=:frmDoc.A.Bank))")
							If SqlFetchNext(hSqlAux(), nFetchRes)
								Set frmDoc.m_sDrec  = ''
								Set frmDoc.m_sNazns = '10'
							Else
								Set frmDoc.m_sDrec="#fMT "||Str(nMt)||IifS(frmDoc.m_sDrec='','#',SalStrTrimX(frmDoc.m_sDrec))
								Set frmDoc.m_sNazns = '11'
						If not cDocW.oDoc()
							Break
						! DG: Логику привязки сообщения к документу вынес в процедуру
						If strPar02 = 'EN'
							! If not SqlPLSQLCommand(hSql(), "bars_swift.stmt_document_link(nSwRef, nN, bars_swift.t_listref(frmDoc.m_nRef), 0)")
								                                        Break 
							If not SqlPrepareAndExecute(hSql(), "begin bars_swift.stmt_document_link(" || Str(nSwRef) || "," ||  Str(nN) || ", bars_swift.t_listref(" || Str(frmDoc.m_nRef) || "), 0); end;")
								Break
						Else
							If not SqlPLSQLCommand(hSql(), "bars_swift.impmsg_document_link(frmDoc.m_nRef, nSwRef)")
								Break
						! If not SqlPrepareAndExecute( hSqlAux(),"INSERT INTO sw_oper ( ref, swref) VALUES (:frmDoc.m_nRef ,:nSwRef ) ")
							                                                                                                             Break 
						! If SalStrScan(strPar02,'E')>=0 and SalStrScan(strPar02,'N')>=0
							                                                                                                             If not SqlPrepareAndExecute( hSqlAux(),"UPDATE sw_950d set OUR_REF=:frmDoc.m_nRef, CHECKED_IND ='Y' WHERE swref=:nSwRef and n=:nN  " ) 
								                                                                                                             Break 
						! Else 
							! If not SqlPrepareAndExecute( hSqlAux(),"UPDATE sw_journal SET date_pay=:frmDoc.m_dDatV1 WHERE swref=:nSwRef " ) 
								                                                                                                             Break 
						Return TRUE
					Return FALSE
			Function: iDop
				Description: Вставка допреквизитов в OPERW
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: TAG_   
					Long String: VALUE_
				Actions
					If nFli=1
						! If SqlPrepareAndExecute( hSqlAux(),
								  "SELECT TRIM(TAG||OPT),TRIM(VALUE) 
								     INTO :TAG_,:VALUE_ FROM sw_operw WHERE SWREF=:nSwRef ORDER BY N ")
							                                                                                                      While SqlFetchNext( hSqlAux(), nFetchRes )
								                                                                                                      If VALUE_
									! If SqlPrepareAndExecute( hSqlAux2(),"SELECT tag FROM op_field WHERE tag=:TAG_ ") and not SqlFetchNext( hSqlAux2(), nFetchRes )
										                                                                                                      If not SqlPrepareAndExecute( hSqlAux2(),"INSERT INTO op_field (tag,name,vspo_char) VALUES (:TAG_,:TAG_,'F')")
											                                                                                                      Return FALSE
									                                                                                                      If SqlPrepareAndExecute( hSqlAux2(),"SELECT tag FROM operw WHERE tag=:TAG_ AND ref=:frmDoc.m_nRef")
										                                                                                                      If SqlFetchNext( hSqlAux2(), nFetchRes )
											                                                                                                      Set VALUE_=PutCrLf()||VALUE_
											                                                                                                      If not SqlPrepareAndExecute( hSqlAux2(),"UPDATE operw SET value=value||:VALUE_ WHERE tag=:TAG_ AND ref=:frmDoc.m_nRef")
												                                                                                                      Return FALSE
										                                                                                                      Else 
											                                                                                                      If not SqlPrepareAndExecute( hSqlAux2(),"INSERT INTO operw (ref,tag,value) VALUES (:frmDoc.m_nRef,:TAG_,:VALUE_)")
												                                                                                                      Return FALSE
						! DG (20/03/2006): Перенес логику в процедуру bars_swift.impmsg_document_storetag()
						If not SqlPLSQLCommand(hSql(), "bars_swift.impmsg_document_storetag(frmDoc.m_nRef, nSwRef, nN)")
							Return FALSE
					Return cDocW.iDop()
		Window Parameters
			Window Handle: hWnd ! Родительское окно
			Number: nSwRef      ! референция
			Number: nMt         ! N MT-сообщения
			String: sMtRef	    ! MT identifier
			String: sSWT_TT     ! Код операции
			String: sLcv        ! Код валюты ISO
			Number: nAmnt       ! Сумма
			String: sSndr       ! Отправитель
			String: sRcvr       ! Получатель
			String: strNlsA     ! Счет А
			String: strNlsB     ! Счет Б
			Date/Time: dtVDat   ! Дата валютирования
			String: strPar02    !! = 'E' - с автовходом и автовыходом
			Number: nN          !! для EN
		Window Variables
			!
			String: sTmpNazn
			String: sTag
			String: sOpt
			Long String: sValu
			String: sTNlsA
			String: sTNlsB
			!
			Number: nTmp
			String: sTmp
			Long String: lsTmp
			Boolean: fCanTranslit
			Number: nTransBack
			String: sCharSet
			Number: nInd
			Number: nNDpc
			Number: nLDpc
			String: strSwTTName
			!
			Number: nRelMsgRef
			Number: nRelMsgMt
			String: sRCVRFName
			String: strNamB
			String: strOkpoB
			String: strMfoB
			Number: nFlg
			Number: nX
			Number: nY
			Number: nTmpS
			Number: nTmpSa
			String: sNameBank
			String: sKOD_G
		Message Actions
			On UM_Choose
				!
				! MOS - запоминаю входящую сумму
				Set nTmpS = nAmnt/SalNumberPower(10, nDigA)
				! DG: Вызов первой функции получения реквизитов
				If not SqlPLSQLCommand( hSql(), 'bars_swift.impmsg_document_getparams(nSwRef, strMfoB, nKvA_TT, strNlsB, strOkpoB, strNamB, nAmnt, dtVDat)') 
				! DG: Второй параметризованный вызов функции получения реквизитов
				If SalStrScan(strPar02,'F')>=0 ! Используется формула определения получателя и суммы
					If not sRCVRFName
						Set sRCVRFName='p_get_rcvr'
						! P_Get_Rcvr(swref_ IN NUMBER, okpo_ OUT VARCHAR2, mfo_ OUT VARCHAR2, 
								nls_ OUT VARCHAR2, kv_ OUT INTEGER, nazv_ OUT VARCHAR2, sum_ OUT NUMBER, datv_	 OUT DATE, val_ OUT NUMBER )
					If not SqlPLSQLCommand( hSql(),sRCVRFName||"(nSwRef, strOkpoB, strMfoB, strNlsB, nTmp, strNamB, nAmnt, dtVDat, nFlg)") 
						Call Debug('Нет обращения к '||sRCVRFName)
				! Наследование атрибутов предыдущего платежа отменено
				If NOT fKeepAttributes
					Set strLast_TT = sSWT_TT
					Set strLast_Nazn = ''
					Call SalArraySetUpperBound( strLast_Dp, 1, -1 )
				!
				Set bDocStart=TRUE
				Set sTT   = sSWT_TT
				Set dfNazn = strLast_Nazn
				Set nId   = GetUserId()
				Set aFlg[3] = TRUE  ! Дата валютирования 1
				Call SqlPrepareAndExecute(hSql(),T("
						SELECT t.name,t.flags,t.fli,t.flv,t.dk,t.sk,t.nlsa,t.nlsb,t.KV,t.KVK
						  INTO :sTTN,:sFlags,:nFli,:nFlv,
						       :nDk,:nSk,:sTNlsA,:sTNlsB,:nKvA_TT,:nKvB_TT
						  FROM tts t WHERE t.tt=:sTT"))
				If not SqlFetchNext(hSql(),nFetchRes)
					Call SalMessageBox( CurrentLangTable.GetAtomTitle('frmDoc.cTErrTT') || " "||sTT, 'DlgMSG_Error', MB_IconExclamation)
					Call SalDestroyWindow(hWndForm)
				If sTT='D07' or sTT='D06'
					Set sGetXRate = STRING_Null ! Имя функции получения кросс курса
				Call Flgs2aFlg(sFlags)
				! что-то надо делать с датой 
				Set bFixValD1 = TRUE
				Set dFixValD1 = dtVDat
				If nFli = 1
					! Set bFixValD1 = FALSE
					If GetGlobalOption('SWTVFDOC') = '1'
						If dtVDat < GetBankDate()
							Set dFixValD1 = GetBankDate()
					Else
						Set dFixValD1 = GetBankDate()
				! MIK для НадраБанк: По параметру завжди встановлюємо дату валютування поточну банківську
				If GetGlobalOption('SWTDVCUR') = '1'
					Set dFixValD1 = GetBankDate()
				! DG: Для информационных документов валюта может быть не задана
				If sLcv != STRING_Null
					If SqlPrepareAndExecute(hSql(), "SELECT kv,dig INTO :nKvA_TT,:nDigA FROM tabval WHERE lcv=:sLcv" ) 
						If not SqlFetchNext(hSql(),nFetchRes)
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('frmDoc.cTErrKV') || " "||sLcv, 'DlgMSG_Error', MB_IconExclamation)
							Call SalDestroyWindow(hWndForm)
						If not nFlv
							Set nKvB_TT = nKvA_TT
							Set nDigB   = nDigA
				!
				Set nS = nAmnt/SalNumberPower(10, nDigA)
				If nS = 0
					Set nS = NUMBER_Null
					! Call Debug('Summ  is NULL')
				If nDk = 1 OR nDk = 3  !! кредитовая операция
					If strNlsA
						Set sNlsA_TT=strNlsA
					Else
						Set sNlsA_TT=sTNlsA
					If strNlsB
						Set sNlsB_TT=strNlsB
					Else
						Set sNlsB_TT=sTNlsB
				Else !! дебетовая операция 
					If strNlsB != STRING_Null
						Set sNlsA_TT=strNlsB
					Else
						Set sNlsA_TT=sTNlsA
					If strNlsA != STRING_Null
						Set sNlsB_TT=strNlsA
					Else
						Set sNlsB_TT=sTNlsB
				! MOS -- прихоти Ощада по операции D07
				If GetGlobalOption('SW_D07') = '1' AND sTT='D07'
					Set sNlsB_TT = STRING_Null
					Set strOkpoB = STRING_Null
					Set strNamB = STRING_Null
					Set nS = nTmpS
					! Достанем наименование банка
					Call SqlPrepareAndExecute(hSql(),"SELECT substr(bars_swift.get_name_bank(:nSwRef),1,150) INTO :sNameBank  FROM dual")
					Call SqlFetchNext(hSql(),nFetchRes)
					! Формируем назначение платежа
					Set strLast_Nazn = 'Комісія за п/д на суму '||SalFmtFormatNumber( nAmnt/100, '999999999.00' )||' від '||SalFmtFormatDateTime( dtVDat, 'dd/MM/yyyy' )||' - '||sNameBank
				If GetGlobalOption('SW_D07') = '1' AND sTT='830' AND (nMt=490 OR nMt=456)
					Set sNlsB_TT = sNlsA_TT
					Set sNlsA_TT = STRING_Null
				!
				If strMfoB
					Set sBankB_TT=strMfoB
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmDoc.cTTitle') || ' [ ' ||sTTN|| ' ].')
				Call ShowApdVersion('01')
				If not aFlg[9] ! nFsk некассовые
					Set nSk_TT=NUMBER_Null
				!
				! Выясним возможность обратной перекодировки
				If SalStrLeftX( sMtRef, 1) = '+'
					Set fCanTranslit = TRUE
					Set sCharSet = 'RUR6'
				Else
					If SqlPrepareAndExecute( hSqlAux(), "SELECT chrset, transback INTO :sCharSet, :nTransBack FROM sw_banks WHERE bic=:sSndr")
						If SqlFetchNext( hSqlAux(), nInd )
							If NOT sCharSet
								Set sCharSet = 'TRANS'
							If nTransBack
								Set fCanTranslit = TRUE
				!
				Call SalSendClassMessage( UM_Clear, 0, 0)
				If GetGlobalOption('SW_D07') = '1' AND sTT='D07'
					Set nTmpSa = dfSumB/SalNumberPower(10, nDigB)
				! --- WindowS ReSize ---
				Set nWinW=10
				Set nWinH=7.1
				Call SalSetWindowSize ( hWndForm , nWinW, nWinH )
				Call SalSendMsgToChildren( hWndForm, UM_ParentSize, nWinW, nWinH )
				Call SalInvalidateWindow ( hWndForm )
				! Call Debug(SalFmtFormatDateTime(dFixValD1, 'dd-mon-yyyy'))
			On UM_Insert
				Call SalSendClassMessage(UM_Insert, 0, 0)
				Call SalDisableWindow(pbNewDoc)
			On SAM_Destroy
				Call SqlRollback(hSql())   ! Разлочим если чего залочили
				Call SalEnableWindow(hWnd)
				Call SalSetFocus(hWnd)
				!
				Set strLast_Nazn = aVal[0]
				Call SalArrayGetUpperBound( aTag, 1, nInd )
				Set nNDpc = 0
				While nNDpc <= nInd
					Set strLast_Dp[nNDpc] = aVal[nNDpc]
					Set nNDpc = nNDpc + 1
				If SalStrScan(strPar02,'E')>=0
					Call SalSendMsg( frm_TBK.StmtHdr, SAM_DoubleClick, 0, 0)
				Else
					Call SalPostMsg( hWnd, UM_Populate, 0, 0 )
			On SAM_CreateComplete
				Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
				If GetGlobalOption('SW_D07') = '1' AND sTT='D07'
					If VisArrayFindString (aTag, 'KOD_N')>0
						Set i=VisArrayFindString (aTag, 'KOD_N')
						Set frmDoc.aVal[i] = '2443003'
					If VisArrayFindString (aTag, 'KOD_G')>0
						Call SqlPrepareAndExecute(hSql(),"select KODC into :sKOD_G from bopcount where substr(ISO_COUNTR,1,2) in(select substr(sender, 5,2) from v_sw_impmsg where swref=:nSwRef) and rownum=1")
						Call SqlFetchNext(hSql(),nFetchRes)
						Set i=VisArrayFindString (aTag, 'KOD_G')
						Set frmDoc.aVal[i] = sKOD_G
	!
	Table Window: tblShowUBM		! 05
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Просмотр неразобранных и необработанных SWIFT сообщений
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.32"
				Top:    0.267"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Просмотр неразобраных и необработанных SWIFT сообщений
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5531
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.217"
						Begin Y:  Class Default
						End X:  5.217"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.35"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44688
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.55"
						Begin Y:  -0.012"
						End X:  4.55"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbReDistrib
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('tblShowUBM.cBTipReDistrib')
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
								! Get NewUserId
								If NOT SalModalDialog( dlg_PickUpUser, hWndForm, nNewUId )
									Return FALSE
								!
								Set nIRow = TBL_MinRow
								While SalTblFindNextRow( hWndForm, nIRow, ROW_Selected, 0 )
									Call SalTblSetContext( hWndForm, nIRow )
									Call Fun_ReDistrib( tblShowUBM.colId, nNewUId )
								Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
							Else
								Call SalMessageBeep( MB_IconAsterisk )
								Call SalMessageBox( CurrentLangTable.GetAtomTitle('tblShowUBM.cTMess1'), 
										  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconAsterisk )
				Line
					Resource Id: 5532
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5533
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: cpb_Timer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.9"
						Top:    0.135"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.292"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On UM_TimerFired
							Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
		Contents
			Column: colId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						пользователя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLog
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рабочее имя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.743"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colFIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ФИО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colMes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Неразобранных сообщений
						всего
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  3.114"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Fun_ReDistrib
				Description: перераспределение пользовательских документов
				Returns
					Boolean:
				Parameters
					Number: nFromId
					Number: nToId
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					If nFromId = nToId
						Return TRUE
					! DG: Заменил на вызов функции
					If SqlPLSQLCommand(hSql(), "bars_swift.impmsg_message_changeuser(NUMBER_Null, nFromId, nToId)")
						Call SqlCommitEx(hSql(), "Сообщения перераспределены.")
						Return TRUE
					Else
						Call SqlRollbackEx(hSql(), "Сообщения не перераспределены.")
						Return FALSE
					! If SqlPrepareAndExecute( hSql(), 'UPDATE sw_journal SET id=:nToId WHERE
							id=:nFromId AND swref NOT IN (SELECT swref FROM sw_oper)' )
						                                                                                                             Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tblShowUBM.cTPMess') || ' (' || 
								SalNumberToStrX(nFromId, 0) || ') -> (' || SalNumberToStrX(nToId, 0) || ')' )
						                                                                                                             Return TRUE
					! Else 
						                                                                                                             Return FALSE
					Call SalWaitCursor( FALSE )
		Window Parameters
		Window Variables
			Number: nInterval
			String: sNewWhere
			String: sNewFrom
			Number: nTmp
			Number: nIRow
			Number: nNewUId
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tblShowUBM.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Set tblShowUBM.nFlags = GT_ReadOnly
				! Set fFilterAtStart=TRUE
				! Set tblShowUBM.strFilterTblName = 'STAFF'
				Set tblShowUBM.strPrintFileName = 'Showubm.txt'
				Call SalDisableWindow( tblShowUBM.pbIns )
				Call SalDisableWindow( tblShowUBM.pbDel )
				Call SalDisableWindow( tblShowUBM.pbUpdate )
				Call SalDisableWindow( tblShowUBM.pbDetails )
				Set nInterval=300
				Call cpb_Timer.Init(nInterval, 0, TRUE)
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call SalWaitCursor( FALSE )
			On UM_Populate
				! If fFilterAtStart
					                                                  Call SetQueryFilter( cF )
					                                                  Set fFilterAtStart = NOT fFilterAtStart
				! Call SalWaitCursor(TRUE)
				! Set sNewWhere = cF.GetFilterWhereClause( FILTER_Complex)
				! Set sNewFrom = cF.GetFilterFromClause( FILTER_Complex )
				! If sNewWhere != ''
					                                                  Set sNewWhere = ' AND ' || sNewWhere 
				! If sNewFrom  != ''
					                                                  Set sNewFrom = ' , ' || sNewFrom 
				Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
			On SAM_User
				Call SalWaitCursor( TRUE )
				! Set strDSql = "
						      SELECT sw_journal.id, staff.logname, decode(sw_journal.id, NULL, 'Нераспределенные', staff.fio), count(*)  
						      INTO :hWndForm.tblShowUBM.colId, :hWndForm.tblShowUBM.colLog, 
						           :hWndForm.tblShowUBM.colFIO, :hWndForm.tblShowUBM.colMes 
						      FROM sw_journal , staff "|| sNewFrom ||"
						      WHERE staff.ID(+)=sw_journal.ID AND 
						            sw_journal.swref NOT IN (SELECT swref FROM sw_oper) AND 
						            sw_journal.mt NOT IN (select mt from sw_stmt) " || 
						            sNewWhere ||"
						      GROUP BY sw_journal.id, staff.logname, staff.fio"
				!
				Set strDSql = "
						      SELECT id, logname, fio, cnt  
						      INTO :hWndForm.tblShowUBM.colId, :hWndForm.tblShowUBM.colLog, 
						           :hWndForm.tblShowUBM.colFIO, :hWndForm.tblShowUBM.colMes 
						      FROM v_sw_staff_messages"
				Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
				Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
				Set nTmp = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nTmp)
				Set colFIO=CurrentLangTable.GetAtomTitle('tblShowUBM.cTItog') || ':'
				Set colMes = SalTblColumnSum( tblShowUBM, 4, 0, 0 )
				Call VisTblAutoSizeColumn( tblShowUBM, hWndNULL )
				Call SalTblSetContext(hWndForm, 0)
				Call SalWaitCursor(FALSE)
	Dialog Box: dlg_PickUpUser		! 06
		Class:
		Property Template:
		Class DLL Name:
		Title: Выберите пользователя...
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.017"
				Width Editable? Yes
				Height: 3.488"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Выбрать операцию для обработки SWIFT сообщения.
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblSWUsers
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.017"
						Top:    0.024"
						Width:  6.867"
						Width Editable? Yes
						Height: 2.274"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								пол.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ф.И.О.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nIterator
					Number: nRow
				Message Actions
					On SAM_Create
						Call SalWaitCursor( TRUE )
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						!
						! Call SalTblPopulate( hWndItem, hSql(), 
								'SELECT id, fio INTO :colId, :colName FROM staff WHERE id IN
								 (SELECT id FROM SW_STAFF_LIST)', TBL_FillAll )
						Call SalTblPopulate( hWndItem, hSql(),
								"select distinct id, fio
								    from v_sw_staff", TBL_FillAll)
					On SAM_DoubleClick
						Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: В&ыбрать
				Window Location and Size
					Left:   1.1"
					Top:    2.512"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nUId = tblSWUsers.colId
						Call SalEndDialog( hWndForm, 1 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: О&тменить
				Window Location and Size
					Left:   3.917"
					Top:    2.512"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 0 )
		Functions
		Window Parameters
			Receive Number: nUId
		Window Variables
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_PickUpUser.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
			On SAM_CreateComplete
				Call SalWaitCursor( FALSE )
			On SAM_Close
				Call SalEndDialog( hWndForm, 0 )
	!
	Form Window: frm_SwReestr		! 07
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.683"
				Width Editable? Yes
				Height: 5.321"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Формирование реестра сообщений для подчиненных
				банков
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Дата формирования:
				Resource Id: 10217
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.171"
					Top:    0.19"
					Width:  2.414"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgReeDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfReeDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.814"
						Top:    0.156"
						Width:  1.614"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbEditDirs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbEdit
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.45"
					Top:    0.107"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = CurrentLangTable.GetAtomTitle('frm_SwReestr.cBTipEditDirs')
					On SAM_Click
						Call FunNSIEditControlled( 'SW_REG_DIRS', tblOblUpr, SAM_Create )
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.883"
					Top:    0.107"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = CurrentLangTable.GetAtomTitle('frm_SwReestr.cBTipRefresh')
					On SAM_Click
						Call SalSendMsg( tblOblUpr, SAM_Create, 0, 0 )
			Frame
				Resource Id: 10218
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.05"
					Top:    0.024"
					Width:  7.383"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfPath
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.05"
						Top:    0.56"
						Width:  7.383"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Arial Cyr
					Font Size: 8
					Font Enhancement: Bold
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Check Box: cbFull
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Переформировать ВСЕ сообщения
				Window Location and Size
					Left:   0.083"
					Top:    0.845"
					Width:  4.133"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_SwReestr.cFTipFull') )
					On SAM_Click
						If MyValue
							Call SalMessageBeep ( MB_IconAsterisk )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMess1'),
									CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
			Child Table: tblOblUpr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.05"
						Top:    1.131"
						Width:  7.383"
						Width Editable? Yes
						Height: 3.104"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial Cyr
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colRnk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ид.
								Управления
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.329"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.167"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSubDir
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalWaitCursor( TRUE )
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						Call SalTblPopulate( hWndItem, hSql(), T(
								"SELECT c.rnk, c.nmk, d.dir INTO :colRnk, :colName, :colSubDir 
								 FROM customer c, OUTER sw_reg_dirs d 
								 WHERE c.rnk=d.rnk ORDER BY c.rnk"), TBL_FillAll )
						Call SalWaitCursor( FALSE )
			Pushbutton: pbAll
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Для ВСЕХ
				Window Location and Size
					Left:   0.1"
					Top:    4.405"
					Width:  2.043"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call f_Iterator( 0 )
			Pushbutton: pbSelected
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Для ВЫБРАННЫХ
				Window Location and Size
					Left:   2.217"
					Top:    4.405"
					Width:  2.043"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call f_Iterator( ROW_Selected )
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   5.5"
					Top:    4.405"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow( hWndForm )
		Functions
			Function: f_MakeSwiftReg
				Description: Сформировать реестри свифтовок для одного управления
				Returns
					Boolean:
				Parameters
					Number: nRnk
					String: sName
					String: sDir
				Static Variables
				Local variables
					String: strFileName
					String: strPath
					File Handle: hFile
					Number: nSRef
					Number: nRef
					Number: nMT
					Number: nI
					Number: nDone
					Number: nExist
					String: sNum
					String: sFile
					!
					Boolean: fFileOpen
					!
					: COpldok
						Class: cABSConnect
					: CSwoper
						Class: cABSConnect
				Actions
					Call SalWaitCursor( TRUE )
					!
					Call XConnectGetParams( COpldok )
					If NOT COpldok.Connect(  )
						Call SalMessageBeep( MB_IconStop )
						Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTErrConnect'), 'Intrnal Error', MB_IconStop | MB_Ok )
						Return FALSE
					Call CSwoper.Clone( COpldok, FALSE )
					If NOT CSwoper.Connect(  )
						Call SalMessageBeep( MB_IconStop )
						Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTErrConnect'), 'Intrnal Error', MB_IconStop | MB_Ok )
						Call COpldok.Disconnect(  )
						Return FALSE
					!
					Set strPath = strTargetDir 
					If sDir
						Set strPath = strPath || '\\' || sDir 
					!
					If cbFull
						If NOT SqlPrepareAndExecute( hSql(), "DELETE FROM SW_SB_TELEX WHERE rnk=:nRnk AND fdat=" ||
								DateInQuery( SalFmtFormatDateTime( dfReeDate, 'MM/dd/yyyy')) )
							Return FALSE
						Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessDel')|| ' rnk: ' || 
								SalNumberToStrX( nRnk, 0 ) || ' ' || CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForDat') || ': ' || SalFmtFormatDateTime( dfReeDate, 'dd/MM/yyyy') )
					!
					If SqlPrepareAndExecute( COpldok.hSql(), 
							"SELECT DISTINCT o.ref, r.swref, s.fn, substr(s.fn, -3) INTO :nRef, :nSRef, :sFile, :sNum  
							 FROM opldok o, sw_sb_telex s, sw_oper r 
							 WHERE 
							 o.fdat=" || DateInQuery( SalFmtFormatDateTime( dfReeDate, 'MM/dd/yyyy') ) ||
							" AND o.sos=5 AND o.acc IN (SELECT acc FROM cust_acc WHERE rnk=:nRnk ) AND
							      r.ref=o.ref AND o.ref=s.ref(+) 
							 ORDER BY s.fn, o.ref " )
						Set nDone = 0
						Set nI = 0
						While SqlFetchNext( COpldok.hSql(), nFetchRes )
							If sFile 
								If cbFull
									Set fFileOpen = SalFileOpen( hFile, strPath || '\\' || sFile, OF_Create | OF_Write | OF_Text )
									If fFileOpen
										Call SalFilePutStr(hFile, 'FILE: ' || strFileName || SalStrRepeatX(' ', 19) || 
												                          'DATE: ' || SalFmtFormatDateTime( SalDateCurrent(), 'dd-MM-yyyy' ) || '  ' ||
												                          'TIME: ' || SalFmtFormatDateTime( SalDateCurrent(), 'hhhh:mm:ss' ) )
										Call SalFilePutStr(hFile, SalStrRepeatX( '-', 75 ))
										Call SalFilePutStr(hFile, '	---------------------  Instance Type and Transmission --------------	')
										Call SalFilePutStr(hFile, '  Notification (Transmission)')
										Call SalFilePutStr(hFile, '  Priority          : Normal')
										Call SalFilePutStr(hFile, StrWinToDosX( Sw_MtAsText2( hSqlAux(), nSRef )) )
										Call SalFilePutStr(hFile, '')
										Set nDone = nDone + 1
									Else
										Call SalMessageBeep( MB_IconStop )
										Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTErrFileCreate') || ' ' || strPath || '\\' || sFile, CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok )
								If SalStrIsValidNumber( sNum )
									Set nI = SalStrToNumber( sNum )
								Else
									Set nI = f_36ToDec( sNum )
							Else
								! Увеличиваем номер счетчика дял следующего файла
								Set nI= nI + 1
								! берем номер МТ сообщения
								If SqlPrepareAndExecute( CSwoper.hSql( ), 
										"SELECT j.mt INTO :nMT  FROM sw_journal j
										 WHERE j.swref = :nSRef" )
									Call SqlFetchNext( CSwoper.hSql(), nFetchRes )
								Set nExist = 0
								! Если 900ые, то проверим нет ли еще кроме них сообщений
								If nMT >= 900
									If SqlPrepareAndExecute( CSwoper.hSql( ), "SELECT swref INTO :nExist FROM sw_oper WHERE swref<>:nSRef AND ref=:nRef" )
										If NOT SqlFetchNext( CSwoper.hSql( ), nFetchRes )
											Set nExist = 0
								! печатаем, если нет препятствий
								If NOT nExist
									Set fFileOpen = FALSE
									If NOT fFileOpen
										Set strFileName = 'sw'||SalFmtFormatDateTime( dfReeDate, 'ddMMyy' )||'.'
										If nI <= 999
											Set strFileName = strFileName || SalStrRightX( '000' || SalNumberToStrX( nI, 0 ), 3 )
										Else
											Set strFileName = strFileName || SalStrRightX( '000' || f_DecTo36( nI ), 3 )
										Set fFileOpen = SalFileOpen( hFile, strPath || '\\' || strFileName, OF_Create | OF_Write | OF_Text )
										If NOT fFileOpen
											Call SalMessageBeep( MB_IconStop )
											Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTErrFileCreate') || ' ' || strPath || '\\' || strFileName, CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok )
									If fFileOpen
										Call SalFilePutStr(hFile, 'FILE: ' || strFileName || SalStrRepeatX(' ', 19) || 
												                          'DATE: ' || SalFmtFormatDateTime( SalDateCurrent(), 'dd-MM-yyyy' ) || '  ' ||
												                          'TIME: ' || SalFmtFormatDateTime( SalDateCurrent(), 'hhhh:mm:ss' ) )
										Call SalFilePutStr(hFile, SalStrRepeatX( '-', 75 ))
										Call SalFilePutStr(hFile, '	---------------------  Instance Type and Transmission --------------	')
										Call SalFilePutStr(hFile, '  Notification (Transmission)')
										Call SalFilePutStr(hFile, '  Priority          : Normal')
										Call SalFilePutStr(hFile, StrWinToDosX( Sw_MtAsText2( hSqlAux(), nSRef )) )
										Call SalFilePutStr(hFile, '')
										If SqlPrepareAndExecute( hSqlAux(), 
												"INSERT INTO sw_sb_telex (ref, swref, rnk, fdat, fn, dat ) 
												 VALUES (:nRef, :nSRef, :nRnk, " || 
												 DateInQuery( SalFmtFormatDateTime( dfReeDate, 'MM/dd/yyyy') ) || 
												",:strFileName, SYSDATE )" )
											Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessOtm1')|| ' ref: ' ||
													SalNumberToStrX( nRef, 0 ) || ', swref: ' || SalNumberToStrX( nSRef, 0 ) ||
													' ' || CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForDat') || ': ' || SalFmtFormatDateTime( dfReeDate, 'MM/dd/yyyy')  )
											Set nDone = nDone + 1
										Call SalFileClose( hFile )
										Set fFileOpen = FALSE
						If nDone
							Call SqlCommitEx( hSqlAux(), CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessOtm2') || ' rnk: ' || 
									SalNumberToStrX( nRnk, 0 ) || ' ' || CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForDat') || ': ' || SalFmtFormatDateTime( dfReeDate, 'dd/MM/yyyy') )
							Call SalMessageBeep ( MB_IconAsterisk )
							Call MessageInfo( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForKlient') || ' "' || sName || '" ' || CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForKlient1') || ' ' || SalNumberToStrX(nDone, 0) || ' ' || 
									  CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForKlient2') || '.' )
						Else
							Call SalMessageBeep ( MB_IconAsterisk )
							Call MessageInfo( CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForKlient') || ' "' || sName || '" ' || CurrentLangTable.GetAtomTitle('frm_SwReestr.cTMessForKlient3') || '.' )
					If CSwoper.IsConnected(  )
						Call CSwoper.Disconnect(  )
					If COpldok.IsConnected(  )
						Call COpldok.Disconnect(  )
					Call SalWaitCursor( FALSE )
					Return TRUE
			Function: f_Iterator
				Description: Итератор по ОУ
				Returns
					Boolean:
				Parameters
					Number: nRowFlag
				Static Variables
				Local variables
					Number: nRow
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( tblOblUpr, nRow, nRowFlag, 0 )
						Call SalTblSetContext( tblOblUpr, nRow )
						Call f_MakeSwiftReg( tblOblUpr.colRnk, tblOblUpr.colName, tblOblUpr.colSubDir )
						Call SalTblSetRowFlags( tblOblUpr, nRow, ROW_Selected, FALSE )
					Set cbFull = FALSE
					Return TRUE
			Function: Sw_MtAsText2
				Description: Возвращает текстовое представление SWIFT
						сообщения по его референсу
				Returns
					String:
				Parameters
					Sql Handle: hSql_
					Number: nSwRef_
				Static Variables
				Local variables
					! Атрибуты сообщения
					Number: nRef
					Number: nMt
					String: sIO
					String: sSW_Name
					String: sSender
					String: sReceiver
					String: sSenderName
					String: sReceiverName
					String: sSenderCity
					String: sReceiverCity
					String: sCurrencyISO
					Number: nAmount
					! Атрибуты тэгов
					String: sTag
					String: sTagName
					Long String: sValue
					!
					String: sDate
					String: sCurr
					String: sAmnt
					! Др.
					Number: nFetchRes
					String: Result
					String: sMsgHeader
					String: sMsgText
					String: sMsgTrailer
					String: sEOL
				Actions
					Set Result = ''
					! Init
					Set sMsgHeader = '	--------------------------- Message Header -------------------------	'
					Set sMsgText   = '	--------------------------- Message Text ---------------------------	'
					Set sMsgTrailer= '	--------------------------- Message Trailer ------------------------	'
					Set sEOL = SalNumberToChar( 13 ) || SalNumberToChar( 10 )
					If SqlPrepareAndExecute( hSql_, '
							SELECT
							  O.REF,
							  J.MT,
							  J.IO_IND,
							  M.NAME,
							  J.SENDER,
							  B1.NAME,
							  B1.CITY,
							  J.RECEIVER,
							  B2.NAME,
							  B2.CITY,
							  J.CURRENCY,
							  J.AMOUNT/100
							INTO
							  :nRef,
							  :nMt,
							  :sIO,
							  :sSW_Name,
							  :sSender,
							  :sSenderName,
							  :sSenderCity,
							  :sReceiver,
							  :sReceiverName,
							  :sReceiverCity,
							  :sCurrencyISO,
							  :nAmount
							FROM
							  SW_JOURNAL J, SW_OPER O, SW_MT M, SW_BANKS B1, SW_BANKS B2
							WHERE
							  J.SWREF = O.SWREF (+) AND
							  J.MT = M.MT AND
							  J.SENDER = B1.BIC (+) AND J.RECEIVER = B2.BIC (+) AND
							  J.SWREF = :nSwRef_' )
						If SqlFetchNext( hSql_, nFetchRes )
							! Формируем Заголовок
							Set Result = Result || '  ABS Reference  : '
							If nRef
								Set Result = Result || SalNumberToStrX( nRef, 0 )
							Set Result = Result || sEOL
							Set Result = Result || sMsgHeader || sEOL
							Set Result = Result || '  Swift Output   : ' || sSW_Name || sEOL
							Set Result = Result || '  Sender       	 : ' || sSender || sEOL
							Set Result = Result || SalStrRepeatX( ' ', 4 ) || SalStrUpperX(sSenderName) || sEOL
							Set Result = Result || SalStrRepeatX( ' ', 4 ) || SalStrUpperX(sSenderCity) || sEOL
							Set Result = Result || '  Receiver       : ' || sReceiver || sEOL
							Set Result = Result || SalStrRepeatX( ' ', 4 ) || SalStrUpperX(sReceiverName) || sEOL
							Set Result = Result || SalStrRepeatX( ' ', 4 ) || SalStrUpperX(sReceiverCity) || sEOL
							Set Result = Result || sMsgText || sEOL
							! Формируем тело
							If SqlPrepareAndExecute( hSql_, "
									SELECT
									  TAG || NVL(OPT, '' ),
									  replace(VALUE, chr(13) || chr(10), chr(13) || chr(10) || '       '),
									  substr(bars_swift.get_message_fieldname(:nMt, seq, tag, opt), 1, 70)
									INTO
									  :sTag,
									  :sValue,
									  :sTagName
									FROM
									  SW_OPERW
									WHERE
									         SWREF = :nSwRef_
									ORDER BY N" )
								While SqlFetchNext( hSql_, nFetchRes )
									Set Result = Result || PadL( sTag || ':', 6 ) || ' ' || sTagName || sEOL
									If sTag='32A'
										Set sDate =
												SalFmtFormatDateTime(
													SalFmtFormatStrDateTime(
													  SalStrMidX( SalStrTrimX( sValue ), 0, 6 ),
													  'yyMMdd' ),
													'dd MMMM yyyy' )
										Set sCurr = SalStrMidX( SalStrTrimX( sValue ), 6, 3 )
										Set sAmnt = SalStrMidX( SalStrTrimX( sValue ), 9, 26 )
										Set Result = Result || '       Date           : ' || sDate || sEOL
										Set Result = Result || '       Currency       : ' || sCurr || sEOL
										Set Result = Result || '       Amount         : ' ||
												PadL( '#' || sAmnt || '#' , 26 ) || sEOL
									Else If sTag='33B' OR sTag='71F' OR sTag='71G'
										Set sCurr = SalStrMidX( SalStrTrimX( sValue ), 0, 3 )
										Set sAmnt = SalStrMidX( SalStrTrimX( sValue ), 3, 26 )
										Set Result = Result || '       Currency       : ' || sCurr || sEOL
										Set Result = Result || '       Amount         : ' ||
												PadL( '#' || sAmnt || '#' , 26 ) || sEOL
									Else
										! While SalStrLength( sValue ) > 40
											                                                                                             Set Result = Result || '       ' || SalStrLeftX( sValue, 40 ) || sEOL
											                                                                                             Set sValue = SalStrMidX( sValue, 40, SalStrLength( sValue )-40 )
										Set Result = Result || '       ' || sValue || sEOL
							! Формируем окончание
							Set Result = Result || sMsgTrailer || sEOL
					Return Result
		Window Parameters
		Window Variables
			String: strTargetDir
		Message Actions
			On SAM_Create
				Call SalSetWindowLoc(hWndForm, 0, 0)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwReestr.cTWndTitle'))
				Call ShowApdVersion('07')
				Call PrepareWindowEx(hWndForm)
				!
				Call SalUseRegistry( FALSE, GetCompanyName() )
				Call SalGetProfileString( 'Directory', 'SWIFTReeDir', GetPrnDir(), strTargetDir, GetIniFileName() )
				Set dfPath = strTargetDir
				Set dfReeDate = GetBankDate()
				Call SalSetFocus( pbAll )
				Call XSalTooltipSetUserDefault(  )
	Form Window: frm_SwMakeStmt
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Формирование выписок (MT-950)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.0"
				Width Editable? Class Default
				Height: 8.631"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48526
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48527
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSelectAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    0.06"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Выбрать всех
							Set strTip = CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.pbSelectAll')
						On SAM_Click
							Call SalTblSetFlagsAnyRows(tblBankList, ROW_Selected, TRUE, 0, 0)
				Pushbutton: pbExecute
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.45"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Сформировать
							Set strTip = CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.pbExecute')
						On SAM_Click
							Call tblBankList.FunCreateSWIFTStmt()
							Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTExec'))
				Line
					Resource Id: 48529
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.0"
						Begin Y:  0.0"
						End X:  5.0"
						End Y:  0.45"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.1"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48528
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  5.65"
						Begin Y:  Class Default
						End X:  5.65"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.1"
					Top:    0.15"
					Width:  8.4"
					Width Editable? Yes
					Height: 0.604"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
			Background Text: Период формирования выписки
				Resource Id: 48523
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.07"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgPeriod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Начало:
				Resource Id: 48524
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.4"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Arial
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgCC1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Custom Control: cc1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendarDropDown
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   1.9"
						Top:    0.4"
						Width:  1.8"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Arial Cyr
					Font Size: 10
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc1.SetMonthText( strCMonth )
						Call cc1.SetWeekDayText( strCDays )
						Call cc1.WeekStartSet( 2 )
					On SAM_CustControlCmd
						If wParam = 2
							Call SalGetWindowText( hWndItem, strChosenDate, 15 )
							If strChosenDate
								Set dtSTbegin = SalFmtFormatStrDateTime( strChosenDate, 'dd/MM/yyyy' )
			Background Text: Окончание:
				Resource Id: 48525
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.8"
					Top:    0.4"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Arial Cyr
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgCC2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Custom Control: cc2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendarDropDown
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   5.5"
						Top:    0.4"
						Width:  1.8"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Arial Cyr
					Font Size: 10
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc2.SetMonthText( strCMonth )
						Call cc2.SetWeekDayText( strCDays )
						Call cc2.WeekStartSet( 2 )
					On SAM_CustControlCmd
						If wParam = 2
							Call SalGetWindowText( hWndItem, strChosenDate, 15 )
							If strChosenDate
								Set dtSTend = SalFmtFormatStrDateTime( strChosenDate, 'dd/MM/yyyy' )
			Child Table: tblBankList
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.1"
						Top:    0.85"
						Width:  11.583"
						Width Editable? Class Default
						Height: 3.452"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colRNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: РНК
						Visible? Class Default
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colBIC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: BIC
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSTMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSTMT_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вид выписки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: FunCreateSWIFTStmt
						Description: Создать выписку для отдельного банка.
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
							String: s
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
								Call SalTblSetContext(hWndForm, nRow)
								! Обрабатывается контрагент BIC=colBIC (colRNK)
								Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess1')|| ' BIC=' || colBIC || " (" || SalNumberToStrX(colRNK, 0) || ")")
								! Формируется SWIFT выписка для контрагента RNK=colRNK
								Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess2')|| " RNK=" || SalNumberToStrX(colRNK, 0))
								Set s = 
										"BEGIN SWIFT.CreateCustomerStatementMessage(" || 
										       "'"|| colBIC || "', " ||
										       SalNumberToStrX(colRNK, 0) || ", " ||
										       "TO_DATE('" || SalFmtFormatDateTime( dtSTbegin, 'dd/MM/yyyy') || "','DD/MM/YYYY'), " ||
										       "TO_DATE('" || SalFmtFormatDateTime( dtSTend, 'dd/MM/yyyy') || "','DD/MM/YYYY'), " ||
										       SalNumberToStrX(colSTMT, 0) || "); " ||
										"END;"
								If SqlPrepareAndExecute(hSqlAux(), s)
									! Сформирована SWIFT выписка для контрагента RNK=colRNK
									Call SqlCommitEx(hSqlAux(), CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess3') || " RNK=" || SalNumberToStrX(colRNK, 0))
								Else
									Call SqlRollback(hSqlAux())
							!
							Return TRUE
				Window Variables
					Number: nCusttype
				Message Actions
					On SAM_DoubleClick
						Call SqlPrepareAndExecute(hSql(), "select custtype into :nCusttype from customer where rnk = :colRNK")
						Call SqlFetchNext(hSql(), nFetchRes)
						Call EditCustomer(nCusttype, NUMBER_Null, colRNK, CVIEW_ReadOnly | CVIEW_Accounts | AVIEW_ReadOnly, hWndForm, 0, '', FALSE)
		Functions
		Window Parameters
		Window Variables
			Date/Time: dtSTbegin
			Date/Time: dtSTend
			String: strCMonth[12]
			String: strCDays[7]
			String: strChosenDate
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeight
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				!
				Call GetMonthArrayRus(strCMonth)
				Call GetWeekDayArray(strCDays)
				Set dtSTbegin = SalDateCurrent()
				Set dtSTend = SalDateCurrent()
				Call SalStatusSetText(hWndForm, "")
				Set hWndForm.frm_SwMakeStmt.nFlags = GT_ReadOnly
				Set hWndForm.frm_SwMakeStmt.strFilterTblName = "SW_STMT_CUSTOMER_LIST"
				Set hWndForm.frm_SwMakeStmt.strPrintFileName = "SW_STMT_CUSTOMER_LIST"
				Set hWndForm.frm_SwMakeStmt.strSqlPopulate = 
						"SELECT SW_STMT_CUSTOMER_LIST.rnk, SW_STMT_CUSTOMER_LIST.nmk, SW_STMT_CUSTOMER_LIST.bic, SW_STMT_CUSTOMER_LIST.stmt, s.name
						   INTO :hWndForm.tblBankList.colRNK, :hWndForm.tblBankList.colNAME, :hWndForm.tblBankList.colBIC, :hWndForm.tblBankList.colSTMT, :hWndForm.tblBankList.colSTMT_NAME 
						   FROM SW_STMT_CUSTOMER_LIST, STMT s
						  WHERE SW_STMT_CUSTOMER_LIST.stmt = s.stmt
						  ORDER BY SW_STMT_CUSTOMER_LIST.nmk"
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call SalSetFocus(pbExit)
			On WM_Size
				Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
				Call SalSetWindowSize(hWndForm.frm_SwMakeStmt.tblBankList, 
						     SalPixelsToFormUnits( hWndForm.frm_SwMakeStmt.tblBankList, nWinWidth, FALSE)-0.2,
						     SalPixelsToFormUnits( hWndForm.frm_SwMakeStmt.tblBankList, nWinHeight, TRUE)-0.9)
	! cGenericTable: frm_SwMakeStmt_old2	! 08
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Формирование выписок (MT-950)
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.55"
				Width Editable? Yes
				Height: 5.781"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                             Description: 
		                             Named Menus 
		                             Menu 
		                             Tool Bar 
			                             Contents 
				                             Pushbutton: pbIns
					                             Message Actions 
				                             Pushbutton: pbDel
					                             Message Actions 
				                             Pushbutton: pbRefresh
					                             Message Actions 
				                             Pushbutton: pbUpdate
					                             Message Actions 
				                             Line 
				                             Pushbutton: pbSearch
					                             Message Actions 
				                             Pushbutton: pbFilter
					                             Message Actions 
				                             Pushbutton: pbDetails
					                             Message Actions 
				                             Pushbutton: pbPrint
					                             Message Actions 
				                             Line 
				                             Pushbutton: pbSelectAll
					                             Message Actions 
						                             On SAM_Create
							! Выбрать всех
							                             Set strTip = CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.pbSelectAll')
						                             On SAM_Click
							                             Call SalTblSetFlagsAnyRows(hWndForm, ROW_Selected, TRUE, 0, 0)
				                             Pushbutton: pbExecute
					                             Message Actions 
						                             On SAM_Create
							! Сформировать
							                             Set strTip = CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.pbExecute')
						                             On SAM_Click
							! Set nRow = TBL_MinRow
							! While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
								                              Call SalTblSetContext(hWndForm, nRow)
								                              Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess1')|| ' BIC=' || colBIC || " (" || SalNumberToStrX(colRNK, 0) || ")")
								                              Call FunCreateSWIFTStmt(colBIC, colRNK, dtSTbegin, dtSTend, colSTMT)
							                             Call FunCreateSWIFTStmt()
							                             Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTExec'))
				                             Line 
				                             Pushbutton: pbExit
					                             Message Actions 
				                             Line 
				                             Line 
				! Picture: pic1
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   0.1"
						Top:    0.6"
						Width:  7.3"
						Width Editable? Yes
						Height: 0.604"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					File Name:
					Storage: External
					Picture Transparent Color: None
					Fit: Scale
					Scaling
						Width:  100
						Height:  100
					Corners: Square
					Border Style: Etched
					Border Thickness: 1
					Tile To Parent? No
					Border Color: 3D Shadow Color
					Background Color: 3D Face Color
.end
					                             Message Actions 
				! Background Text: Период формирования выписки
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.271"
						Top:    0.5"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Arial
					Font Size: 10
					Font Enhancement: Bold
					Text Color: 3D Shadow Color
					Background Color: Default
.end
				! cLabelControl: bgPeriod
					                             Message Actions 
				! Background Text: Начало:
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.2"
						Top:    0.75"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Arial
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				! cLabelControl: bgCC1
					                             Message Actions 
				! cCalendarDropDown: cc1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
					                             Message Actions 
						                             On SAM_Create
							                             Call cc1.SetMonthText(strCMonth)
							                             Call cc1.SetWeekDayText(strCDays)
							                             Call cc1.WeekStartSet(2)
						                             On SAM_CustControlCmd
							                             If wParam = 2
								                             Call SalGetWindowText(hWndItem, strChosenDate, 15)
								                             If strChosenDate
									                             Set dtSTbegin = SalFmtFormatStrDateTime(strChosenDate, 'dd/MM/yyyy')
				! Background Text: Окончание:
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.6"
						Top:    0.75"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Arial Cyr
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				! cLabelControl: bgCC2
					                             Message Actions 
				! cCalendarDropDown: cc2
.data CLASSPROPSSIZE
0000: 4200
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					                             Message Actions 
						                             On SAM_Create
							                             Call cc2.SetMonthText(strCMonth)
							                             Call cc2.SetWeekDayText(strCDays)
							                             Call cc2.WeekStartSet(2)
						                             On SAM_CustControlCmd
							                             If wParam = 2
								                             Call SalGetWindowText(hWndItem, strChosenDate, 15)
								                             If strChosenDate
									                             Set dtSTend = SalFmtFormatStrDateTime(strChosenDate, 'dd/MM/yyyy')
				                             Custom Control: cld1
					                             Message Actions 
		                             Contents 
			                             Column: colRNK
				                             List Values 
				                             Message Actions 
			                             Column: colBIC
				                             List Values 
				                             Message Actions 
			                             Column: colNAME
				                             List Values 
				                             Message Actions 
			                             Column: colSTMT
				                             List Values 
				                             Message Actions 
			                             Column: colSTMT_NAME
				                             List Values 
				                             Message Actions 
		                             Functions 
			                             Function: FunCreateSWIFTStmt
				                             Description: Создать выписку для отдельного банка.
				                             Returns 
					                             Boolean: 
				                             Parameters 
				                             Static Variables 
				                             Local variables 
					                             Number: nRow
					                             String: s
				                             Actions 
					                             Set nRow = TBL_MinRow
					                             While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
						                             Call SalTblSetContext(hWndForm, nRow)
						! Обрабатывается контрагент BIC=colBIC (colRNK)
						                             Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess1')|| ' BIC=' || colBIC || " (" || SalNumberToStrX(colRNK, 0) || ")")
						! Формируется SWIFT выписка для контрагента RNK=colRNK
						                             Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess2')|| " RNK=" || SalNumberToStrX(colRNK, 0))
						                             Set s = 
								"BEGIN SWIFT.CreateCustomerStatementMessage(" || 
								       "'"|| colBIC || "', " ||
								       SalNumberToStrX(colRNK, 0) || ", " ||
								       "TO_DATE('" || SalFmtFormatDateTime( dtSTbegin, 'dd/MM/yyyy') || "','DD/MM/YYYY'), " ||
								       "TO_DATE('" || SalFmtFormatDateTime( dtSTend, 'dd/MM/yyyy') || "','DD/MM/YYYY'), " ||
								       SalNumberToStrX(colSTMT, 0) || "); " ||
								"END;"
						                             If SqlPrepareAndExecute(hSqlAux(), s)
							! Сформирована SWIFT выписка для контрагента RNK=colRNK
							                             Call SqlCommitEx(hSqlAux(), CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess3') || " RNK=" || SalNumberToStrX(colRNK, 0))
						                             Else 
							                             Call SqlRollback(hSqlAux())
					!
					                             Return TRUE
		                             Window Parameters 
		                             Window Variables 
			                             Date/Time: dtSTbegin
			                             Date/Time: dtSTend
			                             String: strCMonth[12]
			                             String: strCDays[7]
			                             String: strChosenDate
		                             Message Actions 
			                             On SAM_Create
				! Присваиваем значения многоязыковым объектам
				                             Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				                             Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTWndTitle'))
				                             Call PrepareWindowEx(hWndForm)
				!
				                             Call GetMonthArrayRus(strCMonth)
				                             Call GetWeekDayArray(strCDays)
				                             Set dtSTbegin = SalDateCurrent()
				                             Set dtSTend = SalDateCurrent()
				                             Call SalStatusSetText(hWndForm, "")
				                             Set hWndForm.frm_SwMakeStmt.nFlags = GT_ReadOnly
				                             Set hWndForm.frm_SwMakeStmt.strFilterTblName = "SW_STMT_CUSTOMER_LIST"
				! Set hWndForm.frm_SwMakeStmt.strSqlPopulate = 
						"SELECT l.rnk, l.nmk, l.bic, l.stmt, s.name
						   INTO :hWndForm.frm_SwMakeStmt.colRNK, :hWndForm.frm_SwMakeStmt.colNAME, :hWndForm.frm_SwMakeStmt.colBIC, :hWndForm.frm_SwMakeStmt.colSTMT, :hWndForm.frm_SwMakeStmt.colSTMT_NAME 
						   FROM SW_STMT_CUSTOMER_LIST l, STMT s
						  WHERE l.stmt = s.stmt"
				                             Call SalSendClassMessage(SAM_Create, 0, 0)
	! Form Window: frm_SwMakeStmt_old		! 08
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Формирование выписок (MT-950)
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.583"
				Width Editable? Yes
				Height: 7.417"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                             Description: Форма ручного формирования выписок на банки
		                             Named Menus 
		                             Menu 
		                             Tool Bar 
			                             Contents 
		                             Contents 
			! Group Box: Период формирования выписки
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    0.071"
					Width:  7.4"
					Width Editable? Yes
					Height: 0.714"
					Height Editable? Yes
				Visible? Yes
				Font Name: Arial Cyr
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
.end
			                             Picture: pic1
				                             Message Actions 
			                             Background Text: Период формирования выписки
			                             Data Field: bgPeriod
				                             Message Actions 
			                             Background Text: Начало:
			                             Data Field: bgCC1
				                             Message Actions 
			                             Custom Control: cc1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
				                             Message Actions 
					                             On SAM_Create
						                             Call cc1.SetMonthText( strCMonth )
						                             Call cc1.SetWeekDayText( strCDays )
						                             Call cc1.WeekStartSet( 2 )
					                             On SAM_CustControlCmd
						                             If wParam = 2
							                             Call SalGetWindowText( hWndItem, strChosenDate, 15 )
							                             If strChosenDate
								                             Set dtSTbegin = SalFmtFormatStrDateTime( strChosenDate, 'dd/MM/yyyy' )
			                             Background Text: Окончание:
			                             Data Field: bgCC2
				                             Message Actions 
			                             Custom Control: cc2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
				                             Message Actions 
					                             On SAM_Create
						                             Call cc2.SetMonthText( strCMonth )
						                             Call cc2.SetWeekDayText( strCDays )
						                             Call cc2.WeekStartSet( 2 )
					                             On SAM_CustControlCmd
						                             If wParam = 2
							                             Call SalGetWindowText( hWndItem, strChosenDate, 15 )
							                             If strChosenDate
								                             Set dtSTend = SalFmtFormatStrDateTime( strChosenDate, 'dd/MM/yyyy' )
			                             Child Table: tblBankList
				                             Contents 
					                             Column: colRNK
						                             List Values 
						                             Message Actions 
					                             Column: colBIC
						                             List Values 
						                             Message Actions 
					                             Column: colNAME
						                             List Values 
						                             Message Actions 
					                             Column: colSTMT
						                             List Values 
						                             Message Actions 
					                             Column: colSTMT_NAME
						                             List Values 
						                             Message Actions 
				                             Functions 
				                             Window Variables 
				                             Message Actions 
					                             On SAM_Create
						! Присваиваем значения многоязыковым объектам
						                             Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						                             Call SalWaitCursor(TRUE)
						                             Call SalTblPopulate(hWndForm, hSql(), T(
								"SELECT l.rnk, l.nmk, l.bic, l.stmt, s.name
								   INTO :colRNK, :colNAME, :colBIC, :colSTMT, :colSTMT_NAME 
								   FROM SW_STMT_CUSTOMER_LIST l, STMT s
								  WHERE l.stmt = s.stmt"), TBL_FillAll)
						                             Call SalWaitCursor(FALSE)
			                             Pushbutton: pbFilter
				                             Message Actions 
			                             Pushbutton: pbRefresh
				                             Message Actions 
					                             On SAM_Click
						                             Call SalSendMsg(tblBankList, SAM_Create, 0, 0)
			                             Pushbutton: pbSelectAll
				                             Message Actions 
					                             On SAM_Click
						                             Call SalTblSetFlagsAnyRows(tblBankList, ROW_Selected, TRUE, 0, 0)
			                             Pushbutton: pbExecute
				                             Message Actions 
					                             On SAM_Click
						                             Set nRow = TBL_MinRow
						                             While SalTblFindNextRow(tblBankList, nRow, ROW_Selected, 0)
							                             Call SalTblSetContext(tblBankList, nRow)
							                             Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess1')|| ' BIC=' || tblBankList.colBIC || " (" || SalNumberToStrX(tblBankList.colRNK, 0) || ")")
							                             Call FunCreateSWIFTStmt(tblBankList.colBIC, tblBankList.colRNK, dtSTbegin, dtSTend, tblBankList.colSTMT)
						                             Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTExec'))
			                             Pushbutton: pbExit
				                             Message Actions 
					                             On SAM_Click
						                             Call SalDestroyWindow(hWndForm)
		                             Functions 
			                             Function: FunCreateSWIFTStmt
				                             Description: Создать выписку для отдельного банка.
				                             Returns 
					                             Boolean: 
				                             Parameters 
					                             String: bic_
					                             Number: rnk_
					                             Date/Time: dt1_
					                             Date/Time: dt2_
					                             Number: stmt_
				                             Static Variables 
				                             Local variables 
					                             String: s
				                             Actions 
					                             Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess2')|| " RNK=" || SalNumberToStrX(rnk_, 0))
					                             Set s = "BEGIN SWIFT.CreateCustomerStatementMessage(" || 
							"'"|| bic_ || "', " ||
							SalNumberToStrX(rnk_, 0) || ", " ||
							"TO_DATE('" || SalFmtFormatDateTime( dt1_, 'dd/MM/yyyy') || "','DD/MM/YYYY'), " ||
							"TO_DATE('" || SalFmtFormatDateTime( dt2_, 'dd/MM/yyyy') || "','DD/MM/YYYY'), " ||
							SalNumberToStrX(stmt_, 0) || "); END;"
					                             If not SqlPrepareAndExecute(hSqlAux(), s)
						                             Call SqlRollback(hSqlAux())
						                             Return FALSE
					                             Call SqlCommitEx(hSqlAux(), CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTMess3') || " RNK=" || SalNumberToStrX(rnk_, 0))
					                             Return TRUE
		                             Window Parameters 
		                             Window Variables 
			                             Date/Time: dtSTbegin
			                             Date/Time: dtSTend
			                             String: strCMonth[12]
			                             String: strCDays[7]
			                             String: strChosenDate
			                             Number: nRow
		                             Message Actions 
			                             On SAM_Create
				                             Call SalSetWindowLoc(hWndForm, 0, 0)
				! Присваиваем значения многоязыковым объектам
				                             Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				                             Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SwMakeStmt.cTWndTitle'))
				                             Call PrepareWindowEx(hWndForm)
				!
				                             Call GetMonthArrayRus(strCMonth)
				                             Call GetWeekDayArray(strCDays)
				                             Set dtSTbegin = SalDateCurrent()
				                             Set dtSTend = SalDateCurrent()
				                             Call SalSetFocus(pbExecute)
				                             Call SalStatusSetText(hWndForm, "")
	!
	Table Window: frm_SWIFTMsgList		! 09
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Реестр SWIFT сообщений
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: 1
		Memory Settings
			Maximum Rows in Memory: 32000
			Discardable? Class Default
		Description: Архив свифт сообщений
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44142
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.4"
						Begin Y:  Class Default
						End X:  5.4"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.35"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44143
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Option Button: pbShowExtraFields
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    0.07"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set MyValue = FALSE
						On SAM_Click
							If MyValue
								Call SalShowWindow( colSwID )
								Call SalShowWindow( colSndrName )
								Call SalShowWindow( colRcvrName )
								Call SalShowWindow( colAccAName )
								Call SalShowWindow( colAccBName )
								Call SalShowWindow( colToAlien )
								Call SalShowWindow( colDateIn )
								Call SalShowWindow( colDateOut )
								Call SalShowWindow( colOwnerName )
								Call SalShowWindow( colOperName )
							Else
								Call SalHideWindow( colSwID )
								Call SalHideWindow( colSndrName )
								Call SalHideWindow( colRcvrName )
								Call SalHideWindow( colAccAName )
								Call SalHideWindow( colAccBName )
								Call SalHideWindow( colToAlien )
								Call SalHideWindow( colDateIn )
								Call SalHideWindow( colDateOut )
								Call SalHideWindow( colOwnerName )
								Call SalHideWindow( colOperName )
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cBTipShowExtraFields') )
						On UM_NoFontChange
							Return TRUE
				Pushbutton: pbFindMatch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.45"
						Top:    0.07"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cBTipFindMatch')
						On SAM_Click
							If colSwRef
								Set nTmp = SalModalDialog( dlg_PickUpDoc, hWndForm, colAccA, colAccB, colAmnt, colCcy, strTTArr, colDateV, colTrn, colMT )
								If nTmp > 0
									If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTMess1'),
											  CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion ) = IDNO
										Return FALSE
									If not SqlPrepareAndExecute(hSql(),
											"SELECT vdat INTO :dPayDat FROM oper WHERE ref=:nTmp")
										Return FALSE
									If NOT SqlFetchNext( hSql(), nFetchRes )
										Return FALSE
									If NOT SqlPrepareAndExecute(hSql(),
											"UPDATE sw_journal SET date_pay=:dPayDat WHERE swref=:colSwRef")
										Return FALSE 
									If colRef
										If not SqlPrepareAndExecute(hSql(),
												"UPDATE sw_oper SET ref=:nTmp WHERE swref=:colSwRef")
											Return FALSE 
									Else
										If not SqlPrepareAndExecute(hSql(),
												"INSERT INTO sw_oper (ref, swref) VALUES (:nTmp, :colSwRef)")
											Return FALSE 
									Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTMess2') || ' ' || SalNumberToStrX(colSwRef, 0) ||
											' ' || CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTMess3') || ' ' || SalNumberToStrX( nTmp, 0) )
									Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbShowMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.9"
						Top:    0.07"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cBTipShowMsg')
						On SAM_Click
							Call SWIFTMsgView(hWndForm, colSwRef)
				Line
					Resource Id: 44144
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.55"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: colSwRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: N
						п/п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: I/O
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Center
				Width:  0.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: MT
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSwID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: SWIFT
						референс
				Visible? Yes
				Editable? No
				Maximum Data Length: 35
				Data Type: String
				Justify: Left
				Width:  1.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSndr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Отправитель
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 12
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSndrName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						отправителя
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPayer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Плательщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAmnt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Amount
						(original)
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAmntFace
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCcy
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Валюта
						(ISO)
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Center
				Width:  0.817"
				Width Editable? Yes
				Format: Uppercase
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDig
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ccy digits
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRcvr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Получатель
						(Банк)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRcvrName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						получателя
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPayee
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Получатель
						средств
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colToAlien
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Конечный
						получатель
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAccA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Acc-A
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAccAName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счета А (АБС)
				Visible? No
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAccB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Acc-A
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAccBName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счет Б (АБС)
				Visible? No
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDateIn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Принято
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.917"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDateOut
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Отправлено
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.933"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDatePay
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обработано
						в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.15"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOwnerId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: OwnerID
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOwnerName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Поручено
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOperId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: OperID
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOperName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обработано
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Референс
						док-та в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDateV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colTrn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Поле21
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			String: strPreFilter
			String: strAddTitle
		Window Variables
			: Aux
				Class: cABSConnect
			: Count
				Class: cGenQuery
			Number: nCount
			String: strCountSql
			File Handle: hFile
			Number: nTmp
			Date/Time: dPayDat
			String: strTT
			String: strTTName
			String: strTTArr[*,2]
			String: strSecure
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTWndTitle'))
				Call ShowApdVersion('09')
				Call PrepareWindow(hWndForm)
				!
				Call XConnectGetParams( Aux )
				If NOT Aux.Connect()
					Call SalDestroyWindow( hWndForm )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize( hWndForm )
				!
				If EnhancedSecurity(  )
					Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
				If SqlPrepareAndExecute( hSql(), 
						'SELECT t.tt, t.name INTO :strTT, :strTTName FROM tts t, staff_tts s 
						 WHERE s.tt = t.tt AND s.id = ' || SalNumberToStrX( GetUserId(), 0 ) || ' AND 
						       t.tt IN (SELECT DISTINCT tt from sw_tt_import) ' || strSecure )
					Set nTmp = 0
					While SqlFetchNext( hSql(), nFetchRes )
						Set strTTArr[nTmp, 0] = strTT
						Set strTTArr[nTmp, 1] = strTTName
						Set nTmp = nTmp + 1
				!
				Set frm_SWIFTMsgList.nFlags = GT_ReadOnly
				Set frm_SWIFTMsgList.fFilterAtStart = TRUE
				Set frm_SWIFTMsgList.strFilterTblName = 'SW_JOURNAL'
				Set frm_SWIFTMsgList.strPrintFileName = 'SW_LIST.TXT'
				If strAddTitle
					Set frm_SWIFTMsgList.strTitleAux = strAddTitle
				Set frm_SWIFTMsgList.strSqlPopulate = 
						"SELECT sw_journal.swref, io_ind, mt, trn, sender, b1.name, payer, amount, currency, t.dig,
						        receiver, b2.name, payee, transit, accd, acck, date_in, date_out, date_pay, o.ref, vdate, substr(sww.value, 1, 150) tag20 
						 INTO :hWndForm.frm_SWIFTMsgList.colSwRef, :hWndForm.frm_SWIFTMsgList.colIO, 
						      :hWndForm.frm_SWIFTMsgList.colMT, :hWndForm.frm_SWIFTMsgList.colSwID, 
						      :hWndForm.frm_SWIFTMsgList.colSndr, :hWndForm.frm_SWIFTMsgList.colSndrName, 
						      :hWndForm.frm_SWIFTMsgList.colPayer, :hWndForm.frm_SWIFTMsgList.colAmnt,
						      :hWndForm.frm_SWIFTMsgList.colCcy, :hWndForm.frm_SWIFTMsgList.colDig, 
						      :hWndForm.frm_SWIFTMsgList.colRcvr, :hWndForm.frm_SWIFTMsgList.colRcvrName, 
						      :hWndForm.frm_SWIFTMsgList.colPayee, :hWndForm.frm_SWIFTMsgList.colToAlien, 
						      :hWndForm.frm_SWIFTMsgList.colAccA, :hWndForm.frm_SWIFTMsgList.colAccB, 
						      :hWndForm.frm_SWIFTMsgList.colDateIn, :hWndForm.frm_SWIFTMsgList.colDateOut, 
						      :hWndForm.frm_SWIFTMsgList.colDatePay, :hWndForm.frm_SWIFTMsgList.colRef,  :hWndForm.frm_SWIFTMsgList.colDateV, :hWndForm.frm_SWIFTMsgList.colTrn
						 FROM sw_journal, sw_banks b1, sw_banks b2, tabval t, sw_oper o, sw_operw sww 
						 WHERE 
						      sw_journal.swref=o.swref(+) AND 
						      t.lcv=currency AND 
						      b1.bic=sender AND 
						      b2.bic=receiver AND
						      sww.swref(+)=sw_journal.swref AND  case when mt='103' then '20' else '21' end =sww.tag "
				Call Count.Init( "SELECT count(*) INTO :nCount FROM sw_journal" )
				If strPreFilter
					Set frm_SWIFTMsgList.strSqlPopulate = frm_SWIFTMsgList.strSqlPopulate || ' AND ' || strPreFilter
					Set strCountSql = strCountSql || ' AND ' || strPreFilter
				Set frm_SWIFTMsgList.strSqlPopulate = frm_SWIFTMsgList.strSqlPopulate || ' ORDER BY sw_journal.swref '
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Populate
				Call SalSendClassMessage( UM_Populate, 0, 0 )
				Call SalWaitCursor( TRUE )
				Set strCountSql = Count.GetFullSQLString( frm_SWIFTMsgList.cF )
				If SqlPrepareAndExecute( Aux.hSql(), strCountSql )
					Call SqlFetchNext( Aux.hSql(), nFetchRes )
				Call SalStatusSetText( hWndForm, CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTStText') || ': ' || SalNumberToStrX( nCount, 0 ))
				Call SalWaitCursor( FALSE )
			On SAM_FetchRowDone
				If SalIsNull( colRef )
					Call SetTblRowColor( hWndForm, COLOR_DarkGreen )
				Else
					If SqlPrepareAndExecute( Aux.hSql(), 
							"SELECT s.id, s.fio INTO :colOperId, :colOperName FROM staff s, oper o
							 WHERE s.id=o.userid AND o.ref=:colRef" )
						Call SqlFetchNext( Aux.hSql(), nFetchRes )
				!
				If NOT SalIsNull( colToAlien )
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle )
				!
				If NOT SalIsNull( colDig )
					Set colAmntFace = colAmnt/SalNumberPower( 10, colDig )
				Else
					Set colAmntFace = colAmnt
				!
				If NOT SalIsNull( colAccA )
					If SqlPrepareAndExecute( Aux.hSql(), 
							"SELECT nls INTO :colAccAName FROM accounts WHERE acc=:colAccA" )
						Call SqlFetchNext( Aux.hSql(), nFetchRes )
				If NOT SalIsNull( colAccB )
					If SqlPrepareAndExecute( Aux.hSql(), 
							"SELECT nls INTO :colAccBName FROM accounts WHERE acc=:colAccB" )
						Call SqlFetchNext( Aux.hSql(), nFetchRes )
				!
				If NOT SalIsNull( colOwnerId )
					If SqlPrepareAndExecute( Aux.hSql(), 
							"SELECT fio INTO :colOwnerName FROM staff WHERE id=:colOwnerId" )
						Call SqlFetchNext( Aux.hSql(), nFetchRes )
			On SAM_DoubleClick
				If colRef
					Call DocViewContentsEx( hWndMDI, colRef )
				Else
					Call SWIFTMsgView( hWndMDI, colSwRef )
			On UM_Print
				Select Case GetTablePrintOpt(  )
					Case 1		! Whole table
						Call SalSendClassMessage( UM_Print, 0, 0 )
						Break
					Case 2		! Only selected documents
						If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
							Set nRow=TBL_MinRow
							While SalTblFindNextRow( hWndForm, nRow, ROW_Selected, 0 )
								Call SalTblFetchRow( hWndForm, nRow )
								Call SalStatusSetText( hWndForm, CurrentLangTable.GetAtomTitle('cTExec') || SalNumberToStrX( colSwRef, 0 ))
								!
								If colRef
									Call DocsPrint( colRef, 'OPER', AUTO_PRINT_DOC )
								Else
									Set strPrintFileName = 'sw' || 
												SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss.') || 
											        GetCharForDigit( SalDateDay( SalDateCurrent() ) ) || 
											        SalStrLeftX(SalFmtFormatDateTime(SalDateCurrent() ,'mmmmmm'), 2)
									If NOT SalFileOpen( hFile, GetPrnDir() || '\\' || strPrintFileName, OF_Write | OF_Create | OF_Text )
										Call SalMessageBeep( MB_IconStop )
										Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTErrFileOpen') || ' ' || GetPrnDir() || '\\' || strPrintFileName, 'Внимание!', MB_IconStop | MB_Ok )
										Return FALSE
									Call SalFilePutStr( hFile, '' )
									Call SalFilePutStr( hFile, Sw_MtAsText( hSqlAux(), colSwRef ) )
									Call SalFileClose( hFile )
									Call DosDirectPrint( GetPrnDir() || '\\' || strPrintFileName )
								!
								Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, FALSE )
							Call SalStatusSetText( hWndForm, CurrentLangTable.GetAtomTitle('cTExec') )
							Call MessageInfo( CurrentLangTable.GetAtomTitle('frm_SWIFTMsgList.cTDocSave') || ' ' || GetPrnDir() )
							Call SalWaitCursor( FALSE )
						Break
					Default
						Break
			On SAM_Destroy
				Call SalSendClassMessage( SAM_Destroy, 0, 0 )
				If Aux.IsConnected()
					Call Aux.Disconnect()
	Form Window: frm_SWIFTDoc		! 10
		Class:
		Property Template:
		Class DLL Name:
		Title: SWIFT сообщение
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.867"
				Width Editable? Yes
				Height: 5.512"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Просмотреть свифтовочку
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.417"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbPrint
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frm_SWIFTDoc.cBTipPrint')
						On SAM_Click
							Set szReport = GetPrnDir() || '\\sw'
							Set szReport= szReport ||
										SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss.') ||
									        GetCharForDigit( SalDateDay( SalDateCurrent() ) ) ||
									        SalStrLeftX(SalFmtFormatDateTime(SalDateCurrent() ,'mmmmmm'), 2)
							Call SwiftPrint(nSwRef, szReport)
							Call DosDirectPrint(szReport)
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.667"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frm_SWIFTDoc.cBTipExit')
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
		Contents
			Multiline Field: mlMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10000
					String Type: Long String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  9.633"
						Width Editable? Yes
						Height: 4.464"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New Cyr
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Gray
				Message Actions
		Functions
		Window Parameters
			Number: nSwRef
		Window Variables
			Number: nX0
			Number: nY0
			Number: nX1
			Number: nY1
			String: szReport
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_SWIFTDoc.cTWndTitle') )
				Call PrepareWindow(hWndForm)
				!
				Set mlMT = Sw_MtAsTextEx( hSql(), nSwRef, NUMBER_Null )
				Call SalSetFocus( pbExit )
			On SAM_CreateComplete
				Call SalWaitCursor( FALSE )
			On WM_Size
				Call GetClientRect( hWndForm, nX0, nY0, nX1, nY1 )
				Call SalSetWindowLoc( hWndForm.frm_SWIFTDoc.mlMT, 0, 0 )
				Call SalSetWindowSize( hWndForm.frm_SWIFTDoc.mlMT, 
							SalPixelsToFormUnits( hWndForm.frm_SWIFTDoc.mlMT, nX1-nX0, FALSE ),
						        SalPixelsToFormUnits( hWndForm.frm_SWIFTDoc.mlMT, nY1-nY0, TRUE  ))
	!
	Form Window: splKS			! 11
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Подбор коррсчета
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.575"
				Top:    1.021"
				Width:  13.7"
				Width Editable? Class Default
				Height: 6.048"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Подбор коррсчетов для валютных платежей, уходящих через SWIFT.
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbReject
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! 'Вернуть отправителю'
							Set strTip = CurrentLangTable.GetAtomTitle('splKS.cBTipReject')
						On SAM_Click
							Call SalSendMsg( tbl, UM_HotDocuments, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 27681
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Select Case GetTablePrintOpt(  )
								Case 1		! Whole table
									Call SalGetWindowText(tbl, sTmp, 100)
									Call TablePrint(tbl, SalFmtFormatDateTime(GetBankDate(), 'dd/MM/yyyy') || ': ' || sTmp, '', '')
									Break
								Case 2		! Only selected documents
									If SalTblAnyRows(tbl, ROW_Selected, 0)
										Set nRow = TBL_MinRow
										While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
											Call SalTblFetchRow(tbl, nRow)
											Call DocsPrint(tbl.colRef, 'OPER', AUTO_PRINT_DOC)
											Call SalTblSetRowFlags(tbl, nRow, ROW_Selected, FALSE)
										Call SalWaitCursor(FALSE)
									Break
								Default
									Break
				Line
					Resource Id: 27682
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.967"
						Begin Y:  0.417"
						End X:  3.967"
						End Y:  0.0"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 58715
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.6"
						Begin Y:  0.417"
						End X:  4.6"
						End Y:  0.0"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.533"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 27683
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  6.417"
						Begin Y:  0.464"
						End X:  6.417"
						End Y:  0.048"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 47856
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.733"
						Begin Y:  0.393"
						End X:  5.733"
						End Y:  -0.024"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.717"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SalTblAnyRows(tbl2, ROW_Selected, 0)
								Call SalSendMsg(tbl2, UM_DoubleClick, 0, 0)
						On SAM_Create
							! 'Оплатить отмеченные документы'
							Set strTip = CurrentLangTable.GetAtomTitle('splKS.cBTipRun')
				Data Field: dfSumSelect
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 10
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.767"
							Top:    0.095"
							Width:  1.55"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: 3D Face Color
						Input Mask: Unformatted
					Message Actions
				Background Text: Отмечено:
					Resource Id: 27684
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.383"
						Top:    0.131"
						Width:  1.383"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
				Line
					Resource Id: 6042
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  7.067"
						Begin Y:  0.464"
						End X:  7.067"
						End Y:  0.048"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Data Field: bgSumSelect
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pb_Stop
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.85"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! 'Без коррсчета'
							Set strTip = CurrentLangTable.GetAtomTitle('splKS.cBTipStop')
						On SAM_Click
							If SalTblAnyRows(tbl, ROW_Selected, 0)
								! Снять с подбора К/С ?
								If SalMessageBox(CurrentLangTable.GetAtomTitle('splKS.cTMessQuestionBack'), 
										   CurrentLangTable.GetAtomTitle('cTQuestion'), MB_YesNo | MB_IconQuestion) = IDYES
									! -- Для НБУ по-старому
									If bNBUBANK
										If SqlPrepareAndExecute(hSql(), "UPDATE operw SET value='-1' where tag='NOS_A'and ref=:tbl.colRef")
											Call SqlCommit(hSql())
										Else
											Call SqlRollback(hSql())
									! -- Для КБ через bars_swift
									Else
										If SqlPLSQLCommand(hSql(), "bars_swift.genmsg_document_coraccskip(tbl.colRef)")
											Call SqlCommit(hSql())
										Else
											Call SqlRollback(hSql())
									Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Check Box: cb_LCV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ISO ccy
					Window Location and Size
						Left:   10.5"
						Top:    0.095"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_LCV
								Call SalHideWindow(splKS.tbl.colInvKVD)
								Call SalHideWindow(splKS.tbl.colInvKV)
								Call SalShowWindow(splKS.tbl.colLCVD)
								Call SalShowWindow(splKS.tbl.colLCV)
								!
								Call SalHideWindow(splKS.tbl2.colInvKV)
								Call SalShowWindow(splKS.tbl2.colLCV)
							Else
								Call SalHideWindow(splKS.tbl.colLCVD)
								Call SalHideWindow(splKS.tbl.colLCV)
								Call SalShowWindow(splKS.tbl.colInvKVD)
								Call SalShowWindow(splKS.tbl.colInvKV)
								!
								Call SalShowWindow(splKS.tbl2.colInvKV)
								Call SalHideWindow(splKS.tbl2.colLCV)
				Check Box: cb_BB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Bank Beneficiary
					Window Location and Size
						Left:   11.733"
						Top:    0.095"
						Width:  1.65"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_BB
								Call SalShowWindow(splKS.tbl.colBankName)
							Else
								Call SalHideWindow(splKS.tbl.colBankName)
				Option Button: obPap
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.06"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\BROWSE.BMP
					Picture Transparent Color: None
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							! Пассивные счета
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('splKS.cBTipPap'))
						On SAM_Create
							Set nPAP = 1
						On SAM_Click
							If obPap
								Set nPAP = 2
							Else
								Set nPAP = 1
							Call SalSendMsg(tbl2, UM_Populate, 0, tbl.colInvKV)
				Pushbutton: pbSwt2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.06"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\resource\bmp\APP1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SalTblAnyRows(tbl2, ROW_Selected, 0)
								Set strMsgGenType = '2'
								Call SalSendMsg(tbl2, UM_DoubleClick, 0, 0)
						On SAM_Create
							! 'Оплатить отмеченные документы'
							Set strTip = CurrentLangTable.GetAtomTitle('splKS.cBTipRun2')
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.571"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  13.483"
						Width Editable? Class Default
						Height: 2.571"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: InvS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								проплаты
						Visible? Yes
						Editable? No
						Maximum Data Length: 12
						Data Type: Number
						Justify: Right
						Width:  1.383"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф док
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.886"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colTt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип
								опер
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colMFOA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: МФО
								А
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.967"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNLSA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счет
								ДТ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNLSB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счёт КТ
						Visible? No
						Editable? No
						Maximum Data Length: 15
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colLCVD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
								ДТ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colLCV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
								КТ
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDateV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата вал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.217"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If not SalIsValidDateTime( hWndItem )
									Call SalMessageBox( CurrentLangTable.GetAtomTitle('splKS.cTErrDataFormat'), 
											  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation )
									Return VALIDATE_Cancel
								If colDateV_do > colDateV
									Call SalMessageBox( CurrentLangTable.GetAtomTitle('splKS.cTErrVDat'), 
											  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation )
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: colInvKVD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
								ДТ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colInvKV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
								КР
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colInvS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								документа
						Visible? No
						Editable? No
						Maximum Data Length: 12
						Data Type: Number
						Justify: Right
						Width:  1.783"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSs
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								документа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colBank
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код Банка
								 получателя
						Visible? Yes
						Editable? No
						Maximum Data Length: 11
						Data Type: String
						Justify: Center
						Width:  1.417"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colBankName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование Банка
								получателя
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSos
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Опл
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.886"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Д/К
						Visible? Yes
						Editable? No
						Maximum Data Length: 2
						Data Type: Number
						Justify: Center
						Width:  0.886"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDig
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDateV_do
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата вал.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.217"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
					Column: colVob
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNMSA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOkpoA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOkpoB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNazn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: 160
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDrec
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTag57
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBankKey
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colUseCover
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nGenType
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On UM_Populate
						! Call Debug('header table populate...')
						Call SalSendClassMessage(UM_Populate, 0, 0)
						! Call Debug('set focus to first row ....')
						Call SalTblSetRow(tbl, TBL_SetFirstRow)
						! Call Debug('Send message to detail table with currency=' || Str(tbl.colInvKV) || ' amount=' || tbl.colSs || ' ref=' || Str(tbl.colRef))
						! Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
					On SAM_FetchRowDone
						! Сумма док м.б. не = сумме требуемого ресурса
						! If SqlPrepareAndExecute(hSqlAux2(), 
								"SELECT sum(decode(DK,1,1,-1)*S)/100 INTO :InvS FROM opl 
								  WHERE ref=:colRef AND kv=:colInvKV AND nls=:colNLSB")
								AND SqlFetchNext(hSqlAux2(), nFetchRes)
						Set colSs = Dig4(colInvS, colDig, nMaxDig)
						!
						Set colDateV_do = colDateV   ! Запомним дату валютирования (на случай если ее изменят)
						! If SqlPrepareAndExecute(hSqlAux2(), "SELECT tag, value INTO :colTag57, :colBank FROM operw WHERE ref=:colRef AND tag like '57%' ") 
								AND SqlFetchNext(hSqlAux2(), nFetchRes)
							                                                     If cb_BB and colBank != '-1'
								                                                     If SqlPrepareAndExecute(hSqlAux2(), "SELECT name INTO :colBankName FROM sw_banks WHERE bic=:colBank")
										and SqlFetchNext(hSqlAux2(), nFetchRes)
						! If cb_LCV 
							                                                     If SqlPrepareAndExecute(hSqlAux2(),
									"SELECT d.lcv,k.lcv INTO :colLCVD,:colLCV FROM tabval d, tabval k WHERE d.kv=:colInvKVD AND k.kv=:colInvKV ") 
									AND SqlFetchNext(hSqlAux2(), nFetchRes)
					On SAM_TblDoDetails
						! Call Debug('TblDoDetail: Send message to detail table with currency=' || Str(tbl.colInvKV) || ' amount=' || tbl.colSs || ' ref=' || Str(tbl.colRef))
						If tbl.colMFOA=GetBankMfo()
							Call SalEnableWindow(pbReject)
						Else
							Call SalDisableWindow(pbReject)
						! Обновляем список доступных корсчетов
						Call SalSendMsg(tbl2, UM_Populate, 0, tbl.colInvKV)
						! Если возможно, то разрешаем кнопку "Оплата с покрытием"
						If GetGlobalOptionEx('SWIFT')
							! If SqlPrepareAndExecute(hSqlAux2(),
									"SELECT bars_swift_msg.docmsg_document_getgentype(:colRef) INTO :tbl.nGenType FROM dual") 
									AND SqlFetchNext(hSqlAux2(), nFetchRes)
								                                     If (nGenType = 2)
									                                     Call SalEnableWindow(pbSwt2)
								                                     Else 
									                                     Call SalDisableWindow(pbSwt2)
							! Else 
								                                     Call SalDisableWindow(pbSwt2)
							If bMT103Cov AND colUseCover = 'Y'
								Call SalEnableWindow(pbSwt2)
							Else
								Call SalDisableWindow(pbSwt2)
					On SAM_ColumnSelectClick	
						Call SalSendClassMessage(SAM_ColumnSelectClick, wParam, lParam)
						Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
					On WM_LbuttonUp
						Set dfSumSelect = SalTblColumnSum(tbl, 1, ROW_Selected, 0)
					On UM_HotDocuments
						! 'Вернуть' || SalNumberToStrX(colInvS,2) || ' ' || colLCV || ' плательщику ?'
						If tbl.colMFOA=GetBankMfo() and
								   SalMessageBox(CurrentLangTable.GetAtomTitle('splKS.cTMessBack') || ' ' || SalNumberToStrX(colInvS,2) || ' ' || colLCV || ' ' || CurrentLangTable.GetAtomTitle('splKS.cTMessBack1') ||' ?', 
								  CurrentLangTable.GetAtomTitle('cTQuestion'), MB_YesNo | MB_IconQuestion) = IDYES
							Call WaitCursorOn()
							Set bOk = FALSE
							Set sErrTxt = STRING_Null
							While TRUE       !! Средства - возвращаем, документ блокируем
								If NOT Pay_Bck(tbl.colRef, 5, '')
									! 'Ош. при вызове pay_bck'
									Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrPayBck') || ' pay_bck'
									Break
								! 'Повернено відділом коррахунків.'
								If NOT SqlPrepareAndExecute( hSql(),
										"INSERT INTO operw(ref,tag,value) 
										 VALUES(:tbl.colRef, 'BACKR', '" || CurrentLangTable.GetAtomTitle('splKS.cTMessBACKR') || "') " )
									! 'Невозможно изменить назначение платежа (OPERW)'
									Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrNazn') || ' (OPERW)'
									Break
								! NOS_A := -1
								If NOT SqlPrepareAndExecute(hSql(),
										"UPDATE operw SET value='-1' WHERE ref=:tbl.colRef AND tag='NOS_A'")
									! 'Невозможно обновить TAG NOS_A'
									Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrUpdate') ||' TAG NOS_A'
									Break
								! в OPER изменяем поле chk
								If not SqlPLSQLCommand(hSql(),'chk.PUT_NOS(tbl.colRef,Grp)')
									! 'Невозможно поставить визу'
									Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrVisa')
									Break
								! подпись
								Set nTmp = 3
								If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! подпись 
									If NOT cDoc.SetDocR(tbl.colRef, TRUE)
										! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
										Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1')
										Break
									! Подписываем...
									Set strKeyId = GetIdOper( )
									If GetGlobalOptionEx('INTSIGN') = 2 		 !-- новая внутрення подпись
										! If NOT cDoc.LockSignStore(tbl.colRef,Grp,nTmp)
											                                                                                                                            Set sErrTxt = 'Ошибка при работе с внутренней ЭЦП'
											                                                                                                                            Break 
										If NOT cDoc.sDocInt(99,Grp)
											Set sErrTxt = "Невозможно подписать документ (cDoc.sDocInt)"
											Break
										If NOT cDoc.PutVis(Grp,nTmp)
											Set sErrTxt = "Невозможно подписать документ (cDoc.PutVis)"
											Break
									Else
										If NOT cDoc.sDocVisa()
											! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
											Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1')
											Break
										Call SqlSetLongBindDatatype(6, BLOB_BYTE)
										If NOT SqlPrepareAndExecute(hSql(), 
												"INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
												 VALUES(:tbl.colRef, sysdate, :nUSERID, :Grp, :nTmp, :strKeyId, :cDoc.m_lsSign)")
											! 'Невозможно выполнить INSERT INTO oper_visa'
											Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrExec') || ' INSERT INTO oper_visa'
											Break
								Else
									If NOT SqlPrepareAndExecute(hSql(), 
											"INSERT INTO oper_visa(ref, dat, userid, groupid, status) 
											 VALUES(:tbl.colRef, sysdate, :nUSERID, :Grp, :nTmp)")
										Set sErrTxt = 'Невозможно вставить в OPER_VISA'
										Break
								Set bOk = TRUE
								Break
							If bOk
								! 'Возврат с подбора коррсчета. Док Реф:#' || SalNumberToStrX(tbl.colRef,0) || ' возвращен'
								Call SqlCommitEx(hSql(), 'NOSTRO(Подбор КС). ' || 
										  CurrentLangTable.GetAtomTitle('splKS.cTMessBackKS') || ' '  || 
										  CurrentLangTable.GetAtomTitle('splKS.cTMessDocRef') || ':#' || SalNumberToStrX(tbl.colRef,0) || ' ' || 
										  CurrentLangTable.GetAtomTitle('splKS.cTMessDocRefBack'))
							Else
								Call SqlRollbackEx(hSql(), 'NOSTRO(Подбор КС). ' || sErrTxt || '. ' || CurrentLangTable.GetAtomTitle('splKS.cTMessDocRef') || ' #:' ||SalNumberToStrX(tbl.colRef,0))
								If sErrTxt
									! sErrTxt || '. Док Реф:#' || SalNumberToStrX(tbl.colRef,0)
									Call MessageErrorEx(sErrTxt || '. ' || CurrentLangTable.GetAtomTitle('splKS.cTMessDocRef') || ' #:' ||SalNumberToStrX(tbl.colRef,0))
							Call SalWaitCursor(TRUE)
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
							Call SalWaitCursor(FALSE)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.643"
						Width:  13.483"
						Width Editable? Class Default
						Height: 2.274"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 500
					Discardable? No
				Contents
					Column: colCAcc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ID
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер
								КС
						Visible? Yes
						Editable? No
						Maximum Data Length: 15
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								КС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colLCV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colInvKV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colInvOstC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток
								фактический
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.55"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOstCs
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток
								фактический
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colInvOstB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток
								плановый
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOstBs
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток
								плановый
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNosBic
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код Банка
								корреспондента
						Visible? Yes
						Editable? No
						Maximum Data Length: 11
						Data Type: String
						Justify: Center
						Width:  1.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNosAcc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ID
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNosNane
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование банка
								корреспондента
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.371"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDig
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOKPO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ОКПО
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strDSql
					String: sFilt
					String: sOKPO
					String: sNlsA
					String: sNmsA
					String: sMfoA
					String: sOkpoA
					Boolean: bKlAcc
					Number: nRefNos
					String: strBIC1
					String: strBIC2
					String: strBIC3
					String: strBIC4
				Message Actions
					On UM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					On UM_Populate
						! Call Debug('populate detail table...')
						If lParam
							! Call Debug(' detail table: populate option currency=' || Str(lParam))
							Set sFilt = "and kv=" || SalNumberToStrX(lParam,0)
						Else
							! Call Debug(' detail table: populate option without param')
							Set sFilt = ""
						Set strDSql =
								"select acc, nls, kv, lcv, substr(nms,1,38), ostc, ostb, bic, dig
								   into :colCAcc, :colNLS, :colInvKV, :colLCV, :colNMS, :colInvOstC, :colInvOstB, :colNosBic, :colDig 
								   from v_sw_corracc
								  where pap in (" || IifS(nPAP=1, "1, 3", "2") || ") " || sFilt || 
								        IifS(sTbl2Filter='', "", " and (" || sTbl2Filter || ")") || "
								  order by kv"
						Call SalWaitCursor(TRUE)
						Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						Set colOstCs = Dig4(colInvOstC, colDig, nMaxDig)
						Set colOstBs = Dig4(colInvOstB, colDig, nMaxDig)
						Set colNosAcc = colCAcc 
						If nPAP = 2
							Call XSalTblSetRowBackColor(tbl2, lParam, SalColorFromRGB(230,255,230))
					On UM_DoubleClick
						! Через tbl2.colNLS tbl2.colNMS ?
						If SalMessageBox(CurrentLangTable.GetAtomTitle('splKS.cTMess1') || ' ' || tbl2.colNLS || ' ' || tbl2.colNMS || ' ?', 'Вопрос', MB_YesNo | MB_IconQuestion) = IDYES
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
								Call SalTblSetContext(tbl, nRow)
								If tbl2.colInvKV = tbl.colInvKV
									Set bOk = FALSE
									Set sErrTxt = STRING_Null
									While TRUE
										If Subs(strPar01,1,1) = '1'
											If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! Проверка подписи n-1
												! Проверим подпись
												! если не верна, то выдать сообщение и вернуть документ на предыдущий уровень??
												If GetGlobalOptionEx('INTSIGN') != 2
													Call cDoc.SetDocR(tbl.colRef, FALSE)
													If NOT cDoc.CheckDocSign('CUR', 0)
														Select Case cDoc.m_nSignErrType
															Case 1
																! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.colRef, 0) || ']!'
																Call SaveErrorToLog(CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || 
																		  CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa2') || ' [Ref=' || SalNumberToStrX(tbl.colRef, 0) || ']!' )
																Break
															Case 2
																! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.colRef, 0) || ']!'
																Call SaveErrorToLog(CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || 
																		  CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa3') || ' [Ref=' || SalNumberToStrX(tbl.colRef, 0) || ']!' )
																Call SalMessageBeep(MB_IconStop)
																! 'Подпись предыдущей группы визирования неверна!' || PutCrLf() || 'Возвратить документ на повторное визирование?'
																If SalMessageBox(CurrentLangTable.GetAtomTitle('splKS.cTMessSign1') || PutCrLf() ||
																		  CurrentLangTable.GetAtomTitle('splKS.cTMessSign2') ,
																		  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_YesNo | MB_DefButton1 ) = IDYES
																	If SqlPrepareAndExecute(hSql(), 'UPDATE oper SET chk=substr(chk, 1, length(rtrim(chk))-6) WHERE ref=:tbl.colRef') AND
																			   SqlPrepareAndExecute(hSql(), 'DELETE FROM oper_visa WHERE sqnc = (SELECT max(sqnc) FROM oper_visa WHERE ref=:tbl.colRef)')
																		! 'Возврат документа на повторное визирование Ref = ' || SalNumberToStrX(tbl.colRef, 0)
																		Call SqlCommitEx(hSql(), 'NOSTRO(Подбор КС). ' || CurrentLangTable.GetAtomTitle('splKS.cTMessSign3') || ' Ref = ' || SalNumberToStrX(tbl.colRef, 0))
																	Else
																		Call SqlRollbackEx(hSql(), 'NOSTRO(Подбор КС). Не удалось выполниьт операцию: ' || 
																				  CurrentLangTable.GetAtomTitle('splKS.cTMessSign3') || ' Ref = ' || SalNumberToStrX(tbl.colRef, 0))
																Break
															Default
																! 'Нерасчетный код возврата!'
																Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || CurrentLangTable.GetAtomTitle('splKS.cTErrKod'))
																Break
														Break
										! -- ОКПО по требованию НБУ !! Уточнение ОКПО по признаку б/с
										Set bKlAcc = FALSE
										Set sOKPO  = STRING_Null
										If sKlF  
											If SqlPrepareAndExecute(hSql(), "SELECT kl FROM ps WHERE nbs=substr(:tbl2.colNLS,1,4) AND kl=:sKlF" ) 
													AND SqlFetchNext(hSql(), nFetchRes) 
												Set bKlAcc = TRUE
											Else
												Set bKlAcc = FALSE
										If NOT bKlAcc
											If SqlPrepareAndExecute(hSql(),
													"SELECT okpo INTO :sOKPO FROM customer c,cust_acc u 
													  WHERE u.acc=:tbl2.colNosAcc and u.rnk=c.rnk" ) 
													AND SqlFetchNext(hSql(), nFetchRes)
										!
										! -- дописываем проводку в старый документ
										If bNOSTOREF
											! Call Debug("Point.6: Add rows in financial model (PAYTT).")
											If not SqlPLSQLCommand(hSql(),
													   "BARS.PAYTT(nFlg, tbl.colRef, tbl.colDateV, strNosTt, splKS.tbl.colDk,
													    tbl.colInvKV, tbl.colNLSB, tbl.InvS*100,
													    tbl.colInvKV, tbl2.colNLS, tbl.InvS*100)")
												Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrExecTT') || ' PS1'
												Break
											! Call Debug("Point.7: Add NOS_B into OPERW.")
											If not SqlPrepareAndExecute(hSql(),
													   "INSERT INTO operw (ref, tag, value)
													    VALUES (:tbl.colRef, 'NOS_B', :tbl2.colNosBic)")
												Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrInsert') || ' TAG NOS_B'
												Break
											! Call Debug("Point.8: UPDATE NOS_A in OPERW.")
											If not SqlPrepareAndExecute(hSql(),
													   "UPDATE operw SET value=:tbl2.colNosAcc WHERE ref=:tbl.colRef AND tag='NOS_A'")
												Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrInsert') || ' TAG NOS_A'
												Break
											! Call Debug("Point.9: Change NLSB and ID_B in OPER.")
											If not SqlPrepareAndExecute(hSql(),
													"UPDATE oper SET nlsb=:tbl2.colNLS,nam_b=:tbl2.colNMS, id_b=nvl(:sOKPO,id_b)" || strNewTT ||
													   " WHERE ref=:tbl.colRef ")
												Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr21')
												Break
											!
											If tbl.colDateV_do < tbl.colDateV
												! Call Debug(SalFmtFormatDateTime( tbl.colDateV_do,'dd-MM-yyyy')||SalFmtFormatDateTime( tbl.colDateV,'dd-MM-yyyy'))
												! Call Debug("Point.10: Value dates unmatch. Change OPER.VDAT")
												If not SqlPrepareAndExecute(hSql(),
														   'UPDATE oper SET vdat=:tbl.colDateV WHERE ref=:tbl.colRef and sos in (1,3)')
													Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr22')
													Break
												! Call Debug("Point.11: Value dates unmatch. Change OPLDOK.FDAT")
												If NOT SqlPrepareAndExecute(hSql(),
														"DECLARE
														   DATN date;
														 BEGIN
														   FOR k IN (SELECT TT, DK, ACC, S, SQ, FDAT, TXT
														               FROM opldok WHERE ref=" || Str(tbl.colRef) || "
														              ORDER BY FDAT desc, stmt, dk desc)
														   LOOP
														     IF DATN IS NULL THEN
														       ful_bak(" || Str(tbl.colRef) || ");
														       DATN:=k.FDAT;
														     END IF;
														     GL.pay2(null, " || Str(tbl.colRef) || ", DATN, k.TT,
														             null, k.DK, k.ACC, k.S, k.SQ, k.DK, k.TXT);
														   END LOOP;
														 END;")
													Set sErrTxt = 'Ошибка замены даты валютирования'
													Break
											! Дописать в поле CHK след 6 байт о новой визе
											! Call Debug("Point.12: Put NOS visa group (CHK.PUT_NOS)")
											! If not SqlPLSQLCommand(hSql(),'chk.PUT_NOS(tbl.colRef,Grp)')
												                                Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr23')
												                                Break 
											! !!!!!
											! Добавить в историю виз OPER_VISA,
													  nTmp=0-только визировал,  nTmp=1-оплатил по факту.
											Set nTmp=nFlg+1
											!
											If GetGlobalOptionEx( 'VISASIGN' ) AND GetSignOn()!=0	! подпись
												! Call Debug("Point.13: Make visa sign and add row into OPER_VISA")
												If cDoc.SetDocR( tbl.colRef, TRUE )
													! Подписываем...
													Set strKeyId = GetIdOper( )
													If GetGlobalOptionEx('INTSIGN')=2
														If NOT cDoc.LockSignStore(tbl.colRef,Grp,nTmp)
															Call SqlRollback( hSql() )
															Call SaveErrorToLog( CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1') )
															Break
														! Else
															                                Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('splKS.cTMessKS') || '. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
													Else
														If cDoc.sDocVisa(  )
															Call SqlSetLongBindDatatype( 6, BLOB_BYTE )
															If SqlPrepareAndExecute(hSql(), "
																	 INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign)
																	 VALUES (:tbl.colRef,sysdate,:nUSERID,:Grp,:nTmp,:strKeyId,:cDoc.m_lsSign)")
																! Наконец-то commit
																! Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('splKS.cTMessKS') || '. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
															Else
																Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr24') || ' INSERT INTO oper_visa'
																Break
														Else
															Call Debug( CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1'))
															Call SaveErrorToLog( CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1') )
															Break
												Else
													Call Debug( CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1'))
													Call SaveErrorToLog( CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') ||' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1') )
													Break
											Else
												! Дописать в поле CHK след 6 байт о новой визе
												! Call Debug("Point.12: Put NOS visa group (CHK.PUT_NOS)")
												If not SqlPLSQLCommand(hSql(),'chk.PUT_NOS(tbl.colRef,Grp)')
													Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr23')
													Break
												! Call Debug("Point.14: Add row into OPER_VISA")
												If not SqlPrepareAndExecute(hSql(),
														   "INSERT INTO OPER_VISA (REF,DAT,USERID,GROUPID,STATUS )
														    VALUES (:tbl.colRef, sysdate,:nUSERID,:Grp, :nTmp )")
													Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrInsert') || ' OPER_VISA'
													Break
										! -- порождаем новый документ
										Else
											! Счет nlsa в oper:
											! из настройки операции
											If bNLSA
												Set sMfoA  = GetBankMfo()
												Set sOkpoA = GetBankOkpoS()
												If NOT SqlPrepareAndExecute(hSql(),
														"SELECT a.nls, a.nms INTO :sNlsA, :sNmsA 
														 FROM tts t, accounts a 
														 WHERE t.tt=:strNosTt AND t.nlsm=a.nls AND a.kv=:tbl.colInvKV")
														OR NOT SqlFetchNext(hSql(), nFetchRes)
													! если не нашли, берем из первичного документа
													Set sNlsA  = tbl.colNLSA
													Set sNmsA  = tbl.colNMSA
													Set sMfoA  = tbl.colMFOA
													Set sOkpoA = tbl.colOkpoA
											! из первичного документа
											Else
												Set sNlsA  = tbl.colNLSA
												Set sNmsA  = tbl.colNMSA
												Set sMfoA  = tbl.colMFOA
												Set sOkpoA = tbl.colOkpoA
											! Порождаем новый документ NOS
											Call cDoc.SetDoc(0, strNosTt, 1, IifN(nVobNosTt!=0,nVobNosTt,tbl.colVob), tbl.colNd, 
													     GetBankDate(), GetBankDate(), 
													     IifD(tbl.colDateV<GetBankDate(), GetBankDate(), tbl.colDateV), 
													     IifD(tbl.colDateV<GetBankDate(), GetBankDate(), tbl.colDateV),
													     sNlsA,       sNmsA,       sMfoA,        '', tbl.colInvKV, tbl.InvS*100, sOkpoA,
													     tbl2.colNLS, tbl2.colNMS, GetBankMfo(), '', tbl.colInvKV, tbl.InvS*100, IifS(sOKPO!='',sOKPO,tbl.colOkpoB),
													     tbl.colNazn, tbl.colDrec, GetIdOper(),  '', NUMBER_Null, IifN(tbl.colMFOA=GetBankMfo(),0,3))
											If NOT cDoc.oDoc()
												Set sErrTxt = 'Ошибка создания документа ' || strNosTt
												Break
											Set nRefNos = cDoc.m_nRef
											If NOT SqlPLSQLCommand(hSql(), "p_nosw(tbl.colRef, nRefNos, tbl2.colNosBic, tbl2.colNosAcc)")
												Set sErrTxt = 'Ошибка выполнения процедуры P_NOSW'
												Break
											! Связываем документы через refl
											If Subs(strPar01,1,1) = '1'
												Set nTmp = 1
												! NOS - главный, CVV - дочерний (refl в NOS указывает на дочерний CVV)
												If NOT SqlPrepareAndExecute(hSql(), 
														"UPDATE oper SET refl=:tbl.colRef WHERE ref=:nRefNos")
													Set sErrTxt = 'REFL'
													Break
												If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! подпись
													If NOT cDoc.SetDocR(tbl.colRef, TRUE)
														! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
														Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') ||' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1')
														Break
													! Подписываем...
													Set strKeyId = GetIdOper()
													If GetGlobalOptionEx('INTSIGN') = 2
														If NOT cDoc.LockCheckSignStore(tbl.colRef,Grp,nTmp)
															! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
															Call SaveErrorToLog(CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1'))
															Break
													Else
														If NOT SqlPLSQLCommand(hSql(),'chk.PUT_NOS(tbl.colRef,Grp)')
															! 'Невозможно поставить визу'
															Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr2') || ' ' || CurrentLangTable.GetAtomTitle('splKS.cTErr23')
															Break
														If NOT cDoc.sDocVisa()
															! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
															Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTMessVisaGrp') || ' ' || SalNumberToStrX(Grp,0) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErrDocVisa1')
															Break
														Call SqlSetLongBindDatatype(6, BLOB_BYTE)
														If NOT SqlPrepareAndExecute(hSql(), 
																"INSERT INTO oper_visa(ref, dat, userid, groupid, status, keyid, sign) 
																 VALUES(:tbl.colRef, sysdate, :nUSERID, :Grp, :nTmp, :strKeyId, :cDoc.m_lsSign)")
															! 'Невозможно выполнить INSERT INTO oper_visa'
															Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr2') || ' ' || CurrentLangTable.GetAtomTitle('splKS.cTErr24') || ' INSERT INTO oper_visa'
															Break
												Else
													If NOT SqlPLSQLCommand(hSql(),'chk.PUT_NOS(tbl.colRef,Grp)')
														! 'Невозможно поставить визу'
														Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErr2') || ' ' || CurrentLangTable.GetAtomTitle('splKS.cTErr23')
														Break
													If NOT SqlPrepareAndExecute(hSql(),
															"INSERT INTO OPER_VISA(REF, DAT, USERID, GROUPID, STATUS) 
															 VALUES(:tbl.colRef, sysdate, :nUSERID, :Grp, :nTmp )")
														! 'вставить OPER_VISA'
														Set sErrTxt = 
																CurrentLangTable.GetAtomTitle('splKS.cTErr2') || ' ' ||
																CurrentLangTable.GetAtomTitle('splKS.cTErrInsert') || ' OPER_VISA'
														Break
											Else
												! CVV - главный, NOS - дочерний (refl в CVV указывает на дочерний NOS)
												If NOT SqlPrepareAndExecute(hSql(), 
														"UPDATE oper SET refl=:nRefNos WHERE ref=:tbl.colRef")
													Set sErrTxt = 'REFL'
													Break
										!
										Set bOk = TRUE
										Break
									! -- Формируем МТ сообщение
									If bOk AND GetGlobalOptionEx('SWIFT') AND GetBankMfo() != '300001'
										! № МТ берем из доп.реквизитов
										! Call Debug("Point.15: Commercial Bank, Account A belongs to class 2, Generate MT Message")
										! Set nMT = 0
										! If SqlPrepareAndExecute( hSql(),"SELECT NVL(substr(d_rec,-4,3),'0') INTO :sMT FROM oper WHERE ref=:splKS.tbl.colRef")
												and SqlFetchNext(hSql(), nFetchRes)
											                                                                                                             If SalStrIsValidNumber( sMT  )
												                                                                                                             Set nMT = Val(sMT)
										! если там нет и это платеж клиента (2 класс), то МТ=103
										! If =0 and Subs(splKS.tbl.colNLSA,1,1)='2' 
											                                                                                                             Set nMT = 103
										! If nMT >0 
											! Call Debug("Point.16: Make call to SWIFT.Fr_ABS_To_SW procedure.")
											                                                                                                                                                   Set bOk = SqlPLSQLCommand(hSql(), "SWIFT.Fr_ABS_To_SW (nMT, splKS.tbl.colRef ) " )
											                                                                                                                                                   Set sErrTxt = "Error during MT message creation! МТ" || Str(nMT) || ", REF=" || Str(splKS.tbl.colRef)
										! Получаем реквизиты покрытия
										If strMsgGenType = '2'
											If NOT SalModalDialog(dlgSwtCov, hWndForm, nRefNos)
												Set bOk = FALSE
										! Формирование сообщения
										If bOk
											Set bOk = SqlPLSQLCommand(hSql(), "bars_swift_msg.docmsg_process_document2(nRefNos, strMsgGenType)")
										! Call Debug('After')
										Set sErrTxt = "Error during SWIFT message creation! REF=" || Str(splKS.tbl.colRef)
									If bOk
										Call SqlCommitEx(hSql(), 'NOSTRO(Подбор КС). REF#' || Str(tbl.colRef) || '(' || tbl.colTt || ')' || '->' || Str(nRefNos) || '(' || strNosTt || ')')
									Else
										Call SqlRollbackEx(hSql(), 'NOSTRO(Подбор КС). REF#' || Str(tbl.colRef) || ': ' || sErrTxt || '.')
										If sErrTxt
											! 'REF#' || Str(tbl.colRef) || ': Ошибка: ' || sErrTxt
											Call MessageErrorEx('REF#' || Str(tbl.colRef) || ': ' || CurrentLangTable.GetAtomTitle('splKS.cTErr1') || ': ' || sErrTxt || '.')
							! -- Принудительно сбрасываем флаг генерации сообщения
							Call SalWaitCursor(TRUE)
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
							Call SalWaitCursor(FALSE)
						Set strMsgGenType = STRING_Null
		Functions
		Window Parameters
			Number: Grp       !! № спец.группы визирования - ПОДБОР КС
			String: strPar01  !! '1' - подбор КС выполняется для плановых операций, иначе для фактических 
			String: strPar02  !! фильтр на таблицы: tbl_filter#tbl2_filter
		Window Variables
			String: sKlF
			String: strNewTT
			Boolean: bNLSA
			Boolean: bMV_VPS !! Мультивалютная ВПС
			Boolean: bMT103Cov
			Boolean: bNOSTOREF
			String: sErrTxt
			String: strNosTt
			Number: nVobNosTt
			Number: nRow
			Boolean: bOk
			Number: nFlg
			!
			String: sTblFilter
			String: sTbl2Filter
			Number: nScan
			!
			Number: nMaxDig
			Number: nMT
			String: sMT
			!
			String: sNEXTVISAGRP
			String: strDocType
			String: sTmp
			Number: nTmp
			Number: nUSERID
			: cDoc
				Class: cDoc
			String: strKeyId
			Number: nPAP
			String: strMsgGenType      ! Флаг для процедуры генерации сообщения ( char(1))
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('splKS.cTWndTitle'))
				Call ShowApdVersion('11')
				Call PrepareWindowEx(hWndForm)
				! Фильтр при старте
				Set fFilterAtStart = 1
				Set cb_LCV = TRUE
				Set cb_BB  = TRUE
				Set strMsgGenType = STRING_Null
				Call SalSendMsg(cb_LCV, SAM_Click, 0, 0)
				Call SalSendMsg(cb_BB,  SAM_Click, 0, 0)
				! DG: Временно
				Call SalDisableWindow(pbSwt2)
				!
				Set bNOSTOREF = GetGlobalOption('NOSTOREF') = '1'	! Дописывать NOS в старый документ (одним реф., NOS-дочерняя)
				Set strNosTt  = GetGlobalOption('NOSTT')		! Операция для подбора КС
				Set sKlF      = GetGlobalOption('INTA_KOD')		! Есть признак внутр/клиентских счетов в PS
				Set bMV_VPS   = GetGlobalOption('MV_VPS')   = '1'	! Мультивалютная ВПС
				Set bNLSA     = GetGlobalOption('NOSNLSA')  = '1'	! NLSA для NOS брать из настройки операции
				Set bMT103Cov = GetGlobalOption('SW103COV') = '1' ! Признак возможности формирования покрытий
				If NOT strNosTt
					Set strNosTt = 'PS1'
				Else
					Set nVobNosTt = Val(GetValueStr("SELECT min(vob) FROM tts_vob WHERE tt='" || strNosTt || "'"))
				If bMV_VPS
					Call SalShowWindow(splKS.tbl.colMFOA)
				Else
					Call SalHideWindow(splKS.tbl.colMFOA)
				!
				Set sNEXTVISAGRP = NumberToHexSX(Grp)
				Set nUSERID = GetUserId()
				!
				Set hWndForm.splKS.nFlags = GT_NoDel | GT_NoUpd
				Set hWndForm.splKS.strFilterTblName = 'V_SW_CORRACC_DOCS'
				!
				If DigInit() != -1
					Set nMaxDig = DigInit()
				If SqlPrepareAndExecute(hSql(), T(
						"SELECT flags[38,38] FROM tts WHERE tt=:strNosTt INTO :nFlg "))  
						and not SqlFetchNext(hSql(), nFetchRes)
					! 'Не описана транзакция ' || strNosTt
					Set sErrTxt = CurrentLangTable.GetAtomTitle('splKS.cTErrTT') || ' ' || strNosTt
					Call MessageErrorEx(CurrentLangTable.GetAtomTitle('splKS.cTErr1') || ': ' || sErrTxt || '.')
					Call SalSendMsg(hWndForm, UM_Close, 0, 0)
					Return TRUE
				! ЕСЛИ NOS плановая, то меняем в первичной операции в OPER код ТТ c <CVV> на NOS
						  и дальше визируем NOS по ее цепочке виз
				If nFlg   
					Set strNewTT = ''
				! ИНАЧЕ код основной операции в OPER сохранится <CVV>.
				Else
					If Subs(strPar01,1,1) = '1'
						Set strNewTT = ',tt=:strNosTt '
					Else
						Set strNewTT = ',tt=:strNosTt,chk=\'\' '
				! Разбор параметра strPar02 - фильтр на таблицы
				Set nScan = SalStrScan(strPar02, '#')
				If nScan = -1
					Set sTblFilter  = strPar02
					Set sTbl2Filter = ''
				Else
					Set sTblFilter  = Subs(strPar02,1,nScan)
					Set sTbl2Filter = Subs(strPar02,nScan+2,Len(strPar02)-nScan-1)
				! разные select берем из параметров вызова. 
						  Пример: для НБУ (на транзите - плановые) и для КБ (на транзите - фактические)
				If Subs(strPar01,1,1) = '1' 	!! плановые
					Set strDocType = 'PLAN'
					Call SalEnableWindow(tbl.colDateV)
				Else !! фактические
					Set strDocType = 'FACT'
					! Set strSqlPopulate =
							"SELECT OPER.ref,  OPER.tt, OPER.vob, OPER.nd, OPER.vdat, 
							        OPER.nlsa, OPER.id_a, oper.mfoa, OPER.nam_a, 
							        OPER.nlsb, OPER.id_b, OPER.nazn, OPER.d_rec, 
							        OPER.kv, OPER.kv2, decode(OPER.kv2,OPER.kv,OPER.s/100,OPER.s2/100), 
							        OPER.sos, OPER.dk, 2 
							   INTO :splKS.tbl.colRef,  :splKS.tbl.colTt, :splKS.tbl.colVob, :splKS.tbl.colNd, :splKS.tbl.colDateV, 
							        :splKS.tbl.colNLSA, :splKS.tbl.colOkpoA, :splKS.tbl.colMFOA, :splKS.tbl.colNMSA, 
							        :splKS.tbl.colNLSB, :splKS.tbl.colOkpoB, :splKS.tbl.colNazn, :splKS.tbl.colDrec, 
							        :splKS.tbl.colInvKVD,:splKS.tbl.colInvKV, :splKS.tbl.colInvS, 
							        :splKS.tbl.colSos,   :splKS.tbl.colDk, :splKS.tbl.colDig 
							   FROM OPER, operw w 
							  WHERE w.tag='NOS_A' AND OPER.ref=w.ref AND OPER.sos=5 AND w.value='0' 
							  ORDER BY OPER.vdat, OPER.KV2 "
				Set strSqlPopulate =
						"select ref, tt, vob, nd, vdat, 
						        mfoa, nlsa, nam_a, id_a, nlsb, id_b, 
						        nazn, d_rec, kv, kv2, s, trn_amount, sos, dk, lcv_d, lcv_c, dig_c,
						        bank_bic, bank_name, exist_bank_key, can_use_cover
						   into :splKS.tbl.colRef,  :splKS.tbl.colTt, :splKS.tbl.colVob, :splKS.tbl.colNd, :splKS.tbl.colDateV, 
						        :splKS.tbl.colMFOA, :splKS.tbl.colNLSA, :splKS.tbl.colNMSA, :splKS.tbl.colOkpoA,
						        :splKS.tbl.colNLSB, :splKS.tbl.colOkpoB, :splKS.tbl.colNazn, :splKS.tbl.colDrec, 
						        :splKS.tbl.colInvKVD,:splKS.tbl.colInvKV,:splKS.tbl.colInvS, :splKS.tbl.InvS,
						        :splKS.tbl.colSos,  :splKS.tbl.colDk, :splKS.tbl.colLCVD, :splKS.tbl.colLCV  :splKS.tbl.colDig,
						        :splKS.tbl.colBank, :splKS.tbl.colBankName, :splKS.tbl.colBankKey, :splKS.tbl.colUseCover
						   from v_sw_corracc_docs
						  where doc_type = :strDocType " || IifS(sTblFilter='', "", " and (" || sTblFilter || ")") || "
						  order by vdat"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_DoubleClick
				If Not SalIsNull(tbl.colRef)
					Call DocViewContentsEx(hWndForm, tbl.colRef)
	Table Window: KS			! 12
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Справочние корсчетов банка (для SWIFT)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.2"
				Top:    1.833"
				Width:  14.183"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 64000
			Discardable? Class Default
		Description: Справочник КоррСчетов Банка
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10265
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10266
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10267
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colKv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.843"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Return F_KV_NLS ()
					On SAM_DoubleClick
						! Временно сохраняем значение ISOCODE
						Set strTmpCurrISO = colLcv
						Set colLcv = ''
						If FunNSIGet('tabval', 'lcv', strCurrCode, strCurrISO)
							Set colLcv = strCurrISO
							Set colKv = SalStrToNumber(strCurrCode)
						Else
							Set colLcv = strTmpCurrISO
			Column: colLcv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ISO
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.843"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						! Временно сохраняем значение ISOCODE
						Set nTmpCurrCode = colKv
						Set colKv = NUMBER_Null
						If FunNSIGet('tabval', 'lcv', strCurrCode, strCurrISO)
							Set colLcv = strCurrISO
							Set colKv = SalStrToNumber(strCurrCode)
						Else
							Set colKv = nTmpCurrCode
			!
			Column: colNls
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Корр.счет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 15
				Data Type: String
				Justify: Left
				Width:  1.914"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Return F_KV_NLS ()
					On SAM_DoubleClick
						If FunNSIGetFiltered('accounts', 'nls', "accounts.nls like '1_00%' and substr(accounts.nls, 2, 1) in ('5', '6')", strAccCode, strAccNum)
							Set colNls = strAccNum
							Set colAcc = SalStrToNumber(strAccCode)
							Call GetAccCurrency()
			Column: colAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Acc
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.771"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: colBic
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: BIC
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: String
				Justify: Left
				Width:  1.443"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set colBankName = STRING_Null
						If not SalIsNull(hWndItem)
							Set colBic = SalStrUpperX(colBic)
							If SqlPrepareAndExecute(hSql(), 
									  "SELECT name INTO :colBankName FROM sw_banks WHERE bic=:colBic" )
									and not SqlFetchNext(hSql(), nFetchRes )
								Call SalMessageBox( CurrentLangTable.GetAtomTitle('KS.cTErrBIC'),
										  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation | MB_Ok)
								Return VALIDATE_Cancel
					On SAM_DoubleClick
						If FunNSIGet('sw_banks', 'name', strBicCode, strBankName)
							Set colBic = strBicCode
							Set colBankName = strBankName
			Column: colBankName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование банка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.271"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colVostroAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счет VOSTRO
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 35
				Data Type: String
				Justify: Left
				Width:  2.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNlsTran
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Транзитный счет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 15
				Data Type: String
				Justify: Left
				Width:  2.086"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                                Call SqlPrepareAndExecute(hSql(), "
								     SELECT acc
								     INTO :colAccTran
								     FROM accounts
								     WHERE kv=:colKv and nls=:colNlsTran")
						                                                                                                                                                                                                                Set bOk = SqlFetchNext(hSql(), nInd)
						                                                                                                                                                                                                                If bOk
							                                                                                                                                                                                                                Return VALIDATE_Ok
						                                                                                                                                                                                                                Else 
							                                                                                                                                                                                                                Set nInd = SalMessageBox('Счет не открыт! Принять '
									    || 'как есть?', 'Ошибка',
									    MB_IconExclamation | MB_YesNo)
							                                                                                                                                                                                                                If nInd = IDYES
								                                                                                                                                                                                                                Return VALIDATE_Ok
							                                                                                                                                                                                                                Else 
								                                                                                                                                                                                                                Return VALIDATE_Cancel
			Column: colAccTran
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: AccTran
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.771"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Acc
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.771"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_KV_NLS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set colAcc = NUMBER_Null
					Set colLcv = STRING_Null
					!
					If colKv=NUMBER_Null
						Return TRUE
					Else
						If SqlPrepareAndExecute(hSql(), 
								   "SELECT lcv INTO :colLcv FROM tabval WHERE kv=:colKv ")
								and not SqlFetchNext(hSql(), nFetchRes )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('KS.cTErrKV'),
									  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation | MB_Ok)
							Return FALSE
					If colNls =STRING_Null
						Return TRUE
					!
					If SqlPrepareAndExecute(hSql(), 
							  "SELECT acc INTO :colAcc FROM accounts WHERE kv=:colKv and nls=:colNls")
							and not SqlFetchNext(hSql(), nFetchRes )
						Call SalMessageBox( CurrentLangTable.GetAtomTitle('KS.cTErrNLS') , 
								  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation | MB_Ok)
						Return FALSE
					Return TRUE
					!
			Function: GetAccCurrency
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nTmpCurrCode = colKv
					If SqlPrepareAndExecute(hSql(), 
							  "SELECT kv INTO :colKv FROM accounts WHERE acc = :colAcc")
							and SqlFetchNext(hSql(), nFetchRes )
						Call SalSendMsg(colKv, SAM_Validate, 0, 0) 
					Else
						Set colKv = nTmpCurrCode
					Return TRUE
					!
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: strCurrISO
			String: strCurrCode
			String: strTmpCurrISO
			Number: nTmpCurrCode
			String: strAccCode
			String: strAccNum
			String: strBicCode
			String: strBankName
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('KS.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				! Call SetWindowFullSize( hWndForm )
				! Set KS.fFilterAtStart=1
				Set KS.strFilterTblName = 'BIC_ACC'
				Set KS.strPrintFileName = 'BIC_ACC'
				Set KS.strSqlPopulate =
						"SELECT an.KV, t.LCV, an.NLS, bic_acc.BIC, s.NAME, bic_acc.ACC, 
						        at.NLS, bic_acc.TRANSIT, bic_acc.THEIR_ACC,
						        bic_acc.rowid
						 INTO :KS.colKv, :KS.colLcv, :KS.colNls, :KS.colBic, :KS.colBankName, :KS.colAcc,
						      :KS.colNlsTran, :KS.colAccTran, :KS.colVostroAcc,
						      :KS.colRI
						 FROM accounts an, accounts at, tabval t, bic_acc, sw_banks s
						 WHERE an.acc=bic_acc.acc AND an.kv=t.kv AND bic_acc.BIC=s.BIC and 
						       at.acc (+)=bic_acc.TRANSIT "
				Set KS.strSqlUpdate =
						"UPDATE bic_acc SET
						        bic_acc.BIC=:KS.colBic,
						        bic_acc.ACC=:KS.colAcc, 
						        bic_acc.TRANSIT=:KS.colAccTran,
						        bic_acc.THEIR_ACC=:KS.colVostroAcc 
						WHERE rowid=:KS.colRI "
				Set KS.strSqlDelete = "DELETE FROM bic_acc WHERE rowid=:KS.colRI "
				Set KS.strSqlInsert = 
						"INSERT INTO bic_acc (BIC,ACC,TRANSIT,THEIR_ACC ) VALUES 
						(:KS.colBic,:KS.colAcc,:KS.colAccTran,:KS.colVostroAcc) "
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call SalWaitCursor( FALSE )
	Form Window: frm_BIC_Import		! 13
		Class:
		Property Template:
		Class DLL Name:
		Title: Импорт справочника BIC
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.833"
				Width Editable? Yes
				Height: 2.488"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Импорт BIC Directory из файла обновления SWIFT
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Источник:
				Resource Id: 27860
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.117"
					Top:    0.155"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgFileName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfFileName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.2"
						Top:    0.104"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.298"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Arial Cyr
					Font Size: 9
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbBrowse
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Искать...
				Window Location and Size
					Left:   6.35"
					Top:    0.095"
					Width:  1.183"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If SalDlgOpenFile( hWndForm, CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTBrowse'), strFilters, 2, nIndex, strFileName, strPath )
							Set dfFileName = strPath
			Check Box: cbInitialImport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Режим первичного импорта ( добавление недостающих )
				Window Location and Size
					Left:   0.117"
					Top:    0.512"
					Width:  7.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Custom Control: ccMeter
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cMeter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    0.893"
						Width:  7.417"
						Width Editable? Class Default
						Height: 0.345"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Royal Blue
					Background Color: Class Default
					DLL Settings
				Message Actions
			Pushbutton: pbAction
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Старт
				Window Location and Size
					Left:   1.633"
					Top:    1.476"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If fImportStart
							Set fCancel = TRUE
							Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTStart') )
						Else
							Set fCancel = FALSE
							Set fImportStart = TRUE
							Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTExit') )
							Call DoImport( dfFileName )
							Set fImportStart = FALSE
							Call ccMeter.SetProgress( 0 )
							Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTStart') )
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Выйти
				Window Location and Size
					Left:   4.533"
					Top:    1.476"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow( hWndForm )
		Functions
			Function: DoImport
				Description: Начать импорт!
				Returns
				Parameters
					String: strFile
				Static Variables
				Local variables
					File Handle: hFile
					!
					Number: nRows
					Number: nIterator
					!
					String: strRecord
					: cRow
						Class: cBicDirectoryRecord
					String: strAction
				Actions
					! If cbInitialImport
						                                                                                                                                                                      Call SalMessageBox('Initial', 'Imp', MB_OK)
						! E
					! Else
						                                                                                                                                                                      Call SalMessageBox('not Initial', 'Imp', MB_OK)
					If Not SalFileOpen( hFile, strFile, OF_Read | OF_Text )
						Call SalMessageBeep( MB_IconStop )
						Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTErrFileOpen') || ' ' || strFile, CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTImport')||': '||CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
						Return FALSE
					!
					Call SalFileSeek( hFile, 0, FILE_SeekEnd ) 
					Set nRows = SalFileTell( hFile ) / BICDirectoryRecLen
					Call SalFileSeek( hFile, 0, FILE_SeekBegin ) 
					!
					Set nIterator = 0
					Call SalYieldEnable( TRUE )
					Call SalYieldStartMessages( pbAction )
					While NOT fCancel AND nIterator < nRows
						Call SalFileSeek( hFile, nIterator * BICDirectoryRecLen, FILE_SeekBegin ) 
						If SalFileGetStr( hFile, strRecord, BICDirectoryRecLen ) AND cRow.setRecord( strRecord )
							Set strFullName    = cRow.strIName || ' ' || cRow.strBranchName
							Set strFullAddress = cRow.strAddress || ' ' || cRow.strLocation 
							! put it into database
							If cbInitialImport
								If cRow.strOperation != 'D'
									When SqlError
										Return FALSE
									! Call SalMessageBox(cRow.strBIC, 'Debug', MB_OK)
									! Call SalMessageBox('Step1', 'Debug', MB_OK)
									Call SqlPLSQLCommand(hSql(), 'swift.import_swbank(1, strAction, cRow.strBIC, strFullName, strFullAddress, cRow.strHQCity, cRow.strCountry)')
									! Call SalMessageBox('Step2', 'Debug', MB_OK)
									! Call SqlPrepareAndExecute(hSql(), 
											'UPDATE SW_BANKS SET name = :strFullName, office = :strFullAddress, city = :cRow.strHQCity, 
											                     country = :cRow.strCountry)
											 WHERE bic = :cRow.strBIC')
									! Call SqlGetModifiedRows( hSql(), nRowAffected )
									! Call SalMessageBox(SalNumberToStrX(nRowAffected, 0), 'debug', MB_OK)
									! If SqlGetModifiedRows( hSql(), nRowAffected )
										! If nRowAffected = 0
											                                                                                                                                                                     Call SalMessageBox('rows=>0', 'debug', MB_OK)
											                                                                                                                                                                     Call SqlPrepareAndExecute(hSql(), 
													'INSERT INTO SW_BANKS (bic, name, office, city, country)
													 VALUES (:cRow.strBIC, :strFullName, :strFullAddress, :cRow.strHQCity, :cRow.strCountry)')
							Else
								When SqlError
									Return FALSE
								Call SqlPLSQLCommand(hSql(), 'swift.import_swbank(2, cRow.strOperation, cRow.strBIC, strFullName, strFullAddress, cRow.strHQCity, cRow.strCountry)')
								! If cRow.strOperation = 'D'      ! Delete
									                                                                                                                                                                     When SqlError
										                                                                                                                                                                     Return FALSE
									                                                                                                                                                                     Call SqlPrepareAndExecute(hSql(), 'DELETE FROM SW_BANKS WHERE bic=:cRow.strBIC')
								! Else If cRow.strOperation = 'A' ! Append
									                                                                                                                                                                     When SqlError
										                                                                                                                                                                     Return FALSE
									                                                                                                                                                                     Call SqlPrepareAndExecute(hSql(), 
											'INSERT INTO SW_BANKS (bic, name, office, city, country)
											 VALUES (:cRow.strBIC, :strFullName, :strFullAddress, :cRow.strHQCity, :cRow.strCountry)')
								! Else If cRow.strOperation = 'M' OR
										        cRow.strOperation = 'W' ! Modified
									                                                                                                                                                                     When SqlError
										                                                                                                                                                                     Return FALSE
									                                                                                                                                                                     Call SqlPrepareAndExecute(hSql(), 
											'UPDATE SW_BANKS SET name = :strFullName, office = :strFullAddress, city = :cRow.strHQCity, 
											                     country = :cRow.strCountry)
											 WHERE bic = :cRow.strBIC')
							!
							Set nIterator = nIterator + 1
							If SalNumberMod( nIterator, 500 ) = 0
								Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTSaveBIC')|| ': ' || SalNumberToStrX( nIterator, 0) )
							Call ccMeter.SetProgress( SalNumberRound( nIterator / nRows * 100 ) )
							Call SalUpdateWindow( hWndForm.frm_BIC_Import.dfFileName )
							Call SalUpdateWindow( hWndForm.frm_BIC_Import.pbBrowse )
							Call SalUpdateWindow( hWndForm.frm_BIC_Import.cbInitialImport )
							Call SalUpdateWindow( hWndForm.frm_BIC_Import.pbAction )
							Call SalUpdateWindow( hWndForm.frm_BIC_Import.pbExit )
							Call SalUpdateWindow( hWndForm )
						Else
							Set fCancel = TRUE
							Call SalMessageBeep( MB_IconStop )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTErrFile')|| ' ' || strFile || ' ' || CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTErrFileStrukt'), 
									  CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTImport')||': '||CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTErr'), MB_IconStop )
					If fCancel
						Call SqlRollbackEx( hSql(), CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTErrImportBIC') )
						Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTMessImportNO'), CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTImport'), MB_Ok | MB_IconStop )
					Else
						Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTImpBIC') ||': ' || SalNumberToStrX( nIterator, 0) )
						Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTMessImportOK'), CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTImport'), MB_Ok | MB_IconAsterisk )
					Call SalYieldStopMessages( )
					!
					Call SalFileClose( hFile )
		Window Parameters
		Window Variables
			String: strFileName
			String: strPath
			String: strFilters[2]
			Number: nIndex
			!
			Boolean: fImportStart
			Boolean: fCancel
			!
			String: strFullName
			String: strFullAddress
			Number: nRowAffected
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_BIC_Import.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Call ccMeter.SetProgress( 0 )
				!
				Call SalUseRegistry( FALSE, GetCompanyName() )
				Call SalGetProfileString( INI_Directory, 'SWIFTNSIDir', GetPrnDir(), strPath, GetIniFileName() )
				Set strFileName = 'FI.DAT'
				Set strPath     = strPath || '\\' || strFileName
				Set dfFileName  = strPath
				!
				Set strFilters[0] = 'BIC Directory'
				Set strFilters[1] = 'FI.DAT'
				Set nIndex        = 1
				!
				Call SalSetFocus( pbAction )
			On SAM_CreateComplete
				Call SalWaitCursor( FALSE )
	!
	Table Window: tblWaitDK		! 14
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Прогноз состояния НОСТРО-счетов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.03"
				Top:    1.117"
				Width:  12.657"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Прогноз состояния НОСТРО счетов
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28034
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.35"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28035
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 28036
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: cpb_Timer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.9"
						Top:    0.135"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.292"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On UM_TimerFired
							Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
		Contents
			Column: colNLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Номер ЛС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование ЛС
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Валюта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOst
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDog
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						дебет
						ожидаемые
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKog
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						кредит
						ожидаемые
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOstog
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ожидаемый
						остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: SetOSColorRow
				Description: Покрасить поле остатка в нужный цвет
				Returns
				Parameters
					Number: nOS
					Window Handle: hCol
				Static Variables
				Local variables
					Number: nInd
				Actions
					If nOS < 0
						Set nInd=COLOR_Red
					Else If nOS > 0
						Set nInd=COLOR_DarkBlue
					Else
						Set nInd=COLOR_Black
					Call SalTblSetCellTextColor( hCol, nInd, FALSE )
		Window Parameters
		Window Variables
			String: sNewFrom
			String: sNewWhere
			Number: nInterval
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tblWaitDK.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Set tblWaitDK.nFlags = GT_ReadOnly
				Set fFilterAtStart=TRUE
				Set tblWaitDK.strFilterTblName = 'ACCOUNTS'
				Set tblWaitDK.strPrintFileName = 'Waitdk.txt'
				Call SalDisableWindow( tblWaitDK.pbIns )
				Call SalDisableWindow( tblWaitDK.pbDel )
				Call SalDisableWindow( tblWaitDK.pbUpdate )
				Call SalDisableWindow( tblWaitDK.pbDetails )
				Set nInterval=300
				Call cpb_Timer.Init(nInterval, 0, TRUE)
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call SalWaitCursor( FALSE )
			On UM_Populate
				If fFilterAtStart
					Call SetQueryFilter( cF )
					Set fFilterAtStart = NOT fFilterAtStart
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set sNewWhere = cF.GetFilterWhereClause( FILTER_Complex)
				Set sNewFrom = cF.GetFilterFromClause( FILTER_Complex )
				If sNewWhere != ''
					Set sNewWhere = ' AND ' || sNewWhere 
				If sNewFrom  != ''
					Set sNewFrom = ' , ' || sNewFrom 
				Set strDSql = '
						SELECT accounts.nls, accounts.nms, tabval.lcv, 
						       accounts.dos/100, accounts.kos/100, accounts.ostc/100, 
						       x.dos/100, x.kos/100, (accounts.ostb-x.dos+x.kos)/100
						INTO :hWndForm.tblWaitDK.colNLS, :hWndForm.tblWaitDK.colNMS, 
						     :hWndForm.tblWaitDK.colKV,  :hWndForm.tblWaitDK.colDob,
						     :hWndForm.tblWaitDK.colKob, :hWndForm.tblWaitDK.colOst, 
						     :hWndForm.tblWaitDK.colDog, :hWndForm.tblWaitDK.colKog, 
						     :hWndForm.tblWaitDK.colOstog
						FROM accounts, tabval,
						(
						SELECT SUM(amount) dos, 0 kos, a.nls nls, a.kv kv 
						FROM sw_journal j, accounts a 
						WHERE a.acc=j.accd AND j.accd IS NOT NULL AND swref NOT IN (SELECT swref FROM sw_oper) 
						GROUP BY a.nls, a.kv 
						UNION ALL 
						SELECT 0 dos, SUM(amount) kos, a.nls nls, a.kv kv 
						FROM sw_journal j, accounts a 
						WHERE a.acc=j.acck AND j.acck IS NOT NULL AND swref NOT IN (SELECT swref FROM sw_oper) 
						GROUP BY a.nls, a.kv 
						) x ' || sNewFrom || ' 
						WHERE  x.nls(+)=accounts.nls AND x.kv(+)=accounts.kv AND accounts.nbs IN (1500, 1600) 
						AND accounts.dazs IS NULL AND accounts.kv=tabval.kv ' ||
						sNewWhere
				!
				Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
				Call VisTblAutoSizeColumn( tblWaitDK, hWndNULL )
				Call SalTblSetContext(hWndForm, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If SalIsNull( colDog )
					Set colDog = 0
				If SalIsNull( colKog )
					Set colKog = 0
				If SalIsNull( colOstog )
					Set colOstog = colOst
				Call SetOSColorRow( colOst, SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colOst ), COL_GetID ))
				Call SetOSColorRow( colOstog, SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colOstog ), COL_GetID ))
	!
	Form Window: frm_TBK		! 15
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Nostro Reconciliation (MT950 Processing)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.3"
				Width Editable? Class Default
				Height: 6.631"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: NOSTRO Reconciliation
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call Debug('Updating fired')
				Line
					Resource Id: 6001
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.4"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CHILDS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Детальные строки выписки
							Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cTMBLTitle')
				Pushbutton: pbSetNostroAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.967"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Указать НОСТРО счет
							Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cTBGetNosro')
						On SAM_Click
							Set sNOSTROAcc = ''
							Set sNOSTROSemantic = ''
							If FunNSIGetFilteredAltPK('V_NOSTRO_ACCOUNTS', 'ACC', 'THEIR_ACC',
									   'V_NOSTRO_ACCOUNTS.BIC=\'' || StmtHdr.colStmtSender || '\' AND V_NOSTRO_ACCOUNTS.KV = ' || Str(StmtHdr.colStmtCurrCode), 
									   sNOSTROAcc, sNOSTROSemantic  ) > 0
								! Если строк не было и нажали ОК, то функция возвращает значение 0
								! Такое значение привязывать не нужно
								If SalStrToNumber(sNOSTROAcc) != 0
									Set StmtHdr.colNosAccCode = SalStrToNumber(sNOSTROAcc)
									If SqlPLSQLCommand(hSql(), "bars_swift.stmt_set_nostroacc(frm_TBK.StmtHdr.colStmtRef, frm_TBK.StmtHdr.colNosAccCode)")
										Call SqlCommitEx(hSql(), "Установлен счет выписки")
									Else
										Call SqlRollbackEx(hSql(), "Ошибка установки счета выписки")
									Call SalSendMsg(StmtHdr, UM_Populate, 0, 0)
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.85"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6002
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  4.35"
						Begin Y:  Class Default
						End X:  4.35"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.15"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6003
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  5.667"
						Begin Y:  Class Default
						End X:  5.667"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfNosAccName
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.533"
							Top:    0.107"
							Width:  4.55"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbSwitch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.45"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Class Default
						Height: 0.317"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Switch.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Все
							Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBStmtTypeAll')
							Set nStmtType = 0
						On SAM_Click
							If nStmtType = 0
								! Необработанные
								Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBStmtTypeActive')
								Set nStmtType = 1
							Else
								! Все
								Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBStmtTypeAll')
								Set nStmtType = 0
							Call SetQueryFilter(StmtHdr.cF)
							! Перечитываем список заголовков выписок
							Call SalSendMsg(StmtHdr, UM_Populate, 0, 0)
				Line
					Resource Id: 48209
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.0"
						Begin Y:  0.44"
						End X:  5.0"
						End Y:  0.024"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
		Contents
			Child Table: StmtHdr
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.133"
						Top:    0.048"
						Width:  9.483"
						Width Editable? Class Default
						Height: 2.333"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Maize
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colStmtRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № п/п
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtSender
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: BIC
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф сообщ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtPage
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
								Стр.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtAccNum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ЛОРО- 
								счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtCurrCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								вал
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtCurrency
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ISO
								вал
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtBegDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Нач.дата
								выписки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  0.867"
						Width Editable? Class Default
						Format: Date
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colStmtEndDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кон.дата
								выписки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.029"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtRestIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Входящий 
								по 950
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtDebitTurn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ДЕБЕТ
								по 950
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.167"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtCreditTurn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: КРЕДИТ
								по 950
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.167"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtRestOut
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Исходящий
								по 950
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStmtCntLines
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								дет. строк
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colStmtCntProc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кол-во 
								необ. строк
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colStmtState
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: К
								В
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Center
						Width:  0.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If colStmtState
									Call ChangeStatementState(colStmtRef, 1)
								Else
									Call ChangeStatementState(colStmtRef, 0)
								Call SalSendMsg(StmtHdr, UM_Populate, 0, 0)
							On SAM_SqlError
								! Call ShowSqlError(wParam, lParam)
								!
								! Return FALSE
								Call Debug('SAM_SqlError fired')
					Column: colNosAccCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: NOSTRO 
								счет
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNosAccNum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: NOSTRO 
								счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNosAccName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNosRestIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Входящий
								по  NOSTRO
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNosRestOut
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Исходящий
								по NOSTRO
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNosCntTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кол-во опер.
								 по NOSTRO
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: sFilter
					String: sFilter2
				Message Actions
					On UM_Populate
						If frm_TBK.fFilterAtStart
							If NOT SetQueryFilter(cF)
								Call SalEndDialog(frm_TBK, 0)
							Set frm_TBK.fFilterAtStart = NOT frm_TBK.fFilterAtStart
						Set sFilter2 = SalStrTrimX(SalStrUpperX(strPar01))
						If sFilter2 != ""
							If Subs(sFilter2,1,3) != 'AND'
								Set sFilter2 = 'AND ' || sFilter2
						Call SalWaitCursor(TRUE)
						Set sFilter = ""
						Set sFilter = cF.GetFilterWhereClause(FALSE)
						If nStmtType = 0
							! Необработанные
							Call SalSetWindowText(frm_TBK, CurrentLangTable.GetAtomTitle('frm_TBK.cTWndTitle') || ' ' || CurrentLangTable.GetAtomTitle('frm_TBK.cBStmtTypeActive'))
							Set frm_TBK.strSqlPopulate =
									"select 
									            stmt_ref, sender_bic, stmt_trn, stmt_page,
									            loro_accnum, stmt_currcode, stmt_currency,
									            stmt_beg_date, stmt_end_date, stmt_rest_in,
									            stmt_dos stmt_debit_turn, stmt_kos stmt_credit_turn, stmt_rest_out,
									            stmt_detail_count, stmt_nproc_count, stmt_processed,
									            nostro_acccode, nostro_accnum, nostro_accname, 
									            nostro_rest_in, nostro_rest_out, nostro_trn_count
									     into 
									            :frm_TBK.StmtHdr.colStmtRef, :frm_TBK.StmtHdr.colStmtSender, :frm_TBK.StmtHdr.colStmtTrn, :frm_TBK.StmtHdr.colStmtPage,
									            :frm_TBK.StmtHdr.colStmtAccNum, :frm_TBK.StmtHdr.colStmtCurrCode, :frm_TBK.StmtHdr.colStmtCurrency,
									            :frm_TBK.StmtHdr.colStmtBegDate, :frm_TBK.StmtHdr.colStmtEndDate, :frm_TBK.StmtHdr.colStmtRestIn, 
									            :frm_TBK.StmtHdr.colStmtDebitTurn, :frm_TBK.StmtHdr.colStmtCreditTurn, :frm_TBK.StmtHdr.colStmtRestOut,
									            :frm_TBK.StmtHdr.colStmtCntLines, :frm_TBK.StmtHdr.colStmtCntProc, :frm_TBK.StmtHdr.colStmtState,
									            :frm_TBK.StmtHdr.colNosAccCode, :frm_TBK.StmtHdr.colNosAccNum, :frm_TBK.StmtHdr.colNosAccName,
									            :frm_TBK.StmtHdr.colNosRestIn, :frm_TBK.StmtHdr.colNosRestOut, :frm_TBK.StmtHdr.colNosCntTrn
									  from v_sw950_header
									 where stmt_currcode > 0 " ||  sFilter2 ||  
									   IifS( sFilter = "", "", " AND " || sFilter ) || " 
									 order by sender_bic, stmt_currcode, nostro_accnum, stmt_num"
						Else
							! Все
							Call SalSetWindowText(frm_TBK, CurrentLangTable.GetAtomTitle('frm_TBK.cTWndTitle') || ' ' || CurrentLangTable.GetAtomTitle('frm_TBK.cBStmtTypeAll'))
							Set frm_TBK.strSqlPopulate =
									"select 
									            stmt_ref, sender_bic, stmt_trn, stmt_page,
									            loro_accnum, stmt_currcode, stmt_currency,
									            stmt_beg_date, stmt_end_date, stmt_rest_in,
									            0 stmt_debit_turn, 0 stmt_credit_turn, stmt_rest_out,
									            stmt_detail_count, stmt_nproc_count, stmt_processed,
									            nostro_acccode, nostro_accnum, nostro_accname, 
									            nostro_rest_in, nostro_rest_out, nostro_trn_count
									     into 
									            :frm_TBK.StmtHdr.colStmtRef, :frm_TBK.StmtHdr.colStmtSender, :frm_TBK.StmtHdr.colStmtTrn, :frm_TBK.StmtHdr.colStmtPage,
									            :frm_TBK.StmtHdr.colStmtAccNum, :frm_TBK.StmtHdr.colStmtCurrCode, :frm_TBK.StmtHdr.colStmtCurrency,
									            :frm_TBK.StmtHdr.colStmtBegDate, :frm_TBK.StmtHdr.colStmtEndDate, :frm_TBK.StmtHdr.colStmtRestIn, 
									            :frm_TBK.StmtHdr.colStmtDebitTurn, :frm_TBK.StmtHdr.colStmtCreditTurn, :frm_TBK.StmtHdr.colStmtRestOut,
									            :frm_TBK.StmtHdr.colStmtCntLines, :frm_TBK.StmtHdr.colStmtCntProc, :frm_TBK.StmtHdr.colStmtState,
									            :frm_TBK.StmtHdr.colNosAccCode, :frm_TBK.StmtHdr.colNosAccNum, :frm_TBK.StmtHdr.colNosAccName,
									            :frm_TBK.StmtHdr.colNosRestIn, :frm_TBK.StmtHdr.colNosRestOut, :frm_TBK.StmtHdr.colNosCntTrn
									  from v_sw950_all_header v_sw950_header
									 where stmt_currcode > 0 and stmt_beg_date >= :dtMinSVDate and stmt_end_date <= :dtMaxSVDate " ||  sFilter2 ||  
									   IifS( sFilter = "", "", " AND " || sFilter ) || " 
									 order by sender_bic, stmt_currcode, nostro_accnum, stmt_num"
						Call SalTblPopulate(hWndForm, hSql(), frm_TBK.strSqlPopulate, TBL_FillAll)
						Call SalTblSetContext(hWndForm, 0)
						Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
						!
						Call VisTblAutoSizeColumn( StmtHdr, hWndNULL )
						Call DisableButtons()
						Call SalTblSetContext(StmtHdr, 0)
						Call SalWaitCursor( FALSE )
					On SAM_FetchRowDone
						Call XSalTblSetRowBackColor( StmtHdr, lParam, SalColorFromRGB( 255,255,180) )
					On SAM_DoubleClick
						Call PopulateDetail(1)
					On SAM_RowSetContext
						Call SalTblReset(StmtDetail)
						Call SalTblReset(Docs)
						Set dfNosAccName = StmtHdr.colNosAccName
						If StmtHdr.colNosAccCode
							Call SalDisableWindow( pbSetNostroAcc )
						Else
							Call SalEnableWindow( pbSetNostroAcc )
					On SAM_ContextMenu
						Call SalCreateWindow(SWJ1, hWndMDI, StmtHdr.colStmtRef, STRING_Null )
			Custom Control: cSplMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  8.0"
						Width Editable? Class Default
						Height: 3.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.9"
						Top:    0.131"
						Width:  0.883"
						Width Editable? Class Default
						Height: 0.464"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   11.267"
						Top:    0.655"
						Width:  0.517"
						Width Editable? Class Default
						Height: 0.369"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
					On SAM_Create
						Call SalColorSet( cSplMBR, 5, SalColorFromRGB( 58, 110, 165 ) )
						Call SalColorSet( cSplMBR, 8, COLOR_White )
			Custom Control: cSplMBRT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   11.167"
						Top:    1.524"
						Width:  0.5"
						Width Editable? Class Default
						Height: 0.31"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBRTL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   11.283"
						Top:    1.917"
						Width:  0.383"
						Width Editable? Class Default
						Height: 0.369"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.633"
						Top:    0.714"
						Width:  0.533"
						Width Editable? Class Default
						Height: 0.262"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
					On SAM_Create
						Call SalColorSet( cSplMBL, 5, SalColorFromRGB( 58, 110, 165 ) )
						Call SalColorSet( cSplMBL, 8, COLOR_White )
			Custom Control: cSplMBLT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.567"
						Top:    1.095"
						Width:  0.567"
						Width Editable? Class Default
						Height: 0.262"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBLTL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   11.217"
						Top:    1.143"
						Width:  0.367"
						Width Editable? Class Default
						Height: 0.274"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBLTLR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    1.631"
						Width:  0.583"
						Width Editable? Class Default
						Height: 0.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBLTLR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    1.631"
						Width:  0.583"
						Width Editable? Class Default
						Height: 0.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBLTLR2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    1.631"
						Width:  0.583"
						Width Editable? Class Default
						Height: 0.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBLTLR3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    1.631"
						Width:  0.583"
						Width Editable? Class Default
						Height: 0.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Pushbutton: pbView
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.083"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Оригинал SWIFT-сообщения /Одна стр.
						Set strTip=CurrentLangTable.GetAtomTitle('frm_TBK.cBTipSWDetails')
					On SAM_Click
						! DG: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! TODO
						! Если к строке прикреплен документ, то просмотр документа
						! Если к строке прикреплено только сообщение, то просмотр сообщения
						If StmtDetail.colProcessed='Y'
							If SqlPrepareAndExecute(hSql(),"select ref  into :nTmpDocRef from sw_oper where swref = :StmtHdr.colStmtRef and swrnum = :StmtDetail.colN")
								While SqlFetchNext(hSql(), nFetchRes)
									Call DocViewContentsEx(hWndForm, nTmpDocRef)
						Else If not SalIsNull(StmtDetail.colSrcSwRef)
							Call SWIFTMsgView(hWndMDI, StmtDetail.colSrcSwRef)
			Pushbutton: pbNewDoc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.567"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Обработать сообщение...
						Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBTipOPL')
						Call SalSendMsg(hWndItem, SAM_User, 0, 0)
					On SAM_Click
						! Разрешаем обработку транзакций в соответствии с разрешенным диапазонам дат
						If (StmtDetail.colVDate > dtMaxSVDate or StmtDetail.colVDate < dtMinSVDate)
							Call SalMessageBox("Дата валютирования строки не входит в разрешенный диапазон (" ||  SalFmtFormatDateTime(dtMinSVDate, 'dd/MM/yyyy')  ||" - " || SalFmtFormatDateTime(dtMaxSVDate, 'dd/MM/yyyy') || ")", "Ошибка", MB_Ok)
							Return FALSE
						Set sCurTT = ''
						If nTTArr < 1
							Call SalMessageBeep( MB_IconStop )
							! Пользователю не даны права на банковские операции для SWIFT!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTMessUserTT'), 
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconStop )
							Return FALSE
						Else
							If nTTArr = 1
								Set sCurTT = strTTArr[0,0]
							Else
								If NOT SalModalDialog( dlg_PickUpTT, hWndForm, strTTArr, nTTArr, sCurTT )
									Return FALSE
							If not SalIsNull( StmtDetail.colSrcSwRef ) 
								If StmtDetail.colDebitSum = NUMBER_Null
									Set sNlsA = StmtHdr.colNosAccNum
									Set sNlsB = GetAccB(StmtDetail.colSrcSwRef)
								Else
									Set sNlsA = GetAccB(StmtDetail.colSrcSwRef)
									Set sNlsB = StmtHdr.colNosAccNum
								! Получаем реф. связанного сообщения, т.е. если разбираем 202 и есть сообщение 103
								! по которому было создано 202, то будем показывать именно 103
								If SqlPLSQLCommand(hSql(),"bars_swift.impmsg_message_getrelmsg(StmtDetail.colSrcSwRef, nRelMsgRef, nRelMsgMt)")
									Call SqlFetchNext(hSql(),nFetchRes)
								! Получаем отправителя и получателя сообщения
								If SqlPrepareAndExecute(hSql(),"SELECT sender, receiver INTO :strMsgSender, :strMsgReceiver FROM sw_journal WHERE swref = :nRelMsgRef")
									Call SqlFetchNext(hSql(),nFetchRes)
								Call SalCreateWindow( frmDoc, hWndForm, 
										     StmtHdr, nRelMsgRef, nRelMsgMt, StmtHdr.colStmtTrn, sCurTT, StmtHdr.colStmtCurrency, 
										     IifN(StmtDetail.colDebitSum != NUMBER_Null, StmtDetail.colDebitSum, StmtDetail.colCreditSum)*100, 
										     strMsgSender, strMsgReceiver, sNlsA, sNlsB, GetBankDate(), 'E'||sUseF, 0 )
							Else
								! Без прикрепленного сообщения
								If StmtDetail.colDebitSum = NUMBER_Null
									Set sNlsA = StmtHdr.colNosAccNum
									Set sNlsB = STRING_Null
								Else
									Set sNlsA = STRING_Null
									Set sNlsB = StmtHdr.colNosAccNum
								Call SalCreateWindow( frmDoc, hWndForm, 
										     StmtHdr, StmtHdr.colStmtRef, 950, StmtHdr.colStmtTrn, sCurTT, StmtHdr.colStmtCurrency, 
										     IifN(StmtDetail.colDebitSum != NUMBER_Null, StmtDetail.colDebitSum, StmtDetail.colCreditSum)*100, 
										     StmtHdr.colStmtSender, STRING_Null, sNlsA, sNlsB, GetBankDate(), 'EN'||sUseF, StmtDetail.colN )
						Call PopulateDetail(1)
					On SAM_User
						If SqlPrepareAndExecute( hSql(), "
								  SELECT t.tt, t.name 
								  INTO :strTT, :strTTName 
								  FROM tts t, staff_tts s 
								  WHERE s.tt = t.tt AND s.id = :nUserId AND 
								        t.tt IN (SELECT tt from sw_tt_import WHERE io_ind ='O') " || strSecure )
							Set nTTArr = 0
							While SqlFetchNext( hSql(), nFetchRes )
								Set strTTArr[nTTArr, 0] = strTT
								Set strTTArr[nTTArr, 1] = strTTName
								Set nTTArr = nTTArr + 1
			Pushbutton: pbAbs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.05"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Документ в АБС
						Set strTip=CurrentLangTable.GetAtomTitle('frm_TBK.cBTipAbs')
			Child Table: StmtDetail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.133"
						Top:    2.905"
						Width:  4.917"
						Width Editable? Yes
						Height: 1.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № пп
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colVDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата 
								движения
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDebitSum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: DEBET
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCreditSum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: CREDIT
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwTT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: BIC
								корресп
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.317"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colMt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTheirRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: МТ-РЕФ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDetail
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Детали
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.867"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSrcSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: I
								O
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colProcessed
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф
								АБС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( StmtDetail, UM_QueryLabelText, 0, 0 )
					On SAM_RowSetContext
						Call SalDisableWindow(pbAbs)
						Call SalTblReset( Docs )
						! Если строка обработана
						If StmtDetail.colProcessed = 'Y'
							! Свободные Документы 
							Call SalDisableWindow(pbViewDoc)
							Call SalDisableWindow(pbLinkDoc)
							Call SalDisableWindow(pbFindDoc)
							! Просмотр разрешен, можно отвязать, нельзя ввести новый
							Call SalEnableWindow(pbView)
							Call SalEnableWindow( pbUnlinkDoc )
							Call SalDisableWindow(pbNewDoc)
							If SalIsNull(StmtDetail.colSrcSwRef)
								Call SalDisableWindow(pbUnlinkSrcMsg)
								Call SalEnableWindow(pbSetSrcMsg)
							Else
								Call SalDisableWindow(pbSetSrcMsg)
								Call SalEnableWindow(pbUnlinkSrcMsg)
						Else
							Call SalDisableWindow(pbUnlinkDoc)
							If SalIsNull(StmtDetail.colSrcSwRef)
								Call SalDisableWindow(pbView)
								Call SalDisableWindow(pbUnlinkSrcMsg)
								Call SalEnableWindow(pbSetSrcMsg)
							Else
								Call SalEnableWindow(pbView)
								Call SalEnableWindow(pbUnlinkSrcMsg)
								Call SalDisableWindow(pbSetSrcMsg)
							Call SalEnableWindow(pbNewDoc)
							Call SalEnableWindow( pbLinkDoc ) 
							Call SalEnableWindow(pbViewDoc)
							Call SalEnableWindow(pbFindDoc)
							Call PopulateDocs(STRING_Null)
						! Если строка выписки не обработана 
						! If SalIsNull(StmtDetail.colDocRef) 
							                                                Call SalDisableWindow(pbUnlinkDoc)
							                                                If SalIsNull(StmtDetail.colSrcSwRef)
								                                                Call SalDisableWindow(pbView)
								                                                Call SalDisableWindow(pbUnlinkSrcMsg)
								                                                Call SalEnableWindow(pbSetSrcMsg)
							                                                Else 
								                                                Call SalEnableWindow(pbView)
								                                                Call SalEnableWindow(pbUnlinkSrcMsg)
								                                                Call SalDisableWindow(pbSetSrcMsg)
							                                                Call SalEnableWindow(pbNewDoc)
							                                                Call SalEnableWindow( pbLinkDoc ) 
							                                                Call SalEnableWindow(pbViewDoc)
							                                                Call PopulateDocs()
						! Else 
							! Свободные Документы 
							                                                Call SalDisableWindow(pbViewDoc)
							                                                Call SalDisableWindow(pbLinkDoc)
							! Просмотр разрешен, можно отвязать, нельзя ввести новый
							                                                Call SalEnableWindow(pbView)
							                                                Call SalEnableWindow( pbUnlinkDoc )
							                                                Call SalDisableWindow(pbNewDoc)
							                                                If SalIsNull(StmtDetail.colSrcSwRef)
								                                                Call SalDisableWindow(pbUnlinkSrcMsg)
								                                                Call SalEnableWindow(pbSetSrcMsg)
							                                                Else 
								                                                Call SalDisableWindow(pbSetSrcMsg)
								                                                Call SalEnableWindow(pbUnlinkSrcMsg)
					On SAM_DoubleClick
						If colProcessed != 'Y'
							Call SalSendMsg( pbNewDoc, SAM_Click, 0, 0 )
						Else
							Call SalSendMsg( pbView, SAM_Click, 0, 0 )
					On WM_RbuttonUp
						Call SalSendMsg( StmtDetail, WM_LbuttonDown, wParam, lParam )
						Call SalSendMsg( pbView, SAM_Click, 0, 0 )
					On SAM_FetchRowDone
						! Устананавливаем другой цвет строки
						If colProcessed = 'Y'
							Call XSalTblSetRowBackColor( StmtDetail, lParam, COLOR_LightGreen)
						Else If (colVDate < dtMinSVDate or colVDate > dtMaxSVDate)
							Call XSalTblSetRowBackColor( StmtDetail, lParam, COLOR_LightGray)
			Pushbutton: pbLinkDoc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.2"
					Top:    2.548"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DOC_OUT.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						! Сквитовать...
						Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBTipKWT')
					On SAM_Click
						Set strLnkRefList = ''
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(Docs, nRow, ROW_Selected, 0)
							Call SalTblFetchRow(Docs, nRow)
							If Docs.colTt='NOS'
								Call SqlPrepareAndExecute(hSql(), T(
										"SELECT flags[38,38] FROM tts WHERE tt='NOS' INTO :nFlg "))
								Call SqlFetchNext(hSql(), nFetchRes) 
								Set nGrp = 71
								Set strKeyId = GetIdOper()
								Set nUSERID2 = GetUserId()
								Set dBankdate = GetBankDate()
								Set nTmp=nFlg+1
								Set flOK = TRUE
								Set sErrTxt = STRING_Null
								If not SqlPLSQLCommand(hSql(),"gl.PAY(2, Docs.colRef, dBankdate,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null,NUMBER_Null,NUMBER_Null,STRING_Null)")
									Set sErrTxt = 'Не удалось доплатить реф№'||SalNumberToStrX(Docs.colRef, 0)
									Set flOK = FALSE
									Break
								If not SqlPrepareAndExecute(hSql(),
										"UPDATE oper SET nextvisagrp='!!', currvisagrp='47' WHERE ref=:Docs.colRef")
									Set sErrTxt = 'Не удалось проставить NextVisaGrp для реф№'||SalNumberToStrX(Docs.colRef, 0)
									Set flOK = FALSE
									Break
								If not SqlPLSQLCommand(hSql(),"bars_swift.genmsg_notify_listadd(Docs.colRef)")
									Set sErrTxt = 'Не удалось добавить в очередь реф№'||SalNumberToStrX(Docs.colRef, 0)
									Set flOK = FALSE
									Break
								If not SqlPrepareAndExecute(hSql(),"begin bars_swift.genmsg_notify_process; end;")
									Set sErrTxt = 'Не удалось запустить bars_swift.genmsg_notify_process'
									Set flOK = FALSE
									Break
								! If not SqlPrepareAndExecute(hSql(),"begin bars_swift.genmsg_notify_insep; end;")
									                    Set sErrTxt = 'Не удалось запустить bars_swift.genmsg_notify_insep'
									                    Set flOK = FALSE
									                    Break 
								If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! подпись 
									If NOT cDoc.SetDocR(Docs.colRef, TRUE)
										! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
										Set sErrTxt = 'Не удалось подписать операцию '||Docs.colTt||' референс '||Str(Docs.colRef)
										Set flOK = FALSE
										Break
									! Подписываем...
									Set strKeyId = GetIdOper( )
									If GetGlobalOptionEx('INTSIGN') = 2 		 !-- новая внутрення подпись
										If NOT cDoc.sDocInt(99,nGrp)
											Set sErrTxt = "Невозможно подписать документ (cDoc.sDocInt)"
											Set flOK = FALSE
											Break
										If NOT cDoc.PutVis(nGrp,nTmp)
											Set sErrTxt = "Невозможно подписать документ (cDoc.PutVis)"
											Set flOK = FALSE
											Break
									Else
										If NOT cDoc.sDocVisa()
											! 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!'
											Set sErrTxt = 'Виза группы ' || SalNumberToStrX(nGrp,0) || ': Не удалось подписать операцию!'
											Set flOK = FALSE
											Break
										Call SqlSetLongBindDatatype(6, BLOB_BYTE)
										If NOT SqlPrepareAndExecute(hSql(), 
												"INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
												 VALUES(:Docs.colRef, sysdate, :nUSERID2, :nGrp, :nTmp, :strKeyId, :cDoc.m_lsSign)")
											! 'Невозможно выполнить INSERT INTO oper_visa'
											Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
											Set flOK = FALSE
											Break
								Else
									If NOT SqlPrepareAndExecute(hSql(), 
											"INSERT INTO oper_visa(ref, dat, userid, groupid, status) 
											 VALUES(:Docs.colRef, sysdate, :nUSERID2, :nGrp, :nTmp)")
										Set sErrTxt = 'Невозможно вставить в OPER_VISA'
										Set flOK = FALSE
										Break
							Set strLnkRefList = strLnkRefList || ','  || SalNumberToStrX(Docs.colRef, 0)
						If flOK = FALSE
							Call MessageErrorEx(sErrTxt)
						Set strLnkRefList = SalStrMidX(strLnkRefList, 1, SalStrLength(strLnkRefList)-1)
						! Call Debug(strLnkRefList)
						If strLnkRefList ! = '' and GetGlobalOption('SW_NR20')!='1'
							! Call Debug('Calling link...')
							If SqlPrepareAndExecute(hSql(), "begin bars_swift.stmt_document_link(" || Str(StmtHdr.colStmtRef) || "," ||  Str(StmtDetail.colN) || ", bars_swift.t_listref(" || strLnkRefList || "), 0); end;")
								Call SqlCommitEx( hSql(), 'bars_swift.stmt_link_doc()')
							Else
								Call SqlRollbackEx( hSql(), 'bars_swift.stmt_link_doc()')
							Call PopulateDetail(1)
						!
						! If SalTblQueryRowFlags(Docs, SalTblQueryContext(Docs), ROW_Selected)
							! DG (21/02/2006):
							! Перенес логику в процедуру SWIFT.STMT_DOCUMENT_LINK()
							!
							! Call Debug('Before oracle call')
							! Если к строке выписки привязано сообщение, а к нему пытаются 
							! привязать документ с другим сообщением, то выдавать предупреждение
							! и сохранять результат в протокол
							! If (StmtDetail.colSrcSwRef != NUMBER_Null and Docs.colSwRef != NUMBER_Null)
								                                            If (StmtDetail.colSrcSwRef != Docs.colSwRef)
									                                            If (SalMessageBox(CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgDocLinked'), CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgDocLink'), MB_YesNo) = IDYES)
										! Запись в протокол
										                                            Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgUserConfirmDocLinkEx') )
									                                            Else 
										                                            Return TRUE
							! If SqlPLSQLCommand(hSql(), "bars_swift.stmt_document_link(StmtHdr.colStmtRef, StmtDetail.colN, Docs.colRef, 0)")
								                                            Call SqlCommitEx( hSql(), 'bars_swift.stmt_link_doc()')
							! Else 
								                                            Call SqlRollbackEx( hSql(), 'bars_swift.stmt_link_doc()')
							! Call Debug('After call')
							! Call PopulateDetail(1)
							! Call SalSendMsg( StmtHdr, SAM_DoubleClick, 0, 0 )
							! If not SalIsNull( T61.SWREF )
								                                                                                                                     Set nSWREF = T61.SWREF
							! Else 
								                                                                                                                     Set nSWREF = TBK.SWREF
							! 'Сквитован реф.'
							! If SqlPrepareAndExecute( hSql(), 
									  "INSERT into sw_oper (ref, swref) values ( :TA.colRef, :nSWREF )" ) 
									and SqlPrepareAndExecute( hSql(), 
									  "UPDATE sw_950d set OUR_REF= :TA.colRef, CHECKED_IND ='Y' 
									   where swref=:TBK.SWREF and n=:T61.N " ) 
									and SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_TBK.cTKwtRef')||Str(TA.colRef)  )
								                                                                                                                     Call HIDE_All_PB()
								                                                                                                                     Call SalSendMsg( TBK, SAM_DoubleClick, 0, 0 )
			Pushbutton: pbUnlinkDoc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.533"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Create
						! Сквитовать...
						Set strTip = 'RE-'|| CurrentLangTable.GetAtomTitle( 'frm_TBK.cBTipKWT')
					On SAM_Click
						If SalTblQueryRowFlags( StmtDetail, SalTblQueryContext(StmtDetail), ROW_Selected )
							! 'RE-Сквитован реф.'
							! DG (21/02/2006): Логику удаления перенес в пакет
							! If SqlPrepareAndExecute( hSql(), 
									  "DELETE from sw_oper where ref=:T61.REF " ) and SqlPrepareAndExecute( hSql(), 
									  "UPDATE sw_950d set OUR_REF= null, CHECKED_IND ='N' 
									   where swref=:TBK.SWREF and n=:T61.N " ) 
									and SqlCommitEx( hSql(), 'RE-'||CurrentLangTable.GetAtomTitle('frm_TBK.cTKwtRef')||Str(TA.colRef)  )
								                                                                                                                     Call SalSendMsg( TBK, SAM_DoubleClick, 0, 0 )
							If SqlPLSQLCommand(hSql(), "bars_swift.stmt_document_unlink(StmtHdr.colStmtRef, StmtDetail.colN)")
								Call SqlCommitEx( hSql(), 'bars_swift.stmt_unlink_doc()')
							Else
								Call SqlRollbackEx( hSql(), 'bars_swift.stmt_unlink_doc()')
							Call SalSendMsg( StmtHdr, SAM_DoubleClick, 0, 0 )
			Pushbutton: pbViewDoc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.7"
					Top:    2.548"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Create
						! Посмотреть похожий Документ в АБС
						Set strTip=CurrentLangTable.GetAtomTitle('frm_TBK.cBTipKWT1')
					On SAM_Click
						If SalTblQueryRowFlags( Docs, SalTblQueryContext(Docs), ROW_Selected )
							If Not SalIsNull(Docs.colRef)
								Call DocViewContentsEx(hWndForm, Docs.colRef)
			Child Table: Docs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   5.15"
						Top:    2.917"
						Width:  4.467"
						Width Editable? Yes
						Height: 1.905"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? Yes
				Contents
					Column: colFDat
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата 
								движения
								АБС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф
								АБС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDetail
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Подробности
								документа,
								проведенного в АБС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSos
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: SOS
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код ОП
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( Docs, UM_QueryLabelText, 0, 0 )
						!
					On SAM_FetchRowDone
						Set nTARecno = nTARecno + 1
						If colTt = 'NOS'
							Call XSalTblSetRowBackColor( Docs, lParam, COLOR_LightGreen)
					On SAM_DoubleClick
						Call SalSendMsg( pbLinkDoc, SAM_Click, 0, 0 )
					On SAM_ContextMenu
						Call SalSendMsg( pbViewDoc, SAM_Click, 0, 0 )
			Pushbutton: pbSetSrcMsg
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRelation
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.283"
					Top:    2.488"
					Width:  0.4"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Привязать сообщение
						Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBTipSetSrcMsg')
					On SAM_Click
						Call LinkSrcMsg()
			Pushbutton: pbUnlinkSrcMsg
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.683"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Отвязать сообщение
						Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBTipUnlinkSrcMsg')
					On SAM_Click
						Call UnlinkSrcMsg()
			Pushbutton: pbFindDoc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.2"
					Top:    2.548"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\details.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Список подібних документів
						Set strTip = CurrentLangTable.GetAtomTitle('frm_TBK.cBTipFindDocs')
					On SAM_Click
						Set dtDocMin = StmtDetail.colVDate - nVDocMin
						Set dtDocMax = StmtDetail.colVDate + nVDocMax
						Set nTrnAmnt = IifN( StmtDetail.colCreditSum = NUMBER_Null, StmtDetail.colDebitSum, StmtDetail.colCreditSum) * 100
						If SalModalDialog(dlg_PickUpDocStmt, hWndForm, StmtHdr.colNosAccCode, IifN(StmtDetail.colDebitSum = NUMBER_Null, 0, 1) , dtDocMin, dtDocMax, nTrnAmnt, strRefList)
							Call PopulateDocs(strRefList)
			Custom Control: cSplMBRTL2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   11.283"
						Top:    1.917"
						Width:  0.383"
						Width Editable? Class Default
						Height: 0.369"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSplMBRTL3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   11.283"
						Top:    1.917"
						Width:  0.383"
						Width Editable? Class Default
						Height: 0.369"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
			Function: PopulateDetail
				Description:
				Returns
				Parameters
					Number: nMode
				Static Variables
				Local variables
					Number: nRow     ! Номер строки
					Boolean: bFlag
				Actions
					Call SalWaitCursor( TRUE )
					If nMode = 1
						! Выполняем допривязку появившихся сообщений
						If SqlPLSQLCommand(hSql(), "bars_swift.stmt_srcmsg_autolink(StmtHdr.colStmtRef)")
							Call SqlCommitEx(hSql(), "Допривязка сообщений к выписке")
						Else
							Call SqlRollbackEx(hSql(), "Ошибка допривязки сообщений к выписке")
					If GetGlobalOption('SW_NR20')!='1'
						Call SalTblPopulate(StmtDetail, hSqlAux(),
								"select numrow, vdate, debit_sum, credit_sum, 
								            processed, swtt, src_swref, their_ref, 
								            detail, mt
								     into :StmtDetail.colN, :StmtDetail.colVDate, :StmtDetail.colDebitSum, :StmtDetail.colCreditSum,
								            :StmtDetail.colProcessed, :StmtDetail.colSwTT, :StmtDetail.colSrcSwRef, :StmtDetail.colTheirRef,
								            :StmtDetail.colDetail, :StmtDetail.colMt
								    from v_sw950_detail
								 where  sw950ref = :StmtHdr.colStmtRef 
								 order by numrow", TBL_FillAll)
					Else
						Call SalTblPopulate(StmtDetail, hSqlAux(),
								"select d.numrow, d.vdate, d.debit_sum, d.credit_sum, 
								            d.processed, d.swtt, d.src_swref, d.their_ref, 
								            d.detail, d.mt
								     into :StmtDetail.colN, :StmtDetail.colVDate, :StmtDetail.colDebitSum, :StmtDetail.colCreditSum,
								            :StmtDetail.colProcessed, :StmtDetail.colSwTT, :StmtDetail.colSrcSwRef, :StmtDetail.colTheirRef,
								            :StmtDetail.colDetail, :StmtDetail.colMt
								    from v_sw950_detail d
								 where  sw950ref = :StmtHdr.colStmtRef 
								 and  NOT exists (select 1 from sw_journal s, sw_oper sw, oper o
								                    where s.swref=sw.swref
								                    and sw.ref=o.ref
								                    and o.sos=5
								                    and s.trn = case when d.stmt_dk in('D', 'RC') then d.their_ref when d.stmt_dk in('C', 'RD') then d.their2_ref end ) 
								 order by numrow", TBL_FillAll)
					Call VisTblAutoSizeColumn( StmtDetail, hWndNULL )
					! Выполняем проверку: ко всем ли строкам привязаны документы.
					! Если документы привязаны ко всем строкам, то предлагаем установить признак "Обработана"
					Set bFlag = TRUE
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(StmtDetail, nRow, 0, 0)
						Call SalTblSetContext(StmtDetail, nRow)
						If StmtDetail.colProcessed = 'N'
							Set bFlag = FALSE
							Break
					!
					If bFlag
						If (SalMessageBox(CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgChgStmtState'), CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgStmt'), MB_YesNo) = IDYES)
							Call ChangeStatementState(StmtHdr.colStmtRef, 1)
					!
					Call SalTblSetFocusRow( StmtDetail, 0 )
					Call SalTblSetContext(StmtDetail, 0)
					Call SalSendMsg( StmtDetail, SAM_RowSetContext, 0, 0 )
					Call SalWaitCursor(FALSE)
			Function: PopulateDocs
				Description:
				Returns
				Parameters
					String: strRefs
				Static Variables
				Local variables
					Number: dk           ! Признак Дебет/Кредит
					Number: s             ! Сумма проводки по корсчету
					String: their_ref
					String: sSqlTA
					! Number: nStmtMin
					! Number: nStmtMax
					Date/Time: dtDocMin
					Date/Time: dtDocMax
					Number: cnt
				Actions
					If StmtHdr.colNosAccCode
						Call SalWaitCursor( TRUE )
						! Вычисление признака и суммы
						Set dk= IifN( StmtDetail.colDebitSum = NUMBER_Null, 0, 1)
						Set s = IifN( StmtDetail.colCreditSum = NUMBER_Null, StmtDetail.colDebitSum, StmtDetail.colCreditSum) * 100
						! Параметры получили при старте функции
						! Set nStmtMin = Val(GetGlobalOption('SWTSTMMN'))
						! Set nStmtMax = Val(GetGlobalOption('SWTSTMMX'))
						Set dtDocMin = StmtDetail.colVDate - nVDocMin
						Set dtDocMax = StmtDetail.colVDate + nVDocMax
						! Call Debug('acc=' || SalNumberToStrX(StmtHdr.colNosAccCode, 10) || ' dk=' || SalNumberToStrX(dk, 10) || ' date=' || SalFmtFormatDateTime(dtDocMin, 'dd/mm/yyyy') || 'date2=' || SalFmtFormatDateTime(dtDocMax, 'dd/mm/yyyy'))
						If strRefs = STRING_Null
							If GetGlobalOptionEx('SW_NR20')=1
								Call SqlPrepareAndExecute(hSql(),"SELECT count(*) INTO :cnt  from v_sw950_doc
										   where fdat   between :dtDocMin and :dtDocMax
										      and  acc   = :StmtHdr.colNosAccCode
										      and  th_ref = :StmtDetail.colTheirRef
										 order by ref")
								Call SqlFetchNext( hSql(), nFetchRes )
								If cnt>0
									Set sSqlTA =
											"select  ref, fdat, detail, sos, tt
											    into :Docs.colRef, :Docs.colFDat, :Docs.colDetail, :Docs.colSos, :Docs.colTt
											    from v_sw950_doc
											   where fdat   between :dtDocMin and :dtDocMax
											      and  acc   = :StmtHdr.colNosAccCode
											      and  th_ref = :StmtDetail.colTheirRef
											 order by ref"
								Else
									Set sSqlTA = "select  ref, fdat, detail, sos, tt
											      into :Docs.colRef, :Docs.colFDat, :Docs.colDetail, :Docs.colSos, :Docs.colTt
											    from v_sw950_doc
											   where fdat   between :dtDocMin and :dtDocMax
											      and  acc   = :StmtHdr.colNosAccCode
											      and  dk    = :dk
											      and  s     = :s
											 order by ref"
							Else
								Set sSqlTA =
										"select  ref, fdat, detail, sos, tt
										    into :Docs.colRef, :Docs.colFDat, :Docs.colDetail, :Docs.colSos, :Docs.colTt
										    from v_sw950_doc
										   where fdat   between :dtDocMin and :dtDocMax
										      and  acc   = :StmtHdr.colNosAccCode
										      and  dk     = :dk
										      and  s        = :s
										 order by ref"
						Else
							Set sSqlTA =
									"select  ref, fdat, detail, sos, tt
									    into :Docs.colRef, :Docs.colFDat, :Docs.colDetail, :Docs.colSos, :Docs.colTt
									    from v_sw950_doc
									   where fdat   between :dtDocMin and :dtDocMax
									      and  acc   = :StmtHdr.colNosAccCode
									      and  dk     = :dk
									      and  ref in (" || strRefs || ")
									 order by ref"
						Call SalTblPopulate(Docs, hSql(), sSqlTA , TBL_FillAll)
						Call VisTblAutoSizeColumn( Docs, hWndNULL )
						If nTARecno >0
							Call SalEnableWindow( pbLinkDoc)
							Call SalEnableWindow( pbViewDoc)
						Call SalTblSetContext(Docs, 0)
						Call SalWaitCursor(FALSE)
			Function: DisableButtons
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( pbLinkDoc )
					Call SalDisableWindow( pbUnlinkDoc )
					Call SalDisableWindow( pbViewDoc)
					Call SalDisableWindow( pbFindDoc )
					Call SalDisableWindow( pbAbs )
					Call SalDisableWindow( pbNewDoc )
					Call SalDisableWindow( pbView )
			Function: ChangeStatementState
				Description: Изменение состояния выписки
				Returns
					Boolean:
				Parameters
					Number: nStmtRef
					Number: nStmtState
				Static Variables
				Local variables
					String: strErrorText
					Number: nErrorNum
					Number: nPos
					Sql Handle: hSqlError
				Actions
					When SqlError
						! Получаем код ошибки
						Call SqlExtractArgs(wParam, lParam, hSqlError, nErrorNum, nPos)
						! Получаем текст ошибки
						Call SqlGetErrorText(nErrorNum, strErrorText)
						! Сверяем ошибку с ошибкой перевода состояния из-за необработанных строк
						If SalStrLeftX(strErrorText, 15) = 'ORA-20781: \\310'
							! Спрашиваем о принудительной квитовке
							If (SalMessageBox(CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgChgStmtStateEx'), CurrentLangTable.GetAtomTitle('frm_TBK.cTMsgStmt'), MB_YesNo) = IDNO)
								If SqlPLSQLCommand(hSql(), "bars_swift.stmt_set_state2(nStmtRef, nStmtState, 1)")
									Call SqlCommitEx(hSql(), "Изменено состояние выписки")
								Else
									Call SqlRollbackEx(hSql(), "Ошибка при изменении состояния выписки")
							Return TRUE
					If SqlPLSQLCommand(hSql(), "bars_swift.stmt_set_state(nStmtRef, nStmtState)")
						Call SqlCommitEx(hSql(), "Изменено состояние выписки")
					Else
						Call SqlRollbackEx(hSql(), "Ошибка при изменении состояния выписки")
					Return TRUE
			Function: GetAccB
				Description: Функция получает номер счета Б из сообщения
				Returns
					String: strAccNum
				Parameters
					Number: nSwRef
				Static Variables
				Local variables
					String: strAccNum
				Actions
					Set strAccNum = STRING_Null
					If SqlPrepareAndExecute(hSql(),"SELECT nls INTO :strAccNum FROM accounts WHERE acc= bars_swift.impmsg_message_getaccb(:nSwRef)")
						Call SqlFetchNext(hSql(),nFetchRes)
			Function: UnlinkSrcMsg
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					If SalTblQueryRowFlags( StmtDetail, SalTblQueryContext(StmtDetail), ROW_Selected )
						If SqlPLSQLCommand(hSql(), "bars_swift.stmt_srcmsg_unlink(StmtHdr.colStmtRef, StmtDetail.colN)")
							Call SqlCommitEx( hSql(), 'bars_swift.stmt_unlink_doc()')
						Else
							Call SqlRollbackEx( hSql(), 'bars_swift.stmt_unlink_doc()')
						Call PopulateDetail(0)
					Call SalWaitCursor( FALSE)
			Function: LinkSrcMsg
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nSwRef
				Actions
					If SalTblQueryRowFlags( StmtDetail, SalTblQueryContext(StmtDetail), ROW_Selected )
						! Вызов справочника поиска
						Set nSwRef = SalModalDialog( dlgSelMsg, hWndForm, 'V_SW_IMPMSG', '' )
						If nSwRef > 0
							Call SalWaitCursor( TRUE )
							If SqlPLSQLCommand(hSql(), "bars_swift.stmt_srcmsg_link(StmtHdr.colStmtRef, StmtDetail.colN, nSwRef, 1)")
								Call SqlCommitEx( hSql(), 'bars_swift.stmt_unlink_doc()')
							Else
								Call SqlRollbackEx( hSql(), 'bars_swift.stmt_unlink_doc()')
						Call PopulateDetail(0)
					Call SalWaitCursor( FALSE)
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02 !! 'F' - есть функция определения получателя
		Window Variables
			! Number: kolTA
			Number: nSWREF
			Number: nKWT
			Date/Time: bDAT
			Number: FF
			String: sTmp
			String: sSql
			String: dTmp
			!
			Number: nUserId
			String: strSecure
			String: strTTArr[*,2]
			Number: nTTArr
			String: strTT
			String: strTTName
			String: sCurTT
			String: sNlsA
			String: sNlsB
			!
			String: sNOSTROAcc
			String: sNOSTROSemantic
			!
			Number: nTARecno    ! Кол-во записей подобных документов
			!
			String: strMsgSender
			String: strMsgReceiver
			!
			Number: nRelMsgRef
			Number: nRelMsgMt
			String: sUseF    ! Флаг "использовать внешнюю ф-ю для поиска получателя"
			Number: nTmpDocRef
			String: strRefList
			!
			Date/Time: dtMinSVDate
			Date/Time: dtMaxSVDate
			Number: nMinSVDate
			Number: nMaxSVDate
			!
			Number: nVDocMin
			Number: nVDocMax
			Date/Time: dtDocMin
			Date/Time: dtDocMax
			!
			Number: nRow
			String: strLnkRefList
			Number: nTrnAmnt
			Number: nStmtType
			Number: nTmp
			Number: nUSERID2
			Number: nGrp
			String: strKeyId
			Number: nFlg
			String: sErrTxt
			: cDoc
				Class: cDoc
			Boolean: flOK
			Date/Time: dBankdate
			Number: nNOS_R
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				! Call SalSetWindowText(hWndForm, 'Nostro Reconciliation (MT950 Processing)')
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_TBK.cTWndTitle'))
				Call ShowApdVersion('15')
				Call PrepareWindow(hWndForm)
				!
				Set frm_TBK.nTabInstance = 1
				Set frm_TBK.fFilterAtStart = TRUE
				Set frm_TBK.strPrintFileName = 'MT950'
				Set frm_TBK.strFilterTblName = "V_SW950_HEADER"
				Call SalWaitCursor( TRUE )
				Call SalTblSetLockedColumns( hWndForm, 13 ) 
				Set bDAT = GetBankDate()
				Set nUserId = GetUserId()
				Set sUseF=IifS(SalStrScan(strPar02,'F')>=0,'F','')
				If EnhancedSecurity(  )
					Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
				!
				Set frm_TBK.nFlags = GT_ReadOnly
				Set frm_TBK.nTabInstance = 1
				! главное горизонтальное окно
				Call cSplMain.setBarSize(5)
				Call cSplMain.setTopFrame(StmtHdr)
				Call cSplMain.setBottomFrame(cSplMB)
				Call cSplMain.setBarPosition(550)
				! нижнее вертикальное окно
				Call cSplMB.setBarSize(5)
				Call cSplMB.setLeftFrame(cSplMBL)
				Call cSplMB.setRightFrame(cSplMBR)
				Call cSplMB.setBarPosition(620)
				! нижнее правое гориз.
				Call SalSetWindowText( cSplMBR, 'Похожие документы в АБС')
				Call SalSetWindowText(cSplMBR, CurrentLangTable.GetAtomTitle('frm_TBK.cTMBRTitle')||';')
				Call cSplMBR.setTopFrame(cSplMBRT)
				Call cSplMBR.setBottomFrame(Docs)
				Call cSplMBR.setBarPosition(180)
				Call cSplMBR.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				! кнопки справа
				Call cSplMBRT.setRightFrame(cSplMBRTL)
				Call cSplMBRT.setLeftFrame(pbLinkDoc)
				Call cSplMBRT.setBarPosition(75)
				Call cSplMBRT.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBRTL.setRightFrame(cSplMBRTL2)
				Call cSplMBRTL.setLeftFrame(pbViewDoc)
				Call cSplMBRTL.setBarPosition(80)
				Call cSplMBRTL.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBRTL2.setLeftFrame(pbFindDoc)
				Call cSplMBRTL2.setBarPosition(85)
				Call cSplMBRTL2.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				! нижнее левое гориз.
				Call SalSetWindowText( cSplMBL, 'Детальные строки выписки')
				Call SalSetWindowText(cSplMBL, CurrentLangTable.GetAtomTitle('frm_TBK.cTMBLTitle')||';')
				Call cSplMBL.setTopFrame(cSplMBLT)
				Call cSplMBL.setBottomFrame(StmtDetail)
				Call cSplMBL.setBarPosition(180)
				Call cSplMBL.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				! кнопки слева
				Call cSplMBLT.setLeftFrame(pbView)
				Call cSplMBLT.setRightFrame(cSplMBLTL)
				Call cSplMBLT.setBarPosition(42)
				Call cSplMBLT.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBLTL.setLeftFrame(pbNewDoc)
				Call cSplMBLTL.setRightFrame(cSplMBLTLR)
				Call cSplMBLTL.setBarPosition(43)
				Call cSplMBLTL.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBLTLR.setLeftFrame(pbAbs)
				Call cSplMBLTLR.setRightFrame(cSplMBLTLR1)
				Call cSplMBLTLR.setBarPosition(45)
				Call cSplMBLTLR.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBLTLR1.setLeftFrame(pbUnlinkDoc)
				Call cSplMBLTLR1.setRightFrame(cSplMBLTLR2)
				Call cSplMBLTLR1.setBarPosition(47)
				Call cSplMBLTLR1.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBLTLR2.setLeftFrame(pbSetSrcMsg)
				Call cSplMBLTLR2.setRightFrame(cSplMBLTLR3)
				Call cSplMBLTLR2.setBarPosition(55)
				Call cSplMBLTLR2.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call cSplMBLTLR3.setLeftFrame(pbUnlinkSrcMsg)
				Call cSplMBLTLR3.setBarPosition(58)
				Call cSplMBLTLR3.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
				! Получаем параметры интервала дат для строк выписки
				Set nMinSVDate = Val(GetGlobalOption('SWTSVMNI'))
				Set nMaxSVDate = Val(GetGlobalOption('SWTSVMAX'))
				Set dtMinSVDate = GetBankDate()-nMinSVDate
				Set dtMaxSVDate = GetBankDate() + nMaxSVDate
				! Получаем параметры интервала строк для документов
				Set nVDocMin = Val(GetGlobalOption('SWTDVMNI'))
				Set nVDocMax = Val(GetGlobalOption('SWTDVMAX'))
				Call SalWaitCursor(FALSE)
	Table Window: SWJ			! 16
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Журнал принятых(O) и отправленных (I) SWIFT- сообщений
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    0.688"
				Width:  12.667"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? Class Default
		Description: Журнал всех принятых и отправленных сообщений.
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12494
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.85"
						Begin Y:  0.0"
						End X:  5.85"
						End Y:  0.464"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.967"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.4"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip=CurrentLangTable.GetAtomTitle('SWJ.cBTipDetails')
						On SAM_Click
							Call SalCreateWindow(SWJ1, hWndMDI, SWJ.SWREF, SWJ.TRN )
				Pushbutton: pbAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.833"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Switch.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip=CurrentLangTable.GetAtomTitle('SWJ.cBTipAll')
						On SAM_Click
							Call SalCreateWindow(SWJ1, hWndMDI, 0, SWJ.TRN )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.15"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12495
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.183"
						Begin Y:  0.0"
						End X:  5.183"
						End Y:  0.464"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.75"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12496
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbAbs
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.267"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip=CurrentLangTable.GetAtomTitle('SWJ.cBTipAbs')
						On SAM_Click
							If Not SalIsNull( SWJ.REF ) and  SWJ.MT != 950
								Call DocViewContentsEx(hWndForm, SWJ.REF)
				Pushbutton: pbGenInfDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.7"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip=CurrentLangTable.GetAtomTitle('SWJ.cBTipGenInfDoc')
						On SAM_Click
							Set bOk = SqlPLSQLCommand(hSql(), "bars_swift.stmt_gen_infdoc2(SWJ.SWREF, nInfDocs)")
							If bOk
								Call SqlCommitEx(hSql(), 'Создан Информационный документ')
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('SWJ.cTMsgGenInfDoc') || NumberToStr(nInfDocs), CurrentLangTable.GetAtomTitle('SWJ.cTMsgGenInfDocTitle'), MB_Ok)
							Else
								Call SqlRollbackEx(hSql(), 'Ошибка создания инф. документа')
								Call MessageErrorEx(CurrentLangTable.GetAtomTitle('SWJ.cTErrGenInfDoc'))
		Contents
			Column: SWREF 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: SWREF
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MT  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: MT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TRN 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф сообщ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IO_IND   
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CURRENCY  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SENDER 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: BIC отправ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RECEIVER 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: BIC получ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! 7
			Column: PAYER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Плательщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PAYEE 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Получатель
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AMOUNT  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCD 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: АССД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCK 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: АССК
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счет Д
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счет К
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATE_IN 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата вх
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATE_OUT 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата исх
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! 14
			Column: DATE_PAY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата опл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATE_REC  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата REC
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VDATE 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата VDAT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ID
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MTREF  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: MTREF
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PAGE 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: PAGE
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TRANSIT  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: TRANSIT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! 21
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Состояние сообщения
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: pFILTR
			String: strPar02
		Window Variables
			String: sFilter1
			Number: nInfDocs
			Boolean: bOk
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('SWJ.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Set sFilter1 = SalStrTrimX( SalStrUpperX( pFILTR ) )
				If sFilter1 != ""
					If Subs(sFilter1,1,3) != 'AND'
						Set sFilter1 = 'AND ' || sFilter1
				Set SWJ.nTabInstance = 1
				Set SWJ.fFilterAtStart = 1
				Set SWJ.strFilterTblName = 'SW_JOURNAL'
				Set SWJ.strPrintFileName = 'SW_JOUR'
				Set SWJ.strSqlPopulate =
						"SELECT SW_JOURNAL.SWREF,   SW_JOURNAL.MT,      SW_JOURNAL.TRN ,
						        SW_JOURNAL.IO_IND,  SW_JOURNAL.CURRENCY,SW_JOURNAL.SENDER,SW_JOURNAL.RECEIVER,
						        SW_JOURNAL.PAYER,   SW_JOURNAL.PAYEE,   SW_JOURNAL.AMOUNT/100,SW_JOURNAL.ACCD,SW_JOURNAL.ACCK,
						        SW_JOURNAL.DATE_IN, SW_JOURNAL.DATE_OUT,d.nls,      k.nls,  
						        SW_JOURNAL.DATE_PAY,SW_JOURNAL.DATE_REC,SW_JOURNAL.VDATE, SW_JOURNAL.ID, 
						        SW_JOURNAL.PAGE,    SW_JOURNAL.TRANSIT, SW_JOURNAL.SOS 
						   INTO :SWJ.SWREF,   :SWJ.MT,      :SWJ.TRN,  
						        :SWJ.IO_IND,  :SWJ.CURRENCY,:SWJ.SENDER, :SWJ.RECEIVER,
						        :SWJ.PAYER,   :SWJ.PAYEE,   :SWJ.AMOUNT, :SWJ.ACCD,  :SWJ.ACCK, 
						        :SWJ.DATE_IN, :SWJ.DATE_OUT,:SWJ.NLSD,   :SWJ.NLSK,  
						        :SWJ.DATE_PAY,:SWJ.DATE_REC,:SWJ.VDATE,  :SWJ.ID, 
						        :SWJ.PAGE,    :SWJ.TRANSIT, :SWJ.SOS
						   FROM SW_JOURNAL, accounts d, accounts k
						  WHERE SW_JOURNAL.accd=d.acc (+) and SW_JOURNAL.acck=k.acc (+) " || sFilter1 ||" 
						  ORDER BY SW_JOURNAL.DATE_IN"
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
			On SAM_FetchRowDone
				If SWJ.MT != 950
					If SqlPrepareAndExecute(hSqlAux2(), "SELECT ref INTO :SWJ.REF FROM sw_oper WHERE swref=:SWJ.SWREF")
							and SqlFetchNext(hSqlAux2(), nFetchRes)
					If not SalIsNull(SWJ.REF)
						! слабо зеленый 
						Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230,255,230))
				Else
					If SqlPrepareAndExecute(hSqlAux2(), "SELECT swref FROM sw_950 WHERE swref=:SWJ.SWREF and done=1")
							and SqlFetchNext( hSqlAux2(), nFetchRes )
						! слабо-желтый
						Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255,255,180))
				! Если документ удален, пометим его красным
				If SWJ.SOS = -2
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 0, 0))
	Table Window: SWJ1			! 17
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Журнал принятых(O) и отправленных (I) SWIFT- сообщений
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    0.688"
				Width:  11.217"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Просмотр деталей МТ-сообщения
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.367"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12491
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12492
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.75"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12493
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colN   
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSeq 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Sequence
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colTag
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Поле
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOpt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Опция
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colValue
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Значение
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  7.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nSwRef
			String: strSwTrn
		Window Variables
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('SWJ1.cTWTitle') || " = " || Str(SWJ1.nSwRef))
				Call PrepareWindow(hWndForm)
				!
				Set SWJ1.strPrintFileName = 'SW_'||Str(SWJ1.nSwRef)
				If SWJ1.nSwRef > 0
					Set SWJ1.strSqlPopulate =
							"select n, seq, tag, opt, value
							    into :SWJ1.colN, :SWJ1.colSeq, :SWJ1.colTag, :SWJ1.colOpt, :SWJ1.colValue 
							 from sw_operw 
							where swref = :SWJ1.nSwRef order by n"
				Else
					Set SWJ1.strSqlPopulate =
							"select w.n, w.seq, w.tag, w.opt, w.value
							    into :SWJ1.colN, :SWJ1.colSeq, :SWJ1.colTag, :SWJ1.colOpt, :SWJ1.colValue 
							 from sw_operw w, sw_journal j 
							where w.swref = j.swref 
							    and j.trn = :SWJ1.strSwTrn 
							order by j.page, w.n"
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Call SalWaitCursor( FALSE )
	Dialog Box: dlg_SelMT			! 18
		Class:
		Property Template:
		Class DLL Name:
		Title: Выбор типа сообщения...
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.167"
				Width Editable? Yes
				Height: 3.56"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  5.9"
						Width Editable? Yes
						Height: 2.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: MT
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Set strSQL = T("select mt, name into :colMT, :colName from sw_mt order by 1")
						Call SalTblPopulate(tblMT, hSql(), strSQL, TBL_FillAll)
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: В&ыбрать
				Window Location and Size
					Left:   0.867"
					Top:    2.619"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set strMT = tblMT.colMT
						Set strName = tblMT.colName
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: О&тменить
				Window Location and Size
					Left:   3.683"
					Top:    2.619"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set strMT = STRING_Null
						Set strName = STRING_Null
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive String: strMT
			Receive String: strName
		Window Variables
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
			On SAM_CreateComplete
				Call SalWaitCursor(FALSE)
			On SAM_Close
				Call SalEndDialog(hWndForm, 0)
	Form Window: frmMT2			! 19
		Class:
		Property Template:
		Class DLL Name:
		Title: Ввод сообщения
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.267"
				Width Editable? Yes
				Height: 5.94"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Форма ручного ввода МТ-сообщения
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Standard
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Black
			Contents
				Pushbutton: pbTest1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbChangeMT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Сменить тип сообщения'
						On SAM_Click
							Call ClearVariables()                 !Очищаем внутренние переменные 
							Call SelectMT()                        !Меняем тип сообщения
							Call tblFields.FillFieldNames()   !Загружаем список полей
		Contents
			Pushbutton: pbSaveMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Сохранить'
			Pushbutton: pbNewMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.883"
					Top:    0.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Ввод нового сообщения'
			Pushbutton: pbPrint
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbPrint
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.483"
					Top:    1.071"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Печать'
			Pushbutton: pbClose
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.083"
					Top:    1.071"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Выйти'
					On SAM_Click
						Call SalSendMsg(hWndForm, SAM_Close, 0, 0)
			Pushbutton: pbFieldList
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.283"
					Top:    1.071"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Child Table: tblFields
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    1.405"
						Width:  9.7"
						Width Editable? Yes
						Height: 3.833"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colSeq
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colTag
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOpt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colStatus
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование поля
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colValue
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Click
								Call ShowButtons(SalStrToNumber(colLstFlag))
					Column: colSubSeq
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colRBlkNum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colLstFlag
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: FillFieldNames
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: strSql
						Actions
							Set strSql = T("select seq, subseq, rblknum, lstflag, tag, opt, status, decode(tag, '-1', null, rpad(tag || opt, 3, ' ') || '  ') || name into :colSeq, :colSubSeq, :colRBlkNum, :colLstFlag, :colTag, :colOpt, :colStatus, :colName from tmp_dg_swv where mt = 
									:strMTCode")
							Call SalTblPopulate(tblFields, hSql(), strSql, TBL_FillAll)
					Function: FormatRow
						Description:
						Returns
							Boolean: bRet
						Parameters
							Window Handle: hWndForm
							Number: nRowNum
						Static Variables
						Local variables
						Actions
							! Call Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Red)
							! If tblFields(nRowNum).tag = -1
								                                                                                                                                                                              Call SalMessageBox(tblFields(nRowNum).name, "debug", MB_OK)
					Function: ShowButtons
						Description: Функция вызывается при перемещении по строкам таблицы и разрешает/запрешает кнопки
						Returns
						Parameters
							Number: p_nListFlag  ! Флаг наличие справочника на данное поле
						Static Variables
						Local variables
						Actions
							If p_nListFlag = 1
								Call UnHideButton(pbFieldList)
							Else
								Call HideButton(pbFieldList)
				Window Variables
					String: l_strFontName
					Number: l_nFontSize
					Number: l_nEnhancment
				Message Actions
					On SAM_Create
						Call FillFieldNames()
						! Блокируем кнопки
						Call HideButton(pbFieldList)
					On SAM_FetchRowDone
						Call FormatRow(hWndForm, lParam)
						If colTag = '-1'
							Call SalFontGet(hWndForm, l_strFontName, l_nFontSize, l_nEnhancment)
							Call XSalTblSetRowFontName(hWndForm, lParam, l_strFontName, l_nFontSize+1, FONT_EnhBold)
							Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
		Functions
			Function: GetMT
				Description: Получает код и наименование MT-сообщения
				Returns
					String: strMTCode
				Parameters
					Receive String: strMTName
				Static Variables
				Local variables
					Number: nDlgResult
					String: strMT
					String: strName
				Actions
					Set nDlgResult = SalModalDialog(dlg_SelMT, hWndForm, strMT, strName)
					If nDlgResult != 1
						Return STRING_Null
					Else
						Set strMTName = strName
						Return strMT
			Function: HideButton
				Description:
				Returns
				Parameters
					Window Handle: hWnd
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow(hWnd)
			Function: UnHideButton
				Description:
				Returns
				Parameters
					Window Handle: hWnd
				Static Variables
				Local variables
				Actions
					Call SalEnableWindow(hWnd)
			Function: SelectMT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set strMTCode = GetMT(strMTName)
					Call SalSetWindowText(hWndForm, 'Ввод сообщения [' || strMTCode || '  ' || strMTName || ']')
			Function: ClearVariables
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
		Window Parameters
			Number: nPar01    !! Реф. сообщения (редактирование)
			String: strPar02
			String: strPar03
		Window Variables
			String: strMTCode     ! Код вводимого MT-сообщения
			String: strMTName    ! Наименование вводимого MT-сообщения
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SelectMT()  ! Выбираем тип сообщения для ввода
				! Блокируем кнопки
				Call HideButton(pbFieldList)
				Call HideButton(pbNewMT)
				Call HideButton(pbPrint)
			On SAM_Close
				Call SalDestroyWindow(hWndForm)
	Dialog Box: dlgSelMsg		! 20
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Выбор сообщения...
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.5"
				Width Editable? Class Default
				Height: 5.274"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Выбор сообщения из очереди
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlgSelMsg.cBTipRefresh')
					! On SAM_Create
						                                                                                                                                                          Set strTip = CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cBTipViewDoc')
					! On SAM_Create
						                                                                                                                                                          Set strTip = CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cBTipViewDoc')
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25978
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlgSelMsg.cBTipSearch')
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlgSelMsg.cBTipFilter')
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25979
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  3.95"
						Begin Y:  Class Default
						End X:  3.95"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlgSelMsg.cBTipOk')
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.517"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlgSelMsg.cBTipExit')
				Line
					Resource Id: 25980
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  5.067"
						Begin Y:  0.333"
						End X:  5.067"
						End Y:  -0.083"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbViewDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.367"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlgSelMsg.cBTipViewDoc')
						On SAM_Click
							Call SalCreateWindow(frm_SWIFTDoc, hWndForm, tbl.colSwRef)
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  10.417"
						Width Editable? Class Default
						Height: 4.357"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф.
								сообщ.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 3
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип
								сообщ.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwIO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Напр.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 15
						Data Type: String
						Justify: Left
						Width:  0.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSwSender
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отправитель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  2.233"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwReceiver
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Получатель
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 11
						Data Type: String
						Justify: Left
						Width:  2.3"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwValueDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								валют.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSwDateIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								поступл.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 35
						Data Type: Date/Time
						Justify: Left
						Width:  1.433"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						Call SalSendClassMessage( UM_Create, 0, 0 )
					On UM_Populate
						If dlgSelMsg.strSqlPopulate != ''
							Call SalWaitCursor( TRUE )
							Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
							Set strDSql = cQ.GetFullSQLString( cF )
							Call SalTblPopulate( hWndForm, cMain.hSql(), T(strDSql), TBL_FillNormal )
							Call SalTblSetContext( hWndForm, 0 )
							Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor( FALSE )
		Functions
			Function: ReturnValue
				Description:
				Returns
					Number: nRes
				Parameters
				Static Variables
				Local variables
				Actions
					Return tbl.colSwRef
		Window Parameters
			String: strViewName
			String: strFilter
		Window Variables
			String: strAddWhere
			String: strOutFilter
			String: strAccDWhere
			String: strAccKWhere
			String: strNlsA
			String: strNlsB
			String: TTList
			!
			Number: i
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgSelMsg.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Call SalDisableWindow(pbPrint)
				!
				Set dlgSelMsg.nFlags = GT_ReadOnly
				Set dlgSelMsg.strFilterTblName = strViewName
				!
				Set dlgSelMsg.strSqlPopulate = 
						'select swref, mt, io_ind, trn, sender, receiver, vdate, date_in
						    from ' || strViewName
				If strFilter != ''
					Set dlgSelMsg.strSqlPopulate = dlgSelMsg.strSqlPopulate || ' 
							 where ' || strFilter
					Set strAddWhere = ''
				Else
					Set strAddWhere  = ' where '
				Call SalSendClassMessage( UM_Create, 0, 0 )
	Form Window: splLockSwtMsg		! 21
.data CLASSPROPSSIZE
0000: 3A00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 000000000000C0C0 C000FFFFFF008080
0020: 8000020000000000 0000010000000100 0000000000000001 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
		Class: cSplitterWindow
		Property Template:
		Class DLL Name:
		Title: Блокированные сообщения SWIFT
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.146"
				Width:  10.0"
				Width Editable? Class Default
				Height: 4.893"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Управление формированием SWIFT сообщений
		Named Menus
			Menu: menu_ReturnOption
				Resource Id: 33351
				Title:
				Description:
				Enabled when:
				Status Text:
				Menu Item Name:
				Menu Item: Только сообщение
					Resource Id: 33352
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg(tbl, UM_Delete, 1, 0)
					Menu Item Name:
				Menu Item: Сообщение и документ
					Resource Id: 33353
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg(tbl, UM_Delete, 2, 0)
					Menu Item Name:
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.429"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbReturn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipReturn')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Delete, 0, 0)
				Pushbutton: pbAccept
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipAccept')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Insert, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.133"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipRefresh')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbEdit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Relation.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipUpdate')
						On SAM_Click
							If not (SqlPrepareAndExecute(hSql(), "select bars_swift.msgchk_geteditstatus(:tbl.cSwRef) from dual into :nEditStatus") And SqlFetchNext(hSql(), nNextRow))
								Return FALSE
							If nEditStatus != 1
								Call SalMessageBox(CurrentLangTable.GetAtomTitle(
										     'frmLockSwtMsg.cTErrEditDisabled'), '', MB_IconStop)
								Return FALSE
							Call SalSendMsg(tbl, UM_Update, 0, 0)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Line
					Resource Id: 52948
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.35"
						Begin Y:  -0.01"
						End X:  4.35"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbFilter
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipFilter')
						On SAM_Click
							If SetQueryFilter(tbl.F)
								Call SalPostMsg(hWndForm.splLockSwtMsg.tbl, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.233"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipDetail')
						On SAM_Click
							Call SalSendMsg(hWndForm.splLockSwtMsg.tbl, UM_DoubleClick, 0, 0)
				Line
					Resource Id: 52949
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  3.517"
						Begin Y:  -0.01"
						End X:  3.517"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 47857
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  0.783"
						Begin Y:  0.012"
						End X:  0.783"
						End Y:  0.476"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.833"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Esc
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipExit')
						On SAM_Click
							Call SalSendMsg( hWndForm, UM_Close, 0, 0)
				Line
					Resource Id: 52950
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  2.1"
						Begin Y:  -0.01"
						End X:  2.1"
						End Y:  0.448"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Option Button: pbTimerOn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.5"
						Top:    0.06"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\CLOCK.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set MyValue = TRUE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('splLockSwtMsg.cBTipTimerOn') )
						On SAM_Click
							Call SalMessageBeep ( MB_IconAsterisk )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTMessReread') || ' ' || IifS( MyValue, CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTMessRereadOff'), CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTMessRereadOn') ),   
									CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
				Pushbutton: cpb_Timer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.986"
						Top:    0.083"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.292"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On UM_TimerFired
							If NOT SalTblAnyRows( hWndForm, ROW_Edited | ROW_MarkDeleted, 0 ) AND pbTimerOn
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbReturnOpt
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cpbAttachedButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.06"
						Width:  0.2"
						Width Editable? Class Default
						Height: 0.32"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call pbReturnOpt.AttachButton( pbReturn, 'menu_ReturnOption', PBA_MenuRollDown )
		Contents
			Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cSplitterWindow
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    3.323"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: White
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? No
				Contents
					Column: cSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № п/п
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип
								
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cSndr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отправитель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.814"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cSndrName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: SWIFT
								референция
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.257"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cRcvr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Получатель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cRcvrName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCurr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cAmnt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								валютир
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.083"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								отправки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								регистр
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								оплаты
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlUpdate
					String: strSqlPopulate
					String: strSqlDelete
					: Q
						Class: cGenQuery
					: F
						Class: cGenFilter
					!
					String: sNlsA
					String: sNlsB
					!
					String: sUserF
					String: sCurTT
					!
					Number: nRowFlags
					String: strPrintPath
					File Handle: hFile
					Boolean: bSortOrd
					!
					String: strCheckVisaPar
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						!
						Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
						Set strSqlPopulate=
								"SELECT swref, mt, trn, 
								                sender_bic, sender_name,
								                receiver_bic, receiver_name,
								                currency, amount/100,
								                date_rec, date_pay, vdate
								      INTO :splLockSwtMsg.tbl.cSwRef,  :splLockSwtMsg.tbl.cMT, :splLockSwtMsg.tbl.cTrn,
								                :splLockSwtMsg.tbl.cSndr, :splLockSwtMsg.tbl.cSndrName,
								                :splLockSwtMsg.tbl.cRcvr, :splLockSwtMsg.tbl.cRcvrName,
								                :splLockSwtMsg.tbl.cCurr, :splLockSwtMsg.tbl.cAmnt,
								                :splLockSwtMsg.tbl.cDatR, :splLockSwtMsg.tbl.cDatP, :splLockSwtMsg.tbl.cDatV
								     FROM v_sw_procmsg"
						Set strCheckVisaPar = GetGlobalOption('SWTMSGLK')
						If (strCheckVisaPar = '1')
							Set strSqlPopulate = strSqlPopulate || SalNumberToChar(13) || SalNumberToChar(10) || ' WHERE expstatus = 1'
						If strFilter != STRING_Null
							If strCheckVisaPar = '1'
								Set strSqlPopulate = strSqlPopulate || ' AND ' || strFilter
							Else
								Set strSqlPopulate = strSqlPopulate || SalNumberToChar(13) || SalNumberToChar(10) || ' WHERE ' || strFilter
						!
						Call Q.Init( strSqlPopulate )
						Call F.Init( "V_SW_PROCMSG", "V_SW_PROCMSG")
						Call SalPostMsg( hWndItem, UM_Populate, 0, 0)
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set nFRef = cSwRef
						Set nCount = 0
						Call SalTblPopulate(hWndItem, hSql(), T(Q.GetFullSQLString( F )), TBL_FillAll)
						Call SalStatusSetText( SalParentWindow( hWndItem), CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTStText') || ': ' || SalNumberToStrX(nCount,0) )
						Call VisTblAutoSizeColumn( hWndItem, cSwRef )
						Call VisTblAutoSizeColumn( hWndItem, cMT )
						Call VisTblAutoSizeColumn( hWndItem, cTrn )
						Call VisTblAutoSizeColumn( hWndItem, cCurr )
						Call VisTblAutoSizeColumn( hWndItem, cAmnt )
						Set nFRow = VisTblFindString( hWndItem, 0, cSwRef, SalNumberToStrX( nFRef, 0 ))
						If nFRow = -1
							Set nFRow = 0
						Call SalTblSetContext( hWndItem, nFRow )
						Call SalTblSetFocusRow( hWndItem, nFRow )
						Call SalTblSetRowFlags( hWndItem, nFRow, ROW_Selected, TRUE )
						Call SalSendMsg(hWndItem, SAM_TblDoDetails, 0, 0)
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						Set nCount = nCount + 1
					On SAM_DoubleClick
						Call ShowMsg(cSwRef)
					On UM_Insert
						If MessageQuestion(CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTMsgUnLockMsg')) != IDYES
							Return FALSE
						If not UnlockMsg(tbl, 0)
							Return FALSE
						Call SalSendMsg(tbl, UM_Populate, 0, 0)
					On UM_Delete
						If MessageQuestion(CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTMsgRejectMsg')) != IDYES
							Return FALSE
						If wParam = 0
							If not ReturnMsg(NUMBER_Null)
								Return FALSE
						Else If wParam = 1
							If not ReturnMsg(0)
								Return FALSE
						Else
							If not ReturnMsg(1)
								Return FALSE
						Call SalSendMsg(tbl, UM_Populate, 0, 0)
					On UM_Update
						! Call SalCreateWindow(frmMT, hWndForm, tbl.cSwRef, '', '')
						Call SalCreateWindow(frmMT, hWndMDI, tbl.cSwRef, '', '')
					On SAM_TblDoDetails
						If cSwRef
							Set mlBody = 'From: ' || cSndr 
							If cSndrName
								Set mlBody = mlBody || ' - ' || cSndrName
							Set mlBody = mlBody || PutCrLf() || 'To  : ' || cRcvr
							If cRcvrName
								Set mlBody = mlBody || ' - ' || cRcvrName
							Set mlBody = mlBody || PutCrLf()
							!
							If SqlPrepareAndExecute(hSqlAux(),T(
									"SELECT tag,opt,value INTO :sTag,:sOpt,:sValu 
									 FROM sw_operw WHERE swref=:cSwRef ORDER BY n"))
								While SqlFetchNext(hSqlAux(),nFetchRes)
									Set sTmp=SalStrRightX('  '||sTag||sOpt||': ', 6)
									! While SalStrLength( sValu ) > 40
										                                                                               Set sTmp = sTmp || SalStrLeftX( VisStrSubstitute(sValu, PutCrLf(), PutCrLf()||'      '), 40 ) || PutCrLf() || '      '
										                                                                               Set sValu = SalStrMidX( sValu, 40, SalStrLength( sValu )-40 )
									Set sTmp = sTmp || VisStrSubstitute(sValu, PutCrLf(), PutCrLf()||'      ')
									! If sTag = '57' AND sOpt = 'A' ! Look for transit bank name
										                                                                               If SqlPrepareAndExecute( hSqlAux2(), 
												"SELECT name INTO :sTrnsName FROM sw_banks WHERE bic='" || SalStrLeftX( sValu || 'XXXX', 11 )|| "'")
											                                                                               If SqlFetchNext( hSqlAux2(), nFetchRes )
												                                                                               Set sTmp = sTmp || ' - ' || sTrnsName
									Set mlBody=mlBody || PutCrLf() || sTmp
						Else
							Set mlBody = ''
						! If Subs(strPar02,1,1)= 'E'
							                                                                                                                                                      Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(tbl, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			Multiline Field: mlBody
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.033"
						Top:    3.393"
						Width:  9.8"
						Width Editable? Yes
						Height: 0.464"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 10
					Font Enhancement: None
					Text Color: Default
					Background Color: Gray
				Message Actions
					On UM_NoFontChange
						Return TRUE
		Functions
			Function: ShowMsg
				Description: Показывает текст сообщения
				Returns
				Parameters
					Number: nSwRef
				Static Variables
				Local variables
				Actions
					Call SalCreateWindow(frm_SWIFTDoc, hWndForm, nSwRef)
			Function: UnlockMsg
				Description:
				Returns
					Boolean:
				Parameters
					Window Handle: hWndTable
					Number: nBlk
				Static Variables
				Local variables
					Number: nSwRef
					Number: nRow
				Actions
					Call WaitCursorOn()
					Set nRow = TBL_MinRow
					! ! главный цикл
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblFetchRow(tbl, nRow)
						Set nSwRef = tbl.cSwRef
						! Разблокируем сообщение
						If SqlPLSQLCommand(hSql(), "bars_swift.unlock_message( nSwRef )")
							Call SqlCommit(hSql())
							Call SaveInfoToLog( "Разблокировано сообщение SwRef = " || Str(nSwRef) )
						Else
							Call SqlRollback( hSql() )
					! Set nRow = TBL_MinRow
					! While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						                                                                                                                                                      Call SalTblDeleteRow(tblLockDocs, nRow, TBL_Adjust)
						                                                                                                                                                      Call SalTblFetchRow(tblLockDocs, nRow)
					Call WaitCursorOff()
					Return TRUE
			Function: ReturnMsg
				Description:
				Returns
				Parameters
					Number: nReturnOption
				Static Variables
				Local variables
				Actions
					Call WaitCursorOn()
					Set nRow = TBL_MinRow
					! ! главный цикл
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblFetchRow(tbl, nRow)
						Set nSwRef = tbl.cSwRef
						! Удаляем сообщение
						If SqlPLSQLCommand(hSql(), "bars_swift.expmsg_delete_message( nSwRef, nReturnOption )")
							Call SqlCommit(hSql())
							Call SaveInfoToLog( "Удалено сообщение SwRef = " || Str(nSwRef) )
						Else
							Call SqlRollback( hSql() )
					! Set nRow = TBL_MinRow
					! While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						                                                                                                                                                      Call SalTblDeleteRow(tblLockDocs, nRow, TBL_Adjust)
						                                                                                                                                                      Call SalTblFetchRow(tblLockDocs, nRow)
					Call WaitCursorOff()
					Return TRUE
		Window Parameters
			Number: nPar01
			String: strPar02
			String: strPar03
		Window Variables
			String: strFileName
			Number: i
			Date/Time: dOperDat
			String: sTmp
			String: sTag
			String: sTrnsName
			String: sOpt
			Long String: sValu
			String: sFilt
			Number: nId
			Number: mId[*]
			Number: nTmp
			Number: nBound
			Number: nRow
			Number: nFRow
			Number: nFRef
			Number: nCount
			Number: nSwRef
			!
			Boolean: bType
			Number: nInterval
			!
			String: strTTArr[*,2]
			Number: nTTArr
			Number: nUserId
			String: strSecure
			String: strTT
			String: strTTName
			String: strIoInd
			String: strACC
			!
			!
			!
			!
			String: strFilter
			Number: nEditStatus
			Number: nNextRow
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				! Call SalTblSetTableFlags(tbl, TBL_Flag_SingleSelection, TRUE)
				! В протокол сообщение о начале работы
				Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTBeginFunc') )
				! If nIsp
					                                                                                                                                                      Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTBeginFunc1') )
					                                                                                                                                                      If SqlPrepareAndExecute( hSql(), 'SELECT fio INTO :sTmp FROM staff WHERE id=:nIsp' )
						                                                                                                                                                      If SqlFetchNext( hSql(), nFetchRes )
							                                                                                                                                                      Call SalSetWindowText( hWndForm, sTmp || ': ' || CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTWTitle') )
					                                                                                                                                                      Call SalDisableWindow( pbUserList )
					                                                                                                                                                      Call SalDisableWindow( pbApplyToAll )
				! Else 
					                                                                                                                                                      Call SalDisableWindow( pbReject )
					                                                                                                                                                      Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splSwtMsgJrn.cTBeginFunc2') )
				Call XSalTooltipSetUserDefault()
				! Устанавливаем таймер обновления окна
				Set nInterval=300
				Call cpb_Timer.Init(nInterval, 0, TRUE)
				Set strFilter = strPar02
				! Set nUserId = GetUserId()
				! Set strIoInd='O'
				! Set strSecure = ''
				! If EnhancedSecurity(  )
					                                                                                                                                                      Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
			On SAM_CreateComplete
				Call SalSendClassMessage(SAM_CreateComplete, wParam, lParam)
				Call SalWaitCursor(FALSE)
			On UM_Close
				Call SalDestroyWindow(hWndForm)
			On SAM_Destroy
				Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splLockSwtMsg.cTEndFunc') )
	Form Window: frmMT_new			! 22
		Class:
		Property Template:
		Class DLL Name:
		Title: SWIFT сообщение
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.533"
				Width Editable? Yes
				Height: 7.94"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Просмотреть свифтовочку
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.417"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.367"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipExit')
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
				Pushbutton: pbChangeMT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Recycle.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipChangeMT')
						On SAM_Click
							! При изменении типа существующего сообщения
							If nPar01 != NUMBER_Null and nPar01 != 0
								Call SelectMT()
								Set nNewMt = SalStrToNumber(strMTCode)
								Call LoadMessage(nNewMt)
								Call SalEnableWindow(pbSrcMsg)
				Pushbutton: pbSaveMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SaveMessage(nNewMt)
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipSaveMsg')
				Pushbutton: pbNewMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipNewMsg')
				Line
					Resource Id: 52954
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  2.2"
						Begin Y:  0.048"
						End X:  2.2"
						End Y:  0.464"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 42088
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  1.567"
						Begin Y:  0.071"
						End X:  1.567"
						End Y:  0.488"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbHelp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If strDictName != STRING_Null
								If FunNSIGet(strDictName, strDictSK, strDictCode, strDictSemn)
									Call SalSendMsgToChildren(hWndForm, SAM_User, 0, 0)
									Call Debug('Messsage sent')
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipHelp')
				Line
					Resource Id: 52955
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  8.667"
						Begin Y:  -0.012"
						End X:  8.667"
						End Y:  0.405"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSrcMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SWIFTMsgView(hWndForm, nPar01)
		Contents
			Group Box:
				Resource Id: 52951
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  9.2"
					Width Editable? Yes
					Height: 1.167"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfSndr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.405"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_User
						If strControl = 'dfSndr'
							Set dfSndr = strDictCode
							Set dfSndrName = strDictSemn
					On SAM_SetFocus
						Set strDictName = 'SW_BANKS'
						Set strDictSK = 'NAME'
						Set strControl = 'dfSndr'
			Data Field: dfSndrName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.405"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfRcvr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.905"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_User
						If strControl = 'dfRcvr'
							Set dfRcvr = strDictCode
							Set dfRcvrName = strDictSemn
					On SAM_SetFocus
						Set strDictName = 'SW_BANKS'
						Set strDictSK = 'NAME'
						Set strControl = 'dfRcvr'
			Data Field: dfRcvrName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.905"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Отправитель
				Resource Id: 52952
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.262"
					Width:  9.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Получатель
				Resource Id: 52953
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.762"
					Width:  8.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tblFields
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.217"
						Top:    1.452"
						Width:  8.967"
						Width Editable? Yes
						Height: 4.869"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? Yes
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colSeq
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Блок
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSubSeq
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Подблок
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTag
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поле
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? Yes
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOpt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Опц
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: String
						Justify: Center
						Width:  0.586"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? No
								Auto Drop Down? Yes
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								Call SalListClear(colOpt)
								If colEditable = "N"
									Return TRUE
								If colOptModel = 'a'
									! Call Debug('MT=' || strMTCode || 'Seq= ' || colSeq || ' Tag=' || colTag)
									Call SalListPopulate(colOpt, hSql(),
											 "SELECT decode(opt, '-', null, opt)
											      FROM sw_model_opt
											    WHERE mt  = to_number(:strMTCode)
											          AND num = :colNum" )
					Column: colStatus
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colValue
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 800
						Data Type: Long String
						Justify: Left
						Width:  5.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Popup Edit
							Multiline Cell? Yes
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							! On SAM_Click
								                                                                                                                                                     If ((nFunction & 0x000F) = 0)
										 OR (((nFunction & 0x000F) != 0x000F) AND
										         (SalNumberMod(SalStrToNumber(colTag), 2) = 0))
									                                                                                                                                                     Call SalTblSetColumnFlags ( tblFields.colValue, COL_Editable, FALSE )
									                                                                                                                                                     Call SalDisableWindow( tblFields.colValue )
								                                                                                                                                                     Else 
									                                                                                                                                                     Call SalEnableWindow( tblFields.colValue)
									                                                                                                                                                     Call SalTblSetColumnFlags (tblFields.colValue, COL_Editable, TRUE)
							! On SAM_Validate
								                                                                                                                                                     If SalIsNull( colValue ) AND colStatus = 'M'
									                                                                                                                                                     Call SalMessageBox ( 'Не заполнено обязательное поле!','Ошибка', MB_IconExclamation | MB_Ok )
									                                                                                                                                                     Return VALIDATE_Cancel
								                                                                                                                                                     Else 
									                                                                                                                                                     Return ufValidateSWField ( colTag, colOpt, colValue )
							On SAM_SetFocus
								If colEditable = "N"
									Set strTmpValue = colValue
							On SAM_AnyEdit
								If colEditable = "N"
									Set colValue = strTmpValue
					Column: colNum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colEmpty
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSeqStat
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOptModel
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colEditable
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_SetFocus
								Call SalEnableWindow(colValue)
								If colEditable = "N"
									Call SalDisableWindow(colValue)
							On SAM_KillFocus
								Call SalEnableWindow(colValue)
								! Call Debug('Kill focus fired')
				Functions
					Function: Init
						Description: Init
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							! Call Debug('start tblFields.Init()...')
							If nSwRef = NUMBER_Null or nSwRef = 0
								Set strSQL = T(
										"SELECT num, seq, subseq, tag, opt, status, empty, seqstat, opt optmodel, 'Y' editable
										     FROM sw_model
										       INTO :colNum, :colSeq, :colSubSeq, :colTag, :colOpt, :colStatus, :colEmpty, :colSeqStat, :colOptModel,:colEditable
										   WHERE mt = :strMTCode
										ORDER BY num")
							Else
								Set strSQL = T(
										"SELECT num, seq, subseq, tag, opt, status, empty, seqstat, value, optmodel, editval
										     FROM tmp_sw_message
										       INTO :colNum, :colSeq, :colSubSeq, :colTag, :colOpt, :colStatus, :colEmpty, :colSeqStat, :colValue, :colOptModel, :colEditable
										ORDER BY num")
							Call SalTblPopulate( tblFields, hSql(), strSQL, TBL_FillAll )
							Call SalPostMsg( tblFields, SAM_RowSetContext, 0, 0 )
							! Call Debug('end tblFields.Init()...')
					Function: AfterRefreshHook
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							If nInArray >0
								Set nTableRow = TBL_MinRow
								Loop
									If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
										Call SalTblFetchRow ( tblFields, nTableRow )
										Set nRow = 0
										Loop
											If nRow > SalStrToNumber(strValues[0, 0, nInArray])
												Break
											Else If strValues[nRow, 0, nInArray] = tblFields.colTag
												Set tblFields.colValue = VSStrTrim(strValues[nRow, 1, nInArray])
											Call Inc(nRow)
									Else
										Break
							Else
								Set nTableRow = TBL_MinRow
								Loop
									If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
										Call SalTblFetchRow ( tblFields, nTableRow )
										! Set nFunction = 0x0001
										Call SalColorSet( colValue, COLOR_IndexCellText, COLOR_Black )
									Else
										Break
					Function: RepopulateTags
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set nRow = 0
							! Call SalListClear( colOpt )
							While nRow != nMaxRow
								If strModif[nRow, 1] = colTag
									! Call SalListAdd ( colOpt, colTag || strModif[nRow, 2] )
									Set colOpt = strModif[nRow, 2]
								Set nRow = nRow+1
							! If SalListQueryCount( colOpt ) = 0
								                                                                                                                                                              Call SalListAdd ( colOpt, colTag )
							! Call SalListSetSelect( colOpt, 0 )
					Function: ufValidateSWField
						Description: Performs checking for correspondence the structure of a SWIFT field
								to the predefined format (from SW_FORMAT table), if the latter
								exists.
						Returns
							Boolean:
						Parameters
							String: sTag
							String: sOpt
							String: sValue
						Static Variables
						Local variables
							String: sFmt
							Number: nInd
							Boolean: bOK
						Actions
							! Call SqlPrepareAndExecute ( hSql(), T(
									'SELECT fmt
									 INTO   :sFmt
									 FROM   sw_format
									 WHERE  opt = :sOpt
									   AND  tag = :sTag'))
							! If SqlFetchNext ( hSql(), nInd )
								! --- А здесь предполагается проверка на соответствие формату
								                                                                                                                                                      Set bOK = VALIDATE_Ok
							Set bOK = VALIDATE_Ok
							Return bOK
				Window Variables
					String: strModif[0:*, 1:2]
					String: strTag
					String: strOpt
					Number: nRet
					Number: nMaxRow
					Number: nTableRow
					Window Handle: hwCol
				Message Actions
					On SAM_Create
						Call Init()
					On SAM_FetchRowDone
						If colStatus = "M"
							Call SalColorSet( colTag, COLOR_IndexCellText, COLOR_Red )
							Call SalColorSet( colOpt, COLOR_IndexCellText, COLOR_Red )
						If colEditable = "N"
							! Call SalDisableWindow(colOpt)
							! Call SalDisableWindow(colValue)
							Call XSalTblSetRowBackColor( hWndItem, lParam, COLOR_Gray )
			Group Box:
				Resource Id: 52956
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.321"
					Width:  9.2"
					Width Editable? Yes
					Height: 5.083"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			Function: SelectMT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set strMTCode = GetMT(strMTName)
					Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmMT.cTTitle') || strMTCode || '  ' || strMTName || ']')
			Function: GetMT
				Description: Получает код и наименование MT-сообщения
				Returns
					String: strMTCode
				Parameters
					Receive String: strMTName
				Static Variables
				Local variables
					Number: nDlgResult
					String: strMT
					String: strName
				Actions
					Set nDlgResult = SalModalDialog(dlg_SelMT, hWndForm, strMT, strName)
					If nDlgResult != 1
						Return STRING_Null
					Else
						Set strMTName = strName
						Return strMT
			Function: LoadMessage
				Description: Загружаем сообщения для редактирования
				Returns
				Parameters
					Number: nNewMt
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand( hSql(), 'swift.gen_full_message(nSwRef, nNewMt)')
						If SqlPrepareAndExecute( hSql(), 
								"select to_char(mt), sender, receiver 
								     into :strMTCode, :dfSndr, :dfRcvr 
								    from sw_journal where swref = :nSwRef")
							Call SqlFetchNext( hSql(), nFetchRes)
							! Получаем наименование типа сообщения
							If SqlPrepareAndExecute(hSql(), "select name into :strMTName from sw_mt where mt = :strMTCode")
								Call SqlFetchNext(hSql(), nFetchRes)
							! Устанаваливаем заголовок окна
							Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmMT.cTTitle') || strMTCode || '  ' || strMTName || ']')
							! Из заголовка мы получили только коды, получаем наименования участников
							If SqlPrepareAndExecute(hSql(), "select name into :dfSndrName from sw_banks where bic = :dfSndr")
								Call SqlFetchNext(hSql(), nFetchRes)
							If SqlPrepareAndExecute(hSql(), "select name into :dfRcvrName from sw_banks where bic = :dfRcvr")
								Call SqlFetchNext(hSql(), nFetchRes)
							! Блокируем поля отправителя и получателя
							Call SalDisableWindow(dfSndr)
							Call SalDisableWindow(dfRcvr)
							! Блокируем кнопки смены типа сообщения и создания нового
							If (GetGlobalOptionEx('SWTMSGCT')=1)
								Call SalEnableWindow(pbChangeMT)
							Else
								Call SalDisableWindow(pbChangeMT)
							Call SalDisableWindow(pbNewMsg)
							Call tblFields.Init()
			Function: InitHideControls
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow(dfSndrName)
					Call SalDisableWindow(dfRcvrName)
			Function: UpdateControls
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Если редактирование, то 
			Function: SaveMessage
				Description:
				Returns
					Boolean:
				Parameters
					Number: nNewMt
				Static Variables
				Local variables
					Number: nTableRow
				Actions
					! Удаляем данные из временной таблицы и вставляем данные из грида
					If not SqlPrepareAndExecute(hSql(), 'delete from tmp_sw_message')
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmMT.cTMsgSaveMsgErr'), '', MB_Ok)
						Return FALSE
					! Проходим по всей таблице и вставляем в базу каждую строку
					Set nTableRow = TBL_MinRow
					Loop
						If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
							Call SalTblFetchRow ( tblFields, nTableRow )
							! Вставляем
							Call SqlPrepareAndExecute(hSql(), 
									   'insert into tmp_sw_message(num, seq, subseq, tag, opt, status, empty, seqstat, value)
									    values (:tblFields.colNum, :tblFields.colSeq, :tblFields.colSubSeq, :tblFields.colTag, :tblFields.colOpt, :tblFields.colStatus, :tblFields.colEmpty, :tblFields.colSeqStat, :tblFields.colValue)')
						Else
							Break
					! Вызываем функцию проверки и сохранения изменений
					If SqlPLSQLCommand(hSql(), 'swift.update_message(nSwRef, nNewMt)')
						Call SqlCommit(hSql())
						Call SalDisableWindowAndLabel(tblFields)
						Call SalColorSet(tblFields, COLOR_IndexWindow, COLOR_LightGray)
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmMT.cTMsgSaveMsg'), '', MB_Ok)
						Call SalEnableWindow(pbSrcMsg)
		Window Parameters
			Number: nPar01
			String: strPar02
			String: strPar03
		Window Variables
			String: strMTCode
			String: strMTName
			Number: nSwRef    ! Реф. сообщения для редактирования
			!
			String: strControl      ! Имя элемента
			String: strDictName ! Имя справочника
			String: strDictSK      ! Семантика справочника
			String: strDictCode  ! Полученный код справочника
			String: strDictSemn ! Полученная семантика справочника
			!
			! Derived from SWIFTAPI
			Number: nRow
			String: strDefMT
			! Number: nSwRef
			String: strV
			String: strT
			String: strO
			String: strS
			String: strPK
			String: strSK
			Number: nCurRow
			Number: N
			Boolean: bOK
			!
			Number: nRef
			String: strValues[50, 0:2, 1:2]
			Number: nInArray
			Number: nFunction
			! 0x0000    - Disable Editing table
					  0x0001    - Enable Editing only some fields
					  0x000F    - Enable Edititng entire table
					  0x0010    - Enable Add Field
					  0x0020    - Enable Remove Field
					  0x0040    - Enable Edit To:
					  0x0080    - Enable Edit To:
			Long String: strTmpValue
			Number: nNewMt  ! Новый тип сообщения, если изменяется тип
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Set nNewMt = NUMBER_Null
				If nPar01 = NUMBER_Null or nPar01 = 0
					Call SelectMT()  ! Ввод нового сообщения, выбираем тип
				Else
					Set nSwRef = nPar01
					! Загружаем сообщение
					Call LoadMessage(nNewMt)
					! Можно менять тип сообщения прямо в редактировании !!!
					If (GetGlobalOptionEx('SWTMSGCT')=1)
						Call SalEnableWindow(pbChangeMT)
					Else
						Call SalDisableWindow(pbChangeMT)
					Call SalDisableWindow(pbNewMsg)
					Call SalDisableWindow(pbSrcMsg)
				Call InitHideControls()
				Set nFunction = 0x000F
			On SAM_CreateComplete
				Call SalWaitCursor(FALSE)
			! On SAM_Close
				 Call SalDestroyWindow(hWndForm)
	Form Window: frmMT			! 22
		Class:
		Property Template:
		Class DLL Name:
		Title: SWIFT сообщение
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.6"
				Width Editable? Yes
				Height: 7.94"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Просмотреть свифтовочку
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.417"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.367"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipExit')
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
				Pushbutton: pbChangeMT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Recycle.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipChangeMT')
						On SAM_Click
							! При изменении типа существующего сообщения
							If nPar01 != NUMBER_Null and nPar01 != 0
								Call SelectMT()
								Set nNewMt = SalStrToNumber(strMTCode)
								Call LoadMessage(nNewMt)
								Call SalEnableWindow(pbSrcMsg)
				Pushbutton: pbSaveMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SaveMessage(nNewMt)
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipSaveMsg')
				Pushbutton: pbNewMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipNewMsg')
				Line
					Resource Id: 11816
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  2.2"
						Begin Y:  0.048"
						End X:  2.2"
						End Y:  0.464"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 11817
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  1.567"
						Begin Y:  0.071"
						End X:  1.567"
						End Y:  0.488"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbHelp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If strDictName != STRING_Null
								If FunNSIGet(strDictName, strDictSK, strDictCode, strDictSemn)
									Call SalSendMsgToChildren(hWndForm, SAM_User, 0, 0)
									Call Debug('Messsage sent')
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('frmMT.cBTipHelp')
				Line
					Resource Id: 11818
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  8.667"
						Begin Y:  -0.012"
						End X:  8.667"
						End Y:  0.405"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSrcMsg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SWIFTMsgView(hWndForm, nPar01)
		Contents
			Group Box:
				Resource Id: 11812
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  9.2"
					Width Editable? Yes
					Height: 1.167"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfSndr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.405"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_User
						If strControl = 'dfSndr'
							Set dfSndr = strDictCode
							Set dfSndrName = strDictSemn
					On SAM_SetFocus
						Set strDictName = 'SW_BANKS'
						Set strDictSK = 'NAME'
						Set strControl = 'dfSndr'
			Data Field: dfSndrName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.405"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfRcvr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.905"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_User
						If strControl = 'dfRcvr'
							Set dfRcvr = strDictCode
							Set dfRcvrName = strDictSemn
					On SAM_SetFocus
						Set strDictName = 'SW_BANKS'
						Set strDictSK = 'NAME'
						Set strControl = 'dfRcvr'
			Data Field: dfRcvrName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.905"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Отправитель
				Resource Id: 11813
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.262"
					Width:  9.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Получатель
				Resource Id: 11814
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.762"
					Width:  8.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tblFields
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: clsSortedTable
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.217"
						Top:    1.452"
						Width:  8.967"
						Width Editable? Class Default
						Height: 4.869"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Yes
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colSeq
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Блок
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSubSeq
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Подблок
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTag
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поле
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? Yes
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOpt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Опц
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: String
						Justify: Center
						Width:  0.586"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? No
								Auto Drop Down? Yes
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								Call SalListClear(colOpt)
								If colEditable = "N"
									Return TRUE
								If colOptModel = 'a'
									! Call Debug('MT=' || strMTCode || 'Seq= ' || colSeq || ' Tag=' || colTag)
									Call SalListPopulate(colOpt, hSql(),
											 "SELECT decode(opt, '-', null, opt)
											      FROM sw_model_opt
											    WHERE mt  = to_number(:strMTCode)
											          AND num = :colNum" )
					Column: colStatus
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colValue
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 800
						Data Type: Long String
						Justify: Left
						Width:  5.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Popup Edit
							Multiline Cell? Yes
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							! On SAM_Click
								                                                                                                                                                     If ((nFunction & 0x000F) = 0)
										 OR (((nFunction & 0x000F) != 0x000F) AND
										         (SalNumberMod(SalStrToNumber(colTag), 2) = 0))
									                                                                                                                                                     Call SalTblSetColumnFlags ( tblFields.colValue, COL_Editable, FALSE )
									                                                                                                                                                     Call SalDisableWindow( tblFields.colValue )
								                                                                                                                                                     Else 
									                                                                                                                                                     Call SalEnableWindow( tblFields.colValue)
									                                                                                                                                                     Call SalTblSetColumnFlags (tblFields.colValue, COL_Editable, TRUE)
							! On SAM_Validate
								                                                                                                                                                     If SalIsNull( colValue ) AND colStatus = 'M'
									                                                                                                                                                     Call SalMessageBox ( 'Не заполнено обязательное поле!','Ошибка', MB_IconExclamation | MB_Ok )
									                                                                                                                                                     Return VALIDATE_Cancel
								                                                                                                                                                     Else 
									                                                                                                                                                     Return ufValidateSWField ( colTag, colOpt, colValue )
							On SAM_SetFocus
								If colEditable = "N"
									Set strTmpValue = colValue
							On SAM_AnyEdit
								If colEditable = "N"
									Set colValue = strTmpValue
					Column: colNum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colEmpty
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSeqStat
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOptModel
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colEditable
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_SetFocus
								Call SalEnableWindow(colValue)
								If colEditable = "N"
									Call SalDisableWindow(colValue)
							On SAM_KillFocus
								Call SalEnableWindow(colValue)
								! Call Debug('Kill focus fired')
				Functions
					Function: Init
						Description: Init
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							! Call Debug('start tblFields.Init()...')
							If nSwRef = NUMBER_Null or nSwRef = 0
								Set strSQL = T(
										"SELECT num, seq, subseq, tag, opt, status, empty, seqstat, opt optmodel, 'Y' editable
										     FROM sw_model
										       INTO :colNum, :colSeq, :colSubSeq, :colTag, :colOpt, :colStatus, :colEmpty, :colSeqStat, :colOptModel,:colEditable
										   WHERE mt = :strMTCode
										ORDER BY num")
							Else
								Set strSQL = T(
										"SELECT num, seq, subseq, tag, opt, status, empty, seqstat, value, optmodel, editval
										     FROM tmp_sw_message
										       INTO :colNum, :colSeq, :colSubSeq, :colTag, :colOpt, :colStatus, :colEmpty, :colSeqStat, :colValue, :colOptModel, :colEditable
										ORDER BY num")
							Call SalTblPopulate( tblFields, hSql(), strSQL, TBL_FillAll )
							Call SalPostMsg( tblFields, SAM_RowSetContext, 0, 0 )
							! Call Debug('end tblFields.Init()...')
					Function: AfterRefreshHook
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							If nInArray >0
								Set nTableRow = TBL_MinRow
								Loop
									If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
										Call SalTblFetchRow ( tblFields, nTableRow )
										Set nRow = 0
										Loop
											If nRow > SalStrToNumber(strValues[0, 0, nInArray])
												Break
											Else If strValues[nRow, 0, nInArray] = tblFields.colTag
												Set tblFields.colValue = VSStrTrim(strValues[nRow, 1, nInArray])
											Call Inc(nRow)
									Else
										Break
							Else
								Set nTableRow = TBL_MinRow
								Loop
									If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
										Call SalTblFetchRow ( tblFields, nTableRow )
										! Set nFunction = 0x0001
										Call SalColorSet( colValue, COLOR_IndexCellText, COLOR_Black )
									Else
										Break
					Function: RepopulateTags
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set nRow = 0
							! Call SalListClear( colOpt )
							While nRow != nMaxRow
								If strModif[nRow, 1] = colTag
									! Call SalListAdd ( colOpt, colTag || strModif[nRow, 2] )
									Set colOpt = strModif[nRow, 2]
								Set nRow = nRow+1
							! If SalListQueryCount( colOpt ) = 0
								                                                                                                                                                              Call SalListAdd ( colOpt, colTag )
							! Call SalListSetSelect( colOpt, 0 )
					Function: ufValidateSWField
						Description: Performs checking for correspondence the structure of a SWIFT field
								to the predefined format (from SW_FORMAT table), if the latter
								exists.
						Returns
							Boolean:
						Parameters
							String: sTag
							String: sOpt
							String: sValue
						Static Variables
						Local variables
							String: sFmt
							Number: nInd
							Boolean: bOK
						Actions
							! Call SqlPrepareAndExecute ( hSql(), T(
									'SELECT fmt
									 INTO   :sFmt
									 FROM   sw_format
									 WHERE  opt = :sOpt
									   AND  tag = :sTag'))
							! If SqlFetchNext ( hSql(), nInd )
								! --- А здесь предполагается проверка на соответствие формату
								                                                                                                                                                      Set bOK = VALIDATE_Ok
							Set bOK = VALIDATE_Ok
							Return bOK
				Window Variables
					String: strModif[0:*, 1:2]
					String: strTag
					String: strOpt
					Number: nRet
					Number: nMaxRow
					Number: nTableRow
					Window Handle: hwCol
				Message Actions
					On SAM_Create
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
						Call Init()
					On SAM_FetchRowDone
						If colStatus = "M"
							Call SalColorSet( colTag, COLOR_IndexCellText, COLOR_Red )
							Call SalColorSet( colOpt, COLOR_IndexCellText, COLOR_Red )
						If colEditable = "N"
							! Call SalDisableWindow(colOpt)
							! Call SalDisableWindow(colValue)
							Call XSalTblSetRowBackColor( hWndItem, lParam, COLOR_Gray )
			Group Box:
				Resource Id: 11815
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.321"
					Width:  9.2"
					Width Editable? Yes
					Height: 5.083"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			Function: SelectMT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set strMTCode = GetMT(strMTName)
					Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmMT.cTTitle') || strMTCode || '  ' || strMTName || ']')
			Function: GetMT
				Description: Получает код и наименование MT-сообщения
				Returns
					String: strMTCode
				Parameters
					Receive String: strMTName
				Static Variables
				Local variables
					Number: nDlgResult
					String: strMT
					String: strName
				Actions
					Set nDlgResult = SalModalDialog(dlg_SelMT, hWndForm, strMT, strName)
					If nDlgResult != 1
						Return STRING_Null
					Else
						Set strMTName = strName
						Return strMT
			Function: LoadMessage
				Description: Загружаем сообщения для редактирования
				Returns
				Parameters
					Number: nNewMt
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand( hSql(), 'swift.gen_full_message(nSwRef, nNewMt)')
						If SqlPrepareAndExecute( hSql(), 
								"select to_char(mt), sender, receiver 
								     into :strMTCode, :dfSndr, :dfRcvr 
								    from sw_journal where swref = :nSwRef")
							Call SqlFetchNext( hSql(), nFetchRes)
							! Получаем наименование типа сообщения
							If SqlPrepareAndExecute(hSql(), "select name into :strMTName from sw_mt where mt = :strMTCode")
								Call SqlFetchNext(hSql(), nFetchRes)
							! Устанаваливаем заголовок окна
							Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmMT.cTTitle') || strMTCode || '  ' || strMTName || ']')
							! Из заголовка мы получили только коды, получаем наименования участников
							If SqlPrepareAndExecute(hSql(), "select name into :dfSndrName from sw_banks where bic = :dfSndr")
								Call SqlFetchNext(hSql(), nFetchRes)
							If SqlPrepareAndExecute(hSql(), "select name into :dfRcvrName from sw_banks where bic = :dfRcvr")
								Call SqlFetchNext(hSql(), nFetchRes)
							! Блокируем поля отправителя и получателя
							Call SalDisableWindow(dfSndr)
							Call SalDisableWindow(dfRcvr)
							! Блокируем кнопки смены типа сообщения и создания нового
							If (GetGlobalOptionEx('SWTMSGCT')=1)
								Call SalEnableWindow(pbChangeMT)
							Else
								Call SalDisableWindow(pbChangeMT)
							Call SalDisableWindow(pbNewMsg)
							Call tblFields.Init()
			Function: InitHideControls
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow(dfSndrName)
					Call SalDisableWindow(dfRcvrName)
			Function: UpdateControls
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Если редактирование, то 
			Function: SaveMessage
				Description:
				Returns
					Boolean:
				Parameters
					Number: nNewMt
				Static Variables
				Local variables
					Number: nTableRow
				Actions
					! Удаляем данные из временной таблицы и вставляем данные из грида
					If not SqlPrepareAndExecute(hSql(), 'delete from tmp_sw_message')
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmMT.cTMsgSaveMsgErr'), '', MB_Ok)
						Return FALSE
					! Проходим по всей таблице и вставляем в базу каждую строку
					Set nTableRow = TBL_MinRow
					Loop
						If SalTblFindNextRow ( tblFields, nTableRow, 0, 0 )
							Call SalTblFetchRow ( tblFields, nTableRow )
							! Вставляем
							Call SqlPrepareAndExecute(hSql(), 
									   'insert into tmp_sw_message(num, seq, subseq, tag, opt, status, empty, seqstat, value)
									    values (:tblFields.colNum, :tblFields.colSeq, :tblFields.colSubSeq, :tblFields.colTag, :tblFields.colOpt, :tblFields.colStatus, :tblFields.colEmpty, :tblFields.colSeqStat, :tblFields.colValue)')
						Else
							Break
					! Вызываем функцию проверки и сохранения изменений
					If SqlPLSQLCommand(hSql(), 'swift.update_message(nSwRef, nNewMt)')
						Call SqlCommit(hSql())
						Call SalDisableWindowAndLabel(tblFields)
						Call SalColorSet(tblFields, COLOR_IndexWindow, COLOR_LightGray)
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmMT.cTMsgSaveMsg'), '', MB_Ok)
						Call SalEnableWindow(pbSrcMsg)
		Window Parameters
			Number: nPar01
			String: strPar02
			String: strPar03
		Window Variables
			String: strMTCode
			String: strMTName
			Number: nSwRef    ! Реф. сообщения для редактирования
			!
			String: strControl      ! Имя элемента
			String: strDictName ! Имя справочника
			String: strDictSK      ! Семантика справочника
			String: strDictCode  ! Полученный код справочника
			String: strDictSemn ! Полученная семантика справочника
			!
			! Derived from SWIFTAPI
			Number: nRow
			String: strDefMT
			! Number: nSwRef
			String: strV
			String: strT
			String: strO
			String: strS
			String: strPK
			String: strSK
			Number: nCurRow
			Number: N
			Boolean: bOK
			!
			Number: nRef
			String: strValues[50, 0:2, 1:2]
			Number: nInArray
			Number: nFunction
			! 0x0000    - Disable Editing table
					  0x0001    - Enable Editing only some fields
					  0x000F    - Enable Edititng entire table
					  0x0010    - Enable Add Field
					  0x0020    - Enable Remove Field
					  0x0040    - Enable Edit To:
					  0x0080    - Enable Edit To:
			Long String: strTmpValue
			Number: nNewMt  ! Новый тип сообщения, если изменяется тип
		Message Actions
			On SAM_Create
				Call PrepareWindow(hWndForm)
				Set nNewMt = NUMBER_Null
				If nPar01 = NUMBER_Null or nPar01 = 0
					Call SelectMT()  ! Ввод нового сообщения, выбираем тип
				Else
					Set nSwRef = nPar01
					! Загружаем сообщение
					Call LoadMessage(nNewMt)
					! Можно менять тип сообщения прямо в редактировании !!!
					If (GetGlobalOptionEx('SWTMSGCT')=1)
						Call SalEnableWindow(pbChangeMT)
					Else
						Call SalDisableWindow(pbChangeMT)
					Call SalDisableWindow(pbNewMsg)
					Call SalDisableWindow(pbSrcMsg)
				Call InitHideControls()
				Set nFunction = 0x000F
			On SAM_CreateComplete
				Call SalWaitCursor(FALSE)
			! On SAM_Close
				 Call SalDestroyWindow(hWndForm)
	Table Window: tblChkLAU		! 23
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Импортированные сообщения без аутентификации
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7409
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7410
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7411
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: cpb_Timer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.9"
						Top:    0.135"
						Width:  1.2"
						Width Editable? Class Default
						Height: 0.292"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call cpb_Timer.Init(nInterval, 0, TRUE)
						On UM_TimerFired
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Contents
			Column: cLAUAct
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Разрешить
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Check Box
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_AnyEdit
						If cLAUAct
							Set cLAURej = 0
			Column: cLAURej
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Запретить
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Check Box
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_AnyEdit
						If cLAURej
							Set cLAUAct = 0
			Column: cSwRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: SWREF
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cMt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: MT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cTrn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф сообщ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cCurr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cSender
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: BIC отправ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cReceiver
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: BIC получ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAmnt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDateIn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата вх
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			Boolean: bCreateWindow
			Number: nInterval
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tblChkLAU.cTWndTitle'))
				Call SetWindowFullSize(hWndForm)
				Call PrepareWindowEx(hWndForm)
				If NOT SqlPLSQLCommand(hSql(), "SWIFT_ADM.SET_LAU_CHECK('ejGBlgewrB@', 0)")
					Call SalDestroyWindow(hWndForm)
					Return TRUE
				Set bCreateWindow = TRUE
				Set nInterval = 300
				Set hWndForm.tblChkLAU.nFlags = GT_NoIns |GT_NoDel
				Set hWndForm.tblChkLAU.fFilterAtStart = TRUE
				Set hWndForm.tblChkLAU.strFilterTblName = "v_sw_auth_messages"
				Set hWndForm.tblChkLAU.strSqlPopulate =
						"SELECT lau_act, swref, mt, io_ind, trn, 
						        currency, sender, receiver, amount/100, date_in 
						   INTO :hWndForm.tblChkLAU.cLAUAct, :hWndForm.tblChkLAU.cSwRef, 
						        :hWndForm.tblChkLAU.cMt, :hWndForm.tblChkLAU.cIO, 
						        :hWndForm.tblChkLAU.cTrn, :hWndForm.tblChkLAU.cCurr, 
						        :hWndForm.tblChkLAU.cSender, :hWndForm.tblChkLAU.cReceiver, 
						        :hWndForm.tblChkLAU.cAmnt, :hWndForm.tblChkLAU.cDateIn 
						   FROM v_sw_auth_messages"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Call VisTblAutoSizeColumn(hWndForm, cLAUAct)
				Call VisTblAutoSizeColumn(hWndForm, cLAURej)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If hWndForm.tblChkLAU.cLAUAct OR hWndForm.tblChkLAU.cLAURej
						If NOT SqlPLSQLCommand(hSql(), "SWIFT.PROCESS_AUTH_MESSAGE(tblChkLAU.cSwRef, tblChkLAU.cLAUAct)")
							Call SqlRollbackEx(hSql(), "SWIFT.LAU. Ошибка выполнения процедуры SWIFT.PROCESS_AUTH_MESSAGE для сообщения " || Str(hWndForm.tblChkLAU.cSwRef))
							Break
						Else
							Call SqlCommitEx(hSql(), "SWIFT.LAU. Сообщение " || Str(hWndForm.tblChkLAU.cSwRef) || " " || 
									  IifS(hWndForm.tblChkLAU.cLAUAct=1, "авторизуется для дальнейшей обработки", "удалено"))
				Call SalSendMsg(hWndForm, UM_Populate, 0,0 )
			On SAM_DoubleClick
				If SalTblAnyRows(hWndForm, ROW_Selected, 0)
					Call SWIFTMsgView(hWndMDI, hWndForm.tblChkLAU.cSwRef)
			On SAM_Destroy
				Set bStart = TRUE
				If bCreateWindow
					Call SqlPLSQLCommand(hSql(), "SWIFT_ADM.SET_LAU_CHECK('ejGBlgewrB@', 1)")
	Form Window: frmCheckMsg
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.9"
				Width Editable? Yes
				Height: 5.845"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblMsgList
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  9.5"
						Width Editable? Yes
						Height: 3.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: cSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Референс
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип
								сообщения
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cSndr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отправитель
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.567"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cRcvr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Получатель
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.483"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: SWIFT
								референс
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cCurr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Валюта
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cAmnt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cDocRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Референс
								документа
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cEditStatus
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					: cF		! фильтр
						Class: cGenFilter
					: cQry		! основная строка населения
						Class: cGenQuery
					Number: nFocusRow
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowSize( hWndForm, wParam-6, SalNumberRound( 0.6*lParam ))
					On SAM_DoubleClick
						Call ShowMsg(tblMsgList.cSwRef)
					On UM_Update
						Call SalCreateWindow(frmMT, hWndForm, tblMsgList.cSwRef, '', '')
					On WM_Populate
						Call SalWaitCursor( TRUE )
						! Заполняем список сообщений
						Call tblMsgList.cQry.Init( T( strMsgListSelect ))
						Set strMsgListSelect = cQry.GetFullSQLString( cF )
						Call tblMsgList.cF.Init( 'V_SW_USER_VISA_MSG', 'q' )
						Call SalTblPopulate( hWndItem, hSql(), T(strMsgListSelect), TBL_FillNormal )
						! Выставляем размеры столбцов
						Call VisTblAutoSizeColumn( hWndItem, cSwRef )
						Call VisTblAutoSizeColumn( hWndItem, cMT )
						Call VisTblAutoSizeColumn( hWndItem, cSndr )
						Call VisTblAutoSizeColumn( hWndItem, cRcvr )
						Call VisTblAutoSizeColumn( hWndItem, cTrn )
						Call VisTblAutoSizeColumn( hWndItem, cAmnt )
						Call VisTblAutoSizeColumn( hWndItem, cDocRef )
						! Устанавливаем фокус на первую строку
						Call SalTblSetContext( tblMsgList, TBL_MinRow )
						Call SalSendMsg(tblCheckMarks, WM_Populate, 0, 0 )
						If tblMsgList.cEditStatus = 1
							Call SalEnableWindow(pbEdit)
						Else
							Call SalDisableWindow(pbEdit)
						!
						Call SalWaitCursor( FALSE )
					On SAM_Create
						Call SalPostMsg(tblMsgList, WM_Populate, 0, 0 )
					On SAM_RowSetContext
						! Call Debug('RowSetContext fired...' || NumberToStr(cDocRef))
						Call SalSendMsg( tblCheckMarks, WM_Populate, 0, 0)
						! Нужно позаботиться о кнопке редактирования
						If tblMsgList.cEditStatus = 1
							Call SalEnableWindow(pbEdit)
						Else
							Call SalDisableWindow(pbEdit)
			Child Table: tblCheckMarks
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   5.283"
						Top:    3.405"
						Width:  6.0"
						Width Editable? Yes
						Height: 1.573"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: cChkGrp
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Группа контроля
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.017"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cChkUsr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Исполнитель
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cChkMarkId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nTX1
					Number: nTY1
					Number: nTX2
					Number: nTY2
					String: strChkMarkSelect
				Message Actions
					On UM_ParentSize
						Call GetWindowRect( hWndForm, nTX1, nTY1, nTX2, nTY2 )
						Call XSalSetWindowPos( hWndForm, wParam - (nTX2 - nTX1) - 3, SalNumberRound(0.6*lParam + 40))
					On WM_Populate
						! Call Debug('ChkMark begin populate...')
						Call SalTblReset( tblCheckMarks )
						Call SetTblRowColor( tblCheckMarks, COLOR_DarkBlue )
						! Call Debug('Step 1')
						Set strChkMarkSelect ="
								select decode(markid, 0, mark, checkgroup), decode(markid, 0, username, 1, username, mark),  markid
								   into :cChkGrp, :cChkUsr, :cChkMarkId
								  from v_visalist where ref = :tblMsgList.cDocRef"
						! Call Debug('Step 2')
						Call SalTblPopulate( hWndItem, hSql(), T(strChkMarkSelect), TBL_FillNormal )
						! Call Debug('Step 3')
						! Set nDocChkMark = tblMsgList.cDocRef
					On SAM_FetchRowDone
						If cChkMarkId = 0 or cChkMarkId = 1
							Call SetTblRowColor( tblCheckMarks, COLOR_DarkBlue )
						Else
							Call SetTblRowColor( tblCheckMarks, COLOR_DarkGreen )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbDelete
				Property Template:
				Class DLL Name:
				Title: Вернуть
				Window Location and Size
					Left:   2.683"
					Top:    4.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 181, SalNumberRound( 0.6 * lParam + 100 ))
					On SAM_Click
						!
							! Будут визированы все отмеченные документы. Продолжать?
						Call SalWaitCursor(TRUE)
						If MessageQuestion(CurrentLangTable.GetAtomTitle('frmCheckMsg.cTMessQuestionBack')) = IDYES
							! Если документ сторнируется, запрашиваем причину
							If nPar = 0
								Set strBackReasonId = ''
								Set strBackReason = ''
								If FunNSIGet('BP_REASON', '', strBackReasonId,  strBackReason)
									If strBackReasonId and strBackReason
										Set nNextRow = TBL_MinRow
										Set nBackReasonId = Val(strBackReasonId)
										While SalTblFindNextRow(tblMsgList, nNextRow, ROW_Selected, 0)
											Call SalTblFetchRow(tblMsgList, nNextRow)
											If SqlPLSQLCommand(hSql(), "bars_swift.msgchk_put_checkstamp( tblMsgList.cDocRef, tblMsgList.cSwRef, nChkGrpId, 0, nBackReasonId)")
												Call SqlCommit(hSql())
												Call SaveInfoToLog( "Завизировано сообщение SwRef = " || Str(tblMsgList.cSwRef) )
											Else
												Call SqlRollback( hSql() )
									Else
										Call SalMessageBeep(MB_IconStop)
										! Call SalMessageBox('Причина отказа не была выбрана или пуста! Повторите операцию.',
												    'Сторно документов, ошибка', MB_IconStop)
										Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmCheckMsg.cTErrReason'),
												  CurrentLangTable.GetAtomTitle('frmCheckMsg.cTErrStorno'), MB_IconStop)
								Else
									Call SalMessageBeep(MB_IconStop)
									! Call SalMessageBox(
											     'Причина отказа не была выбрана или пуста! Повторите операцию.',
											     'Сторно документов, ошибка', MB_IconStop)
									Call SalMessageBox(CurrentLangTable.GetAtomTitle(
											     'frmCheckMsg.cTErrReason'), CurrentLangTable.GetAtomTitle(
											     'frmCheckMsg.cTErrStorno'), MB_IconStop)
							Else ! Возврат на одну визу назад
								Set nNextRow = TBL_MinRow
								While SalTblFindNextRow(tblMsgList, nNextRow, ROW_Selected, 0)
									Call SalTblSetContext(tblMsgList, nNextRow)
									If SqlPLSQLCommand(hSql(), "bars_swift.msgchk_put_checkstamp( tblMsgList.cDocRef, tblMsgList.cSwRef, nChkGrpId, 0, -1 )")
										Call SqlCommit(hSql())
										Call SaveInfoToLog( "Завизировано сообщение SwRef = " || Str(tblMsgList.cSwRef) )
									Else
										Call SqlRollback( hSql() )
							!
							Call SalSendMsg(tblMsgList, WM_Populate, 0, 0)
							Call SalWaitCursor(FALSE)
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Выход
				Window Location and Size
					Left:   3.983"
					Top:    4.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 276, SalNumberRound( 0.6 * lParam + 100 ))
					On SAM_Click
						Call SalDestroyWindow( hWndForm )
			Pushbutton: pbDoc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbDetail
				Property Template:
				Class DLL Name:
				Title: Документ
				Window Location and Size
					Left:   1.383"
					Top:    4.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 86, SalNumberRound( 0.6 * lParam + 100 ))
					On SAM_Click
						Call DocViewContentsEx(hWndItem, tblMsgList.cDocRef)
			Pushbutton: pbEdit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbEdit
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.083"
					Top:    4.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 6, SalNumberRound( 0.6 * lParam + 100 ))
					On SAM_Click
						Call SalSendMsg(tblMsgList, UM_Update, 0, 0)
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			Pushbutton: pbFilter
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbFilter
				Property Template:
				Class DLL Name:
				Title: Фильтр
				Window Location and Size
					Left:   0.083"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 6, SalNumberRound( 0.6 * lParam + 40 ))
					On SAM_Click
						If SetQueryFilter( tblMsgList.cF ) OR fFirstLoad
							Call SalPostMsg( tblMsgList, WM_Populate, 0, 0 )
							If fFirstLoad
								Set fFirstLoad = FALSE
			Pushbutton: pbPrint
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbPrint
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.383"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 86, SalNumberRound( 0.6 * lParam + 40 ))
					On SAM_Click
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( tblMsgList, nRow, ROW_Selected, 0 )
							Call SalTblSetContext( tblMsgList, nRow )
							Call DocsPrint( tblMsgList.cSwRef, 'oper', 0 )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Виза
				Window Location and Size
					Left:   2.683"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 181, SalNumberRound( 0.6 * lParam + 40 ))
					On SAM_Click
						!
							! Будут визированы все отмеченные документы. Продолжать?
						If MessageQuestion(CurrentLangTable.GetAtomTitle('frmCheckMsg.cTMessQuestionVisa')) = IDYES
							Call SalWaitCursor(TRUE)
							Set nNextRow = TBL_MinRow
							While SalTblFindNextRow(tblMsgList, nNextRow, ROW_Selected, 0)
								Call SalTblSetContext(tblMsgList, nNextRow)
								If SqlPLSQLCommand(hSql(), "bars_swift.msgchk_put_checkstamp( tblMsgList.cDocRef, tblMsgList.cSwRef, nChkGrpId, 1, NUMBER_Null )")
									Call SqlCommit(hSql())
									Call SaveInfoToLog( "Завизировано сообщение SwRef = " || Str(tblMsgList.cSwRef) )
								Else
									Call SqlRollback( hSql() )
							!
							Call SalSendMsg(tblMsgList, WM_Populate, 0, 0)
							Call SalWaitCursor(FALSE)
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.983"
					Top:    4.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ParentSize
						Call XSalSetWindowPos( hWndItem, 276, SalNumberRound( 0.6 * lParam + 40 ))
					On SAM_Click
						Call SalSendMsg( tblMsgList, WM_Populate, 0, 0 )
		Functions
			Function: ShowMsg
				Description: Показывает текст сообщения
				Returns
				Parameters
					Number: nSwRef
				Static Variables
				Local variables
				Actions
					Call SalCreateWindow(frm_SWIFTDoc, hWndForm, nSwRef)
			Function: ShowDoc
				Description: Показывает привязанный к сообщению документ
				Returns
				Parameters
					Number: nSwRef
				Static Variables
				Local variables
				Actions
					Call SalCreateWindow(frm_SWIFTDoc, hWndForm, nSwRef)
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nW
			Number: nH
			Number: npW
			Number: npH
			!
			Boolean: fFirstLoad
			Number: nRow
			String: strMsgListSelect      ! Заполнение списка сообщений
			Number: nChkGrpId           !  Номер группы контроля   
			String: strChkGrpId             ! Номер группы контроля (шестнадцатиричное представление)
			String: strCheckerName     ! Наименование группы контроля
			Number: nNextRow
			Number: nDocChkMark
			String: strBackReasonId     ! Код причины возврата
			String: strBackReason        ! Причина возврата
			Number: nBackReasonId
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				!
				! Получаем код группы визирования
				Set nChkGrpId = SalModalDialog(dlg_SwChkGrpSelect, hWndForm, NUMBER_Null)
				If nChkGrpId = -1
					Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmCheckMsg.cTMsgNotChkGrp'), '', MB_IconStop | MB_Ok)
					Call SalDestroyWindow(hWndForm)
					Return TRUE
				Set strChkGrpId = NumberToHexSX(nChkGrpId)
				!
				Set strMsgListSelect = '
						select q.swref, q.mt, q.sender_bic, q.receiver_bic, q.trn, q.currency, q.amount/100, q.ref, editstatus
						   into :cSwRef, :cMT, :cSndr, :cRcvr, :cTrn, :cCurr, :cAmnt, :cDocRef, :cEditStatus
						  from v_sw_user_visa_msg q
						 where q.nextvisagrp = :strChkGrpId'
				!
				Call SqlPrepareAndExecute(hSql(), '
						     SELECT grpname
						     INTO :strCheckerName
						     FROM v_sw_user_visa
						     WHERE grpid=:nChkGrpId')
				Call SqlFetchNext(hSql(), nFetchRes)
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frmCheckMsg.cTWndTitle')|| ': [ ' || strCheckerName || ' ]')
				Call PrepareWindowEx(hWndForm)
				Set fFirstLoad = TRUE
			On WM_Size
				Call GetWindowRect( hWndForm, nW, nH, npW, npH )
				If npW - nW < 750
					Call XSalSetWindowSize( hWndForm, 750, npH - nH )
				Call GetClientRect( hWndForm, nW, nH, npW, npH )
				Call SalSendMsgToChildren( hWndForm, UM_ParentSize, npW, npH )
				!
				Call SalInvalidateWindow( hWndForm )
	Dialog Box: dlg_SwChkGrpSelect
		Class:
		Property Template:
		Class DLL Name:
		Title: Группы контроля платежей
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.357"
				Width Editable? Yes
				Height: 2.656"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Выбор группы контроля
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			List Box: lbGroupsCheck
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.086"
					Top:    0.083"
					Width:  5.1"
					Width Editable? Yes
					Height: 1.396"
					Height Editable? Yes
				Visible? Yes
				Multiple selection? No
				Sorted? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: 8
				Font Enhancement: Default
				Text Color: Default
				Background Color: System Window Color
				Horizontal Scroll? No
				List Initialization
				Message Actions
					On SAM_Create
						Set nIterator = 0
						Loop
							If nIterator >= nGrpNum
								Break
							Call SalListAdd(hWndItem, strGrpArray[nIterator,0])
							Set nIterator = nIterator + 1
						Call SalListSetSelect(hWndItem, 0)
					On SAM_DoubleClick
						Call SalSendMsg(pbSelect, SAM_Click, 0, 0)
			Pushbutton: pbSelect
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   0.586"
					Top:    1.688"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm,
								     SalStrToNumber(strGrpArray[
								     SalListQuerySelection(lbGroupsCheck), 1]))
			Pushbutton: pbAbort
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   3.214"
					Top:    1.688"
					Width:  1.5"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, -1)
		Functions
		Window Parameters
			Number: nUserId
		Window Variables
			String: strGrpArray[*,2]
			Number: nGrpNum
			Number: nIterator
			!
			String: strGrpName
			Number: nGrpId
			!
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SwChkGrpSelect.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Set nGrpNum = 0
				Call SqlPrepareAndExecute(hSql(), '
						     SELECT grpid, grpname
						     INTO :nGrpId,:strGrpName
						     FROM v_sw_user_visa
						     ORDER BY 2')
				While SqlFetchNext(hSql(), nFetchRes)
					Set strGrpArray[nGrpNum,0] = strGrpName
					Set strGrpArray[nGrpNum,1] = SalNumberToStrX(nGrpId, 0)
					Set nGrpNum = nGrpNum + 1
				If nGrpNum = 1
					Call SalEndDialog(hWndForm, SalStrToNumber(strGrpArray[0, 1]))
				If nGrpNum = 0
					Call SalEndDialog(hWndForm, -1)
	Form Window: splSearchMsg		! 19 
.data CLASSPROPSSIZE
0000: 3A00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 000000000000C0C0 C000FFFFFF008080
0020: 8000020000000000 0000010000000100 0000000000000001 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
		Class: cSplitterWindow
		Property Template:
		Class DLL Name:
		Title: Поиск сообщений
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.146"
				Width:  10.0"
				Width Editable? Class Default
				Height: 4.893"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Поиск сообщений
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSearchMsg.cBTipRefresh')
						On SAM_Click
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSearchMsg.cBTipFilter')
						On SAM_Click
							If SetQueryFilter(tbl.F)
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSearchMsg.cBTipDetail')
						On SAM_Click
							Call SalSendMsg(tbl, UM_DoubleClick, 0, 0)
				Line
					Resource Id: 56502
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  9.117"
						Begin Y:  0.071"
						End X:  9.117"
						End Y:  0.536"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 56506
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  1.583"
						Begin Y:  0.012"
						End X:  1.583"
						End Y:  0.476"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.233"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Esc
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('splSearchMsg.cBTipExit')
						On SAM_Click
							Call SalSendMsg( hWndForm, UM_Close, 0, 0)
				Data Field: dfText
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.183"
							Top:    0.06"
							Width:  5.8"
							Width Editable? Yes
							Height: 0.3"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Содержит текст
					Resource Id: 56505
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
		Contents
			Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cSplitterWindow
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    3.323"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: White
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? No
				Contents
					Column: cSwRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cIO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вх/Исх
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Center
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: cMT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип
								
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cTrn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: SWIFT
								референция
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.257"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cSndr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отправитель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.814"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cRcvr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Получатель
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cCurr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cAmnt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: ########000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								валютир
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.083"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								отправки
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								регистр
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDatP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								оплаты
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.067"
						Width Editable? Yes
						Format: dd-MM-yyyy
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: cDocRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф
								документа
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlInit              ! Начальная строка запроса 
					String: strSqlPopulate     ! Строка запроса
					: Q
						Class: cGenQuery
					: F
						Class: cGenFilter
					Boolean: bFirstCall
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						! Устанавливаем флаг
						Set bFirstCall = TRUE
						! Формируем строку запроса
						Set strSqlPopulate =
								"select swref, io_ind, mt, trn, sender, receiver,
								        currency, amount/100, date_rec, date_pay, vdate, ref
								   into :tbl.cSwRef, :tbl.cIO, :tbl.cMT, :tbl.cTrn, :tbl.cSndr, :tbl.cRcvr, 
								        :tbl.cCurr, :tbl.cAmnt, :tbl.cDatR, :tbl.cDatP, :tbl.cDatV, :tbl.cDocRef
								   from v_sw_searchmsg
								  where bars_swift.get_message_condition(swref, :dfText) = 1"
						! Если в строке вызова задан фильтр, устанавливаем его
						If strFilter != STRING_Null
							Set strSqlPopulate = strSqlPopulate || PutCrLf() || ' where ' || strFilter
						! Применяем фильтр
						Call Q.Init(strSqlPopulate)
						Call F.Init("V_SW_SEARCHMSG", "V_SW_SEARCHMSG")
						! Населяем представление
						Call SalPostMsg(hWndItem, UM_Populate, 0, 0)
					On UM_Populate
						! При первом вызове вызываем форму установки фильтра
						If bFirstCall
							Set bFirstCall = FALSE
							Call SetQueryFilter(F)
						Call SalWaitCursor(TRUE)
						! Применяем фильтр
						Call SalTblPopulate(hWndItem, hSql(), T(Q.GetFullSQLString(F)), TBL_FillAll)
						! Устанавливаем размеры столбцов по их наполнению
						Call VisTblAutoSizeColumn(hWndItem, cSwRef)
						Call VisTblAutoSizeColumn(hWndItem, cIO)
						Call VisTblAutoSizeColumn(hWndItem, cMT)
						Call VisTblAutoSizeColumn(hWndItem, cTrn)
						Call VisTblAutoSizeColumn(hWndItem, cCurr)
						Call VisTblAutoSizeColumn(hWndItem, cAmnt)
						Call VisTblAutoSizeColumn(hWndItem, cDatV)
						Call VisTblAutoSizeColumn(hWndItem, cDatO)
						Call VisTblAutoSizeColumn(hWndItem, cDatR)
						Call VisTblAutoSizeColumn(hWndItem, cDatP)
						! Устанавливаем фокус на первую строку
						Call SalTblSetContext(hWndItem, 0)
						Call SalTblSetFocusRow(hWndItem, 0)
						Call SalTblSetRowFlags(hWndItem, 0, ROW_Selected, TRUE)
						Call SalSendMsg(hWndItem, SAM_TblDoDetails, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_DoubleClick
						Call ShowMessage(cSwRef)
					On SAM_TblDoDetails
						Call ShowMessageDetail(cSwRef)
			Multiline Field: mlBody
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.033"
						Top:    3.393"
						Width:  9.8"
						Width Editable? Yes
						Height: 0.464"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 10
					Font Enhancement: None
					Text Color: Default
					Background Color: Gray
				Message Actions
		Functions
			Function: ShowMessageDetail
				Description: Функция показывает тело сообщения в нижней части формы
				Returns
				Parameters
					Number: nSwRef
				Static Variables
				Local variables
					String: strTag
					String: strOpt
					Long String: strValue
				Actions
					If (nSwRef)
						Set mlBody = 'From: ' || tbl.cSndr 
						Set mlBody = mlBody || PutCrLf() || 'To  : ' || tbl.cRcvr
						Set mlBody = mlBody || PutCrLf()
						If SqlPrepareAndExecute(hSql(),T(
								"select tag, opt, value into :strTag,:strOpt,:strValue
								   from sw_operw where swref = :nSwRef order by n"))
							While SqlFetchNext(hSql(), nFetchRes)
								Set mlBody=mlBody || PutCrLf() || SalStrRightX('  ' || strTag || strOpt || ': ', 6) || VisStrSubstitute(strValue, PutCrLf(), PutCrLf() || '      ')
					Else
						Set mlBody = ''
			Function: ShowMessage
				Description: Функция показывает сообщение в отделном окне
				Returns
				Parameters
					Number: nSwRef
				Static Variables
				Local variables
				Actions
					! Call SalCreateWindow(frm_SWIFTDoc, hWndForm, nSwRef)
					If (tbl.cDocRef != NUMBER_Null)
						Call DocViewContentsEx(hWndForm, tbl.cDocRef)
					Else
						Call SalCreateWindow(frm_SWIFTDoc, hWndForm, nSwRef)
		Window Parameters
			Number: nPar01
			String: strPar02
			String: strPar03
		Window Variables
			String: strFilter
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('splSearchMsg.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				! В протокол сообщение о начале работы
				Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('splSearchMsg.cTBegFunc'))
				! Установленный фильтр
				Set strFilter = strPar02
				Call SalWaitCursor(FALSE)
			! On SAM_CreateComplete
				                                 Call SalSendClassMessage(SAM_CreateComplete, wParam, lParam)
			On UM_Close
				Call SalDestroyWindow(hWndForm)
			On SAM_Destroy
				Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('splSearchMsg.cTEndFunc') )
	Form Window: frm_SWBack
		Class:
		Property Template:
		Class DLL Name:
		Title: Удаление привязки документа
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.45"
				Width Editable? Yes
				Height: 2.6"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Референс:
				Resource Id: 42110
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.5"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Frame
				Resource Id: 42111
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.15"
					Width:  4.9"
					Width Editable? Yes
					Height: 0.9"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Frame
				Resource Id: 42112
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.2"
					Width:  4.9"
					Width Editable? Yes
					Height: 0.905"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Data Field: dfRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    0.45"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbSearch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledSearch
				Property Template:
				Class DLL Name:
				Title: Искать
				Window Location and Size
					Left:   0.45"
					Top:    1.42"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sSWRef = ""
						Set nCount = 0
						If SqlPrepareAndExecute(hSql(), 
								"select swref into :nSWRef from sw_oper where ref=:dfRef")
							While SqlFetchNext(hSql(), nFetchRes)
								Set sSWRef = IifS(sSWRef="", Str(nSWRef), sSWRef || ", " || Str(nSWRef))
								Set nCount = nCount + 1
							If nCount > 0
								Call DocViewContentsEx(hWndMDI, dfRef)
								Call SalEnableWindow(pbBack)
							Else
								Call SalDisableWindow(pbBack)
								! Call SalMessageBox("Документ не найден!", "Сообщение", MB_IconAsterisk | MB_Ok)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessDocNotFound'), 
										     CurrentLangTable.GetAtomTitle('cTMess'), MB_IconExclamation | MB_Ok)
			Pushbutton: pbBack
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Отвязать
				Window Location and Size
					Left:   2.03"
					Top:    1.42"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! If SalMessageBox("Удалить привязку доумента " || Str(dfRef) || PutCrLf() || 
								   " к сообщению " || sSWRef || " ?" ,
								   "Вопрос", MB_YesNo | MB_IconHand) = IDYES
						If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessDel') || " " || Str(dfRef) || PutCrLf() || 
								   " " || CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessForMessage') || " " || sSWRef || " ?" ,
								   CurrentLangTable.GetAtomTitle('cTQuestion'), MB_IconQuestion | MB_YesNo) = IDYES
							If SqlPLSQLCommand(hSql(), "bars_swift.document_unlink(dfRef)")
								Call SqlCommitEx(hSql(), "SWIFT. " || CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessCommit') || " " || Str(dfRef) || " " ||
										     CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessForMessage') || " " || sSWRef)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessCommit') || " " || Str(dfRef) || " " ||
										     CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessForMessage') || " " || sSWRef, 
										     CurrentLangTable.GetAtomTitle('cTMess'), MB_IconAsterisk | MB_Ok)
							Else
								Call SqlRollbackEx(hSql(), "SWIFT. " || CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessRollback') || " " || Str(dfRef) || " " ||
										     CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessForMessage') || " " || sSWRef)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessRollback') || " " || Str(dfRef) || " " || 
										     CurrentLangTable.GetAtomTitle('frm_SWBack.cTMessForMessage') || " " || sSWRef, 
										     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation | MB_Ok)
						Call SalDisableWindow(pbBack)
						Call SalSetFocus(dfRef)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.6"
					Top:    1.42"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
		Functions
		Window Parameters
		Window Variables
			Number: nSWRef
			String: sSWRef
			Number: nCount
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_SWBack.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				!
				Call SalDisableWindow(pbBack)
				Call SalSetFocus(dfRef)
	Dialog Box: dlg_PickUpDocStmt		! 02
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Подбор документа для квитовки...
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.5"
				Width Editable? Class Default
				Height: 5.274"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Выбрать документы для квитовки выписки.
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6969
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6970
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! SAM_Click
						On SAM_Click
							! Call WaitCursorOn()
							! Set strRefs = 'null'
							! Set nRow = TBL_MinRow
							! Call Debug("REtVal2")
							! While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
								                                          Call SalTblFetchRow(tbl, nRow)
								                                          Set strRefs = strRefs || ','  || SalNumberToStrX(tbl.colRef, 0)
							! Call SalEndDialog(hWndForm, 1)
							Call ReturnValue()
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6971
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbViewDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.667"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cBTipViewDoc')
						On SAM_Click
							Call DocViewContentsEx( hWndForm, tbl.colRef )
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  10.417"
						Width Editable? Class Default
						Height: 4.357"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Референс
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.017"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colVDat
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								валютир.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.117"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNlsA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Счет А
						Visible? Yes
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSum
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.667"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCcy
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Валюта
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNlsB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Cчет Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Д/К
						Visible? Yes
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Center
						Width:  0.433"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNazn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назначение платежа
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDig
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						! Присваиваем значения многоязыковым объектам
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						!
						Call SalSendClassMessage( UM_Create, 0, 0 )
					On UM_Populate
						If dlg_PickUpDocStmt.strSqlPopulate != ''
							! If pbPreFilter
								! Call cQ.Init( dlg_PickUpDocStmt.strSqlPopulate || ' AND ' || strAddWhere || strOutFilter || ')' )
								                                               Call cQ.Init( dlg_PickUpDocStmt.strSqlPopulate)
							! Else 
								                                               Call cQ.Init( dlg_PickUpDocStmt.strSqlPopulate || ' AND ' || strAddWhere || ')')
							Call cQ.Init( dlg_PickUpDocStmt.strSqlPopulate)
							Call SalWaitCursor( TRUE )
							Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
							Set strDSql = cQ.GetFullSQLString( cF )
							Call SalTblPopulate( hWndForm, cMain.hSql(), T(strDSql), TBL_FillNormal )
							Call SalTblSetContext( hWndForm, 0 )
							Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor( FALSE )
					On UM_DoubleClick
						Call ReturnValue()
		Functions
			Function: ReturnValue
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call WaitCursorOn()
					Set strRefs = 'null'
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblFetchRow(tbl, nRow)
						Set strRefs = strRefs || ','  || SalNumberToStrX(tbl.colRef, 0)
					Call SalEndDialog(hWndForm, 1)
		Window Parameters
			Number: nAccCode
			Number: nDk
			Date/Time: dtDocMin
			Date/Time: dtDocMax
			Number: nAmount
			Receive String: strRefs
		Window Variables
			!
			Number: nRow
		Message Actions
			On SAM_Create
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_PickUpDoc.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				!
				Set dlg_PickUpDocStmt.nFlags = GT_ReadOnly
				Set dlg_PickUpDocStmt.strFilterTblName = 'V_SW950_DOC'
				!
				Set dlg_PickUpDocStmt.fFilterAtStart=1
				!
				! Set strAddWhere  = 'fdat BETWEEN SYSDATE-10 AND SYSDATE+10 '
				! Set strOutFilter = 'AND OPLDOK.s = :dlg_PickUpDoc.Amnt'
				! If AccDb
					                                               Set strAccDWhere = '(OPLDOK.acc = :dlg_PickUpDoc.AccDb AND OPLDOK.dk = 0)'
				! If AccKr
					                                               Set strAccKWhere = '(OPLDOK.acc = :dlg_PickUpDoc.AccKr AND OPLDOK.dk = 1)'
				! If strAccDWhere OR strAccKWhere
					                                               Set strOutFilter = strOutFilter || ' AND ('
					                                               If strAccDWhere
						                                               Set strOutFilter = strOutFilter || strAccDWhere
					                                               If strAccKWhere
						                                               If strAccDWhere
							                                               Set strOutFilter = strOutFilter || ' OR '
						                                               Set strOutFilter = strOutFilter || strAccKWhere
					                                               Set strOutFilter = strOutFilter || ')'
				!
				Set dlg_PickUpDocStmt.strSqlPopulate = 
						'select ref, fdat, null, null, s/100, null, null, dk, detail 
						 into :tbl.colRef, :tbl.colVDat, :tbl.colNlsA, :tbl.colNlsB, :tbl.colSum,
						      :tbl.colCcy, :tbl.colDig, :tbl.colDK, :tbl.colNazn 
						 from v_sw950_doc
						 where fdat between :dtDocMin and :dtDocMax and acc = :nAccCode and dk=:nDk and s<=:nAmount'
				Call SalSendClassMessage( SAM_Create, 0, 0 )
	Dialog Box: dlgSwtCov         ! Выбор банка - получателя исходного сообщения
		Class:
		Property Template:
		Class DLL Name:
		Title: Справочник МФО
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Type of Dialog: Modal
			Window Location and Size
				Left:   1.638"
				Top:    0.24"
				Width:  6.214"
				Width Editable? Yes
				Height: 4.857"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: System Window Color
		Description: Формирование сообщения с покрытием
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? No
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: bgSearchStr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   3.317"
					Top:    3.893"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SqlPLSQLCommand(hSql(), "bars_swift_msg.docmsg_document_set103covhdr(nRefNos, df103RcvBic, df202RcvBic)")
						Call SalEndDialog(hWndForm, TRUE)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.667"
					Top:    3.893"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
			Group Box: Исходное сообщение (MT103)
				Resource Id: 20939
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.155"
					Width:  5.7"
					Width Editable? Yes
					Height: 1.75"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Group Box: Сообщение покрытия (MT202)
				Resource Id: 20940
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    1.988"
					Width:  5.7"
					Width Editable? Yes
					Height: 1.75"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Отправитель
				Resource Id: 20941
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    0.429"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Получатель
				Resource Id: 20942
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    1.179"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: df103SndBic
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    0.429"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: df103SndName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.738"
						Width:  5.3"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: df103RcvBic
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    1.179"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: df103RcvName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    1.488"
						Width:  5.3"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbFind103Rcv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.25"
					Top:    1.179"
					Width:  0.4"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call FunNSIGet('sw_banks', 'name', df103RcvBic, df103RcvName)
			Pushbutton: pbFind103Snd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.25"
					Top:    0.429"
					Width:  0.4"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Background Text: Отправитель
				Resource Id: 20943
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    2.286"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: df202SndBic
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    2.286"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbFind202Snd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.25"
					Top:    2.286"
					Width:  0.4"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: df202SndName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    2.595"
						Width:  5.3"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Получатель
				Resource Id: 20944
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    2.952"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: df202RcvBic
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    2.952"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbFind202Rcv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.25"
					Top:    2.929"
					Width:  0.4"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: df202RcvName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    3.262"
						Width:  5.3"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
			Number: nDocRef
		Window Variables
			! String: strCond
			! String: strOurMfo
			Number: nWidth
			Number: nHeight
			! Number: nX
			! Number: nY
			! Number: nZ
			! Number: nStat
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				! Call SalGetWindowSize (SalParentWindow (hWndForm), nWidth, nHeight)
				! Call SalSetWindowSize (hWndForm , nWidth, nHeight)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgSwtCov.cTWndTitle'))
				Call SalCenterWindow(hWndForm)
				! Заполняем поля формы
				Call SqlPLSQLCommand(hSql(), "bars_swift_msg.docmsg_document_get103covhdr(nRefNos, df103SndBic, df103SndName, df103RcvBic, df103RcvName, df202RcvBic, df202RcvName)")
				Set df202SndBic = df103SndBic
				Set df202SndName = df103SndName
				Call SalDisableWindow(pbFind103Snd)
				Call SalDisableWindow(pbFind202Snd)
				Call SalDisableWindow(pbFind202Rcv)
			On WM_Size
				Call SalGetWindowSize (hWndForm , nWidth, nHeight)
				Call SalSendMsgToChildren(hWndForm, UM_ParentSize, nWidth, nHeight)
				Call SalInvalidateWindow(hWndForm)
