.head 0 +  Application Description: ПРАВЭКС
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B90000 002C000000030000 00030000004B0000 00C6000000FCFFFF
0040: FFE9FFFFFFFCFFFF FFFEFFFFFF720200 00C3010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D01000000075769 6E646F7773
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001C51 3A5C424152533938 5C4C494252415259 5C4162736170692E
0020: 646C6C1C513A5C42 41525339385C4C49 42524152595C4162 736170692E617063
0040: 00000101011C513A 5C4241525339385C 4C4942524152595C 4162736170692E72
0060: 756E1C513A5C4241 525339385C4C4942 524152595C416273 6170692E646C6C1C
0080: 513A5C4241525339 385C4C4942524152 595C416273617069 2E61706300000101
00A0: 01175C4261727339 385C42696E5C4241 52533032382E6170 64165C4261727339
00C0: 385C42696E5C4162 736170692E646C6C 165C426172733938 5C42696E5C416273
00E0: 6170692E61706300 00010101001C513A 5C4241525339385C 4C4942524152595C
0100: 4162736170692E64 6C6C1C513A5C4241 525339385C4C4942 524152595C416273
0120: 6170692E61706300 00010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0218B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: nsiapi.apd
.head 2 -  File Include: GENFCLS.APL
.head 2 -  File Include: GENBUTN.APL
.head 2 -  File Include: GENLBL.APL
.head 2 -  File Include: GENLBUTN.APL
.head 2 -  File Include: GENLIST.APL
.head 2 -  File Include: GENTBL.APL
.head 2 -  File Include: GENTBLD.APL
.head 2 -  File Include: GENTBLF.APL
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: VTLBX.APL
.head 2 -  File Include: VTTBLWIN.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd/MM/yyyy
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: ApdNum  = '28'
.head 4 -  String: ApdVer  = '00'
.head 4 -  Number: UM_Init = SAM_User + 701
.head 2 +  Resources
.head 3 +  Icon: PIC_Level0
.head 4 -  File Name: \BARS98\RESOURCE\ICO\MONEY.ICO
.head 3 +  Icon: PIC_Level1
.head 4 -  File Name: \BARS98\RESOURCE\ICO\TTS0.ICO
.head 3 +  Icon: PIC_Level2
.head 4 -  File Name: \BARS98\RESOURCE\ICO\TTS1.ICO
.head 3 +  ! Icon: PIC_Folder
.head 4 -    File Name: \BARS98\RESOURCE\ICO\ARW05RT.ICO
.head 3 +  ! Icon: PIC_Root
.head 4 -    File Name: \BARS98\RESOURCE\ICO\ROOTNODE.ICO
.head 3 +  ! Icon: PIC_Base
.head 4 -    File Name: \BARS98\RESOURCE\ICO\BASENODE.ICO
.head 3 +  ! Icon: PIC_Folder
.head 4 -    File Name: \BARS98\RESOURCE\ICO\FOLDER.ICO
.head 3 +  ! Icon: PIC_OpenFolder
.head 4 -    File Name: \BARS98\RESOURCE\ICO\FOLDEROP.ICO
.head 3 +  ! Icon: PIC_Item
.head 4 -    File Name: \BARS98\RESOURCE\ICO\ITEMNODE.ICO
.head 2 +  Variables
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Number: nFetchRes
.head 3 -  Boolean: bApdInited
.head 3 -  Window Handle: hMenuWnd
.head 2 +  Internal Functions
.head 3 +  Function: Ini028
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars028.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile(strFileName, strLangId))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('cTAt', 'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTMessage','Сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('cTQuestion','Вопрос')
.head 7 -  Call CurrentLangTable.AddAtom('cTToLogExit','Выход из диалога')
.head 7 -  ! ====================================================
.head 7 -  ! frmBranch
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cTWndTitle','Редактирование иерархии подразделений')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipInsert','Добавить отделение')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipDelete','Удалить отделение')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipReopen','Переподчинить отделение')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipEditParams','Редактирование параметров отделения')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipRefresh','Обновить')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipUpdate','Сохранить изменения')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cBTipCancel','Выйти')
.head 7 -  ! tblBranch
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.tblBranch.colName','Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.tblBranch.colB040','Код подразделения~по справочнику НБУ')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.tblBranch.colDescr','Комментарий')
.head 7 -  ! tblParams
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.tblParams.colTag','Название~параметра')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.tblParams.colTagName','Наименование~параметра')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.tblParams.colVal','Значение~параметра')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cTMessSave','Сохранить измененные реквизиты подразделения')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cTUpdateBranchOk','Изменение свойств подразделения')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cTUpdateBranchErr','Ошибка выполнения процедуры при изменении свойств подразделения')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cTUpdateBranchParamsOk','Изменение параметров подразделения')
.head 7 -  Call CurrentLangTable.AddAtom('frmBranch.cTUpdateBranchParamsErr','Ошибка выполнения процедуры при изменении параметров подразделения')
.head 7 -  ! ====================================================
.head 7 -  ! dlgBranchReopen
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.cTWndTitle','Перевод отделения')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.pbSave','Выбрать')
.head 7 -  ! tbl
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.tbl.colBranch','Подразделение')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.tbl.colName','Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.tbl.colB040','Код подразделения~по справочнику НБУ')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.tbl.colDescr','Комментарий')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.cTMessReopenBranch','Перевести отделение')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.cTMessToFilial','в подразделение')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.cTMessReopenOk','Переведено отделение')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchReopen.cTErrReopen','Ошибка выполнения процедуры переподчинения отделения')
.head 7 -  ! ====================================================
.head 7 -  ! dlgBranchInsert
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTWndTitle','Добавление отделения')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.pbSave','Сохранить')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.bgBranch','Код подразделения:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.bgB040','Код подразделения (НБУ):')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.bgName','Наименование подразделения:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.bgDescr','Комментарий:')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cBTipGetValue','Выбрать из справочника')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTMessAddBranch','Добавлено отделение')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTMessToFilial','в подразделение')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTMessRekv','Заполнены не все реквизиты!')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTMessBranchInt','Введите числовой код!')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTMessBranch5','Значение должно содержать не менее 5 символов!')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTMessBranch6','Значение должно содержать не менее 6 символов!')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlgBranchInsert.cTErrAddBranch','Ошибка выполнения процедуры при добавлении отделения')
.head 7 -  ! ====================================================
.head 7 -  ! frmSetRates
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTWndTitle','Установка курсов валют')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTWndTitleArc','Архив')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cBTipSetRates','Установить курсы подразделений')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cBTipArcAll','За все дни')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cBTipArcTek','На текущий день')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colKv','Вал.')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colVDate','Дата~установки')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colBSum', 'Базовяа~сумма')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colRateO','Официальный~курс')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colRateB','Курс~покупки')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colRateS','Курс~продажи')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.tblRates.colBranch','Отделение')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTAllBranches','Все подразделения')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessSetRatesQuestionSelKv','Установить курсы подразделений по выбранным валютам на')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessSetRatesQuestionAllKv','Установить курсы подразделений по ВСЕМ валютам на')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessSetRatesErr','Неуспешное выполнение процедуры установки курсов подразделений')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessSetRatesOk','Установлены курсы валют подразделений')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessNotSaveData','В таблице присутствуют несохраненные изменения!')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessNotSaveData_','Перечитайте или сохраните данные.')
.head 7 -  Call CurrentLangTable.AddAtom('frmSetRates.cTMessKvNotSelect','Не выбрана валюта!')
.head 7 -  ! ====================================================
.head 7 -  ! tblShowJobs
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTWndTitle','Управление списком заданий')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cBTipStart','Выполнить задание')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cBTipStop','Остановить задание')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cBTipDetails','Просмотр протокола')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colJobCode','Код~задания')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colJobName','Наименование~задания')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colJobId','ID~задания')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colLastDate','Время последнего~выполнения~задания')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colNextDate','Время следующего~выполнения~задания')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colBroken','Остановлено')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colBrokenName','Остановлено')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colInterval','Интервал')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colFailures','Кол-во~ошибок')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.colWhat','Выполняемая~процедура')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTProcOk','Успешно выполнена процедура')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTProcErr','Неуспешное выполнение процедуры')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTForJob','для задания')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTBrokenYes','Да')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTBrokenNo','Нет')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTJobIsAbsent','Нет в списке заданий')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTJobIsStart','Задание выполняется')
.head 7 -  Call CurrentLangTable.AddAtom('tblShowJobs.cTJobIsStop','Задание остановлено')
.head 7 -  ! ====================================================
.head 6 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\bars028_tst.lng','RUS')
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: Sel028	! __exported
.head 4 -  Description: Bars028_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Ini028()
.head 5 +  Select Case nMode
.head 6 +  Case 0
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow(frmBranch, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin0)
.head 7 -  Break
.head 6 +  Case 1
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(frmSetRates, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin1)
.head 7 -  Break
.head 6 +  Case 2
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2 = SalCreateWindow(tblShowJobs, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin2)
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 3 +  Function: ShowApdVersion
.head 4 -  Description: Показать версию APD
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strText
.head 5 -  Number: nLength
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( strText, 160 )
.head 5 -  Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
.head 5 -  Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
.head 2 +  Named Menus
.head 3 +  Menu: mnMaster
.head 4 -  Resource Id: 40887
.head 4 -  Title: (untitled)
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Контекстный &Поиск
.head 5 -  Resource Id: 40889
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 'Контекстный Поиск'
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call TblFindString(hMenuWnd, 1)
.head 6 -  Call SalSendMsg(hMenuWnd, UM_Init, 0, 0)
.head 6 -  Call SalSendMsg(hMenuWnd, SAM_RowSetContext, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Фильтр
.head 5 -  Resource Id: 40891
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 'Фильтр'
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hMenuWnd, UM_Init, 1, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Показать/спрятать тэг
.head 5 -  Resource Id: 40890
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hMenuWnd, UM_Init, 2, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Закр&ыть
.head 5 -  Resource Id: 40888
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 -  Menu Actions
.head 5 -  Menu Item Name:
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3063301029
0000: D9010000F1000000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F41003C00 000D630052616469
0040: 6F4C69730074426F 7886000000F00500 0000E0010D000000 FF3F0D00B9000100
0060: FFFFE01A00000001 FE00FF8327000000 01FB00FF0F340000 00EE0100FF3F0180
0080: 0022000000010000 00000A6347656E46 696C007465727400 0000047800000002
00A0: 640400000100FFE0 8001000000DF04D8 00010D00FF7F1170 0000000200FFFFC1
00C0: 1500000001FD00FF C701802200000200 00000B6347E34446 69CF00049E000204
00E0: D1000100003F8001 F9000037040001F6 0D00FFDF11DC0002 00FF7F1573000100
0100: FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbBrowse
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 +  Form Window: frmBranch
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.283"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.405"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.4"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbInsert
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Добавить отделение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipInsert')
.head 6 +  On SAM_Click
.head 7 -  Call insertBranch()
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Удалить отделение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipDelete')
.head 6 +  On SAM_Click
.head 7 -  Call deleteBranch()
.head 4 +  Pushbutton: pbReopen
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.967"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Переподчинить отделение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipReopen')
.head 6 +  On SAM_Click
.head 7 -  Call reopenBranch()
.head 4 -  Line
.head 5 -  Resource Id: 16493
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.517"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  1.517"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbEditParams
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbEdit
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.633"
.head 6 -  Top:    0.048"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Редактирование параметров отделения
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipEditParams')
.head 6 +  On SAM_Click
.head 7 -  Call ShowBranchParams()
.head 4 -  Line
.head 5 -  Resource Id: 16494
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.183"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  2.183"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Обновить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(cBranch, SAM_User, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 16495
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.833"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  2.833"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.95"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить изменения
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipUpdate')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(cBranch, UM_Update, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 16496
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.45"
.head 6 -  Begin Y:  -0.06"
.head 6 -  End X:  3.45"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmBranch.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Custom Control: cSplMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  List Box: cBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cOutlineListBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Default
.head 5 -  Top:    Default
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 5.298"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: System Text Color
.head 4 -  Background Color: System Window Color
.head 4 -  Horizontal Scroll? Yes
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg(tblBranch, UM_ObjActivate, 0, 0)
.head 6 -  Call cBranch.SetStyle(LBS_ShowHorzScrollBar | LBS_ShowSelectTextPicture | LBS_VisExtensions | LBS_Explorer | LBS_FmtMixedcase )
.head 6 -  Call SalSendMsg(hWndItem, UM_Populate, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call populateBranch()
.head 5 +  On SAM_Click
.head 6 -  Set nFocusBranch = VisListGetFocusIndex(hWndItem)
.head 6 +  If hCurrentBranch AND (fEditBranch OR fEditParams)
.head 7 -  Call SalSendMsg(hWndItem, UM_Update, 0, 0)
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set hCurrentBranch = cBranch.GetItemHandle(nFocusBranch)
.head 6 -  Set nCurrentBranch = nValue
.head 6 -  Set sCurrentBranch = smBranchList[nCurrentBranch,0]
.head 6 -  Set sCurrentTobo   = smBranchList[nCurrentBranch,4]
.head 6 -  !
.head 6 +  If nParEdit
.head 7 -  Call SalDisableWindow(pbEditParams)
.head 7 -  Call SalDisableWindow(pbUpdate)
.head 7 -  Call SalDisableWindow(tblBranch.colName)
.head 7 -  Call SalDisableWindow(tblBranch.colB040)
.head 7 -  Call SalDisableWindow(tblBranch.colDescr)
.head 7 -  Call SalDisableWindow(tblParams.colVal)
.head 7 +  If Subs(sOurTobo,1,Len(sOurTobo)) = Subs(sCurrentBranch,1,Len(sOurTobo))
.head 8 -  Call SalEnableWindow(tblBranch.colName)
.head 8 -  Call SalEnableWindow(tblBranch.colB040)
.head 8 -  Call SalEnableWindow(tblBranch.colDescr)
.head 8 -  Call SalEnableWindow(tblParams.colVal)
.head 8 -  ! Если редактируем свои пар-ры или
  мы-ГБ и редактируем свои пар-ры или пар-ры филиала (не подразделения)
.head 8 +  If sOurTobo = sCurrentBranch
OR sOurTobo = sMainBranch and cBranch.nLevel < 2
.head 9 -  Call SalEnableWindow(pbEditParams)
.head 6 -  Call SalSendMsg(tblBranch, UM_Populate, 0, 0)
.head 6 -  Call SalSendMsg(tblParams, UM_Populate, 0, 0)
.head 5 +  On SAM_User	! Refrech
.head 6 +  If hCurrentBranch AND (fEditBranch OR fEditParams)
.head 7 -  Call SalSendMsg(hWndItem, UM_Update, 0, 0)
.head 6 -  Call SalSendMsg(hWndItem, UM_Populate, 0, 0)
.head 5 +  On UM_Update
.head 6 -  ! Сохранить измененные реквизиты подразделения smBranchList[nCurrentBranch,4] smBranchList[nCurrentBranch,1] ?
.head 6 +  If IDYES = SalMessageBox(CurrentLangTable.GetAtomTitle('frmBranch.cTMessSave') ||' ' || 
   smBranchList[nCurrentBranch,4] || ' ' || smBranchList[nCurrentBranch,1] || ' ?', 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion)
.head 7 -  Call saveBranch()
.head 6 +  Else
.head 7 +  If fEditBranch
.head 8 -  Set fEditBranch = FALSE
.head 8 -  Set tblBranch.colName  = smBranchList[nCurrentBranch, 1]
.head 8 -  Set tblBranch.colB040  = smBranchList[nCurrentBranch, 2]
.head 8 -  Set tblBranch.colDescr = smBranchList[nCurrentBranch, 3]
.head 7 -  Set fEditParams = FALSE
.head 6 -  Call SalDisableWindow(pbUpdate)
.head 6 -  Call SalTblSetRowFlags(tblBranch, 0, ROW_Edited, FALSE)
.head 6 -  !
.head 6 -  Call SalSetFocus(hWndItem)
.head 6 -  Call VisListSetFocusIndex(hWndItem, nFocusBranch)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On VTM_OutlineCornerClick
.head 6 -  Set nCurrentFlag = cBranch.GetItemFlags(cBranch.GetItemHandle(wParam))
.head 6 +  If (nCurrentFlag & ITEM_IsParent)
.head 7 +  If (nCurrentFlag & ITEM_IsExpanded)
.head 8 -  Call cBranch.Collapse(wParam)
.head 7 +  Else
.head 8 -  Call cBranch.Expand(wParam)
.head 5 +  On VTM_KeyDown
.head 6 -  Set nCurrentFlag = cBranch.GetItemFlags(cBranch.GetItemHandle(VisListGetFocusIndex(hWndItem)))
.head 6 +  Select Case wParam
.head 7 +  Case VK_Left
.head 8 +  If nCurrentFlag & ITEM_CanCollapse
.head 9 -  Call cBranch.Collapse(VisListGetFocusIndex(hWndItem))
.head 8 -  Break
.head 7 +  Case VK_Right
.head 8 +  If nCurrentFlag & ITEM_CanExpand
.head 9 -  Call cBranch.Expand(VisListGetFocusIndex(hWndItem))
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalSendClassMessage(VTM_KeyDown, wParam, lParam)
.head 8 -  Break
.head 5 +  On SAM_Destroy
.head 6 -  Call cBranch.FreeDescendents(hItemRoot)
.head 5 +  On SAM_DragDrop
.head 6 -  Return FALSE
.head 3 +  Child Table: tblBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.183"
.head 6 -  Top:    0.179"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.107"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Set fEditBranch = TRUE
.head 8 -  Call SalEnableWindow(pbUpdate)
.head 5 +  Column: colB040
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код подразделения
по справочнику НБУ
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Set fEditBranch = TRUE
.head 8 -  Call SalEnableWindow(pbUpdate)
.head 5 +  Column: colDescr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Описание
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Set fEditBranch = TRUE
.head 8 -  Call SalEnableWindow(pbUpdate)
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_ObjActivate
.head 6 -  Call SalTblInsertRow(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_New, FALSE)
.head 5 +  On UM_Populate
.head 6 -  Set colName  = smBranchList[nCurrentBranch,1]
.head 6 -  Set colB040  = smBranchList[nCurrentBranch,2]
.head 6 -  Set colDescr = smBranchList[nCurrentBranch,3]
.head 3 +  Child Table: tblParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    1.512"
.head 6 -  Width:  5.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.798"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название
параметра
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTagName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
параметра
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
параметра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Set fEditParams = TRUE
.head 8 -  Call SalEnableWindow(pbUpdate)
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bTagShow
.head 5 -  !
.head 5 -  String: sStrPopulate
.head 5 -  : cFParams
.head 6 -  Class: cGenFilter
.head 5 -  : cQParams
.head 6 -  Class: cGenQuery
.head 5 -  !
.head 5 -  Number: nCurRow
.head 5 -  Window Handle: hCol
.head 5 -  Boolean: bSortOrd
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set bTagShow = FALSE
.head 6 -  Set sStrPopulate =
"SELECT t.tag, t.name, p.val 
   INTO :colTag, :colTagName, :colVal 
   FROM branch_tags t, branch_parameters p 
  WHERE t.tag=p.tag(+) AND p.branch(+)=:sCurrentBranch 
  ORDER BY t.name"
.head 6 -  Call cFParams.Init("branch_parameters", 'p')
.head 6 -  Call cQParams.Init(sStrPopulate)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), sStrPopulate, TBL_FillAll)
.head 5 +  On SAM_ContextMenu
.head 6 -  Set hMenuWnd = hWndForm
.head 6 -  Call SalTrackPopupMenu(hWndForm, 'mnMaster', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 5 +  On UM_Init
.head 6 +  Select Case (wParam)
.head 7 -  ! Контекстный Поиск
.head 7 +  Case 0
.head 8 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_Selected, FALSE, 0, 0)
.head 8 -  Call SalTblQueryFocus(hWndForm, nCurRow, hCol)
.head 8 -  Call SalTblSetContext(hWndForm, nCurRow)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nCurRow, ROW_Selected, TRUE)
.head 8 -  Break
.head 7 -  ! Фильтр
.head 7 +  Case 1
.head 8 +  If SetQueryFilter(cFParams)
.head 9 -  Set sStrPopulate = cQParams.GetFullSQLString(cFParams)
.head 9 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 8 -  Break
.head 7 -  ! TAG
.head 7 +  Case 2
.head 8 -  Set bTagShow = not bTagShow
.head 8 +  If bTagShow
.head 9 -  Call SalShowWindow(tblParams.colTag)
.head 8 +  Else
.head 9 -  Call SalHideWindow(tblParams.colTag)
.head 8 -  Break
.head 7 +  Default
.head 8 -  Break
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 2 +  Functions
.head 3 +  Function: insertBranch
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCurrBranch
.head 5 -  String: sCurrBranch
.head 5 -  String: sBranchName
.head 5 -  String: sCurrTobo
.head 5 -  String: sRetBranch
.head 5 -  String: sRetName
.head 5 -  String: sRetB040
.head 5 -  String: sRetDescr
.head 4 +  Actions
.head 5 -  Set nCurrBranch = cBranch.nValue
.head 5 -  Set sCurrBranch = smBranchList[nCurrBranch, 0]
.head 5 -  Set sBranchName = smBranchList[nCurrBranch, 1]
.head 5 -  Set sCurrTobo   = smBranchList[nCurrBranch, 4]
.head 5 +  If SalModalDialog(dlgBranchInsert, hWndMDI, sCurrBranch, sBranchName, sCurrTobo, 
   IifN(cBranch.nLevel=0, TRUE, FALSE), sRetBranch, sRetName, sRetB040, sRetDescr, TRUE)
.head 6 -  Call SalSendMsg(cBranch, UM_Populate, 0, 0)
.head 3 +  Function: ShowBranchParams
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCurrBranch
.head 5 -  String: sCurrBranch
.head 5 -  String: sBranchName
.head 5 -  String: sCurrTobo
.head 5 -  String: sRetBranch
.head 5 -  String: sRetName
.head 5 -  String: sRetB040
.head 5 -  String: sRetDescr
.head 4 +  Actions
.head 5 -  Set nCurrBranch = cBranch.nValue
.head 5 -  Set sCurrBranch = smBranchList[nCurrBranch, 0]
.head 5 -  Set sBranchName = smBranchList[nCurrBranch, 1]
.head 5 -  Set sCurrTobo   = smBranchList[nCurrBranch, 4]
.head 5 -  ! Редактирование
.head 5 +  If nParEdit
.head 6 +  If cBranch.nLevel=0
.head 7 -  Call FunNSIEditFFiltered("PARAMS", 0, "")
.head 6 +  Else
.head 7 -  Call FunNSIEditFFiltered("PARAMS$BASE", 0, "kf='"||sCurrTobo||"'")
.head 5 -  ! Просмотр
.head 5 +  Else
.head 6 +  If cBranch.nLevel=0
.head 7 -  Call FunNSIEditFFiltered("PARAMS", 1, "")
.head 6 +  Else
.head 7 -  Call FunNSIEditFFiltered("PARAMS$BASE", 1, "kf='"||sCurrTobo||"'")
.head 3 +  Function: deleteBranch
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCurrBranch
.head 5 -  String: sCurrBranch
.head 5 -  String: sBranchName
.head 5 -  String: sCurrTobo
.head 4 +  Actions
.head 5 -  Call SalMessageBox('Пока не реализовано', '', MB_Ok)
.head 5 -  Return TRUE
.head 5 -  Set nCurrBranch = cBranch.nValue
.head 5 -  Set sCurrBranch = smBranchList[nCurrBranch, 0]
.head 5 -  Set sBranchName = smBranchList[nCurrBranch, 1]
.head 5 -  Set sCurrTobo   = smBranchList[nCurrBranch, 4]
.head 5 +  If IDYES = SalMessageBox('Удалить подразделение ' || 
  sCurrTobo || ' ' || sBranchName || ' ?', 'Внимание!', MB_YesNo | MB_IconQuestion)
.head 6 +  If SqlPLSQLCommand(hSql(), 
   "branch_edit.delBranch(sCurrBranch)")
.head 7 -  Call SqlCommitEx(hSql(), "EDITBRANCH. Удалено подразделение " || 
     sCurrBranch || " " || sBranchName || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 7 -  Call VisListDeleteSelected(cBranch)
.head 7 -  Call SalSendMsg(cBranch, SAM_Click, 0, 0)
.head 6 +  Else
.head 7 -  Call SqlRollbackEx(hSql(), "EDITBRANCH. Ошибка выполнения процедуры при удалении подразделения " || 
     sCurrBranch || " " || sBranchName || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 3 +  Function: reopenBranch
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCurrBranch
.head 5 -  String: sCurrBranch
.head 5 -  String: sBranchName
.head 5 -  String: sCurrTobo
.head 5 -  String: sCurrB040
.head 5 -  String: sCurrDescr
.head 4 +  Actions
.head 5 -  Set nCurrBranch = cBranch.nValue
.head 5 -  Set sCurrBranch = smBranchList[nCurrBranch, 0]
.head 5 -  Set sBranchName = smBranchList[nCurrBranch, 1]
.head 5 -  Set sCurrTobo   = smBranchList[nCurrBranch, 4]
.head 5 -  Set sCurrB040   = smBranchList[nCurrBranch, 2]
.head 5 -  Set sCurrDescr  = smBranchList[nCurrBranch, 3]
.head 5 +  If SalModalDialog(dlgBranchReopen, hWndMDI, sCurrBranch, sCurrTobo, sBranchName, sCurrB040, sCurrDescr)
.head 6 -  Call SalSendMsg(cBranch, UM_Populate, 0, 0)
.head 3 +  Function: saveBranch
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCurrBranch
.head 5 -  String: sCurrBranch
.head 5 -  String: sBranchName
.head 5 -  String: sCurrTobo
.head 5 -  String: sName
.head 5 -  String: sB040
.head 5 -  String: sDescr
.head 5 -  Number: nRow
.head 5 -  String: sTag
.head 5 -  String: sVal
.head 4 +  Actions
.head 5 -  Set nCurrBranch = cBranch.nValue
.head 5 -  Set sCurrBranch = smBranchList[nCurrBranch, 0]
.head 5 -  Set sBranchName = smBranchList[nCurrBranch, 1]
.head 5 -  Set sCurrTobo   = smBranchList[nCurrBranch, 4]
.head 5 -  Set sName  = tblBranch.colName
.head 5 -  Set sB040  = tblBranch.colB040
.head 5 -  Set sDescr = tblBranch.colDescr
.head 5 +  If fEditBranch
.head 6 -  Set fEditBranch = FALSE
.head 6 +  If SqlPLSQLCommand(hSql(), 
  "branch_edit.updateBranch(sCurrBranch, sName, sB040, sDescr, NUMBER_Null)")
.head 7 -  ! Изменение свойств подразделения
.head 7 -  Call SqlCommitEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('frmBranch.cTUpdateBranchOk') || " " || sCurrBranch || 
     " (Name=" || sBranchName || ", B040=" || sB040 || 
     ", Description=" || sDescr || ") [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 7 -  Set smBranchList[nCurrBranch, 1] = sName
.head 7 -  Set smBranchList[nCurrBranch, 2] = sB040
.head 7 -  Set smBranchList[nCurrBranch, 3] = sDescr
.head 7 -  Call cBranch.SetItemData(cBranch.hItem, sCurrTobo || " " || sName, nCurrBranch, 0)
.head 6 +  Else
.head 7 -  ! Ошибка выполнения процедуры при изменении свойств подразделения
.head 7 -  Call SqlRollbackEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('frmBranch.cTUpdateBranchErr') || " " || 
     sCurrBranch || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 5 +  If fEditParams
.head 6 -  Set fEditParams = FALSE
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblParams, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(tblParams, nRow)
.head 7 -  Set sTag = tblParams.colTag
.head 7 -  Set sVal = tblParams.colVal
.head 7 +  If SqlPLSQLCommand(hSql(), 
  "branch_edit.setBranchParams(sCurrBranch, sTag, sVal)")
.head 8 -  ! Изменение параметров подразделения
.head 8 -  Call SqlCommitEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('frmBranch.cTUpdateBranchParamsOk') || " " || 
     sCurrBranch || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 7 +  Else
.head 8 -  ! Ошибка выполнения процедуры при изменении параметров подразделения
.head 8 -  Call SqlRollbackEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('frmBranch.cTUpdateBranchParamsErr') || " " || 
     sCurrBranch || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 8 -  Break
.head 3 +  Function: setBranchListValue
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nI 
.head 5 -  String: sBId
.head 5 -  String: sBName
.head 5 -  String: sBB040
.head 5 -  String: sBDescr
.head 5 -  String: sBTobo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set smBranchList[nI,0] = sBId
.head 5 -  Set smBranchList[nI,1] = sBName
.head 5 -  Set smBranchList[nI,2] = sBB040
.head 5 -  Set smBranchList[nI,3] = sBDescr
.head 5 -  Set smBranchList[nI,4] = sBTobo
.head 3 +  Function: populateBranch
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIterator
.head 5 -  Number: hItemLevel0
.head 5 -  String: sBranch
.head 5 -  String: sBranchName
.head 5 -  String: sB040
.head 5 -  String: sDescription
.head 5 -  String: sTobo
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set hCurrentBranch = NUMBER_Null
.head 5 -  Call cBranch.FreeDescendents(hItemRoot)
.head 5 -  Set hItemRoot = cBranch.GetRoot()
.head 5 +  If hItemRoot
.head 6 -  Set nIterator = 0
.head 6 -  Set nBranchNum = 0
.head 6 -  ! 1-й уровень (Level=0) - это наш филиал
.head 6 -  Call SqlPrepareAndExecute(hSql(),
"SELECT branch, name, b040, description
   INTO :sBranch, :sBranchName, :sB040, :sDescription
   FROM branch 
  WHERE branch=:sOurTobo 
  ORDER BY branch")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set hItemLevel0 = cBranch.LoadChild(hItemRoot, hPicLevel0, hPicLevel0, sBranchName, nIterator, 0)
.head 6 -  Call setBranchListValue(nIterator, sBranch, sBranchName, sB040, sDescription, '')
.head 6 -  Set nIterator = nIterator + 1
.head 6 +  If hItemLevel0
.head 7 -  Call populateSubBranch(sOurTobo, hItemLevel0, 1, nIterator)
.head 6 -  Set nBranchNum = nIterator
.head 6 -  Call cBranch.ShowOutline(1)
.head 6 -  Call VisListSetFocusIndex(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: populateSubBranch
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: p_sTobo
.head 5 -  Number: hParentLevel
.head 5 -  Number: nLevel
.head 5 -  Receive Number: nIterator
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cCnc
.head 6 -  Class: cABSConnect
.head 5 -  Number: hItemLevel1
.head 5 -  Number: hItemLevel2
.head 5 -  String: sBranch
.head 5 -  String: sBranchName
.head 5 -  String: sB040
.head 5 -  String: sDescription
.head 5 -  String: sTobo
.head 4 +  Actions
.head 5 -  Call XConnectGetParams(cCnc)
.head 5 +  If NOT cCnc.Connect()
.head 6 -  Return FALSE
.head 5 -  Call SqlPrepareAndExecute(cCnc.hSql(),
"SELECT branch, name, b040, description
   INTO :sBranch, :sBranchName, :sB040, :sDescription
   FROM branch 
  WHERE nvl(instr(trim(substr(branch,length(:p_sTobo)+1,length(branch)-length(:p_sTobo)-1)),'/'),-1)=0
    and branch like '" || p_sTobo || "%'
  ORDER BY branch")
.head 5 +  While SqlFetchNext(cCnc.hSql(), nFetchRes)
.head 6 -  Set sTobo = Subs(sBranch, 2, Len(sBranch)-2)
.head 6 -  Set hItemLevel1 = cBranch.LoadChild(hParentLevel, IifN(nLevel>1, hPicLevel2, hPicLevel1), IifN(nLevel>1, hPicLevel2, hPicLevel1), sTobo || " " || sBranchName, nIterator, 0)
.head 6 -  Call setBranchListValue(nIterator, sBranch, sBranchName, sB040, sDescription, sTobo)
.head 6 -  Set nIterator = nIterator + 1
.head 6 -  Call populateSubBranch(sBranch, hItemLevel1, nLevel+1, nIterator)
.head 5 -  Call cCnc.Disconnect()
.head 2 +  Window Parameters
.head 3 -  Number: nParEdit	! 0-ReadOnly, 1-Edit
.head 3 -  String: sMainBranch	! Признак гл. банка ('/' - для ПРАВЕКС)
.head 3 -  String: sPar2
.head 2 +  Window Variables
.head 3 -  String: sOurTobo
.head 3 -  Boolean: fEditBranch
.head 3 -  Boolean: fEditParams
.head 3 -  !
.head 3 -  Number: hItemRoot
.head 3 -  Number: hPicLevel0
.head 3 -  Number: hPicLevel1
.head 3 -  Number: hPicLevel2
.head 3 -  !
.head 3 -  Number: nBranchNum
.head 3 -  String: smBranchList[*,5]
.head 3 -  ! 0 - branch (/) OR (/300001/) OR (/300001/001/)
  1 - branchName
  2 - b040
  3 - description
  4 - tobo () OR (300000) OR (001)
.head 3 -  !
.head 3 -  Number: nFocusBranch
.head 3 -  Number: hCurrentBranch
.head 3 -  Number: nCurrentBranch
.head 3 -  String: sCurrentBranch
.head 3 -  String: sCurrentTobo
.head 3 -  Number: nCurrentFlag
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Редактирование иерархии подразделений
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmBranch.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set sOurTobo   = GetValueStr("SELECT substr(tobopack.GetTOBO,1,30) FROM dual")
.head 4 -  Set hPicLevel0 = VisPicLoad(PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'PIC_Level0', '' )
.head 4 -  Set hPicLevel1 = VisPicLoad(PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'PIC_Level1', '' )
.head 4 -  Set hPicLevel2 = VisPicLoad(PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'PIC_Level2', '' )
.head 4 -  Set fEditBranch = FALSE
.head 4 -  Set fEditParams = FALSE
.head 4 -  Call SalDisableWindow(pbInsert)
.head 4 -  Call SalDisableWindow(pbDelete)
.head 4 -  Call SalDisableWindow(pbReopen)
.head 4 -  Call SalDisableWindow(pbEditParams)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(tblBranch.colName)
.head 4 -  Call SalDisableWindow(tblBranch.colB040)
.head 4 -  Call SalDisableWindow(tblBranch.colDescr)
.head 4 -  Call SalDisableWindow(tblParams.colVal)
.head 4 +  If nParEdit
.head 5 -  Call SalEnableWindow(pbInsert)
.head 4 -  Call cSplMain.setBarPosition(350)
.head 4 -  Call cSplMain.setLeftFrame(cBranch)
.head 4 -  Call cSplMain.setRightFrame(cSplR)
.head 4 -  Call cSplR.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
.head 4 -  Call cSplR.setBarPosition(100)
.head 4 -  Call cSplR.setTopFrame(tblBranch)
.head 4 -  Call cSplR.setBottomFrame(tblParams)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call VisPicFree(hPicLevel0)
.head 4 -  Call VisPicFree(hPicLevel1)
.head 4 -  Call VisPicFree(hPicLevel2)
.head 4 -  ! Выход из диалога: Редактирование иерархии подразделений
.head 4 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('cTToLogExit') || ": " ||
     CurrentLangTable.GetAtomTitle('frmBranch.cTWndTitle'))
.head 1 +  Dialog Box: dlgBranchInsert
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 16501
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  7.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.35"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код подразделения:
.head 4 -  Resource Id: 16497
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.2"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.15"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If not SalIsValidInteger(dfBranch)
.head 7 -  ! Введите числовой код!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessBranchInt'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If bMain and Len(dfBranch) < 6
.head 7 -  ! Значение должно содержать не менее 6 символов!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessBranch6'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If not bMain and Len(dfBranch) < 5
.head 7 -  ! Значение должно содержать не менее 5 символов!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessBranch5'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Pushbutton: pbGetValue
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.75"
.head 5 -  Top:    0.155"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Выбрать из справочника
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('dlgBranchInsert.cBTipGetValue')
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGetFiltered('BANKS', 'NB', '', sPK, sSK)
.head 7 +  If sPK != ''
.head 8 -  Set dfBranch = sPK
.head 3 -  Background Text: Код подразделения (НБУ):
.head 4 -  Resource Id: 16499
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.5"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgB040
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfB040
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.45"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Наименование подразделения:
.head 4 -  Resource Id: 16498
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.8"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.75"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Комментарий:
.head 4 -  Resource Id: 16500
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.1"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDescr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDescr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.05"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 16502
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.45"
.head 5 -  Width:  7.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.65"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.25"
.head 5 -  Top:    1.548"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If NOT SalIsNull(dfBranch) AND NOT SalIsNull(dfName)
.head 7 -  Set sNewBranch = sBranchParent || dfBranch || '/'
.head 7 -  Set sNewName   = dfName
.head 7 -  Set sNewB040   = dfB040
.head 7 -  Set sNewDescr  = dfDescr
.head 7 +  If fInsert
.head 8 +  If SqlPLSQLCommand(hSql(), 
  "branch_edit.insBranch(sNewBranch, sNewName, sNewB040, sNewDescr, NUMBER_Null)")
.head 9 -  ! Добавлено отделение sNewBranch в подразделение sBranchParent [GetUserLoginName() GetUserRealName()]
.head 9 -  Call SqlCommitEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessAddBranch') || " " || sNewBranch || " " ||
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessToFilial') || " " || sBranchParent || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 9 -  ! Добавлено отделение dfBranch в подразделение sTobo
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessAddBranch') || " " || dfBranch || " " ||
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessToFilial') || " " || sTobo, 
     CurrentLangTable.GetAtomTitle('cTMessage'), MB_Ok | MB_IconInformation)
.head 9 -  Call SalEndDialog(hWndForm, TRUE)
.head 8 +  Else
.head 9 -  ! Ошибка выполнения процедуры при добавлении отделения sNewBranch в подразделение sBranchParent [GetUserLoginName() GetUserRealName()]
.head 9 -  Call SqlRollbackEx(hSql(), "EDITBRANCH. " || CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTErrAddBranch')||" " || sNewBranch || " " ||
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessToFilial') || " " || sBranchParent || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 9 -  ! Ошибка выполнения процедуры при добавлении отделения dfBranch в подразделение sTobo
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTErrAddBranch') || " " || dfBranch || " " || 
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessToFilial') || " " || sTobo, 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 7 +  Else
.head 8 -  Call SalEndDialog(hWndForm, TRUE)
.head 6 +  Else
.head 7 -  ! Заполнены не все реквизиты!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTMessRekv'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconInformation)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.483"
.head 5 -  Top:    1.55"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! Реквизиты родителя
.head 3 -  String: sBranchParent
.head 3 -  String: sBranchName
.head 3 -  String: sTobo
.head 3 -  !
.head 3 -  Boolean: bMain
.head 3 -  !
.head 3 -  Receive String: sNewBranch
.head 3 -  Receive String: sNewName
.head 3 -  Receive String: sNewB040
.head 3 -  Receive String: sNewDescr
.head 3 -  !
.head 3 -  Boolean: fInsert
.head 2 +  Window Variables
.head 3 -  String: sPK
.head 3 -  String: sSK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! sTobo sBranchName . Добавление отделения.
.head 4 -  Call SalSetWindowText(hWndForm, sTobo || " " || sBranchName || ". " || 
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTWndTitle') || ".")
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If NOT bMain
.head 5 -  Call SalHideWindow(pbGetValue)
.head 4 -  Set dfBranch = sNewBranch
.head 4 -  Set dfB040   = sNewB040
.head 4 -  Set dfName   = sNewName
.head 4 -  Set dfDescr  = sNewDescr
.head 3 +  On SAM_Destroy
.head 4 -  ! Выход из диалога: sTobo sBranchName. Добавление отделения.
.head 4 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('cTToLogExit') || ": " || sTobo || " " || sBranchName || ". " || 
     CurrentLangTable.GetAtomTitle('dlgBranchInsert.cTWndTitle') || ".")
.head 1 +  Dialog Box: dlgBranchReopen
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.3"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17106
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17107
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17108
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    0.06"
.head 6 -  Width:  10.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colBranch
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подразделение
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colB040
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код подразделения
по справочнику НБУ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDescr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ---
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 17109
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.15"
.head 5 -  Width:  10.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   7.983"
.head 5 -  Top:    4.298"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Перевести отделение sTobo sBranchName в подразделение tbl.colBranch tbl.colName?
.head 6 +  If IDYES = SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTMessReopenBranch') || ' ' || 
   sTobo || ' ' || sBranchName || ' ' || 
   CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTMessToFilial') ||' ' || tbl.colBranch || ' ' || tbl.colName || ' ?', 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion)
.head 7 -  Set sNewBranch = sTobo
.head 7 -  Set sNewName   = sBranchName
.head 7 -  Set sNewB040   = sB040
.head 7 -  Set sNewDescr  = sDescr
.head 7 +  If SalModalDialog(dlgBranchInsert, hWndMDI, tbl.colBranch, tbl.colName, tbl.colBranch, TRUE, 
  sNewBranch, sNewName, sNewB040, sNewDescr, FALSE)
.head 8 +  If SqlPLSQLCommand(hSql(), 
  "branch_edit.reBranch(sBranch, sNewBranch, sNewName, sNewB040, sNewDescr)")
.head 9 -  ! Переведено отделение sBranch в подразделение tbl.colBranch [GetUserLoginName() GetUserRealName()]
.head 9 -  Call SqlCommitEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTMessReopenOk') || " " || sBranch || " " ||
     CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTMessToFilial') || " " || tbl.colBranch || " [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 9 -  ! Переведено отделение sTobo в подразделение tbl.colBranch
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTMessReopenOk') || " " || sTobo || " " || 
     CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTMessToFilial') || " " || tbl.colBranch, 
     CurrentLangTable.GetAtomTitle('cTMessage'), MB_Ok | MB_IconInformation)
.head 9 -  Call SalEndDialog(hWndForm, TRUE)
.head 8 +  Else
.head 9 -  ! Ошибка выполнения процедуры переподчинения отделения sBranch [GetUserLoginName() GetUserRealName()]
.head 9 -  Call SqlRollbackEx(hSql(), "EDITBRANCH. " || 
     CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTErrReopen')|| " " || 
     sBranch || "  [" || GetUserLoginName() || " " || GetUserRealName() || "]")
.head 9 -  ! Ошибка выполнения процедуры переподчинения отделения sTobo
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTErrReopen') || " " || sTobo, 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.233"
.head 5 -  Top:    4.3"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! Реквизиты отделения
.head 3 -  String: sBranch
.head 3 -  String: sTobo
.head 3 -  String: sBranchName
.head 3 -  String: sB040
.head 3 -  String: sDescr
.head 2 +  Window Variables
.head 3 -  String: sNewBranch
.head 3 -  String: sNewName
.head 3 -  String: sNewB040
.head 3 -  String: sNewDescr
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! sTobo sBranchName. Перевод отделения.
.head 4 -  Call SalSetWindowText(hWndForm, sTobo || ' ' || sBranchName || ". " || 
     CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTWndTitle') || ".")
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dlgBranchReopen.strSqlPopulate = 
"SELECT branch, name, b040, description
   INTO :dlgBranchReopen.tbl.colBranch, :dlgBranchReopen.tbl.colName, 
        :dlgBranchReopen.tbl.colB040, :dlgBranchReopen.tbl.colDescr 
   FROM branch 
  ORDER BY branch"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  ! Выход из диалога: sTobo sBranchName. Перевод отделения.
.head 4 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('cTToLogExit') || ": " || sTobo || " " || sBranchName || ". " || 
     CurrentLangTable.GetAtomTitle('dlgBranchReopen.cTWndTitle') || ".")
.head 1 +  Form Window: frmSetRates
.head 2 -  Class: cGenericTableFrm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.0"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 11232
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 11233
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSetRates
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Установить курсы на отделения'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmSetRates.cBTipSetRates')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(tblRates, ROW_Edited, 0)
.head 8 -  ! "В таблице присутствуют несохраненные изменения!" || PutCrLf() || "Перечитайте или сохраните данные."
.head 8 -  Call SalMessageBox(
     CurrentLangTable.GetAtomTitle('frmSetRates.cTMessNotSaveData') || PutCrLf() || 
     CurrentLangTable.GetAtomTitle('frmSetRates.cTMessNotSaveData_'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 7 -  Set bTblFlag = SalTblAnyRows(tblRates, ROW_Selected, 0)
.head 7 -  ! IifS(bFlag=TRUE, "Установить курсы подразделений по выбранным валютам на " || sBankDate, 
  "Не выбрана валюта!" || PutCrLf() || "Установить курсы подразделений по ВСЕМ валютам на " || sBankDate)
.head 7 +  If SalMessageBox(IifS(bTblFlag=TRUE, 
   CurrentLangTable.GetAtomTitle('frmSetRates.cTMessSetRatesQuestionSelKv') || " " || sBankDate, 
   CurrentLangTable.GetAtomTitle('frmSetRates.cTMessKvNotSelect') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('frmSetRates.cTMessSetRatesQuestionAllKv') || " " || sBankDate),
   CurrentLangTable.GetAtomTitle('cTQuestion'), MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Call hWndForm.frmSetRates.tblRates.SetRates(bTblFlag)
.head 8 -  Call SalSendMsg(tblRates, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbArc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set bArc = NOT bArc
.head 7 -  Call PopulateForm()
.head 6 +  On SAM_TooltipSetText
.head 7 +  If NOT bArc
.head 8 -  ! 'За все дни'
.head 8 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frmSetRates.cBTipArcAll'))
.head 7 +  Else
.head 8 -  ! 'На текущий день'
.head 8 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frmSetRates.cBTipArcTek'))
.head 4 -  Line
.head 5 -  Resource Id: 11234
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  5.0"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  5.0"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 11235
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.683"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  5.683"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 24
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Combo Box: cmbBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.1"
.head 5 -  Width:  9.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.512"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbBranch.Init(hWndItem)
.head 7 -  Call cmbBranch.Populate(hSql(), "BRANCH", "BRANCH || ' ' || NAME", 
     IifS(nPar=1,"OUR_BRANCH","OUR_BRANCH_SUB"), " ORDER BY BRANCH")
.head 7 -  ! Call cmbBranch.Add('-', 'Все отделения')
.head 7 -  Call cmbBranch.Add('-', CurrentLangTable.GetAtomTitle('frmSetRates.cTAllBranches'))
.head 7 +  If nPar = 1
.head 8 -  Call cmbBranch.SetSelectById(sOurBranch)
.head 8 -  Set sBranch = cmbBranch.GetCurrentKey()
.head 7 +  Else
.head 8 -  Call SalListSetSelect(hWndItem, 0)
.head 8 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 8 -  Set sBranch = cmbBranch.GetCurrentKey()
.head 7 -  Call PopulateForm()
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set sBranch = cmbBranch.GetCurrentKey()
.head 6 -  Call PopulateForm()
.head 3 +  Child Table: tblRates
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableFrm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.45"
.head 6 -  Width:  9.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 60000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
установки курса
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBSum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Базовая
сумма
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRateO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Официальный
курс
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRateB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс
покупки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRateS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс
продажи
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBranch
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отделение
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: SetRates
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bFlag	! TRUE-по выбранным валютам, FALSE-по всем валютам
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nFlagsOn
.head 7 -  String: sKv
.head 7 -  Number: nKv
.head 6 +  Actions
.head 7 -  Set sKv  = ""
.head 7 -  Set nFlagsOn = IifN(bFlag=TRUE, ROW_Selected, 0)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, nFlagsOn, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Set nKv = colKv
.head 8 -  Set sKv = sKv || IifS(sKv="", "", ",") || Str(nKv)
.head 8 +  If not SqlPLSQLCommand(hSql(), "setratessubbranch(dBankDate, nKv)")
.head 9 -  ! Call SqlRollbackEx(hSql(), "SETRATES. Неуспешное выполнение процедуры установки курсов подразделений")
.head 9 -  Call SqlRollbackEx(hSql(), "SETRATES. " || CurrentLangTable.GetAtomTitle('frmSetRates.cTMessSetRatesErr'))
.head 9 -  ! Call SalMessageBox("Неуспешное выполнение процедуры установки курсов подразделений", "Внимание!", MB_IconExclamation | MB_Ok)
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmSetRates.cTMessSetRatesErr'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 9 -  Return FALSE
.head 7 -  ! "SETRATES. Установлены курсы валют подразделений ((" || sKv || ")-" || sBankDate || ")")
.head 7 -  Call SqlCommitEx(hSql(), "SETRATES. " || CurrentLangTable.GetAtomTitle('frmSetRates.cTMessSetRatesOk') || " ((" || sKv || ")-" ||sBankDate || ")")
.head 7 -  ! Call SalMessageBox("Установлены курсы валют подразделений", "Сообщение", MB_IconAsterisk | MB_Ok)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frmSetRates.cTMessSetRatesOk'), 
     CurrentLangTable.GetAtomTitle('cTMessage'), MB_IconAsterisk | MB_Ok)
.head 7 -  Return TRUE
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On UM_Update
.head 6 -  Set frmSetRates.strSqlUpdate = 
"update cur_rates$base
    set rate_b = :hWndForm.tblRates.colRateB,
        rate_s = :hWndForm.tblRates.colRateS
  where kv = :hWndForm.tblRates.colKv
    and vdate = :hWndForm.tblRates.colVDate
    and branch = :hWndForm.tblRates.colBranch"
.head 6 -  Call SalSendClassMessage(UM_Update, 0, 0)
.head 2 +  Functions
.head 3 +  Function: PopulateForm
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SalSetWindowText(hWndForm, "Редактирование иерархии подразделений")
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmSetRates.cTWndTitle'))
.head 5 -  ! IifS(sBranch='-', "Все подразделения", sBranch) || IifS(bArc=TRUE, " - Архив", "")
.head 5 -  Set hWndForm.frmSetRates.strTitleAux = IifS(sBranch='-', CurrentLangTable.GetAtomTitle('frmSetRates.cTAllBranches'), sBranch) || 
    IifS(bArc=TRUE, " - " || CurrentLangTable.GetAtomTitle('frmSetRates.cTWndTitleArc'), "")
.head 5 +  If sBranch = '-'
.head 6 -  Call SalShowWindow(hWndForm.frmSetRates.tblRates.colBranch)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.frmSetRates.tblRates.colBranch)
.head 5 +  If not bArc and sBranch = sOurBranch
.head 6 -  Call SalEnableWindow(pbSetRates)
.head 5 +  Else
.head 6 -  Call SalDisableWindow(pbSetRates)
.head 5 -  Set hWndForm.frmSetRates.nFlags = GT_NoIns | GT_NoDel
.head 5 -  ! v_cur_rates исп. для фильтра
.head 5 -  Set hWndForm.frmSetRates.strSqlPopulate =
"select kv, vdate, bsum, rate_o, rate_b, rate_s, branch
   into :hWndForm.tblRates.colKv,    :hWndForm.tblRates.colVDate, 
        :hWndForm.tblRates.colBSum,  :hWndForm.tblRates.colRateO, 
        :hWndForm.tblRates.colRateB, :hWndForm.tblRates.colRateS, :hWndForm.tblRates.colBranch
   from cur_rates$base v_cur_rates
  where " || IifS(sBranch='-', "branch like '"||sOurBranch||"%'" || IifS(nPar=1, "", " and branch<>:frmSetRates.sOurBranch"), 
       "branch=:frmSetRates.sBranch") || IifS(bArc=TRUE, "", " and vdate=bankdate") || "
  order by vdate, branch, kv"
.head 5 -  Call SalSendMsg(hWndForm, SAM_Create, 0, 0)
.head 5 -  Call SalSendMsg(tblRates, UM_Populate, 0, 0)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nPar	! 1-я+дети, 2-только дети
.head 3 -  String: sPar1
.head 3 -  String: sPar2
.head 2 +  Window Variables
.head 3 -  Boolean: bInit
.head 3 -  Boolean: bArc
.head 3 -  String: sOurBranch
.head 3 -  Date/Time: dBankDate
.head 3 -  String: sBankDate
.head 3 -  String: sBranch
.head 3 -  Boolean: bTblFlag
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If not bInit
.head 5 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 -  ! Call SalSetWindowText(hWndForm, "Редактирование иерархии подразделений")
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmSetRates.cTWndTitle'))
.head 5 -  Call PrepareWindowEx(hWndForm)
.head 5 -  Call SalDisableWindow(pbDetails)
.head 5 -  Set sOurBranch = GetValueStr("SELECT substr(tobopack.GetTOBO,1,30) FROM dual")
.head 5 -  Set dBankDate  = GetBankDate()
.head 5 -  Set sBankDate  = SalFmtFormatDateTime(dBankDate, 'dd/MM/yyyy')
.head 5 -  Set bArc  = FALSE
.head 5 -  Set bInit = TRUE
.head 5 -  Set hWndForm.frmSetRates.strFilterTblName = 'v_cur_rates'
.head 5 -  Set hWndForm.frmSetRates.strPrintFileName = 'currates'
.head 5 -  Set hWndForm.frmSetRates.nFlags = GT_NoIns | GT_NoDel
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Table Window: tblShowJobs
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Управление списком заданий
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 42023
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.633"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  5.633"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 36700
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.967"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  4.967"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tblShowJobs.cBTipDetails')
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 42024
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.1"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 42025
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbStart
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tblShowJobs.cBTipStart')
.head 6 +  On SAM_Click
.head 7 +  If hWndForm.tblShowJobs.colJobId
.head 8 -  Call StartJob()
.head 8 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbStop
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.45"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_BKLD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tblShowJobs.cBTipStop')
.head 6 +  On SAM_Click
.head 7 +  If hWndForm.tblShowJobs.colJobId
.head 8 -  Call StopJob()
.head 8 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 2 +  Contents
.head 3 +  Column: colJobCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
задания
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colJobName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
задания
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colJobId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ID
задания
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLastDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Время последнего
выполнения
задания
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: DateTime
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNextDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Время следующего
выполнения
задания
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: DateTime
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBroken
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остановлено
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBrokenName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остановлено
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colInterval
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Interval
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFailures
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во
ошибок
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colWhat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполняемая
процедура
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colJobFilter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: JobFilter
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 254
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: StartJob
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand(hSql(), "bars_job.start_job(colJobId)")
.head 6 -  ! Успешно выполнена процедура start_job для задания colJobCode (colJobId)
.head 6 -  Call SqlCommitEx(hSql(), "JOBS. " || CurrentLangTable.GetAtomTitle('tblShowJobs.cTProcOk') || " start_job " || 
     CurrentLangTable.GetAtomTitle('tblShowJobs.cTForJob') || " " || colJobCode || "(" || Str(colJobId) || ")" )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Неуспешное выполнение процедуры start_job для задания colJobCode (colJobId)
.head 6 -  Call SqlRollbackEx(hSql(), "JOBS. " || CurrentLangTable.GetAtomTitle('tblShowJobs.cTProcErr') || " start_job " || 
     CurrentLangTable.GetAtomTitle('tblShowJobs.cTForJob') || " " || colJobCode || "(" || Str(colJobId) || ")" )
.head 6 -  Return FALSE
.head 3 +  Function: StopJob
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand(hSql(), "bars_job.stop_job(colJobId)")
.head 6 -  ! Успешно выполнена процедура stop_job для задания colJobCode (colJobId)
.head 6 -  Call SqlCommitEx(hSql(), "JOBS. " || CurrentLangTable.GetAtomTitle('tblShowJobs.cTProcOk') || " stop_job " || 
     CurrentLangTable.GetAtomTitle('tblShowJobs.cTForJob') || " " || colJobCode || "(" || Str(colJobId) || ")" )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Неуспешное выполнение процедуры stop_job для задания colJobCode (colJobId)
.head 6 -  Call SqlRollbackEx(hSql(), "JOBS. " || CurrentLangTable.GetAtomTitle('tblShowJobs.cTProcErr') || " stop_job " || 
     CurrentLangTable.GetAtomTitle('tblShowJobs.cTForJob') || " " || colJobCode || "(" || Str(colJobId) || ")" )
.head 6 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Number: nPar	! 0-спрятаны колонки, 1-расширенный доступ-показать колонки
.head 3 -  String: sPar1
.head 3 -  String: sPar2
.head 2 +  Window Variables
.head 3 -  Number: nRowColor
.head 3 -  String: sText
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Управление списком заданий
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tblShowJobs.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 +  If not nPar
.head 5 -  Call SalHideWindow(colJobCode)
.head 5 -  Call SalHideWindow(colJobId)
.head 5 -  Call SalHideWindow(colInterval)
.head 5 -  Call SalHideWindow(colWhat)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Set hWndForm.tblShowJobs.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.tblShowJobs.strFilterTblName = 'v_jobs_list'
.head 4 -  Set hWndForm.tblShowJobs.strSqlPopulate = 
"select job_code, job_name, job_id, job_filter,
        last_date, next_date, broken, interval, failures, what
   into :hWndForm.tblShowJobs.colJobCode, :hWndForm.tblShowJobs.colJobName,
        :hWndForm.tblShowJobs.colJobId, :hWndForm.tblShowJobs.colJobFilter,
        :hWndForm.tblShowJobs.colLastDate, :hWndForm.tblShowJobs.colNextDate,
        :hWndForm.tblShowJobs.colBroken, :hWndForm.tblShowJobs.colInterval,
        :hWndForm.tblShowJobs.colFailures, :hWndForm.tblShowJobs.colWhat
   from v_jobs_list
  order by job_name"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalSetFocus(hWndForm)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If not colBroken
.head 5 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkRed)
.head 4 +  Else If colBroken = 'Y'
.head 5 -  Set colBrokenName = CurrentLangTable.GetAtomTitle('tblShowJobs.cTBrokenYes')
.head 5 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkBlue)
.head 4 +  Else
.head 5 -  Set colBrokenName = CurrentLangTable.GetAtomTitle('tblShowJobs.cTBrokenNo')
.head 5 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkGreen)
.head 3 +  On SAM_DoubleClick
.head 4 +  If hWndForm.tblShowJobs.colJobFilter
.head 5 -  Call FunNSIEditFFiltered('SEC_AUDIT', 1, hWndForm.tblShowJobs.colJobFilter)
.head 3 +  On SAM_RowSetContext
.head 4 +  If not colBroken
.head 5 -  Call SalDisableWindow(pbStart)
.head 5 -  Call SalDisableWindow(pbStop)
.head 4 +  Else If hWndForm.tblShowJobs.colBroken = 'Y'
.head 5 -  Call SalEnableWindow(pbStart)
.head 5 -  Call SalDisableWindow(pbStop)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbStart)
.head 5 -  Call SalEnableWindow(pbStop)
.head 4 +  If not hWndForm.tblShowJobs.colJobFilter
.head 5 -  Call SalDisableWindow(pbDetails)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(pbDetails)
.head 3 +  On SAM_RowHeaderClick
.head 4 +  If not colBroken
.head 5 -  Set nRowColor = COLOR_DarkRed
.head 5 -  ! Нет в списке заданий
.head 5 -  Set sText = CurrentLangTable.GetAtomTitle('tblShowJobs.cTJobIsAbsent')
.head 4 +  Else If colBroken = 'Y'
.head 5 -  Set nRowColor = COLOR_DarkBlue
.head 5 -  ! Задание остановлено
.head 5 -  Set sText = CurrentLangTable.GetAtomTitle('tblShowJobs.cTJobIsStop')
.head 4 +  Else
.head 5 -  Set nRowColor = COLOR_DarkGreen
.head 5 -  ! Задание выполняется
.head 5 -  Set sText = CurrentLangTable.GetAtomTitle('tblShowJobs.cTJobIsStart')
.head 4 -  Call XSalTooltipSetColors(nRowColor, COLOR_LightGray)
.head 4 -  Call XSalTooltipShow(hWndForm, sText)
.head 4 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
