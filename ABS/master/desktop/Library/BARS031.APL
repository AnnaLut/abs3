.head 0 +  Application Description: Пустая
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000E90000 002C000000020000 0003000000000000 00BB010000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 6300000101011944 3A5C424152533938 5C42494E5C424152 533033312E617064
00C0: 0E443A5C42415253 39385C42494E5C0E 443A5C4241525339 385C42494E5C0000
00E0: 010101001D513A5C 4241525339385C4C 4942524152595C42 4152533031352E64
0100: 6C6C1D513A5C4241 525339385C4C4942 524152595C424152 533031352E617063
0120: 0000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? No
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  ! !
.head 2 -  File Include: QCKTABS.APL
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Docwis6.apl
.head 2 -  ! ! File Include: Docfun6.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: vtdos.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: qckdvc.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: Vtcomm.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: #000
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: ApdNum   =  '31'
.head 4 -  String: ApdVer   =  '00'
.head 4 -  ! История изменений: -----------------------------------------------------|
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 2245890891
0000: 8600000039000000 0000000000000000 02000005000000DB 000000E0010D0000
0020: 00FF3FE800800000 0204000000FFFFE0 EC00000002FE00FF 83F000000002FB00
0040: FF0FF4000000EE02 00FF3F
.enddata
.head 3 -  Window Handle: hWinI
.head 3 -  String: sRet1
.head 3 -  String: sRet2
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Window Handle: hWin3
.head 3 -  Number: nFetchRes
.head 3 -  Window Handle: hWin97
.head 3 -  Window Handle: hWin28
.head 3 -  Window Handle: hWin29
.head 3 -  Window Handle: hWin30
.head 3 -  Boolean: bApdInited
.head 2 +  Internal Functions
.head 3 +  Function: Sel031	! __exported
.head 4 -  Description: Bars031_Selector
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 5 -  String: cashTAG
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TOBO
.head 5 -  String: CASH
.head 4 +  Actions
.head 5 -  Call Ini031()
.head 5 +  If GetBankMfo()='353575'
   AND SalDateCurrent()>=SalDateConstruct( 2008, 10, 4, 0, 0, 0 )
.head 6 -  Call SalMessageBox("Окончен срок тестового использования модуля 'Комунальные платежи'! Обратитесь к разработчику!" , "В Н И М А Н И Е !", MB_Ok | MB_IconStop)
.head 6 -  Return FALSE
.head 5 +  Select Case nMode
.head 6 +  Case 0  ! Администрирование ком плат
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow( ADM, hWndParent, nMode, nPar, strPar01,strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( hWin0  )
.head 7 -  Break
.head 6 +  Case 297 ! Новій ввод
.head 7 +  If not IsWindow(hWinI)
.head 8 -  Set hWinI = SalCreateWindow( frmKP, hWndParent, nMode, nPar, strPar01,strPar02, cashTAG)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( hWinI  )
.head 7 -  Break
.head 6 +  Case 97  ! Прямой ввод в папки (так назіваеміе ком.платежи в АЖИО) в тек день
.head 7 +  If not IsWindow(hWin97)
.head 8 -  Set hWin97 = SalCreateWindow( KP, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( KP )
.head 7 -  Break
.head 6 +  Case 98  ! 97 но бе3 ген соглаш
.head 7 +  If not IsWindow(hWin97)
.head 8 -  Set hWin97 = SalCreateWindow( KP, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( KP )
.head 7 -  Break
.head 6 +  Case 197 ! Прямой ввод в папки (так назіваеміе ком.платежи в АЖИО) в БУД день
.head 7 +  If not IsWindow(hWin97)
.head 8 -  Set hWin97 = SalCreateWindow( KP, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( KP )
.head 7 -  Break
.head 6 -  !
.head 6 +  Case 28  ! импорт коммунальные платежи MAJAR
.head 7 +  If not IsWindow(hWin28)
.head 8 -  Set hWin28 = SalCreateWindow(kp_MAJAR, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(kp_MAJAR)
.head 7 -  Break
.head 6 +  Case 29  ! импорт коммунальные платежи UTEL
.head 7 +  If not IsWindow(hWin29)
.head 8 -  Set hWin29 = SalCreateWindow(kp_UTEL, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(kp_UTEL)
.head 7 -  Break
.head 6 +  Case 30  ! импорт DBF для коммунальных платежей и не только
.head 7 -  Call SalModalDialog( dlg_LoadDbf, hWndParent, strPar01, strPar02 )
.head 7 +  ! If not IsWindow(hWin30)
.head 8 -                                                                                                                  Set hWin30 = SalCreateWindow(frm_LoadDbf, hWndParent, strPar01, strPar02)
.head 7 +  ! Else
.head 8 -                                                                                                                  Call SalBringWindowToTop(dlg_LoadDbf)
.head 7 -  Break
.head 3 +  Function: ShowApdVersion
.head 4 -  Description: Показать версию APD
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strText
.head 5 -  Number: nLength
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( strText, 160 )
.head 5 -  Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
.head 5 -  Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
.head 3 +  Function: Ini031
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars031.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  Call DocWisInit( 'Vkv' )
.head 6 -  ! ! ====================================================
.head 6 -  ! ! dlg_LoadDbf
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTWndTitle','Загрузка файла')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.pbRun','Выполнить')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.pbExit','Отменить')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.pbChoose','Выбрать...')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cbTransCode','Перекодировать из кодировки OEM (DOS) в ANSI (WIN)')
.head 6 -  ! !
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnDelNew','НОВАЯ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNoDelNew','ЗАМЕНА')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNo','ОТКАЗ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNoDelPlusNew1','НОВЫЕ ДАННЫЕ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNoDelPlusNew2','ДОБАВИТЬ')
.head 6 -  ! ! Msg
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsgTable','Таблица')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg11','уже существует (пустая) !')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg12','Удалить таблицу')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg13','и создать НОВУЮ ?')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg21','уже существует c данными !')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg22','Удалить таблицу и создать НОВУЮ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg23','НЕ удалять таблицу, УДАЛИТЬ старые данные')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg24','НЕ удалять таблицу, добавить ТОЛЬКО НОВЫЕ данные')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg25','НЕ удалять таблицу, добавить ВСЕ данные')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsgDel','Невозможно удалить записи из таблицы')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsgFileOk','Обработка файла завершена!')
.head 6 -  ! ! Err
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTErrDir','Не удалось переити в каталог')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTErrDB','Нет доступа к базе данных')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTErrFileOpen','Не удалось открыть файл')
.head 6 -  ! ! Constant
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTLoadFile','Загрузка файла')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTConfirm','Подтверждение')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTQuery','ЗАПРОС')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTLoad','Загрузка')
.head 6 -  ! ! ====================================================
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: CheckTrialVersion
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If GetBankMfo()='380623' and SalDateCurrent()>SalDateConstruct ( 2008, 08, 12, 0, 0, 0 )  
.head 6 -  Call SalMessageBox('Истек ознакомительный период для даной функции. Обратитесь к разроботчику','Триал версия',MB_Ok)
.head 6 -  Call SalDestroyWindow ( hWndForm )
.head 5 +  If GetBankMfo()='300205' and SalDateCurrent()>SalDateConstruct ( 2008, 09, 14, 0, 0, 0 )  
.head 6 -  Call SalMessageBox('Истек ознакомительный период для даной функции. Обратитесь к разроботчику','Триал версия',MB_Ok)
.head 6 -  Call SalDestroyWindow ( hWndForm )
.head 5 +  If GetBankMfo()='353575' and SalDateCurrent()>SalDateConstruct ( 2008, 11, 10, 0, 0, 0 )  
.head 6 -  Call SalMessageBox('Истек ознакомительный период для даной функции. Обратитесь к разроботчику','Триал версия',MB_Ok)
.head 6 -  Call SalDestroyWindow ( hWndForm )
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
.head 3 +  Functional Class: cDocPerekryt
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: bSignInit
.head 4 +  Functions
.head 5 +  Function: sIni
.head 6 -  Description: Инициализировать ЭЦП
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 +  Static Variables
.head 7 -  ! Boolean: bSignInited
.head 7 -  ! Number: nTim
.head 6 +  Local variables
.head 7 -  ! String: strUxDateTime
.head 7 -  String: strDay
.head 7 -  Number: nDay
.head 7 -  Number: nErrorSign
.head 7 -  String: strErrorSign
.head 7 -  String: strPinCode
.head 6 -  Actions
.head 3 +  Functional Class: cDoc_KP_SIGN
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: NLS_CASH
.head 5 -  String: NLS_NLK
.head 5 -  Number: FLI       ! флаг межбанк
.head 4 +  Functions
.head 5 +  Function: pLnk
.head 6 -  Description: Оплата связанных транзакций
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nFlgBlank ! Пустой параметр
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If m_nPyD and (m_nFlg=1 or m_nFlg=2)   ! Визируем только f38 1 и 2
.head 8 +  If not Pay(2,m_nRef,m_dDatV1,'',NUMBER_Null,NUMBER_Null,'',NUMBER_Null,NUMBER_Null,'')
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: iDoc
.head 6 -  Description: Временная блокировка оплаті по факту
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set cDoc.m_nPyD=0   ! Запретить оплату по факт остатку
.head 7 -  Return cDoc.iDoc()
.head 5 +  Function: oDoc
.head 6 -  Description: Оплатить документ
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  While TRUE
.head 8 +  If cDoc.oDoc()
.head 9 +  If FLI = 1
.head 10 +  If not
 cDoc.PayV
(0, cDoc.m_nRef, cDoc.m_dDatV1, cDoc.m_sTT, 1,
 cDoc.A.Kv, NLS_CASH, cDoc.A.S,
 cDoc.B.Kv, NLS_NLK,  cDoc.B.S)
.head 11 -  Break
.head 9 +  If cDoc.m_nFlg = 1
.head 10 +  If not cDoc.P_Fac(cDoc.m_nRef, SalFmtFormatDateTime(cDoc.m_dDatV1, 'MM-dd-yyyy'))
.head 11 -  Break
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 3 +  Functional Class: cDoc_KP_nSIGN
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: NLS_CASH
.head 5 -  String: NLS_NLK
.head 5 -  Number: FLI       ! флаг межбанк
.head 4 +  Functions
.head 5 +  Function: pLnk
.head 6 -  Description: Оплата связанных транзакций
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nFlgBlank ! Пустой параметр
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If m_nPyD and (m_nFlg=1 or m_nFlg=2)   ! Визируем только f38 1 и 2
.head 8 +  If not Pay(2,m_nRef,m_dDatV1,'',NUMBER_Null,NUMBER_Null,'',NUMBER_Null,NUMBER_Null,'')
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 3 -  !
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbGetValue
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table: cQuickTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column: cGenColComboBox_NumId
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 +  Form Window: KP
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    0.438"
.head 4 -  Width:  13.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.643"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Комунальные платежи
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  ! ! ПЕЧАТЬ тикетов:
1.Нахальная перчать :
  Тикеты на комисии и
  Тикеты на основные платежи ГОЛУБОЙ таблицы
  печатаются автоматически в момент оплаты (на лист)
2 F5 - печать всех тикетов (осн, ком) на лист
3.Двойным щелчком ЛЕВОЙ мышки на оплаченной строке (ЗЕЛЕНОЙ и ГОЛУБОЙ)
                  печатается тикет на осн.платеж  (оттиск)
4.Щелчком ПРАВОЙ мышки на оплаченной строке с комис (ЗЕЛЕНОЙ и ГОЛУБОЙ)
                  печатается тикет на ком.платеж (на случай замятия)
.head 4 +  Option Button: pbRef
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Відкрити/Закрити колонки Референсів' )
.head 6 +  On SAM_Click
.head 7 -  Call F_Ref( not pbRef)
.head 4 +  Pushbutton: pb_F10
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F10. Ввести '
.head 6 +  On SAM_Click
.head 7 +  If STOTAL > 0 and F_Opl
.head 8 -  Set F_Opl = FALSE
.head 8 -  Call SqlCommit( hSql() )
.head 8 -  Call SalDisableWindow( pb_F1 )
.head 8 -  Call SalDisableWindow( pb_F2 )
.head 8 -  Call SalDisableWindow( pb_F3 )
.head 8 -  Call SalDisableWindow( pb_F4 )
.head 8 -  Call SalDisableWindow( pb_F8 )
.head 8 -  Call SalDisableWindow( pb_F9)
.head 8 +  If f_Opl(rS)
.head 9 -  Call F_Ref (1)
.head 9 -  Call SqlCommit( hSql() )
.head 9 -  Set yRef = 1
.head 9 -  Call SalEnableWindow( pbRef )
.head 9 -  If SalStrUpperX( Subs(strPar02,1,1) )='N' ! нахальная печать NO
.head 9 +  Else ! YES
.head 10 -  Call F_Print(1)
.head 9 -  Call SalDisableWindow( T1.S )
.head 9 -  Call SalDisableWindow( T1.P )
.head 9 -  Call SalDisableWindow( T2.S )
.head 9 -  Call SalDisableWindow( T2.P )
.head 9 -  Call SalDisableWindow( T2.NAMK )
.head 9 -  Call SalDisableWindow( T2.MFOK )
.head 9 -  Call SalDisableWindow( T2.OKPOK )
.head 9 -  Call SalDisableWindow( T2.NLSK )
.head 9 -  Call SalDisableWindow( pb_F10 )
.head 9 -  Call SalDisableWindow( D1 )
.head 9 -  Call SalTblReset( D1 )
.head 9 -  !
.head 9 -  Call MessageNoWait('Введено пачку документів ','Повідомлення',3,0)
.head 9 -  Call SalEnableWindow( pb_F5 )
.head 9 -  !
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalDisableWindow( pbRef )
.head 9 -  Set F_Opl = TRUE
.head 9 -  Call SalEnableWindow( pb_F1 )
.head 9 -  Call SalEnableWindow( pb_F2 )
.head 9 -  Call SalEnableWindow( pb_F3 )
.head 9 -  Call SalEnableWindow( pb_F4 )
.head 9 -  Call SalEnableWindow( pb_F8 )
.head 9 -  Call SalEnableWindow( pb_F9)
.head 9 -  Call MessageNoWait( IifS( rS !=NUMBER_Null, 'Сума док='||Str(rS), '' )|| sErr, 'Помилка !', 0, 1)
.head 4 +  Pushbutton: pb_F5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F5. Надрукувати ПАЧКУ оплачених документів'
.head 6 +  On SAM_Click
.head 7 -  Call F_Print(2)
.head 4 +  Pushbutton: pb_Print1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.067"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =
'Page
Down - Надрукувати квитанцію на поточний введений документ'
.head 6 +  On SAM_Click
.head 7 +  If nTAB = 1 and T1.S != NUMBER_Null
.head 8 +  If f_Prov1()
.head 9 -  Call F_Ottisk(T1.NAMK, dFIO, T1.S, T1.S2)
.head 9 -  ! Number: nSUMB
.head 9 -  ! Number: nSUMBK
.head 8 +  ! Else
.head 9 -                                                                      Call MessageNoWait( 'Сума док='|| Str(T1.S ) || sErr, 'Помилка !', 0, 1)
.head 7 +  Else If nTAB = 2 and T2.S != NUMBER_Null
.head 8 +  If f_Prov2()
.head 9 -  Call F_Ottisk(T2.NAMK, dFIO, T2.S, T2.S2)
.head 8 +  ! Else
.head 9 -                                                                      Call MessageNoWait( 'Сума док='|| Str(T2.S )|| sErr, 'Помилка !', 0, 1)
.head 4 +  Pushbutton: pb_New
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Новий '
.head 6 +  On SAM_Click
.head 7 -  Set F_Opl = FALSE
.head 7 -  Call F_tts()
.head 4 -  Line
.head 5 -  Resource Id: 28576
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.06"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbK_Val
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Купівля ВАЛЮТИ. Оп.'||AA1
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'K_', NLS_CASH, AA1,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 4 +  Pushbutton: pbP_Val
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Salmon
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продаж ВАЛЮТИ. Оп.'|| AA2
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'P_', NLS_CASH, AA2,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 4 -  Line
.head 5 -  Resource Id: 28577
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.95"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  2.95"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'ESC. Завершити  '
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! !
.head 4 +  Pushbutton: pb_Null
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: BankName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.183"
.head 7 -  Top:    0.048"
.head 7 -  Width:  2.967"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: BankOkpo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.617"
.head 7 -  Top:    0.048"
.head 7 -  Width:  2.067"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: BankMfo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.15"
.head 7 -  Top:    0.048"
.head 7 -  Width:  1.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  ! !
.head 4 +  Data Field: DatVal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.8"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NLS_CASH
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.1"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Рахунок каси')
.head 4 +  Data Field: NMS_CASH
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.5"
.head 7 -  Top:    0.095"
.head 7 -  Width:  3.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pb_F11
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.65"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F11
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F11.Установити фокус на "ПРИЙНЯТО" '
.head 6 +  On SAM_Click
.head 7 -  Call SalSetFocus( SNAL )
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F12
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  Set strTip = 'F12.Вибрати доп.реквізит з базового довідника'
.head 6 +  On SAM_Click
.head 7 +  If nBROWSER = 1
.head 8 -  Set sTmp = D1.VALUE
.head 7 +  Else
.head 8 -  Set sTmp = D2.VALUE
.head 7 -  Call SalModalDialog( dlgTagBrowse1, KP , gBROWSER, sTmp )
.head 7 +  If nBROWSER = 1
.head 8 -  Set D1.VALUE = sTmp
.head 8 -  Call SalSendMsg( D1.VALUE, SAM_Validate, 0, 0 )
.head 7 +  Else
.head 8 -  Set D2.VALUE = sTmp
.head 8 -  Call SalSendMsg( D2.VALUE, SAM_Validate, 0, 0 )
.head 4 +  Pushbutton: pb_F6
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F6
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF6_.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F6.Наслідувати доп.реквізити (*) з поперед.операції'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "UPDATE tmp_operw t
   SET value = (select MAX(value) from tmp_operw where tag=t.tag and value is not null)
WHERE value is null and
      tt=decode(:nTAB,1,:T1.TT, :T2.TT) and nom=decode(:nTAB,1,:T1.NOM,:T2.NOM) and
 tag in (select tag from OP_FIELD where substr(name,1,1)='*') ")
.head 8 -  Set nNOM = -1
.head 8 +  If nTAB = 2
.head 9 -  Call SalSetFocus( T2 )
.head 9 -  Call SalTblSetFocusRow( T2, nRow2 )
.head 9 -  Call SalSendMsg( T2, SAM_RowSetContext, 0, 0 )
.head 8 +  Else
.head 9 -  Call SalSetFocus( T1 )
.head 9 -  Call SalTblSetFocusRow( T1, nRow1 )
.head 9 -  Call SalSendMsg( T1, SAM_RowSetContext, 0, 0 )
.head 2 +  Contents
.head 3 +  Pushbutton: pb_F1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    0.012"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F1.Розмножити БЛАНК ОТРИМУВАЧА '
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (1)
.head 6 -  Call SalSetFocus(pb_F2)
.head 6 -  Call SalSetFocus(T1)
.head 6 -  Call SalTblSetFocusRow(T1, nRow )
.head 6 -  Call SalTblSetFocusCell(T1, nRow, T1.S, 0, -1)
.head 3 +  Pushbutton: pb_F4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.567"
.head 5 -  Top:    0.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F4
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F4. Розмножити з реквізитами ПЛАТНИКА '
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (4)
.head 6 -  Call SalSetFocus(pb_F2)
.head 6 -  Call SalSetFocus(T1)
.head 6 -  Call SalTblSetFocusRow(T1, nRow )
.head 6 -  Call SalTblSetFocusCell(T1, nRow, T1.S, 0, -1)
.head 3 -  !
.head 3 +  Pushbutton: pb_F2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F2.Розмножити БЛАНК'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (2)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Light Aqua
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F3.Розмножити з реквізитами ОТРИМУВАЧА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (3)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.033"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF8_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Light Periwinkle
.head 4 -  Background Color: Cyan
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8.Розмножити з реквізитами ПЛАТНИКА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (8)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.483"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F9
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF9_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Light Periwinkle
.head 4 -  Background Color: Dark Aqua
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F9.Розмножити з реквізитами ОТРИМУВАЧА та ПЛАТНИКА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (9)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 -  !
.head 3 +  Child Table: T1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    0.321"
.head 6 -  Width:  8.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: NOM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SKP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отримувач по ГЕН.Угоді
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО-Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платіж
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If T1.S != NUMBER_Null
.head 9 -  Call SalMapEnterToTab( FALSE )
.head 8 +  Else
.head 9 -  Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Call KP.f_Tochka ( 1, T1.S, NLS_CASH, BankMfo, NLSK, T1.S, T1.fS2 )
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_Enter and T1.S != NUMBER_Null
.head 9 -  Call SalSetFocus(NAZN1)
.head 9 -  ! Call SalSetFocus(D1)
.head 9 -  ! Call SalTblSetFocusRow(D1,0)
.head 9 -  ! Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( pb_Print1, COLOR_IndexWindow, COLOR_LightGreen )
.head 7 -  !
.head 5 +  Column: S2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-1
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VOB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZ_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доч оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: fS2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Форм ком
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: P
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пеня
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_FIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NFILE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: f1
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTAB = 1
.head 7 -  Set NAZN1 = IifS( T1.NAZ_TT = STRING_Null, T1.NAM_TT, T1.NAZ_TT )
.head 7 -  Set NAM_TT1 = T1.NAM_TT
.head 7 +  If T1.TT = sTT and T1.NOM = nNOM
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Set sTT = T1.TT
.head 7 -  Set nNOM = T1.NOM
.head 7 -  Set sNAMK= T1.NAMK
.head 7 -  Set nRow = SalTblQueryContext( T1 )
.head 7 -  Set nRow1  = nRow
.head 7 +  If nRow > 13
.head 8 -  Set nRow = 13
.head 7 -  !
.head 7 -  Call SalTblPopulate(D1, hSql(),
 "SELECT o.tag, o.value, f.name, f.CHKR,  f.BROWSER, o.DVAL, o.OPT
  INTO :D1.TAG, :D1.VALUE, :D1.NAM_TAG, :D1.CHKR, :D1.BROWSER, :D1.DVAL, :D1.OPT
  FROM tmp_operw o, OP_FIELD f
  WHERE o.tag=f.tag and o.tt=:T1.TT and o.nom = :T1.NOM
  ORDER BY ord " , TBL_FillAll)
.head 7 -  Call SalTblSetContext( D1, 0 )
.head 7 -  Call SalTblSetRowFlags( D1, 0, ROW_Selected, TRUE )
.head 7 -  Call SalSendMsg( D1, SAM_RowSetContext, 0,0)
.head 7 -  Call SalEnableWindow (D1)
.head 7 -  Call SalDisableWindow (D2)
.head 7 -  Call SalDisableWindow (NAZN2)
.head 7 -  Return TRUE
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  ! Подвести доп.табл
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( KP.T1, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call T1.f1( )
.head 5 +  On SAM_RowSetContext
.head 6 -  Call T1.f1( )
.head 5 -  ! Печатать тикет
.head 5 +  On SAM_DoubleClick
.head 6 +  If T1.REF1 != NUMBER_Null
.head 7 -  Call DocsPrint ( T1.REF1, 'OPER', FALSE )
.head 5 +  On WM_RbuttonUp
.head 6 +  If T1.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T1.REF2, 'OPER', FALSE )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd1 = not bSortOrd1
.head 6 -  Call SalTblSortRows( KP.T1 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd1 )
.head 3 +  Data Field: NAM_TT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва операції')
.head 3 -  Background Text: Признач.пл.-1
.head 4 -  Resource Id: 28574
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: NAZN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  5.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Призначення платежу-1')
.head 5 +  On SAM_Validate
.head 6 -  Set T1.NAZ_TT = NAZN1
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 +  If NAZN1 = STRING_Null
.head 7 -  Set NAZN1 = T1.NAM_TT
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 5 -  !
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D1)
.head 7 -  Call SalTblSetFocusRow(D1,0)
.head 7 -  Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 3 +  Child Table: D1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.9"
.head 6 -  Top:    0.31"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.762"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: TAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вопрос
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VALUE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Деталі
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalMapEnterToTab( TRUE )
.head 8 -  Set nBROWSER = 1
.head 8 +  If Subs(D1.TAG,1,3)='FIO' and D1.VALUE = STRING_Null and dFIO != STRING_Null
.head 9 -  Set D1.VALUE = dFIO
.head 9 -  Set T1.NAM_FIO = dFIO
.head 9 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 -  Call F_Focus (D1.DVAL, D1.BROWSER)
.head 7 +  On SAM_Validate
.head 8 -  Set D1.VALUE = SalStrTrimX( D1.VALUE )
.head 8 -  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE), D1.OPT  )
.head 8 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 +  If Subs(D1.TAG,1,3)='?LC'
.head 9 +  If D1.VALUE  != STRING_Null
.head 10 -  Set sLC = D1.VALUE
.head 10 +  If SqlPrepareAndExecute( hSql(),
  "SELECT S, fio, Nvl(TAG,0)
   INTO :T1.S, :dFIO , :nTag
   FROM KP_FILE
   WHERE tt=:T1.TT and lc=:sLC ")
and not SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Call SalMessageBox(" LC="|| D1.VALUE ||" не знайдено в БД (KP_FILE), tt=" ||T1.TT ,
 "УВАГА !", MB_IconStop )
.head 10 +  Else
.head 11 -  Set T1.NAM_FIO = dFIO
.head 11 -  Call SalSendMsg( T1.S, SAM_Validate, 0, 0 )
.head 11 +  If nTag = 1
.head 12 -  Set nRowD1 = TBL_MinRow
.head 12 +  While SalTblFindNextRow( D1, nRowD1, 0, 0 )
.head 13 -  Call SalTblSetContext( D1, nRowD1 )
.head 13 -  If SqlPrepareAndExecute( hSql(),
"SELECT value INTO :D1.VALUE
 FROM KP_TAG where TT=:T1.TT and LC=:sLC and TAG=:D1.TAG")
and SqlFetchNext( hSql(), nFetchRes )
and SqlPrepareAndExecute( hSql(),
"UPDATE tmp_operw
 SET VALUE =:D1.VALUE
 WHERE tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM")
.head 9 +  Else
.head 10 -  Call SalMessageBox(" LC="|| D1.VALUE ||" НЕ заповнено ! ", "УВАГА !", MB_IconStop )
.head 8 +  If Subs(D1.TAG,1,3)='FIO'
.head 9 -  Set T1.NAM_FIO = dFIO
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_PageDown and T1.S != NUMBER_Null
.head 9 -  Call SalSendMsg( pb_Print1, SAM_Click, 0, 0 )
.head 5 +  Column: CHKR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BROWSER
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DVAL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTag
.head 5 -  Number: nRowD1
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Green )
.head 6 +  Else
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, nCol1 )
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblSetColumnTitle( D1.VALUE, D1.NAM_TAG )
.head 6 -  Call SalSendMsg( D1.VALUE, SAM_SetFocus, 0, 0 )
.head 5 -  On SAM_SetFocus
.head 3 -  !
.head 3 +  Child Table: T2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    2.548"
.head 6 -  Width:  8.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.393"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: NOM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SKP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 +  ! If SKP =NUMBER_Null
.head 9 -                                                                                                   Set T2.SKP = 5
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Set dTmp ='Помилка СКП'
.head 8 +  If SqlPrepareAndExecute( hSql(), "SELECT name INTO :dTmp from sk where sk=:T2.SKP and sk <40 " )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Cancel
.head 5 +  Column: NAMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: безпосередній Отримувач
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 5 +  Column: MFOK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 +  If FLI = 0 and MFOK = STRING_Null and KP_SIGN =1
.head 9 -  Set MFOK = BankMfo
.head 9 -  Set dTmp = BankName
.head 8 -  ! Call T2.f1()
.head 8 -  ! Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Set T2.MFOK=SalStrTrimX(T2.MFOK)
.head 8 +  If T2.MFOK = STRING_Null
.head 9 -  Set S =0
.head 9 -  Call SalSendMsg( T2.S, SAM_AnyEdit, 0, 0 )
.head 9 -  Call SalSendMsg( T2.S, SAM_Validate, 0, 0 )
.head 9 -  Return VALIDATE_Ok
.head 8 +  If not IsValidMFO( T2.MFOK )
.head 9 -  Set dTmp ='Помилка МФО-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 +  ! If FLI = 0 and T2.MFOK !=BankMfo
or T2.MFOK != STRING_Null and
   SqlPrepareAndExecute( hSql(),"SELECT nb INTO :dTmp from banks where nvl(blk,0)<>4 and mfo=:T2.MFOK" )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SqlPrepareAndExecute( hSql(),"SELECT nb INTO :dTmp from banks where nvl(blk,0)<>4 and mfo=:T2.MFOK" )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Set dTmp ='Помилка МФО-Б'
.head 8 -  Return VALIDATE_Cancel
.head 5 +  Column: NLSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.NLSK != STRING_Null and T2.NLSK != KeyAccount(T2.MFOK,T2.NLSK)
or T2.MFOK = BankMfo and
SqlPrepareAndExecute( hSql(),"SELECT a.nms, c.okpo INTO :T2.NAMK,:T2.OKPOK
 FROM accounts a, cust_acc u, customer c
 WHERE a.kv=:n980 and a.nls=:T2.NLSK and a.acc=u.acc and u.rnk=c.rnk " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set dTmp ='Помилка Рах-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dTmp = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: OKPOK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ід.код-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If OKPOK = STRING_Null
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalStrLength(OKPOK) < 8
.head 9 -  Set dTmp = 'Помилка Ід.код-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If SalStrLength(OKPOK) = 8 and OKPOK != V_Okpo(OKPOK)
.head 9 -  Set dTmp = 'Помилка Ід.код-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dTmp = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платіж
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If T2.S != NUMBER_Null
.head 9 -  Call SalMapEnterToTab( FALSE )
.head 8 +  Else
.head 9 -  Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Call KP.f_Tochka ( 2, T2.S, NLS_CASH, MFOK, NLSK, T2.S, T2.fS2 )
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_Enter and T2.S != NUMBER_Null
.head 9 -  Call SalSetFocus(NAZN2)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( pb_Print1, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  Column: S2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VOB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-1
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZ_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доч оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: fS2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Форм ком
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: P
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пеня
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FLI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаг МБ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_FIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 4 +  Functions
.head 5 +  Function: f1
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTAB = 2
.head 7 -  Set NAZN2 = T2.NAZ_TT
.head 7 -  Set NAM_TT2 =T2.NAM_TT
.head 7 +  If T2.TT = sTT and T2.NOM = nNOM
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Set sTT = T2.TT
.head 7 -  Set nNOM = T2.NOM
.head 7 -  Set sNAMK= T2.NAMK
.head 7 -  Set nRow = SalTblQueryContext( T2 )
.head 7 -  Set nRow2  = nRow
.head 7 +  If nRow > 2
.head 8 -  Set nRow =2
.head 7 -  !
.head 7 -  Call SalTblPopulate(D2, hSql(),
 "SELECT o.tag, o.value, f.name, f.CHKR, f.BROWSER, o.DVAL, o.OPT
  INTO :D2.TAG, :D2.VALUE, :D2.NAM_TAG, :D2.CHKR, :D2.BROWSER, :D2.DVAL, :D2.OPT
  FROM tmp_operw o, OP_FIELD f
  WHERE o.tag=f.tag and o.tt=:T2.TT and o.nom = :T2.NOM
  ORDER BY ord " , TBL_FillAll)
.head 7 -  Call SalSetFocus( NAZN2 )
.head 7 -  Call SalDisableWindow (D1)
.head 7 -  Call SalEnableWindow (D2)
.head 7 -  Call SalEnableWindow (NAZN2)
.head 7 -  Return TRUE
.head 5 +  Function: f_ALIEN
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: FLI       ! флаг межбанк
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp
.head 7 -  String: sNSI
.head 6 +  Actions
.head 7 -  Set dTmp = STRING_Null
.head 7 -  Set sNSI = " kv=" || Str(n980) || " and NLSALT is not null "
.head 7 +  If KP_SIGN =1
.head 8 -  Set sNSI = sNSI || " and  mfo " || IifS( FLI=1, "<>", "=" ) || BankMfo
.head 7 -  Set sNSI = sNSI || " order by nlsalt "
.head 7 -  Call FunNSIGetFiltered('ALIEN','NLSALT', sNSI, sTmp, sNlsAlt )
.head 7 +  If sTmp =  STRING_Null
.head 8 -  Return FALSE
.head 7 -  Return 
SqlPrepareAndExecute( hSql(),
   "SELECT MFO, NLS, OKPO, substr(ltrim(rtrim(NAME)),1,38)
    INTO :MFOK, :NLSK, :OKPOK, :NAMK FROM alien WHERE nlsalt=:sNlsAlt " )
and
SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  ! Подвести доп.табл
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( KP.T2, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call T2.f1()
.head 5 +  On SAM_RowSetContext
.head 6 -  Call T2.f1()
.head 5 -  ! Печатать тикет
.head 5 +  On SAM_DoubleClick
.head 6 +  If T2.REF1 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF1, 'OPER', FALSE )
.head 6 +  Else
.head 7 -  Call T2.f_ALIEN (T2.FLI)
.head 5 +  On WM_RbuttonUp
.head 6 +  If T2.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF2, 'OPER', FALSE )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd2 = not bSortOrd2
.head 6 -  Call SalTblSortRows( KP.T2 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd2 )
.head 3 +  Data Field: NAM_TT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.155"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва операції')
.head 3 +  Data Field: dfTextNAZN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NAZN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    4.024"
.head 6 -  Width:  6.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Cyan
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Призначення платежу-2')
.head 5 +  On SAM_Validate
.head 6 +  If NAZN2 = STRING_Null or SalStrLength( NAZN2 ) < 3
.head 7 -  Call SalMessageBox("Не заповнено Призначення платежу", "Увага !", MB_IconStop)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set T2.NAZ_TT = NAZN2
.head 6 -  Return VALIDATE_Ok
.head 6 -  !
.head 5 +  On VTM_LeftDoubleClick
.head 6 -  Set sTipNazn = SalStrLeftX( SalStrRightX( '000000'||sNlsAlt, 6 ), 3 )
.head 6 -  ! Set sTipNazn = STRING_Null
.head 6 -  Call FunNSIGetFiltered('ALIEN_NAZN','NAZN',
    ' IDT= '|| sTipNazn ||' or IDT is null  order by IDN', sTipNazn, NAZN2 )
.head 6 -  Call SalSendMsg( NAZN2, SAM_Validate, 0, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D2)
.head 7 -  Call SalTblSetFocusRow(D2,0)
.head 7 -  Call SalTblSetFocusCell(D2, 0, D2.VALUE, 0, -1)
.head 3 +  Child Table: D2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.393"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.524"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: TAG ! 1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TAG ! 2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вопрос
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VALUE ! 3
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Деталі
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nBROWSER = 2
.head 8 +  If Subs(D2.TAG,1,3) ='FIO' and D2.VALUE = STRING_Null and dFIO != STRING_Null
.head 9 -  Set D2.VALUE = dFIO
.head 9 -  Set T2.NAM_FIO = dFIO
.head 9 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D2.VALUE where tt=:T2.TT and tag=:D2.TAG and nom=:T2.NOM ")
.head 8 -  Call F_Focus (D2.DVAL, D2.BROWSER)
.head 7 +  On SAM_Validate
.head 8 -  If not F_Tag( D2.CHKR, SalStrTrimX(D2.TAG), SalStrTrimX(D2.VALUE), D2.OPT )
.head 8 +  If Subs(D2.TAG,1,3)='FIO'
.head 9 -  Set T2.NAM_FIO = dFIO
.head 8 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D2.VALUE where tt=:T2.TT and tag=:D2.TAG and nom=:T2.NOM ")
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_PageDown and T2.S != NUMBER_Null
.head 9 -  Call SalSendMsg( pb_Print1, SAM_Click, 0, 0 )
.head 7 -  !
.head 5 +  Column: CHKR  ! 4
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BROWSER ! 6
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DVAL ! 7
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPT ! 8
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )
.head 6 +  Else
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 ) ) ! голубой
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblSetColumnTitle( D2.VALUE, D2.NAM_TAG )
.head 6 -  ! Call SalSendMsg( D2.VALUE, SAM_SetFocus, 0, 0 )
.head 3 +  Data Field: SNAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    4.714"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Прийнято у клієнта')
.head 5 +  On SAM_SetFocus
.head 6 +  If SNAL = 0
.head 7 -  Set SNAL = NUMBER_Null
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_KillFocus
.head 6 -  Call KP.f_Tochka ( 0, NUMBER_Null, STRING_Null,STRING_Null,STRING_Null, SNAL,  STRING_Null )
.head 6 +  If STOTAL > 0
.head 7 +  If SNAL < STOTAL or SNAL=NUMBER_Null
.head 8 -  Call SalMessageBox(" НЕДОСТАТЧА коштів, чи помилка суми ! ", "УВАГА !", MB_IconStop)
.head 8 -  Set SNAL = NUMBER_Null
.head 8 -  Set SDEL = 0
.head 7 +  Else
.head 8 -  Set SDEL = SNAL - STOTAL
.head 8 -  Set ml1 = SumPr(  STOTAL *100, 'F', 'Грн' , "коп" )
.head 8 -  Set ml2 = SumPr(  SDEL *100, 'F', 'Грн' , "коп" )
.head 8 -  Set ml3 = NumberPr( SKOL, "M" )
.head 8 +  If yRef = 0
.head 9 -  Call SalEnableWindow( pb_F10 )
.head 9 -  Set F_Opl = TRUE
.head 5 -  !
.head 3 -  !
.head 3 +  Data Field: NLS_NLK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.012"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Рахунок-транзит (без ген.угоди)')
.head 3 -  !
.head 3 -  Background Text: Платник
.head 4 -  Resource Id: 28575
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.524"
.head 5 -  Width:  0.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dTmp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    5.167"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Підказки')
.head 3 +  Data Field: dFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.762"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Cyan
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'ПІБ')
.head 3 +  Data Field: STOTAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    4.321"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів')
.head 3 +  Data Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.167"
.head 6 -  Top:    4.369"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів прописом')
.head 3 +  Data Field: SDEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    5.119"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту')
.head 3 +  Data Field: ml2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    5.167"
.head 6 -  Width:  4.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту прописом')
.head 3 +  Data Field: ml3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.45"
.head 6 -  Top:    4.762"
.head 6 -  Width:  3.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів прописом')
.head 3 +  Data Field: SKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    4.714"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів')
.head 3 +  Data Field: KKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    4.714"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість комісій')
.head 3 +  Data Field: sTOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.369"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.25"
.head 6 -  Top:    4.0"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTextSTOTAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTextSNAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTextSDEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_tts
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Подготовить таблиці
.head 5 -  Set F_Opl = FALSE
.head 5 -  Call SalDisableWindow( pb_F10 )
.head 5 -  Call SalDisableWindow( pb_F5 )
.head 5 -  Call SalEnableWindow( SNAL )
.head 5 -  Set dTmp = STRING_Null
.head 5 -  Set dFIO = STRING_Null
.head 5 -  Set STOTAL = 0
.head 5 -  Set ml1 = ""
.head 5 -  Set SDEL = 0
.head 5 -  Set ml2 = ""
.head 5 -  Set ml3 = ""
.head 5 -  Set SNAL = 0
.head 5 -  Set SKOL = 0
.head 5 -  Set KKOL = 0
.head 5 -  Set yRef = 0
.head 5 -  !
.head 5 -  Set sTT= '   '
.head 5 -  Set nNOM = 0
.head 5 -  Set g_NOM = 0
.head 5 -  If SqlPrepareAndExecute( hSql(), "delete from tmp_operw ") and
  SqlPrepareAndExecute( hSql(),
  "insert into tmp_operw (tt,tag,NOM, ord, VALUE,  DVAL, OPT )
   select tt, tag, 0, ord, val,  VAL, OPT
   from OP_RULES WHERE USED4INPUT=1 and TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) ")
.head 5 -  !
.head 5 -  Call SalDisableWindow (D1)
.head 5 -  Call SalTblReset( T1 )
.head 5 -  Call SalTblReset( D1 )
.head 5 -  Set NAZN1 = STRING_Null
.head 5 -  Call SalEnableWindow( T1.P )
.head 5 -  Call SalEnableWindow( T1.S )
.head 5 -  Call SalEnableWindow( pb_F1 )
.head 5 -  Call SalEnableWindow( pb_F4 )
.head 5 -  Call SalEnableWindow( pb_F2 )
.head 5 -  Call SalEnableWindow( pb_F3 )
.head 5 -  Call SalEnableWindow( pb_F8 )
.head 5 -  Call SalEnableWindow( pb_F9 )
.head 5 -  ! зеленіе операции
.head 5 -  Call SalTblPopulate(T1, hSql(),
 "SELECT T.tt, a.NLS, substr(a.nms,1,38), NVL(t.NAZN, t.name),
         C.OKPO, v.VOB, 0, d.tt, d.s, nvl(t.sk,5)
  into :T1.TT,:T1.NLSK,:T1.NAMK,:T1.NAM_TT,
       :T1.OKPOK,:T1.VOB,:T1.NOM,:T1.TT2,:T1.fS2,:T1.SKP
  FROM tts T, ACCOUNTS A, CUST_ACC U, CUSTOMER C, tts_vob v, tts d, ttsap ap
  WHERE v.tt=t.tt and A.KV=:n980 AND A.NLS=T.NLSA AND A.ACC=U.ACC AND U.RNK=C.RNK AND
        t.nlsa is not null and t.nlsa<>:NLS_NLK and
        t.nlsb is null and
        T.TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) and
        t.tt = ap.tt (+) and d.tt (+) = ap.ttap
   ORDER BY a.nms " , TBL_FillAll)
.head 5 -  !
.head 5 -  Set bSortOrd1 = FALSE
.head 5 -  Call SalTblReset( T2 )
.head 5 -  Call SalTblReset( D2 )
.head 5 -  Call SalEnableWindow( T2.P )
.head 5 -  Call SalEnableWindow( T2.S )
.head 5 -  Call SalEnableWindow( T2.NAMK )
.head 5 -  Call SalEnableWindow( T2.MFOK )
.head 5 -  Call SalEnableWindow( T2.OKPOK )
.head 5 -  Call SalEnableWindow( T2.NLSK )
.head 5 -  Call SalEnableWindow (D2)
.head 5 -  Set NAZN2 = STRING_Null
.head 5 -  Call SalTblPopulate(T2, hSql(),
 "SELECT T.tt, t.name,  v.VOB, 0, d.tt, d.s, t.FLI,  t.sk
  into :T2.TT, :T2.NAM_TT, :T2.VOB,:T2.NOM, :T2.TT2, :T2.fS2, :T2.FLI, :T2.SKP
  FROM tts T, tts_vob v, tts d, ttsap ap
  WHERE v.tt=t.tt  AND t.fli<=:KP_SIGN and
        (t.nlsa=:NLS_NLK or t.nlsa is null ) and t.nlsb is null  and
        T.TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) and
        t.tt = ap.tt (+) and d.tt (+) = ap.ttap
ORDER BY t.name " , TBL_FillAll)
.head 5 -  Set bSortOrd2 = FALSE
.head 5 -  Call SalDisableWindow( pbRef )
.head 5 -  Call F_Ref (0)
.head 5 -  Call SalSetFocus( T1 )
.head 5 -  Call SalTblSetRow( T1, TBL_MinRow )
.head 5 -  Call SalSetFocus( T1.S )
.head 3 +  Function: Fb_FK
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nFK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TT_
.head 5 -  String: NAM_TT_
.head 5 -  String: NFILE_
.head 5 -  Number: VOB_
.head 5 -  Number: SKP_
.head 5 -  Number: NOM_
.head 5 -  Number: FLI_
.head 5 -  String: TT2_
.head 5 -  String: fS2_
.head 5 -  !
.head 5 -  String: NAMK_
.head 5 -  String: MFOK_
.head 5 -  String: OKPOK_
.head 5 -  String: NLSK_
.head 5 -  String: NAM_FIO_
.head 4 +  Actions
.head 5 -  Set g_NOM  = g_NOM + 1
.head 5 -  ! Голубая
.head 5 +  If (nFK = 2 or nFK = 8) or (nFK = 3 or nFK = 9)
.head 6 -  Set NAM_FIO_ = T2.NAM_FIO
.head 6 -  Set TT_  = T2.TT
.head 6 -  Set SKP_  = T2.SKP
.head 6 -  Set FLI_ = T2.FLI
.head 6 -  Set NAM_TT_=T2.NAM_TT
.head 6 -  Set TT2_ = T2.TT2
.head 6 -  Set fS2_ = T2.fS2
.head 6 -  Set VOB_ = T2.VOB
.head 6 -  Set NOM_ = T2.NOM
.head 6 +  If nFK = 3 or nFK = 9
.head 7 -  Set NAMK_= T2.NAMK
.head 7 -  Set MFOK_= T2.MFOK
.head 7 -  Set OKPOK_=T2.OKPOK
.head 7 -  Set NLSK_= T2.NLSK
.head 6 -  !
.head 6 -  Set nRow = SalTblQueryContext ( T2 )
.head 6 -  Set nRow = SalTblInsertRow( T2, nRow + 1)
.head 6 -  Call SalTblSetContext(T2, nRow )
.head 6 -  Call SalTblSetRowFlags( T2, nRow, ROW_New, FALSE )
.head 6 -  !
.head 6 -  Set T2.NAM_FIO = NAM_FIO_
.head 6 -  Set T2.TT  = TT_
.head 6 -  Set T2.SKP = SKP_
.head 6 -  Set T2.FLI = FLI_
.head 6 -  Set T2.NAM_TT=NAM_TT_
.head 6 -  Set T2.TT2 = TT2_
.head 6 -  Set T2.fS2 = fS2_
.head 6 -  Set T2.VOB = VOB_
.head 6 -  Set T2.NOM = g_NOM
.head 6 +  If nFK = 3 or nFK = 9
.head 7 -  Set T2.NAMK = NAMK_
.head 7 -  Set T2.MFOK = MFOK_
.head 7 -  Set T2.OKPOK= OKPOK_
.head 7 -  Set T2.NLSK = NLSK_
.head 7 -  Set T2.NAZ_TT = NAZN2
.head 5 -  ! Зеленая
.head 5 +  Else If nFK = 1 or nFK = 4
.head 6 -  Set NAM_FIO_ = T1.NAM_FIO
.head 6 -  Set TT_  = T1.TT
.head 6 -  Set SKP_ = T1.SKP
.head 6 -  Set NAM_TT_=T1.NAM_TT
.head 6 -  Set TT2_ = T1.TT2
.head 6 -  Set fS2_ = T1.fS2
.head 6 -  Set VOB_ = T1.VOB
.head 6 -  Set NOM_ = T1.NOM
.head 6 -  Set NAMK_= T1.NAMK
.head 6 -  Set OKPOK_=T1.OKPOK
.head 6 -  Set NLSK_= T1.NLSK
.head 6 -  Set NFILE_=T1.NFILE
.head 6 -  !
.head 6 -  Set nRow = SalTblQueryContext ( T1 )
.head 6 -  Set nRow = SalTblInsertRow( T1, nRow + 1)
.head 6 -  Call SalTblSetContext(T1, nRow )
.head 6 -  Call SalTblSetRowFlags( T1, nRow, ROW_New, FALSE )
.head 6 -  !
.head 6 -  Set T1.NAM_FIO = NAM_FIO_
.head 6 -  Set T1.TT  = TT_
.head 6 -  Set T1.NFILE=NFILE_
.head 6 -  Set T1.SKP = SKP_
.head 6 -  Set T1.NAM_TT=NAM_TT_
.head 6 -  Set T1.NAZ_TT=NAM_TT_
.head 6 -  Set T1.TT2 = TT2_
.head 6 -  Set T1.fS2 = fS2_
.head 6 -  Set T1.VOB = VOB_
.head 6 -  Set T1.NAMK= NAMK_
.head 6 -  Set T1.OKPOK=OKPOK_
.head 6 -  Set T1.NLSK= NLSK_
.head 6 -  Set T1.NOM = g_NOM
.head 6 +  If nFK = 1
.head 7 -  Set T1.NAZ_TT = NAZN1
.head 5 -  !
.head 5 -  If SqlPrepareAndExecute( hSql(),
 "INSERT INTO tmp_operw ( tt, tag, NOM, VALUE, ord,  BROWSER, DVAL, OPT )
  SELECT tt, tag, :g_NOM,
        Decode( :nFK, 1,DVAL, 2,DVAL,3,DVAL, VALUE ),
        ord,  BROWSER, DVAL, OPT
   from tmp_operw where TT=:TT_ and nom=:NOM_ ")
.head 5 -  Return TRUE
.head 3 +  Function: f_Tochka
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMod
.head 5 -  Number: S
.head 5 -  String: NLSA
.head 5 -  String: MFOB
.head 5 -  String: NLSB
.head 5 -  Window Handle: hWnd
.head 5 -  String: sS2
.head 4 +  Static Variables
.head 5 -  String: sTmp
.head 4 +  Local variables
.head 5 -  String: aS
.head 5 -  String: sSQL
.head 5 -  Number: nS2
.head 4 +  Actions
.head 5 -  Set nROW1 = SalTblQueryContext ( T1 )
.head 5 -  Set nROW2 = SalTblQueryContext ( T2 )
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 +  If nMod >0
.head 6 -  !
.head 6 -  ! Формула суммы комиссии #(S), #(KVA), #(KVB), #(NLSA), #(NLSB), #(MFOA), #(MFOB)
.head 6 +  If sS2 != STRING_Null and S > 0
.head 7 -  Set sSQL = SalStrUpperX(' ' || sS2 )
.head 7 -  Set sSQL = ' ' || sS2
.head 7 -  Set aS  = SalNumberToStrX(S * 100, 0)     ! Сумма платежа
.head 7 +  While SalStrScan( sSQL, '#(S)' ) > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL, '#(S)' ), 4, aS )
.head 7 +  While SalStrScan( sSQL, '#(KVA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(KVA)'), 6, Str(n980))
.head 7 +  While SalStrScan( sSQL, '#(KVB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(KVB)'), 6, Str(n980))
.head 7 +  While SalStrScan( sSQL, '#(NLSA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(NLSA)'), 7, NLSA)
.head 7 +  While SalStrScan( sSQL, '#(NLSB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(NLSB)'), 7, NLSB)
.head 7 +  While SalStrScan( sSQL, '#(MFOA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(MFOA)'), 7, BankMfo )
.head 7 +  While SalStrScan( sSQL, '#(MFOB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(MFOB)'), 7, MFOB )
.head 7 -  Set sSQL = "SELECT ROUND(" || sSQL || ",0) INTO :nS2 FROM dual"
.head 7 +  If SqlPrepareAndExecute( hSql(), sSQL ) and SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Set nS2 = nS2 /100
.head 7 +  Else
.head 8 -  Set nS2 =0
.head 6 +  Else
.head 7 -  Set nS2 = NUMBER_Null
.head 6 +  If nMod = 1
.head 7 -  Call SalSetFocus( NAZN1 )
.head 7 -  ! Call SalTblSetFocusCell( D1, 0, D1.VALUE, 0, 1 )
.head 7 -  ! Call SalSendMsg( D1, SAM_RowSetContext, 0, 0 )
.head 7 -  Set T1.S2 = nS2
.head 6 +  Else
.head 7 -  Call SalSetFocus( NAZN2 )
.head 7 -  Set T2.S2 = nS2
.head 6 -  Set STOTAL =
SalTblColumnSum( T1, SalTblQueryColumnID( T1.S ), 0, 0 ) +
SalTblColumnSum( T1, SalTblQueryColumnID( T1.S2), 0, 0 ) +
SalTblColumnSum( T2, SalTblQueryColumnID( T2.S ), 0, 0 ) +
SalTblColumnSum( T2, SalTblQueryColumnID( T2.S2), 0, 0 )
.head 6 -  Call F_Kol()
.head 5 -  Call SalTblSetContext(T1, nROW1)
.head 5 -  Call SalTblSetContext(T2, nROW2)
.head 5 -  ! Call SalMapEnterToTab( TRUE )
.head 5 -  Return TRUE
.head 3 +  Function: F_Print
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMod
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T1, nRow)
.head 6 +  If T1.REF1 != NUMBER_Null and nMod= 2
.head 7 -  Call DocsPrint ( T1.REF1, 'OPER', FALSE )
.head 6 +  If T1.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T1.REF2, 'OPER', FALSE )
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.REF1 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF1, 'OPER', FALSE )
.head 6 +  If T2.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF2, 'OPER', FALSE )
.head 3 +  Function: F_Kol
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set SKOL = 0
.head 5 -  Set KKOL = 0
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T1, nRow)
.head 6 +  If T1.S > 0
.head 7 -  Set SKOL = SKOL +1
.head 6 +  If T1.S2 > 0
.head 7 -  Set KKOL = KKOL +1
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.S > 0
.head 7 -  Set SKOL = SKOL +1
.head 6 +  If T2.S2 > 0
.head 7 -  Set KKOL = KKOL +1
.head 3 +  Function: F_Tag
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sCHKR
.head 5 -  String: sTag
.head 5 -  String: sValue
.head 5 -  String: sOpt
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bFL
.head 4 +  Actions
.head 5 +  If Subs(sTag,1,3)='FIO' and sValue != STRING_Null
.head 6 -  Set dFIO = sValue
.head 5 -  ! Если sValue = STRING_Null
.head 5 -  ! и не обяз  != M не проверять
.head 5 -  Set bFL = TRUE
.head 5 -  ! Обязательный, но пустой
.head 5 +  If sOpt ='M' and sValue = STRING_Null
.head 6 -  Set bFL = FALSE
.head 5 -  ! не пустой, но есть проверка и он ее не проходит
.head 5 +  If sValue != STRING_Null and sCHKR != STRING_Null
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT C_TAG (:sTag,:sValue) INTO :nC_TAG from dual ")
and SqlFetchNext( hSql(), nFetchRes )
and nC_TAG = 0
.head 7 -  Set bFL = FALSE
.head 5 -  ! Плохо дело
.head 5 +  If not bFL
.head 6 +  If nBROWSER = 1
.head 7 -  Set D1.VALUE = sNOT
.head 7 -  Call XSalTblSetCellBackColor( D1.VALUE , nCol )
.head 6 +  Else
.head 7 -  Set D2.VALUE = sNOT
.head 7 -  Call XSalTblSetCellBackColor( D2.VALUE , nCol )
.head 6 -  Set sErr = " Помилка доп.реквізиту "|| sTag
.head 6 -  Call SalMessageBox( sErr, "Увага !", MB_IconStop)
.head 5 -  Return bFL
.head 3 +  Function: F_Focus
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sVALUE
.head 5 -  String: sBROWSER
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sNOT = sVALUE
.head 5 -  ! Call SalMapEnterToTab( TRUE )
.head 5 +  If sBROWSER != STRING_Null
.head 6 -  Call SalEnableWindow( pbHelp )
.head 6 -  Set gBROWSER = sBROWSER
.head 5 +  Else
.head 6 -  Call SalDisableWindow( pbHelp )
.head 3 +  Function: F_Komis
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nSum !! Сумма комис в коп
.head 5 -  String: TT1  !! Код Осн.оп
.head 5 -  Number: NOM   !! Ном осн.оп
.head 5 -  String: TT2  !! Код ком=доч оп
.head 5 -  String: sFIO !!
.head 5 -  Date/Time: sDate !! дата ввода
.head 5 -  Receive Number: REF2 !!Реф после оплдаты ком
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  Number: nVob
.head 5 -  Number: nRef
.head 5 -  !
.head 5 -  String: NLS6
.head 5 -  String: NMS6
.head 5 -  String: FORMULA6
.head 4 +  Actions
.head 5 -  ! Комиссия
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT t.name, v.vob, translate ( NLSA, '#', ' ' )
 INTO :sNazn,  :nVob, :FORMULA6
 FROM tts  t,  tts_vob v
 WHERE t.tt=:TT2 and v.tt=t.tt" )
  and SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr("|| FORMULA6 || ",1,14) into :NLS6 from dual")
  and SqlFetchNext( hSql(), nFetchRes )
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr(nms,1,38) INTO :NMS6 FROM accounts
 WHERE kv=:n980 and nls = :NLS6 " )
  and SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nRef = NUMBER_Null
.head 8 -  Set sNazn= Subs(sNazn ||IifS(sFIO=STRING_Null,'', '. Платник '|| sFIO),1, 160)
.head 8 -  Call cDoc_KP_SIGN.SetDoc( nRef, TT2, 0, nVob, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS6, NMS6, BankMfo, '', n980, nSum, BankOkpo,
     NLS_CASH, NMS_CASH, BankMfo, '', n980, nSum, BankOkpo,
     sNazn, '',GetIdOper(),'', 5 ,0)
.head 8 +  If not cDoc_KP_SIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 8 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value)
  SELECT :nRef, tag, value
  FROM tmp_operw  WHERE tt=:TT1 and value is not null and nom=:NOM " )
.head 9 -  Return FALSE
.head 8 -  Set REF2 = nRef
.head 7 +  Else
.head 8 -  Call Debug("Не отк счет из формулы счета доходов операции " || TT2 )
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Call Debug("Формула счета доходов операции " || TT2 )
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call Debug("Не описана операция " || TT2 )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: f_Opl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Number: rS
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  Number: nRef
.head 5 -  Date/Time: sDate
.head 5 -  Number: nRowT
.head 5 -  ! Number: nRowD
.head 5 -  String: sNazn
.head 5 -  !
.head 4 +  Actions
.head 5 -  ! последняя проверка доп реквизитов
.head 5 -  Set rS = NUMBER_Null
.head 5 +  If STOTAL > 0 and (SNAL < STOTAL or SNAL=NUMBER_Null)
.head 6 -  Set sErr = " НЕДОСТАТЧА коштів, чи помилка суми !"
.head 6 -  Set SNAL = NUMBER_Null
.head 6 -  Set SDEL = 0
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set nBROWSER = 1
.head 5 -  Set nRowT = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRowT, 0, 0 )
.head 6 -  Call SalTblSetContext( T1, nRowT )
.head 6 +  If T1.S >0
.head 7 +  If not f_Prov1()
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  Set nBROWSER = 2
.head 5 -  Set nRowT = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRowT, 0, 0 )
.head 6 -  Call SalTblSetContext( T2, nRowT )
.head 6 +  If T2.S >0
.head 7 +  If not f_Prov2()
.head 8 -  Return FALSE
.head 6 -  !
.head 5 -  ! -----------------------------
.head 5 -  ! Собственно оплата
.head 5 -  If SqlPrepareAndExecute( hSql(),"SELECT sysdate INTO :sDate FROM dual") and SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! По T1
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set sErr=' Полилка в оплаті'
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T1, nRow )
.head 6 +  If T1.S >0
.head 7 -  Set nRef = NUMBER_Null
.head 7 -  Set nSum = T1.S * 100
.head 7 -  Set sNazn= Subs(IifS( T1.NAZ_TT = STRING_Null or SalStrLength( T1.NAZ_TT  ) < 3,
                      T1.NAM_TT,
                      T1.NAZ_TT ) ||
                IifS(T1.NAM_FIO=STRING_Null,'', '. Платник '|| T1.NAM_FIO) , 1, 160)
.head 7 -  Set rS=T1.S
.head 7 -  Call cDoc_KP_SIGN.SetDoc( nRef, T1.TT, 0, T1.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     T1.NLSK, T1.NAMK, BankMfo, '', n980, nSum, T1.OKPOK ,
     NLS_CASH, NMS_CASH, BankMfo, '', n980, nSum, BankOkpo,
     sNazn, '', GetIdOper(),'', T1.SKP ,0)
.head 7 -  Set cDoc_KP_SIGN.m_nFli = 0
.head 7 +  If not cDoc_KP_SIGN.oDoc()
.head 8 -  Return FALSE
.head 7 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 7 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value) SELECT :nRef, tag, value
  FROM tmp_operw  WHERE tt=:T1.TT and value is not null and nom=:T1.NOM " )
.head 8 -  Return FALSE
.head 7 -  Set T1.REF1 = nRef
.head 7 -  ! Комиссия
.head 7 +  If T1.S2 > 0
.head 8 +  If not F_Komis( T1.S2*100,  T1.TT, T1.NOM, T1.TT2, T1.NAM_FIO, sDate, T1.REF2 )
.head 9 -  Return FALSE
.head 5 -  ! По T2
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T2, nRow )
.head 6 +  If T2.S >0
.head 7 -  Set nRef = NUMBER_Null
.head 7 -  Set nSum = T2.S * 100
.head 7 -  Set rS   =T2.S
.head 7 -  Set sNazn= Subs(T2.NAZ_TT ||IifS(T2.NAM_FIO=STRING_Null,'', '. Платник '|| T2.NAM_FIO) , 1,160)
.head 7 -  ! !!
.head 7 +  If KP_SIGN = 0 and BankMfo != T2.MFOK
.head 8 -  ! МБ, временно внутренний с дальнейшей перекредитовкой)
.head 8 -  Call cDoc_KP_nSIGN.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS_CASH, BankName, BankMfo, '', n980, nSum, BankOkpo,
     NLS_NLK, T2.NAMK,  T2.MFOK, '', n980, nSum,  T2.OKPOK,
     sNazn, '', GetIdOper(),'', T2.SKP ,0)
.head 8 +  If not cDoc_KP_nSIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_nSIGN.m_nRef
.head 8 -  If SqlPrepareAndExecute( hSql(),"update oper set nlsb=:T2.NLSK where ref=:nRef")
.head 7 +  Else
.head 8 -  ! Натуральный МБ или натуральные внутренние
.head 8 -  Set cDoc_KP_SIGN.FLI = 1
.head 8 -  Set cDoc_KP_SIGN.NLS_CASH = NLS_CASH
.head 8 -  Set cDoc_KP_SIGN.NLS_NLK = NLS_NLK
.head 8 -  Call cDoc_KP_SIGN.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS_NLK, BankName, BankMfo, '', n980, nSum, BankOkpo,
     T2.NLSK, T2.NAMK,  T2.MFOK, '', n980, nSum,  T2.OKPOK,
     sNazn, '', GetIdOper(),'', T2.SKP ,0)
.head 8 +  If not cDoc_KP_SIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 7 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value)
  SELECT :nRef, tag, value
  FROM tmp_operw  WHERE tt=:T2.TT and value is not null and nom=:T2.NOM" )
.head 8 -  Return FALSE
.head 7 +  If KP_SIGN = 0 and BankMfo =T2.MFOK
.head 8 -  If SqlPrepareAndExecute( hSql(),"DELETE from nlk_ref where ref1=:nRef")
.head 7 -  Set T2.REF1 = nRef
.head 7 -  ! Комиссия
.head 7 +  If T2.S2 > 0
.head 8 -  Set cDoc_KP_SIGN.FLI = 0
.head 8 +  If not F_Komis( T2.S2*100,  T2.TT, T2.NOM, T2.TT2, T2.NAM_FIO, sDate,  T2.REF2 )
.head 9 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: f_Prov1
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowD
.head 5 -  !
.head 4 +  Actions
.head 5 -  Call T1.f1()
.head 5 -  Set nRowD = TBL_MinRow
.head 5 -  Set rS = T1.S
.head 5 +  While SalTblFindNextRow( D1, nRowD, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRowD )
.head 6 +  If D1.BROWSER != STRING_Null
.head 7 -  Call SalEnableWindow( pbHelp )
.head 7 -  Set gBROWSER = D1.BROWSER
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbHelp )
.head 6 +  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE ), D1.OPT )
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: f_Prov2
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowD
.head 4 +  Actions
.head 5 -  Call T2.f1()
.head 5 -  Set nRowD = TBL_MinRow
.head 5 -  Set rS=T2.S
.head 5 +  While SalTblFindNextRow( D2, nRowD, 0, 0 )
.head 6 -  Call SalTblSetContext( D2, nRowD )
.head 6 +  If T2.NAZ_TT = STRING_Null or SalStrLength( T2.NAZ_TT ) < 3
.head 7 -  Call SalSendMsg( NAZN2, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено призначення платежу ! "
.head 7 -  Return FALSE
.head 6 +  If T2.MFOK = STRING_Null
.head 7 -  Call SalSendMsg( T2.MFOK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено МФО отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.NLSK = STRING_Null
.head 7 -  Call SalSendMsg( T2.NLSK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено рахунок отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.NAMK = STRING_Null
.head 7 -  Call SalSendMsg( T2.NAMK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено назва отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.OKPOK = STRING_Null
.head 7 -  Call SalSendMsg( T2.OKPOK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено ід.код отримувача! "
.head 7 -  Return FALSE
.head 6 +  ! If T2.MFOK = STRING_Null or T2.NLSK = STRING_Null or
   T2.NAMK = STRING_Null or T2.OKPOK=STRING_Null
.head 7 -                                                                      Set sErr=" НЕ заповнено реквізити отримувача ! "
.head 7 -                                                                      Return FALSE
.head 6 +  If T2.SKP = NUMBER_Null
.head 7 -  Call SalSendMsg( T2.SKP, SAM_Validate, 0, 0 )
.head 7 -  Set sErr ='Помилка СКП'
.head 7 -  Return FALSE
.head 6 +  If D2.BROWSER != STRING_Null
.head 7 -  Call SalEnableWindow( pbHelp )
.head 7 -  Set gBROWSER = D2.BROWSER
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbHelp )
.head 6 +  If not F_Tag( D2.CHKR, SalStrTrimX(D2.TAG), SalStrTrimX(D2.VALUE ), D2.OPT )
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: F_Ref
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nMode= 1
.head 6 -  Call SalShowWindow (T1.REF1)
.head 6 -  Call SalShowWindow (T1.REF2)
.head 6 -  Call SalShowWindow (T2.REF1)
.head 6 -  Call SalShowWindow (T2.REF2)
.head 5 +  Else
.head 6 -  Call SalHideWindow (T1.REF1)
.head 6 -  Call SalHideWindow (T1.REF2)
.head 6 -  Call SalHideWindow (T2.REF1)
.head 6 -  Call SalHideWindow (T2.REF2)
.head 3 +  Function: F_Ottisk
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: NMK
.head 5 -  String: FIO1
.head 5 -  Number: nSUMB
.head 5 -  Number: nSUMBK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TIME
.head 5 -  String: SUMB
.head 5 -  String: SUMBK
.head 5 -  !
.head 5 -  String: sTmp
.head 5 -  String: strReport
.head 5 -  String: strTempl
.head 5 -  !
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT  to_char(sysdate,'DD/MM/yyyy HH24:MM:SS') INTO :TIME FROM dual " )
and  SqlFetchNext(  hSqlAux2(),  nFetchRes)
.head 5 +  If nSUMB >0
.head 6 -  Set SUMB = SalNumberToStrX( nSUMB, 2 )|| ' грн'
.head 5 +  Else
.head 6 -  Set SUMB = STRING_Null
.head 5 +  If nSUMBK >0
.head 6 -  Set SUMBK = ', ком. '|| SalNumberToStrX( nSUMBK, 2 )|| ' грн'
.head 5 +  Else
.head 6 -  Set SUMBK = STRING_Null
.head 5 -  !
.head 5 -  Set strTempl = GetTemplateDir()||'\\OTTISK.qrd'
.head 5 -  Set sTmp =
GetBankMfo()||'~'|| GetBankName() ||'~'|| ADR ||'~'|| TIME || '~' || FIO1 || '~' ||
NMK ||'~'|| SUMB||'~'||SUMBK||'~'|| GetUserRealName()
.head 5 -  ! ---------------     Печатаем тикет            ------------
[REM        MFOA      - MFO--А
[REM        NBA       - Наш Банк
[REM        ADR
[REM        TIME     - Сист Дата
[REM        FIO1     - Кто платит
[REM        NMK   - Наименование Контрагента
[REM        SUMB     - Сумма сделки
[REM        SUMBK    - Сумма комиссии
[REM        FIO     - Кто ввел
-----
.head 5 -  !
.head 5 -  Set strReport = GetPrnDir()||'\\_'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || Str(SalDateDay(SalDateCurrent())), 2)
.head 5 -  !
.head 5 -  Call DosReport (strTempl,  strReport,'MFOA~NBA~ADR~TIME~FIO1~NMK~SUMB~SUMBK~FIO', sTmp, 0)
.head 5 -  Call DosDirectPrint(strReport)
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPap
.head 3 -  String: pNLS_NLK
.head 3 -  String: strPar02 ! ='' нахальная печать есть , ='N' нах печати нет
.head 2 +  Window Variables
.head 3 -  : cDoc_KP_SIGN
.head 4 -  Class: cDoc_KP_SIGN
.head 3 -  : cDoc_KP_nSIGN
.head 4 -  Class: cDoc_KP_nSIGN
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  ! String: sNLS_NLK
.head 3 -  !
.head 3 -  Boolean: bSortOrd1
.head 3 -  Boolean: bSortOrd2
.head 3 -  Window Handle: hDocWdog
.head 3 -  Boolean: F_Opl
.head 3 -  Number: KP_SIGN
.head 3 -  Number: yRef
.head 3 -  !
.head 3 -  Number: nTAB
.head 3 -  Number: g_NOM
.head 3 -  !
.head 3 -  String: sErr
.head 3 -  String: sPap
.head 3 -  String: sLC
.head 3 -  Number: nRow
.head 3 -  Number: nRow1
.head 3 -  Number: nRow2
.head 3 -  Number: n980
.head 3 -  String: sTT
.head 3 -  Number: nNOM
.head 3 -  String: sNAMK
.head 3 -  String: sNlsAlt
.head 3 -  String: sTipNazn
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  Number: nCol1
.head 3 -  Number: nTmp
.head 3 -  Number: nC_TAG
.head 3 -  String: sNOT
.head 3 -  Number: nCol
.head 3 -  String: gBROWSER
.head 3 -  Number: nBROWSER
.head 3 -  String: sTmp
.head 3 -  String: AA1
.head 3 -  String: AA2
.head 3 -  !
.head 3 -  Number: nUser
.head 3 -  Number: nROW1
.head 3 -  Number: nROW2
.head 3 -  Number: rS
.head 3 -  Number: nLT1
.head 3 -  Number: nHT1
.head 3 -  Number: nLT2
.head 3 -  Number: nHT2
.head 3 -  Date/Time: bDat
.head 3 -  Number: b840
.head 3 -  Number: b978
.head 3 -  Number: b643
.head 3 -  ! !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nW
.head 3 -  Number: nH
.head 3 -  Number: nCW
.head 3 -  Number: nCH
.head 3 -  String: ADR
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  !
.head 4 -  Set dfTextNAZN2  = 'Признач.пл.-2'
.head 4 -  Set dfTextSTOTAL = 'Сума платежів'
.head 4 -  Set dfTextSNAL = 'Прийнято у клієнта'
.head 4 -  Set dfTextSDEL = 'Повернути клієнту'
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute( hSql(),"SELECT kv, NOMINAL INTO :nRow, :nTmp FROM tabval where kv in (840,978,643) ")
.head 4 +  While SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If nRow = 840
.head 6 -  Set b840 = nTmp
.head 5 +  Else If nRow = 978
.head 6 -  Set b978 = nTmp
.head 5 +  Else If nRow = 643
.head 6 -  Set b643 = nTmp
.head 4 -  Set F_Opl = FALSE
.head 4 +  If pNLS_NLK != STRING_Null
.head 5 -  Set NLS_NLK = pNLS_NLK
.head 4 +  Else
.head 5 -  Call SqlPrepareAndExecute( hSql(),
  "SELECT substr(tobopack.gettoboparam('NLS2902'),1,14) INTO :NLS_NLK FROM dual " )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If NLS_NLK = STRING_Null
.head 6 -  Call SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('NLS_2902'),1,14)
   INTO :NLS_NLK FROM dual  " )
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If NLS_NLK = STRING_Null
.head 5 -  Call SalMessageBox('Неможливо визначити транзитний рахунок','Помилка', MB_IconStop)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call SalGetWindowSize( T1, nLT1, nHT1 )
.head 4 -  Call SalGetWindowSize( T2, nLT2, nHT2 )
.head 4 -  Set nCol = SalColorFromRGB( 255,200,255 )  ! розовій
.head 4 -  Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 -  Set nCol1 = SalColorFromRGB( 230,255,230 )
.head 4 -  Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
.head 4 -  ! Call SalGetWindowSize( dFIO, nW3, nH3 )
.head 4 -  Set BankName = GetBankName()
.head 4 -  Set BankMfo =  GetBankMfo()
.head 4 -  Set DatVal = GetBankDate()
.head 4 -  Set n980 = GetBaseVal()
.head 4 +  If nMode >100
.head 5 -  ! найти по календатю
.head 5 -  Set bDat = DatVal
.head 5 +  If SqlPrepareAndExecute( hSql(),
   "SELECT min( to_date(:bDat) + num)
    INTO :DatVal
    FROM conductor WHERE num<7 and to_date(:bDat) + num not in
        (select holiday from holiday where kv=:n980 and holiday> :bDat ) " ) and
not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set DatVal = GetBankDate() +1
.head 4 -  Set BankOkpo = GetBankOkpoS()
.head 4 -  Set nUser = GetUserId()
.head 4 -  ! Код ТОБО,
  Счет кассы из ini-файла  (или головной банк )
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20),
          substr(pul.Get_Mas_Ini_Val('CASH'),1,14)
   INTO :TOBO, :NLS_CASH FROM dual  " )
and SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If TOBO = STRING_Null 
.head 5 -  Call SqlPrepareAndExecute( hSql(),
  "SELECT tobo,name INTO :TOBO,:sTOBO FROM tobo WHERE tobo=tobopack.gettobo " )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If sTOBO = STRING_Null 
.head 5 -  Call SqlPrepareAndExecute( hSql(),
  "SELECT name INTO :sTOBO FROM tobo WHERE tobo=:TOBO " )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If NLS_CASH = STRING_Null
.head 5 -  Call SqlPrepareAndExecute( hSql(),
  "SELECT substr(tobopack.gettoboparam('CASH'),1,14) INTO :NLS_CASH FROM dual " )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 -  ! Наименование счета кассы и наименование папки
ИЛИ ВЫХОД - если не найдено
.head 4 +  If NLS_CASH != STRING_Null
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(a.nms,1,38), f.name
   INTO :NMS_CASH, :sPap
   FROM accounts a,  folders f
   WHERE a.nls=:NLS_CASH and f.idfo=:nPap " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalMessageBox('НЕ ВСТАНОВЛЕНО рахунок каси відділення '|| sTOBO,'Помилка', MB_IconStop)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! -------------------------------
.head 4 -  ! Операции обмена ВАЛ
.head 4 -  Set AA1 = STRING_Null
.head 4 -  Set AA2 = STRING_Null
.head 4 -  ! сначала в INI- файле
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('AA1'),1,3), substr(pul.Get_Mas_Ini_Val('AA2'),1,3)
   INTO :AA1, :AA2 FROM dual " )
and SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If AA1 = STRING_Null or AA2 = STRING_Null
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT v1.param_value, v2.param_value  INTO :AA1, :AA2
   FROM BRANCH_PARAMS_VALUES v1, BRANCH_PARAMS_VALUES v2
   WHERE v1.mfo=:TOBO and v2.mfo=:TOBO and v1.name='AA1' and v2.name='AA2' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set AA1 = 'AA1'
.head 6 -  Set AA2 = 'AA2'
.head 4 -  ! С ЭЦП (1-Маршавина)  или без(0 -АЖИО) - по умолчанию =1
.head 4 -  Set KP_SIGN = 1
.head 4 -  ! сначала в общем PARAMS
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :KP_SIGN FROM PARAMS WHERE par='KP_SIGN' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT param_value INTO :KP_SIGN FROM BRANCH_PARAMS_VALUES
   WHERE mfo=:TOBO and name='KP_SIGN' and param_value = '0' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set KP_SIGN = 1
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :ADR FROM PARAMS WHERE par='ADDRESS' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 4 -  !
.head 4 -  Call SalSetWindowText( KP, "Комплексне обслуговування ФО, папка операцій № "||Str(nPap)|| "-"||sPap )
.head 4 -  !
.head 4 -  Call F_tts()
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 +  If nMode=98
.head 5 -  Call SalHideWindow( pb_F1 )
.head 5 -  Call SalHideWindow( pb_F4 )
.head 5 -  Call SalHideWindow( NAZN1 )
.head 5 -  Call SalHideWindow( NAM_TT1 )
.head 5 -  Call SalHideWindow( T1 )
.head 5 -  Call SalHideWindow( D1 )
.head 5 -  Call SalHideWindowAndLabel( NAZN1 )
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nWW, nWH )
.head 4 +  If nWW >= 12
.head 5 +  If nWH < 6
.head 6 -  Call SalSetWindowSize( hWndForm, nWW, 6 )
.head 4 +  Else
.head 5 +  If nWH < 6
.head 6 -  Call SalSetWindowSize( hWndForm, 12, 6 )
.head 5 +  Else
.head 6 -  Call SalSetWindowSize( hWndForm, 12, nWH )
.head 4 -  Call GetClientRect( hWndForm, nX, nY, nW, nH )
.head 4 -  ! F1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F1, 0.05, 0)
.head 4 -  ! F4
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F4, 0.5, 0)
.head 4 -  ! NAZN1
.head 4 -  Call SalGetWindowSize(hWndForm.KP.NAZN1, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.NAZN1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05-3.2, nCH)
.head 4 -  ! NAM_TT1
.head 4 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT1, nCW, nCH )
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, nCH)
.head 4 -  ! T1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.T1, 0, 0.35)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.T1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05,
	SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.5)
.head 4 -  ! D1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.D1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, 0.35)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.D1, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.D1, nCW,
	SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.5)
.head 4 +  If nMode=97
.head 5 -  ! F2
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F2, 0.05,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 5 -  ! F3
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F3, 0.5,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 5 -  ! F8
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F8, 0.95,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 5 -  ! F9
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F9, 1.4,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 5 -  ! NAM_TT2
.head 5 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT2, nCW, nCH )
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.05)
.head 5 -  ! T2
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.T2, 0,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-2.75)
.head 5 -  Call SalSetWindowSize( hWndForm.KP.T2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05, 1.5)
.head 5 -  ! D2
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.D2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-2.75)
.head 5 -  Call SalGetWindowSize(hWndForm.KP.D2, nCW, nCH)
.head 5 -  Call SalSetWindowSize( hWndForm.KP.D2, nCW, 1.5)
.head 4 +  Else If nMode=98
.head 5 -  ! F2
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F2, 0.05,0)
.head 5 -  ! F3
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F3, 0.5,0)
.head 5 -  ! F8
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F8, 0.95,0)
.head 5 -  ! F9
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.pb_F9, 1.4,0)
.head 5 -  ! NAM_TT2
.head 5 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT2, nCW, nCH )
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,    0)
.head 5 -  ! T2
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.T2, 0, 0.35)
.head 5 -  Call SalSetWindowSize( hWndForm.KP.T2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05, 5)
.head 5 -  ! D2
.head 5 -  Call SalSetWindowLoc(hWndForm.KP.D2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,  0.35)
.head 5 -  Call SalGetWindowSize(hWndForm.KP.D2, nCW, nCH)
.head 5 -  Call SalSetWindowSize( hWndForm.KP.D2, nCW, 5)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextNAZN2, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-1.2+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAZN2, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-1.2)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.NAZN2, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.NAZN2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-0.1-2.2, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSTOTAL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.95+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.STOTAL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.95)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml1, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.9)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml1, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-2.2-0.1-1.55, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSNAL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SNAL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SKOL, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.KKOL, 0.1+2.2+2.15,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml3, 0.1+2.2+2.75,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.6)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml3, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml3,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-2.75-0.1-2.2, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSDEL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.35+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SDEL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.35)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml2, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.3)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml2, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-0.1-2.2-1.55, nCH)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NLS_NLK,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -1.2)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.TOBO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-1.95,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -1.2)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.sTOBO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.9)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dFIO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.6)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dTmp,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.3)
.head 4 -  !
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  ! Dialog Box: dlg_KP
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввод платежей ФЛ в пользу ЮЛ
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.025"
.head 4 -  Top:    0.031"
.head 4 -  Width:  15.583"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.738"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -                                                                                        Description: 
.head 2 +                                                                                        Tool Bar 
.head 3 -                                                                                        Contents 
.head 2 +                                                                                        Contents 
.head 3 -                                                                                        Frame 
.head 3 +                                                                                        Data Field: TOBO
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Код відділення')
.head 3 +                                                                                        Data Field: S_TOBO
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Назва відділення')
.head 3 +                                                                                        Data Field: CASH
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Рахунок каси')
.head 3 +                                                                                        Data Field: S_CASH
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Назва Рахуноку каси')
.head 3 +                                                                                        Data Field: USR
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Код виконавця')
.head 3 +                                                                                        Data Field: S_USR
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'ПІБ виконавця')
.head 3 -  ! !!!!!!!!!!!!!!
.head 3 +                                                                                        Data Field: nSTOTAL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Сума платежів')
.head 3 +                                                                                        Data Field: sSTOTAL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Сума платежів прописом')
.head 3 -  ! !
.head 3 +                                                                                        Data Field: nKOL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Кількість платежів')
.head 3 +                                                                                        Data Field: sKOL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Кількість платежів прописом')
.head 3 -  !
.head 3 +                                                                                        Data Field: nNAL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Прийнято у клієнта')
.head 5 +  ! On SAM_SetFocus
.head 6 +                                                                                         If SNAL = 0
.head 7 -                                                                                         Set SNAL = NUMBER_Null
.head 6 -                                                                                         Call SalMapEnterToTab( TRUE )
.head 5 +  ! On SAM_KillFocus
.head 6 -                                                                                         Call KP.f_Tochka ( 0, NUMBER_Null, STRING_Null,STRING_Null,STRING_Null, SNAL,  STRING_Null )
.head 6 +                                                                                         If STOTAL > 0
.head 7 +                                                                                         If SNAL < STOTAL or SNAL=NUMBER_Null
.head 8 -                                                                                         Call SalMessageBox(" НЕДОСТАТЧА коштів, чи помилка суми ! ", "УВАГА !", MB_IconStop)
.head 8 -                                                                                         Set SNAL = NUMBER_Null
.head 8 -                                                                                         Set SDEL = 0
.head 7 +                                                                                         Else 
.head 8 -                                                                                         Set SDEL = SNAL - STOTAL
.head 8 -                                                                                         Set ml1 = SumPr(  STOTAL *100, 'F', 'Грн' , "коп" )
.head 8 -                                                                                         Set ml2 = SumPr(  SDEL *100, 'F', 'Грн' , "коп" )
.head 8 -                                                                                         Set ml3 = NumberPr( SKOL, "M" )
.head 8 +                                                                                         If yRef = 0
.head 9 -                                                                                         Call SalEnableWindow( pb_F10 )
.head 9 -                                                                                         Set F_Opl = TRUE
.head 5 -  !
.head 3 +                                                                                        Data Field: sNAL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Прийнято у клієнтау прописом')
.head 3 -  !
.head 3 +                                                                                        Data Field: nDEL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Повернути клієнту')
.head 3 +                                                                                        Data Field: sDEL
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Повернути клієнту прописом')
.head 3 -  ! !
.head 3 +                                                                                        Data Field: dFIO
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_TooltipSetText
.head 6 -                                                                                        Return XSalTooltipSetText( lParam, 'Платник')
.head 3 -  !
.head 3 +                                                                                        Pushbutton: pb_New
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_Create
.head 6 -                                                                                        Set strTip = 'Новий клієнт'
.head 5 +                                                                                        On SAM_Click
.head 6 -                                                                                        Call F_New()
.head 3 +                                                                                        Pushbutton: pbK_Val
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_Create
.head 6 -                                                                                        Set strTip = 'Купівля ВАЛЮТИ.'
.head 5 +  ! On SAM_Click
.head 6 -                                                                                         Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'K_', NLS_CASH, AA1,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 3 +                                                                                        Pushbutton: pbP_Val
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_Create
.head 6 -                                                                                        Set strTip = 'Продаж ВАЛЮТИ.'
.head 5 +  ! On SAM_Click
.head 6 -                                                                                         Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'P_', NLS_CASH, AA2,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 3 +                                                                                        Pushbutton: pb_Exit
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_Create
.head 6 -                                                                                        Set strTip = 'ESC. Завершити  '
.head 5 +                                                                                        On SAM_Click
.head 6 -                                                                                        Call SalEndDialog(hWndForm, 0)
.head 3 -  ! !!!!!!!!!!!!!!!!!!!!!
.head 3 +                                                                                        Child Table: T1
.head 4 +                                                                                        Contents 
.head 5 +                                                                                        Column: ND
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: NLS
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: NMS
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: NAK
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: ACC
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: SK
.head 6 -                                                                                        List Values 
.head 6 +                                                                                        Message Actions 
.head 7 +  ! On SAM_KillFocus
.head 8 -                                                                                           Call SalSendMsg( SK, SAM_Validate, 0, 0 ) 
.head 7 +  ! On SAM_Validate
.head 8 +                                                                                           If SK != NUMBER_Null  
.head 9 +                                                                                           If SqlPrepareAndExecute( hSql(),
"SELECT name into :NMSK from sk where sk=:SK and sk<40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 10 -  ! Call SalMessageBox("Ош.МФО-Б "|| MFOB , "В Н И М А Н И Е ! ", MB_IconStop)
.head 10 -                                                                                           Set NMSK = "! Ош.СКП "
.head 10 -                                                                                           Return VALIDATE_Cancel
.head 8 +                                                                                           Else 
.head 9 -                                                                                           Set NMSK = STRING_Null
.head 8 -                                                                                           Return VALIDATE_Ok
.head 5 +                                                                                        Column: MFOB
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: NB
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: NLSB
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: OKPOB
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: NMSB
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 4 -                                                                                        Functions 
.head 4 -                                                                                        Window Variables 
.head 4 +                                                                                        Message Actions 
.head 5 +                                                                                        On SAM_Create
.head 6 -                                                                                        Call SalTblPopulate( T1, hSql(), 
"SELECT K.nd, a.acc,a.nls,a.nms, K.mfob, K.nlsb, K.okpob, K.nmsb, b.nb, K.nak, K.sk
 INTO :ND,:ACC, :NLS, :NMS,:MFOB,:NLSB, :OKPOB,:NMSB,:NB,:NAK,:SK
 From KP_DEAL k, accounts a, banks b
 WHERE K.acc=a.acc and a.dazs is null and K.mfob=b.MFO (+) and 
 nd in (select nd from kp_tobo where tobo=:TOBO) 
 ORDER BY a.acc", TBL_FillAll )
.head 6 -                                                                                        Call F_New()
.head 6 -                                                                                        Call SalWaitCursor(TRUE)
.head 5 +                                                                                        On SAM_DoubleClick
.head 6 -                                                                                        Call Sel031()
.head 3 -  !
.head 3 +                                                                                        Child Table: T2
.head 4 +                                                                                        Contents 
.head 5 +                                                                                        Column: ND
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 5 +                                                                                        Column: REF
.head 6 -                                                                                        List Values 
.head 6 -                                                                                        Message Actions 
.head 4 -                                                                                        Functions 
.head 4 -                                                                                        Window Variables 
.head 4 -                                                                                        Message Actions 
.head 3 -  !
.head 2 +                                                                                        Functions 
.head 3 +                                                                                        Function: F_New
.head 4 -                                                                                        Description: 
.head 4 -                                                                                        Returns 
.head 4 -                                                                                        Parameters 
.head 4 -                                                                                        Static Variables 
.head 4 -                                                                                        Local variables 
.head 4 +                                                                                        Actions 
.head 5 -                                                                                        Set F_Opl = FALSE
.head 5 -                                                                                        Call SalTblReset( tREF )
.head 5 -  ! Call SalDisableWindow( pb_F10 )
.head 5 -  ! Call SalDisableWindow( pb_F5 )
.head 5 -                                                                                        Call SalEnableWindow( nNAL )
.head 5 -                                                                                        Set dFIO = STRING_Null
.head 5 -                                                                                        Set nSTOTAL = 0
.head 5 -                                                                                        Set nDEL = 0
.head 5 -                                                                                        Set nNAL = 0
.head 5 -                                                                                        Set nKOL = 0
.head 5 -  ! Set yRef = 0
.head 5 -                                                                                        Set sSTOTAL = ""
.head 5 -                                                                                        Set sDEL = ""
.head 5 -                                                                                        Set sNAL = ""
.head 5 -                                                                                        Set sKOL = ""
.head 5 -                                                                                        Call SalSetFocus( T1 )
.head 2 -                                                                                        Window Parameters 
.head 2 +                                                                                        Window Variables 
.head 3 -                                                                                        Number: n980
.head 3 -                                                                                        Boolean: F_Opl
.head 2 +                                                                                        Message Actions 
.head 3 +                                                                                        On SAM_Create
.head 4 -                                                                                        Set n980 = GetBaseVal()
.head 4 -                                                                                        Set USR = GetUserId()
.head 4 -                                                                                        Set S_USR = GetUserRealName()
.head 4 -                                                                                        If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20),
          substr(pul.Get_Mas_Ini_Val('CASH'),1,14)
   INTO :TOBO, :CASH FROM dual  " )
and SqlFetchNext( hSql(), nFetchRes ) 
and SqlPrepareAndExecute( hSql(),
  "SELECT t.name, a.nms 
   INTO :S_TOBO, :S_CASH 
   FROM tobo t, accounts a 
   WHERE t.tobo=:TOBO and kv=:n980 and nls=:CASH " )
and SqlFetchNext( hSql(), nFetchRes ) 
.head 4 +                                                                                        Else 
.head 5 -                                                                                        Call SalMessageBox("НЕ УСТАНОВЛЕНО ТОБО та рахунок каси каристувачеві ",
Str(USR)||' '||S_USR , MB_IconStop)
.head 5 -                                                                                        Call SalEndDialog(hWndForm, 0)
.head 3 +                                                                                        On SAM_CreateComplete
.head 4 -  ! Call SalEndDialog(hWndForm, 0)
.head 4 -                                                                                        Call SalMapEnterToTab( TRUE )
.head 1 +  Dialog Box: dlg_KP
.head 2 -  Class: cQuickTabsDialog
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Платежі фізичних осіб на користь ЮО
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.05"
.head 4 -  Top:    0.073"
.head 4 -  Width:  13.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.893"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 31520
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.071"
.head 5 -  Width:  13.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код відділення')
.head 3 +  Data Field: S_TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.155"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва відділення')
.head 3 +  Data Field: CASH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Рахунок каси')
.head 3 +  Data Field: S_CASH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.083"
.head 6 -  Top:    0.155"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва Рахуноку каси')
.head 3 +  Data Field: USR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.683"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код виконавця')
.head 3 +  Data Field: S_USR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.155"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'ПІБ виконавця')
.head 3 -  ! !!!!!!!!!!!!!!
.head 3 +  Pushbutton: pb_F1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Red
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call picTabs.BringToTop(0,TRUE)
.head 3 +  Pushbutton: pb_F2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Red
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call picTabs.BringToTop(1,TRUE)
.head 3 +  Pushbutton: pb_F3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Red
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call picTabs.BringToTop(2,TRUE)
.head 3 -  ! !!
.head 3 +  Data Field: nTOTAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів')
.head 3 +  Data Field: sTOTAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.488"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів прописом')
.head 3 -  ! !
.head 3 +  Data Field: nKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.488"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів')
.head 3 +  Data Field: sKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    0.488"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів прописом')
.head 3 -  !
.head 3 +  Pushbutton: pb_F11
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F11
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Red
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F11.Установити фокус на "ПРИЙНЯТО у клієнта" '
.head 5 +  On SAM_Click
.head 6 -  Call SalSetFocus( nNAL )
.head 3 +  Data Field: nNAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.821"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'ПРИЙНЯТО у клієнта')
.head 5 +  ! On SAM_SetFocus
.head 6 +                                                                                         If SNAL = 0
.head 7 -                                                                                         Set SNAL = NUMBER_Null
.head 6 -                                                                                         Call SalMapEnterToTab( TRUE )
.head 5 +  ! On SAM_KillFocus
.head 6 -                                                                                         Call KP.f_Tochka ( 0, NUMBER_Null, STRING_Null,STRING_Null,STRING_Null, SNAL,  STRING_Null )
.head 6 +                                                                                         If STOTAL > 0
.head 7 +                                                                                         If SNAL < STOTAL or SNAL=NUMBER_Null
.head 8 -                                                                                         Call SalMessageBox(" НЕДОСТАТЧА коштів, чи помилка суми ! ", "УВАГА !", MB_IconStop)
.head 8 -                                                                                         Set SNAL = NUMBER_Null
.head 8 -                                                                                         Set SDEL = 0
.head 7 +                                                                                         Else 
.head 8 -                                                                                         Set SDEL = SNAL - STOTAL
.head 8 -                                                                                         Set ml1 = SumPr(  STOTAL *100, 'F', 'Грн' , "коп" )
.head 8 -                                                                                         Set ml2 = SumPr(  SDEL *100, 'F', 'Грн' , "коп" )
.head 8 -                                                                                         Set ml3 = NumberPr( SKOL, "M" )
.head 8 +                                                                                         If yRef = 0
.head 9 -                                                                                         Call SalEnableWindow( pb_F10 )
.head 9 -                                                                                         Set F_Opl = TRUE
.head 5 -  !
.head 3 +  Data Field: sNAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    1.155"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Прийнято у клієнтау прописом')
.head 3 -  !
.head 3 +  Data Field: nDEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    1.155"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту')
.head 3 +  Data Field: sDEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.821"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту прописом')
.head 3 -  ! !
.head 3 +  Data Field: dFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.821"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Платник')
.head 3 -  !
.head 3 +  Pushbutton: pb_New
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.383"
.head 5 -  Top:    1.155"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F4
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Maize
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F4. Новий клієнт (нова пачка)'
.head 5 +  On SAM_Click
.head 6 -  Call F_New()
.head 3 +  Pushbutton: pbK_Val
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.883"
.head 5 -  Top:    1.155"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Periwinkle
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Купівля ВАЛЮТИ.'
.head 5 +  ! On SAM_Click
.head 6 -                                                                                         Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'K_', NLS_CASH, AA1,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 3 +  Pushbutton: pbP_Val
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.383"
.head 5 -  Top:    1.155"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Salmon
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Продаж ВАЛЮТИ.'
.head 5 +  ! On SAM_Click
.head 6 -                                                                                         Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'P_', NLS_CASH, AA2,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 3 +  Pushbutton: pb_Exit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.883"
.head 5 -  Top:    1.155"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'ESC. Завершити  '
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 -  ! !!
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162557365466F 6E74000700437573 746F6D0000546162 466F6E744E616D65
0020: 000E004D53205361 6E73205365726966 00005461624F7269 656E746174696F6E
0040: 0001000000546162 546F704D61726769 6E00020030000054 6162466F726D5061
0060: 6765730003000909 0000546162447261 775374796C65000B 0057696E39355374
0080: 796C650000546162 426F74746F6D4D61 7267696E00050030 2E34350000546162
00A0: 50616765436F756E 7400020031000054 61624C6162656C73 005E0046312E2020
00C0: 20CC20CE20C620CB 20C820C220B22020 EEEFE5F0E0F6B3BF 20200946322E2020
00E0: 20CF20CE20D220CE 20D720CD20C02020 EFE0F7EAE0202020 0946332E202020CF
0100: 20CE20D220CE20D7 20CD20C02020EEEF E5F0E0F6B3FF2020 00005461624E616D
0120: 65730012004E616D 6530094E616D6531 094E616D65320000 5461625269676874
0140: 4D617267696E0002 0030000054616243 757272656E740006 004E616D65320000
0160: 5461624C6566744D 617267696E000200 300000546162466F 6E7453697A650002
0180: 0038000000000000 0000000000000000 0000000000000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: A001
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    1.821"
.head 5 -  Width:  12.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 5.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Black
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Child Table: T1
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.25"
.head 6 -  Top:    2.071"
.head 6 -  Width:  12.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
 договора
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
29*
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование 
сч 29*
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Груп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ACC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СКП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_KillFocus
.head 8 -                                                                                           Call SalSendMsg( SK, SAM_Validate, 0, 0 ) 
.head 7 +  ! On SAM_Validate
.head 8 +                                                                                           If SK != NUMBER_Null  
.head 9 +                                                                                           If SqlPrepareAndExecute( hSql(),
"SELECT name into :NMSK from sk where sk=:SK and sk<40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 10 -  ! Call SalMessageBox("Ош.МФО-Б "|| MFOB , "В Н И М А Н И Е ! ", MB_IconStop)
.head 10 -                                                                                           Set NMSK = "! Ош.СКП "
.head 10 -                                                                                           Return VALIDATE_Cancel
.head 8 +                                                                                           Else 
.head 9 -                                                                                           Set NMSK = STRING_Null
.head 8 -                                                                                           Return VALIDATE_Ok
.head 5 +  Column: MFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.867"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.банка -Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.65"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наимен-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: NMSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наимен 
СПК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s6F
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s6U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s3U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: VOB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -                                                                                     List Values 
.head 6 -                                                                                     Message Actions 
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: ACC6F
.head 5 -  Number: ACC6U
.head 5 -  Number: ACC3U 
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblPopulate( T1, hSql(), 
"SELECT K.nd, a.acc,a.nls,a.nms, K.mfob, K.nlsb, K.okpob, K.nmsb, b.nb, K.nak, K.sk,
  s.name, k.tt, k.ACC6F,   k.ACC6U, k.ACC3U 
 INTO :ND,:ACC, :NLS, :NMS,:MFOB,:NLSB, :OKPOB,:NMSB,:NB,:NAK,:SK,
  :NMSK , :TT , :ACC6F,:ACC6U,:ACC3U 
 From KP_DEAL k, accounts a, banks b, sk s
 WHERE K.acc=a.acc and a.dazs is null and K.mfob=b.MFO (+) and 
  k.sk =s.sk (+) 
 AND nd in (select nd from kp_tobo where tobo=:TOBO) 
 ORDER BY a.acc", TBL_FillAll )
.head 6 -  Call F_New()
.head 6 -  ! Call SalWaitCursor(TRUE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call F_DOK()
.head 5 +  On SAM_FetchRowDone
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT a1.nls,a2.nls,a3.nls INTO :T1.s6F,:T1.s6U,:T1.s3U 
 FROM accounts a1, accounts a2, accounts a3
 where  a1.acc=:ACC6F and a2.acc=:ACC6U and a3.acc (+)=:ACC3U " )
and SqlFetchNext( hSqlAux2(), nFetchRes ) 
.head 3 +  Child Table: T2
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.15"
.head 6 -  Top:    2.333"
.head 6 -  Width:  8.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.821"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
 договора
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
плат
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  ! !!!!!!!!!!
.head 3 +  Data Field: dNLS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    2.405"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сч.29*')
.head 3 +  Data Field: dNMS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    2.405"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование Сч.29*')
.head 3 +  Check Box: dNAK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Группировать
.head 4 -  Window Location and Size
.head 5 -  Left:   5.683"
.head 5 -  Top:    2.405"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: * F11 прийнято * F4 нова пачка * F6 новий документ * F7 скп * F8 банк-Б * F10 ввод * F5 друк *
.head 4 -  Resource Id: 56489
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.488"
.head 5 -  Width:  12.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Light Gray
.head 3 +  Pushbutton: pb_SK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.583"
.head 5 -  Top:    2.405"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\A_SPEC.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F7. Вибрати СКП'
.head 5 +  On SAM_Click
.head 6 -  Call F_SK ()
.head 3 +  Data Field: dSK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    2.405"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Символ Кас.Плану')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  On SAM_Validate
.head 6 +  If dSK >40
.head 7 -  Call SalMessageBox( 'Символ Кас.Плану', " Увага ! Помилка !  ", MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dNMSK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.983"
.head 6 -  Top:    2.405"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование СКП')
.head 3 -  !
.head 3 +  Pushbutton: pb_MFO
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    2.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTBANK.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8. Вибрати Банк-Б'
.head 5 +  On SAM_Click
.head 6 -  Call F_MFO ()
.head 3 +  Data Field: dMFOB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    2.738"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  On SAM_Validate
.head 6 +  If dMFOB != STRING_Null  
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT nb into :dNB from banks where mfo=:dMFOB and nvl(blk,0) <>4 ")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Call SalMessageBox( 'МФО-Б', " Увага ! Помилка !  ", MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set dNB = "! МФО-Б"
.head 6 +  Else
.head 7 -  Set dNB = STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'МФО-Б')
.head 3 +  Data Field: dNB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    2.738"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Наименование МФО-Б')
.head 3 +  Data Field: dNLSB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.683"
.head 6 -  Top:    2.738"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Рахунок-Б')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  On SAM_Validate
.head 6 +  If dNLSB != KeyAccount( dMFOB, dNLSB )
.head 7 -  Call SalMessageBox( 'Рахунок-Б', " Увага ! Помилка !  ", MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dNMSB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    2.738"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If dNMSB = STRING_Null
.head 7 -  Set dNMSB = dNMS
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Наименование-Б(получателя)')
.head 3 +  Data Field: dOKPOB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.483"
.head 6 -  Top:    2.738"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'ОКПО-Б')
.head 3 -  !
.head 3 +  Data Field: dK_FL
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    3.071"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'Сума комісії з платника')
.head 3 +  Data Field: dS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    3.071"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'Сума платежу')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 6 +  If dS != NUMBER_Null
.head 7 -  Set nTOTAL = nTOTAL - dS
.head 5 +  On SAM_Validate
.head 6 -  Call DecPoint(hWndItem)
.head 6 +  If not SalIsValidDecimal( hWndItem, 15, 2 ) or SalIsNull( hWndItem ) or dS=0 
.head 7 -  Call SalMessageBox( "Помилка в сумі ", " Увага ! ", MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set dS=SalNumberAbs(dS)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  If dS != NUMBER_Null and dS >0
.head 7 -  Call F_Komis( )
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D1)
.head 7 -  Call SalTblSetContext(D1, 0)
.head 7 -  ! Call SalTblSetFocusRow(D1,0)
.head 7 -  ! Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 7 -  ! Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
.head 7 -  Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, 1)
.head 3 +  Child Table: D1
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    3.405"
.head 6 -  Width:  9.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: VALUE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значення дод.реквізиту
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalMapEnterToTab( TRUE )
.head 8 +  If Subs(D1.TAG,1,3)='FIO' 
.head 9 +  If dFIO != STRING_Null and VALUE = STRING_Null
.head 10 -  Set D1.VALUE = dFIO 
.head 7 +  On SAM_DoubleClick
.head 8 +  If D1.BROWSER != STRING_Null
.head 9 -  Set sTmp = D1.VALUE
.head 9 -  Call SalModalDialog( dlgTagBrowse1, dlg_KP , D1.BROWSER, sTmp )
.head 9 -  Set D1.VALUE = sTmp
.head 9 -  Call SalSendMsg( D1.VALUE, SAM_Validate, 0, 0 )
.head 7 +  On SAM_Validate
.head 8 -  Set D1.VALUE = SalStrTrimX( D1.VALUE )
.head 8 +  If F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE), D1.OPT, D1.NAME  )
.head 9 +  ! If Subs(D1.TAG,1,3)='?LC'
.head 10 -                                                                                     Set sLC = D1.VALUE
.head 10 +                                                                                     If SqlPrepareAndExecute( hSql(),
  "SELECT S, fio, Nvl(TAG,0)
   INTO :dS, :dFIO , :nTag
   FROM KP_FILE
   WHERE tt=:T1.TT and lc=:sLC ")
and not SqlFetchNext( hSql(), nFetchRes )
.head 11 -                                                                                     Call SalMessageBox(" LC="|| D1.VALUE ||" не знайдено в БД (KP_FILE), tt=" ||T1.TT ,
 "УВАГА !", MB_IconStop )
.head 10 +                                                                                     Else
.head 11 -                                                                                     Set T1.NAM_FIO = dFIO
.head 11 -                                                                                     Call SalSendMsg( T1.S, SAM_Validate, 0, 0 )
.head 11 +                                                                                     If nTag = 1
.head 12 -                                                                                     Set nRowD1 = TBL_MinRow
.head 12 +                                                                                     While SalTblFindNextRow( D1, nRowD1, 0, 0 )
.head 13 -                                                                                     Call SalTblSetContext( D1, nRowD1 )
.head 13 -                                                                                     If SqlPrepareAndExecute( hSql(),
"SELECT value INTO :D1.VALUE
 FROM KP_TAG where TT=:T1.TT and LC=:sLC and TAG=:D1.TAG")
and SqlFetchNext( hSql(), nFetchRes )
and SqlPrepareAndExecute( hSql(),
"UPDATE tmp_operw
 SET VALUE =:D1.VALUE
 WHERE tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM")
.head 7 +  ! On SAM_KillFocus
.head 8 -                                                                                     Call SalSendMsg( D1.VALUE, SAM_Validate, 0, 0 )
.head 5 +  Column: TAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Додатковий реквізит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: FMT
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BROWSER
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BROWSER
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 250
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NOMODIFY 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NOMODIFY 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VSPO_CHAR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VSPO_CHAR
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: CHKR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OPT
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: F_Tag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sCHKR
.head 7 -  String: sTag
.head 7 -  String: sValue
.head 7 -  String: sOpt
.head 7 -  String: sName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bFL
.head 7 -  Number: nC_TAG
.head 6 +  Actions
.head 7 -  Set bFL = TRUE
.head 7 +  If Subs(sTag,1,3)='FIO' and sValue != STRING_Null
.head 8 -  Set dFIO = sValue
.head 7 -  ! Если sValue = STRING_Null
.head 7 -  ! и не обяз  != M не проверять
.head 7 -  ! Обязательный, но пустой
.head 7 +  If sOpt ='M' and sValue = STRING_Null
.head 8 -  Set bFL = FALSE
.head 7 -  ! не пустой, но есть проверка и он ее не проходит
.head 7 +  If sValue != STRING_Null and sCHKR != STRING_Null
.head 8 +  If SqlPrepareAndExecute( hSql(), "SELECT C_TAG (:sTag,:sValue) INTO :nC_TAG from dual ")
and SqlFetchNext( hSql(), nFetchRes )
and nC_TAG = 0
.head 9 -  Set bFL = FALSE
.head 7 -  ! Плохо дело
.head 7 +  If not bFL
.head 8 -  ! Set D1.VALUE = sNOT
.head 8 -  Call XSalTblSetCellBackColor( D1.VALUE , COLOR_LightGreen )
.head 8 -  Set sErr = " Помилка доп.реквізиту: "|| sName || "("||sTag||")"
.head 8 -  Call SalMessageBox( sErr, "Увага !", MB_IconStop)
.head 7 -  Return bFL
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Data Field: dNAZN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    5.321"
.head 6 -  Width:  9.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Назначение платежа')
.head 3 -  !
.head 3 +  Pushbutton: pb_Del
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.183"
.head 5 -  Top:    3.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F6
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F6. Витерти екран '
.head 5 +  On SAM_Click
.head 6 -  Set nTOTAL = nTOTAL - dS
.head 6 -  Set nTOTAL = nTOTAL - dK_FL
.head 6 -  Call F_DOK()
.head 3 +  Pushbutton: pb_F10
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.683"
.head 5 -  Top:    3.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F10
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F10. Ввести '
.head 5 +  On SAM_Click
.head 6 +  ! If STOTAL > 0 and F_Opl
.head 7 -                                                                                     Set F_Opl = FALSE
.head 7 -                                                                                     Call SqlCommit( hSql() )
.head 7 -                                                                                     Call SalDisableWindow( pb_F1 )
.head 7 -                                                                                     Call SalDisableWindow( pb_F2 )
.head 7 -                                                                                     Call SalDisableWindow( pb_F3 )
.head 7 -                                                                                     Call SalDisableWindow( pb_F4 )
.head 7 -                                                                                     Call SalDisableWindow( pb_F8 )
.head 7 -                                                                                     Call SalDisableWindow( pb_F9)
.head 7 +                                                                                     If f_Opl(rS)
.head 8 -                                                                                     Call F_Ref (1)
.head 8 -                                                                                     Call SqlCommit( hSql() )
.head 8 -                                                                                     Set yRef = 1
.head 8 -                                                                                     Call SalEnableWindow( pbRef )
.head 8 -                                                                                     If SalStrUpperX( Subs(strPar02,1,1) )='N' ! нахальная печать NO
.head 8 +                                                                                     Else ! YES
.head 9 -                                                                                     Call F_Print(1)
.head 8 -                                                                                     Call SalDisableWindow( T1.S )
.head 8 -                                                                                     Call SalDisableWindow( T1.P )
.head 8 -                                                                                     Call SalDisableWindow( T2.S )
.head 8 -                                                                                     Call SalDisableWindow( T2.P )
.head 8 -                                                                                     Call SalDisableWindow( T2.NAMK )
.head 8 -                                                                                     Call SalDisableWindow( T2.MFOK )
.head 8 -                                                                                     Call SalDisableWindow( T2.OKPOK )
.head 8 -                                                                                     Call SalDisableWindow( T2.NLSK )
.head 8 -                                                                                     Call SalDisableWindow( pb_F10 )
.head 8 -                                                                                     Call SalDisableWindow( D1 )
.head 8 -                                                                                     Call SalTblReset( D1 )
.head 8 -  !
.head 8 -                                                                                     Call MessageNoWait('Введено пачку документів ','Повідомлення',3,0)
.head 8 -                                                                                     Call SalEnableWindow( pb_F5 )
.head 8 -  !
.head 7 +                                                                                     Else 
.head 8 -                                                                                     Call SqlRollback(hSql())
.head 8 -                                                                                     Call SalDisableWindow( pbRef )
.head 8 -                                                                                     Set F_Opl = TRUE
.head 8 -                                                                                     Call SalEnableWindow( pb_F1 )
.head 8 -                                                                                     Call SalEnableWindow( pb_F2 )
.head 8 -                                                                                     Call SalEnableWindow( pb_F3 )
.head 8 -                                                                                     Call SalEnableWindow( pb_F4 )
.head 8 -                                                                                     Call SalEnableWindow( pb_F8 )
.head 8 -                                                                                     Call SalEnableWindow( pb_F9)
.head 8 -                                                                                     Call MessageNoWait( IifS( rS !=NUMBER_Null, 'Сума док='||Str(rS), '' )|| sErr, 'Помилка !', 0, 1)
.head 6 -  Call F_Opl()
.head 3 +  Pushbutton: pb_F5
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.183"
.head 5 -  Top:    3.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F5
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F5. Надрукувати ПАЧКУ оплачених документів'
.head 5 +  On SAM_Click
.head 6 -  ! Call F_Print(2)
.head 2 +  Functions
.head 3 +  Function: F_Opl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  Number: nRef
.head 5 -  Date/Time: sDate
.head 5 -  Number: nRow
.head 5 -  String: sNazn
.head 5 -  String: sIns
.head 5 -  !
.head 5 -  Boolean: FL
.head 4 +  Actions
.head 5 -  ! последняя проверка 
.head 5 +  If dS <=0
.head 6 -  Set sErr= 'Помилка в сумі '
.head 6 -  Call SalMessageBox( sErr, "Увага !", MB_IconStop)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRow )
.head 6 +  If not D1.F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE ), D1.OPT, D1.NAME )
.head 7 -  Return FALSE
.head 6 +  If D1.VALUE != STRING_Null
.head 7 -  Call SalTblSetRowFlags( D1, nRow, ROW_New, TRUE )
.head 5 -  ! Собственно оплата
.head 5 -  Set sIns = "INSERT into operw (ref,tag,value) VALUES(:nRef,:D1.TAG,:D1.VALUE )" 
.head 5 -  ! Set sErr = 'Помилка в оплаті'
.head 5 -  ! Set FL = FALSE
.head 5 -  If SqlPrepareAndExecute( hSql(),"SELECT sysdate INTO :sDate FROM dual") and SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set nSum = ( dS - IifN(T1.s3U=STRING_Null, nK_UL, 0 ) )  * 100
.head 5 -  Set sNazn= Subs( dFIO ||' '|| dNAZN, 1, 160)
.head 5 +  If dNAK
.head 6 -  ! Деб 100*  Кред 29*
.head 6 -  Call cDoc.SetDoc( nRef, T1.TT, 1, 6, STRING_Null,
     sDate, sDate, DatB, DatB,
     CASH, S_CASH, BankMfo, '', n980, nSum, BankOkpo,
     dNLS, dNMS, BankMfo, '', n980, nSum, dOKPOB,     
     sNazn, '', GetIdOper(),'', dSK ,0)
.head 5 +  Else
.head 6 -  ! Деб 29*  Кред 26*
.head 6 -  Call cDoc.SetDoc( nRef, T1.TT, 1, 6, STRING_Null,
     sDate, sDate, DatB, DatB,
     dNLS, dNMS, BankMfo, '', n980, nSum, BankOkpo ,
     dNLSB, dNMSB, dMFOB, '', n980, nSum, dOKPOB,     
     sNazn, '', GetIdOper(),'', dSK ,0)
.head 5 -  !
.head 5 +  If cDoc.oDoc()
.head 6 -  Set nRef = cDoc.m_nRef
.head 6 +  If not dNAK
.head 7 -  ! Деб 100*  Кред 29*
.head 7 +  If not cDoc.PayV(0,nRef, DatB, T1.TT, 1, n980, CASH, nSum, n980, dNLS, nSum )
.head 8 -  Return FALSE
.head 5 +  Else
.head 6 -  Return FALSE
.head 5 +  If dK_FL >0 
.head 6 -  ! Деб 100*  Кред 611*ФЛ
.head 6 +  If not cDoc.PayV(0,nRef, DatB, 'Э99', 1, n980, CASH, nSum, n980, T1.s6F, nSum )
.head 7 -  Return FALSE
.head 5 +  If nK_UL >0 
.head 6 -  ! Деб 35*  Кред 611*ЮЛ или 
.head 6 -  ! Деб 29*  Кред 611*ЮЛ  
.head 6 +  If not cDoc.PayV(0,nRef, DatB, 'Э99', 1, n980, IifS(T1.s3U=STRING_Null, dNLS, T1.s3U), nK_UL, n980, T1.s6U, nK_UL )
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  If SqlPrepareAndExecute( hSql(),"INSERT INTO operw(ref,tag,value) VALUES(:nRef,'ND',:T1.ND)" )
and  SqlPrepare(hSql(), sIns )
and SalTblDoInserts(D1, hSql(), TRUE) 
.head 5 +  Else
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: DecPoint      ! Корректировка символа "десятичной точки"
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 -  Return TRUE
.head 3 +  Function: F_New
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblReset( T2 )
.head 5 -  Call SalEnableWindow( nNAL )
.head 5 -  Set dFIO = STRING_Null
.head 5 -  Set nTOTAL = 0
.head 5 -  Set nDEL = 0
.head 5 -  Set nNAL = 0
.head 5 -  Set nKOL = 0
.head 5 -  Set sTOTAL = ""
.head 5 -  Set sDEL = ""
.head 5 -  Set sNAL = ""
.head 5 -  Set sKOL = ""
.head 5 -  Call SalSetFocus( T1 )
.head 3 +  Function: F_DOK
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dNLS = T1.NLS
.head 5 -  Set dNMS = T1.NMS
.head 5 -  Set dNAK = T1.NAK
.head 5 -  Set dS = NUMBER_Null
.head 5 -  Set dK_FL = 0
.head 5 -  Set nK_FL = 0
.head 5 -  Set nK_UL = 0
.head 5 -  Call SalDisableWindow( pb_F5 )
.head 5 +  If T1.SK != NUMBER_Null
.head 6 -  Set dSK= T1.SK
.head 6 -  Set dNMSK=T1.NMSK
.head 6 -  Call SalDisableWindow( pb_SK )
.head 6 -  Call SalDisableWindow( dSK )
.head 5 +  Else
.head 6 -  Call SalEnableWindow( pb_SK )
.head 6 -  Call SalEnableWindow( dSK )
.head 5 +  If T1.MFOB != STRING_Null
.head 6 -  Set dMFOB= T1.MFOB
.head 6 -  Set dNB =T1.NB
.head 6 -  Set dNLSB=T1.NLSB
.head 6 -  Set dOKPOB=T1.OKPOB
.head 6 -  Set dNMSB=T1.NMSB
.head 6 -  Call SalDisableWindow( pb_MFO )
.head 6 -  Call SalDisableWindow( dMFOB )
.head 6 -  Call SalDisableWindow( dNLSB )
.head 6 -  Call SalDisableWindow( dOKPOB )
.head 6 -  Call SalDisableWindow( dNMSB )
.head 5 +  Else
.head 6 -  Call SalEnableWindow( pb_MFO )
.head 6 -  Call SalEnableWindow( dMFOB )
.head 6 -  Call SalEnableWindow( dNLSB )
.head 6 -  Call SalEnableWindow( dOKPOB )
.head 6 -  Call SalEnableWindow( dNMSB )
.head 5 -  Call SalTblPopulate( D1, hSql(), 
"SELECT f.TAG,f.NAME,r.VAL,f.FMT,f.BROWSER,f.NOMODIFY,f.VSPO_CHAR,f.CHKR,r.OPT
 INTO :D1.TAG, :D1.NAME, :D1.VALUE ,:D1.FMT, :D1.BROWSER, :D1.NOMODIFY, 
      :D1.VSPO_CHAR, :D1.CHKR, :D1.OPT
 From op_Field f, op_Rules r
 WHERE f.tag= r.tag and r.tt=:T1.TT and r.USED4INPUT = 1 
 ORDER BY r.ORD ", TBL_FillAll )
.head 5 -  Call SalTblSetLockedColumns( D1, 1 )
.head 5 -  Call picTabs.BringToTop(2,TRUE)
.head 5 +  If dSK = NUMBER_Null
.head 6 -  Call SalSetFocus( pb_SK )
.head 5 +  Else If dMFOB = STRING_Null
.head 6 -  Call SalSetFocus( dMFOB )
.head 5 +  Else
.head 6 -  Call SalSetFocus( dS )
.head 3 +  Function: F_SK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("SK","NAME"," SK <40 ", sTmp, dNMSK )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set dSK =Val(sTmp)
.head 3 +  Function: F_MFO
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("BANKS", "NB"," nvl(blk,0) <>4 ", sTmp, dNB )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set dMFOB=sTmp
.head 6 -  Call SalSendMsg( dNLSB, SAM_KillFocus, 0, 0 ) 
.head 3 +  Function: F_Komis
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nTOTAL = nTOTAL + dS
.head 5 +  If dK_FL != NUMBER_Null and dK_FL >0 
.head 6 -  Set nTOTAL = nTOTAL - dK_FL
.head 5 -  Set nK_FL = 0
.head 5 -  Set nK_UL = 0
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT Bars.KP_Kom(:T1.ND,:dS,0),Bars.KP_Kom(:T1.ND,:dS,1) INTO :nK_FL,:nK_UL from dual" )
and SqlFetchNext( hSql(), nFetchRes ) 
.head 6 +  If nK_FL > 0
.head 7 -  Set dK_FL = nK_FL
.head 7 -  Set nTOTAL = nTOTAL + dK_FL
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  Number: nS
.head 3 -  Number: nK_UL
.head 3 -  Number: nK_FL
.head 3 -  String: sErr
.head 3 -  String: sTmp
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Date/Time: DatB 
.head 3 -  String: BankMfo
.head 3 -  String: BankOkpo
.head 2 +  Message Actions
.head 3 -  ! F6 - нова пачка
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set DatB = GetBankDate()
.head 4 -  Set BankMfo = GetBankMfo()
.head 4 -  Set BankOkpo = GetBankOkpoS()
.head 4 -  Set sDecimal=SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 +  If sDecimal='.'
.head 5 -  Set sDecimal2=','
.head 4 +  Else
.head 5 -  Set sDecimal2='.'
.head 4 -  Set USR = GetUserId()
.head 4 -  Set S_USR = GetUserRealName()
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20),
          substr(pul.Get_Mas_Ini_Val('CASH'),1,14)
   INTO :TOBO, :CASH FROM dual  " )
and SqlFetchNext( hSql(), nFetchRes ) 
and SqlPrepareAndExecute( hSql(),
  "SELECT t.name, a.nms 
   INTO :S_TOBO, :S_CASH 
   FROM tobo t, accounts a 
   WHERE t.tobo=:TOBO and kv=:n980 and nls=:CASH " )
and SqlFetchNext( hSql(), nFetchRes ) 
.head 4 +  Else
.head 5 -  Call SalMessageBox("НЕ УСТАНОВЛЕНО ТОБО та рахунок каси каристувачеві ",
Str(USR)||' '||S_USR , MB_IconStop)
.head 5 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalDisableWindow( dNAK )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Call picTabs.BringToTop(0,TRUE)
.head 4 -  Call SalSetFocus( T1 )
.head 1 -  !
.head 1 +  Dialog Box: dlgTagBrowse1   ! TAG бровзер
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Код-Текст Бровзер
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.7"
.head 4 -  Top:    0.49"
.head 4 -  Width:  7.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.44"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск(F7):
.head 4 -  Resource Id: 45577
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    0.238"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.238"
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nRow=-1
.head 6 -  Call SalSendMsg( pbSearch, SAM_Click, 0, 0 )
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.595"
.head 6 -  Width:  6.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.857"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 30000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  ! cColumnLabeled: colKod
.head 6 -                                                                                                                                                                                                              List Values
.head 6 -                                                                                                                                                                                                              Message Actions
.head 5 +  ! cColumnLabeled: colTxt
.head 6 -                                                                                                                                                                                                              List Values
.head 6 -                                                                                                                                                                                                              Message Actions
.head 5 +  Column: colKod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTxt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Текст
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If not SalIsNull( colKod )
.head 7 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalTblQueryFocus ( hWndForm, nRow, hWndCol )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    4.655"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetContext( tbl, nRow )
.head 6 -  Set strKod=tbl.colKod
.head 6 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    4.702"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  Frame
.head 4 -  Resource Id: 45578
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.095"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    4.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = VisTblFindString (tbl, nRow+1, hWndNULL, df1)
.head 6 +  If nRow != -1
.head 7 -  Call SalTblSetFocusRow( tbl, nRow )
.head 7 -  ! Call SalTblSetContext( tbl, nRow )
.head 7 -  ! Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, TRUE )
.head 6 -  ! Call DebugN(nRow)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strSelect
.head 3 -  Receive String: strKod
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: N1
.head 3 -  Number: L1
.head 3 -  String: sSql
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sSql = SalStrTrimX( SalStrUpperX( strSelect ) )
.head 4 -  Set L1 =  SalStrLength( sSql ) -1
.head 4 -  Set sSql = SalStrTrimX( Subs(sSql,1, L1 ) )
.head 4 -  Set L1 = SalStrLength( sSql ) -1
.head 4 -  Set sSql = SalStrTrimX( Subs(sSql,1, L1 ) )
.head 4 -  Set N1 = SalStrScan ( sSql, 'SELECT' )
.head 4 -  Set sSql = Subs(sSql ,N1+1 , L1 )  || " INTO :tbl.colKod, :tbl.colTxt"
.head 4 -  Call SalTblPopulate( tbl, hSql(), sSql , TBL_FillAll)
.head 4 -  Call SalSetFocus( df1 )
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Form Window: Vkv
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.65"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.31"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.417"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45583
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 45584
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 45585
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 45586
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45587
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set Vkv.dfValD1 = Vkv.DatVal
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 45579
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set Vkv.dfDocD = SalDateCurrent(  )
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalShowWindow( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  ! Call UnHideIt( hWndItem )
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalShowWindow( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Set Vkv.i=0
.head 6 -  Call SalArrayGetUpperBound( Vkv.aTag, 1, Vkv.nTmp )
.head 6 +  While Vkv.i < Vkv.nTmp
.head 7 -  Set Vkv.i = Vkv.i + 1
.head 7 +  If SalStrTrimX( Vkv.aTag [ Vkv.i ] )='FIO'
.head 8 -  Set Vkv.aVal[Vkv.i] = FIO
.head 8 -  Set Vkv.iFIO = Vkv.i
.head 6 -  Call SalListSetSelect( lb1, 0 )
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSendClassMessage( SAM_SetFocus, 0, 0 )
.head 6 +  If SalListQuerySelection( Vkv.lb1 )=0
and Vkv.dfNazn = STRING_Null and Vkv.dfKvA != STRING_Null
and Vkv.dfSumA !=NUMBER_Null
.head 7 -  Set Vkv.dfNazn  =
IifS(Vkv.KP_='K_','Купівля ','Продаж ') ||
SalNumberToStrX( Vkv.dfSumA,2) ||' '|| Vkv.dfKvA ||
' по курсу '|| SalNumberToStrX( Vkv.dfRatNom,4)
.head 7 -  Set Vkv.aVal[ 0 ] = dfNazn
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 167
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 166
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKurs
.head 4 +  Actions
.head 5 -  Set nKurs = dfRatNom
.head 5 -  Return cDocW.oDoc()
.head 2 +  Window Parameters
.head 3 -  String: TOBO !! Код безБал отд
.head 3 -  String: KP_ !! Купiвля = K_
            !! Продаж  = P_
.head 3 -  String: sAccA !! Счет кассы
.head 3 -  String: TTT !! код операции
.head 3 -  String: FIO
.head 3 -  Date/Time: DatVal !! дата валютирования
.head 3 -  Window Handle: pb_
.head 3 -  !
.head 3 -  Number: b840
.head 3 -  Number: b978
.head 3 -  Number: b643
.head 2 +  Window Variables
.head 3 -  String: colFlags
.head 3 -  Number: iFIO
.head 2 +  Message Actions
.head 3 +  On UM_Choose
.head 4 -  Set Vkv.sGetXRate='BARS.GetXRate'
.head 4 +  If not Vkv.bDocStart
.head 5 -  Set Vkv.bDocStart=TRUE
.head 5 -  Set Vkv.bFixAll  =FALSE
.head 5 -  Set Vkv.bFixNlsA =FALSE
.head 5 -  Set Vkv.bFixKvA  =FALSE
.head 5 -  Set Vkv.bFixKvB  =FALSE
.head 5 -  Set Vkv.bFixNlsB =FALSE
.head 5 -  Set Vkv.bFixMfoB =FALSE
.head 5 -  Set Vkv.bFixDocD =FALSE
.head 5 -  Set Vkv.bFixValD1=FALSE
.head 5 -  Set Vkv.sFixKvA  =STRING_Null
.head 5 -  Set Vkv.sFixNlsA =STRING_Null
.head 5 -  Set Vkv.sFixKvB  =STRING_Null
.head 5 -  Set Vkv.sFixNlsB =STRING_Null
.head 5 -  Set Vkv.sFixMfoB =STRING_Null
.head 5 -  Set Vkv.dFixDocD =DATETIME_Null
.head 5 -  Set Vkv.dFixValD1=DATETIME_Null
.head 5 -  Set Vkv.nFixVob  =NUMBER_Null
.head 5 -  Set Vkv.sTT = TTT
.head 5 +  If not SqlPrepareAndExecute(hSql(),
  "SELECT name, fli, flv, nvl(dk,1),  sk, flags
   INTO :Vkv.sTTN,  :Vkv.nFli, :Vkv.nFlv, :Vkv.nDk, :Vkv.nSk_TT,:Vkv.colFlags
   FROM tts WHERE tt=:Vkv.sTT " )
or not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox("Не описана операція " || TTT, "Помилка", MB_IconExclamation)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  !
.head 5 -  Set Vkv.sNlsA_TT  = Vkv.sAccA
.head 5 -  Set Vkv.sNlsB_TT  = Vkv.sAccA
.head 5 -  Set Vkv.nKvB_TT = GetBaseVal()
.head 5 -  !
.head 5 -  Call Flgs2aFlg(Vkv.colFlags)
.head 5 -  ! Set Vkv.nFpy =SalStrToNumber(SalStrMidX(Vkv.colFlags,37,1))
.head 5 -  ! Set Vkv.nFvD1=SalStrToNumber(SalStrMidX(Vkv.colFlags,3,1))
.head 5 -  ! Set Vkv.nFvD2=SalStrToNumber(SalStrMidX(Vkv.colFlags,49,1))
.head 5 -  ! Set Vkv.nFtr =SalStrToNumber(SalStrMidX(Vkv.colFlags,59,1))
.head 5 -  ! Set Vkv.nFbk =SalStrToNumber(SalStrMidX(Vkv.colFlags,60,1))
.head 5 -  ! Set Vkv.nFcb =SalStrToNumber(SalStrMidX(Vkv.colFlags,58,1))
.head 5 -  ! Set Vkv.nFpr =SalStrToNumber(SalStrMidX(Vkv.colFlags,46,1))
.head 5 -  ! Set Vkv.nFdp =SalStrToNumber(SalStrMidX(Vkv.colFlags,35,1))
.head 5 -  ! Set Vkv.nFug =SalStrToNumber(SalStrMidX(Vkv.colFlags,12,1))
.head 5 -  ! Set Vkv.nFeq =SalStrToNumber(SalStrMidX(Vkv.colFlags,14,1))
.head 5 +  ! If SalStrToNumber(SalStrMidX(Vkv.colFlags,9,1)) = 0
.head 6 -                                                                                                                                                                                               Set Vkv.nSk_TT = NUMBER_Null
.head 5 +  ! Else
.head 6 +                                                                                                                                                                                               If Vkv.nSk_TT=NUMBER_Null
.head 7 -                                                                                                                                                                                               Set Vkv.nSk_TT =0
.head 4 -  Call SalSetWindowText(hWndForm, 'НЕТОРГОВІ валютообмінні операції - [ ' || Vkv.sTT ||' '|| Vkv.sTTN || ' ]')
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  ! Set dFIO = Vkv.aVal[Vkv.iFIO]
.head 4 -  Call SalEnableWindow( pb_ )
.head 4 -  Call SalSetFocus(pb_)
.head 1 +  Table Window: kp_MAJAR
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт коммунальные платежи (MAJAR)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.138"
.head 4 -  Top:    0.979"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.024"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45588
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45589
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45590
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfKat
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.119"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Каталог импорта
.head 5 -  Resource Id: 45591
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.head 4 +  Custom Control: cc1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cMeter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  DLL Name:
.head 6 -  MS Windows Class Name:
.head 6 -  Style:  Class Default
.head 6 -  ExStyle:  Class Default
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.05"
.head 7 -  Top:    0.643"
.head 7 -  Width:  9.7"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Etched Border? Class Default
.head 6 -  Hollow? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Horizontal Scroll? Class Default
.head 6 -  Tab Stop? Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  DLL Settings
.head 5 -  Message Actions
.head 4 -  ! ! Background Text: Файл импорта
.head 4 +  Data Field: dfFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.381"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfRec
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.233"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.517"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDone
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.0"
.head 7 -  Top:    0.679"
.head 7 -  Width:  3.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfFIFI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Charcoal
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set dfFIFI = 'Файл импорта'
.head 2 +  Contents
.head 3 +  Column: colFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRecc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во зап.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  String: sCurrentDir
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: sFile
.head 3 -  Sql Handle: hSqlA
.head 3 -  String: sFIO
.head 3 -  String: sNDOM
.head 3 -  String: sNKV
.head 3 -  Number: nKODA
.head 3 -  Number: nLC
.head 3 -  Number: nKUL
.head 3 -  Number: nRNP
.head 3 -  Number: nNA
.head 3 -  Number: nSALN
.head 3 -  Number: nMES
.head 3 -  String: smFiles[*]
.head 3 -  Number: nDelta
.head 3 -  Number: nPos
.head 3 -  Number: nCount
.head 3 -  Number: nCountUpd
.head 3 -  Number: nK_USL
.head 3 -  Number: nK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalHideWindow(dfFIFI)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'KP_MAJAR', 'C:\\KP_MAJAR', dfKat, GetIniFileName())
.head 4 -  Set dfKat = IifS(Right(dfKat, 1)='\\', Left(dfKat, Len(dfKat)-1), dfKat)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalHideWindow(cc1)
.head 4 -  Call SalHideWindow(dfDone)
.head 4 -  Set nFiles = VisDosEnumFiles(dfKat || '\\OS???_??.DBF', FA_Standard, smFiles)
.head 4 -  ! вычитываем каталог и обрабатываем файлы OS???_??.DBF
.head 4 +  If nFiles > 0
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nI = 0
.head 5 +  While nI < nFiles
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set colFileName = smFiles[nI]
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalShowWindow(dfDone)
.head 5 +  If SalMessageBox('Информация за предыдущий период будет удалена. Продолжать ?',
   'ВНИМАНИЕ !', MB_IconHand | MB_YesNo) = IDYES
.head 6 -  Set dfDone = 'Очистка KP_MAJAR'
.head 6 -  ! If SqlPrepareAndExecute(hSql(), '
   TRUNCATE TABLE
   kp_majar')
.head 6 -  ! If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_majar')
.head 6 +  If SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_majar drop storage')
.head 7 -  Call SalShowWindow(dfFIFI)
.head 7 -  Call SalHideWindow(dfDone)
.head 7 -  Set dfDone = ''
.head 7 -  Call SalFileGetCurrentDirectory(sCurrentDir)
.head 7 -  Set nI = 0
.head 7 -  Set bU = TRUE
.head 7 +  While nI < nFiles and bU
.head 8 -  Set sFile = smFiles[nI]
.head 8 -  ! Set nRow = TBL_MinRow
.head 8 -  Call SalFileSetCurrentDirectory(dfKat)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SqlConnect(hSqlA)
.head 9 -  Set nK_USL = Val(Subs(sFile,3,3))
.head 9 -  Call SalShowWindow(cc1)
.head 9 -  Call cc1.SetProgress(0)
.head 9 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     INTO :nCount
     FROM " || sFile)
.head 9 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 9 -  Call SalTblSetContext(hWndForm, nI)
.head 9 -  Set colProgressDone = 'Импорт ...'
.head 9 -  Set nDelta = 100 / nCount
.head 9 -  Set dfFile = sFile || ' (' || Str(nI+1) || ' из ' || Str(nFiles) || ')'
.head 9 -  Set dfRec = Str(nCount) || ' зап.'
.head 9 -  Set nPos = 0
.head 9 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT KODA,LC,FIO,KUL,NDOM,NKV,RNP,NA,SALN,MES
     INTO :nKODA,:nLC,:sFIO,:nKUL,:sNDOM,:sNKV,:nRNP,:nNA,:nSALN,:nMES
     FROM " || sFile)
.head 9 -  Set nK = 1
.head 9 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  Set colRecc = nK
.head 10 -  Set sFIO = SalStrTrimX(StrDosToWinX(sFIO))
.head 10 -  Set sNDOM = SalStrTrimX(sNDOM)
.head 10 -  Set sNKV = SalStrTrimX(sNKV)
.head 10 +  If SqlPrepareAndExecute(hSql(), '
   UPDATE kp_majar
   SET KODA=:nKODA,FIO=:sFIO,KUL=:nKUL,NDOM=:sNDOM,NKV=:sNKV,RNP=:nRNP,NA=:nNA,
       SALN=:nSALN,MES=:nMES
   WHERE LC=:nLC and K_USL=:nK_USL')
.head 11 -  Set nCountUpd = 0
.head 11 -  Call SqlGetModifiedRows(hSql(), nCountUpd)
.head 11 +  If nCountUpd = 0
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO kp_majar (KODA,LC,FIO,KUL,NDOM,NKV,RNP,NA,SALN,MES,K_USL)
   VALUES (:nKODA,:nLC,:sFIO,:nKUL,:sNDOM,:sNKV,:nRNP,:nNA,:nSALN,:nMES,
           :nK_USL)')
.head 13 -  Call MessageNoWait('Импорт MAJAR. Невозможно вставить строку в KP_MAJAR.' ||
     'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 13 -  Set bU = FALSE
.head 13 -  Break
.head 11 -  ! Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 11 -  ! Call SalTblSetContext(hWndForm, nRow)
.head 11 -  ! Set colKODA = nKODA
.head 11 -  ! Set colLC = nLC
.head 11 -  ! Set colFIO = sFIO
.head 11 -  ! Set colKUL = nKUL
.head 11 -  ! Set colNDOM = sNDOM
.head 11 -  ! Set colNKV = sNKV
.head 11 -  ! Set colRNP = nRNP
.head 11 -  ! Set colNA = nNA
.head 11 -  ! Set colSALN = nSALN
.head 11 -  ! Set colMES = nMES
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Call cc1.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 11 -  Set nK = nK + 1
.head 10 +  Else
.head 11 -  Call MessageNoWait('Импорт MAJAR. Невозможно вставить строку в KP_MAJAR. ' ||
     'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 11 -  Set bU = FALSE
.head 11 -  ! Call SqlDisconnect(hSqlA)
.head 11 -  Break
.head 9 -  Call SqlDisconnect(hSqlA)
.head 9 -  Call SalHideWindow(cc1)
.head 9 -  Set dfFile = ''
.head 9 -  Set dfRec = ''
.head 9 -  Set colProgressDone = 'Готово !!!'
.head 9 -  Call SalTblSetRowFlags(hWndForm, nI, ROW_Edited | ROW_New, FALSE)
.head 9 -  Call SalFileCreateDirectory(dfKat || '\\Archiv')
.head 9 -  Call VisFileCopy(dfKat || '\\' || smFiles[nI], dfKat || '\\Archiv\\' ||
     smFiles[nI])
.head 9 +  If File(dfKat || '\\Archiv\\' || smFiles[nI])
.head 10 -  Call VisFileDelete(dfKat || '\\' || smFiles[nI])
.head 9 -  Set nI = nI + 1
.head 7 +  If bU
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalHideWindow(cc1)
.head 8 -  Call SalShowWindow(dfDone)
.head 8 -  Set dfDone = 'Готово'
.head 8 -  Call SalHideWindow(dfFIFI)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Импорт MAJAR. Невозможно удалить старую информацию из KP_MAJAR. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 5 +  Else
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Else
.head 5 -  Call MessageNoWait('Импорт MAJAR. Отсутствуют файлы для импорта (' || dfKat ||
     '\\OS???_??.DBF)', 'ВНИМАНИЕ !!!', 7, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 1 +  Table Window: kp_UTEL
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт коммунальные платежи (UTEL)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.138"
.head 4 -  Top:    0.979"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.024"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45592
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45593
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45594
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfKat
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.119"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Каталог импорта
.head 5 -  Resource Id: 45595
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.head 4 +  Custom Control: cc1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cMeter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  DLL Name:
.head 6 -  MS Windows Class Name:
.head 6 -  Style:  Class Default
.head 6 -  ExStyle:  Class Default
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.05"
.head 7 -  Top:    0.643"
.head 7 -  Width:  9.7"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Etched Border? Class Default
.head 6 -  Hollow? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Horizontal Scroll? Class Default
.head 6 -  Tab Stop? Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  DLL Settings
.head 5 -  Message Actions
.head 4 -  ! ! Background Text: Файл импорта
.head 4 +  Data Field: dfFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.381"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDone
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.0"
.head 7 -  Top:    0.679"
.head 7 -  Width:  3.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfFIFI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Charcoal
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRecc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во зап.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: FileGetStr
.head 4 -                                                                                                                        Description:
.head 4 +                                                                                                                        Returns
.head 5 -                                                                                                                        String:
.head 4 +                                                                                                                        Parameters
.head 5 -                                                                                                                        File Handle: hF
.head 4 -                                                                                                                        Static Variables
.head 4 +                                                                                                                        Local variables
.head 5 -                                                                                                                        String: sTemp
.head 5 -                                                                                                                        Number: n0A
.head 4 +                                                                                                                        Actions
.head 5 +                                                                                                                        While TRUE
.head 6 +                                                                                                                        If Len(sBigBuffer) > 0
.head 7 -                                                                                                                        Set n0A = At(Chr(10), sBigBuffer)
.head 7 +                                                                                                                        If n0A > 0
.head 8 -                                                                                                                        Set sTemp = Left(sBigBuffer, n0A-1)
.head 8 -                                                                                                                        Set sBigBuffer = Right(sBigBuffer, Len(sBigBuffer)-n0A)
.head 8 -                                                                                                                        Return sTemp
.head 7 +                                                                                                                        Else
.head 8 -                                                                                                                        Set sFirst = sBigBuffer
.head 8 -                                                                                                                        Call ReadString(hF)
.head 6 +                                                                                                                        Else
.head 7 -                                                                                                                        Call ReadString(hF)
.head 6 +                                                                                                                        If nBytes = 0
.head 7 -                                                                                                                        Return ''
.head 6 +                                                                                                                        Else
.head 7 -                                                                                                                        Set sBigBuffer = sFirst || sBigBuffer
.head 3 +  ! Function: ReadString
.head 4 -                                                                                                                        Description:
.head 4 -                                                                                                                        Returns
.head 4 +                                                                                                                        Parameters
.head 5 -                                                                                                                        File Handle: hF
.head 4 -                                                                                                                        Static Variables
.head 4 -                                                                                                                        Local variables
.head 4 +                                                                                                                        Actions
.head 5 -                                                                                                                        Set sBigBuffer = Spac(65536)
.head 5 -                                                                                                                        Set nBytes = SalFileRead(hF, sBigBuffer, 65536)
.head 5 -                                                                                                                        Set sBigBuffer = VisStrRightTrim(sBigBuffer)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: sFile
.head 3 -  String: sFIO
.head 3 -  String: smFiles[*]
.head 3 -  Number: nCountUpd
.head 3 -  Number: nK
.head 3 -  String: sGRUPPA
.head 3 -  String: sSALDO
.head 3 -  String: sSUM_NACH
.head 3 -  String: sSUM_AVANS
.head 3 -  String: sSUM_OPLAT
.head 3 -  String: sPENJA
.head 3 -  String: sPHONE
.head 3 -  String: sLSCHET
.head 3 -  String: sABON_ID
.head 3 -  !
.head 3 -  String: sPUNKT
.head 3 -  String: sSTREET
.head 3 -  String: sNDOM
.head 3 -  String: sKVARTIRA
.head 3 -  ! String: smFIO[*]
.head 3 -  ! String: smLSCHET[*]
.head 3 -  ! String: smABON_ID[*]
.head 3 -  ! String: smPHONE[*]
.head 3 -  ! String: smGRUPPA[*]
.head 3 -  ! String: smSALDO[*]
.head 3 -  ! String: smSUM_NACH[*]
.head 3 -  ! String: smSUM_AVANS[*]
.head 3 -  ! String: smSUM_OPLAT[*]
.head 3 -  ! String: smPENJA[*]
.head 3 -  Number: nT
.head 3 -  Number: nJ
.head 3 -  Number: nInd
.head 3 -  File Handle: hF
.head 3 -  String: sBuffer
.head 3 -  String: smTemp[*]
.head 3 -  Number: nTek
.head 3 -  Number: nFileSize
.head 3 -  String: sType
.head 3 -  String: sSqlUpdate
.head 3 -  String: sSqlInsert
.head 3 -  !
.head 3 -  ! String: sFirst
.head 3 -  ! String: sBigBuffer
.head 3 -  ! Number: nBytes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'KP_UTEL', 'C:\\KP_UTEL', dfKat, GetIniFileName())
.head 4 -  Set dfKat = IifS(Right(dfKat, 1)='\\', Left(dfKat, Len(dfKat)-1), dfKat)
.head 4 -  Set dfFIFI = 'Файл импорта'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalHideWindow(dfFIFI)
.head 4 -  Call SalHideWindow(cc1)
.head 4 -  Call SalHideWindow(dfDone)
.head 4 -  Set nFiles = VisDosEnumFiles(dfKat || '\\S??????.UNL', FA_Standard, smFiles)
.head 4 -  ! вычитываем каталог и обрабатываем файлы A??????.UNL
.head 4 +  If nFiles > 0
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nI = 0
.head 5 +  While nI < 3
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set colFileName = IifS(nI=0, 'A', IifS(nI=1, 'R', 'S')) ||
    Right(smFiles[0], Len(smFiles[0])-1)
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalShowWindow(dfDone)
.head 5 -  ! If SalMessageBox('Информация за предыдущий период будет удалена. Продолжать ?',
   'ВНИМАНИЕ !', MB_IconExclamation | MB_YesNo | MB_SystemModal) = IDYES
.head 5 +  If SalMessageBox('Информация за предыдущий период будет удалена. Продолжать ?',
   'ВНИМАНИЕ !', MB_IconHand | MB_YesNo) = IDYES
.head 6 -  Set dfDone = 'Очистка KP_UTEL'
.head 6 -  ! If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_A') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_R') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_S')
.head 6 -  ! If SqlPLSQLCommand(hSql(), 'kp_utel_trunc')
.head 6 +  If SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel drop storage') and
   SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel_A drop storage') and
   SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel_R drop storage') and
   SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel_S drop storage')
.head 7 -  Set dfDone = ''
.head 7 -  Call SalHideWindow(dfDone)
.head 7 -  Set bU = TRUE
.head 7 -  Call SalUpdateWindow(hWndForm)
.head 7 -  !
.head 7 -  Set sFile = 'A' || Right(smFiles[0], Len(smFiles[0])-1)
.head 7 -  Call SalShowWindow(cc1)
.head 7 -  Call cc1.SetProgress(0)
.head 7 -  Call SalShowWindow(dfFIFI)
.head 7 -  Set dfFile = sFile || ' (1 из 3)'
.head 7 -  Call SalUpdateWindow(hWndForm)
.head 7 -  !
.head 7 -  Set nTek = 0
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Set colProgressDone = 'Импорт ...'
.head 7 -  ! Call Debug(sFile)
.head 7 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 7 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 7 -  Set nJ = 0
.head 7 -  ! Set sFirst = ''
.head 7 -  ! Set sBigBuffer = ''
.head 7 -  ! Set nBytes = 0
.head 7 +  Loop
.head 8 -  Set sBuffer = Spac(512)
.head 8 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 9 -  Break
.head 8 -  ! Set sBuffer = FileGetStr(hF)
.head 8 +  ! If Len(sBuffer) = 0
.head 9 -                                                                                                                     Break
.head 8 -  Set nTek = nTek + Len(sBuffer) + 1
.head 8 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 8 -  Call SalTblSetContext(hWndForm, 0)
.head 8 -  Set colRecc = nJ
.head 8 -  Call SalUpdateWindow(hWndForm)
.head 8 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 8 +  If nInd > 3
.head 9 -  Set sLSCHET = smTemp[0]
.head 9 -  Set sABON_ID = smTemp[1]
.head 9 -  Set sPHONE = smTemp[2]
.head 9 -  Set sFIO = smTemp[3]
.head 9 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_A (LSCHET,ABON_ID,PHONE,FIO)
     VALUES (:sLSCHET,:sABON_ID,:sPHONE,:sFIO)')
.head 8 -  Set nJ = nJ + 1
.head 7 -  Set colProgressDone = 'Готово !!!'
.head 7 -  Call SalFileClose(hF)
.head 7 -  !
.head 7 -  Set nTek = 0
.head 7 -  Set sFile = 'R' || Right(smFiles[0], Len(smFiles[0])-1)
.head 7 -  ! Call Debug(sFile)
.head 7 -  Call SalTblSetContext(hWndForm, 1)
.head 7 +  If File(dfKat || '\\' || sFile)
.head 8 -  Set colProgressDone = 'Импорт ...'
.head 8 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 8 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 8 -  Set dfFile = sFile || ' (2 из 3)'
.head 8 -  Set nJ = 0
.head 8 -  Set nTek = 0
.head 8 -  ! Set sFirst = ''
.head 8 -  ! Set sBigBuffer = ''
.head 8 -  ! Set nBytes = 0
.head 8 +  Loop
.head 9 -  Set sBuffer = Spac(512)
.head 9 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 10 -  Break
.head 9 -  ! Set sBuffer = FileGetStr(hF)
.head 9 +  ! If Len(sBuffer) = 0
.head 10 -                                                                                                                     Break
.head 9 -  Set nTek = nTek + Len(sBuffer) + 1
.head 9 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 9 -  ! Call SalTblSetContext(hWndForm, 1)
.head 9 -  Set colRecc = nJ
.head 9 -  Call SalUpdateWindow(hWndForm)
.head 9 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 9 +  If nInd > 6
.head 10 -  Set sLSCHET = smTemp[0]
.head 10 -  Set sABON_ID = smTemp[1]
.head 10 -  Set sFIO = smTemp[2]
.head 10 -  Set sPUNKT = smTemp[3]
.head 10 -  Set sSTREET = smTemp[4]
.head 10 -  Set sNDOM = smTemp[5]
.head 10 -  Set sKVARTIRA = smTemp[6]
.head 10 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_R (LSCHET,ABON_ID,FIO,PUNKT,STREET,NDOM,KVARTIRA)
     VALUES (:sLSCHET,:sABON_ID,:sFIO,:sPUNKT,:sSTREET,:sNDOM,:sKVARTIRA)')
.head 9 -  Set nJ = nJ + 1
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Call SalFileClose(hF)
.head 7 +  Else
.head 8 -  Set colProgressDone = 'Нет ' || sFile
.head 7 -  !
.head 7 -  Set nTek = 0
.head 7 -  Set sFile = 'S' || Right(smFiles[0], Len(smFiles[0])-1)
.head 7 -  Call SalTblSetContext(hWndForm, 2)
.head 7 +  If File(dfKat || '\\' || sFile)
.head 8 -  Set colProgressDone = 'Импорт ...'
.head 8 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 8 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 8 -  Set dfFile = sFile || ' (3 из 3)'
.head 8 -  Set nJ = 0
.head 8 -  Set nTek = 0
.head 8 -  ! Set sFirst = ''
.head 8 -  ! Set sBigBuffer = ''
.head 8 -  ! Set nBytes = 0
.head 8 +  Loop
.head 9 -  Set sBuffer = Spac(512)
.head 9 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 10 -  Break
.head 9 -  ! Set sBuffer = FileGetStr(hF)
.head 9 +  ! If Len(sBuffer) = 0
.head 10 -                                                                                                                     Break
.head 9 -  Set nTek = nTek + Len(sBuffer) + 1
.head 9 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 9 -  ! Call SalTblSetContext(hWndForm, 2)
.head 9 -  Set colRecc = nJ
.head 9 -  Call SalUpdateWindow(hWndForm)
.head 9 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 9 +  If nInd > 7
.head 10 -  Set sLSCHET = smTemp[0]
.head 10 -  Set sABON_ID = smTemp[1]
.head 10 -  Set sGRUPPA = smTemp[2]
.head 10 -  Set sSALDO = smTemp[3]
.head 10 -  Set sSUM_NACH = smTemp[4]
.head 10 -  Set sSUM_AVANS = smTemp[5]
.head 10 -  Set sSUM_OPLAT = smTemp[6]
.head 10 -  Set sPENJA = smTemp[7]
.head 10 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_S (LSCHET,ABON_ID,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                     PENJA)
     VALUES (:sLSCHET,:sABON_ID,:sGRUPPA,:sSALDO,:sSUM_NACH,:sSUM_AVANS,
             :sSUM_OPLAT,:sPENJA)')
.head 9 -  Set nJ = nJ + 1
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Call SalFileClose(hF)
.head 7 +  Else
.head 8 -  Set colProgressDone = 'Нет ' || sFile
.head 7 -  !
.head 7 -  Call SalHideWindow(cc1)
.head 7 -  Set dfFile = ''
.head 7 -  Call SalHideWindow(dfFIFI)
.head 7 -  Call SalShowWindow(dfDone)
.head 7 -  Set dfDone = 'Наполнение KP_UTEL'
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colFileName = 'таблица KP_UTEL'
.head 7 -  Set colProgressDone = 'Наполнение ...'
.head 7 -  Call SalUpdateWindow(hWndForm)
.head 7 -  ! вставить в kp_utel
.head 7 -  ! and a.PHONE=
     (SELECT a.PHONE
      FROM kp_utel_s s, kp_utel_a a
      WHERE s.LSCHET=a.LSCHET and s.ABON_ID=a.ABON_ID and rownum=1) ???
.head 7 -  Set bU = SqlPrepareAndExecute(hSql(), "
    INSERT
    INTO kp_utel (LSCHET,ABON_ID,FIO,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                  PENJA,PHONE)
   (SELECT s.LSCHET,s.ABON_ID,a.FIO,s.GRUPPA,to_number(s.SALDO),
           to_number(s.SUM_NACH),to_number(s.SUM_AVANS),to_number(s.SUM_OPLAT),
           to_number(s.PENJA),max(a.PHONE)
    FROM kp_utel_s s, kp_utel_a a
    WHERE s.LSCHET=a.LSCHET and s.ABON_ID=a.ABON_ID and s.LSCHET<>'-1'
    GROUP BY s.LSCHET,s.ABON_ID,a.FIO,s.GRUPPA,to_number(s.SALDO),
             to_number(s.SUM_NACH),to_number(s.SUM_AVANS),to_number(s.SUM_OPLAT),
             to_number(s.PENJA))") and
    SqlPrepareAndExecute(hSql(), "
    INSERT
    INTO kp_utel (LSCHET,ABON_ID,FIO,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                  PENJA,PUNKT,STREET,NDOM,KVARTIRA)
   (SELECT r.LSCHET,r.ABON_ID,r.FIO,s.GRUPPA,s.SALDO,to_number(s.SUM_NACH),
           to_number(s.SUM_AVANS),to_number(s.SUM_OPLAT),to_number(s.PENJA),r.PUNKT,
           r.STREET,r.NDOM,r.KVARTIRA
    FROM kp_utel_s s, kp_utel_r r
    WHERE s.LSCHET=r.LSCHET and s.ABON_ID=r.ABON_ID and s.LSCHET<>'-1')")
.head 7 +  If bU
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalFileCreateDirectory(dfKat || '\\Archiv')
.head 8 -  Call VisFileCopy(dfKat || '\\A' || Right(sFile, 10), dfKat || '\\Archiv\\A' ||
     Right(sFile, 10))
.head 8 +  If File(dfKat || '\\Archiv\\A' || Right(sFile, 10))
.head 9 -  Call VisFileDelete(dfKat || '\\A' || Right(sFile, 10))
.head 8 -  Call VisFileCopy(dfKat || '\\S' || Right(sFile, 10), dfKat || '\\Archiv\\S' ||
     Right(sFile, 10))
.head 8 +  If File(dfKat || '\\Archiv\\S' || Right(sFile, 10))
.head 9 -  Call VisFileDelete(dfKat || '\\S' || Right(sFile, 10))
.head 8 -  Call VisFileCopy(dfKat || '\\R' || Right(sFile, 10), dfKat || '\\Archiv\\R' ||
     Right(sFile, 10))
.head 8 +  If File(dfKat || '\\Archiv\\R' || Right(sFile, 10))
.head 9 -  Call VisFileDelete(dfKat || '\\R' || Right(sFile, 10))
.head 8 -  Set colRecc = Val(GetValueStr('
    SELECT to_char(count(*))
    FROM kp_utel'))
.head 8 -  ! Call SalHideWindow(cc1)
.head 8 -  ! Call SalShowWindow(dfDone)
.head 8 -  ! Call SalHideWindow(dfFIFI)
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Set dfDone = 'Готово'
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 1, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 2, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 3, ROW_Edited | ROW_New, FALSE)
.head 8 -  ! Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call MessageNoWait('Импорт UTEL. Невозможно наполнить правильными данными KP_UTEL. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 37, 1)
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Импорт UTEL. Невозможно удалить старую информацию из KP_UTEL. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 37, 1)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 5 +  Else
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Else
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call MessageNoWait('Импорт UTEL. Отсутствуют файлы для импорта (' || dfKat ||
     '\\A??????.UNL)', 'ВНИМАНИЕ !!!', 37, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 1 +  Dialog Box: dlg_LoadDbf    ! 01 Импорт с DBF приехал с OTCN.apd,  с прибамбасом
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Загрузка файла
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.738"
.head 4 -  Top:    1.188"
.head 4 -  Width:  7.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.452"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Загрузка файлов dbf в таблицы б.д. (MIK+IVAN)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  !
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.143"
.head 6 -  Top:    1.107"
.head 6 -  Width:  6.829"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.281"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 45596
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.171"
.head 6 -  Top:    0.156"
.head 6 -  Width:  5.186"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSetFocus(hWndItem)
.head 3 +  Pushbutton: pbChoose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать...
.head 4 -  Window Location and Size
.head 5 -  Left:   5.486"
.head 5 -  Top:    0.135"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 3 +  Check Box: cbTransCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Перекодировать из кодировки OEM (DOS) в ANSI (WIN)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.595"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 45597
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    0.988"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.531"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 45598
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    1.5"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.533"
.head 5 -  Top:    1.571"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set fOpen=TRUE
.head 6 +  If dfPath = STRING_Null or dfPath = ''
.head 7 -  Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 6 +  Else
.head 7 -  Call VisDosSplitPath(dfPath, tmp01, tmp02, tmp03, tmp04)
.head 7 -  Set strFile=tmp03 || tmp04
.head 7 +  If not strFile
.head 8 -  Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 6 +  If fOpen
.head 7 +  If SalFileSetCurrentDirectory(SalStrLeftX(dfPath, SalStrScan(dfPath,strFile)-1))
.head 8 -  Call SalSetWindowText(hWndForm, 'Загрузка файла ' || dfPath)
.head 8 -  Call CreTabSqlFromDbf(strFile, strTabName, strPrcName, cbTransCode)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Не удалось переити в каталог
' || dfPath, '', MB_OK)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.167"
.head 5 -  Top:    1.571"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Data Field: dfRecN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    0.595"
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: CreTabSqlFromDbf
.head 4 -  Description: Создание таблиы из DFB-файла
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDbf
.head 5 -  String: sTabName     ! Имя таблицы куда импортить
.head 5 -  String: sProcName    ! Имя процедуры после импорта
.head 5 -  Boolean: bTrans
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlOdbc
.head 5 -  File Handle: hFile
.head 5 -  String: sBuf
.head 5 -  String: sItem
.head 5 -  String: sTyp
.head 5 -  String: sLen1
.head 5 -  String: sLen2
.head 5 -  Number: i
.head 5 -  Number: j
.head 5 -  Number: nLen1
.head 5 -  Number: nLen2
.head 5 -  String: sSqlItm
.head 5 -  String: sSqlSel
.head 5 -  String: sSqlBin
.head 5 -  String: sTabI  ! имя входной таблицы (dbf)
.head 5 -  String: sTabO  ! имя выходной таблицы ОРАКЛЕ
.head 5 -  String: sRealTab
.head 5 -  Number: NTmp[*]
.head 5 -  Number: LTmp[*]
.head 5 -  String: CTmp[*]
.head 5 -  Date/Time: DTmp[*]
.head 5 -  ! Number: nRec
.head 5 -  Number: nDelta
.head 5 -  Number: nFetchRes
.head 5 -  Number: nBound
.head 5 -  Boolean: fRecreate
.head 5 -  Boolean: fExists
.head 5 -  ! Boolean: fInsertRow
.head 5 -  Number: nRowsCount
.head 5 -  Number: nRow
.head 5 -  Number: nChoose
.head 5 -  !
.head 5 -  String: sSqlDel
.head 5 -  Number: nKp
.head 5 -  Number: nKv
.head 5 -  Number: nI
.head 5 -  String: smPer[*]
.head 5 -  String: smVal[*]
.head 5 -  Boolean: bDel
.head 5 -  Boolean: bDelZ
.head 4 +  Actions
.head 5 +  If SalFileOpen(hFile, sDbf, OF_Read)
.head 6 -  Call SalFileRead(hFile, sBuf, 32)
.head 6 -  Set sSqlItm = ''
.head 6 -  Set j = 0
.head 6 +  While SalFileRead(hFile, sBuf, 32) > 0
.head 7 -  Set sItem = SalStrTrimX(sBuf)
.head 7 +  If SalStrLop(sBuf) = 13
.head 8 -  Set sSqlItm = sSqlItm || ')'
.head 8 -  Break
.head 7 +  Else
.head 8 +  If SalStrLength(sSqlItm) = 0
.head 9 -  Set i = SalStrLength(sDbf)
.head 9 +  While i > 0
.head 10 -  ! Call SalMessageBox(SalStrMidX(sDbf, i-1, 1), 'MMM', MB_OK)
.head 10 +  If SalStrMidX(sDbf, i-1, 1) = '\\' or SalStrMidX(sDbf, i-1, 1) = ':'
.head 11 -  Break
.head 10 -  Set i = i - 1
.head 9 -  Set sTabI = SalStrMidX(sDbf, i, SalStrLength(sDbf) - i)
.head 9 -  Set i = SalStrScan(sTabI, '.')
.head 9 +  If i >= 0
.head 10 -  Set sTabI = SalStrLeftX(sTabI, SalStrScan(sTabI, '.'))
.head 9 -  Set sSqlItm = '('
.head 9 -  Set sSqlSel = ''
.head 9 -  Set sSqlBin = ''
.head 9 -  ! Call SalMessageBox(sSql, 'SSS', MB_OK)
.head 9 -  ! Return FALSE
.head 8 +  Else
.head 9 -  Set sSqlItm = sSqlItm || ',' || SalNumberToChar(10)
.head 9 -  Set sSqlSel = sSqlSel || ','
.head 9 -  Set sSqlBin = sSqlBin || ','
.head 7 -  Set i = 0
.head 7 -  ! Call Debug(sItem)
.head 7 -  ! Call Debug(sSqlItm)
.head 7 +  While i < 10
.head 8 -  Call SalStrLop(sBuf)
.head 8 -  Set i = i + 1
.head 7 -  Set sTyp = SalNumberToChar(SalStrLop(sBuf))
.head 7 +  If not (sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L')
.head 8 -  Set sSqlItm = SalStrMidX(sSqlItm, 0, SalStrLength(sSqlItm)-2)
.head 8 -  Set sSqlSel = SalStrMidX(sSqlSel, 0, SalStrLength(sSqlSel)-1)
.head 8 -  Set sSqlBin = SalStrMidX(sSqlBin, 0, SalStrLength(sSqlBin)-1)
.head 7 -  Set i = 0
.head 7 +  While i < 4
.head 8 -  Call SalStrLop(sBuf)
.head 8 -  Set i = i + 1
.head 7 -  Set nLen1 = SalStrLop(sBuf)
.head 7 -  Set sLen1 = SalNumberToStrX(nLen1, 0)
.head 7 -  Set nLen2 = SalStrLop(sBuf)
.head 7 -  Set sLen2 = SalNumberToStrX(nLen2, 0)
.head 7 +  If sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L'
.head 8 -  Set sSqlBin = sSqlBin || ':' || sTyp || 'Tmp[' || SalNumberToStrX(j, 0) || ']'
.head 8 -  ! Call Debug(sSqlBin)
.head 8 -  Set j = j + 1
.head 8 +  If sTyp = 'C'
.head 9 +  If nLen1 < 11
.head 10 -  Set sTyp = 'CHAR'
.head 9 +  Else
.head 10 -  Set sTyp = 'VARCHAR'
.head 8 +  Else If sTyp = 'N'
.head 9 +  If nLen1 < 5 and nLen2 = 0
.head 10 -  Set sTyp = 'SMALLINT'
.head 10 -  Set sLen1 = ''
.head 9 +  Else If nLen1 < 10 and nLen2 = 0
.head 10 -  Set sTyp = 'INTEGER'
.head 10 -  Set sLen1 = ''
.head 9 +  Else
.head 10 -  Set sTyp = 'DECIMAL'
.head 10 -  Set sLen1 = sLen1 || ',' || sLen2
.head 8 +  Else If sTyp = 'D'
.head 9 -  Set sTyp = 'DATE'
.head 9 -  Set sLen1 = ''
.head 8 +  Else If sTyp = 'L'
.head 9 -  Set sTyp = 'CHAR'
.head 9 -  Set sLen1 = '1'
.head 8 +  If sLen1 = ''
.head 9 -  Set sSqlItm = sSqlItm || sItem || ' ' || sTyp
.head 8 +  Else
.head 9 -  Set sSqlItm = sSqlItm || sItem || ' ' || sTyp || '(' || sLen1 || ')'
.head 8 -  Set sSqlSel = sSqlSel || sItem
.head 6 +  If hFile
.head 7 -  Call SalFileClose(hFile)
.head 6 -  ! =====================================
.head 6 -  Set SqlDatabase = 'dBase_Files'
.head 6 +  If SqlConnect(hSqlOdbc)
.head 7 +  If sTabName
.head 8 -  Set sTabO = sTabName   ! Внешнее имя создаваемой таблицы
.head 7 +  Else
.head 8 -  Set sTabO = sTabI      ! Имя таблицы совпадает с именем DBF
.head 7 -  Set sRealTab=sTabO
.head 7 +  If TableExists(sRealTab)
.head 8 -  Set fExists = TRUE
.head 8 -  ! смотрим есть ли записи в таблице
.head 8 +  If SqlPrepareAndExecute(hSqlAux(), 'SELECT count(*) INTO :nRowsCount FROM ' || sRealTab)
.head 9 -  Call SqlFetchNext(hSqlAux(), nRow)
.head 8 -  ! если нету строк - drop-нуть или оставить
.head 8 +  If nRowsCount = 0
.head 9 -  ! If SalMessageBox('Таблица ' || sRealTab || ' уже существует (пустая) !' ||
   PutCrLf() || 'Удалить таблицу ' || sRealTab || ' и создать НОВУЮ ?',
   'Подтверждение', MB_YesNo | MB_IconExclamation) = IDYES
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgTable') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg11') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg12') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg13'),
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTConfirm'), MB_YesNo | MB_IconExclamation) = IDYES
.head 10 -  Set fRecreate = TRUE
.head 10 -  Set bDel = FALSE
.head 10 -  Set bDelZ = FALSE
.head 9 +  Else
.head 10 -  Return FALSE
.head 8 -  ! если есть строки - drop-нуть или просто удалить записи?
.head 8 +  Else
.head 9 -  Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 9 -  Set hBtns[0] = hBtnDelNew
.head 9 -  Set hBtns[1] = hBtnNoDelNew
.head 9 -  Set hBtns[2] = hBtnNo | MBF_DefButton
.head 9 -  Set hBtns[3] = hBtnNoDelPlusNew1
.head 9 -  Set hBtns[4] = hBtnNoDelPlusNew2
.head 9 -  ! Set nChoose = VisMessageBox(
'Таблица ' || sRealTab || ' уже существует c данными !' || PutCrLf() || PutCrLf() ||
'                 НОВАЯ - Удалить таблицу и создать НОВУЮ' || PutCrLf() ||
'               ЗАМЕНА - НЕ удалять таблицу, УДАЛИТЬ старые данные' || PutCrLf() ||
'НОВЫЕ ДАННЫЕ - НЕ удалять таблицу, добавить ТОЛЬКО НОВЫЕ данные' || PutCrLf() ||
'          ДОБАВИТЬ - НЕ удалять таблицу, добавить ВСЕ данные', 'ЗАПРОС', MBF_IconQuestion, hBtns, 5)
.head 9 -  Set nChoose = VisMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgTable') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg21') || PutCrLf() || PutCrLf() ||
    '                 ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnDelNew') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg22') || PutCrLf() ||
    '               ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelNew') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg23') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew1') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg24') || PutCrLf() ||
    '          ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew2') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg25'),
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTQuery'), MBF_IconQuestion, hBtns, 5)
.head 9 -  ! Call DebugN(nChoose)
.head 9 +  If nChoose = 0
.head 10 -  Set fRecreate = TRUE
.head 10 -  Set bDel = FALSE
.head 9 +  If nChoose = 1
.head 10 -  Set fRecreate = FALSE
.head 10 -  Set bDel = TRUE
.head 10 -  Set bDelZ = TRUE
.head 9 +  If nChoose = 2
.head 10 -  Return FALSE
.head 9 +  If nChoose = 3
.head 10 -  Set fRecreate = FALSE
.head 10 -  Set bDel = FALSE
.head 10 -  Set bDelZ = TRUE
.head 9 +  If nChoose = 4
.head 10 -  Set fRecreate = FALSE
.head 10 -  Set bDel = FALSE
.head 10 -  Set bDelZ = FALSE
.head 9 +  ! Set nChoose = SalMessageBox('Таблица ' || sRealTab ||
    ' уже существует c данными, удалить ?!
    ' || '
Удалить таблицу и создать новую ' || sRealTab || '(Yes/Да).
Не удалять таблицу, только импортировать новые данные(No/Нет) ?',
    'Подтверждение', MB_YesNoCancel | MB_IconExclamation)
.head 10 -                                                                                                                    Set fRecreate = TRUE
.head 9 +  ! If nChoose = IDCANCEL
.head 10 -                                                                                                                    Return FALSE
.head 9 +  ! If nChoose = IDNO
.head 10 -                                                                                                                    Set fRecreate = FALSE
.head 9 +  ! If nChoose = IDYES
.head 10 -                                                                                                                    Set fRecreate = TRUE
.head 7 +  Else
.head 8 -  Set fRecreate = TRUE
.head 8 -  Set fExists = FALSE
.head 7 -  ! Синоним существует - убиваем нафиг
.head 7 +  If TRUE
.head 8 +  When SqlError
.head 9 -  Return FALSE
.head 8 -  ! Дропаем его нафиг
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'DROP PUBLIC SYNONYM ' || sTabO)
.head 7 +  If fRecreate
.head 8 +  If fExists
.head 9 +  If SqlPrepareAndExecute(hSql(), 'DROP TABLE ' || sRealTab)
.head 10 +  When SqlError
.head 11 -  Return FALSE
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'DROP PUBLIC SYNONYM ' || sTabO)
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'DROP ROLE ' || sTabO)
.head 9 +  Else
.head 10 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'CREATE TABLE ' || sTabO || ' ' || sSqlItm)
.head 7 +  Else
.head 8 -  ! есть строки - просто удалить записи
.head 8 +  If bDel
.head 9 +  If SqlPrepareAndExecute(hSqlAux(), 'DELETE FROM ' || sRealTab)
.head 10 -  Call SqlCommit(hSqlAux())
.head 9 +  Else
.head 10 -  ! Call SalMessageBox('Невозможно удалить записи из таблицы ' || sRealTab, 'Внимание', 0)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgDel') || ' ' || sRealTab,
  CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 10 -  Return FALSE
.head 7 -  Set dfRecN=0
.head 7 -  Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT count(*) FROM ' || sTabI || ' INTO :dfRecN')
.head 7 -  Call SqlFetchNext(hSqlOdbc, nFetchRes)
.head 7 +  If dfRecN > 0
.head 8 -  Set i = 0
.head 8 -  Set nDelta = 100/dfRecN
.head 8 -  Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT ' || sSqlSel || ' INTO ' || sSqlBin || ' FROM ' || sTabI)
.head 8 +  While SqlFetchNext(hSqlOdbc, nFetchRes)
.head 9 -  Set j = 0
.head 9 -  Call SalArrayGetUpperBound(CTmp, 1, nBound)
.head 9 +  While j <= nBound
.head 10 +  If SalStrLength(CTmp[j]) > 0
.head 11 -  Set CTmp[j] = SalStrTrimX(IifS(bTrans, StrDosToWinX(CTmp[j]), CTmp[j]))
.head 10 -  Set j = j + 1
.head 9 -  Set nKp = SalStrTokenize(sSqlSel, '', ',', smPer)
.head 9 -  Set nKv = SalStrTokenize(sSqlBin, '', ',', smVal)
.head 9 +  If nKp = nKv
.head 10 -  Set nI = 0
.head 10 -  Set sSqlDel = ''
.head 10 +  While nI < nKp
.head 11 -  Set sSqlDel = sSqlDel || smPer[nI] || '=' || smVal[nI] || ' and '
.head 11 -  Set nI = nI + 1
.head 10 -  Set sSqlDel = Left(sSqlDel, Len(sSqlDel)-5)
.head 9 +  If bDelZ
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'DELETE FROM ' || sTabO || ' WHERE ' || sSqlDel)
.head 9 -  Call SqlPrepareAndExecute(hSql(), 'INSERT INTO ' || sTabO || ' (' || sSqlSel || ') VALUES(' || sSqlBin || ')')
.head 9 -  Set i = i + nDelta
.head 9 -  Set dfRecN=dfRecN-1
.head 9 -  Call ccProgressBar.SetProgress(i)
.head 9 -  Call SalUpdateWindow (SalParentWindow (hWndForm))
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call ccProgressBar.SetProgress(100)
.head 7 -  Call SqlDisconnect(hSqlOdbc)
.head 7 +  If sProcName
.head 8 -  Call Debug('Процедура'||sProcName)
.head 8 +  If not SqlPLSQLCommand(hSql(),sProcName)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalMessageBox('Не удалось выполнить процедуру: ' || sProcName, 'Ошибка', MB_OK)
.head 9 -  Return FALSE
.head 7 -  ! Make some additional settings for using new table in ABS
.head 7 +  If TRUE
.head 8 +  When SqlError
.head 9 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'CREATE PUBLIC SYNONYM ' || sTabO || ' FOR ' || GetUserLoginName() || '.' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT SELECT ON ' || sTabO || ' TO START1')
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'CREATE ROLE ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT SELECT ON ' || sTabO || ' TO ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT INSERT ON ' || sTabO || ' TO ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT UPDATE ON ' || sTabO || ' TO ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT DELETE ON ' || sTabO || ' TO ' || sTabO)
.head 7 -  !
.head 7 -  Call SalMessageBeep(MB_IconAsterisk)
.head 7 -  ! Call SalMessageBox('Обработка файла завершена!', 'Загрузка', MB_IconAsterisk | MB_Ok)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgFileOk'),
 CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTLoad'), MB_IconAsterisk | MB_Ok)
.head 6 +  Else
.head 7 -  ! Call SalMessageBox('Нет доступа к базе данных: ' || SqlDatabase, 'Ошибка', MB_OK)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTErrDB') || ': ' || SqlDatabase,
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK)
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Call SalMessageBox('Не удалось открыть файл: ' || sDbf, 'Ошибка', MB_OK)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTerrFileOpen') || ': ' || sDbf,
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK)
.head 6 -  Return FALSE
.head 3 +  Function: TableExists
.head 4 -  Description: Находит таблицу по синониму или в схеме текущего ползователя
Возвращает True если таблица есть
Параметр sTabName возвращает полностью квалифицированное имя таблицы
OWNER.TABLE
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive String: sTabName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sOwner
.head 5 -  String: sTable
.head 4 +  Actions
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_OWNER, TABLE_NAME
   INTO :sOwner,:sTable
   FROM ALL_SYNONYMS
   WHERE UPPER(SYNONYM_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Синоним есть
.head 7 -  Set sOwner = SalStrTrimX(sOwner)
.head 7 -  Set sTable = SalStrTrimX(sTable)
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM DBA_TABLES
   WHERE UPPER(OWNER)=UPPER('" || SalStrTrimX(sOwner) || "') and
         UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTable) || "')")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! И указывает на таблицу
.head 9 -  Set sTabName = sOwner || '.' || sTable
.head 9 -  Return nFetchRes = FETCH_Ok
.head 8 +  Else
.head 9 -  ! И указывает в никуда
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM USER_TABLES
   WHERE UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 10 +  If SqlFetchNext(hSql(), nFetchRes)
.head 11 -  ! Но, таблица есть
.head 11 -  Set sTabName = GetUserLoginName() || '.' || sTable
.head 11 -  Return nFetchRes = FETCH_Ok
.head 6 +  Else
.head 7 -  ! Синонима нет
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM USER_TABLES
   WHERE UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Таблица есть
.head 9 -  Set sTabName = GetUserLoginName() || '.' || sTabName
.head 9 -  Return nFetchRes = FETCH_Ok
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  String: strFn
.head 3 -  String: strPar
.head 2 +  Window Variables
.head 3 -  Number: nIndex
.head 3 -  String: strFilters[2]
.head 3 -  String: strFile
.head 3 -  Boolean: fOpen
.head 3 -  String: tmp01
.head 3 -  String: tmp02
.head 3 -  String: tmp03
.head 3 -  String: tmp04
.head 3 -  !
.head 3 -  Number: hBtnDelNew
.head 3 -  Number: hBtnNoDelNew
.head 3 -  Number: hBtnNoDelPlusNew1
.head 3 -  Number: hBtnNoDelPlusNew2
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  String: strTabName
.head 3 -  String: strPrcName
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTWndTitle') )
.head 4 -  Call ShowApdVersion('01')
.head 4 -  Set dfPath = strFn
.head 4 -  Set strFilters[0] = 'Data Base Files (*.dbf)'
.head 4 -  Set strFilters[1] = '*.dbf'
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Загрузка файла ' || sFn)
.head 4 -  Set strTabName=SalStrTrimX(SalStrLeftX(strPar,SalStrScan(strPar||',',',')))
.head 4 -  Set strPrcName=SalStrTrimX(SalStrRightX(strPar,SalStrLength(strPar)-SalStrScan(strPar||',',',')-1))
.head 4 -  Call WaitCursorOn()
.head 3 +  On SAM_CreateComplete
.head 4 -  Set hBtnDelNew = VisMessageLoadButton('&0.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnDelNew'), 0)
.head 4 -  Set hBtnNoDelNew = VisMessageLoadButton('&1.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelNew'), 1)
.head 4 -  Set hBtnNo = VisMessageLoadButton('&2.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNo'), 2)
.head 4 -  Set hBtnNoDelPlusNew1 = VisMessageLoadButton('&3.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew1'), 3)
.head 4 -  Set hBtnNoDelPlusNew2 = VisMessageLoadButton('&4.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew2'), 4)
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call VisMessageFreeButton(hBtnDelNew)
.head 4 -  Call VisMessageFreeButton(hBtnNoDelNew)
.head 4 -  Call VisMessageFreeButton(hBtnNoDelPlusNew1)
.head 4 -  Call VisMessageFreeButton(hBtnNoDelPlusNew2)
.head 4 -  Call VisMessageFreeButton(hBtnNo)
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'Imp_KL_NBU(hWndMDI)')
.head 4 -  Call WaitCursorOff()
.head 1 +  Table Window: ADM1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Договор на комунальные платежи
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   3.063"
.head 4 -  Top:    0.417"
.head 4 -  Width:  14.733"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 8.44"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 5.179"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 -  !
.head 4 +  Data Field: dND
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.683"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Референс договора')
.head 4 +  Data Field: NLS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  3.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Счет 29*')
.head 6 +  On SAM_Validate
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT nls,acc,nms into :NLS,:dACC,:NMS from accounts where nls=:NLS")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Call SalMessageBox( 'Счет '||NLS||'не найден', "Внимание" , MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 4 +  Data Field: dACC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.483"
.head 7 -  Top:    0.071"
.head 7 -  Width:  0.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NMS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.983"
.head 7 -  Top:    0.071"
.head 7 -  Width:  4.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Наименование счета 29*')
.head 4 +  Data Field: NAME_D
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    0.405"
.head 7 -  Width:  8.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Название ген. соглашения')
.head 4 +  Data Field: SUM_D
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.583"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Сумма оплаты по-умолчанию')
.head 6 +  On SAM_Validate
.head 7 -  Call DecPoint(hWndItem)
.head 4 +  Check Box: GRP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Группировать
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.321"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call F_GRP()
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Использовать схему перекрытия')
.head 4 +  Check Box: NAK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: С накоплением
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.655"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call F_NAK()
.head 7 +  If NAK
.head 8 -  Call F_FillFromPerek()
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Накопление комиссии с юр. лица на счет 2902*')
.head 4 +  Pushbutton: pb_SK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_SPEC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать СКП'
.head 6 +  On SAM_Click
.head 7 -  Call F_SK ()
.head 4 +  Data Field: NMSK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.283"
.head 7 -  Top:    0.738"
.head 7 -  Width:  9.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Наименование СКП')
.head 4 +  Data Field: SK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    0.738"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If SK != NUMBER_Null  
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT name into :NMSK from sk where sk=:SK and sk <40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 -  Set NMSK= STRING_Null
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set NMSK= STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 4 -  !
.head 4 +  Pushbutton: pb_MFO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    1.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTBANK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать Банк-Б'
.head 6 +  On SAM_Click
.head 7 -  Call F_MFO ()
.head 4 +  Data Field: NB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.883"
.head 7 -  Top:    1.071"
.head 7 -  Width:  8.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  Pl_Ins || 'Наименование МФО-Б')
.head 4 +  Data Field: MFOB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    1.071"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_SetFocus
.head 7 +  If MFOB = NUMBER_Null
.head 8 -  Set MFOB = Val(GetBankMfo())
.head 8 -  Set NB= GetBankName()
.head 6 +  On SAM_Validate
.head 7 +  If MFOB != NUMBER_Null  
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT nb into :NB from banks where mfo=:MFOB and nvl(blk,0) <>4 ")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 -  Set NB = "! Ош.МФО-Б"
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Call SalSendMsg( NLSB, SAM_KillFocus, 0, 0 ) 
.head 7 +  Else
.head 8 -  Set NB = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  On SAM_KillFocus
.head 7 -  Call SalSendMsg( MFOB, SAM_Validate, 0, 0 ) 
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, Pl_Ins || 'МФО-Б')
.head 4 -  !
.head 4 +  Pushbutton: pb_Alien
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    1.429"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ACCOUNTS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: White
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать корреспондента'
.head 6 +  On SAM_Click
.head 7 -  Call F_Alien ()
.head 4 +  Data Field: NLSB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    1.405"
.head 7 -  Width:  2.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_KillFocus
.head 7 +  If MFOB != NUMBER_Null and NLSB != NUMBER_Null
.head 8 -  Set NLSB = Val(KeyAccount( Str(MFOB), Str(NLSB)) )
.head 7 +  If MFOB = Val(GetBankMfo())
.head 8 -  If SqlPrepareAndExecute( hSql(),
"SELECT a.nms,c.okpo into :NMSB,:OKPOB from accounts a,customer c where a.rnk=c.rnk and a.nls=:NLSB and a.kv=:n980")
and SqlFetchNext(hSql(), nFetchRes) 
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  Pl_Ins || 'Счет-Б')
.head 4 +  Data Field: NMSB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.683"
.head 7 -  Top:    1.405"
.head 7 -  Width:  5.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_SetFocus
.head 7 +  If NMSB = STRING_Null
.head 8 -  Set NMSB = Subs(NMS,1,38)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  Pl_Ins || 'Наименование-Б(получателя)')
.head 4 +  Data Field: OKPOB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.583"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  Pl_Ins || 'ОКПО-Б')
.head 4 +  Data Field: NAZN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    1.738"
.head 7 -  Width:  10.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Назначение платежа')
.head 4 -  !
.head 4 +  Pushbutton: pb_TT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    2.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать Шаблон экрана ввода (Наимен.оп)'
.head 6 +  On SAM_Click
.head 7 -  Call F_TT ()
.head 4 +  Pushbutton: pb_Formula2902
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\FORMULA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Использовать формулу для счета(вычисляется с помощью tobopack.gettoboparam)'
.head 6 +  On SAM_Click
.head 7 -  Set NLS='#(\'KP2902_'||Str(dND)||'\')'
.head 4 +  Data Field: TT_NAME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    2.071"
.head 7 -  Width:  7.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Шаблон экрана ввода (Наимен.оп)')
.head 4 +  Data Field: TT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    2.071"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Код Шаблона экрана ввода (Код оп.)')
.head 4 -  !
.head 4 +  Pushbutton: pb_QRD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    2.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\PRINT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать Шаблон оттиска (имя файла)'
.head 6 +  On SAM_Click
.head 7 -  Call F_QRD ()
.head 4 +  Data Field: QRD_NAME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.883"
.head 7 -  Top:    2.405"
.head 7 -  Width:  4.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Шаблон оттиска (Описание)')
.head 4 +  Data Field: QRD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    2.405"
.head 7 -  Width:  2.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Шаблон оттиска (Имя файла)')
.head 4 +  Data Field: VOB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.1"
.head 7 -  Top:    2.405"
.head 7 -  Width:  0.583"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Вид банковского документа')
.head 6 +  On SAM_Validate
.head 7 +  If VOB != NUMBER_Null
.head 8 +  If SqlPrepareAndExecute( hSql(),"SELECT name,UPPER(rep_prefix) || '_D.QRD' INTO :QRD_NAME,:QRD FROM vob") and not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set QRD = ''
.head 9 -  Set QRD_NAME = ''
.head 9 -  Return VALIDATE_Cancel
.head 7 -  Return VALIDATE_Ok
.head 4 -  !
.head 4 +  Pushbutton: pb_IDG
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    2.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CURRCONV.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: White
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать группу перекрытия'
.head 6 +  On SAM_Click
.head 7 -  Call F_IDG ()
.head 4 +  Data Field: IDG_NAME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.283"
.head 7 -  Top:    2.738"
.head 7 -  Width:  6.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: White
.head 6 -  Background Color: Dark Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Группа перекрытия')
.head 4 +  Data Field: IDG
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    2.738"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: White
.head 6 -  Background Color: Dark Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Код группы перекрытия')
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! !
.head 4 -  !
.head 4 +  Pushbutton: pb_6F
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    3.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTPERS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать Сч.дох.(6110) от ФЛ'
.head 6 +  On SAM_Click
.head 7 -  Call F_DOX (1)
.head 4 +  Data Field: NLS6F
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    3.071"
.head 7 -  Width:  3.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Сч.дох.(6110) от ФЛ')
.head 6 +  On SAM_Validate
.head 7 +  If NLS6F != STRING_Null 
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT acc,nms INTO :ACC6F,:NMS6F from accounts 
 where kv=:n980 and nls=:NLS6F and dazs is null and nbs='6510' ") 
 and not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set NMS6F = "! Ош.Счет"
.head 9 -  Set ACC6F = NUMBER_Null
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set NMS6F = STRING_Null
.head 8 -  Set ACC6F = NUMBER_Null
.head 4 +  Data Field: NMS6F
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.683"
.head 7 -  Top:    3.071"
.head 7 -  Width:  6.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Наименование сч.дох. от ФЛ')
.head 4 -  !
.head 4 +  Pushbutton: pb_3U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    3.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTCORP.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать Сч.НАЧ.дох.(3570) от ЮЛ)'
.head 6 +  On SAM_Click
.head 7 -  Call F_DOX (2)
.head 4 +  Data Field: NLS3U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    3.405"
.head 7 -  Width:  3.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Сч.НАЧ.дох.(3570) от ЮЛ')
.head 6 +  On SAM_Validate
.head 7 +  If NLS3U != STRING_Null 
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT acc,nms INTO :ACC3U,:NMS3U from accounts 
 where kv=:n980 and nls=:NLS3U and dazs is null and nbs='3570' ") 
 and not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set NMS3U = "! Ош.Счет"
.head 9 -  Set ACC3U = NUMBER_Null
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set NMS3U = STRING_Null
.head 8 -  Set ACC3U = NUMBER_Null
.head 4 +  Data Field: NMS3U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.683"
.head 7 -  Top:    3.405"
.head 7 -  Width:  6.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Наименование сч.НАЧ.дох. от ЮЛ')
.head 4 -  !
.head 4 +  Pushbutton: pb_6U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    3.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTCORP.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать Сч.дох.(6110) от ЮЛ'
.head 6 +  On SAM_Click
.head 7 -  Call F_DOX (3)
.head 4 +  Data Field: NLS6U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    3.738"
.head 7 -  Width:  3.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Сч.дох.(6110) от ЮЛ')
.head 6 +  On SAM_Validate
.head 7 +  If NLS6U != STRING_Null 
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT acc,SUBSTR(nms,1,38) INTO :ACC6U,:NMS6U from accounts 
 where kv=:n980 and nls=:NLS6U and dazs is null and nbs='6110' ") 
 and not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set NMS6U = "! Ош.Счет"
.head 9 -  Set ACC6U = NUMBER_Null
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call F_ShowHideUKom(TRUE)
.head 7 +  Else
.head 8 -  Set NMS6U = STRING_Null
.head 8 -  Set ACC6U = NUMBER_Null
.head 8 -  Call F_ShowHideUKom(FALSE)
.head 6 -  On SAM_SetFocus
.head 4 +  Data Field: NMS6U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.683"
.head 7 -  Top:    3.738"
.head 7 -  Width:  6.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam,  'Наименование сч.дох. от ЮЛ')
.head 4 -  !
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    4.655"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    4.655"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    4.655"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    4.655"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_GenPer
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    4.655"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сгенерировать состав схемы перекрытия для данного договора'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( 'Сгенерировать состав схемы перекрытия для данного договора ?' ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDYES
.head 8 -  Call F_GenPer()
.head 4 -  Line
.head 5 -  Resource Id: 4050
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.35"
.head 6 -  Top:    4.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    4.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.217"
.head 6 -  Top:    4.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.65"
.head 6 -  Top:    4.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 4051
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.317"
.head 6 -  Top:    4.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 4052
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.2"
.head 6 -  Begin Y:  0.655"
.head 6 -  End X:  0.2"
.head 6 -  End Y:  1.119"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Pushbutton: pb_Save
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Сохранить
.head 5 -  Window Location and Size
.head 6 -  Left:   11.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call F_SAVE( TRUE )
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Выйти
.head 5 -  Window Location and Size
.head 6 -  Left:   13.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Radio Button: rbUPer
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: %
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    4.286"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalShowWindow( dfUKom )
.head 4 +  Radio Button: rbUSum
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Фикс.
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    4.286"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalShowWindow( dfUKom )
.head 4 +  Radio Button: rbUSet
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Сетка
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    4.286"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set dfUKom = NUMBER_Null
.head 7 -  Call SalHideWindow( dfUKom )
.head 7 -  Call SalSendMsg(gridU,SAM_Click,0,0)
.head 4 +  Data Field: dfUKom
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.683"
.head 7 -  Top:    4.18"
.head 7 -  Width:  2.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Call DecPoint(hWndItem)
.head 4 +  Data Field: dfTableName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    5.012"
.head 7 -  Width:  8.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Group Box: Перечисление коммисии
.head 5 -  Resource Id: 46674
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    2.071"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Option Button: gridF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.483"
.head 6 -  Top:    3.071"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BROWSE.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Palette
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Показать тарифную сетку для физ. лица' )
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call F_InitTab(FALSE)
.head 4 +  Option Button: gridU
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.483"
.head 6 -  Top:    3.738"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BROWSE.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Palette
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Показать тарифную сетку для юр. лица' )
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call F_InitTab(FALSE)
.head 4 +  Option Button: gridP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.583"
.head 6 -  Top:    4.655"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CHILDS.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Показать состав схемы  перекрытия' )
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call F_SAVE( FALSE )
.head 7 -  Call F_InitTab(TRUE)
.head 4 +  Pushbutton: pb_Formula6F
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    3.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\FORMULA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Использовать формулу для счета(вычисляется с помощью tobopack.gettoboparam)'
.head 6 +  On SAM_Click
.head 7 -  Set NLS6F='#(\'KP6F_'||Str(dND)||'\')'
.head 4 +  Pushbutton: pb_Formula6U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    3.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\FORMULA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Использовать формулу для счета(вычисляется с помощью tobopack.gettoboparam)'
.head 6 +  On SAM_Click
.head 7 -  Set NLS6U='#(\'KP6U_'||Str(dND)||'\')'
.head 4 -  Group Box: Коммисия с юр. лица
.head 5 -  Resource Id: 4639
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    4.071"
.head 6 -  Width:  10.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbShow2902
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.267"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( dND ) 
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT tag INTO :sTmp FROM tobo_tags WHERE tag='KP2902_"||Str(dND)||"'") and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 +  If SalMessageBox( "Создать параметр KP2902_"||Str(dND)||" в справочнике tobo_tags?" ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDYES
.head 10 -  Call SqlPrepareAndExecute( hSql(), "insert into tobo_tags(tag,name) values ('KP2902_"||Str(dND)||"','Счет 2902 для ген. соглашения № "||Str(dND)||"')")
.head 10 -  Call SqlCommit(hSql())
.head 8 -  Call FunNSIEditFFiltered('tobo_params',0,"tobo_params.tag='KP2902_"||Str(dND)||"'")
.head 4 +  Pushbutton: pbShow6F
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.267"
.head 6 -  Top:    3.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( dND ) 
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT tag INTO :sTmp FROM tobo_tags WHERE tag='KP6F_"||Str(dND)||"'") and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 +  If SalMessageBox( "Создать параметр KP6F_"||Str(dND)||" в справочнике tobo_tags?" ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDYES
.head 10 -  Call SqlPrepareAndExecute( hSql(), "insert into tobo_tags(tag,name) values ('KP6F_"||Str(dND)||"','Сч.дох.(6110) от ФЛ для ген. соглашения № "||Str(dND)||"')")
.head 10 -  Call SqlCommit(hSql())
.head 8 -  Call FunNSIEditFFiltered('tobo_params',0,"tobo_params.tag='KP6F_"||Str(dND)||"'")
.head 4 +  Pushbutton: pbShow6U
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.267"
.head 6 -  Top:    3.726"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( dND ) 
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT tag INTO :sTmp FROM tobo_tags WHERE tag='KP6U_"||Str(dND)||"'") and not SqlFetchNext(hSql(), nFetchRes) 
.head 9 +  If SalMessageBox( "Создать параметр KP2902_"||Str(dND)||" в справочнике tobo_tags?" ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDYES
.head 10 -  Call SqlPrepareAndExecute( hSql(), "insert into tobo_tags(tag,name) values ('KP6U_"||Str(dND)||"','Сч.дох.(6110) от ЮЛ для ген. соглашения № "||Str(dND)||"')")
.head 10 -  Call SqlCommit(hSql())
.head 8 -  Call FunNSIEditFFiltered('tobo_params',0,"tobo_params.tag='KP6U_"||Str(dND)||"'")
.head 2 +  Contents
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ID
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма платежа >=
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма платежа < 
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PR_FL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % с ФЛ (плательщика)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PR_UL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % с ЮЛ (получателя)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVob
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
Док
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
оп.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMfoB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 9
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKvB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKoef
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Коеф.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPolu
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отримувач
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.529"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNazn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Призначення платежу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOkpoB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.171"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLevB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рівень
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ROWID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ID
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUM_FL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фик. сумма  с ФЛ (плательщика)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUM_UL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фик. сумма с ЮЛ (получателя)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_SK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("SK","NAME"," SK <40 ", sTmp, NMSK )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set SK =Val(sTmp)
.head 3 +  Function: DecPoint      ! Корректировка символа "десятичной точки"
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 -  Return TRUE
.head 3 +  Function: F_MFO
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("BANKS", "NB"," nvl(blk,0) <>4 ", sTmp, NB )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set MFOB=Val(sTmp)
.head 6 -  Call SalSendMsg( NLSB, SAM_KillFocus, 0, 0 ) 
.head 3 +  Function: F_TT
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("TTS", "NAME","" , sTmp, TT_NAME )
.head 5 +  If sTmp != STRING_Null
.head 6 -  Set TT=sTmp
.head 6 -  If SqlPrepareAndExecute( hSql(),"SELECT name INTO :TT_NAME FROM tts where TT=:TT ") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If SqlPrepareAndExecute( hSql(),"SELECT vob INTO :VOB FROM tts_vob where TT=:TT ") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalSendMsg( VOB, SAM_Validate, 0, 0 ) 
.head 3 +  Function: F_QRD
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: svob
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("vob", "","", svob, sTmp)
.head 5 +  If svob != STRING_Null
.head 6 -  Set VOB = Val(svob)
.head 6 -  If SqlPrepareAndExecute( hSql(),"SELECT name,UPPER(rep_prefix) || '_D.QRD' INTO :QRD_NAME,:QRD FROM vob where VOB=:VOB ") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Function: F_GRP
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call F_NAK()
.head 5 +  If GRP
.head 6 -  Call SalShowWindow( pb_IDG )
.head 6 -  Call SalShowWindow( IDG_NAME )
.head 6 -  Call SalShowWindow( IDG )
.head 6 -  Call SalShowWindow( NAK )
.head 6 -  Call SalShowWindow( pb_3U )
.head 6 -  Call SalShowWindow( NMS3U )
.head 6 -  Call SalShowWindow( NLS3U )
.head 6 -  Call SalShowWindow( pb_6U )
.head 6 -  ! Call SalShowWindow( pb_Formula6U )
.head 6 -  ! Call SalShowWindow( pbShow6U )
.head 6 -  Call SalShowWindow( NMS6U )
.head 6 -  Call SalShowWindow( NLS6U )
.head 6 +  If NLS6U != STRING_Null
.head 7 -  Call F_ShowHideUKom(TRUE)
.head 5 +  Else
.head 6 -  Call SalHideWindow( pb_IDG )
.head 6 -  Call SalHideWindow( IDG_NAME )
.head 6 -  Call SalHideWindow( IDG )
.head 6 -  Call SalHideWindow( NAK )
.head 6 -  Call SalHideWindow( pb_3U )
.head 6 -  Call SalHideWindow( NMS3U )
.head 6 -  Call SalHideWindow( NLS3U )
.head 6 -  Call SalHideWindow( pb_6U )
.head 6 -  Call SalHideWindow( NMS6U )
.head 6 -  Call SalHideWindow( NLS6U )
.head 6 -  ! Call SalHideWindow( pb_Formula6U )
.head 6 -  ! Call SalHideWindow( pbShow6U )
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,5, COL_GetID ))		
.head 6 -  Call SalHideWindow( pb_GenPer )
.head 6 -  Call F_ShowHideUKom(FALSE)
.head 3 +  Function: F_IDG
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("PEREKR_G","NAME"," IDG is not null ", sTmp, IDG_NAME )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set IDG =Val(sTmp)
.head 3 +  Function: F_DOX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: N
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sName
.head 5 -  String: sW
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Set sW = " ACCOUNTS.kv="||Str(n980)|| " and  ACCOUNTS.dazs is null and ACCOUNTS.nbs=" || 
IifS( N=2 ,"'3570'" , "'6510'" )
.head 5 -  Call FunNSIGetFiltered ("ACCOUNTS", "NLS", sW, sTmp, sName )
.head 5 +  If sTmp !=STRING_Null
.head 6 +  If N = 1
.head 7 -  Set ACC6F=Val(sTmp)
.head 7 -  Set NLS6F =sName
.head 7 -  Call SalSendMsg( NLS6F, SAM_Validate, 0, 0 )
.head 6 +  Else If N = 2
.head 7 -  Set ACC3U=Val(sTmp)
.head 7 -  Set NLS3U=sName
.head 7 -  Call SalSendMsg( NLS3U, SAM_Validate, 0, 0 )
.head 6 +  Else If N = 3
.head 7 -  Set ACC6U=Val(sTmp)
.head 7 -  Set NLS6U=SalStrLeftX(sName,38)
.head 7 -  Call SalSendMsg( NLS6U, SAM_Validate, 0, 0 )
.head 3 +  Function: F_SAVE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: flag
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql
.head 5 -  String: sSqlForDelKomis
.head 5 -  String: sErr
.head 4 +  Actions
.head 5 -  Set sErr = STRING_Null
.head 5 -  Set sSqlForDelKomis = STRING_Null
.head 5 +  If NLS = STRING_Null 
.head 6 -  Set sErr = sErr || '    <Счет 2902> ' || PutCrLf()
.head 5 +  If GRP and MFOB = NUMBER_Null 
.head 6 -  Set sErr = sErr || '    <МФО-Б> ' || PutCrLf()
.head 5 +  If GRP and NLSB = NUMBER_Null 
.head 6 -  Set sErr = sErr || '   <Счет-Б>' || PutCrLf()
.head 5 +  If GRP and OKPOB= NUMBER_Null 
.head 6 -  Set sErr = sErr || '   <ОКПО-Б> ' || PutCrLf()
.head 5 +  If GRP and NMSB = STRING_Null 
.head 6 -  Set sErr = sErr || '   <Наименов-Б>' || PutCrLf()
.head 5 +  If GRP and NAZN = STRING_Null 
.head 6 -  Set sErr = sErr || '   <Назначение платежа>' || PutCrLf()
.head 5 +  If TT   = STRING_Null 
.head 6 -  Set sErr = sErr || '   <Шаблон ввода>' || PutCrLf()
.head 5 +  If QRD  = STRING_Null  or VOB  = NUMBER_Null
.head 6 -  Set sErr = sErr || '   <Шаблон оттиска>' || PutCrLf()
.head 5 +  If (GRP and IDG=NUMBER_Null) 
.head 6 -  Set sErr = sErr || '   <Группа перекрытия>' || PutCrLf()
.head 5 +  ! If GRP and ACC6U = NUMBER_Null
.head 6 -  Set sErr = sErr || '   <Счет доходов ЮЛ>' || PutCrLf()
.head 5 +  If not GRP and ACC6F = NUMBER_Null
.head 6 -  Set sErr = sErr || '   <Счет доходов ФЛ>' || PutCrLf()
.head 5 +  If GRP and not NAK !!! Ген. согл. без накопления комиссии на 2902
.head 6 +  If ACC6F = NUMBER_Null and ACC6U = NUMBER_Null and ACC3U = NUMBER_Null
.head 7 -  Set sErr = sErr || 'один из счетов доходов должен быть заполнен' || PutCrLf()
.head 5 +  If GRP and NAK !!! Ген. согл. c накоплением комиссии на 2902
.head 6 +  If ACC6F = NUMBER_Null and ACC3U = NUMBER_Null and ACC6U = NUMBER_Null
.head 7 -  Set sErr = sErr || 'Один из счетов доходов должен быть заполнен' || PutCrLf()
.head 5 +  If ACC6U != NUMBER_Null and GRP
.head 6 +  If rbUPer
.head 7 -  Set sKomU_Flag = '0'
.head 6 +  Else If rbUSum
.head 7 -  Set sKomU_Flag = '1'
.head 6 +  Else If rbUSet
.head 7 -  Set sKomU_Flag = '2'
.head 6 +  If sKomU_Flag != '2' 
.head 7 +  If dfUKom = NUMBER_Null 
.head 8 -  Set sErr = sErr || 'Не задано значение комиссии с юр. лица' || PutCrLf()
.head 7 +  Else
.head 8 -  Set sSqlForDelKomis = 'Delete from kp_komis where nd=:ND and type=1'
.head 5 -  !
.head 5 +  If not NAK 
.head 6 -  If SqlPrepareAndExecute( hSql(),"Select sum(pr_fl)+sum(sum_fl) into :nTmp from kp_komis where nd=:ND and type=0") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If (nTmp != 0 and nTmp != NUMBER_Null) and ACC6F = NUMBER_Null
.head 7 -  Set sErr = sErr || '   <Счет доходов ФЛ>' || PutCrLf()
.head 6 +  If GRP
.head 7 -  If SqlPrepareAndExecute( hSql(),"Select sum(pr_ul)+sum(sum_ul) into :nTmp from kp_komis where nd=:ND and type=1") and SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If (nTmp != 0 or nTmp != NUMBER_Null) and ACC6U = NUMBER_Null
.head 8 -  Set sErr = sErr || '   <Счет доходов ЮЛ>' || PutCrLf()
.head 5 -  !
.head 5 +  If sErr ! = STRING_Null 
.head 6 -  Call SalMessageBox( sErr,"Не заданы все обязательные параметры !" , MB_IconStop)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If not GRP 
.head 6 -  Set NAK = FALSE
.head 5 -  Set sSql = "Update KP_deal 
 SET nls =:NLS, mfob =:MFOB,nlsb=:NLSB,okpob=:OKPOB,nmsb=:NMSB,grp=:GRP,nak=:NAK,sk=:SK,
     nazn =:NAZN, tt=:TT, vob=:VOB, 
     name=:NAME_D,sum=:SUM_D, 
     acc6f=:ACC6F, acc6u=:ACC6U, acc3u=:ACC3U, komu_flag=:sKomU_Flag, komu_val=:dfUKom "
.head 5 +  If dACC != NUMBER_Null
.head 6 -  Set sSql = sSql || ",acc=:dACC "
.head 5 -  Set sSql = sSql || " where nd=:ND"
.head 5 +  If SqlPrepareAndExecute( hSql(),sSql)
.head 6 +  If GRP
.head 7 -  Call SqlPrepareAndExecute( hSql(),"Update specparam set idg=:IDG, sps=1 where acc=:ACC")
.head 7 -  ! Call SqlPrepareAndExecute( hSql(),"Delete from perekr_b where ids=:nIds")
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute( hSql(),"Update specparam set idg=null where acc=:ACC")
.head 6 -  !
.head 6 -  Call SalSendMsg(ADM1,UM_Update, 0, 0)
.head 6 -  !
.head 6 +  If sSqlForDelKomis != STRING_Null
.head 7 -  Call SqlPrepareAndExecute( hSql(),sSqlForDelKomis)
.head 6 -  !
.head 6 -  Set sErr = "Обновление договора № "||Str(ND)
.head 6 -  Call SqlCommit(hSql())
.head 6 +  If flag
.head 7 -  Call MessageNoWait( sErr, "Сохранено в БД",2, 0 )
.head 3 +  Function: F_Alien
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 +  Static Variables
.head 5 -  String: sMfo
.head 5 -  String: sNls
.head 5 -  String: sSql
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sSql = STRING_Null
.head 5 -  Set sSql = " kv=" || Str(n980) || " " !and NLSALT is not null "
.head 5 +  If MFOB != NUMBER_Null
.head 6 -  Set sSql = sSql || " and  mfo=" || Str(MFOB)
.head 5 -  Set sSql = sSql || " order by nlsalt "
.head 5 -  Call FunNSIGetFilteredAltPK('ALIEN','MFO','NLS', sSql, sMfo, sNls)
.head 5 +  If sMfo !=  STRING_Null
.head 6 -  If SqlPrepareAndExecute( hSql(),
   "SELECT MFO, NLS, OKPO, NAME
    INTO :MFOB, :NLSB, :OKPOB, :NMSB FROM alien WHERE nls=:sNls") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If MFOB != NUMBER_Null
.head 7 -  Call SalSendMsg( MFOB, SAM_Validate, 0, 0 ) 
.head 3 +  Function: F_NAK
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NAK
.head 6 -  Call SalShowWindow( pb_GenPer )
.head 6 +  If NLS6U = STRING_Null
.head 7 -  Call F_ShowHideUKom( FALSE )
.head 5 +  Else
.head 6 -  Call SalHideWindow( pb_GenPer )
.head 6 +  If NLS6U != STRING_Null
.head 7 -  Call F_ShowHideUKom( TRUE )
.head 5 -  Call F_InitTab(NAK and GRP)
.head 3 +  Function: F_InitTab
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: flag
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If flag
.head 6 -  ! Update
.head 6 -  Set dfTableName = 'Содержимое таблицы: Состав схемы перекрытия'
.head 6 -  Set ADM1.strSqlUpdate =
"update perekr_b 
  SET ids=:nIds,vob=:ADM1.colVob, tt=:ADM1.colTT,mfob=:ADM1.colMfoB,koef=:ADM1.colKoef,nazn=:ADM1.colNazn,polu=:ADM1.colPolu,okpo=:ADM1.colOkpoB,nlsb=:ADM1.colNlsB
 where rowid=:ADM1.ROWID"
.head 6 -  ! Insert
.head 6 -  Set ADM1.strSqlInsert =
"Insert into perekr_b( ids,vob,tt,mfob,nlsb,kv,koef,polu,nazn,okpo, id) 
  values 
( :nIds,:ADM1.colVob,:ADM1.colTT,:ADM1.colMfoB,:ADM1.colNlsB,:ADM1.colKvB,:ADM1.colKoef,:ADM1.colPolu,:ADM1.colNazn,:ADM1.colOkpoB, 0 )"
.head 6 -  ! Delete
.head 6 -  Set ADM1.strSqlDelete = "Delete from perekr_b where rowid=:ADM1.ROWID"
.head 6 -  ! Populate
.head 6 -  Set ADM1.strSqlPopulate =
"SELECT vob,tt,mfob,nlsb,kv,koef,polu,nazn,okpo,idr,rowid
  INTO :ADM1.colVob,:ADM1.colTT,:ADM1.colMfoB,:ADM1.colNlsB,:ADM1.colKvB,:ADM1.colKoef,
       :ADM1.colPolu,:ADM1.colNazn,:ADM1.colOkpoB,:ADM1.colLevB,:ADM1.ROWID
  FROM perekr_b WHERE ids=:nIds" 
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,2, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,3, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,4, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,5, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,6, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,7, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,8, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,9, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,10, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,11, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,12, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,13, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,14, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,15, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,17, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,18, COL_GetID ))		
.head 6 -  Set bPerek = TRUE
.head 5 +  Else
.head 6 -  ! Set bt_Perek = FALSE
.head 6 +  If gridU
.head 7 -  Set nType = 1 
.head 7 -  Set dfTableName = 'Содержимое таблицы: Тарифная сетка для комиссии с юр. лица'
.head 6 +  Else If gridF
.head 7 -  Set nType = 0 
.head 7 -  Set dfTableName = 'Содержимое таблицы: Тарифная сетка для комиссии с физ. лица'
.head 6 -  ! Update
.head 6 -  Set ADM1.strSqlUpdate =
"update KP_komis 
 SET s1=:ADM1.S1, s2=:ADM1.S2, pr_fl=:ADM1.PR_FL,pr_ul=:ADM1.PR_UL,type=:nType,sum_fl=:ADM1.SUM_FL,sum_ul=:ADM1.SUM_UL
 where ID=:ADM1.ID "
.head 6 -  ! Insert
.head 6 -  Set ADM1.strSqlInsert =
"Insert into KP_komis( nd, s1, s2, pr_fl, pr_ul, type,sum_fl,sum_ul ) 
  values 
( :ADM1.ND, :ADM1.S1, :ADM1.S2, :ADM1.PR_FL, :ADM1.PR_UL, :nType, :ADM1.SUM_FL, :ADM1.SUM_UL )"
.head 6 -  ! Delete 
.head 6 -  Set ADM1.strSqlDelete = "Delete from KP_komis where ID=:ADM1.ID"
.head 6 -  ! Populate
.head 6 -  Set ADM1.strSqlPopulate =
"SELECT id, s1, s2, pr_fl, pr_ul, sum_fl, sum_ul
 INTO :ADM1.ID, :ADM1.S1, :ADM1.S2, :ADM1.PR_FL, :ADM1.PR_UL, :ADM1.SUM_FL, :ADM1.SUM_UL
 From KP_komis
 WHERE nd="||Str(ND)||" and type=:nType ORDER BY s1 " 
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,2, COL_GetID ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,3, COL_GetID ))		
.head 6 +  If nType =0
.head 7 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,4, COL_GetID ))		
.head 7 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,5, COL_GetID ))		
.head 7 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,17, COL_GetID ))		
.head 7 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,18, COL_GetID ))		
.head 6 +  Else
.head 7 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,4, COL_GetID ))		
.head 7 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,5, COL_GetID ))		
.head 7 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,17, COL_GetID ))		
.head 7 -  Call SalShowWindow(SalTblGetColumnWindow (ADM1,18, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,6, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,7, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,8, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,9, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,10, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,11, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,12, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,13, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,14, COL_GetID ))		
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (ADM1,15, COL_GetID ))		
.head 6 -  Set bPerek = FALSE
.head 5 -  Call SalSendMsg(hWndForm,UM_Populate, 0, 0)
.head 3 +  Function: F_GenPer
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: ps
.head 5 -  String: sMfo
.head 5 -  String: sOkpo
.head 5 -  Number: koef
.head 5 -  Number: koefD
.head 4 +  Actions
.head 5 -  Call F_SAVE( FALSE )
.head 5 -  Set sMfo = GetBankMfo()
.head 5 -  Set sOkpo = Str(GetBankOkpo())
.head 5 +  If MFOB = Val(sMfo)
.head 6 -  Set ps = 'PS1'
.head 5 +  Else
.head 6 -  Set ps = 'PS2'
.head 5 -  ! Генерим перекрытие
.head 5 -  ! Счет 3570
.head 5 +  If ACC3U != NUMBER_Null
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT * FROM perekr_b WHERE ids=:nIds and tt = 'TP3' ") and not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute( hSql(),"INSERT INTO perekr_b
(ids, tt, mfob, nlsb, polu,nazn, kv, okpo, koef, vob, id)
VALUES (:nIds, 'TP3', :MFOB, :NLSB, :NMSB,:NAZN, :n980, :OKPOB, 1, 6, 0)")
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute( hSql(),"UPDATE perekr_b SET
mfob=:MFOB, nlsb=:NLSB, polu=:NMSB,okpo=:OKPOB
WHERE ids=:nIds and tt = 'TP3'")
.head 6 -  ! NLS_KOM
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT * FROM nls_kom WHERE nls=:NLS and kv = :n980 ") and not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute( hSql(), "INSERT into nls_kom(NLS,KV,NLSK,KVK) VALUES(:NLS,:n980,:NLS3U,:n980) ") 
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute( hSql(), "UPDATE nls_kom SET NLSK=:NLS3U,KVK=:n980 where nls=:NLS and kv=:n980") 
.head 5 +  Else
.head 6 -  ! 2600
.head 6 +  If rbUPer
.head 7 +  If dfUKom != NUMBER_Null
.head 8 -  Set koef = dfUKom * 0.01
.head 7 +  Else
.head 8 -  Set koef = 0
.head 6 +  Else
.head 7 -  Set koef = 0
.head 6 -  Set koefD = 1 - koef
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT * FROM perekr_b WHERE ids=:nIds and nlsb like '2600%' ") and not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute( hSql(),"INSERT INTO perekr_b
(ids, tt, mfob, nlsb, polu,nazn, kv, okpo, koef, vob, id)
VALUES (:nIds, :ps, :MFOB, :NLSB, :NMSB,:NAZN, :n980, :OKPOB, :koefD, 6, 0)")
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute( hSql(),"UPDATE perekr_b SET
mfob=:MFOB, nlsb=:NLSB, polu=:NMSB,okpo=:OKPOB
WHERE ids=:nIds and nlsb like '2600%' ")
.head 6 -  ! 6110
.head 6 +  If ACC6U != NUMBER_Null
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT * FROM perekr_b WHERE ids=:nIds and nlsb like '6510%' ") and not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SqlPrepareAndExecute( hSql(),"INSERT INTO perekr_b
(ids, tt, mfob, nlsb, polu,nazn, kv, okpo, koef, vob, id)
VALUES (:nIds, 'PS1', :sMfo, :NLS6U, :NMS6U,:NAZN, :n980, :sOkpo, :koef, 6, 0)")
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute( hSql(),"UPDATE perekr_b SET
nlsb=:NLS6U, polu=:NMS6U
WHERE ids=:nIds and nlsb like '6510%'")
.head 5 -  Call SalSendClassMessage(UM_Update, 0, 0)
.head 3 +  Function: F_FillFromPerek
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NLSB != NUMBER_Null and MFOB != NUMBER_Null and SqlPrepareAndExecute( hSql(),
"SELECT mfob,nlsb,polu,okpo
  INTO :MFOB,:NLSB,:NMSB,:OKPOB
  FROM perekr_b WHERE ids=:nIds AND nlsb like '2600%'") and SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Call SalSendMsg( MFOB, SAM_Validate, 0, 0 )
.head 5 +  If NLS6U != STRING_Null and SqlPrepareAndExecute( hSql(),
"SELECT nlsb,polu
  INTO :NLS6U,:NMS6U
  FROM perekr_b WHERE ids=:nIds AND nlsb like '6510%'") and SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Call SqlPrepareAndExecute( hSql(), "SELECT acc into :ACC6U from accounts where nls = :NLS6U")
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT nlsb,polu
  INTO :NLS3U,:NMS3U
  FROM perekr_b WHERE ids=:nIds AND nlsb like '3570%'") and SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Call SqlPrepareAndExecute( hSql(), "SELECT acc into :ACC3U from accounts where nls = :NLS3U")
.head 3 +  Function: F_ShowHideUKom
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: show
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If show
.head 6 -  Call SalShowWindow(rbUPer) 
.head 6 -  Call SalShowWindow(rbUSum) 
.head 6 -  Call SalShowWindow(rbUSet) 
.head 6 -  Call SalShowWindow(dfUKom) 
.head 6 -  Call SalShowWindow( gridP )
.head 6 -  Call SalShowWindow(gridU) 
.head 6 +  If sKomU_Flag != STRING_Null
.head 7 +  If sKomU_Flag = '0'
.head 8 -  Set rbUPer = TRUE
.head 8 -  Call SalSendMsg(rbUPer, SAM_Click, 0, 0)
.head 7 +  Else If sKomU_Flag = '1'
.head 8 -  Set rbUSum = TRUE
.head 8 -  Call SalSendMsg(rbUSum, SAM_Click, 0, 0)
.head 7 +  Else If sKomU_Flag = '2'
.head 8 -  Set rbUSet = TRUE
.head 8 -  Call SalSendMsg(rbUSet, SAM_Click, 0, 0)
.head 5 +  Else
.head 6 -  Call SalHideWindow(rbUPer) 
.head 6 -  Call SalHideWindow(rbUSum) 
.head 6 -  Call SalHideWindow(rbUSet) 
.head 6 -  Call SalHideWindow(dfUKom) 
.head 6 -  Call SalHideWindow( gridP )
.head 6 -  Call SalHideWindow(gridU) 
.head 2 +  Window Parameters
.head 3 -  Number: ND
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  Number: ACC
.head 3 -  Number: ACC6F
.head 3 -  Number: ACC6U
.head 3 -  Number: ACC3U
.head 3 -  Number: nIds
.head 3 -  Number: nRow
.head 3 -  Number: nType
.head 3 -  Number: nTmp
.head 3 -  String: sKomU_Flag
.head 3 -  String: Pl_Ins
.head 3 -  String: sTmp
.head 3 -  Boolean: bInit
.head 3 -  Boolean: bPerek
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sDecimal=SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 +  If sDecimal='.'
.head 5 -  Set sDecimal2=','
.head 4 +  Else
.head 5 -  Set sDecimal2='.'
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set bInit = FALSE
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set dND = ND
.head 4 -  Set Pl_Ins = 'Пл. инструкция: '
.head 4 +  If SqlPrepareAndExecute( hSql(),
"SELECT K.acc, nvl(k.nls,a.nls), a.nms, k.mfob, k.nlsb, k.okpob, k.nmsb,k.nak,k.grp,
        k.sk, s.name, k.tt, t.name, k.vob,decode(k.vob,null,null,UPPER(v.rep_prefix) || '_D.QRD'), v.name, b.nb, k.nazn,
        k.acc6f, k.acc6u, k.acc3u, k.komu_flag, k.komu_val,k.name,k.sum
 INTO :ACC,:NLS, :NMS,:MFOB, :NLSB, :OKPOB, :NMSB, :NAK,:GRP,
      :SK, :NMSK,:TT, :TT_NAME,:VOB,:QRD,:QRD_NAME,:NB, :NAZN, 
      :ACC6F,:ACC6U,:ACC3U,:sKomU_Flag,:dfUKom,:NAME_D,:SUM_D 
 From KP_DEAL k, accounts a, banks b, sk s, tts t, vob v
 WHERE k.tt =t.tt (+) and k.sk=s.sk(+) 
   and k.mfob=b.mfo(+) and k.vob=v.vob(+)
   and K.acc=a.acc(+) and a.dazs is null and k.nd=:ND " )
and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If GRP and ACC > 0 
.head 6 -  If SqlPrepareAndExecute( hSql(),
"SELECT s.idg, g.name INTO :IDG, :IDG_NAME 
 From perekr_g g,specparam s Where g.idg=s.idg and s.acc=:ACC")
and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If ACC6F != NUMBER_Null
.head 6 -  If SqlPrepareAndExecute( hSql(),
"SELECT nls,nms INTO :NLS6F,:NMS6F from accounts where acc=:ACC6F") 
 and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If ACC6U !=NUMBER_Null
.head 6 -  If SqlPrepareAndExecute( hSql(),
"SELECT nls,SUBSTR(nms,1 ,38) INTO :NLS6U,:NMS6U from accounts where acc=:ACC6U") 
 and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If ACC3U !=NUMBER_Null
.head 6 -  If SqlPrepareAndExecute( hSql(),
"SELECT nls,nms INTO :NLS3U,:NMS3U from accounts where acc=:ACC3U") 
 and SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Set nIds = Val(NLS)
.head 4 -  !
.head 4 +  If ACC6U != NUMBER_Null and GRP
.head 5 -  Call F_ShowHideUKom(TRUE)
.head 4 +  Else
.head 5 -  Call F_ShowHideUKom(FALSE)
.head 4 -  !
.head 4 +  ! If NAK and GRP
.head 5 -  Set d
.head 4 -  Call F_InitTab(NAK and GRP)
.head 4 -  Call F_GRP()
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalSetFocus( GRP )
.head 4 -  Set gridF = TRUE
.head 3 +  On UM_Populate
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
.head 3 +  On UM_Update
.head 4 +  If bPerek
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set nTmp = 0
.head 5 +  While SalTblFindNextRow ( hWndForm, nRow, 0, ROW_MarkDeleted )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 -  Set nTmp=nTmp+colKoef
.head 5 +  If nTmp = 1 or nTmp=0
.head 6 -  Call SqlCommit(hSql())
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalMessageBox( 'Сумма коеф. не равна 1 ', 'Внимание', MB_IconExclamation )
.head 4 +  Else
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set nTmp = 0
.head 5 +  While SalTblFindNextRow ( hWndForm, nRow, 0, ROW_MarkDeleted )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 +  If nType = 0
.head 7 +  If (PR_FL != NUMBER_Null and PR_FL !=0) and (SUM_FL != NUMBER_Null and SUM_FL !=0)
.head 8 -  Set nTmp = 1
.head 8 -  Break
.head 6 +  Else If nType = 1
.head 7 +  If (PR_UL != NUMBER_Null and PR_UL != 0) and (SUM_UL != NUMBER_Null and SUM_UL != 0)
.head 8 -  Set nTmp = 1
.head 8 -  Break
.head 5 +  If nTmp = 0
.head 6 -  Call SqlCommit(hSql())
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalMessageBox( 'В тарифной сетке должно быть указано одно значение (либо процент, либо сумма) для каждой строки', 'Внимание', MB_IconExclamation )
.head 4 -  Call SalSendClassMessage(UM_Update, 0, 0)
.head 4 -  Call SalTblDefineSplitWindow ( ADM1, 0, TBL_Split_Adjustable )
.head 3 +  ! On SAM_CreateComplete
.head 4 -  Call SalSendMsg(gridF,SAM_Click,0,0)
.head 1 +  Table Window: ADM
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Договора по ком.платежам
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.344"
.head 4 -  Width:  16.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.417"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Top
.head 4 -  Visible? Class Default
.head 4 -  Size: 3.167"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSetColumnFlags ( NLS, COL_Editable, TRUE )
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSetColumnFlags ( NLS, COL_Editable, FALSE )
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 45602
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.75"
.head 6 -  Begin Y:  2.738"
.head 6 -  End X:  5.75"
.head 6 -  End Y:  3.202"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.583"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.083"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F10. Детали договора'
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45603
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.083"
.head 6 -  Begin Y:  2.738"
.head 6 -  End X:  5.083"
.head 6 -  End Y:  3.202"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.583"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45604
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 -  !
.head 4 +  Child Table: tbN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.883"
.head 7 -  Top:    0.071"
.head 7 -  Width:  6.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 2.417"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Maize
.head 6 -  View: Table
.head 6 -  Allow Row Sizing? No
.head 6 -  Lines Per Row: Default
.head 5 -  Memory Settings
.head 6 -  Maximum Rows in Memory: Default
.head 6 -  Discardable? Yes
.head 5 +  Contents
.head 6 +  Column: TOBO
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Код площадки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  1.733"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: NAME
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Наименование площадки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  3.75"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 5 -  Functions
.head 5 -  Window Variables
.head 5 +  Message Actions
.head 6 +  On SAM_DoubleClick
.head 7 -  Call SalSendMsg( pbY, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Arr2tol.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Не использовать на площадке'
.head 6 +  On SAM_Click
.head 7 -  Call F_TOBO (0)
.head 4 +  Pushbutton: pbY
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Использовать на площадке'
.head 6 +  On SAM_Click
.head 7 -  Call F_TOBO (1)
.head 4 +  Child Table: tbY
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.683"
.head 7 -  Top:    0.071"
.head 7 -  Width:  6.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 2.417"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  View: Table
.head 6 -  Allow Row Sizing? No
.head 6 -  Lines Per Row: Default
.head 5 -  Memory Settings
.head 6 -  Maximum Rows in Memory: Default
.head 6 -  Discardable? Yes
.head 5 +  Contents
.head 6 +  Column: TOBO
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Код площадки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  1.333"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 +  Message Actions
.head 8 +  On SAM_DoubleClick
.head 9 -  Call SalSendMsg( pbN, SAM_Click, 0, 0 )
.head 6 +  Column: NAME
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Наименование площадки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  3.3"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 +  Message Actions
.head 8 +  On SAM_DoubleClick
.head 9 -  Call SalSendMsg( pbN, SAM_Click, 0, 0 )
.head 6 +  Column: POS
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Позиция
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  0.85"
.head 7 -  Width Editable? Yes
.head 7 -  Format: #0
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 +  Message Actions
.head 8 +  On SAM_Validate
.head 9 -  Call SqlPrepareAndExecute( hSql(),"update kp_tobo set pos=:tbY.POS where nd=:ND and tobo=:tbY.TOBO")
.head 8 +  On SAM_SetFocus
.head 9 +  If tbY.POS = 0
.head 10 -  If SqlPrepareAndExecute( hSql(),
   "select max(pos)+1 into :POS from kp_tobo where tobo=:tbY.TOBO") and SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalSendMsg( POS, SAM_Validate, 0, 0 )
.head 5 -  Functions
.head 5 -  Window Variables
.head 5 -  Message Actions
.head 4 -  !
.head 4 -  !
.head 4 +  Child Table: lgN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.883"
.head 7 -  Top:    0.06"
.head 7 -  Width:  6.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 2.417"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Maize
.head 6 -  View: Table
.head 6 -  Allow Row Sizing? No
.head 6 -  Lines Per Row: Default
.head 5 -  Memory Settings
.head 6 -  Maximum Rows in Memory: Default
.head 6 -  Discardable? Yes
.head 5 +  Contents
.head 6 +  Column: LOG
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Код пачки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  1.733"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: NAME
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Наименование  пачки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  3.767"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 5 -  Functions
.head 5 -  Window Variables
.head 5 +  Message Actions
.head 6 +  On SAM_DoubleClick
.head 7 -  Call SalSendMsg( pgY, SAM_Click, 0, 0 )
.head 4 +  Child Table: lgY
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.683"
.head 7 -  Top:    0.083"
.head 7 -  Width:  6.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 2.417"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  View: Table
.head 6 -  Allow Row Sizing? No
.head 6 -  Lines Per Row: Default
.head 5 -  Memory Settings
.head 6 -  Maximum Rows in Memory: Default
.head 6 -  Discardable? Yes
.head 5 +  Contents
.head 6 +  Column: LOG
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Код пачки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  1.733"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: NAME
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Наименование пачки
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  3.767"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 5 -  Functions
.head 5 -  Window Variables
.head 5 +  Message Actions
.head 6 +  On SAM_DoubleClick
.head 7 -  Call SalSendMsg( pgN, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pgN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Arr2tol.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Не использовать в лог группе'
.head 6 +  On SAM_Click
.head 7 -  Call F_LOG (0)
.head 4 +  Pushbutton: pgY
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Использовать в лог группе'
.head 6 +  On SAM_Click
.head 7 -  Call F_LOG (1)
.head 4 -  !
.head 4 +  Data Field: dDETALI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.683"
.head 7 -  Top:    2.821"
.head 7 -  Width:  7.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_Help
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    0.988"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\LOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: White
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not rb_TOBO
.head 8 -  Call FunNSIEdit('KP_LOG')
.head 7 +  Else
.head 8 +  If not IsWindow(hWin3)
.head 9 -  Set hWin3 = SalCreateWindow( ADM3, hWndMDI, rb_TOBO,0 )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( hWin3 )
.head 6 +  On SAM_Create
.head 7 +  If rb_TOBO
.head 8 -  Set strTip = 'Справочник по безбалансовым отделениям'
.head 7 +  Else
.head 8 -  Set strTip = 'Справочник по пачкам'
.head 4 +  Data Field: lbNotUse
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.883"
.head 7 -  Top:    2.512"
.head 7 -  Width:  6.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: White
.head 6 -  Background Color: Dark Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: lbUse
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.7"
.head 7 -  Top:    2.512"
.head 7 -  Width:  6.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: White
.head 6 -  Background Color: Dark Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Radio Button: rb_TOBO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Отделения
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    1.762"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call F_RB()
.head 4 +  Radio Button: rb_LOG
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Пачки
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    2.095"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call F_RB()
.head 4 +  Pushbutton: pbCopy
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продублировать текущее ген. соглашение'
.head 6 +  On SAM_Click
.head 7 -  Call DublicateRow()
.head 4 +  Option Button: cbHideTobo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    2.821"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BROWSE.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Спрятать детали' )
.head 6 +  On SAM_Click
.head 7 -  Call F_Position(cbHideTobo)
.head 4 +  Combo Box: cmbTobo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.667"
.head 6 -  Top:    2.86"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.881"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? No
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: 100
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbTobo.Init(hWndItem)
.head 7 -  Call cmbTobo.Populate(hSql(), "tobo", "name", "tobo","" )
.head 7 -  Call cmbTobo.Add('-1', 'Выбор отделения')
.head 7 -  Call cmbTobo.SetSelectById('-1')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\LOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If cmbTobo.strCurrentId != '-1'
.head 8 -  Call FunNSIEditFFiltered('kp_tobo',0,"tobo='"||cmbTobo.strCurrentId||"'")
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Установка нумерации для договоров даного отделения'
.head 4 +  Pushbutton: pbNsl2902
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    2.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DETAILS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditFFiltered('tobo_params',0,"tobo_params.tag='NLS2902'")
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Справочник счетов 2902 для одиночных платежей'
.head 2 +  Contents
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
 договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
29*
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalTblQueryRowFlags(hWndForm, TBL_MinSplitRow,ROW_New)
.head 7 -  Set dDETALI = 'Двойной клик для вызова справочника счетов'
.head 5 +  On SAM_Validate
.head 6 +  If ACC >0
.head 7 -  ! Set NLS=sNLS
.head 6 +  Else
.head 7 +  If NLS != STRING_Null
.head 8 +  If ACC =NUMBER_Null
.head 9 +  If SqlPrepareAndExecute( hSql(),
"SELECT acc, nms INTO :ACC,:NMS FROM accounts WHERE kv=:n980 and nls=:NLS  ")
and not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set NMS = "Счет не открыт!"
.head 10 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set NMS = STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalSendMsg( NLS, SAM_Validate, 0, 0 ) 
.head 5 +  On SAM_DoubleClick
.head 6 +  If SalTblQueryRowFlags(hWndForm, TBL_MinSplitRow, ROW_New)
.head 7 +  If FunNSIGetFilteredAltPK('accounts', 'nls','nms',"nls like '2902%' and dazs is null", sRet1, sRet2)
.head 8 -  Set NLS = sRet1
.head 8 -  Set NMS = sRet2
.head 8 -  Set NAME = sRet2
.head 8 -  Call SalSendMsg( NLS,SAM_KillFocus, 0, 0 ) 
.head 3 +  Column: NMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование 
сч 29*
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: GRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Груп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: СКП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_KillFocus
.head 6 -                                                                                           Call SalSendMsg( SK, SAM_Validate, 0, 0 ) 
.head 5 +  ! On SAM_Validate
.head 6 +                                                                                           If SK != NUMBER_Null  
.head 7 +                                                                                           If SqlPrepareAndExecute( hSql(),
"SELECT name into :NMSK from sk where sk=:SK and sk<40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Call SalMessageBox("Ош.МФО-Б "|| MFOB , "В Н И М А Н И Е ! ", MB_IconStop)
.head 8 -                                                                                           Set NMSK = "! Ош.СКП "
.head 8 -                                                                                           Return VALIDATE_Cancel
.head 6 +                                                                                           Else 
.head 7 -                                                                                           Set NMSK = STRING_Null
.head 6 -                                                                                           Return VALIDATE_Ok
.head 3 +  Column: SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call DecPoint(hWndItem)
.head 3 +  Column: MFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО Б

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_SetFocus
.head 6 +                                                                                           If MFOB = STRING_Null
.head 7 -                                                                                           Set MFOB = GetBankMfo()
.head 7 -                                                                                           Set NB= GetBankName()
.head 5 +  ! On SAM_Validate
.head 6 +                                                                                           If MFOB != STRING_Null  
.head 7 +                                                                                           If SqlPrepareAndExecute( hSql(),
"SELECT nb into :NB from banks where mfo=:MFOB")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Call SalMessageBox("Ош.МФО-Б "|| MFOB , "В Н И М А Н И Е ! ", MB_IconStop)
.head 8 -                                                                                           Set NB = "! Ош.МФО-Б"
.head 8 -                                                                                           Return VALIDATE_Cancel
.head 7 +                                                                                           If NLSB !=STRING_Null
.head 8 -                                                                                           Set NLSB = KeyAccount( MFOB, NLSB )
.head 6 +                                                                                           Else 
.head 7 -                                                                                           Set NB = STRING_Null
.head 6 -                                                                                           Return VALIDATE_Ok
.head 5 +  ! On SAM_KillFocus
.head 6 -                                                                                           Call SalSendMsg( MFOB, SAM_Validate, 0, 0 ) 
.head 3 +  Column: NB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименов.
банка Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет Б

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_KillFocus
.head 6 +                                                                                           If MFOB != STRING_Null and NLSB !=STRING_Null
.head 7 -                                                                                           Set NLSB = KeyAccount( MFOB, NLSB )
.head 3 +  Column: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименов.
счета Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If NMSB = STRING_Null
.head 7 -  Set NMSB = NMS
.head 2 +  Functions
.head 3 +  Function: F_TOBO
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: N
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql
.head 5 -  String: sTOBOy
.head 5 -  String: sTOBOn
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  If N = 1
.head 6 -  Set sTOBOn = tbN.TOBO 
.head 5 +  Else If N = 0
.head 6 -  Set sTOBOy = tbY.TOBO 
.head 5 +  While SalTblFindNextRow( ADM, nRow, ROW_Selected, ROW_MarkDeleted )
.head 6 -  Call SalTblSetContext( ADM, nRow ) 
.head 6 +  If N = 1 and sTOBOn != STRING_Null and ADM.ND != NUMBER_Null
.head 7 -  Set sSql = "Insert into kp_tobo (nd,tobo,pos) (select :ADM.ND,:sTOBOn,nvl(max(pos),0)+1 from kp_tobo where tobo=:sTOBOn)"
.head 6 +  Else If N = 0 and sTOBOy != STRING_Null and ADM.ND != NUMBER_Null 
.head 7 -  Set sSql = "Delete from kp_tobo where nd=:ADM.ND and tobo=:sTOBOy"
.head 6 +  If SqlPrepareAndExecute( hSql(),sSql) 
.head 7 -  Call SqlCommitEx( hSql(), IifS ( N=1, "Добавление договора №", "Удаление договора №" )||Str(ADM.ND)||IifS ( N=1, " к ", " из " ) ||" безб. отд. "|| IifS ( N=1, sTOBOn , sTOBOy ) )
.head 7 -  Call F_RB()
.head 3 +  Function: DecPoint      ! Корректировка символа "десятичной точки"
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 -  Return TRUE
.head 3 +  Function: DublicateRow
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ND >0
.head 6 +  If SqlPrepareAndExecute( hSql(),"INSERT INTO kp_deal
(ACC, MFOB, NLSB, OKPOB, NMSB,NAK, SK, NAZN, TT, KODZ1,KODZ2,KODZ3,ACC6F,ACC6U,ACC3U,VOB,GRP,KOMU_VAL,KOMU_FLAG,NAME,SUM) 
(select ACC, MFOB, NLSB, OKPOB, NMSB,NAK, SK, NAZN, TT, KODZ1,KODZ2,KODZ3,ACC6F,ACC6U,ACC3U,VOB,GRP,KOMU_VAL,KOMU_FLAG,NAME,SUM from kp_deal where nd=:ND)")
.head 7 -  Call SalSendMsg(ADM, UM_Populate, 0, 0)
.head 3 +  Function: F_Position
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: flag
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: h
.head 5 -  Number: y
.head 4 +  Actions
.head 5 -  Set hWndToolBar = SalGetFirstChild( hWndForm, TYPE_FormToolBar)
.head 5 -  Set h = 2.81
.head 5 -  Set y = 2.75 
.head 5 +  If flag 
.head 6 -  Set h = h * (-1) 
.head 6 -  Set y = y * (-1) 
.head 6 -  Call SalHideWindow( lbNotUse ) 
.head 6 -  Call SalHideWindow( lbUse ) 
.head 6 -  Call SalHideWindow( tbN ) 
.head 6 -  Call SalHideWindow( tbY ) 
.head 6 -  Call SalHideWindow( lgN ) 
.head 6 -  Call SalHideWindow( lgY ) 
.head 6 -  Call SalHideWindow( pbY ) 
.head 6 -  Call SalHideWindow( pbN ) 
.head 6 -  Call SalHideWindow( pgN ) 
.head 6 -  Call SalHideWindow( pgY ) 
.head 6 -  Call SalHideWindow( pb_Help ) 
.head 5 +  Else
.head 6 -  Call F_RB()
.head 6 -  Call SalShowWindow( pb_Help ) 
.head 5 -  Call SalGetWindowSize ( hWndToolBar, nWidth, nHeight )				
.head 5 -  Call SalSetWindowSize ( hWndToolBar, nWidth, nHeight + h )
.head 5 -  Call SalGetWindowLoc ( pbIns, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbIns, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbDel, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbDel, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbRefresh, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbRefresh, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbUpdate, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbUpdate, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbSearch, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbSearch, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbFilter, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbFilter, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbCopy, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbCopy, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbDetails, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbDetails, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbPrint, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbPrint, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( pbExit, nX, nY )
.head 5 -  Call SalSetWindowLoc ( pbExit, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( dDETALI, nX, nY )
.head 5 -  Call SalSetWindowLoc ( dDETALI, nX, nY + h )
.head 5 -  Call SalGetWindowLoc ( cbHideTobo, nX, nY )
.head 5 -  Call SalSetWindowLoc ( cbHideTobo, nX, nY + h)
.head 5 -  !
.head 3 +  Function: F_RB
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ND >0
.head 6 -  Set dDETALI= Str(ND) ||' '|| NMS
.head 6 -  Call SalShowWindow( rb_LOG )
.head 6 +  If rb_TOBO
.head 7 -  Call SalHideWindow( lgN )
.head 7 -  Call SalHideWindow( lgY )
.head 7 -  Call SalHideWindow( pgN )
.head 7 -  Call SalHideWindow( pgY )
.head 7 -  Call SalTblPopulate(ADM.tbN, hSql(),
 "SELECT tobo, name into :tbN.TOBO, :tbN.NAME
  from tobo where tobo not in (select tobo from kp_tobo where nd=:ND)", TBL_FillAll )
.head 7 -  Call SalTblPopulate(ADM.tbY, hSql(),
 "SELECT t.tobo, t.name,k.pos into :tbY.TOBO, :tbY.NAME, :tbY.POS
  from tobo t,kp_tobo k where k.tobo=t.tobo and k.nd=:ND", TBL_FillAll )
.head 7 -  Call SalShowWindow( tbN )
.head 7 -  Call SalShowWindow( tbY )
.head 7 -  Call SalShowWindow( pbN )
.head 7 -  Call SalShowWindow( pbY )
.head 6 +  Else If rb_LOG
.head 7 -  Call SalShowWindow( lgN )
.head 7 -  Call SalShowWindow( lgY )
.head 7 -  Call SalShowWindow( pgN )
.head 7 -  Call SalShowWindow( pgY )
.head 7 -  Call SalTblPopulate(ADM.lgN, hSql(),
 "SELECT log, name into :lgN.LOG, :lgN.NAME
  from kp_log where log not in (select log from kp_log_nd where nd=:ND)", TBL_FillAll )
.head 7 -  Call SalTblPopulate(ADM.lgY, hSql(),
 "SELECT log, name into :lgY.LOG, :lgY.NAME
  from kp_log where log in (select log from kp_log_nd where nd=:ND)", TBL_FillAll )
.head 7 -  Call SalHideWindow( tbN )
.head 7 -  Call SalHideWindow( tbY )
.head 7 -  Call SalHideWindow( pbN )
.head 7 -  Call SalHideWindow( pbY )
.head 5 +  Else
.head 6 -  Set dDETALI= NAME
.head 6 -  Call SalHideWindow( rb_LOG )
.head 6 -  Set rb_TOBO = TRUE
.head 6 +  If rb_TOBO
.head 7 -  Call SalHideWindow( lgN )
.head 7 -  Call SalHideWindow( lgY )
.head 7 -  Call SalHideWindow( pgN )
.head 7 -  Call SalHideWindow( pgY )
.head 7 -  Call SalTblPopulate(ADM.tbN, hSql(),
 "SELECT tobo, name into :tbN.TOBO, :tbN.NAME
  from tobo where tobo not in (select tobo from kp_tobo where nd=:ND)", TBL_FillAll )
.head 7 -  Call SalTblPopulate(ADM.tbY, hSql(),
 "SELECT t.tobo, t.name,k.pos into :tbY.TOBO, :tbY.NAME, :tbY.POS
  from tobo t,kp_tobo k where k.tobo=t.tobo and k.nd=:ND", TBL_FillAll )
.head 7 -  Call SalShowWindow( tbN )
.head 7 -  Call SalShowWindow( tbY )
.head 7 -  Call SalShowWindow( pbN )
.head 7 -  Call SalShowWindow( pbY )
.head 5 -  Call SalSendMsg( pb_Help, SAM_Create, 0, 0 )
.head 3 +  Function: F_LOG
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: N
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql
.head 5 -  Number: nLOGy
.head 5 -  Number: nLOGn
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  If N = 1
.head 6 -  Set nLOGn = lgN.LOG 
.head 5 +  Else If N = 0
.head 6 -  Set nLOGy = lgY.LOG 
.head 5 +  While SalTblFindNextRow( ADM, nRow, ROW_Selected, ROW_MarkDeleted )
.head 6 -  Call SalTblSetContext( ADM, nRow ) 
.head 6 +  If N = 1 and nLOGn != NUMBER_Null and ADM.ND != NUMBER_Null
.head 7 +  If ADM.MFOB = STRING_Null or ADM.NLSB = STRING_Null or ADM.NMSB = STRING_Null or ADM.OKPOB = STRING_Null
.head 8 -  Call SalMessageBox( 'Невозможно добавить в пачку договор с незаполнеными основными реквизитами!', 'Внимание', MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 -  Set sSql = "Insert into kp_log_nd (nd,log) values(:ADM.ND,:nLOGn)"
.head 6 +  Else If N =0 and nLOGy != NUMBER_Null and ND != NUMBER_Null
.head 7 -  Set sSql = "Delete from kp_log_nd where nd=:ADM.ND and log=:nLOGy"
.head 6 +  If SqlPrepareAndExecute( hSql(),sSql)
.head 7 -  Call SqlCommitEx( hSql(), IifS ( N=1, "Добавление договора №", "Удаление договора №" )||Str(ADM.ND)||IifS ( N=1, " к ", " из " ) ||" пачке "|| IifS ( N=1, Str(nLOGn), Str(nLOGy)) )
.head 7 -  Call F_RB()
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  Number: nWidth
.head 3 -  Number: nHeight
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nRow
.head 3 -  String: sTmp
.head 3 -  String: sNLS
.head 3 -  Window Handle: hWndToolBar
.head 3 -  Boolean: bEdit
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call CheckTrialVersion()
.head 4 -  Set sDecimal=SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 +  If sDecimal='.'
.head 5 -  Set sDecimal2=','
.head 4 +  Else
.head 5 -  Set sDecimal2='.'
.head 4 -  !
.head 4 -  Set lbNotUse = 'Не используется в'
.head 4 -  Set bEdit = FALSE
.head 4 -  Set lbUse = 'Используется в'
.head 4 -  Set ADM.strFilterTblName = 'KP_DEAL'
.head 4 -  Set ADM.strSqlUpdate =
"update KP_deal SET acc=:ADM.ACC, nls=:ADM.NLS,sum=:ADM.SUM where nd=:ADM.ND"
.head 4 -  Set ADM.strSqlDelete = "Delete from KP_deal where ND=:ADM.ND"
.head 4 -  Set ADM.strSqlInsert =
"Insert into KP_deal(acc,name,nls) values (:ADM.ACC,:ADM.NAME,:ADM.NLS)"
.head 4 -  Set ADM.strSqlPopulate =
"SELECT k.nd, a.acc,a.nls,k.name,k.sum,a.nms, k.mfob, k.nlsb,
        k.okpob, k.nmsb, b.nb, k.grp, k.sk
 INTO :ADM.ND,:ADM.ACC, :ADM.NLS,:ADM.NAME,:ADM.SUM,:ADM.NMS,:ADM.MFOB,:ADM.NLSB,
      :ADM.OKPOB,:ADM.NMSB,:ADM.NB,:ADM.GRP ,:ADM.SK
 From KP_DEAL k, accounts a, banks b
 WHERE k.acc=a.acc(+) and a.dazs is null and k.mfob=b.MFO (+) 
 ORDER BY k.nd" 
.head 4 -  !
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set ADM.nTabInstance = 1
.head 4 -  Set ADM.strPrintFileName = 'KP_DEAL'
.head 4 -  Set ADM.n980 = GetBaseVal()
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_DoubleClick
.head 4 +  If (ND > 0 and ACC != NUMBER_Null) or ND=0
.head 5 +  If not IsWindow(hWin1)
.head 6 -  Set hWin1 = SalCreateWindow( ADM1, hWndMDI, ND, nPar )
.head 5 +  Else
.head 6 -  Call SalBringWindowToTop( hWin1 )
.head 4 +  Else If ND != NUMBER_Null
.head 5 +  If IsWindow(hWin3)
.head 6 -  Call SalDestroyWindow( hWin3 )
.head 5 -  Set hWin3 = SalCreateWindow( ADM3, hWndMDI, FALSE,-ND )
.head 3 +  On SAM_TblDoDetails
.head 4 -  Call F_RB()
.head 3 +  On SAM_FetchRowDone
.head 4 +  If ND < 0
.head 5 -  Call SalTblSetCellTextColor( ND,  COLOR_Red, TRUE )
.head 5 -  Call SalTblSetCellTextColor( NAME,  COLOR_Red, TRUE )
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 204,224,247 ) )
.head 4 +  If ND = 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 3 +  On VTM_KeyUp
.head 4 +  If wParam = VK_Add
.head 5 -  Call SalSendMsg(ADM, SAM_DoubleClick, 0, 0)
.head 1 +  Table Window: ADM3
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.367"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.345"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 48075
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 48076
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 48077
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.договара
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME_ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: rb_TOBO
.head 3 -  Number: N_LOG
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 +  If rb_TOBO
.head 5 -  Call SalTblSetColumnTitle( ADM3.ID , "Код площадки" )
.head 5 -  Call SalTblSetColumnTitle( ADM3.NAME,"Наимен.площадки" )
.head 5 -  Set ADM3.strFilterTblName = 'KP_TOBO'
.head 5 -  Set ADM3.strPrintFileName = 'KP_TOBO'
.head 5 -  Set ADM3.strSqlPopulate =
"SELECT KP_TOBO.TOBO, t.name, d.nd, d.name
 INTO :ADM3.ID, :ADM3.NAME, :ADM3.ND, :ADM3.NAME_ND
 From kp_deal d, KP_TOBO, tobo t
 WHERE KP_TOBO.nd=d.nd and KP_TOBO.tobo=t.tobo
 ORDER BY KP_TOBO.tobo" 
.head 4 +  Else
.head 5 -  Call SalTblSetColumnTitle( ADM3.ID , "Код пачки" )
.head 5 -  Call SalTblSetColumnTitle( ADM3.NAME,"Наименование пачки" )
.head 5 -  Set ADM3.strFilterTblName = "KP_LOG_ND"
.head 5 -  Set ADM3.strPrintFileName = "KP_LOG"
.head 5 -  Set ADM3.strSqlPopulate =
"SELECT to_char(KP_LOG_ND.LOG), t.name, d.nd, d.name
 INTO :ADM3.ID, :ADM3.NAME, :ADM3.ND, :ADM3.NAME_ND
 From KP_DEAL d, KP_LOG_ND, kp_log t
 WHERE KP_LOG_ND.nd=d.nd and KP_LOG_ND.log=t.log and t.log="||Str(N_LOG)||"
 ORDER BY KP_LOG_ND.log" 
.head 4 -  !
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 -  !
.head 1 +  Form Window: frmKP
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввод коммунальных платежей
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   1.175"
.head 4 -  Top:    0.74"
.head 4 -  Width:  14.933"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.369"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.798"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 -  Frame
.head 5 -  Resource Id: 16233
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  14.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Raised-Shadow
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: TOBO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.155"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Код отделения')
.head 4 +  Data Field: S_TOBO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.783"
.head 7 -  Top:    0.155"
.head 7 -  Width:  3.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Название отделения')
.head 4 +  Data Field: CASH
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.583"
.head 7 -  Top:    0.155"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Счет кассы')
.head 4 +  Data Field: S_CASH
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    0.155"
.head 7 -  Width:  3.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Наименование счета кассы')
.head 4 +  Data Field: USR
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   12.683"
.head 7 -  Top:    0.405"
.head 7 -  Width:  0.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Код исполнителя')
.head 4 +  Data Field: S_USR
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.983"
.head 7 -  Top:    0.155"
.head 7 -  Width:  3.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'ФИО исполнителя')
.head 4 -  ! !!!!!!!!!!!!!!
.head 4 +  Pushbutton: pb_F1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call picTabs.BringToTop(0,TRUE)
.head 7 -  Call SalSetFocus(T1)
.head 4 +  Pushbutton: pb_F2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call picTabs.BringToTop(1,TRUE)
.head 4 +  Pushbutton: pb_F3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call picTabs.BringToTop(2,TRUE)
.head 7 -  Call SalSetFocus(T2)
.head 4 -  ! !!
.head 4 +  Data Field: nTOTAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.583"
.head 7 -  Top:    0.488"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.3"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Сумма платежей')
.head 4 +  Data Field: sTOTAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.783"
.head 7 -  Top:    0.488"
.head 7 -  Width:  6.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold-Italic
.head 6 -  Text Color: Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Сумма платежей прописью')
.head 4 -  ! !
.head 4 +  Data Field: nKOL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.583"
.head 7 -  Top:    0.488"
.head 7 -  Width:  0.55"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Teal
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Количество платежей')
.head 4 +  Data Field: sKOL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.183"
.head 7 -  Top:    0.488"
.head 7 -  Width:  4.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Teal
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Количество платежей прописью')
.head 4 -  !
.head 4 +  Pushbutton: pb_F11
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.083"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F11
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F11. Установить фокус на "ПРИНЯТО у клиента" '
.head 6 +  On SAM_Click
.head 7 -  Call SalSetFocus( nNAL )
.head 4 +  Data Field: nNAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.583"
.head 7 -  Top:    0.821"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: #000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Dark Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'ПРИНЯТО у клиента')
.head 6 +  On SAM_SetFocus
.head 7 +  If nNAL = 0
.head 8 -  Set nNAL = NUMBER_Null
.head 6 +  On SAM_Validate
.head 7 +  If not F_CheckNal()	
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Return VALIDATE_Ok
.head 4 +  Data Field: sDEL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.783"
.head 7 -  Top:    1.155"
.head 7 -  Width:  6.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold-Italic
.head 6 -  Text Color: Dark Green
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Принято у клиента прописью')
.head 4 -  !
.head 4 +  Data Field: nDEL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.583"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Dark Green
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Возвратить клиенту')
.head 4 +  Data Field: sNAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.783"
.head 7 -  Top:    0.821"
.head 7 -  Width:  6.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold-Italic
.head 6 -  Text Color: Dark Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Возвратить клиенту прописью')
.head 4 -  ! !
.head 4 +  Data Field: dFIO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.583"
.head 7 -  Top:    0.821"
.head 7 -  Width:  5.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'ФИО плательщика')
.head 4 -  !
.head 4 +  Pushbutton: pb_New
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.083"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F4
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F4. Новый клиент (новая пачка)'
.head 6 +  On SAM_Click
.head 7 -  Call F_New(TRUE)
.head 4 +  Pushbutton: pbK_Val
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.383"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Покупка ВАЛЮТЫ.'
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'K_', CASH, AA1,dFIO, DatB, pb_Exit, b840, b978, b643 )
.head 4 +  Pushbutton: pbP_Val
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.883"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Salmon
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продажа ВАЛЮТЫ.'
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'P_', CASH, AA2,dFIO, DatB, pb_Exit, b840, b978, b643 )
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   14.383"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'ESC. Завершити  '
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! !!
.head 4 +  Data Field: dfTextHelp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.1"
.head 7 -  Top:    1.5"
.head 7 -  Width:  14.683"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_F10
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.583"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F10. Ввести документы '
.head 6 +  On SAM_Click
.head 7 +  If not F_CheckNal()
.head 8 -  Return FALSE
.head 7 +  If bOpl
.head 8 -  Set bOpl = FALSE
.head 8 +  If F_Opl()
.head 9 -  Call SqlCommit( hSql() )
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow( T2, nRow, 0, 0 )
.head 10 -  Call SalTblSetFocusRow( T2, nRow ) 
.head 10 -  Call XSalTblSetRowBackColor(T2, nRow, COLOR_Gray )
.head 9 -  Call MessageNoWait('Пачка документов успешно введена!','Сообщение',3,0)
.head 9 -  Call F_New(FALSE)
.head 9 -  Call SalDisableWindow( pb_F10 )
.head 4 +  Pushbutton: pb_F5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.583"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F5. Напечатать пачку оплаченых документов'
.head 6 +  On SAM_Click
.head 7 -  Call F_Print()
.head 4 +  Pushbutton: pb_PrintO
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    1.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F7
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip ='F12 - Напечатать квитанцию на текущий документ'
.head 6 +  On SAM_Click
.head 7 -  Call SalSetFocus(T2)
.head 7 +  If T2.NUM = NUMBER_Null
.head 8 -  Return FALSE
.head 7 +  If SalMessageBox( 'Напечатать оттиск?','Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDYES
.head 8 -  Call F_Ottisk(T2.NMS, dFIO, T2.S, T2.K_FL)
.head 4 +  Data Field: lbTotal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.512"
.head 7 -  Width:  1.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Blue
.head 6 -  Background Color: Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: lbNal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.845"
.head 7 -  Width:  1.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Red
.head 6 -  Background Color: Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: lbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    1.179"
.head 7 -  Width:  1.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Green
.head 6 -  Background Color: Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162557365466F 6E74000700437573 746F6D0000546162 466F6E744E616D65
0020: 000E004D53205361 6E73205365726966 00005461624C6566 744D617267696E00
0040: 0200300000546162 43757272656E7400 06004E616D653000 00546162426F7474
0060: 6F6D4D617267696E 0002003000005461 6250616765436F75 6E74000200310000
0080: 5461624C6162656C 73003C0046312E20 CCEEE6EBE8E2B320 EEEFE5F0E0F6B3BF
00A0: 0946322E20CFEEF2 EEF7EDE020EEEFE5 F0E0F6B3FF094633 2E20CFEEF2EEF7ED
00C0: E020EFE0F7EAE000 005461624E616D65 730012004E616D65 30094E616D653209
00E0: 4E616D6531000054 616252696768744D 617267696E000200 3000005461624472
0100: 61775374796C6500 0B0057696E393553 74796C6500005461 62466F726D506167
0120: 6573000300090900 00546162546F704D 617267696E000200 300000546162466F
0140: 6E7453697A650003 0031300000546162 4F7269656E746174 696F6E000A005461
0160: 62734F6E546F7000 0000000000000000 0000000000000000 0000000000000000
0180: 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 8501
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Burgundy
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  ! Call picTabs.SetLabel(0, ' ' || CurrentLangTable.GetAtomTitle('frmKP.cTabs0') || ' ', TRUE)
.head 6 -  ! Call picTabs.SetLabel(1, ' ' || CurrentLangTable.GetAtomTitle('frmKP.cTabs1') || ' ', TRUE)
.head 6 -  ! Call picTabs.SetLabel(2, ' ' || CurrentLangTable.GetAtomTitle('frmKP.cTabs2') || ' ', TRUE)
.head 3 -  !
.head 3 +  Child Table: T1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    0.655"
.head 6 -  Width:  14.267"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Black
.head 5 -  Background Color: White
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: POS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № п\п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
29*
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.086"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование 
сч 29*
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: GRP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Груп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СКП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.443"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_KillFocus
.head 8 -                                                                                           Call SalSendMsg( SK, SAM_Validate, 0, 0 ) 
.head 7 +  ! On SAM_Validate
.head 8 +                                                                                           If SK != NUMBER_Null  
.head 9 +                                                                                           If SqlPrepareAndExecute( hSql(),
"SELECT name into :NMSK from sk where sk=:SK and sk<40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 10 -  ! Call SalMessageBox("Ош.МФО-Б "|| MFOB , "В Н И М А Н И Е ! ", MB_IconStop)
.head 10 -                                                                                           Set NMSK = "! Ош.СКП "
.head 10 -                                                                                           Return VALIDATE_Cancel
.head 8 +                                                                                           Else 
.head 9 -                                                                                           Set NMSK = STRING_Null
.head 8 -                                                                                           Return VALIDATE_Ok
.head 5 +  Column: MFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.банка -Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наимен-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.571"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
 договора
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ACC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Груп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наимен 
СПК
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC6F
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC6U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC3U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s6F
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сч.дох.(6110) от ФЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.829"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s6U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сч.дох.(6110) от ЮЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s3U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: s3U
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 6 -  ! List Values 
.head 6 -  ! Message Actions 
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: шаб.
вв
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: PopulateT1
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sqltail
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set T1RCount = 0
.head 7 -  Call SalTblPopulate( T1, hSql(), 
"SELECT t.pos,k.name,k.nd, a.acc, a.nls, a.nms, k.mfob, k.nlsb, k.okpob, k.nmsb, b.nb,k.grp, k.nak, k.sk,
        s.name, k.tt, k.ACC6F,   k.ACC6U, k.ACC3U, k.NAZN, k.VOB 
 INTO :POS,:NAME,:ND, :ACC, :NLS, :NMS, :MFOB, :NLSB, :OKPOB, :NMSB, :NB,:GRP, :NAK, :SK,
      :NMSK, :TT, :ACC6F, :ACC6U, :ACC3U, :NAZN, :VOB 
 FROM kp_deal k, accounts a, banks b, kp_tobo t, sk s
 WHERE k.acc=a.acc(+) and a.dazs is null and k.mfob=b.MFO (+) and k.sk=s.sk(+) 
 AND k.nd=t.nd and t.tobo=:TOBO "||sqltail||" 
 ORDER BY t.pos", TBL_FillAll )
.head 7 -  Call SalTblSetTableFlags( T1, TBL_Flag_SelectableCols, TRUE )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call F_DOK(T1.ND)
.head 5 +  On SAM_FetchRowDone
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT substr(nvl(tobopack.gettoboparam('NLS6110F'), nls),1,15) INTO :T1.s6F FROM accounts where acc=:T1.ACC6F" ) and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT  substr(nvl(tobopack.gettoboparam('NLS6110U'), nls),1,15)  INTO :T1.s6U FROM accounts where acc=:T1.ACC6U" ) and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT nls INTO :T1.s3U FROM accounts where acc=:T1.ACC3U" ) and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 +  If NAK
.head 7 -  Call SalTblSetCellTextColor( T1.NLS,  COLOR_DarkBlue, TRUE )
.head 6 +  If ND < 0
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 204,224,247 ) )
.head 6 -  Set T1RCount = T1RCount + 1
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows( T1 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Add
.head 7 -  Call F_DOK(T1.ND)
.head 3 +  Data Field: dNLS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сч.29*')
.head 3 +  Data Field: dNMS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.35"
.head 6 -  Top:    0.512"
.head 6 -  Width:  3.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование Сч.29*')
.head 3 +  Check Box: dGRP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Группировать
.head 4 -  Window Location and Size
.head 5 -  Left:   6.15"
.head 5 -  Top:    0.512"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb_SK
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.4"
.head 5 -  Top:    0.512"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\A_SPEC.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F7. Вибрати СКП'
.head 5 +  On SAM_Click
.head 6 -  Call F_SK ()
.head 3 +  Data Field: dSK
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.85"
.head 6 -  Top:    0.512"
.head 6 -  Width:  0.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Символ Кас.Плану')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  On SAM_Validate
.head 6 +  If dSK != NUMBER_Null  
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT name into :dNMSK from sk where sk=:dSK and sk <40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Set dNMSK= STRING_Null
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dNMSK= STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dNMSK
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.583"
.head 6 -  Top:    0.512"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование СКП')
.head 3 +  Pushbutton: pb_MFO
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTBANK.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8. Вибрати Банк-Б'
.head 5 +  On SAM_Click
.head 6 -  Call F_MFO ()
.head 3 +  Data Field: dMFOB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    0.845"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  On SAM_Validate
.head 6 +  If dMFOB != STRING_Null  
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT nb into :dNB from banks where mfo=:dMFOB and nvl(blk,0) <>4 ")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Call SalMessageBox( 'Неверный МФО-Б', "Внимание" , MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dNB = STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'МФО-Б')
.head 3 +  Data Field: dNB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.35"
.head 6 -  Top:    0.845"
.head 6 -  Width:  3.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Наименование МФО-Б')
.head 3 +  Pushbutton: pb_Alien
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.1"
.head 5 -  Top:    0.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\ACCOUNTS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выбрать корреспондента'
.head 5 +  On SAM_Click
.head 6 -  Call F_Alien ()
.head 3 +  Data Field: dNLSB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.55"
.head 6 -  Top:    0.845"
.head 6 -  Width:  1.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Рахунок-Б')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 5 +  On SAM_Validate
.head 6 +  If dNLSB !=STRING_Null AND dNLSB != KeyAccount( dMFOB, dNLSB )
.head 7 -  Call SalMessageBox( 'Неверный счет-Б', "Внимание", MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dNMSB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.35"
.head 6 -  Top:    0.845"
.head 6 -  Width:  4.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If dNMSB = STRING_Null
.head 7 -  Set dNMSB = dNMS
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Наименование-Б(получателя)')
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 3 +  Data Field: dOKPOB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.55"
.head 6 -  Top:    0.845"
.head 6 -  Width:  1.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'ОКПО-Б')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 3 +  Child Table: D1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    1.595"
.head 6 -  Width:  13.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.143"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: TAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Додатковий реквізит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.829"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VALUE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значення дод.реквізиту
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.214"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 +  If Subs(D1.TAG,1,3)='FIO' and  dFIO !=STRING_Null
.head 9 -  Set D1.VALUE = dFIO
.head 8 -  Set sNOT = D1.VALUE
.head 8 -  ! Расчет формул
.head 8 -  ! If VAL != STRING_Null
.head 7 +  On SAM_DoubleClick
.head 8 +  If D1.BROWSER != STRING_Null
.head 9 -  Set sTmp = D1.VALUE
.head 9 -  Call SalModalDialog( dlgTagBrowse1, frmKP , D1.BROWSER, sTmp )
.head 9 -  Set D1.VALUE = sTmp
.head 9 -  Call SalSendMsg( D1.VALUE, SAM_Validate, 0, 0 )
.head 7 +  On SAM_Validate
.head 8 -  Set D1.VALUE = SalStrTrimX( D1.VALUE )
.head 8 +  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE), D1.OPT)
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If Subs(D1.TAG,1,3)='?LC' and not bFolder
.head 9 +  If D1.VALUE  != STRING_Null
.head 10 -  Set sLC = D1.VALUE
.head 10 +  If SqlPrepareAndExecute( hSql(),
  "SELECT S, fio, Nvl(TAG,0)
   INTO :dS, :dFIO , :nTag
   FROM KP_FILE
   WHERE tt=:T1.TT and lc=:sLC ")
and not SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Call SalMessageBox("Лицевой счет LC="|| D1.VALUE ||" не найденно в БД (KP_FILE), TT=" ||T1.TT ,
 "Внимание", MB_IconStop )
.head 10 +  Else
.head 11 +  If nTag = 1
.head 12 -  Set nRow = TBL_MinRow
.head 12 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 13 -  Call SalTblSetContext( D1, nRow )
.head 13 -  If SqlPrepareAndExecute( hSql(),
"SELECT value INTO :D1.VALUE
 FROM KP_TAG where TT=:T1.TT and LC=:sLC and TAG=:D1.TAG")
and SqlFetchNext( hSql(), nFetchRes )
.head 9 +  Else
.head 10 -  Call SalMessageBox("Не заполнено поле <Лицевой счет>", "Внимание !", MB_IconStop )
.head 8 -  Call F_CheckFormula()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: VAL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значення дод.реквізиту
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.157"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: FMT
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BROWSER
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BROWSER
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 250
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NOMODIFY 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NOMODIFY 
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VSPO_CHAR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VSPO_CHAR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: CHKR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OPT
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Rn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OPT
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call SetTblRowColor(D1, COLOR_Red)
.head 6 +  Else
.head 7 -  Call SetTblRowColor(D1, COLOR_Black)
.head 6 +  If VAL != STRING_Null and SalStrScan(VAL,'#') < 0
.head 7 -  Set VALUE = VAL
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Insert
.head 7 -  Call SalTblSetFocusRow( D1, D1.Rn - 1 )
.head 7 -  Call SalTblSetFocusCell ( hWndForm, D1.Rn - 1, D1.VALUE, 0, -1 )
.head 3 +  Data Field: dNAZN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    4.762"
.head 6 -  Width:  13.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,  'Назначение платежа')
.head 5 +  ! On VTM_LeftDoubleClick
.head 6 -                       Call FunNSIGetFiltered('ALIEN_NAZN','NAZN',
    ' IDT= '|| SalStrLeftX( SalStrRightX( '000000'||sNlsAlt, 6 ), 3 ) ||' or IDT is null  order by IDN', sTmp, dNAZN )
.head 3 +  Data Field: dS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    1.179"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'Сума платежу')
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 7 -  Call SalTblSetContext( D1, nRow )
.head 7 +  If D1.TAG = 'TOTAL' and D1.VALUE != STRING_Null
.head 8 -  Set dS = SalStrToNumber(D1.VALUE) 
.head 8 -  Call F_Komis( )
.head 8 -  Break
.head 5 +  On SAM_Validate
.head 6 -  Call DecPoint(hWndItem)
.head 6 +  If not SalIsValidDecimal( hWndItem, 15, 2 ) or SalIsNull( hWndItem ) or dS=0 
.head 7 -  Call SalMessageBox( "Ошибка суммы ! ", " Внимание ", MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set dS = SalNumberAbs(dS)
.head 6 -  Call F_Komis( )
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 -  ! Call SalSendMsg(dS, SAM_Validate, 0, 0 )
.head 3 +  Data Field: dK_FL
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.35"
.head 6 -  Top:    1.179"
.head 6 -  Width:  1.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'Сума комісії з платника')
.head 3 +  Pushbutton: pb_Save
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.45"
.head 5 -  Top:    1.179"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Сохранить операцию(F2)'
.head 5 +  On SAM_Click
.head 6 -  Call F_InsRow()
.head 5 +  On VTM_KeyUp
.head 6 -  Call F_InsRow()
.head 3 +  Pushbutton: pb_Del
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.95"
.head 5 -  Top:    1.179"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F6
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F6. Новый документ '
.head 5 +  On SAM_Click
.head 6 -  Call F_Clear()
.head 3 +  Child Table: T2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    0.44"
.head 6 -  Width:  14.267"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.131"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: NUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFOB 
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: K_FL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 6 -  ! List Values 
.head 6 -  ! Message Actions 
.head 5 +  Column: NAM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение 
платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СКП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_KillFocus
.head 8 -                                                                                           Call SalSendMsg( SK, SAM_Validate, 0, 0 ) 
.head 7 +  ! On SAM_Validate
.head 8 +                                                                                           If SK != NUMBER_Null  
.head 9 +                                                                                           If SqlPrepareAndExecute( hSql(),
"SELECT name into :NMSK from sk where sk=:SK and sk<40")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 10 -  ! Call SalMessageBox("Ош.МФО-Б "|| MFOB , "В Н И М А Н И Е ! ", MB_IconStop)
.head 10 -                                                                                           Set NMSK = "! Ош.СКП "
.head 10 -                                                                                           Return VALIDATE_Cancel
.head 8 +                                                                                           Else 
.head 9 -                                                                                           Set NMSK = STRING_Null
.head 8 -                                                                                           Return VALIDATE_Ok
.head 5 -  !
.head 5 +  Column: NLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.086"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование счета
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер 
договора
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
плат
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: CASH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.086"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S_CASH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: s6F
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s6U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: s3U
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 6 -  ! List Values 
.head 6 -  ! Message Actions 
.head 5 +  Column: K_UL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 6 -  ! List Values 
.head 6 -  ! Message Actions 
.head 5 +  Column: NAK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 6 -  ! List Values 
.head 6 -  ! Message Actions 
.head 5 +  Column: GRP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 6 -  ! List Values 
.head 6 -  ! Message Actions 
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If T2.REF != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF, 'OPER', FALSE )
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Delete
.head 7 -  Call SalSendMsg(pbDel, SAM_Click, 0, 0 )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows( T2 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 3 +  Pushbutton: pbDel
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.217"
.head 5 -  Top:    4.619"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Удалить операцию')
.head 5 +  On SAM_Click
.head 6 +  If T2.NUM != NUMBER_Null and T2.REF = NUMBER_Null and SalMessageBox( 'Удалить документ № ' || SalNumberToStrX(T2.NUM,0) || '?' ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDYES
.head 7 -  Set nRow = SalTblQueryContext(T2) 
.head 7 -  Set nTOTAL = nTOTAL - T2.S - T2.K_FL
.head 7 -  Set nKOL = nKOL - 1
.head 7 -  Call SalTblDeleteRow ( T2, nRow, TBL_NoAdjust)
.head 7 +  If nTOTAL != 0
.head 8 -  Call SalEnableWindow( nNAL )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( nNAL )
.head 3 +  Pushbutton: pbShowDoc
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.75"
.head 5 -  Top:    4.619"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Просмотр карточки документа(F3)')
.head 5 +  On SAM_Click
.head 6 +  If T2.REF != NUMBER_Null
.head 7 -  Call DocView( hWndMDI, T2.REF, 2, 0, '')
.head 3 +  Data Field: fMfo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.405"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If fMfo != STRING_Null  
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT nb from banks where mfo=:fMfo and nvl(blk,0) <>4 ")
and not SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  Call SalMessageBox( 'Неверный МФО-Б', "Внимание" , MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: fNls
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    0.405"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If fMfo = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If fNls !=STRING_Null AND fNls != KeyAccount( fMfo, fNls )
.head 7 -  Call SalMessageBox( 'Неверный счет-Б', "Внимание", MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Мфо-Б
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 64554
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.452"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Счет-Б
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 64555
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.15"
.head 5 -  Top:    0.452"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: bFind
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поиск(F6)
.head 4 -  Window Location and Size
.head 5 -  Left:   4.883"
.head 5 -  Top:    0.405"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F6
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_Find()	
.head 3 +  Option Button: cbDetail
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.167"
.head 5 -  Top:    0.405"
.head 5 -  Width:  0.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\BROWSE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Button Style: Check
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Показать дополнительную информацию' )
.head 5 +  On SAM_Click
.head 6 -  Call F_Detail(cbDetail)
.head 3 +  Data Field: fPos
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.65"
.head 6 -  Top:    0.405"
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On VTM_KeyUp
.head 6 +  If fPos != NUMBER_Null
.head 7 -  Call T1.PopulateT1(" and t.pos="||Str(fPos))
.head 6 +  Else
.head 7 -  Call T1.PopulateT1("")
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Поиск по номеру' )
.head 3 +  Data Field: dDatV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.083"
.head 6 -  Top:    1.202"
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam,   'Дата валютування')
.head 3 -  Background Text: Дата валютування:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 34016
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.083"
.head 5 -  Top:    1.262"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: F_Detail
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: flag
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If flag
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,3, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,4, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,6, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,7, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,8, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,9, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,10, COL_GetPos ))		
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,11, COL_GetPos ))
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,20, COL_GetPos ))
.head 6 -  Call SalShowWindow(SalTblGetColumnWindow (T1,21, COL_GetPos ))
.head 5 +  Else
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,3, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,4, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,5, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,6, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,7, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,8, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,9, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,10, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,11, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,20, COL_GetPos ))
.head 6 -  Call SalHideWindow(SalTblGetColumnWindow (T1,21, COL_GetPos ))
.head 3 +  Function: TabActivateFinish
.head 4 -  Description: Override base class function
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nTmp = picTabs.GetTop()
.head 5 +  If nTmp = 0
.head 6 -  Call SalSetFocus(T1)
.head 5 +  Else If nTmp = 2
.head 6 -  Call SalSetFocus(T2)
.head 3 +  Function: F_Opl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRef
.head 5 -  Date/Time: sDate
.head 5 -  String: sIns
.head 5 -  !
.head 5 -  Boolean: FL
.head 4 +  Actions
.head 5 -  ! Собственно оплата
.head 5 -  Set DatB = dDatV
.head 5 -  Set sIns = "INSERT into operw (ref,tag,value) VALUES(:nRef,:D1.TAG,:D1.VALUE )" 
.head 5 -  If SqlPrepareAndExecute( hSql(),"SELECT sysdate INTO :sDate FROM dual") and SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0 )
.head 6 -  Call SalTblSetFocusRow( T2, nRow ) 
.head 6 -  Set nRef = NUMBER_Null
.head 6 +  If T2.REF = NUMBER_Null	
.head 7 -  Set nS = T2.S * 100
.head 7 +  If T2.GRP
.head 8 -  ! Деб 100*  Кред 29*
.head 8 -  Call cDoc.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatB, DatB,
     T2.CASH, T2.S_CASH, BankMfo, '', n980, nS, BankOkpo,
     T2.NLS, T2.NMS, BankMfo, '', n980, nS,BankOkpo,
     T2.NAZN, '', GetIdOper(),'', T2.SK ,0)
.head 7 +  Else
.head 8 -  ! Деб 29*  Кред 26*
.head 8 +  If BankMfo = T2.MFOB
.head 9 -  Call cDoc.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatB, DatB,
     T2.CASH, T2.S_CASH, BankMfo, '', n980, nS, BankOkpo,
     T2.NLSB, T2.NMSB, T2.MFOB, '', n980, nS, T2.OKPOB,
     T2.NAZN, '', GetIdOper(),'', T2.SK ,0)
.head 8 +  Else
.head 9 -  Call cDoc.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatB, DatB,
     T2.CASH, T2.S_CASH, BankMfo, '', n980, nS, BankOkpo,
     T2.NLS, T2.NMSB, T2.MFOB, '', n980, nS, T2.OKPOB,
     T2.NAZN, '', GetIdOper(),'', T2.SK ,0)
.head 7 -  ! Оплата	
.head 7 +  If cDoc.oDoc()
.head 8 -  Set nRef = cDoc.m_nRef
.head 8 -  Set T2.REF = nRef
.head 8 +  If T2.K_FL >0 
.head 9 -  ! Деб 100*  Кред 611*ФЛ
.head 9 +  If not cDoc.PayV(1,nRef, DatB, 'Э99', 1, n980, T2.CASH, T2.K_FL*100, n980, T2.s6F, T2.K_FL*100 )
.head 10 -  Return FALSE
.head 8 +  If T2.K_UL >0 and T2.GRP
.head 9 -  ! Деб 35*  Кред 611*ЮЛ или 
.head 9 -  ! Деб 29*  Кред 611*ЮЛ  
.head 9 +  If not cDoc.PayV(1,nRef, DatB, 'Э99', 1, n980, IifS(T2.s3U=STRING_Null, T2.NLS, T2.s3U), T2.K_UL*100, n980, T2.s6U, nK_UL*100 )
.head 10 -  Return FALSE
.head 8 -  If SqlPrepareAndExecute( hSql(),"INSERT INTO operw(ref,tag,value) VALUES(:nRef,'ND',:T2.ND)" )
and  SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref, tag,value) SELECT :nRef, tag, value FROM tmp_operw  WHERE tt=:T2.TT and value is not null and nom=:T2.NUM" )
.head 8 +  Else
.head 9 -  Return FALSE
.head 8 +  If not T2.GRP and BankMfo != T2.MFOB 
.head 9 -  If SqlPrepareAndExecute( hSql(),"update oper set nlsb=:T2.NLSB where ref=:nRef")
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 -  If SalStrUpperX( Subs(strPar02,1,1) )='N' ! нахальная печать NO
.head 5 +  Else ! YES
.head 6 -  Call F_Print()
.head 5 -  Return TRUE
.head 3 +  Function: DecPoint      ! Корректировка символа "десятичной точки"
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 -  Return TRUE
.head 3 +  Function: F_New
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: full
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If full
.head 6 -  Call SalTblReset( T2 )
.head 6 -  Set nNum = 0
.head 5 -  Call SalDisableWindow( nNAL )
.head 5 -  Call SalDisableWindow( pb_F10 )
.head 5 -  Call SalEnableWindow( dS )
.head 5 -  Set bFolder = FALSE
.head 5 -  Set dFIO = STRING_Null
.head 5 -  Set nTOTAL = 0
.head 5 -  Set nDEL = 0
.head 5 -  Set nKOL = 0
.head 5 -  Set nNAL = 0
.head 5 -  Set sTOTAL = ""
.head 5 -  Set sDEL = ""
.head 5 -  Set sNAL = ""
.head 5 -  Set sKOL = ""
.head 5 -  Set fMfo = ""
.head 5 -  Set fNls = ""
.head 5 -  Set fPos = NUMBER_Null
.head 5 -  Call picTabs.BringToTop(0,TRUE)
.head 5 -  Call SqlPrepareAndExecute( hSql(), "delete from tmp_operw ")
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Call F_Clear()
.head 5 -  Call T1.PopulateT1('')
.head 3 +  Function: F_DOK
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: ND
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: tts_cond
.head 5 -  Number: nI
.head 5 -  Number: sum
.head 5 -  String: tt
.head 4 +  Actions
.head 5 -  Set bFolder = FALSE
.head 5 +  If ND < 0
.head 6 +  If F_EnterFolder(ND)
.head 7 -  Set bFolder = TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 -  Call SalTblSetLockedColumns( D1, 1 )
.head 5 -  Call picTabs.BringToTop(1,TRUE)
.head 5 -  Call F_ShowHide( not bFolder )
.head 5 +  If not bFolder
.head 6 -  If SqlPrepareAndExecute( hSql(), 
"SELECT k.tt,k.vob,k.nazn,k.sk,nvl(k.nls,a.nls),a.nms,k.nlsb,k.nmsb,k.mfob,k.okpob,k.nak,k.grp,b.nb,s.name 
INTO :tt,:nVob,:dNAZN,:dSK,:dNLS,:dNMS,:dNLSB,:dNMSB,:dMFOB,:dOKPOB,:bNak,:dGRP,:dNB,:dNMSK
FROM kp_deal k, accounts a,banks b, sk s
WHERE k.acc=a.acc(+) and k.mfob=b.MFO (+) and k.sk=s.sk(+)  and k.nd=:ND" )
and SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If SalStrScan( dNLS, '#' ) >=0
.head 7 +  If SqlPrepareAndExecute(hSql(), "SELECT substr(tobopack.gettoboparam"|| SalStrRightX(dNLS,SalStrLength(dNLS)-1) ||",1,30) INTO :sTmp FROM dual") and 
   SqlFetchNext( hSql(), nFetchRes )
.head 8 +  If sTmp = STRING_Null 
.head 9 -  Call SalMessageBox("Не задан параметр NLS2902_"||Str(ND)||" для даного отделения",
'Заполните справочник tobo_params' , MB_IconStop)
.head 9 -  Call F_New(TRUE)
.head 9 -  Return FALSE
.head 8 +  Else
.head 9 -  Set dNLS = sTmp
.head 6 -  ! Для одиночек
.head 6 +  If ND = 0
.head 7 -  If SqlPrepareAndExecute( hSql(),"select val into :dNLS from tobo_params where tobo=:TOBO and tag='NLS2902'")
and SqlFetchNext( hSql(), nFetchRes ) 
.head 7 +  If dNLS = STRING_Null
.head 8 -  Call SalMessageBox("Для даного отделения("||TOBO||") не задан параметр NLS2902 (справочник TOBO_PARAMS)", "Внимание", MB_IconExclamation )
.head 8 -  Call F_New( FALSE )
.head 8 -  Return FALSE
.head 7 +  If SqlPrepareAndExecute( hSql(),"select nms into :dNMS from accounts where nls=:dNLS") 
and not SqlFetchNext( hSql(), nFetchRes ) 
.head 8 -  Call SalMessageBox( "Счет "||dNLS||" не найден(параметр NLS2902 из справочника TOBO_PARAMS)", "Внимание", MB_IconExclamation )
.head 8 -  Call F_New( FALSE )
.head 8 -  Return FALSE
.head 7 -  Set dMFOB = fMfo
.head 7 -  Set dNLSB = fNls
.head 7 -  Call SalSendMsg( dMFOB, SAM_Validate, 0, 0 ) 
.head 7 -  Call SalSendMsg( dNLSB, SAM_Validate, 0, 0 ) 
.head 6 -  !
.head 6 -  Set dK_FL = 0
.head 6 -  Set nK_FL = 0
.head 6 -  Set nK_UL = 0
.head 6 -  Set dS = 0
.head 6 -  Call SalEnableWindow( dS )
.head 6 +  If dGRP
.head 7 -  Call SalDisableWindow( pb_MFO )
.head 7 -  Call SalDisableWindow( pb_Alien )
.head 7 -  Call SalDisableWindow( dMFOB )
.head 7 -  Call SalDisableWindow( dNLSB )
.head 7 -  Call SalDisableWindow( dOKPOB )
.head 7 -  Call SalDisableWindow( dNMSB )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pb_MFO )
.head 7 -  Call SalEnableWindow( pb_Alien )
.head 7 -  Call SalEnableWindow( dMFOB )
.head 7 -  Call SalEnableWindow( dNLSB )
.head 7 -  Call SalEnableWindow( dOKPOB )
.head 7 -  Call SalEnableWindow( dNMSB )
.head 6 -  Set tts_cond = "=:tt"
.head 5 +  Else
.head 6 -  Call SalDisableWindow( dS )
.head 6 -  Set tts_cond = " in( "
.head 6 -  Set nI = 0
.head 6 +  Loop
.head 7 +  If nI >= nCountListNd
.head 8 -  Break
.head 7 -  Set sum = SalStrToNumber( ListNd[nI, 2] )
.head 7 -  If Val(ListNd[nI, 0]) =0 and SqlPrepareAndExecute( hSql(), 
"SELECT Bars.KP_Kom(:ListNd[nI, 0],:sum,0),Bars.KP_Kom(:ListNd[nI, 0],:sum,1) INTO :ListNd[nI, 3],:ListNd[nI, 4] from dual" )
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set dS = dS + sum
.head 7 -  Set dK_FL = dK_FL + SalStrToNumber( ListNd[nI, 3] )
.head 7 -  Set tts_cond = tts_cond || "'" || ListNd[nI, 1] || "'"
.head 7 +  If nI != nCountListNd-1 
.head 8 -  Set tts_cond = tts_cond || ","
.head 7 -  Set nI = nI + 1
.head 6 -  Set tts_cond = tts_cond || " ) "
.head 5 -  Call SalTblPopulate( D1, hSql(), 
"select rownum,o.tag,o.name,o.fmt,o.browser,o.NOMODIFY,o.VSPO_CHAR,o.CHKR,
 nvl((select opt from op_rules where tag=o.tag and opt='M' and tt"||tts_cond||" and rownum<2),'O'),
 (select val from op_rules where tag=o.tag and tt"||tts_cond||" and rownum<2) VAL,
  (select ord from op_rules where tag=o.tag and tt"||tts_cond||" and rownum<2) ORD
 INTO :D1.Rn,:D1.TAG, :D1.NAME,:D1.FMT, :D1.BROWSER, :D1.NOMODIFY, :D1.VSPO_CHAR, :D1.CHKR,:D1.OPT,:D1.VAL,:nTmp
 From op_Field o
 where o.tag in (select distinct tag from op_rules where tt"||tts_cond||" and USED4INPUT = 1)
 order by ord ", TBL_FillAll )
.head 5 +  If dSK = NUMBER_Null
.head 6 -  Call SalSetFocus( dSK )
.head 5 +  Else If dMFOB = STRING_Null
.head 6 -  Call SalSetFocus( dMFOB )
.head 5 +  Else
.head 6 -  Call SalSetFocus(D1)
.head 6 -  Call SalTblSetContext(D1, 0)
.head 6 -  Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, 1)
.head 5 +  If bFolder 
.head 6 -  Call SalSetFocus(D1)
.head 6 -  Call SalTblSetContext(D1, 0)
.head 6 -  Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, 1)
.head 3 +  Function: F_SK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("SK","NAME"," SK <40 ", sTmp, dNMSK )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set dSK =Val(sTmp)
.head 3 +  Function: F_MFO
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=STRING_Null
.head 5 -  Call FunNSIGetFiltered 
("BANKS", "NB"," nvl(blk,0) <>4 ", sTmp, dNB )
.head 5 +  If sTmp !=STRING_Null
.head 6 -  Set dMFOB=sTmp
.head 6 -  Call SalSendMsg( dNLSB, SAM_KillFocus, 0, 0 ) 
.head 3 +  Function: F_Komis
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nK_FL = 0
.head 5 -  Set nK_UL = 0
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT Bars.KP_Kom(:T1.ND,:dS,0),Bars.KP_Kom(:T1.ND,:dS,1) INTO :nK_FL,:nK_UL from dual" )
and SqlFetchNext( hSql(), nFetchRes ) 
.head 6 +  If nK_FL > 0
.head 7 -  Set dK_FL = nK_FL
.head 3 +  Function: F_Tag
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sCHKR
.head 5 -  String: sTag
.head 5 -  String: sValue
.head 5 -  String: sOpt
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bFL
.head 4 +  Actions
.head 5 +  If Subs(sTag,1,3)='FIO' and sValue != STRING_Null
.head 6 -  Set dFIO = sValue
.head 5 -  ! Если sValue = STRING_Null
.head 5 -  ! и не обяз  != M не проверять
.head 5 -  Set bFL = TRUE
.head 5 -  ! Обязательный, но пустой
.head 5 +  If sOpt ='M' and sValue = STRING_Null
.head 6 -  Set bFL = FALSE
.head 5 -  ! не пустой, но есть проверка и он ее не проходит
.head 5 +  If sValue != STRING_Null and sCHKR != STRING_Null
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT C_TAG (:sTag,:sValue) INTO :nC_TAG from dual ")
and SqlFetchNext( hSql(), nFetchRes )
and nC_TAG = 0
.head 7 -  Set bFL = FALSE
.head 5 -  ! Плохо дело
.head 5 +  If not bFL
.head 6 -  ! Set D1.VALUE = sNOT
.head 6 -  Call XSalTblSetCellBackColor( D1.VALUE , SalColorFromRGB( 255,200,255 ) )
.head 6 -  Set sErr = " Не заполнен реквизит < "|| D1.NAME || ">"
.head 6 -  Call SalMessageBox( sErr, "Внимание !", MB_IconStop)
.head 6 -  Call SalTblSetFocusCell(D1,SalTblQueryContext(D1),D1.VALUE,0,-1)
.head 5 -  Return bFL
.head 3 +  Function: F_InsRow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  String: sNazn
.head 5 -  Number: nI
.head 5 -  Number: acc6F
.head 5 -  Number: acc6U
.head 5 -  Number: acc3U
.head 4 +  Actions
.head 5 +  If not bFolder
.head 6 -  ! последняя проверка 
.head 6 +  If dS <=0
.head 7 -  Call SalMessageBox('Ошибка суммы', 'Внимание', MB_IconExclamation)
.head 7 -  Call SalSetFocus(dS)
.head 7 -  Return FALSE
.head 6 -  ! !!
.head 6 -  Set sErr = STRING_Null
.head 6 +  If dNLS = STRING_Null 
.head 7 -  Set sErr = sErr || '   <Счет 29*>' || PutCrLf()
.head 6 +  If dMFOB = STRING_Null 
.head 7 -  Set sErr = sErr || '    <МФО-Б> ' || PutCrLf()
.head 6 +  If dNLSB = STRING_Null 
.head 7 -  Set sErr = sErr || '   <Счет-Б>' || PutCrLf()
.head 6 +  If dOKPOB= NUMBER_Null 
.head 7 -  Set sErr = sErr || '   <ОКПО-Б> ' || PutCrLf()
.head 6 +  If dNMSB = STRING_Null 
.head 7 -  Set sErr = sErr || '   <Наименов-Б>' || PutCrLf()
.head 6 +  If dNAZN = STRING_Null 
.head 7 -  Set sErr = sErr || '   <Назначение платежа>' || PutCrLf()
.head 6 +  If dSK = NUMBER_Null 
.head 7 -  Set sErr = sErr || '    <СКП> ' || PutCrLf()
.head 6 +  If sErr ! = STRING_Null 
.head 7 -  Call SalMessageBox( sErr,"Не заданы все обязательные параметры !" , MB_IconStop)
.head 7 -  Return FALSE
.head 5 -  ! !!
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRow ) 
.head 6 +  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE ), D1.OPT)
.head 7 -  Return FALSE
.head 6 +  If D1.VALUE != STRING_Null
.head 7 -  Call SalTblSetRowFlags( D1, nRow, ROW_New, TRUE )
.head 7 -  Call XSalTblGetCellBackColor(D1.VALUE,nCol)
.head 7 +  If nCol = SalColorFromRGB( 255,200,255 )
.head 8 -  Call XSalTblSetCellBackColor( D1.VALUE , SalColorFromRGB( 255,255,255 ) )
.head 5 +  If not bFolder
.head 6 -  ! параметры - сумма и назначение	
.head 6 -  Set nSum = ( dS - IifN(T1.s3U=STRING_Null, nK_UL, 0 ) )
.head 6 -  Set sNazn= Subs(dNAZN || IifS(dFIO=STRING_Null,'', '. Плательщик '|| dFIO), 1, 160)
.head 6 +  If SalMessageBox( 'Добавить документ на сумму' || PutCrLf() || SumPr(dS*100, 'F', 'грн' , "коп" ) || ' (' || SalNumberToStrX(dS,2) || ')' ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDNO
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Set nTOTAL = nTOTAL + dS
.head 6 -  Set nKOL = nKOL + 1
.head 6 +  If nK_FL > 0
.head 7 -  Set nTOTAL = nTOTAL + dK_FL
.head 6 -  ! вставляем строку	 
.head 6 -  Set nRow = SalTblInsertRow ( T2, TBL_MaxRow )					
.head 6 -  Call SalTblSetContext ( T2, nRow )
.head 6 -  Set nNum = nNum + 1
.head 6 -  Set T2.NUM = nNum 
.head 6 -  Set T2.ND = T1.ND
.head 6 -  Set T2.TT = T1.TT
.head 6 -  Set T2.VOB = T1.VOB	
.head 6 -  Set T2.NAZN = sNazn
.head 6 -  Set T2.S = dS
.head 6 -  Set T2.SK = dSK
.head 6 -  Set T2.s6F = T1.s6F
.head 6 -  Set T2.s6U = T1.s6U
.head 6 -  Set T2.s3U = T1.s3U
.head 6 -  Set T2.K_UL = nK_UL
.head 6 -  Set T2.K_FL = nK_FL
.head 6 -  Set T2.MFO = dMFOB 
.head 6 -  Set T2.NAM = dNAZN 
.head 6 -  Set T2.NAK = T1.NAK
.head 6 -  Set T2.GRP = dGRP
.head 6 -  Set T2.CASH = CASH
.head 6 -  Set T2.S_CASH = S_CASH
.head 6 -  Set T2.NLS = dNLS
.head 6 -  Set T2.NMS = dNMS
.head 6 -  Set T2.NLSB = dNLSB
.head 6 -  Set T2.NMSB = dNMSB
.head 6 -  Set T2.MFOB = dMFOB
.head 6 -  Set T2.OKPOB = Str(dOKPOB)
.head 6 -  Call SalTblSetCellTextColor( T2.S,  COLOR_Red, TRUE )
.head 6 -  Call SalTblSetCellTextColor( T2.K_FL, COLOR_DarkGreen, TRUE )
.head 6 -  ! заполнаем доп реквизиты
.head 6 -  If SqlPrepare(hSql(), "INSERT INTO tmp_operw(tt,tag,value,nom) VALUES(:T1.TT,:D1.TAG,:D1.VALUE,:nNum)" )
and SalTblDoInserts(D1, hSql(), TRUE) 
.head 6 -  Call SqlCommit(hSql())
.head 5 +  Else
.head 6 +  Loop
.head 7 +  If nI >= nCountListNd
.head 8 -  Break
.head 7 -  Set nRow = SalTblInsertRow ( T2, TBL_MaxRow )					
.head 7 -  Call SalTblSetContext ( T2, nRow )
.head 7 -  If SqlPrepareAndExecute( hSql(), 
"SELECT k.nd,k.tt,k.vob,k.nazn,k.sk,k.acc6f,k.acc6u,k.acc3u,a.nls,a.nms,k.nlsb,k.nmsb,k.mfob,k.mfob,k.okpob,k.nak,k.grp 
INTO :T2.ND,:T2.TT,:T2.VOB,:T2.NAM,:T2.SK,:acc6F,:acc6U,:acc3U,:T2.NLS,:T2.NMS,:T2.NLSB,:T2.NMSB,:T2.MFO,:T2.MFOB,:T2.OKPOB,:T2.NAK,:T2.GRP
FROM kp_deal k, accounts a WHERE k.acc=a.acc(+) and k.nd=:ListNd[nI, 0]" )
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  !
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT nls INTO :T2.s6F FROM accounts where acc=:acc6F" ) and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT nls INTO :T2.s6U FROM accounts where acc=:acc6U" ) and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT nls INTO :T2.s3U FROM accounts where acc=:acc3U" ) and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 7 -  Set nNum = nNum + 1
.head 7 -  Set T2.NUM = nNum 
.head 7 -  Set T2.S = SalStrToNumber( ListNd[nI, 2] )
.head 7 -  Set T2.K_UL = SalStrToNumber( ListNd[nI, 4] )
.head 7 -  Set T2.K_FL = SalStrToNumber( ListNd[nI, 3] )
.head 7 -  Set T2.CASH = CASH
.head 7 -  Set T2.NAZN = Subs(T2.NAM || IifS(dFIO=STRING_Null,'', '. Плательщик '|| dFIO), 1, 160)
.head 7 -  Set T2.S_CASH = S_CASH
.head 7 -  Call SalTblSetCellTextColor( T2.S,  COLOR_Red, TRUE )
.head 7 -  Call SalTblSetCellTextColor( T2.K_FL, COLOR_DarkGreen, TRUE )
.head 7 -  ! заполнаем доп реквизиты
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 8 -  Call SalTblSetContext( D1, nRow ) 
.head 8 +  If SqlPrepareAndExecute( hSql(),"select tag from op_rules where tt=:T2.TT and tag=:D1.TAG")
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SqlPrepareAndExecute( hSql(), "INSERT INTO tmp_operw(tt,tag,value,nom) VALUES(:T2.TT,:D1.TAG,:D1.VALUE,:nNum)")
.head 7 -  Call SqlCommit(hSql())
.head 7 -  !
.head 7 -  Set nI = nI + 1
.head 6 +  If SalMessageBox( 'Добавить документ на сумму' || PutCrLf() || SumPr(dS*100, 'F', 'грн' , "коп" ) || ' (' || SalNumberToStrX(dS,2) || ')' ,'Подтверждение' , MB_YesNo | MB_IconQuestion ) = IDNO
.head 7 -  Return FALSE
.head 6 -  Set nTOTAL = nTOTAL + dS
.head 6 +  If dK_FL > 0
.head 7 -  Set nTOTAL = nTOTAL + dK_FL
.head 6 -  Set nKOL = nKOL + nCountListNd
.head 5 -  ! !
.head 5 +  If nTOTAL != 0
.head 6 -  Call SalEnableWindow( nNAL )
.head 5 +  Else
.head 6 -  Call SalDisableWindow( nNAL )
.head 5 -  Set bFolder = FALSE
.head 5 -  Call picTabs.BringToTop(0,TRUE)
.head 5 -  Call F_Clear()
.head 3 +  Function: F_Alien
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql
.head 5 -  String: sMfo
.head 5 -  String: sNls
.head 4 +  Actions
.head 5 -  Set sSql = STRING_Null
.head 5 -  Set sSql = " kv=" || Str(n980) || " and NLSALT is not null "
.head 5 +  If dMFOB != STRING_Null
.head 6 -  Set sSql = sSql || " and  mfo=" || dMFOB
.head 5 -  Set sSql = sSql || " order by nlsalt "
.head 5 -  Call FunNSIGetFilteredAltPK('ALIEN','MFO','NLS', sSql, sMfo, sNls)
.head 5 +  If sMfo !=  STRING_Null
.head 6 -  If SqlPrepareAndExecute( hSql(),
   "SELECT MFO, NLS, OKPO, NAME
    INTO :dMFOB, :dNLSB, :dOKPOB, :dNMSB FROM alien WHERE nls=:sNls") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If dMFOB != STRING_Null
.head 7 -  Call SalSendMsg( dMFOB, SAM_Validate, 0, 0 ) 
.head 3 +  Function: F_Clear
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblReset( D1 )
.head 5 -  Set dS = 0
.head 5 -  Set dMFOB= STRING_Null
.head 5 -  Set dNB = STRING_Null
.head 5 -  Set dNLSB = STRING_Null
.head 5 -  Set dOKPOB = NUMBER_Null
.head 5 -  Set dNMSB = STRING_Null
.head 5 -  Set dSK = NUMBER_Null
.head 5 -  Set dK_FL = 0.00
.head 5 -  Set dNMSK = STRING_Null
.head 5 -  Set dNAZN = STRING_Null
.head 5 -  Set bFolder = FALSE
.head 5 -  ! !
.head 5 -  Call SalEnableWindow( dS )
.head 5 -  Call SalEnableWindow( pb_MFO )
.head 5 -  Call SalEnableWindow( pb_SK )
.head 5 -  Call SalEnableWindow( pb_Alien )
.head 5 -  Call SalEnableWindow( dMFOB )
.head 5 -  Call SalEnableWindow( dNLSB )
.head 5 -  Call SalEnableWindow( dOKPOB )
.head 5 -  Call SalEnableWindow( dNMSB )
.head 5 -  Call SalEnableWindow( dSK )
.head 3 +  Function: F_CheckNal
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nNAL = NUMBER_Null or nNAL = 0 or nNAL < nTOTAL 
.head 6 -  Call SalMessageBox("Сумма меньше требуемой, или ошибка суммы ! ", "Внимание", MB_IconStop)
.head 6 -  Set nNAL = NUMBER_Null
.head 6 -  Set nDEL = 0
.head 6 -  ! Call SalSetFocus(nNAL)
.head 6 -  Call SalDisableWindow( pb_F10 )
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Set nDEL = nNAL - nTOTAL
.head 6 -  Set sTOTAL = SumPr(  nTOTAL *100, 'F', 'Грн' , "коп" )
.head 6 -  Set sNAL = SumPr(  nNAL *100, 'F', 'Грн' , "коп" )
.head 6 -  Set sDEL = SumPr(  nDEL *100, 'F', 'Грн' , "коп" )
.head 6 -  Set sKOL = NumberPr( nKOL, "M" )
.head 6 -  Set bOpl = TRUE
.head 6 -  Call SalEnableWindow( pb_F10 )
.head 6 -  Return TRUE
.head 3 +  Function: F_Print
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.REF != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF, 'OPER', FALSE )
.head 3 +  Function: F_Ottisk
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: NMK
.head 5 -  String: FIO1
.head 5 -  Number: nSUMB
.head 5 -  Number: nSUMBK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TIME
.head 5 -  String: SUMB
.head 5 -  String: SUMBK
.head 5 -  !
.head 5 -  String: sTmp
.head 5 -  String: strReport
.head 5 -  String: strTempl
.head 5 -  !
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT  to_char(sysdate,'DD/MM/yyyy HH24:MM:SS') INTO :TIME FROM dual " )
and  SqlFetchNext(  hSqlAux2(),  nFetchRes)
.head 5 +  If nSUMB >0
.head 6 -  Set SUMB = SalNumberToStrX( nSUMB, 2 )|| ' грн'
.head 5 +  Else
.head 6 -  Set SUMB = STRING_Null
.head 5 +  If nSUMBK >0
.head 6 -  Set SUMBK = ', ком. '|| SalNumberToStrX( nSUMBK, 2 )|| ' грн'
.head 5 +  Else
.head 6 -  Set SUMBK = STRING_Null
.head 5 -  !
.head 5 -  Set strTempl = GetTemplateDir()||'\\OTTISK.qrd'
.head 5 -  Set sTmp =
GetBankMfo()||'~'|| GetBankName() ||'~'|| ADR ||'~'|| TIME || '~' || FIO1 || '~' ||
NMK ||'~'|| SUMB||'~'||SUMBK||'~'|| GetUserRealName()
.head 5 -  ! ---------------     Печатаем тикет            ------------
[REM        MFOA      - MFO--А
[REM        NBA       - Наш Банк
[REM        ADR
[REM        TIME     - Сист Дата
[REM        FIO1     - Кто платит
[REM        NMK   - Наименование Контрагента
[REM        SUMB     - Сумма сделки
[REM        SUMBK    - Сумма комиссии
[REM        FIO     - Кто ввел
-----
.head 5 -  !
.head 5 -  Set strReport = GetPrnDir()||'\\_'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || Str(SalDateDay(SalDateCurrent())), 2)
.head 5 -  !
.head 5 -  Call DosReport (strTempl,  strReport,'MFOA~NBA~ADR~TIME~FIO1~NMK~SUMB~SUMBK~FIO', sTmp, 0)
.head 5 -  Call DosDirectPrint(strReport)
.head 3 +  Function: F_EnterFolder
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nd
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(),"select count(*) from kp_log_nd where log=-:nd") and SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Return SalModalDialog( dlg_Folder, frmKP, -T1.ND)
.head 5 +  Else
.head 6 -  Call SalMessageBox('Пачка пустая','Предупреждение',MB_IconExclamation)
.head 6 -  Return FALSE
.head 3 +  Function: F_Find
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sql
.head 5 -  String: sMfo
.head 5 -  String: sNls
.head 4 +  Actions
.head 5 -  Set sMfo = fMfo
.head 5 -  Set sNls = fNls
.head 5 +  If sMfo != STRING_Null 
.head 6 +  While SalStrScan(sMfo, '*') > 0
.head 7 -  Set sMfo = SalStrReplaceX(sMfo,SalStrScan(sMfo,'*'),1,'%')
.head 6 -  Set sql = " and k.mfob like '" || sMfo || "'"
.head 5 +  If sNls != STRING_Null 
.head 6 +  While SalStrScan(sNls, '*') > 0
.head 7 -  Set sNls = SalStrReplaceX(sNls,SalStrScan(sNls,'*'),1,'%')
.head 6 -  Set sql = " and k.nlsb like '" || sNls || "'"
.head 5 -  Call T1.PopulateT1(sql)
.head 5 +  If T1RCount = 0
.head 6 -  Call F_DOK(0)
.head 5 -  Call SalSetFocus(T1)
.head 3 +  Function: F_ShowHide
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: flag
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If flag
.head 6 -  Call SalShowWindow( dNLS )
.head 6 -  Call SalShowWindow( dNMS )
.head 6 -  Call SalShowWindow( dGRP )
.head 6 -  Call SalShowWindow( pb_SK )
.head 6 -  Call SalShowWindow( dSK )
.head 6 -  Call SalShowWindow( dNMSK )
.head 6 -  Call SalShowWindow( pb_MFO )
.head 6 -  Call SalShowWindow( dMFOB )
.head 6 -  Call SalShowWindow( dNB )
.head 6 -  Call SalShowWindow( pb_Alien )
.head 6 -  Call SalShowWindow( dNLSB )
.head 6 -  Call SalShowWindow( dNMSB )
.head 6 -  Call SalShowWindow( dOKPOB )
.head 6 -  Call SalShowWindow( dNAZN )
.head 5 +  Else
.head 6 -  Call SalHideWindow( dNLS )
.head 6 -  Call SalHideWindow( dNMS )
.head 6 -  Call SalHideWindow( dGRP )
.head 6 -  Call SalHideWindow( pb_SK )
.head 6 -  Call SalHideWindow( dSK )
.head 6 -  Call SalHideWindow( dNMSK )
.head 6 -  Call SalHideWindow( pb_MFO )
.head 6 -  Call SalHideWindow( dMFOB )
.head 6 -  Call SalHideWindow( dNB )
.head 6 -  Call SalHideWindow( pb_Alien )
.head 6 -  Call SalHideWindow( dNLSB )
.head 6 -  Call SalHideWindow( dNMSB )
.head 6 -  Call SalHideWindow( dOKPOB )
.head 6 -  Call SalHideWindow( dNAZN )
.head 3 +  Function: F_Formula
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: formula
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: res
.head 5 -  Number: pos
.head 5 -  Number: posEnd
.head 5 -  String: list[*,1]
.head 5 -  Number: count
.head 5 -  Number: nError 
.head 5 -  Number: nType 
.head 5 -  Number: nReturn 
.head 5 -  Number: nErrorPos
.head 5 -  String: strReturn
.head 5 -  Window Handle: hWndReturn
.head 5 -  Date/Time: dtReturn
.head 4 +  Actions
.head 5 +  If SalStrScan(formula,'#(') < 0
.head 6 -  Return formula
.head 5 -  Set count = 0 
.head 5 -  Set res = formula
.head 5 +  While SalStrScan(res, '#(') >= 0
.head 6 -  Set pos = SalStrScan(res,'#(')
.head 6 -  Set posEnd = SalStrScan(res,')')
.head 6 -  Set list[count,0] = SalStrMidX(res,pos,posEnd-pos+1)
.head 6 -  Set res = VisStrSubstitute(res,list[count,0],"")
.head 6 -  Set count = count + 1
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set res = formula
.head 5 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRow )
.head 6 -  Set posEnd = 0
.head 6 +  While posEnd <= count
.head 7 +  If "#("||VisStrTrim(D1.TAG)||")" = list[posEnd,0]
.head 8 +  If D1.VALUE = STRING_Null
.head 9 -  Return ""
.head 8 -  Set res = VisStrSubstitute(res,list[posEnd,0],D1.VALUE)
.head 7 -  Set posEnd = posEnd + 1
.head 5 +  ! If SqlPrepareAndExecute(hSql(), "SELECT ROUND(" || res || ",2) INTO :pos FROM dual") and not
   SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Return ""
.head 5 -  Set nType = SalCompileAndEvaluate ( res, nError, 
				nErrorPos, nReturn, strReturn, dtReturn, hWndReturn, 
				TRUE, SalContextCurrent ( ) )

.head 5 +  If nType = EVAL_Number	
.head 6 -  Set strReturn = SalNumberToStrX ( nReturn, 2 )
.head 5 +  Else
.head 6 -  Set strReturn = ""
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( D1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRow )
.head 6 +  If D1.VAL = formula
.head 7 -  Set D1.VALUE = strReturn !Str(pos)
.head 7 -  Call DecPoint(D1)
.head 7 -  Break
.head 5 -  Return strReturn !Str(pos)
.head 3 +  Function: F_CheckFormula
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nRow2 = TBL_MinRow
.head 5 +  While SalTblFindNextRow( D1, nRow2, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRow2 )
.head 6 +  If D1.VAL != STRING_Null
.head 7 -  Call F_Formula(D1.VAL)
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPap
.head 3 -  String: strPar01
.head 3 -  String: strPar02 ! ='' нахальная печать есть , ='N' нах печати нет
.head 3 -  String: cashTag
.head 2 +  Window Variables
.head 3 -  Window Handle: hDocWdog
.head 3 -  !
.head 3 -  Number: nS
.head 3 -  Number: nK_UL
.head 3 -  Number: nK_FL
.head 3 -  Number: nVob
.head 3 -  String: sErr
.head 3 -  String: sTmp
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  : cDoc
.head 4 -  Class: cDoc_KP_nSIGN
.head 3 -  Date/Time: DatB 
.head 3 -  String: BankMfo
.head 3 -  String: BankOkpo
.head 3 -  String: AA1
.head 3 -  Number: T1RCount
.head 3 -  Number: nRow
.head 3 -  Number: nRow2
.head 3 -  Number: nCol
.head 3 -  String: sNOT
.head 3 -  Number: nTag
.head 3 -  Number: nTmp
.head 3 -  Number: nNum
.head 3 -  String: AA2
.head 3 -  Boolean: bSortOrd
.head 3 -  Boolean: bOpl
.head 3 -  Boolean: bNak
.head 3 -  Boolean: bFolder
.head 3 -  String: sLC
.head 3 -  Number: nC_TAG
.head 3 -  Number: nState
.head 3 -  String: ADR
.head 3 -  !
.head 3 -  Number: n980
.head 3 -  Number: b840
.head 3 -  Number: b978
.head 3 -  Number: b643
.head 3 -  !
.head 3 -  String: ListNd[*,6]	! Массив значений номер договора\TT\сумма\KOMF\KOMU
.head 3 -  Number: nCountListNd
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call CheckTrialVersion()
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set nNum = 0
.head 4 -  ! Set nNum = CalcKonSumKD('3807','4400373461','2426')
.head 4 -  ! Call Debug(Str(nNum))
.head 4 -  Set nKOL = 0
.head 4 -  Set bOpl = FALSE
.head 4 -  Set bFolder = FALSE
.head 4 -  Set DatB = GetBankDate()
.head 4 -  Set dDatV = DatB
.head 4 -  Set BankMfo = GetBankMfo()
.head 4 -  Set BankOkpo = GetBankOkpoS()
.head 4 -  Set sDecimal=SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 -  Set dfTextHelp = 'F4 - новая пачка; F5 - печать; F7 - оттиск; F8 - банк Б; F10 - ввод; F11 - принято;'
.head 4 -  Set lbTotal = 'Итого'
.head 4 -  Set lbNal = 'Принято'
.head 4 -  Set lbDel = 'Сдача'
.head 4 -  ! !!!	
.head 4 -  ! Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  ! !!!	
.head 4 -  If SqlPrepareAndExecute( hSql(),"SELECT kv, NOMINAL INTO :nRow, :nTmp FROM tabval where kv in (840,978,643) ")
.head 4 +  While SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If nRow = 840
.head 6 -  Set b840 = nTmp
.head 5 +  Else If nRow = 978
.head 6 -  Set b978 = nTmp
.head 5 +  Else If nRow = 643
.head 6 -  Set b643 = nTmp
.head 4 +  If sDecimal='.'
.head 5 -  Set sDecimal2=','
.head 4 +  Else
.head 5 -  Set sDecimal2='.'
.head 4 -  Set USR = GetUserId()
.head 4 -  Set S_USR = GetUserRealName()
.head 4 -  ! Вычисляем счет касы
.head 4 +  If cashTag = STRING_Null
.head 5 -  Set cashTag='CASH'
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(nvl(pul.Get_Mas_Ini_Val('KOD_TOBO'),tobopack.gettobo),1,20),
          substr(nvl(pul.Get_Mas_Ini_Val(:cashTag),tobopack.gettoboparam(:cashTag)),1,14)
   INTO :TOBO, :CASH FROM dual" ) 
and SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If TOBO = STRING_Null
.head 5 -  Set TOBO = '0'
.head 5 -  Set S_TOBO = GetBankName()
.head 4 +  Else
.head 5 -  If SqlPrepareAndExecute( hSql(),
  "SELECT name INTO :S_TOBO FROM tobo where tobo=:TOBO" ) 
and SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If CASH = STRING_Null
.head 5 -  If SqlPrepareAndExecute( hSql(),"select val into :CASH from tobo_params where tobo=:TOBO and tag=:cashTag ") and SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If CASH = STRING_Null
.head 5 -  Call SalMessageBox("Невозможно определить счет касы пользователя ",
Str(USR)||' '||S_USR , MB_IconStop)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT nms 
   INTO :S_CASH 
   FROM accounts  
   WHERE kv=:n980 and nls=:CASH " )
and SqlFetchNext( hSql(), nFetchRes ) 
.head 4 -  ! Операции обмена ВАЛ
.head 4 -  Set AA1 = STRING_Null
.head 4 -  Set AA2 = STRING_Null
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(nvl(pul.Get_Mas_Ini_Val('AA1'),tobopack.gettoboparam('AA1')),1,3),
          substr(nvl(pul.Get_Mas_Ini_Val('AA2'),tobopack.gettoboparam('AA2')),1,3)
   INTO :AA1, :AA2 FROM dual" ) 
and SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If AA1 = STRING_Null
.head 5 -  Set AA1 = 'AA1'
.head 4 +  If AA2 = STRING_Null
.head 5 -  Set AA2 = 'AA2'
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :ADR FROM PARAMS WHERE par='ADDRESS' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Call F_Detail( FALSE )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalDisableWindow( dGRP )
.head 4 -  Call T1.PopulateT1('')
.head 4 -  Call F_New(TRUE)
.head 4 -  Call SalSetFocus(T1)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 3 +  On SAM_Close
.head 4 +  If SalMessageBox ('Закрыть окно ввода?','Внимание', MB_YesNo) = IDNO
.head 5 -  Return FALSE
.head 1 +  Dialog Box: dlg_Folder
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  8.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.976"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Содержание папки
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblFolderList
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.238"
.head 6 -  Width:  8.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 4096
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: INUSE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Исп
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On VTM_KeyUp
.head 8 +  If wParam = VK_Space
.head 9 -  Set INUSE = not INUSE
.head 7 +  On SAM_Validate
.head 8 -  Call frmKP.DecPoint(hWndItem)
.head 5 +  Column: RowNum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblPopulate(tblFolderList, hSql(), T(
"SELECT rownum,d.name, d.sum,d.nd,d.tt,d.nak
 FROM kp_log_nd l ,kp_deal d
 INTO :tblFolderList.RowNum, :tblFolderList.NAME, :tblFolderList.SUM,:tblFolderList.ND,:tblFolderList.TT,:tblFolderList.NAK
 WHERE l.nd=d.nd and l.log=:LG 
 ORDER BY rownum,l.nd" ), TBL_FillAll)
.head 6 -  !
.head 6 -  Call SalTblSetRow ( tblFolderList, 1 )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Set nOrderBy = 1
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nOrderBy )
.head 6 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On UM_FetchRowDone
.head 6 -  Call SalTblSetCellTextColor( tblFolderList.SUM,  COLOR_Red, TRUE )
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Space
.head 7 -  Set INUSE = not INUSE
.head 7 +  ! If INUSE
.head 8 -  Call SalTblSetFocusCell ( hWndForm, tblFolderList.RowNum - 1, tblFolderList.SUM, 0, -1 )
.head 6 +  If wParam = VK_Insert
.head 7 -  Call SalTblSetFocusRow( tblFolderList, tblFolderList.RowNum - 1 )
.head 7 -  Call SalTblSetFocusCell ( hWndForm, tblFolderList.RowNum - 1, tblFolderList.SUM, 0, -1 )
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ввести
.head 4 -  Window Location and Size
.head 5 -  Left:   2.683"
.head 5 -  Top:    4.107"
.head 5 -  Width:  1.543"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.512"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  Set frmKP.nCountListNd = 0
.head 6 +  While SalTblFindNextRow(tblFolderList, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(tblFolderList, nRow)
.head 7 +  If tblFolderList.INUSE
.head 8 -  Set frmKP.ListNd[nCountListNd,0] = Str(tblFolderList.ND)
.head 8 -  Set frmKP.ListNd[nCountListNd,1] = tblFolderList.TT
.head 8 -  Set frmKP.ListNd[nCountListNd,2] = SalNumberToStrX(tblFolderList.SUM,4)
.head 8 -  If SqlPrepareAndExecute( hSql(), 
"SELECT Bars.KP_Kom(:tblFolderList.ND,:tblFolderList.SUM,0),Bars.KP_Kom(:tblFolderList.ND,:tblFolderList.SUM,1) 
 INTO :frmKP.ListNd[nCountListNd,3],:frmKP.ListNd[nCountListNd,4] from dual" )
and SqlFetchNext( hSql(), nFetchRes ) 
.head 8 +  Else
.head 9 -  Set frmKP.ListNd[nCountListNd,3] = '0'
.head 9 -  Set frmKP.ListNd[nCountListNd,4] = '0'
.head 8 -  Set frmKP.ListNd[nCountListNd,5] = Str( tblFolderList.NAK )
.head 8 -  Set nCountListNd = nCountListNd + 1
.head 6 +  If frmKP.nCountListNd = 0
.head 7 -  Call SalEndDialog(dlg_Folder, FALSE)
.head 6 -  Call SalEndDialog(dlg_Folder, TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSendMsg( pbSave, SAM_Click, 0, 0 ) 
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    4.107"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.512"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(dlg_Folder, FALSE)
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 50054
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.06"
.head 5 -  Width:  8.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.595"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  7.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: F1 - принять,Insert - установить сумму, Space - выбрать
F2-выделить все
.head 4 -  Resource Id: 39677
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.66"
.head 5 -  Width:  8.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: cbSelAll
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.12"
.head 5 -  Top:    -0.048"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\CHEKIN.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выделить все'
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblFolderList, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(tblFolderList, nRow)
.head 7 +  If not tblFolderList.INUSE
.head 8 -  Set tblFolderList.INUSE = TRUE
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: LG
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT name into :dName from kp_log where log=:LG" )
and not SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Call SalSetWindowText ( hWndForm, 'Содержание пачки №'|| Str(LG) )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 4 -  Call SalTblSetFocusRow(tblFolderList,0)
