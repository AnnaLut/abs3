Application Description: Библиотека, выполняющая защищенную активацию ролей в АБС
		(С) УНИТИ-БАРС 2005
		Автор: Малышев Иван
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000A50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001E443A 5C4241525339385C 4C4942524152595C 524F4C4541555448
0020: 2E6578651E443A5C 4241525339385C4C 4942524152595C52 4F4C45415554482E
0040: 646C6C1E443A5C42 41525339385C4C49 42524152595C524F 4C45415554482E61
0060: 706300000101011E 443A5C4241525339 385C4C4942524152 595C524F4C454155
0080: 54482E72756E1E44 3A5C424152533938 5C4C494252415259 5C524F4C45415554
00A0: 482E646C6C1E443A 5C4241525339385C 4C4942524152595C 524F4C4541555448
00C0: 2E61706300000101 01185C4241525339 385C42494E5C524F 4C45415554482E41
00E0: 5044185C42415253 39385C42494E5C52 4F4C45415554482E 646C6C185C424152
0100: 5339385C42494E5C 524F4C4541555448 2E61706300000101 011E443A5C424152
0120: 5339385C4C494252 4152595C524F4C45 415554482E61706C 1E443A5C42415253
0140: 39385C4C49425241 52595C524F4C4541 5554482E646C6C1E 443A5C4241525339
0160: 385C4C4942524152 595C524F4C454155 54482E6170630000 010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
		Resources
		Variables
			Boolean: bRoleAuthFlagInited	! Флаг инициализаци флага включения аутентификации ролей
			Boolean: bRoleAuthEnabled	! Флаг включения аутентификации ролей
		Internal Functions
			Function: SetRole        ! __exported
				Description:
				Returns
				Parameters
					Sql Handle: hSql
					String: sRoleName
				Static Variables
				Local variables
					String: sAuthParamVal
					String: sIntData
					String: sEncData
					String: sPass
					Number: nFetchRes
				Actions
					If NOT bRoleAuthFlagInited
						Set bRoleAuthFlagInited=TRUE
						Set bRoleAuthEnabled=FALSE
						If SqlPrepareAndExecute( hSql, "SELECT VAL INTO :sAuthParamVal FROM PARAMS WHERE PAR='ROLEAUTH'")
							If SqlFetchNext( hSql, nFetchRes )
								If sAuthParamVal='1'
									Set bRoleAuthEnabled=TRUE
					If bRoleAuthEnabled
						If SqlPrepareAndExecute(hSql, "SELECT SUBSTR(BARS_ROLE_AUTH.GET_ROLE_DATA(:sRoleName),1,100) INTO :sIntData FROM DUAL")
							If SqlFetchNext( hSql, nFetchRes )
								Call SqlClose( hSql )
								If sIntData
									Set sPass='-B857^H!3D#uL3_Ke$(!s)*S'
									If SqlPrepareAndExecute(hSql, "SELECT SUBSTR(BARS_ROLE_AUTH.INTERNAL_(:sIntData, :sPass),1,100) INTO :sEncData FROM DUAL")
										Call SqlClose( hSql )
										Call SqlFetchNext( hSql, nFetchRes )
										Call SqlClose( hSql )
								Call SqlClose( hSql )
								! Call SqlPrepareAndExecute(hSql, "BEGIN BARS_ROLE_AUTH.SET_ROLE_BY_DATA(:sEncData); END;")
								Call SqlOraPLSQLPrepare( hSql, "BEGIN BARS_ROLE_AUTH.SET_ROLE_BY_DATA(:sEncData); END;" )
								Call SqlOraPLSQLExecute( hSql )
								Call SqlClose( hSql )
							Else
								Call SqlClose( hSql )
						Else
							Call SqlClose( hSql )
					Else
						Call SqlPrepareAndExecute(hSql, 'BEGIN BARS_ROLE_AUTH.SET_ROLE(:sRoleName); END;')
		Named Menus
		Class Definitions
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
