.head 0 +  Application Description: Работа со счетами в кредитном модуле
05-04-99  (MIK)
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000D20000 002C000000020000 0003000000000000 0082020000FCFFFF
0040: FFE4FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730C6672
0080: 6D4F704B72656441 6363
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Docfun3.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 -  Resources
.head 2 -  Variables
.head 2 +  Internal Functions
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 425789015
0000: F400000090000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F1A003C00 00046300446F6338
0040: 0000000279000001 F00D000000FF9F0D 00DC000100FF7F01 0080220000000100
0060: 0000000A6347656E 4669006C74657274 000000F004000000 C80204000001FE00
0080: C18001000000BF04 B100010D00FFFFE0 1100000002FE00FF 831500000001FB00
00A0: FF0F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbSwitch
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Table Window: frmOpKredAcc
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.0"
.head 4 -  Top:    0.01"
.head 4 -  Width:  13.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.988"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47007
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47008
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47009
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTipN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 30
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер счета
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsValidInteger(hWndItem)
.head 7 -  Call SalMessageBox("Нецифра в номере счета",
     "Ошибка", MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set colNls = KeyAccount(sBankMfo, colNls)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colLcv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsValidInteger(hWndItem)
.head 7 -  Set sTmp = 'kv'
.head 6 +  Else
.head 7 -  Set sTmp = 'lcv'
.head 7 -  Set colLcv = SalStrUpperX(colLcv)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
       SELECT kv,lcv
       INTO :colKv,:colLcv
       FROM tabval
       WHERE " || sTmp || "=:colLcv")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox("Не найден код валюты " ||
     colLcv, 'Ошибка', MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFlOp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Откр
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 5
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Внетренний
№ счета
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDapp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
движения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDaos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
открытия
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOrd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Порядок
сортировки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nNd
.head 3 -  String: CC_ID
.head 3 -  String: sGr
.head 2 +  Window Variables
.head 3 -  String: sErrTxt
.head 3 -  String: sNlsSN
.head 3 -  String: sNlsSD
.head 3 -  String: sNlsSN8
.head 3 -  String: sNlsSD8
.head 3 -  String: sNbs
.head 3 -  String: sLcv
.head 3 -  Number: nAcc
.head 3 -  Number: nId
.head 3 -  Date/Time: dDat
.head 3 -  Number: nPap
.head 3 -  ! Для таблицы INT_RATES
.head 3 -  Number: nIr_C
.head 3 -  Number: nIr_D
.head 3 -  ! Для таблицы INT_ACC
.head 3 -  Number: nMetr
.head 3 -  Number: nBaseM
.head 3 -  Number: nBaseY
.head 3 -  Number: nFreq
.head 3 -  Boolean: bRat
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  Number: nRnk
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  Number: mMetr[*]
.head 3 -  Number: mBaseY[*]
.head 3 -  Number: mBaseM[*]
.head 3 -  Number: mFreq[*]
.head 3 -  !
.head 3 -  String: sFnls
.head 3 -  String: sSour
.head 3 -  Number: nKvD
.head 3 -  String: sBankMfo
.head 3 -  Date/Time: mdate
.head 3 -  Number: nAim
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set frmOpKredAcc.strPrintFileName = 'DNLS'
.head 4 -  ! Call SalDisableWindow(hPb)
.head 4 -  Set nFlags = GT_NoIns | GT_NoDel
.head 4 -  Set nId = GetUserId()
.head 4 -  Set dDat = GetBankDate()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT d.rnk,a.sour,a.kv,t.lcv,d.wdate,a.aim
     INTO :nRnk,:sSour,:nKvD,:sLcv,:mdate,:nAim
     FROM cc_deal d, cc_add a, tabval t 
     WHERE a.nd=d.nd and a.adds=0 and d.nd=:nNd and
           a.kv=t.kv")
.head 4 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox('Не найден договор №' ||
     SalNumberToStrX(nNd,0), 'Ошибка',
     MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Return FALSE
.head 4 -  Set sFnls = 'N/A'
.head 4 -  Set sFnls = "'" || sFnls || "'"
.head 4 -  Set strSqlPopulate = "
    SELECT t.ord,t.tip,t.name,a.nls,a.kv,v.lcv,1,a.acc,
           a.ostc/100,a.dos/100,a.kos/100,a.dapp,a.daos,
           acrN.fprocN(a.acc,0)
    INTO :frmOpKredAcc.colOrd,:frmOpKredAcc.colTip,
         :frmOpKredAcc.colTipN,:frmOpKredAcc.colNls,
         :frmOpKredAcc.colKv,:frmOpKredAcc.colLcv,
         :frmOpKredAcc.colFlOp,:frmOpKredAcc.colAcc,
         :frmOpKredAcc.colOstc,:frmOpKredAcc.colDos,
         :frmOpKredAcc.colKos,:frmOpKredAcc.colDapp,
         :frmOpKredAcc.colDaos,:frmOpKredAcc.colRat
    FROM accounts a, nd_acc n, tips t, tabval v
    WHERE n.nd=:frmOpKredAcc.nNd and a.acc=n.acc and
          a.tip=t.tip and a.kv=v.kv
    UNION ALL
    SELECT t.ord,t.tip,t.name,'N/A',0,'',0,0,0,
           0,0,to_date(null),to_date(null),to_number(null)
    FROM tips t
    WHERE t.tip not in (
    SELECT a.tip
    FROM accounts a,nd_acc n
    WHERE a.acc=n.acc and n.nd=:frmOpKredAcc.nNd) and
          t.tip in ( 
    SELECT s.tip
    FROM vidd_tip s, cc_deal d
    WHERE d.vidd=s.vidd and d.nd=:frmOpKredAcc.nNd)
    ORDER BY 1 "
.head 4 -  Set strSqlDelete = "
    DELETE
    FROM nd_acc
    WHERE nd=:frmOpKredAcc.nNd and
          acc=:frmOpKredAcc.colAcc"
.head 4 -  Call SalSetWindowText(hWndForm,
     'Счета по кредитному договору ' || CC_ID ||
     ' Реф КД ' || Str(nNd))
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Update
.head 4 -  Set nRow = TBL_MinRow
.head 4 -  Set sErrTxt = ''
.head 4 +  While SalTblFindNextRow(hWndForm, nRow,
      ROW_New | ROW_Edited, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 +  If not Op_Reg(1, nNd, nTmp, nTmp, nTmp, nRnk, colNls,
              colKv, colTipN || ' по кред.Дог.№'||Str(nNd),colTip, nId,nAcc)
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalMessageBox('Невозможно откыть счет ' ||
     colNls, 'Ошибка', MB_IconExclamation)
.head 6 -  Break
.head 5 +  Else
.head 6 -  Call SqlPrepareAndExecute(hSql(),
"UPDATE accounts
 SET grp=NVL(grp,"||sGr||"), tip=:colTip" ||
         IifS( Val(Subs(colNls,1,1))<5,",mdate=:mdate","") || " WHERE acc=:nAcc")
.head 5 -  Set colFlOp = 1
.head 4 -  Call SqlCommit(hSql())
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On UM_DoubleClick
.head 4 +  If colTip = 'SS ' 
.head 5 -  Call SetProcParN(colAcc, colKv, sNlsSN, sNlsSD)
.head 4 +  Else If colTip = 'SP ' 
.head 5 -  Call SetProcParN(colAcc, colKv, sNlsSN8, sNlsSD8)
.head 4 +  Else If colTip = 'SL '
.head 5 -  Call SetProcParN(colAcc, colKv, '', '')
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On SAM_TblDoDetails
.head 4 +  If colFlOp
.head 5 -  Call SalEnableWindow(pbDetails)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbDetails)
.head 3 +  On SAM_Destroy
.head 4 -  ! Call SalEnableWindow(hPb)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If colTip = 'SS '
.head 5 -  Set sNbs = SalStrLeftX(colNls, 4)
.head 5 +  If sNbs = 'N/A' or sNbs = ''
.head 6 +  If SqlPrepareAndExecute(hSqlAux(), "
     SELECT nbs
     INTO :sNbs
     FROM cc_aim
     WHERE aim=:nAim")
.head 7 +  If not SqlFetchNext(hSqlAux(), nFetchRes) 
.head 8 -  Set sNbs =  '9999'
.head 4 -  !
.head 4 +  If colTip = 'SD '
.head 5 -  Set sNlsSD = colNls
.head 4 +  If colTip = 'SN '
.head 5 -  Set sNlsSN = colNls
.head 4 +  If colTip = 'SD8'
.head 5 -  Set sNlsSD8 = colNls
.head 4 +  If colTip = 'SN8'
.head 5 -  Set sNlsSN8 = colNls
.head 4 +  If colNls = 'N/A'
.head 5 +  If SqlPrepareAndExecute(hSqlAux(), "
     SELECT bars.f_nls(:sNbs," || Str(nRnk) || "," ||
            sSour || "," || Str(nNd) || "," || Str(nKvD)
            ||", :colTip)
     INTO :sTmp
     FROM dual")
.head 6 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 +  If SalStrLeftX(sTmp, 2) = '99'
.head 8 -  Set colNls = '????0' || SalStrMidX(sTmp, 5,
    SalStrLength(sTmp)-5)
.head 7 +  Else
.head 8 -  Set colNls = sTmp
.head 5 +  If colFlOp = 0
.head 6 +  If SalStrLeftX(colTip, 2) = 'SD' and colTip != 'SD8'
.head 7 -  Set colKv = 980
.head 7 -  Set colLcv = 'UAH'
.head 6 +  Else
.head 7 -  Set colKv = nKvD
.head 7 -  Set colLcv = sLcv
.head 4 -  Call SalTblSetCellTextColor(colOstc, IifN(colOstc<0,
     COLOR_Red, COLOR_Blue), TRUE)
.head 4 -  Set colOstc = SalNumberAbs(colOstc)
.head 1 +  ! cGenericTable: frmOpZalAcc
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Базовая таблица
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.438"
.head 4 -  Top:    0.49"
.head 4 -  Width:  12.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.75"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? No
.end
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.615"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Contents 
.head 4 +  ! Combo Box: cmbNomDogZal
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.186"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.094"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? No
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 5 +  List Initialization 
.head 6 -  Text: Новый
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT MIN(ndz)
     INTO :nNdz
     FROM cc_accp
     WHERE nd=:nNd")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set nNdz = NUMBER_Null
.head 7 -  Call SalSendMsg(hWndItem, UM_Populate, 0, 0)
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nTmp = SalListQuerySelection(hWndItem)
.head 7 +  If nTmp > 0
.head 8 -  Set nNdz = SalStrToNumber(
    SalListQueryTextX(hWndItem, nTmp))
.head 7 +  Else 
.head 8 -  Set nNdz = NUMBER_Null
.head 7 -  Call SalSendMsg(cmbZalogodatel, SAM_Create, 0, 0)
.head 6 +  On UM_Populate
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     SELECT ndz
     FROM cc_accp
     WHERE nd=:nNd
     GROUP by ndz
     ORDER by ndz"))
.head 7 -  Call SalListInsert(hWndItem, 0, 'Новый')
.head 7 +  If nNdz
.head 8 -  Set sTmp = SalNumberToStrX(nNdz, 0)
.head 7 +  Else 
.head 8 -  Set sTmp = 'Новый'
.head 7 -  Call SalListSetSelect(hWndItem,
     SalListSelectString(hWndItem, 0, sTmp))
.head 4 +  ! Combo Box: cmbZalogodatel
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.743"
.head 6 -  Top:    0.385"
.head 6 -  Width:  4.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.76"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? No
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 5 -  List Initialization 
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If nNdz
.head 8 -  Set sSql = "
    SELECT nmk,rnk
    INTO :sTmp,:nRnk
    FROM customer
    WHERE rnk in (
    SELECT rnk
    FROM cc_accp
    WHERE nd=:nNd and ndz=:nNdz
    GROUP by rnk)
    ORDER by nmk"
.head 7 +  Else 
.head 8 -  Set sSql = "
    SELECT nmk,rnk
    INTO :sTmp,:nRnk
    FROM customer
    ORDER by nmk"
.head 7 -  Call SqlPrepareAndExecute(hSql(), sSql)
.head 7 -  Set nTmp = 0
.head 7 -  Call SalArraySetUpperBound(mRnk, 1, -1)
.head 7 -  Call SalListClear(hWndItem)
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalListAdd(hWndItem, sTmp)
.head 8 -  Set mRnk[nTmp] = nRnk
.head 8 -  Set nTmp = nTmp+1
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nTmp = SalListQuerySelection(hWndItem)
.head 7 +  If nTmp >= 0
.head 8 -  Set nRnk = mRnk[nTmp]
.head 8 -  Set dRNKZ = nRnk
.head 7 +  Else 
.head 8 -  Set nRnk = 0
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  ! Background Text: Зал.дог №
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.129"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 +  ! Data Field: dRNKZ
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.457"
.head 7 -  Top:    0.375"
.head 7 -  Width:  1.257"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.262"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Validate
.head 7 -  Set cmbZalogodatel = GetValueStr("
    SELECT nmk
    FROM customer
    WHERE rnk=" || Str(dRNKZ))
.head 7 -  Set nRnk = dRNKZ
.head 7 -  Return VALIDATE_Ok
.head 6 +  ! On SAM_SetFocus
.head 7 -    Set nKlientRnk = colKlientRnk
.head 4 +  ! Data Field: dOKPOZ
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.186"
.head 7 -  Top:    0.365"
.head 7 -  Width:  1.257"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.262"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Validate
.head 7 -  Set cmbZalogodatel = GetValueStr("
    SELECT nmk
    FROM customer
    WHERE rnk=" || Str(dRNKZ))
.head 7 -  Set nRnk = dRNKZ
.head 7 -  Return VALIDATE_Ok
.head 6 +  ! On SAM_SetFocus
.head 7 -    Set nKlientRnk = colKlientRnk
.head 4 +  ! Data Field: dZalogodatel
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.743"
.head 7 -  Top:    0.115"
.head 7 -  Width:  4.086"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Validate
.head 7 -  Set cmbZalogodatel = GetValueStr("
    SELECT nmk
    FROM customer
    WHERE rnk=" || Str(dRNKZ))
.head 7 -  Set nRnk = dRNKZ
.head 7 -  Return VALIDATE_Ok
.head 6 +  ! On SAM_SetFocus
.head 7 -    Set nKlientRnk = colKlientRnk
.head 4 +  Pushbutton: pbIns
.winattr
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDel
.winattr
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbRefresh
.winattr
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbUpdate
.winattr
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.071"
.head 6 -  Begin Y:  -0.031"
.head 6 -  End X:  4.071"
.head 6 -  End Y:  0.427"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbSearch
.winattr
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDetails
.winattr
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  ! On SAM_Create
.head 7 -  Set strTip = 'Документ по учету залога'
.head 6 +  ! On SAM_Click
.head 7 -  Set nTmp = SalStrToNumber(GetValueStr("
    SELECT max(ref)
    FROM opldok
    WHERE acc=" || Str(colAcc) || " and tt='ZAL' and
          dk=1"))
.head 7 -  Call DocViewContentsEx(hWndMDI, nTmp)
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pb2
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Паспорт клиента-залогодателя'
.head 6 +  On SAM_Click
.head 7 -  Set nTmp = SalStrToNumber(GetValueStr("
    SELECT custtype
    FROM customer
    WHERE rnk=" || Str(colRnk)))
.head 7 +  If nTmp = 2
.head 8 -  Call EditCustCorps(colRnk,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 7 +  Else If nTmp = 3
.head 8 -  Call EditCustPerson(colRnk,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 7 +  Else If nTmp = 1
.head 8 -  Call EditCustBanks(colRnk,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 4 +  Pushbutton: pbFilter
.winattr
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.471"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: dCC_ID
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.271"
.head 7 -  Top:    0.135"
.head 7 -  Width:  1.371"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: dNMK
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.686"
.head 7 -  Top:    0.135"
.head 7 -  Width:  4.571"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Column: colNdz
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
договора
залога
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colRnk
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег №
залого-
дателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: Zalogodatel
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залогодатель
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.629"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 +  Message Actions 
.head 5 +  On SAM_DoubleClick
.head 6 +  If colNdz = NUMBER_Null
.head 7 -  Set sTmp=Str(colRnk)
.head 7 -  Call FunNSIGet('CUSTOMER','NMK',sTmp,Zalogodatel)
.head 7 -  Set colRnk=Val(sTmp)
.head 3 +  Column: colVidZal
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид залога
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.314"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT name,pawn
     INTO :sTmp,:nPawn
     FROM cc_pawn
     ORDER by pawn"))
.head 6 -  Set nTmp = 0
.head 6 -  Call SalArraySetUpperBound(mPawn, 1, -1)
.head 6 -  Call SalListClear(hWndItem)
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalListAdd(hWndItem, sTmp)
.head 7 -  Set mPawn[nTmp] = nPawn
.head 7 -  Set nTmp = nTmp+1
.head 5 +  On SAM_Validate
.head 6 -  Set nTmp = SalListQuerySelection(hWndItem)
.head 6 +  If nTmp >= 0
.head 7 -  Set colPawn = mPawn[nTmp]
.head 6 +  Else 
.head 7 -  Set colPawn = 0
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colMestoZal
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Местонахождение залога
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.157"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT name,mpawn
     INTO :sTmp,:nPawnM
     FROM cc_mpawn
     ORDER by mpawn"))
.head 6 -  Set nTmp = 0
.head 6 -  Call SalArraySetUpperBound(mPawnM, 1, -1)
.head 6 -  Call SalListClear(hWndItem)
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalListAdd(hWndItem, sTmp)
.head 7 -  Set mPawnM[nTmp] = nPawnM
.head 7 -  Set nTmp = nTmp+1
.head 5 +  On SAM_Validate
.head 6 -  Set nTmp = SalListQuerySelection(hWndItem)
.head 6 +  If nTmp >= 0
.head 7 -  Set colPawnM = mPawnM[nTmp]
.head 6 +  Else 
.head 7 -  Set colPawnM = 0
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colSumZal
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма залога
+ Добавить
 - Уменьшить 
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.714"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsValidDecimal(hWndItem, 15, 2)
.head 7 -  Call SalMessageBox("Неверный формат суммы",
     "Ошибка", MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: colNls
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsValidInteger(hWndItem)
.head 7 -  Call SalMessageBox("Нецифра в номере счета",
     "Ошибка", MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set colNls = KeyAccount(sBankMfo, colNls)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 +  If colNdz = NUMBER_Null
.head 7 +  If SqlPrepareAndExecute(hSqlAux(),
"SELECT s_cc_accp.NEXTVAL INTO :colNdz FROM dual") 
.head 8 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 6 +  If SalIsNull(colNls)
.head 7 +  If SqlPrepareAndExecute(hSqlAux(),
  "SELECT bars.f_nls('',:colRnk,:colPawnM,:colNdz, :colPawn,'ZAL')
   INTO :colNls FROM dual")
.head 8 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 3 +  Column: colValZal
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 +  If SalIsValidInteger(hWndItem)
.head 7 -  Set sTmp = 'kv'
.head 6 +  Else 
.head 7 -  Set sTmp = 'lcv'
.head 7 -  Set colValZal = SalStrUpperX(colValZal)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT kv,lcv
     INTO :colKv,:colValZal
     FROM tabval
     WHERE " || sTmp || "=:colValZal")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox("Не найден код валюты " ||
     colValZal, 'Ошибка', MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colAcc
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № счета
внутр
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colPawn
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
залога
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colPawnM
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код места
залога
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colKv
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код 
валюты
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colFL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Флаг
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 2 -  Functions 
.head 2 +  Window Parameters 
.head 3 -  ! Window Handle: hPb
.head 3 -  Number: nNd
.head 3 -  String: CC_ID
.head 3 -  String: sRNK
.head 2 +  Window Variables 
.head 3 -  !
.head 3 -  String: sTmp
.head 3 -  String: sSql
.head 3 -  Number: nTmp
.head 3 -  Number: nId
.head 3 -  Date/Time: dDat
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRnk
.head 3 -  Number: mRnk[*]
.head 3 -  ! Number: nNdz
.head 3 -  Number: nPawn
.head 3 -  Number: mPawn[*]
.head 3 -  Number: nPawnM
.head 3 -  Number: mPawnM[*]
.head 3 -  Number: nKv
.head 3 -  Number: mKv[*]
.head 3 -  String: sBankMfo
.head 3 -  String: sNaz
.head 3 -  : cDoc
.winattr class
.head 4 -  Class: cDoc
.end
.head 3 -  String: sNlsK
.head 3 -  Number: nDk
.head 3 -  Number: nAcc
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  ! Call SalDisableWindow(hPb)
.head 4 -  Set frmOpZalAcc.strPrintFileName = 'DZal'
.head 4 -  Set nFlags = GT_NoDel
.head 4 -  ! Set nNdz = NUMBER_Null
.head 4 -  Set nId = GetUserId()
.head 4 -  Set dDat = GetBankDate()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Set dCC_ID=CC_ID
.head 4 +  If SqlPrepareAndExecute(hSql(), 
"SELECT t.nlsm, c.NMK INTO :sNlsK, :dNMK 
 FROM tts t, customer c WHERE t.tt='ZAL' and c.rnk="||sRNK)
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox('Не описана операция ZAL' ||
     SalNumberToStrX(nNd, 0), 'Ошибка',
     MB_IconExclamation)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 6 -  Return FALSE
.head 4 -  Call SalSetWindowText(hWndForm,
     'Залоги по кредитному договору ' || CC_ID ||
     ' Реф.КД ' || SalNumberToStrX(nNd, 0))
.head 4 -  Set strSqlPopulate = "
    SELECT 1,a.acc,a.nls,a.kv,t.lcv,a.ostc/100,p.mpawn,
           m.name,p.pawn,v.name,p.ndz,p.rnk, c.nmk
    FROM accounts a, cc_accp p, cc_mpawn m,cc_pawn v,
         tabval t, customer c
    WHERE a.acc=p.acc and a.kv=t.kv and
          p.mpawn=m.mpawn and p.pawn=v.pawn and
          p.nd=:frmOpZalAcc.nNd and c.rnk=p.rnk           
    INTO :frmOpZalAcc.colFL,:frmOpZalAcc.colAcc,
         :frmOpZalAcc.colNls,:frmOpZalAcc.colKv,
         :frmOpZalAcc.colValZal,:frmOpZalAcc.colSumZal,
         :frmOpZalAcc.colPawnM,:frmOpZalAcc.colMestoZal,
         :frmOpZalAcc.colPawn,:frmOpZalAcc.colVidZal,
         :frmOpZalAcc.colNdz,:frmOpZalAcc.colRnk,:frmOpZalAcc.Zalogodatel "
.head 4 -  ! Set strSqlPopulate = "
    SELECT 1,a.acc,a.nls,a.kv,t.lcv,a.ostc/100,p.mpawn,
           m.name,p.pawn,v.name,p.ndz,p.rnk
    FROM accounts a, cc_accp p, cc_mpawn m,cc_pawn v,
         tabval t 
    WHERE a.acc=p.acc and a.kv=t.kv and
          p.mpawn=m.mpawn and p.pawn=v.pawn and
          p.nd=:frmOpZalAcc.nNd and
          p.ndz=:frmOpZalAcc.nNdz and
          p.rnk=:frmOpZalAcc.nRnk
    INTO :frmOpZalAcc.colFL,:frmOpZalAcc.colAcc,
         :frmOpZalAcc.colNls,:frmOpZalAcc.colKv,
         :frmOpZalAcc.colValZal,:frmOpZalAcc.colSumZal,
         :frmOpZalAcc.colPawnM,:frmOpZalAcc.colMestoZal,
         :frmOpZalAcc.colPawn,:frmOpZalAcc.colVidZal,
         :frmOpZalAcc.colNdz,:frmOpZalAcc.colRnk"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Update
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow,
          ROW_New | ROW_Edited, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 +  If Op_Reg(2, nNd, colPawn, colPawnM, colNdz, colRnk, colNls,
          colKv, 'Залог по кр.дог. ' || CC_ID ||
          ' Реф.КД ' || SalNumberToStrX(nNd, 0), 'ZAL',
          nId, nAcc)
.head 6 -  Set sTmp = SalNumberToStrX(nNd, 0) || '/' ||
    SalNumberToStrX(colNdz, 0)
.head 6 -  Set nTmp = colSumZal * 100
.head 6 +  If nTmp > 0
.head 7 -  Set nDk = 1
.head 7 -  Set sNaz = 'Внесение'
.head 6 +  Else 
.head 7 -  Set nDk = 0
.head 7 -  Set nTmp = -nTmp
.head 7 -  Set sNaz = 'Возврат'
.head 6 -  Set sNaz = sNaz || ' залога по КД №' || CC_ID ||
    ' Реф.КД ' || sTmp || '.' || colVidZal || '.' ||
    colMestoZal || '.'
.head 6 -  Call cDoc.SetDoc(0, 'ZAL', nDk, 6, 'ZAL' || sTmp,
     dDat, dDat, dDat, dDat, sNlsK, GetBankName(),
     GetBankMfo(), '', colKv, nTmp, '', colNls,
     Zalogodatel, GetBankMfo(), '', colKv, nTmp,
     '', sNaz, '' , GetIdOper(), '', 0,0)
.head 6 +  If cDoc.oDoc()
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else 
.head 7 -  Call SqlRollback(hSql())
.head 5 +  Else 
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalMessageBox('Невозможно откыть счет залога ' || 
     colNls, 'Ошибка', MB_IconExclamation)
.head 4 -  ! Call SalSendMsg(cmbNomDogZal, UM_Populate, 0, 0)
.head 4 -  ! Call SalListPopulate(hWndItem, hSql(), T("
     SELECT ndz
     FROM cc_accp
     WHERE nd=:nNd
     GROUP by ndz
     ORDER by ndz"))
.head 4 -  ! Call SalListInsert(hWndItem, 0, 'Новый')
.head 4 +  ! If nNdz
.head 5 -  Set sTmp = SalNumberToStrX(nNdz, 0)
.head 4 +  ! Else 
.head 5 -  Set sTmp = 'Новый'
.head 4 -  ! Call SalListSetSelect(hWndItem,
     SalListSelectString(hWndItem, 0, sTmp))
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  ! Call SalEnableWindow(hPb)
