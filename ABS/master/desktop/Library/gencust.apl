.head 0 +  Application Description: Centura Builder starter application
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B30000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 00000000001B5C42 41525339385C4C49 42524152595C6765 6E637573742E6578
0020: 651B5C4241525339 385C4C4942524152 595C67656E637573 742E646C6C1B5C42
0040: 41525339385C4C49 42524152595C6765 6E637573742E6170 6300000101011D43
0060: 3A5C424152533938 5C4C494252415259 5C67656E63757374 2E72756E1D433A5C
0080: 4241525339385C4C 4942524152595C67 656E637573742E64 6C6C1D433A5C4241
00A0: 525339385C4C4942 524152595C67656E 637573742E617063 00000101011D433A
00C0: 5C4241525339385C 4C4942524152595C 67656E637573742E 6170641D433A5C42
00E0: 41525339385C4C49 42524152595C6765 6E637573742E646C 6C1D433A5C424152
0100: 5339385C4C494252 4152595C67656E63 7573742E61706300 000101011D433A5C
0120: 4241525339385C4C 4942524152595C67 656E637573742E61 706C1D433A5C4241
0140: 525339385C4C4942 524152595C67656E 637573742E646C6C 1D433A5C42415253
0160: 39385C4C49425241 52595C67656E6375 73742E6170630000 010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: global.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  File Include: GENLABEL.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  ! Параметры клиента
.head 4 -  String: REL_RELATIONS = 'REL'
.head 4 -  String: REL_DOCTYPE   = 'DOCTYPE'
.head 4 -  String: REL_CUSTTYPE  = 'CUSTTYPE'
.head 4 -  String: REL_OKPO      = 'OKPO'
.head 4 -  String: REL_COUNTRY   = 'COUNTRY'
.head 4 -  String: REL_REGION    = 'REGION'
.head 4 -  String: REL_FS        = 'FS'
.head 4 -  String: REL_VED       = 'VED'
.head 4 -  String: REL_SED       = 'SED'
.head 4 -  String: REL_ISE       = 'ISE'
.head 4 -  String: TRUSTEE_TYPEID         = 'TYPEID'
.head 4 -  String: TRUSTEE_DOCUMENTTYPEID = 'DOCUMENTTYPEID'
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  Boolean: fCustLangInit
.head 2 +  Internal Functions
.head 3 +  Function: GenCust_Init
.head 4 -  Description: Инициализация лингвистической таблицы и прочего для библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fCustLangInit
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\gencust.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFileSpecial(strFileName, strLangId, "", TRUE))
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustRekv',          'Не заполнен реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustRekvUnCorrect', 'Некорректно заполнен реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustNmk',           'Наименование клиента (нац)')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustNmkv',          'Наименование клиента (межд)')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustAdr',           'Адрес клиента')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustCountry',       'Страна клиента')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustCodcagent',     'Характеристика клиента')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustTgr',           'Тип госреестра')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustOkpo',          'Идентификационный код')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustRezident',      'для резидента')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustReg',           'Областная НИ')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustDst',           'Районная НИ')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustDateT',         'Дата Регистрации в НИ')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustDateA',         'Дата Регистрации в Администрации')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustCurrent',       'больше текущей')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustIse',           'Сектор экономики')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustFs',            'Форма собственности')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustOe',            'Отрасль экономики')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustSed',           'Сектор экономической деятельности')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustVed',           'Вид экономической деятельности')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustMfo',           'МФО банка')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustPassp',         'Вид документа клиента')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustSer',           'Серия паспорта')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustSerCrl',        'необходимо заполнить кирилицей')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustNumDoc',        'Номер документа')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustOrgan',         'Кем выдан документ')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustPDate',         'Дата выдачи документа')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustBDay',          'Дата рождения клиента')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustPDate2',        'меньше')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustNumDocID',      'Номер паспорта-ID-карты')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustOrganID',       'Орган, который выдал')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustEddrIdID',      'Уникальный номер записи в ЕГДР')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustActualDateID',  'Дествителен до')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrCustPDateID',       'Дата выдачи')
.head 6 -  ! Call CurrentLangTable.SaveToFile('C:\\BARS98\\gencust.lng', 'RUS')
.head 6 -  Set fCustLangInit = TRUE
.head 5 -  Return fCustLangInit
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1277794108
0000: 7300000057000000 0000000000000000 0200000100FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F11003C00 0010410062737472
0040: 6163744300757374 6F6D657238800000 000200000007010D 000000FFFF090D00
0060: 00030400FC0000FF 07
.enddata
.head 3 +  Form Window Class: AbstractCustomer
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 +  Class Variables
.head 5 -  Number: nFetchRes
.head 5 -  Sql Handle: hSql
.head 4 +  Instance Variables
.head 5 -  Number: nHaveTobo
.head 5 -  Boolean: bShowCustomerAddress
.head 5 -  Boolean: bShowCustomerTerritory
.head 5 -  Boolean: bCheckElementOnNsi
.head 5 -  Boolean: bSetElementDefaultValue
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 5 -  Number: nNumAdr
.head 5 -  Number: nNewRnk
.head 5 -  Number: nRnk
.head 5 -  Number: nCusttype	! Тип клиента: 1-банк, 2-юр.лицо, 3-физ.лицо
.head 5 -  String: sNd		! № договора
.head 5 -  String: sNmk		! Наименование клиента
.head 5 -  String: sNmkk		! Наименование клиента краткое
.head 5 -  String: sNmkv		! Наименование клиента международное
.head 5 -  Number: nCountry	! Страна
.head 5 -  Number: nCodcagent	! Характеристика
.head 5 -  Number: nTgr		! Тип гос.реестра
.head 5 -  Number: nPrinsider	! Признак инсайдера
.head 5 -  String: sOkpo		! ОКПО
.head 5 -  String: sNRezidCode	! Код в стране регистрации (для неризидентов)
.head 5 -  String: sSab		! Эл.код
.head 5 -  Number: nStmt		! Формат выписки
.head 5 -  String: sAdr		! Адрес клиента
.head 5 -  Date/Time: dDateOn	! Дата регистрации
.head 5 -  Date/Time: dDateOff	! Дата закрытия
.head 5 -  String: sTaxf		! Налоговый код
.head 5 -  Number: nCReg		! Код обл.НИ
.head 5 -  Number: nCDst		! Код район.НИ
.head 5 -  String: sAdm		! Админ.орган
.head 5 -  String: sRgTax		! Рег номер в НИ
.head 5 -  String: sRgAdm		! Рег номер в НИ
.head 5 -  Date/Time: dDateT	! Дата рег в НИ
.head 5 -  Date/Time: dDateA	! Дата рег. в администрации
.head 5 -  String: sIse		! Инст. сек. экономики
.head 5 -  String: sFs		! Форма собственности
.head 5 -  String: sOe		! Отрасль экономики
.head 5 -  String: sVed		! Вид эк. деятельности
.head 5 -  String: sSed		! Форма хозяйствования
.head 5 -  String: sK050		! k050
.head 5 -  String: sNotes		! Примечание
.head 5 -  Long String: sNotesec	! Примечание для службы безопасности
.head 5 -  Number: nCRisk		! Категория риска
.head 5 -  String: sPincode	!
.head 5 -  Number: nRnkP		! Рег. номер холдинга
.head 5 -  Number: nLim		! Лимит кассы
.head 5 -  String: sNomPDV		! № в реестре плат. ПДВ
.head 5 -  String: sMB		! Принадл. малому бизнесу
.head 5 -  Number: nBC		! Признак НЕклиента банка
.head 5 -  String: sAdrAlt		! Альтернативный адрес
.head 5 -  String: sNomDog		! № договора за сопровождение
.head 5 -  Number: nLimKass	! Лимит кассы
.head 5 -  String: sTobo		! Код безбалансового отделения
.head 5 -  Number: nIsp		! Менеджер счета
.head 5 -  Boolean: bUseEN
.head 5 -  Boolean: bUseNI
.head 5 -  : ListElement
.head 6 -  Class: cCustElementList
.head 5 -  : ListExtern
.head 6 -  Class: cCustRelList
.head 5 -  : ListAddress
.head 6 -  Class: cCustAddressList
.head 5 -  : ListCorpAcc
.head 6 -  Class: cCorpAccList
.head 5 -  : ListRisk
.head 6 -  Class: cCustRiskList
.head 5 -  : ListRept
.head 6 -  Class: cCustReptList
.head 5 -  : ListCategory
.head 6 -  Class: cCustCategoryList
.head 4 +  Functions
.head 5 +  Function: constructor
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlId
.head 7 -  Number: nCustTypeId
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call GenCust_Init()
.head 7 -  Set hSql = hSqlId
.head 7 -  Set nCusttype = nCustTypeId
.head 7 -  Set nRnk = nRnkId
.head 7 -  Set bShowKK   = bParShowKK
.head 7 -  Set nFlagVisa = nParFlagVisa
.head 7 -  Set nHaveTobo = GetGlobalOptionEx('HAVETOBO')
.head 7 -  Set bShowCustomerAddress = Val(GetValueStr("select count(*) from all_tables where table_name='CUSTOMER_ADDRESS'"))
.head 7 +  If bShowCustomerAddress
.head 8 -  Call initCustomerAddress(nRnk, bShowKK, nFlagVisa)
.head 8 -  Call populateCustomerAddress()
.head 8 -  Set bShowCustomerTerritory = Val(GetValueStr("select count(*) from all_tables where table_name='TERRITORY'"))
.head 7 -  Set bCheckElementOnNsi      = Val(GetValueStr("select count(*) from all_tab_columns where table_name='CUSTOMER_FIELD' and column_name='TABCOLUMN_CHECK'"))
.head 7 -  Set bSetElementDefaultValue = Val(GetValueStr("select count(*) from all_tab_columns where table_name='CUSTOMER_FIELD' and column_name='SQLVAL'"))
.head 7 -  Return TRUE
.head 5 +  Function: destructor
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 -  ! Populate
.head 5 +  Function: populateOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 6 +  Actions
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate =
"SELECT nd, custtype, nmk, nmkv, nmkk, 
        country, codcagent, tgr, prinsider, 
        okpo, sab, stmt, adr, date_on, date_off, 
        taxf, c_reg, c_dst, adm, rgtax, rgadm, datet, datea, 
        ise, fs, oe, ved, sed, k050,
        notes, notesec, crisk, pincode, rnkp, lim, nompdv, mb, 
        nvl(bc,0), " || IifS(nHaveTobo>0, "tobo,", "") || " isp, nrezid_code
 INTO :sNd, :nCusttype, :sNmk, :sNmkv, :sNmkk, 
      :nCountry, :nCodcagent, :nTgr, :nPrinsider, 
      :sOkpo, :sSab, :nStmt, :sAdr, :dDateOn, :dDateOff, 
      :sTaxf, :nCReg, :nCDst, :sAdm, :sRgTax, :sRgAdm, :dDateT, :dDateA, 
      :sIse, :sFs, :sOe, :sVed, :sSed, :sK050,
      :sNotes, :sNotesec, :nCRisk, :sPincode, :nRnkP, :nLim, :sNomPDV, :sMB, 
      :nBC, " || IifS(nHaveTobo>0, ":sTobo,", "") || " :nIsp, :sNRezidCode
 FROM customer WHERE rnk=:nRnk"
.head 7 +  Else
.head 8 -  Set sSqlPopulate = 
"SELECT nd, custtype, nmk, nmkv, nmkk, 
        country, codcagent, tgr, prinsider, 
        okpo, sab, stmt, adr, date_on, null, 
        taxf, c_reg, c_dst, adm, rgtax, rgadm, datet, datea, 
        ise, fs, oe, ved, sed, k050,
        notes, notesec, crisk, null, rnkp, null, nompdv, null, 
        0, branch, isp, nrezid_code
 INTO :sNd, :nCusttype, :sNmk, :sNmkv, :sNmkk, 
      :nCountry, :nCodcagent, :nTgr, :nPrinsider, 
      :sOkpo, :sSab, :nStmt, :sAdr, :dDateOn, :dDateOff, 
      :sTaxf, :nCReg, :nCDst, :sAdm, :sRgTax, :sRgAdm, :dDateT, :dDateA, 
      :sIse, :sFs, :sOe, :sVed, :sSed, :sK050,
      :sNotes, :sNotesec, :nCRisk, :sPincode, :nRnkP, :nLim, :sNomPDV, :sMB, 
      :nBC, :sTobo, :nIsp, :sNRezidCode
 FROM clv_customer WHERE rnk=:nRnk"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sSqlPopulate)
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Set bUseNI = NOT (nCReg = -1 OR nCReg = NUMBER_Null)
.head 7 -  Set bUseEN = NOT (
   sIse = STRING_Null AND sFs   = STRING_Null AND
   sOe  = STRING_Null AND sVed  = STRING_Null AND
   sSed = STRING_Null AND sK050 = STRING_Null)
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bShowCustomerAddress AND (nCusttype = 2 OR nCusttype = 3)
.head 8 +  If NOT ListAddress.Populate(hSql)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerDopInfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nLimKass = NUMBER_Null
.head 7 +  If NOT SqlPrepareAndExecute(hSql,
"SELECT lim_kass, adr_alt, nom_dog 
 INTO :nLimKass, :sAdrAlt, :sNomDog 
 FROM rnk_rekv 
 WHERE rnk=:nRnk")
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerElement
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListElement.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListExtern.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCorpAcc.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerRisk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRisk.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerRept
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRept.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: populateCustomerCategory
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCategory.Populate(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  ! Save
.head 5 +  Function: saveOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerAttribute
.head 6 -  Description: сохраняем только customer
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setCustomerAttr(nNewRnk, nCusttype, sNd, sNmk, sNmkv, sNmkk, 
    sAdr, nCodcagent, nCountry, nPrinsider, nTgr, sOkpo, nStmt, sSab, dDateOn, 
    sTaxf, nCReg, nCDst, sAdm, sRgTax, sRgAdm, dDateT, dDateA, 
    sIse, sFs, sOe, sVed, sSed, 
    sNotes, sNotesec, nCRisk, sPincode, nRnkP, nLim, sNomPDV, sMB, nBC, sTobo, nIsp, sNRezidCode, nFlagVisa)")
.head 8 -  Return FALSE
.head 7 -  Call setRnk(nNewRnk)
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bShowCustomerAddress AND (nCusttype = 2 OR nCusttype = 3)
.head 8 +  If nRnk
.head 9 -  Set nNewRnk = nRnk
.head 8 +  Else
.head 9 -  Set nNewRnk = NUMBER_Null
.head 8 -  Call ListAddress.setRnk(nNewRnk)
.head 8 +  If NOT ListAddress.Update(hSql)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerInfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setCustomerRekv(nNewRnk, nLimKass, sAdrAlt, sNomDog)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerElement
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 -  Call ListElement.setRnk(nNewRnk)
.head 7 +  If NOT ListElement.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 -  Call ListExtern.setRnk(nNewRnk)
.head 7 +  If NOT ListExtern.Save(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 -  Call ListCorpAcc.setRnk(nNewRnk)
.head 7 +  If NOT ListCorpAcc.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerEN
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If not SqlPLSQLCommand(hSql, "kl.setCustomerEN(nRnk, sIse, sFs, sVed, sOe, sK050, sSed, nFlagVisa)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerRisk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 -  Call ListRisk.setRnk(nNewRnk)
.head 7 +  If NOT ListRisk.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerRept
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 -  Call ListRept.setRnk(nNewRnk)
.head 7 +  If NOT ListRept.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveCustomerCategory
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 -  Call ListCategory.setRnk(nNewRnk)
.head 7 +  If NOT ListCategory.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  ! Check
.head 5 +  Function: getErrData
.head 6 -  Description: Проверяет реквизиты клиента
Возвращает строку ошибок
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strErrorList
.head 7 -  Number: nErrorCount
.head 6 +  Actions
.head 7 -  Set strErrorList = ''
.head 7 -  Set nErrorCount = 0
.head 7 -  Set sPar = ''
.head 7 -  !
.head 7 +  If sNmk = STRING_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','NMK',sPar)
.head 8 -  ! Не заполнен реквизит <Наименование клиента (нац)>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustNmk')  || '>' || PutCrLf()
.head 7 +  If nCusttype = 3 and sNmkv = STRING_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','NMKV',sPar)
.head 8 -  ! Не заполнен реквизит <Наименование клиента (межд)>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustNmkv')  || '>' || PutCrLf()
.head 7 +  If sAdr = STRING_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','ADR',sPar)
.head 8 -  ! Не заполнен реквизит <Адрес>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustAdr')  || '>' || PutCrLf()
.head 7 +  If nCountry = NUMBER_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','COUNTRY',sPar)
.head 8 -  ! Не заполнен реквизит <Страна клиента>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv')    || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustCountry') || '>' || PutCrLf()
.head 7 +  If nCodcagent = NUMBER_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','CODCAGENT',sPar)
.head 8 -  ! Не заполнен реквизит <Характеристика клиента>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv')      || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustCodcagent') || '>' || PutCrLf()
.head 7 +  If nTgr = NUMBER_Null
.head 8 -  Set nErrorCount = nErrorCount + 1
.head 8 -  Set sPar = IifS(sPar='','TGR',sPar)
.head 8 -  ! Не заполнен реквизит <Тип госреестра>
.head 8 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustTgr')  || '>' || PutCrLf()
.head 7 -  ! ОКПО
.head 7 +  If sOkpo = STRING_Null
.head 8 +  If SalNumberMod( nCodcagent+2, 2)
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','OKPO',sPar)
.head 9 -  ! Не заполнен реквизит <Идентификационный код> для резидента
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustOkpo') || '>' || ' ' || 
    CurrentLangTable.GetAtomTitle('cTErrCustRezident')    || PutCrLf()
.head 7 +  Else
.head 8 +  If NOT checkRegOkpo(nCodcagent, sOkpo)
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','OKPO',sPar)
.head 9 -  ! Не заполнен реквизит <Идентификационный код>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustOkpo') || '>' || PutCrLf()
.head 7 -  ! Для nTgr NI м. не заполнять
.head 7 +  If bUseNI AND nTgr != 3
.head 8 +  If nCReg = -1
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','CREG',sPar)
.head 9 -  ! Не заполнен реквизит <Областная НИ>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustReg')  || '>' || PutCrLf()
.head 8 +  If nCDst = -1
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','CDST',sPar)
.head 9 -  ! Не заполнен реквизит <Районная НИ>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustDst')  || '>' || PutCrLf()
.head 8 +  If dDateT = DATETIME_Null AND nCusttype != 3
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','DATET',sPar)
.head 9 -  ! Не заполнен реквизит <Дата Регистрации в НИ>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv')  || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustDateT') || '>' || PutCrLf()
.head 8 +  If dDateA = DATETIME_Null AND nCusttype != 3
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','DATEA',sPar)
.head 9 -  ! Не заполнен реквизит <Дата Регистрации в Администрации>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv')  || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustDateA') || '>' || PutCrLf()
.head 8 +  If dDateT != DATETIME_Null AND dDateT > GetBankDate()
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','DATET',sPar)
.head 9 -  ! <Дата Регистрации в НИ> больше текущей
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustDateT')   || '>' || 
    CurrentLangTable.GetAtomTitle('cTErrCustCurrent') || PutCrLf()
.head 8 +  If dDateA != DATETIME_Null AND dDateA > GetBankDate()
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','DATEA',sPar)
.head 9 -  ! <Дата Регистрации в Администрации> больше текущей
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustDateA')   || '>' || 
    CurrentLangTable.GetAtomTitle('cTErrCustCurrent') || PutCrLf()
.head 7 +  Else
.head 8 +  If NOT nCReg
.head 9 -  Set nCReg = -1
.head 8 +  If NOT nCDst
.head 9 -  Set nCDst = -1
.head 7 -  !
.head 7 +  If bUseEN
.head 8 -  ! для ПРАВЭКС необязательны для заполнения K080(fs)
.head 8 +  If sIse = STRING_Null
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','ISE',sPar)
.head 9 -  ! Не заполнен реквизит <Сектор экономики>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustIse')  || '>' || PutCrLf()
.head 8 +  If GetGlobalOption('BANKTYPE') != 'PRVX' and sFs  = STRING_Null
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','FS',sPar)
.head 9 -  ! Не заполнен реквизит <Форма собственности>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustFs')   || '>' || PutCrLf()
.head 8 +  If sVed = STRING_Null
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','VED',sPar)
.head 9 -  ! Не заполнен реквизит <Вид экономической деятельности>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustVed')  || '>' || PutCrLf()
.head 8 +  If sK050 = STRING_Null
.head 9 -  Set nErrorCount = nErrorCount + 1
.head 9 -  Set sPar = IifS(sPar='','SED',sPar)
.head 9 -  ! Не заполнен реквизит <Сектор экономической деятельности>
.head 9 -  Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustSed')  || '>' || PutCrLf()
.head 7 -  !
.head 7 +  If nCRisk = 0
.head 8 -  Set nCRisk = NUMBER_Null
.head 7 -  Return strErrorList
.head 5 +  Function: getErrDataEx
.head 6 -  Description: Проверяет реквизиты клиента
Возвращает строку ошибок
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return getErrData(sPar)
.head 5 +  Function: checkRegOkpo
.head 6 -  Description: Проверяет ОКПО при регистрации клиента
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nK010
.head 7 -  String: sOKPO
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sOKPO = ''
.head 8 -  Return TRUE
.head 7 +  If nK010 = NUMBER_Null
.head 8 -  Return FALSE
.head 7 -  ! Резидент
.head 7 +  If nK010 = 1 OR nK010 = 3 OR nK010 = 7 OR nK010 = 9
.head 8 +  If SalStrLength(sOKPO) < 8 or SalStrLength(sOKPO) > 10
.head 9 -  Return FALSE
.head 7 +  If SalStrLength(sOKPO) = 8
.head 8 +  If sOKPO!=V_Okpo(sOKPO)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Call ListElement.setShowKK(bFlag)
.head 7 -  Call ListExtern.setShowKK(bFlag)
.head 7 -  Call ListAddress.setShowKK(bFlag)
.head 7 -  Call ListCorpAcc.setShowKK(bFlag)
.head 7 -  Call ListRisk.setShowKK(bFlag)
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Call ListElement.setFlagVisa(nFlag)
.head 7 -  Call ListExtern.setFlagVisa(nFlag)
.head 7 -  Call ListAddress.setFlagVisa(nFlag)
.head 7 -  Call ListCorpAcc.setFlagVisa(nFlag)
.head 7 -  Call ListRisk.setFlagVisa(nFlag)
.head 7 -  Return TRUE
.head 5 -  ! CustomerAddress
.head 5 +  Function: initCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bShowCustomerAddress AND (nCusttype = 2 OR nCusttype = 3)
.head 8 +  If NOT ListAddress.Init(nInitRnk, bParShowKK, nParFlagVisa)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: updateCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bShowCustomerAddress AND (nCusttype = 2 OR nCusttype = 3)
.head 8 +  If NOT ListAddress.Update(hSql)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nAdrTypeId
.head 7 -  : cAdr
.head 8 -  Class: cCustAddress
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = ListAddress.getIndexById(nAdrTypeId)
.head 7 +  If nIndex != -1
.head 8 -  Set cAdr.nTypeId       = ListAddress.List[nIndex].nTypeId
.head 8 -  Set cAdr.nCountry      = ListAddress.List[nIndex].nCountry
.head 8 -  Set cAdr.sZip          = ListAddress.List[nIndex].sZip
.head 8 -  Set cAdr.sDomain       = ListAddress.List[nIndex].sDomain
.head 8 -  Set cAdr.sRegion       = ListAddress.List[nIndex].sRegion
.head 8 -  Set cAdr.nLocalityType = ListAddress.List[nIndex].nLocalityType
.head 8 -  Set cAdr.sLocality     = ListAddress.List[nIndex].sLocality
.head 8 -  Set cAdr.nStreetType   = ListAddress.List[nIndex].nStreetType
.head 8 -  Set cAdr.sStreet       = ListAddress.List[nIndex].sStreet
.head 8 -  Set cAdr.nHomeType     = ListAddress.List[nIndex].nHomeType
.head 8 -  Set cAdr.sHome         = ListAddress.List[nIndex].sHome
.head 8 -  Set cAdr.nHomepartType = ListAddress.List[nIndex].nHomepartType
.head 8 -  Set cAdr.sHomepart     = ListAddress.List[nIndex].sHomepart
.head 8 -  Set cAdr.nRoomType     = ListAddress.List[nIndex].nRoomType
.head 8 -  Set cAdr.sRoom         = ListAddress.List[nIndex].sRoom
.head 8 -  Set cAdr.sAddress      = ListAddress.List[nIndex].sAddress
.head 8 -  Set cAdr.sComm         = ListAddress.List[nIndex].sComm
.head 8 -  Set cAdr.nTerritoryId  = ListAddress.List[nIndex].nTerritoryId
.head 7 -  Return TRUE
.head 5 +  Function: setCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : cAdr
.head 8 -  Class: cCustAddress
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = ListAddress.getIndexById(cAdr.nTypeId)
.head 7 +  If nIndex != -1
.head 8 -  Set ListAddress.List[nIndex].nCountry      = cAdr.nCountry
.head 8 -  Set ListAddress.List[nIndex].sZip          = cAdr.sZip
.head 8 -  Set ListAddress.List[nIndex].sDomain       = cAdr.sDomain
.head 8 -  Set ListAddress.List[nIndex].sRegion       = cAdr.sRegion
.head 8 -  Set ListAddress.List[nIndex].nLocalityType = cAdr.nLocalityType
.head 8 -  Set ListAddress.List[nIndex].sLocality     = cAdr.sLocality
.head 8 -  Set ListAddress.List[nIndex].nStreetType   = cAdr.nStreetType
.head 8 -  Set ListAddress.List[nIndex].sStreet       = cAdr.sStreet
.head 8 -  Set ListAddress.List[nIndex].nHomeType     = cAdr.nHomeType
.head 8 -  Set ListAddress.List[nIndex].sHome         = cAdr.sHome
.head 8 -  Set ListAddress.List[nIndex].nHomepartType = cAdr.nHomepartType
.head 8 -  Set ListAddress.List[nIndex].sHomepart     = cAdr.sHomepart
.head 8 -  Set ListAddress.List[nIndex].nRoomType     = cAdr.nRoomType
.head 8 -  Set ListAddress.List[nIndex].sRoom         = cAdr.sRoom
.head 8 -  Set ListAddress.List[nIndex].sAddress      = cAdr.sAddress
.head 8 -  Set ListAddress.List[nIndex].sComm         = cAdr.sComm
.head 8 -  Set ListAddress.List[nIndex].nTerritoryId  = cAdr.nTerritoryId
.head 7 -  Return TRUE
.head 5 -  ! CustomerElement
.head 5 +  Function: initCustomerElement
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Number: nInitCType
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListElement.Init(nInitRnk, nInitCType, bParShowKK, nParFlagVisa)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: updateCustomerElement
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListElement.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getElementValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListElement.getValue(sTag)
.head 5 +  Function: setElementValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListElement.setValue(sTag, sValue)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getElementIndex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListElement.getIndexByTag(sTag)
.head 5 +  Function: getElementEditFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListElement.getEditFlag(sTag)
.head 5 -  ! CustomerRel
.head 5 +  Function: initCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListExtern.Init(nInitRnk, bParShowKK, nParFlagVisa)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getCustomerRelParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListExtern.getParNum()
.head 5 +  Function: getCustomerRel
.head 6 -  Description: Получить значения массива по индексу
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  !
.head 7 -  Receive Number: nRelRnk		! number(22)	Ид (Id/Rnk) связ. лица
.head 7 -  Receive Number: nIntExt		! number(1)	1-наш клиент, 0-не наш клиент
.head 7 -  Receive String: sName		! varchar2(70)	Имя
.head 7 -  Receive Number: nDocType	! number(22)	Тип документа
.head 7 -  Receive String: sDocSerial	! varchar2(30)	Серия документв
.head 7 -  Receive String: sDocNumber	! varchar2(22)	Номер документа
.head 7 -  Receive Date/Time: dDocDate	! date		Дата выдачи документа
.head 7 -  Receive String: sDocIssuer	! varchar2(70)	Место выдачи документа
.head 7 -  Receive Date/Time: dBirthday	! date		Дата рождения
.head 7 -  Receive String: sBirthplace	! varchar2(70)	Место рождения
.head 7 -  Receive String: sSex		! char(1) 	Пол
.head 7 -  Receive String: sAdr		! varchar2(100)	Адрес
.head 7 -  Receive String: sTel		! varchar2(100)	Телефон
.head 7 -  Receive String: sEMail		! varchar2(100)	EMail
.head 7 -  Receive Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 7 -  Receive String: sOkpo		! varchar2(10)	ОКПО
.head 7 -  Receive Number: nCountry	! number(3)	Код страны
.head 7 -  Receive String: sRegion		! varchar2(2)	Код региона
.head 7 -  Receive String: sFs		! char(2)	Форма собственности (K081)
.head 7 -  Receive String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 7 -  Receive String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 7 -  Receive String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 7 -  Receive String: sNotes		! varchar2(80)	Комментарий
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRelRnk     = ListExtern.getRelRnk(nIndex)
.head 7 -  Set nIntExt     = ListExtern.getIntExt(nIndex)
.head 7 -  Set sName       = ListExtern.getName(nIndex)
.head 7 -  Set nDocType    = ListExtern.getDocType(nIndex)
.head 7 -  Set sDocSerial  = ListExtern.getDocSerial(nIndex)
.head 7 -  Set sDocNumber  = ListExtern.getDocNumber(nIndex)
.head 7 -  Set dDocDate    = ListExtern.getDocDate(nIndex)
.head 7 -  Set sDocIssuer  = ListExtern.getDocIssuer(nIndex)
.head 7 -  Set dBirthday   = ListExtern.getBirthday(nIndex)
.head 7 -  Set sBirthplace = ListExtern.getBirthplace(nIndex)
.head 7 -  Set sSex        = ListExtern.getSex(nIndex)
.head 7 -  Set sAdr        = ListExtern.getAdr(nIndex)
.head 7 -  Set sTel        = ListExtern.getTel(nIndex)
.head 7 -  Set sEMail      = ListExtern.getEMail(nIndex)
.head 7 -  Set nCusttype   = ListExtern.getCusttype(nIndex)
.head 7 -  Set sOkpo       = ListExtern.getOkpo(nIndex)
.head 7 -  Set nCountry    = ListExtern.getCountry(nIndex)
.head 7 -  Set sRegion     = ListExtern.getRegion(nIndex)
.head 7 -  Set sFs         = ListExtern.getFs(nIndex)
.head 7 -  Set sVed        = ListExtern.getVed(nIndex)
.head 7 -  Set sSed        = ListExtern.getSed(nIndex)
.head 7 -  Set sIse        = ListExtern.getIse(nIndex)
.head 7 -  Set sNotes      = ListExtern.getNotes(nIndex)
.head 7 -  !
.head 7 -  Return TRUE
.head 5 +  Function: setCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nListIndex
.head 7 -  Number: nRelRnk		! number(22)	Ид (Id/Rnk) связ. лица
.head 7 -  Number: nIntExt		! number(1)	1-наш клиент, 0-не наш клиент
.head 7 -  String: sName		! varchar2(70)	Имя
.head 7 -  Number: nDocType	! number(22)	Тип документа
.head 7 -  String: sDocSerial	! varchar2(30)	Серия документв
.head 7 -  String: sDocNumber	! varchar2(22)	Номер документа
.head 7 -  Date/Time: dDocDate	! date		Дата выдачи документа
.head 7 -  String: sDocIssuer	! varchar2(70)	Место выдачи документа
.head 7 -  Date/Time: dBirthday	! date		Дата рождения
.head 7 -  String: sBirthplace	! varchar2(70)	Место рождения
.head 7 -  String: sSex		! char(1) 	Пол
.head 7 -  String: sAdr		! varchar2(100)	Адрес
.head 7 -  String: sTel		! varchar2(100)	Телефон
.head 7 -  String: sEMail		! varchar2(100)	EMail
.head 7 -  Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 7 -  String: sOkpo		! varchar2(10)	ОКПО
.head 7 -  Number: nCountry	! number(3)	Код страны
.head 7 -  String: sRegion		! varchar2(2)	Код региона
.head 7 -  String: sFs		! char(2)	Форма собственности (K081)
.head 7 -  String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 7 -  String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 7 -  String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 7 -  String: sNotes		! varchar2(80)	Примечание
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = nListIndex
.head 7 -  ! update
.head 7 +  If nIndex != NUMBER_Null
.head 8 +  If not ListExtern.setRelRnk(nIndex,nRelRnk)
or not ListExtern.setIntExt(nIndex,nIntExt)
or not ListExtern.setName(nIndex,sName)
or not ListExtern.setDocType(nIndex,nDocType)
or not ListExtern.setDocSerial(nIndex,sDocSerial)
or not ListExtern.setDocNumber(nIndex,sDocNumber)
or not ListExtern.setDocDate(nIndex,dDocDate)
or not ListExtern.setDocIssuer(nIndex,sDocIssuer)
or not ListExtern.setBirthday(nIndex,dBirthday)
or not ListExtern.setBirthplace(nIndex,sBirthplace)
or not ListExtern.setSex(nIndex,sSex)
or not ListExtern.setAdr(nIndex,sAdr)
or not ListExtern.setTel(nIndex,sTel)
or not ListExtern.setEMail(nIndex,sEMail)
or not ListExtern.setCusttype(nIndex,nCusttype)
or not ListExtern.setOkpo(nIndex,sOkpo)
or not ListExtern.setCountry(nIndex,nCountry)
or not ListExtern.setRegion(nIndex,sRegion)
or not ListExtern.setFs(nIndex,sFs)
or not ListExtern.setVed(nIndex,sVed)
or not ListExtern.setSed(nIndex,sSed)
or not ListExtern.setIse(nIndex,sIse)
or not ListExtern.setNotes(nIndex,sNotes)
.head 9 -  Return FALSE
.head 7 -  ! insert
.head 7 +  Else
.head 8 +  If NOT ListExtern.insert(nListIndex, nRelRnk, nIntExt, sName, 
   nDocType, sDocSerial, sDocNumber, dDocDate, sDocIssuer, dBirthday, sBirthplace,
   sSex, sAdr, sTel, sEMail, nCusttype, sOkpo, nCountry, sRegion, 
   sFs, sVed, sSed, sIse, sNotes)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: deleteCustomerRel
.head 6 -  Description: Удалить связанное лицо
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nListIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListExtern.delete(nListIndex)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: editCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nListIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListExtern.setEditedFlag(nListIndex, TRUE)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: addRel
.head 6 -  Description: Добавить связь
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nIndex
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListExtern.addRelation(nIndex, nCustomerRel, nRelId)
.head 5 +  Function: deleteRel
.head 6 -  Description: Удалить связь
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListExtern.delRelation(nIndex)
.head 5 +  Function: getRelation
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListExtern.getRelation(nCustomerRel, nRelId)
.head 5 +  Function: getRelValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 7 -  Receive Number: nVaga1
.head 7 -  Receive Number: nVaga2
.head 7 -  Receive Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  Receive String: sPosition		! varchar2(100)	Должность
.head 7 -  Receive String: sPosition_r		! varchar2(100)	Должность
.head 7 -  Receive String: sFirstName		! varchar2(70)	Имя
.head 7 -  Receive String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  Receive String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Receive Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  Receive String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  Receive String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Receive Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Receive Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Receive Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  Receive String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  Receive String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Receive Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Receive Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  Receive String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListExtern.getRelDetails(nCustomerRel, nRelId, nVaga1, nVaga2, 
     nTypeId, sPosition, sPosition_r, sFirstName, sMiddleName, sLastName, 
     nDocumentTypeId, sDocument, sTrustRegnum, dTrustRegdat, dBDate, dEDate,
     sNotaryName, sNotaryRegion, nSignPrivs, nSignId, sNameR)
.head 7 -  Return TRUE
.head 5 +  Function: setRelValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 7 -  Number: nVaga1
.head 7 -  Number: nVaga2
.head 7 -  Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  String: sPosition		! varchar2(100)	Должность
.head 7 -  String: sPosition_r		! varchar2(100)	Должность в род. падеже
.head 7 -  String: sFirstName		! varchar2(70)	Имя
.head 7 -  String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ListExtern.setRelDetails(nCustomerRel, nRelId, nVaga1, nVaga2, 
     nTypeId, sPosition, sPosition_r, sFirstName, sMiddleName, sLastName, 
     nDocumentTypeId, sDocument, sTrustRegnum, dTrustRegdat, 
     dBDate, dEDate, sNotaryName, sNotaryRegion, nSignPrivs, nSignId, sNameR)
.head 7 -  Return TRUE
.head 5 +  Function: checkRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nCustomerRel
.head 7 -  Receive Number: nRelId
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListExtern.checkRel(nCustomerRel, nRelId, sPar)
.head 5 -  ! CorpAcc
.head 5 +  Function: initCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCorpAcc.Init(nInitRnk, bParShowKK, nParFlagVisa)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: updateCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCorpAcc.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: deleteCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  ! If NOT ListCorpAcc.Delete(hSql,nId)
.head 8 -  Return FALSE
.head 7 +  If NOT ListCorpAcc.Delete(nId)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getCorpAccParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListCorpAcc.getParNum()
.head 5 +  Function: getCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Receive Number: nAccId
.head 7 -  Receive String: sAccMfo
.head 7 -  Receive String: sAccNls
.head 7 -  Receive Number: nAccKv
.head 7 -  Receive String: sAccComm
.head 7 -  Receive String: sBankName
.head 7 -  Receive String: sAccSW56_Name
.head 7 -  Receive String: sAccSW56_Adr
.head 7 -  Receive String: sAccSW56_Code
.head 7 -  Receive String: sAccSW57_Name
.head 7 -  Receive String: sAccSW57_Adr
.head 7 -  Receive String: sAccSW57_Code
.head 7 -  Receive String: sAccSW57_Acc
.head 7 -  Receive String: sAccSW59_Name
.head 7 -  Receive String: sAccSW59_Adr
.head 7 -  Receive String: sAccSW59_Acc
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nAccId   = ListCorpAcc.getId(nIndex)
.head 7 -  Set sAccMfo  = ListCorpAcc.getMfo(nIndex)
.head 7 -  Set sAccNls  = ListCorpAcc.getNls(nIndex)
.head 7 -  Set nAccKv   = ListCorpAcc.getKv(nIndex)
.head 7 -  Set sAccComm = ListCorpAcc.getComm(nIndex)
.head 7 -  Set sBankName = ListCorpAcc.getBankName(nIndex)
.head 7 -  Set sAccSW56_Name = ListCorpAcc.getSW56_Name(nIndex)
.head 7 -  Set sAccSW56_Adr  = ListCorpAcc.getSW56_Adr(nIndex)
.head 7 -  Set sAccSW56_Code = ListCorpAcc.getSW56_Code(nIndex)
.head 7 -  Set sAccSW57_Name = ListCorpAcc.getSW57_Name(nIndex)
.head 7 -  Set sAccSW57_Adr  = ListCorpAcc.getSW57_Adr(nIndex)
.head 7 -  Set sAccSW57_Code = ListCorpAcc.getSW57_Code(nIndex)
.head 7 -  Set sAccSW57_Acc  = ListCorpAcc.getSW57_Acc(nIndex)
.head 7 -  Set sAccSW59_Name = ListCorpAcc.getSW59_Name(nIndex)
.head 7 -  Set sAccSW59_Adr  = ListCorpAcc.getSW59_Adr(nIndex)
.head 7 -  Set sAccSW59_Acc  = ListCorpAcc.getSW59_Acc(nIndex)
.head 7 -  Return TRUE
.head 5 +  Function: setCorpAcc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nListIndex
.head 7 -  Number: nAccId
.head 7 -  String: sAccMfo
.head 7 -  String: sAccNls
.head 7 -  Number: nAccKv
.head 7 -  String: sAccComm
.head 7 -  String: sAccSW56_Name
.head 7 -  String: sAccSW56_Adr
.head 7 -  String: sAccSW56_Code
.head 7 -  String: sAccSW57_Name
.head 7 -  String: sAccSW57_Adr
.head 7 -  String: sAccSW57_Code
.head 7 -  String: sAccSW57_Acc
.head 7 -  String: sAccSW59_Name
.head 7 -  String: sAccSW59_Adr
.head 7 -  String: sAccSW59_Acc
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  ! Set nIndex = ListCorpAcc.getIndexById(nAccId)
.head 7 -  Set nIndex = nListIndex
.head 7 -  ! update
.head 7 +  If nIndex != NUMBER_Null
.head 8 +  If not ListCorpAcc.setMfo(nIndex, sAccMfo) 
or not ListCorpAcc.setNls(nIndex, sAccNls) 
or not ListCorpAcc.setKv(nIndex, nAccKv) 
or not ListCorpAcc.setComm(nIndex, sAccComm)
or not ListCorpAcc.setSW56_Name(nIndex, sAccSW56_Name)
or not ListCorpAcc.setSW56_Adr(nIndex, sAccSW56_Adr)
or not ListCorpAcc.setSW56_Code(nIndex, sAccSW56_Code)
or not ListCorpAcc.setSW57_Name(nIndex, sAccSW57_Name)
or not ListCorpAcc.setSW57_Adr(nIndex, sAccSW57_Adr)
or not ListCorpAcc.setSW57_Code(nIndex, sAccSW57_Code)
or not ListCorpAcc.setSW57_Acc(nIndex, sAccSW57_Acc)
or not ListCorpAcc.setSW59_Name(nIndex, sAccSW59_Name)
or not ListCorpAcc.setSW59_Adr(nIndex, sAccSW59_Adr)
or not ListCorpAcc.setSW59_Acc(nIndex, sAccSW59_Acc)
.head 9 -  Return FALSE
.head 7 -  ! insert
.head 7 +  Else
.head 8 +  If not ListCorpAcc.Insert(hSql, nListIndex, sAccMfo, sAccNls, nAccKv, sAccComm,
   sAccSW56_Name, sAccSW56_Adr, sAccSW56_Code, 
   sAccSW57_Name, sAccSW57_Adr, sAccSW57_Code, sAccSW57_Acc,
   sAccSW59_Name, sAccSW59_Adr, sAccSW59_Acc)
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  ! CustomerRisk
.head 5 +  Function: initCustomerRisk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRisk.Init(nInitRnk, bParShowKK, nParFlagVisa)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: updateCustomeRisk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRisk.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getRiskValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRisk.getValue(nRiskId)
.head 5 +  Function: setRiskValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRisk.setValue(nRiskId, nValue)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getRiskIndex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRisk.getIndexById(nRiskId)
.head 5 +  Function: getRiskEditFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRisk.getEditFlag(nRiskId)
.head 5 -  ! CustomerRept
.head 5 +  Function: initCustomerRept
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRept.Init(nInitRnk, bParShowKK, nParFlagVisa)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: updateCustomeRept
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRept.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getReptValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRept.getValue(nReptId)
.head 5 +  Function: setReptValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListRept.setValue(nReptId, nValue)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getReptIndex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRept.getIndexById(nReptId)
.head 5 +  Function: getReptEditFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListRept.getEditFlag(nReptId)
.head 5 -  ! CustomerCategory
.head 5 +  Function: initCustomerCategory
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nInitRnk
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCategory.Init(nInitRnk, bParShowKK, nParFlagVisa)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: updateCustomeCategory
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCategory.Update(hSql)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getCategoryValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListCategory.getValue(nCategoryId)
.head 5 +  Function: setCategoryValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT ListCategory.setValue(nCategoryId, nValue)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getCategoryIndex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListCategory.getIndexById(nCategoryId)
.head 5 +  Function: getCategoryEditFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ListCategory.getEditFlag(nCategoryId)
.head 5 -  !
.head 5 +  Function: isUseNI
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bUseNI
.head 5 +  Function: setUseNI
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bUseNI = bVal
.head 7 -  Return TRUE
.head 5 +  Function: isUseEN
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bUseEN
.head 5 +  Function: setUseEN
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bUseEN = bVal
.head 7 -  Return TRUE
.head 5 +  Function: isShowCustomerAddress
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bShowCustomerAddress
.head 5 +  Function: isShowCustomerTerritory
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bShowCustomerTerritory
.head 5 +  Function: isCheckElementOnNsi
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bCheckElementOnNsi
.head 5 +  Function: isSetElementDefaultValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bSetElementDefaultValue
.head 5 -  !
.head 5 +  Function: isUsePerson
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: setUsePerson
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nRnk
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getCusttype
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCusttype
.head 5 +  Function: setCusttype
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nCusttype = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getNd
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNd
.head 5 +  Function: setNd
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNd = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNmk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNmk
.head 5 +  Function: setNmk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNmk = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNmkv
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNmkv
.head 5 +  Function: setNmkv
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNmkv = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNmkk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNmkk
.head 5 +  Function: setNmkk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNmkk = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getCountry
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCountry
.head 5 +  Function: setCountry
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nCountry = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getCodcagent
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCodcagent
.head 5 +  Function: setCodcagent
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nCodcagent = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getTgr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nTgr
.head 5 +  Function: setTgr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTgr = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getPrinsider
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nPrinsider
.head 5 +  Function: setPrinsider
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nPrinsider = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getOkpo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sOkpo
.head 5 +  Function: setOkpo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sOkpo = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNRezidCode
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNRezidCode
.head 5 +  Function: setNRezidCode
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNRezidCode = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getSab
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sSab
.head 5 +  Function: setSab
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sSab = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getStmt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nStmt
.head 5 +  Function: setStmt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nStmt = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getAdr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sAdr
.head 5 +  Function: setAdr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sAdr = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getDateOn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDateOn
.head 5 +  Function: setDateOn
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDateOn = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getDateOff
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDateOff
.head 5 +  Function: setDateOff
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDateOff = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getTaxf
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTaxf
.head 5 +  Function: setTaxf
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTaxf = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getCReg
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCReg
.head 5 +  Function: setCReg
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nCReg = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getCDst
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCDst
.head 5 +  Function: setCDst
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nCDst= nVal
.head 7 -  Return TRUE
.head 5 +  Function: getRgTax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sRgTax
.head 5 +  Function: setRgTax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sRgTax= sVal
.head 7 -  Return TRUE
.head 5 +  Function: getRgAdm
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sRgAdm
.head 5 +  Function: setRgAdm
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sRgAdm= sVal
.head 7 -  Return TRUE
.head 5 +  Function: getDateT
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDateT
.head 5 +  Function: setDateT
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDateT = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getDateA
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDateA
.head 5 +  Function: setDateA
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDateA = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getAdm
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sAdm
.head 5 +  Function: setAdm
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sAdm = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getIse
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sIse
.head 5 +  Function: setIse
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sIse = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getFs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sFs
.head 5 +  Function: setFs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sFs = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getOe
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sOe
.head 5 +  Function: setOe
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sOe = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getVed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sVed
.head 5 +  Function: setVed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sVed = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getSed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sSed
.head 5 +  Function: setSed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sSed = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getK050
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sK050
.head 5 +  Function: setK050
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sK050 = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNotes
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNotes
.head 5 +  Function: setNotes
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNotes = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNotesec
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNotesec
.head 5 +  Function: setNotesec
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNotesec = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getCRisk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCRisk
.head 5 +  Function: setCRisk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nCRisk = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getPincode
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sPincode
.head 5 +  Function: setPincode
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sPincode = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getRnkP
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nRnkP
.head 5 +  Function: setRnkP
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnkP = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getLim
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nLim
.head 5 +  Function: setLim
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nLim = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getNomPDV
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNomPDV
.head 5 +  Function: setNomPDV
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNomPDV = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getMB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sMB
.head 5 +  Function: setMB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sMB = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getBC
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nBC
.head 5 +  Function: setBC
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nBC = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getAdrAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sAdrAlt
.head 5 +  Function: setAdrAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sAdrAlt = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNomDog
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNomDog
.head 5 +  Function: setNomDog
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNomDog = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getLimKass
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nLimKass
.head 5 +  Function: setLimKass
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nLimKass = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getTobo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTobo
.head 5 +  Function: setTobo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTobo = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getIsp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nIsp
.head 5 +  Function: setIsp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nIsp = nVal
.head 7 -  Return TRUE
.head 5 -  ! Bank
.head 5 +  Function: getMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getBic
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setBic
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getBicAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setBicAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getKodB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return NUMBER_Null
.head 5 +  Function: setKodB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getRating
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setRating
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  ! B+C
.head 5 +  Function: getRuk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setRuk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getTelR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setTelR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getBuh
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setBuh
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getTelB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setTelB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  ! Corp
.head 5 +  Function: getNmku
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setNmku
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getTelFax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setTelFax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getEMail
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setEMail
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getSealId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return NUMBER_Null
.head 5 +  Function: setSealId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  ! Person
.head 5 +  Function: getSex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setSex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getPassp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return NUMBER_Null
.head 5 +  Function: setPassp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getSer
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setSer
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getNumDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setNumDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getPDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return DATETIME_Null
.head 5 +  Function: setPDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getOrgan
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setOrgan
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getBDay
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return DATETIME_Null
.head 5 +  Function: setBDay
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getBPlace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setBPlace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getTelD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setTelD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getTelW
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setTelW
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getActualDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return DATETIME_Null
.head 5 +  Function: setActualDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: getEddrId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 +  Function: setEddrId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 4 -  Message Actions
.head 3 +  Form Window Class: Bank
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: AbstractCustomer
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sMfo		! Код МФО банка
.head 5 -  String: sBic		! Код BIC банка
.head 5 -  String: sBicAlt		! Код BIC банка альтернативный
.head 5 -  Number: nKodB		! Код 1ПБ банка
.head 5 -  String: sRating		! Рейтинг банка
.head 5 -  String: sRuk		! Руководитель банка
.head 5 -  String: sTelR		! Тел. руководителя
.head 5 -  String: sBuh		! Гл.бухгалтер банка
.head 5 -  String: sTelB		! Тел. гл.бухгалтера
.head 4 +  Functions
.head 5 +  Function: populateOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If NOT AbstractCustomer.populateOwnAttribute()
.head 8 -  Return FALSE
.head 7 +  If NOT SqlPrepareAndExecute(hSql, 
"SELECT mfo, bic, alt_bic, kod_b, rating, ruk, telr, buh, telb
 INTO :sMfo, :sBic, :sBicAlt, :nKodB, :sRating, 
      :sRuk, :sTelR, :sBuh, :sTelB
 FROM custbank WHERE rnk=:nRnk")
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Return TRUE
.head 5 +  Function: saveOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setBankAttr(nNewRnk, sMfo, sBic, sBicAlt, sRating, nKodB, 
   sRuk, sTelR, sBuh, sTelB) ")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getErrData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strErrorList
.head 6 +  Actions
.head 7 -  Set strErrorList = ''
.head 7 +  If SalNumberMod(nCodcagent+2,2) AND sMfo = STRING_Null
.head 8 -  Set sPar = IifS(sPar='', 'MFO', sPar)
.head 8 -  ! Не заполнен реквизит <МФО банка>
.head 8 -  Set strErrorList = strErrorList || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('cTErrCustMfo')  || '>' || PutCrLf()
.head 7 -  Return strErrorList
.head 5 -  !
.head 5 +  Function: getMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sMfo
.head 5 +  Function: setMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sMfo = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getBic
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sBic
.head 5 +  Function: setBic
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sBic = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getBicAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sBicAlt
.head 5 +  Function: setBicAlt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sBicAlt = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getKodB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nKodB
.head 5 +  Function: setKodB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nKodB = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getRating
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sRating
.head 5 +  Function: setRating
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sRating= sVal
.head 7 -  Return TRUE
.head 5 +  Function: getRuk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sRuk
.head 5 +  Function: setRuk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sRuk= sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelR
.head 5 +  Function: setTelR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelR= sVal
.head 7 -  Return TRUE
.head 5 +  Function: getBuh
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sBuh
.head 5 +  Function: setBuh
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sBuh = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelB
.head 5 +  Function: setTelB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelB= sVal
.head 7 -  Return TRUE
.head 4 -  Message Actions
.head 3 +  Form Window Class: Corporation
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: AbstractCustomer
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sNmku		! Наименование по Уставу (полное)
.head 5 -  String: sRuk		! Руководитель
.head 5 -  String: sTelR		! Тел. руководителя
.head 5 -  String: sBuh		! Гл.бухгалтер
.head 5 -  String: sTelB		! Тел. гл.бухгалтера
.head 5 -  String: sTelFax		! Факс
.head 5 -  String: sEMail		! Адрес электронной почты
.head 5 -  Number: nSealId		! Ид. графического представления печати юридического лица
.head 4 +  Functions
.head 5 +  Function: populateOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 6 +  Actions
.head 7 +  If NOT AbstractCustomer.populateOwnAttribute()
.head 8 -  Return FALSE
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate = 
"SELECT nmku, ruk, telr, buh, telb, tel_fax, e_mail, seal_id
 INTO :sNmku, :sRuk, :sTelR, :sBuh, :sTelB, :sTelFax, :sEMail, :nSealId 
 FROM corps WHERE rnk=:nRnk"
.head 7 +  Else
.head 8 -  Set sSqlPopulate = 
"SELECT nmku, ruk, telr, buh, telb, tel_fax, e_mail, seal_id
 INTO :sNmku, :sRuk, :sTelR, :sBuh, :sTelB, :sTelFax, :sEMail, :nSealId 
 FROM clv_corps WHERE rnk=:nRnk"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sSqlPopulate)
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 +  If NOT initCorpAcc(nRnk, bShowKK, nFlagVisa)
.head 8 -  Return FALSE
.head 7 +  If NOT populateCorpAcc()
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: saveOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 +  ! If NOT AbstractCustomer.saveCustomerAddress()
.head 8 -  Return FALSE
.head 7 +  If NOT AbstractCustomer.saveOwnAttribute()
.head 8 -  Return FALSE
.head 7 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setCorpAttr(nNewRnk, sNmku, sRuk, sTelR, sBuh, sTelB, 
    sTelFax, sEMail, nSealId, nFlagVisa)")
.head 8 -  Return FALSE
.head 7 +  If NOT saveCorpAcc()
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getErrData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ''
.head 5 -  !
.head 5 +  Function: getNmku
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNmku
.head 5 +  Function: setNmku
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNmku = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getRuk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sRuk
.head 5 +  Function: setRuk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sRuk = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelR
.head 5 +  Function: setTelR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelR = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getBuh
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sBuh
.head 5 +  Function: setBuh
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sBuh = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelB
.head 5 +  Function: setTelB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelB = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelFax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelFax
.head 5 +  Function: setTelFax
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelFax = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getEMail
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sEMail
.head 5 +  Function: setEMail
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sEMail = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getSealId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nSealId
.head 5 +  Function: setSealId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nSealId = nVal
.head 7 -  Return TRUE
.head 4 -  Message Actions
.head 3 +  Form Window Class: PrivatePerson
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: AbstractCustomer
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sSex		! 
.head 5 -  Number: nPassp
.head 5 -  String: sSer		! Серия док
.head 5 -  String: sNumDoc		! № док
.head 5 -  Date/Time: dPDate	! Даты выдачи док
.head 5 -  String: sOrgan
.head 5 -  Date/Time: dBDay
.head 5 -  String: sBPlace
.head 5 -  String: sTelD
.head 5 -  String: sTelW
.head 5 -  String: sTelM
.head 5 -  !
.head 5 -  Date/Time: dActualDate	! Дійсний до
.head 5 -  String: sEddrId		! Унікальний номер запису в ЄДДР
.head 5 -  !
.head 5 -  Boolean: bUsePerson
.head 4 +  Functions
.head 5 +  Function: populateOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 6 +  Actions
.head 7 +  If NOT AbstractCustomer.populateOwnAttribute()
.head 8 -  Return FALSE
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate = "
    SELECT sex, passp, ser, numdoc, pdate, organ, bday, bplace, teld, telw, CELLPHONE, actual_date, eddr_id
    INTO   :sSex, :nPassp, :sSer, :sNumDoc, :dPDate, :sOrgan, :dBDay, :sBPlace, :sTelD, :sTelW, :sTelM,
           :dActualDate, :sEddrId
    FROM   person
    WHERE  rnk=:nRnk"
.head 7 +  Else
.head 8 -  Set sSqlPopulate = "
    SELECT sex, passp, ser, numdoc, pdate, organ, bday, bplace, teld, telw, CELLPHONE, actual_date, eddr_id 
    INTO   :sSex, :nPassp, :sSer, :sNumDoc, :dPDate, :sOrgan, :dBDay, :sBPlace, :sTelD, :sTelW, :sTelM,
           :dActualDate, :sEddrId
    FROM   clv_person
    WHERE  rnk=:nRnk"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sSqlPopulate)
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext(hSql, nFetchRes)
.head 7 -  Set bUsePerson = NOT (
   sSex    = STRING_Null   AND nPassp  = NUMBER_Null   AND (sSer  = STRING_Null or sEddrId = STRING_Null) AND
   sNumDoc = STRING_Null   AND dPDate  = DATETIME_Null AND sOrgan = STRING_Null                           AND
   dBDay   = DATETIME_Null AND sBPlace = STRING_Null   AND sTelD  = STRING_Null AND sTelW  = STRING_Null)
.head 7 -  Return TRUE
.head 5 +  Function: saveOwnAttribute
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nRnk
.head 8 -  Set nNewRnk = nRnk
.head 7 +  Else
.head 8 -  Set nNewRnk = NUMBER_Null
.head 7 +  ! If NOT AbstractCustomer.saveCustomerAddress()
.head 8 -  Return FALSE
.head 7 +  If NOT AbstractCustomer.saveOwnAttribute()
.head 8 -  Return FALSE
.head 7 -  ! Call Debug('before KL.setPersonAttr')
.head 7 +  If NOT SqlPLSQLCommand(hSql, "
   KL.setPersonAttr(nNewRnk, sSex, nPassp, sSer, sNumDoc, dPDate, sOrgan, dBDay, sBPlace, sTelD, sTelW, sTelM,
                    dActualDate, sEddrId, nFlagVisa)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 7 -  ! Call Debug('after KL.setPersonAttr')
.head 5 +  Function: getErrData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strErrorList
.head 7 -  String: sSerTmp
.head 7 -  Number: nChar
.head 6 +  Actions
.head 7 -  Set strErrorList = ''
.head 7 +  If bUsePerson
.head 8 +  If nPassp = NUMBER_Null
.head 9 -  Set sPar = IifS(sPar='', 'PASSP', sPar)
.head 9 -  ! Не заполнен реквизит <Вид документа клиента>
.head 9 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustPassp') || '>' || PutCrLf()
.head 8 -  ! Для документа-паспорта клиента-резидента проверка серии на кирилицу
.head 8 +  If nPassp = 1 and GetBankCountryCode() = 804 and SalNumberMod(nCodcagent+2, 2)
.head 9 -  Set sSerTmp = sSer
.head 9 -  Set nChar = SalStrLop(sSerTmp)
.head 9 +  While SalStrLop(sSerTmp) > 0
.head 10 +  If nChar < 192 or nChar > 223
.head 11 -  Set sPar = IifS(sPar='', 'SER', sPar)
.head 11 -  ! Некорректно заполнен реквизит <Серия паспорта> - необходимо заполнить кирилицей
.head 11 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekvUnCorrect') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustSer') || '>' || ' - ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustSerCrl') || PutCrLf()
.head 11 -  Break
.head 10 -  Set nChar = SalStrLop(sSerTmp)
.head 8 -  ! Для документа-ID карта !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
.head 8 +  If nPassp = 7 and GetBankCountryCode() = 804 and SalNumberMod(nCodcagent+2, 2)
.head 9 +  If Len(sNumDoc) < 1 or Len(sNumDoc) > 9
.head 10 -  Set sPar = IifS(sPar='', 'NUMDOC', sPar)
.head 10 -  ! Некорректно заполнен реквизит <Номер паспорта-ID-карты> <Номер паспорта-ID-картки>
.head 10 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekvUnCorrect') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustNumDocID') || '>' || PutCrLf()
.head 9 +  If Len(sOrgan) != 4
.head 10 -  Set sPar = IifS(sPar='', 'ORGAN', sPar)
.head 10 -  ! Некорректно заполнен реквизит <Орган, который выдал> <Орган, що видав>
.head 10 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekvUnCorrect') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustOrganID') || '>' || PutCrLf()
.head 9 +  If Len(sEddrId) < 1 or Len(sEddrId) > 14 or
   VisStrSubstitute(sEddrId, '-', '') != Str(Val(VisStrSubstitute(sEddrId, '-', '')))
.head 10 -  Set sPar = IifS(sPar='', 'EDDRID', sPar)
.head 10 -  ! Некорректно заполнен реквизит <Уникальный номер записи в ЕГДР> <Унікальний номер запису в ЄДДР>
.head 10 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekvUnCorrect') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustEddrIdID') || '>' || PutCrLf()
.head 9 +  If dActualDate = DATETIME_Null
.head 10 -  Set sPar = IifS(sPar='', 'ACTUALDATE', sPar)
.head 10 -  ! Не заполнен реквизит <Дествителен до> <Дійсний до>
.head 10 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustActualDateID') || '>' || PutCrLf()
.head 9 +  If dPDate = DATETIME_Null
.head 10 -  Set sPar = IifS(sPar='', 'PDATE', sPar)
.head 10 -  ! Не заполнен реквизит <Дата выдачи> <Дата видачі>
.head 10 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('	') || '>' || PutCrLf()
.head 8 -  ! !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
.head 8 +  If sNumDoc = STRING_Null and nPassp != 7
.head 9 -  Set sPar = IifS(sPar='', 'NUMDOC', sPar)
.head 9 -  ! Не заполнен реквизит <Номер документа>
.head 9 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustNumDoc') || '>' || PutCrLf()
.head 8 +  If sOrgan = STRING_Null and nPassp != 7
.head 9 -  Set sPar = IifS(sPar='', 'ORGAN', sPar)
.head 9 -  ! Не заполнен реквизит <Кем выдан документ>
.head 9 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustOrgan') || '>' || PutCrLf()
.head 8 +  If dPDate = DATETIME_Null and nPassp != 7
.head 9 -  Set sPar = IifS(sPar='', 'PDATE', sPar)
.head 9 -  ! Не заполнен реквизит <Дата выдачи документа>
.head 9 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustPDate') || '>' || PutCrLf()
.head 8 +  If dBDay = DATETIME_Null
.head 9 -  Set sPar = IifS(sPar='', 'BDAY', sPar)
.head 9 -  ! Не заполнен реквизит <Дата выдачи документа>
.head 9 -  Set strErrorList = strErrorList || CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('cTErrCustBDay') || '>' || PutCrLf()
.head 8 +  If dPDate != DATETIME_Null AND dPDate > GetBankDate()
.head 9 -  Set sPar = IifS(sPar='', 'PDATE', sPar)
.head 9 -  ! <Дата выдачи документа> больше текущей
.head 9 -  Set strErrorList = strErrorList || '<' || CurrentLangTable.GetAtomTitle('cTErrCustPDate') || '> ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustCurrent') || PutCrLf()
.head 8 +  If dBDay != DATETIME_Null AND dBDay > GetBankDate()
.head 9 -  Set sPar = IifS(sPar='', 'BDAY', sPar)
.head 9 -  ! <Дата рождения клиента> больше текущей
.head 9 -  Set strErrorList = strErrorList || '<' || CurrentLangTable.GetAtomTitle('cTErrCustBDay') || '> ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustCurrent') || PutCrLf()
.head 8 +  If dPDate != DATETIME_Null AND dBDay  != DATETIME_Null AND dPDate < dBDay
.head 9 -  Set sPar = IifS(sPar='', 'PDATE', sPar)
.head 9 -  ! <Дата выдачи документа> меньше <Дата рождения клиента>
.head 9 -  Set strErrorList = strErrorList || '<' || CurrentLangTable.GetAtomTitle('cTErrCustPDate') || '> ' ||
    CurrentLangTable.GetAtomTitle('cTErrCustPDate2') || ' <' || CurrentLangTable.GetAtomTitle('cTErrCustBDay')
    || '>' || PutCrLf()
.head 7 -  Return strErrorList
.head 5 -  !
.head 5 +  Function: isUsePerson
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bUsePerson
.head 5 +  Function: setUsePerson
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bUsePerson = bVal
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getSex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sSex
.head 5 +  Function: setSex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sSex = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getPassp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nPassp
.head 5 +  Function: setPassp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nPassp = nVal
.head 7 -  Return TRUE
.head 5 +  Function: getSer
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sSer
.head 5 +  Function: setSer
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sSer = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getNumDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNumDoc
.head 5 +  Function: setNumDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNumDoc = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getPDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dPDate
.head 5 +  Function: setPDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dPDate = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getOrgan
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sOrgan
.head 5 +  Function: setOrgan
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sOrgan = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getBDay
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dBDay
.head 5 +  Function: setBDay
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dBDay = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getBPlace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sBPlace
.head 5 +  Function: setBPlace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sBPlace = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelD
.head 5 +  Function: setTelD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelD = sVal
.head 7 -  Return TRUE
.head 5 +  Function: getTelW
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTelW
.head 5 +  Function: setTelW
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTelW = sVal
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getActualDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dActualDate
.head 5 +  Function: setActualDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dActualDate = dVal
.head 7 -  Return TRUE
.head 5 +  Function: getEddrId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sEddrId
.head 5 +  Function: setEddrId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sEddrId = sVal
.head 7 -  Return TRUE
.head 4 -  Message Actions
.head 3 +  Functional Class: cCustElement
.head 4 -  Description: Доп. реквизиты клиента
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTag
.head 5 -  Long String: sValue
.head 5 -  Number: nParId
.head 5 -  Boolean: bEdited
.head 4 -  Functions
.head 3 +  Functional Class: cCustElementList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  Number: nCustType
.head 5 -  : List[*]
.head 6 -  Class: cCustElement
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Number: nInitCType
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum    = 0
.head 7 -  Set nRnk       = nRnkId
.head 7 -  Set nCustType  = nInitCType
.head 7 -  Set bShowKK    = bParShowKK
.head 7 -  Set nFlagVisa  = nParFlagVisa
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 7 -  String: sTag
.head 7 -  Long String: sVal
.head 7 -  String: sVal254
.head 7 -  Number: nParId
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate =
"SELECT f.tag, substr(w.value,1,500), f.parid
   INTO :sTag, :sVal, :nParId
   FROM customerw w, customer_field f
  WHERE f.tag = w.tag(+) AND w.rnk(+) = :nRnk and nvl(f.hist,0) = 0
  ORDER BY f.tag"
.head 7 +  Else
.head 8 -  Set sSqlPopulate =
"SELECT f.tag, substr(w.value,1,500), f.parid
   INTO :sTag, :sVal, :nParId
   FROM clv_customerw w, customer_field f 
  WHERE f.tag = w.tag(+) AND w.rnk(+) = :nRnk and nvl(f.hist,0) = 0
  ORDER BY f.tag"
.head 7 -  ! Список населяем всеми доп. реквизитами - из customerw
.head 7 -  Call SqlSetLongBindDatatype(2, 22)
.head 7 +  If NOT SqlPrepareAndExecute( hSql, sSqlPopulate)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].sTag    = sTag
.head 8 -  Set List[nParNum].sValue  = sVal
.head 8 -  Set List[nParNum].bEdited = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  ! Список населяем всеми доп. реквизитами - из customerpv
.head 7 +  If NOT SqlPrepareAndExecute( hSql, 
"SELECT f.tag, v.val, f.parid
   INTO :sTag, :sVal254, :nParId
   from customer_field f, customerpv v
  where nvl(f.hist,0) = 1
    and f.parid = v.parid(+)
    and v.rnk(+) = :nRnk
    and bankdate between v.dat1(+) and v.dat2(+)
  ORDER BY f.tag")
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].sTag    = sTag
.head 8 -  Set List[nParNum].sValue  = sVal254
.head 8 -  Set List[nParNum].bEdited = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  String: sTag
.head 7 -  String: sVal
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].bEdited 
.head 9 -  Set sTag = List[nIterator].sTag
.head 9 -  Set sVal = List[nIterator].sValue
.head 9 -  Set List[nIterator].bEdited = FALSE
.head 9 +  If NOT SqlPLSQLCommand(hSql, "KL.setCustomerElement(nRnk, sTag, sVal, 0, nFlagVisa)" )
.head 10 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexByTag
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT sTag
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If SalStrUpperX(SalStrTrimX(List[nIterator].sTag)) = SalStrUpperX(SalStrTrimX(sTag))
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 +  Function: getEditFlag
.head 6 -  Description: Получить значение признака редактирования по имени параметра
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByTag(sTag)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return List[nIndex].bEdited
.head 5 +  Function: getValue
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByTag(sTag)
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sValue
.head 5 +  Function: setValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTag
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByTag(sTag)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sValue  = sValue
.head 7 -  Set List[nIndex].bEdited = TRUE
.head 7 -  Return TRUE
.head 3 +  Functional Class: cCustAddress
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nTypeId
.head 5 -  Number: nCountry
.head 5 -  String: sZip
.head 5 -  String: sDomain
.head 5 -  String: sRegion
.head 5 -  String: sLocality
.head 5 -  String: sAddress
.head 5 -  Number: nTerritoryId
.head 5 -  Number: nLocalityType
.head 5 -  Number: nStreetType
.head 5 -  String: sStreet
.head 5 -  Number: nHomeType
.head 5 -  String: sHome
.head 5 -  Number: nHomepartType
.head 5 -  String: sHomepart
.head 5 -  Number: nRoomType
.head 5 -  String: sRoom
.head 5 -  Long String: sComm
.head 4 -  Functions
.head 3 +  Functional Class: cCustAddressList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  : List[*]
.head 6 -  Class: cCustAddress
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  Set nRnk    = nRnkId
.head 7 -  Set bShowKK = bParShowKK
.head 7 -  Set nFlagVisa = nParFlagVisa
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 7 -  Number: nAdrTypeId
.head 7 -  Number: nAdrCountry
.head 7 -  String: sAdrZip
.head 7 -  String: sAdrDomain
.head 7 -  String: sAdrRegion
.head 7 -  String: sAdrLocality
.head 7 -  String: sAdrAddress
.head 7 -  Number: nTerritoryId
.head 7 -  Number: nAdrLocalityType
.head 7 -  Number: nAdrStreetType
.head 7 -  String: sAdrStreet
.head 7 -  Number: nAdrHomeType
.head 7 -  String: sAdrHome
.head 7 -  Number: nAdrHomepartType
.head 7 -  String: sAdrHomepart
.head 7 -  Number: nAdrRoomType
.head 7 -  String: sAdrRoom
.head 7 -  Long String: sAdrComm
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate =
"SELECT b.id, a.country, a.zip, a.domain, a.region, 
        a.locality, a.address, a.territory_id,
        a.locality_type, a.street_type, a.street,
        a.home_type, a.home, a.homepart_type, a.homepart,
        a.room_type, a.room, a.comm
   INTO :nAdrTypeId, :nAdrCountry, :sAdrZip, :sAdrDomain, :sAdrRegion, 
        :sAdrLocality, :sAdrAddress, :nTerritoryId,
        :nAdrLocalityType, :nAdrStreetType, :sAdrStreet,
        :nAdrHomeType, :sAdrHome, :nAdrHomepartType, :sAdrHomepart,
        :nAdrRoomType, :sAdrRoom, :sAdrComm
   FROM customer_address a, customer_address_type b 
  WHERE a.rnk(+) = :nRnk and a.type_id(+) = b.id
  ORDER BY b.id"
.head 7 +  Else
.head 8 -  Set sSqlPopulate =
"SELECT b.id, a.country, a.zip, a.domain, a.region, 
        a.locality, a.address, a.territory_id,
        a.locality_type, a.street_type, a.street,
        a.home_type, a.home, a.homepart_type, a.homepart,
        a.room_type, a.room, a.comm
   INTO :nAdrTypeId, :nAdrCountry, :sAdrZip, :sAdrDomain, :sAdrRegion, 
        :sAdrLocality, :sAdrAddress, :nTerritoryId,
        :nAdrLocalityType, :nAdrStreetType, :sAdrStreet,
        :nAdrHomeType, :sAdrHome, :nAdrHomepartType, :sAdrHomepart,
        :nAdrRoomType, :sAdrRoom, :sAdrComm
   FROM clv_customer_address a, customer_address_type b 
  WHERE a.rnk(+) = :nRnk and a.type_id(+) = b.id
  ORDER BY b.id"
.head 7 -  Call SqlSetLongBindDatatype(18, 22)
.head 7 -  Call SqlPrepareAndExecute(hSql, sSqlPopulate)
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nTypeId   = nAdrTypeId
.head 8 -  Set List[nParNum].nCountry  = nAdrCountry
.head 8 -  Set List[nParNum].sZip      = sAdrZip
.head 8 -  Set List[nParNum].sDomain   = sAdrDomain
.head 8 -  Set List[nParNum].sRegion   = sAdrRegion
.head 8 -  Set List[nParNum].sLocality = sAdrLocality
.head 8 -  Set List[nParNum].sAddress  = sAdrAddress
.head 8 -  Set List[nParNum].nTerritoryId  = nTerritoryId
.head 8 -  Set List[nParNum].nLocalityType = nAdrLocalityType
.head 8 -  Set List[nParNum].nStreetType   = nAdrStreetType
.head 8 -  Set List[nParNum].sStreet       = sAdrStreet
.head 8 -  Set List[nParNum].nHomeType     = nAdrHomeType
.head 8 -  Set List[nParNum].sHome         = sAdrHome
.head 8 -  Set List[nParNum].nHomepartType = nAdrHomepartType
.head 8 -  Set List[nParNum].sHomepart     = sAdrHomepart
.head 8 -  Set List[nParNum].nRoomType     = nAdrRoomType
.head 8 -  Set List[nParNum].sRoom         = sAdrRoom
.head 8 -  Set List[nParNum].sComm         = sAdrComm
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nAdrTypeId
.head 7 -  Number: nAdrCountry
.head 7 -  String: sAdrZip
.head 7 -  String: sAdrDomain
.head 7 -  String: sAdrRegion
.head 7 -  String: sAdrLocality
.head 7 -  String: sAdrAddress
.head 7 -  Number: nTerritoryId
.head 7 -  Number: nAdrLocalityType
.head 7 -  Number: nAdrStreetType
.head 7 -  String: sAdrStreet
.head 7 -  Number: nAdrHomeType
.head 7 -  String: sAdrHome
.head 7 -  Number: nAdrHomepartType
.head 7 -  String: sAdrHomepart
.head 7 -  Number: nAdrRoomType
.head 7 -  String: sAdrRoom
.head 7 -  Long String: sAdrComm
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  Set nAdrTypeId   = List[nIterator].nTypeId
.head 8 -  Set nAdrCountry  = List[nIterator].nCountry
.head 8 -  Set sAdrZip      = List[nIterator].sZip
.head 8 -  Set sAdrDomain   = List[nIterator].sDomain
.head 8 -  Set sAdrRegion   = List[nIterator].sRegion
.head 8 -  Set sAdrLocality = List[nIterator].sLocality
.head 8 -  Set sAdrAddress  = List[nIterator].sAddress
.head 8 -  Set nTerritoryId = List[nIterator].nTerritoryId
.head 8 -  Set nAdrLocalityType = List[nIterator].nLocalityType
.head 8 -  Set nAdrStreetType   = List[nIterator].nStreetType
.head 8 -  Set sAdrStreet       = List[nIterator].sStreet
.head 8 -  Set nAdrHomeType     = List[nIterator].nHomeType
.head 8 -  Set sAdrHome         = List[nIterator].sHome
.head 8 -  Set nAdrHomepartType = List[nIterator].nHomepartType
.head 8 -  Set sAdrHomepart     = List[nIterator].sHomepart
.head 8 -  Set nAdrRoomType     = List[nIterator].nRoomType
.head 8 -  Set sAdrRoom         = List[nIterator].sRoom
.head 8 -  Set sAdrComm         = List[nIterator].sComm
.head 8 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setFullCustomerAddress(nRnk, nAdrTypeId, nAdrCountry, 
    sAdrZip, sAdrDomain, sAdrRegion, sAdrLocality, sAdrAddress, nTerritoryId,
    nAdrLocalityType, nAdrStreetType, sAdrStreet,
    nAdrHomeType, sAdrHome, nAdrHomepartType, sAdrHomepart,
    nAdrRoomType, sAdrRoom, sAdrComm, nFlagVisa)")
.head 9 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexById
.head 6 -  Description: получить индекс параметра в массиве по TypeId
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nTypeId = nId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 3 +  Functional Class: cCorpAcc
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nId
.head 5 -  String: sMfo
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  String: sComm
.head 5 -  String: sBankName
.head 5 -  String: sSW56_Name
.head 5 -  String: sSW56_Adr
.head 5 -  String: sSW56_Code
.head 5 -  String: sSW57_Name
.head 5 -  String: sSW57_Adr
.head 5 -  String: sSW57_Code
.head 5 -  String: sSW57_Acc
.head 5 -  String: sSW59_Name
.head 5 -  String: sSW59_Adr
.head 5 -  String: sSW59_Acc
.head 5 -  Boolean: bDelete
.head 4 -  Functions
.head 3 +  Functional Class: cCorpAccList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  : List[*]
.head 6 -  Class: cCorpAcc
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 -  Set nRnk    = nRnkId
.head 7 -  Set bShowKK = bParShowKK
.head 7 -  Set nFlagVisa = nParFlagVisa
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 7 -  Number: nAccId
.head 7 -  String: sAccMfo
.head 7 -  String: sAccNls
.head 7 -  Number: nAccKv
.head 7 -  String: sAccComm
.head 7 -  String: sBankName
.head 7 -  String: sAccSW56_Name
.head 7 -  String: sAccSW56_Adr
.head 7 -  String: sAccSW56_Code
.head 7 -  String: sAccSW57_Name
.head 7 -  String: sAccSW57_Adr
.head 7 -  String: sAccSW57_Code
.head 7 -  String: sAccSW57_Acc
.head 7 -  String: sAccSW59_Name
.head 7 -  String: sAccSW59_Adr
.head 7 -  String: sAccSW59_Acc
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate =
"select c.id, c.mfo, c.nls, c.kv, c.comments, b.nb,
        c.sw56_name, c.sw56_adr, c.sw56_code,
        c.sw57_name, c.sw57_adr, c.sw57_code, c.sw57_acc,
        c.sw59_name, c.sw59_adr, c.sw59_acc
   into :nAccId, :sAccMfo, :sAccNls, :nAccKv, :sAccComm, :sBankName,
        :sAccSW56_Name, :sAccSW56_Adr, :sAccSW56_Code,
        :sAccSW57_Name, :sAccSW57_Adr, :sAccSW57_Code, :sAccSW57_Acc,
        :sAccSW59_Name, :sAccSW59_Adr, :sAccSW59_Acc
   from corps_acc c, banks b
  where c.rnk = :nRnk and c.mfo = b.mfo
  order by c.mfo, c.nls, c.kv"
.head 7 +  Else
.head 8 -  Set sSqlPopulate =
"select c.id, c.mfo, c.nls, c.kv, c.comments, b.nb,
        null, null, null, null, null, null, null, null, null, null
   into :nAccId, :sAccMfo, :sAccNls, :nAccKv, :sAccComm, :sBankName,
        :sAccSW56_Name, :sAccSW56_Adr, :sAccSW56_Code,
        :sAccSW57_Name, :sAccSW57_Adr, :sAccSW57_Code, :sAccSW57_Acc,
        :sAccSW59_Name, :sAccSW59_Adr, :sAccSW59_Acc
   from clv_corps_acc c, banks b
  where c.rnk = :nRnk and c.mfo = b.mfo
  order by c.mfo, c.nls, c.kv"
.head 7 -  Call SqlPrepareAndExecute(hSql, sSqlPopulate)
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nId   = nAccId
.head 8 -  Set List[nParNum].sMfo  = sAccMfo
.head 8 -  Set List[nParNum].sNls  = sAccNls
.head 8 -  Set List[nParNum].nKv   = nAccKv
.head 8 -  Set List[nParNum].sComm = sAccComm
.head 8 -  Set List[nParNum].sBankName = sBankName
.head 8 -  Set List[nParNum].sSW56_Name = sAccSW56_Name
.head 8 -  Set List[nParNum].sSW56_Adr  = sAccSW56_Adr
.head 8 -  Set List[nParNum].sSW56_Code = sAccSW56_Code
.head 8 -  Set List[nParNum].sSW57_Name = sAccSW57_Name
.head 8 -  Set List[nParNum].sSW57_Adr  = sAccSW57_Adr
.head 8 -  Set List[nParNum].sSW57_Code = sAccSW57_Code
.head 8 -  Set List[nParNum].sSW57_Acc  = sAccSW57_Acc
.head 8 -  Set List[nParNum].sSW59_Name = sAccSW59_Name
.head 8 -  Set List[nParNum].sSW59_Adr  = sAccSW59_Adr
.head 8 -  Set List[nParNum].sSW59_Acc  = sAccSW59_Acc
.head 8 -  Set List[nParNum].bDelete    = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nAccId
.head 7 -  String: sAccMfo
.head 7 -  String: sAccNls
.head 7 -  Number: nAccKv
.head 7 -  String: sAccComm
.head 7 -  String: sAccSW56_Name
.head 7 -  String: sAccSW56_Adr
.head 7 -  String: sAccSW56_Code
.head 7 -  String: sAccSW57_Name
.head 7 -  String: sAccSW57_Adr
.head 7 -  String: sAccSW57_Code
.head 7 -  String: sAccSW57_Acc
.head 7 -  String: sAccSW59_Name
.head 7 -  String: sAccSW59_Adr
.head 7 -  String: sAccSW59_Acc
.head 7 -  Boolean: bDelete
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  Set nAccId   = List[nIterator].nId
.head 8 -  Set sAccMfo  = List[nIterator].sMfo
.head 8 -  Set sAccNls  = List[nIterator].sNls
.head 8 -  Set nAccKv   = List[nIterator].nKv
.head 8 -  Set sAccComm = List[nIterator].sComm
.head 8 -  Set sAccSW56_Name = List[nIterator].sSW56_Name
.head 8 -  Set sAccSW56_Adr  = List[nIterator].sSW56_Adr
.head 8 -  Set sAccSW56_Code = List[nIterator].sSW56_Code
.head 8 -  Set sAccSW57_Name = List[nIterator].sSW57_Name
.head 8 -  Set sAccSW57_Adr  = List[nIterator].sSW57_Adr
.head 8 -  Set sAccSW57_Code = List[nIterator].sSW57_Code
.head 8 -  Set sAccSW57_Acc  = List[nIterator].sSW57_Acc
.head 8 -  Set sAccSW59_Name = List[nIterator].sSW59_Name
.head 8 -  Set sAccSW59_Adr  = List[nIterator].sSW59_Adr 
.head 8 -  Set sAccSW59_Acc  = List[nIterator].sSW59_Acc
.head 8 -  Set bDelete       = List[nIterator].bDelete
.head 8 +  If bDelete
.head 9 +  If NOT SqlPLSQLCommand(hSql, "KL.delCorpAcc(nAccId, nFlagVisa)")
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setCorpAccEx(nRnk, nAccId, sAccMfo, sAccNls, nAccKv, sAccComm,
 sAccSW56_Name, sAccSW56_Adr, sAccSW56_Code, 
 sAccSW57_Name, sAccSW57_Adr, sAccSW57_Code, sAccSW57_Acc,
 sAccSW59_Name, sAccSW59_Adr, sAccSW59_Acc, nFlagVisa)")
.head 10 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Call Populate(hSql)
.head 7 -  Return TRUE
.head 5 +  Function: Insert
.head 6 -  Description: Добавить значения
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Receive Number: nListIndex
.head 7 -  String: sAccMfo
.head 7 -  String: sAccNls
.head 7 -  Number: nAccKv
.head 7 -  String: sAccComm
.head 7 -  String: sAccSW56_Name
.head 7 -  String: sAccSW56_Adr
.head 7 -  String: sAccSW56_Code
.head 7 -  String: sAccSW57_Name
.head 7 -  String: sAccSW57_Adr
.head 7 -  String: sAccSW57_Code
.head 7 -  String: sAccSW57_Acc
.head 7 -  String: sAccSW59_Name
.head 7 -  String: sAccSW59_Adr
.head 7 -  String: sAccSW59_Acc
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 6 +  Actions
.head 7 +  If sAccMfo != '' AND
   sAccNls != ''
.head 8 -  Set nIterator  = nParNum
.head 8 -  Set nListIndex = nParNum
.head 8 -  Set List[nIterator].nId   = NUMBER_Null
.head 8 -  Set List[nIterator].sMfo  = sAccMfo
.head 8 -  Set List[nIterator].sNls  = sAccNls
.head 8 -  Set List[nIterator].nKv   = nAccKv
.head 8 -  Set List[nIterator].sComm = sAccComm
.head 8 -  Set List[nIterator].sSW56_Name = sAccSW56_Name
.head 8 -  Set List[nIterator].sSW56_Adr  = sAccSW56_Adr
.head 8 -  Set List[nIterator].sSW56_Code = sAccSW56_Code
.head 8 -  Set List[nIterator].sSW57_Name = sAccSW57_Name
.head 8 -  Set List[nIterator].sSW57_Adr  = sAccSW57_Adr
.head 8 -  Set List[nIterator].sSW57_Code = sAccSW57_Code
.head 8 -  Set List[nIterator].sSW57_Acc  = sAccSW57_Acc
.head 8 -  Set List[nIterator].sSW59_Name = sAccSW59_Name
.head 8 -  Set List[nIterator].sSW59_Adr  = sAccSW59_Adr
.head 8 -  Set List[nIterator].sSW59_Acc  = sAccSW59_Acc
.head 8 -  !
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Delete
.head 6 -  Description: Удалить значение
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Sql Handle: hSql
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 6 +  Actions
.head 7 +  ! If NOT SqlPLSQLCommand(hSql, "KL.delCorpAcc(nId, nFlagVisa)")
.head 8 -  Return FALSE
.head 7 -  Set nIterator = getIndexById(nId)
.head 7 +  If nIterator != -1
.head 8 -  Set List[nIterator].bDelete = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexById
.head 6 -  Description: получить индекс параметра в массиве по TypeId
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nId = nId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 -  !
.head 5 +  Function: getId
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nId
.head 5 +  Function: setId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nId = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getMfo
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sMfo
.head 5 +  Function: setMfo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sMfo = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getNls
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sNls
.head 5 +  Function: setNls
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sNls = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getKv
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nKv
.head 5 +  Function: setKv
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nKv = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getComm
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sComm
.head 5 +  Function: setComm
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sComm = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW56_Name
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW56_Name
.head 5 +  Function: setSW56_Name
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW56_Name = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW56_Adr
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW56_Adr
.head 5 +  Function: setSW56_Adr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW56_Adr = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW56_Code
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW56_Code
.head 5 +  Function: setSW56_Code
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW56_Code = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW57_Name
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW57_Name
.head 5 +  Function: setSW57_Name
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW57_Name = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW57_Adr
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW57_Adr
.head 5 +  Function: setSW57_Adr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW57_Adr = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW57_Code
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW57_Code
.head 5 +  Function: setSW57_Code
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW57_Code = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW57_Acc
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW57_Acc
.head 5 +  Function: setSW57_Acc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW57_Acc = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW59_Name
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW59_Name
.head 5 +  Function: setSW59_Name
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW59_Name = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW59_Adr
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW59_Adr
.head 5 +  Function: setSW59_Adr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW59_Adr = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSW59_Acc
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSW59_Acc
.head 5 +  Function: setSW59_Acc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSW59_Acc = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getBankName
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sBankName
.head 3 +  Functional Class: cCustRel
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRelRnk		! number(22)	Ид (Id/Rnk) связ. лица
.head 5 -  Number: nIntExt		! number(1)	1-наш клиент, 0-не наш клиент
.head 5 -  String: sName		! varchar2(70)	ФИО / Наименование
.head 5 -  Number: nDocType	! number(22)	Тип документа
.head 5 -  String: sDocSerial	! varchar2(30)	Серия документв
.head 5 -  String: sDocNumber	! varchar2(22)	Номер документа
.head 5 -  Date/Time: dDocDate	! date		Дата выдачи документа
.head 5 -  String: sDocIssuer	! varchar2(70)	Место выдачи документа
.head 5 -  Date/Time: dBirthday	! date		Дата рождения
.head 5 -  String: sBirthplace	! varchar2(70)	Место рождения
.head 5 -  String: sSex		! char(1) 	Пол
.head 5 -  String: sAdr		! varchar2(100)	Адрес
.head 5 -  String: sTel		! varchar2(100)	Телефон
.head 5 -  String: sEMail		! varchar2(100)	EMail
.head 5 -  Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 5 -  String: sOkpo		! varchar2(10)	ОКПО
.head 5 -  Number: nCountry	! number(3)	Код страны
.head 5 -  String: sRegion		! varchar2(2)	Код региона
.head 5 -  String: sFs		! char(2)	Форма собственности (K081)
.head 5 -  String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 5 -  String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 5 -  String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 5 -  String: sNotes		! varchar(80)   Примечание
.head 5 -  Boolean: bEdit		! Признак: сохранить связь
.head 5 -  Boolean: bDelete	! Признак: удалить связь
.head 4 -  Functions
.head 3 +  Functional Class: cCustRelList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  : List[*]
.head 6 -  Class: cCustRel
.head 5 -  Number: nParNum
.head 5 -  : RelList[*]
.head 6 -  Class: cRelations
.head 5 -  Number: nRelParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nParNum    = 0
.head 7 -  Set nRelParNum = 0
.head 7 -  Set bShowKK    = bParShowKK
.head 7 -  Set nFlagVisa  = nParFlagVisa
.head 7 -  Call setRnk(nRnkId)
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSqlPopulate
.head 7 -  Number: nRelId		! number(22)	Ид связи
.head 7 -  Number: nRelRnk		! number(22)	Ид (Id/Rnk) связ. лица
.head 7 -  Number: nIntExt		! number(1)	1-наш клиент, 0-не наш клиент
.head 7 -  String: sName		! varchar2(70)	Наименование/ФИО
.head 7 -  Number: nDocType	! number(22)	Тип документа
.head 7 -  String: sDocSerial	! varchar2(30)	Серия документв
.head 7 -  String: sDocNumber	! varchar2(22)	Номер документа
.head 7 -  Date/Time: dDocDate	! date		Дата выдачи документа
.head 7 -  String: sDocIssuer	! varchar2(70)	Место выдачи документа
.head 7 -  Date/Time: dBirthday	! date		Дата рождения
.head 7 -  String: sBirthplace	! varchar2(70)	Место рождения
.head 7 -  String: sSex		! char(1) 	Пол
.head 7 -  String: sAdr		! varchar2(100)	Адрес
.head 7 -  String: sTel		! varchar2(100)	Телефон
.head 7 -  String: sEMail		! varchar2(100)	EMail
.head 7 -  Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 7 -  String: sOkpo		! varchar2(10)	ОКПО
.head 7 -  Number: nCountry	! number(3)	Код страны
.head 7 -  String: sRegion		! varchar2(2)	Код региона
.head 7 -  String: sFs		! char(2)	Форма собственности (K081)
.head 7 -  String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 7 -  String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 7 -  String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 7 -  String: sNotes		! varchar2(80)	Примечание
.head 7 -  Number: nVaga1			! number(6,2)	Удельный вес прямого участия в уставном фонде
.head 7 -  Number: nVaga2			! number(6,2)	Удельный вес опосредствованного участия в уставном фонде
.head 7 -  Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  String: sPosition		! varchar2(100)	Должность
.head 7 -  String: sPosition_r		! varchar2(100)	Должность в род. падеже
.head 7 -  String: sFirstName		! varchar2(70)	Имя
.head 7 -  String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 7 -  Number: nTmpRelRnk
.head 7 -  Number: nListIndex
.head 7 -  Number: nRelListIndex
.head 6 +  Actions
.head 7 -  Set nTmpRelRnk = NUMBER_Null
.head 7 -  Set nParNum    = 0
.head 7 -  Set nRelParNum = 0
.head 7 +  If bShowKK
.head 8 -  Set sSqlPopulate = 
"select rel_id, rel_rnk, rel_intext, name, doc_type, doc_serial, doc_number,
        doc_date, doc_issuer, birthday, birthplace, sex, adr, tel, email,
        custtype, okpo, country, region, fs, ved, sed, ise, notes,
        vaga1, vaga2, type_id, position, position_r, first_name, middle_name, last_name, 
        document_type_id, document, trust_regnum, trust_regdat, bdate, edate, 
        notary_name, notary_region, sign_privs, sign_id, name_r
   from v_customer_rel 
  where rnk=:nRnk
  order by rel_rnk"
.head 7 +  Else
.head 8 -  Set sSqlPopulate = 
"select rel_id, rel_rnk, rel_intext, name, doc_type, doc_serial, doc_number,
        doc_date, doc_issuer, birthday, birthplace, sex, adr, tel, email,
        custtype, okpo, country, region, fs, ved, sed, ise, notes,
        vaga1, vaga2, type_id, position, position_r, first_name, middle_name, last_name, 
        document_type_id, document, trust_regnum, trust_regdat, bdate, edate, 
        notary_name, notary_region, sign_privs, sign_id, name_r
   from (select rnk, rel_id, rel_rnk, rel_intext, name, 
       doc_type, doc_serial, doc_number, doc_date, doc_issuer, 
       birthday, birthplace, sex, adr, tel, email,
       custtype, okpo, country, region, fs, ved, sed, ise, notes,
       vaga1, vaga2,           
       type_id, position, position_r, first_name, middle_name, last_name, 
       document_type_id, document, trust_regnum, trust_regdat, 
       bdate, edate, notary_name, notary_region,   
       sign_privs, sign_id, name_r
  from ( select r.rnk, r.rel_id, c.id rel_rnk, r.rel_intext, c.name, 
                c.doc_type, c.doc_serial, c.doc_number,
                c.doc_date, c.doc_issuer, c.birthday, c.birthplace, 
                c.sex, c.adr, c.tel, c.email,
                c.custtype, c.okpo, c.country, c.region, 
                c.fs, c.ved, c.sed, c.ise, c.notes,
                r.vaga1, r.vaga2, 
                r.type_id, r.position, r.position_r, r.first_name, r.middle_name, r.last_name,
                r.document_type_id, r.document,        
                r.trust_regnum, r.trust_regdat, r.bdate, r.edate, 
                r.notary_name, r.notary_region,   
                r.sign_privs, r.sign_id, r.name_r
           from clv_customer_rel r, customer_extern c 
          where r.rel_intext=0 and r.rel_rnk=c.id   
          union all
         select r.rnk, r.rel_id, c.rnk, r.rel_intext, c.nmk, p.passp, p.ser, p.numdoc, 
                p.pdate, p.organ, p.bday, p.bplace, 
                nvl(p.sex,0), c.adr, 
                decode(c.custtype,3,p.teld,s.telr), 
                decode(c.custtype,3,substr(trim(w.value),1,254),s.e_mail),
                decode(c.custtype,3,2,1), c.okpo, c.country, to_char(c.c_reg), 
                c.fs, c.ved, c.sed, c.ise, substr(trim(m.value),1,254),
                r.vaga1, r.vaga2, 
                r.type_id, r.position, r.position_r, r.first_name, r.middle_name, r.last_name,
                r.document_type_id, r.document,        
                r.trust_regnum, r.trust_regdat, r.bdate, r.edate, 
                r.notary_name, r.notary_region,   
                r.sign_privs, r.sign_id, r.name_r
           from clv_customer_rel r, customer c, person p, clv_customerw w, customerw m, corps s
          where r.rel_intext=1 and r.rel_rnk=c.rnk 
            and c.rnk=p.rnk(+)
            and r.rnk=w.rnk(+) and w.tag(+)='EMAIL'
            and c.rnk=m.rnk(+) and m.tag(+)='RCOMM'
            and c.rnk=s.rnk(+) ) ) v_customer_rel 
  where rnk=:nRnk
  order by rel_rnk"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sSqlPopulate ||
"  into :nRelId, :nRelRnk, :nIntExt, :sName, :nDocType, :sDocSerial, :sDocNumber,
        :dDocDate, :sDocIssuer, :dBirthday, :sBirthplace, :sSex, :sAdr, :sTel, :sEMail,
        :nCusttype, :sOkpo, :nCountry, :sRegion, :sFs, :sVed, :sSed, :sIse, :sNotes,
        :nVaga1, :nVaga2, :nTypeId, :sPosition, :sPosition_r, :sFirstName, :sMiddleName, :sLastName, 
        :nDocumentTypeId, :sDocument, :sTrustRegnum, :dTrustRegdat, :dBDate, :dEDate, 
        :sNotaryName, :sNotaryRegion, :nSignPrivs, :nSignId, :sNameR")
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 +  If nTmpRelRnk != nRelRnk
.head 9 -  Call insert(nListIndex, nRelRnk, nIntExt, sName, 
     nDocType, sDocSerial, sDocNumber, dDocDate, sDocIssuer, dBirthday, sBirthplace,
     sSex, sAdr, sTel, sEMail, nCusttype, sOkpo, nCountry, sRegion, 
     sFs, sVed, sSed, sIse, sNotes)
.head 9 -  Set nTmpRelRnk = nRelRnk
.head 8 -  Call insRelation(nRelListIndex, nListIndex, nRelId, nVaga1, nVaga2, 
     nTypeId, sPosition, sPosition_r, sFirstName, sMiddleName, sLastName, 
     nDocumentTypeId, sDocument, sTrustRegnum, dTrustRegdat, dBDate, dEDate, 
     sNotaryName, sNotaryRegion, nSignPrivs, nSignId, sNameR)
.head 7 -  Return TRUE
.head 5 +  Function: Save
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRelRnk		! number(22)	Ид (Id/Rnk) связ. лица
.head 7 -  Number: nIntExt		! number(1)	1-наш клиент, 0-не наш клиент
.head 7 -  String: sName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocType	! number(22)	Тип документа
.head 7 -  String: sDocSerial	! varchar2(30)	Серия документв
.head 7 -  String: sDocNumber	! varchar2(22)	Номер документа
.head 7 -  Date/Time: dDocDate	! date		Дата выдачи документа
.head 7 -  String: sDocIssuer	! varchar2(70)	Место выдачи документа
.head 7 -  Date/Time: dBirthday	! date		Дата рождения
.head 7 -  String: sBirthplace	! varchar2(70)	Место рождения
.head 7 -  String: sSex		! char(1) 	Пол
.head 7 -  String: sAdr		! varchar2(100)	Адрес
.head 7 -  String: sTel		! varchar2(100)	Телефон
.head 7 -  String: sEMail		! varchar2(100)	EMail
.head 7 -  Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 7 -  String: sOkpo		! varchar2(10)	ОКПО
.head 7 -  Number: nCountry	! number(3)	Код страны
.head 7 -  String: sRegion		! varchar2(2)	Код региона
.head 7 -  String: sFs		! char(2)	Форма собственности (K081)
.head 7 -  String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 7 -  String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 7 -  String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 7 -  String: sNotes		! varchar2(80)	Примечание
.head 7 -  !
.head 7 -  Number: nIterator
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 -  Set nRelRnk = List[nIterator].nRelRnk
.head 8 -  Set nIntExt = List[nIterator].nIntExt
.head 8 -  !
.head 8 -  ! insert/update
.head 8 +  If not List[nIterator].bDelete  
.head 9 -  ! Сохраняем только измененные строки
.head 9 +  If List[nIterator].bEdit
.head 10 -  ! Сохраняем только не наших клиентов
.head 10 +  If nIntExt = 0
.head 11 -  Set sName       = List[nIterator].sName
.head 11 -  Set nDocType    = List[nIterator].nDocType
.head 11 -  Set sDocSerial  = List[nIterator].sDocSerial
.head 11 -  Set sDocNumber  = List[nIterator].sDocNumber
.head 11 -  Set dDocDate    = List[nIterator].dDocDate
.head 11 -  Set sDocIssuer  = List[nIterator].sDocIssuer
.head 11 -  Set dBirthday   = List[nIterator].dBirthday
.head 11 -  Set sBirthplace = List[nIterator].sBirthplace
.head 11 -  Set sSex        = List[nIterator].sSex
.head 11 -  Set sAdr        = List[nIterator].sAdr
.head 11 -  Set sTel        = List[nIterator].sTel
.head 11 -  Set sEMail      = List[nIterator].sEMail
.head 11 -  Set nCusttype   = List[nIterator].nCusttype
.head 11 -  Set sOkpo       = List[nIterator].sOkpo
.head 11 -  Set nCountry    = List[nIterator].nCountry
.head 11 -  Set sRegion     = List[nIterator].sRegion
.head 11 -  Set sFs         = List[nIterator].sFs
.head 11 -  Set sVed        = List[nIterator].sVed
.head 11 -  Set sSed        = List[nIterator].sSed
.head 11 -  Set sIse        = List[nIterator].sIse
.head 11 -  Set sNotes      = List[nIterator].sNotes
.head 11 +  If not SqlPLSQLCommand(hSql, 
"KL.setCustomerExtern(nRelRnk, sName, 
    nDocType, sDocSerial, sDocNumber, dDocDate, sDocIssuer, dBirthday, sBirthplace,
    sSex, sAdr, sTel, sEMail, nCusttype, sOkpo, nCountry, sRegion, 
    sFs, sVed, sSed, sIse, sNotes)" )
.head 12 -  Return FALSE
.head 11 -  Set List[nIterator].nRelRnk = nRelRnk
.head 10 -  ! Для наших клиентов сохраняем коментарий
.head 10 +  Else
.head 11 -  Set sNotes = List[nIterator].sNotes
.head 11 +  If not SqlPLSQLCommand(hSql, "kl.setCustomerElement(nRelRnk, 'RCOMM', sNotes, 0, nFlagVisa)")
.head 12 -  Return FALSE
.head 10 -  ! Установка связей в customer_rel
.head 10 +  If not SaveRelation(hSql, nIterator, nRelRnk, nIntExt)
.head 11 -  Return FALSE
.head 8 -  ! delete
.head 8 +  Else
.head 9 -  ! Удаляем связи из customer_rel
.head 9 -  Set i = 0
.head 9 +  While i < getRelParNum()
.head 10 +  If getCustomerRel(i) = nIterator
.head 11 +  If not DeleteRelation(hSql, i, nRelRnk, nIntExt)
.head 12 -  Return FALSE
.head 10 -  Set i = i + 1
.head 8 -  !
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  !
.head 7 -  Call Populate(hSql)
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: insert
.head 6 -  Description: Добавить значения
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nListIndex
.head 7 -  Number: nRelRnk		! number(22)	Ид (Id/Rnk) связ. лица
.head 7 -  Number: nIntExt		! number(1)	1-наш клиент, 0-не наш клиент
.head 7 -  String: sName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocType	! number(22)	Тип документа
.head 7 -  String: sDocSerial	! varchar2(30)	Серия документв
.head 7 -  String: sDocNumber	! varchar2(22)	Номер документа
.head 7 -  Date/Time: dDocDate	! date		Дата выдачи документа
.head 7 -  String: sDocIssuer	! varchar2(70)	Место выдачи документа
.head 7 -  Date/Time: dBirthday	! date		Дата рождения
.head 7 -  String: sBirthplace	! varchar2(70)	Место рождения
.head 7 -  String: sSex		! char(1) 	Пол
.head 7 -  String: sAdr		! varchar2(100)	Адрес
.head 7 -  String: sTel		! varchar2(100)	Телефон
.head 7 -  String: sEMail		! varchar2(100)	EMail
.head 7 -  Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 7 -  String: sOkpo		! varchar2(10)	ОКПО
.head 7 -  Number: nCountry	! number(3)	Код страны
.head 7 -  String: sRegion		! varchar2(2)	Код региона
.head 7 -  String: sFs		! char(2)	Форма собственности (K081)
.head 7 -  String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 7 -  String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 7 -  String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 7 -  String: sNotes		! varchar2(80)	Примечание
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nListIndex = nParNum
.head 7 -  Set List[nListIndex].nRelRnk     = nRelRnk
.head 7 -  Set List[nListIndex].nIntExt     = nIntExt
.head 7 -  Set List[nListIndex].sName       = sName
.head 7 -  Set List[nListIndex].nDocType    = nDocType
.head 7 -  Set List[nListIndex].sDocSerial  = sDocSerial
.head 7 -  Set List[nListIndex].sDocNumber  = sDocNumber
.head 7 -  Set List[nListIndex].dDocDate    = dDocDate
.head 7 -  Set List[nListIndex].sDocIssuer  = sDocIssuer
.head 7 -  Set List[nListIndex].dBirthday   = dBirthday
.head 7 -  Set List[nListIndex].sBirthplace = sBirthplace
.head 7 -  Set List[nListIndex].sSex        = sSex
.head 7 -  Set List[nListIndex].sAdr        = sAdr
.head 7 -  Set List[nListIndex].sTel        = sTel
.head 7 -  Set List[nListIndex].sEMail      = sEMail
.head 7 -  Set List[nListIndex].nCusttype   = nCusttype
.head 7 -  Set List[nListIndex].sOkpo       = sOkpo
.head 7 -  Set List[nListIndex].nCountry    = nCountry
.head 7 -  Set List[nListIndex].sRegion     = sRegion
.head 7 -  Set List[nListIndex].sFs         = sFs
.head 7 -  Set List[nListIndex].sVed        = sVed
.head 7 -  Set List[nListIndex].sSed        = sSed
.head 7 -  Set List[nListIndex].sIse        = sIse
.head 7 -  Set List[nListIndex].sNotes      = sNotes
.head 7 -  Set List[nListIndex].bEdit       = FALSE
.head 7 -  Set List[nListIndex].bDelete     = FALSE
.head 7 -  !
.head 7 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: delete
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nListIndex
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 +  If nListIndex < nParNum
.head 8 -  ! Set List[nListIndex].bDelete = TRUE
.head 8 -  Call setDeletedFlag(nListIndex, TRUE)
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getRelDetails
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 7 -  Receive Number: nVaga1
.head 7 -  Receive Number: nVaga2
.head 7 -  Receive Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  Receive String: sPosition		! varchar2(100)	Должность
.head 7 -  Receive String: sPosition_r		! varchar2(100)	Должность в род. падеже
.head 7 -  Receive String: sFirstName		! varchar2(70)	Имя
.head 7 -  Receive String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  Receive String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Receive Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  Receive String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  Receive String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Receive Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Receive Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Receive Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  Receive String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  Receive String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Receive Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Receive Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  Receive String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getRelIndexById(nCustomerRel, nRelId)
.head 7 +  If nIndex != -1
.head 8 -  Set nVaga1          = getVaga1(nIndex)
.head 8 -  Set nVaga2          = getVaga2(nIndex)
.head 8 -  Set nTypeId         = getTypeId(nIndex)
.head 8 -  Set sPosition       = getPosition(nIndex)
.head 8 -  Set sPosition_r     = getPosition_r(nIndex)
.head 8 -  Set sFirstName      = getFirstName(nIndex)
.head 8 -  Set sMiddleName     = getMiddleName(nIndex)
.head 8 -  Set sLastName       = getLastName(nIndex)
.head 8 -  Set nDocumentTypeId = getDocumentTypeId(nIndex)
.head 8 -  Set sDocument       = getDocument(nIndex)
.head 8 -  Set sTrustRegnum    = getTrustRegnum(nIndex)
.head 8 -  Set dTrustRegdat    = getTrustRegdat(nIndex)
.head 8 -  Set dBDate          = getBDate(nIndex)
.head 8 -  Set dEDate          = getEDate(nIndex)
.head 8 -  Set sNotaryName     = getNotaryName(nIndex)
.head 8 -  Set sNotaryRegion   = getNotaryRegion(nIndex)
.head 8 -  Set nSignPrivs      = getSignPrivs(nIndex)
.head 8 -  Set nSignId         = getSignId(nIndex)
.head 8 -  Set sNameR          = getNameR(nIndex)
.head 7 -  Return TRUE
.head 5 +  Function: setRelDetails
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 7 -  Number: nVaga1
.head 7 -  Number: nVaga2
.head 7 -  Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  String: sPosition		! varchar2(100)	Должность
.head 7 -  String: sPosition_r		! varchar2(100)	Должность в род. падеже
.head 7 -  String: sFirstName		! varchar2(70)	Имя
.head 7 -  String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getRelIndexById(nCustomerRel, nRelId)
.head 7 +  If nIndex != -1
.head 8 -  Call setVaga1(nIndex, nVaga1)
.head 8 -  Call setVaga2(nIndex, nVaga2)
.head 8 -  Call setTypeId(nIndex, nTypeId)
.head 8 -  Call setPosition(nIndex, sPosition)
.head 8 -  Call setPosition_r(nIndex, sPosition_r)
.head 8 -  Call setFirstName(nIndex, sFirstName)
.head 8 -  Call setMiddleName(nIndex, sMiddleName)
.head 8 -  Call setLastName(nIndex, sLastName)
.head 8 -  Call setDocumentTypeId(nIndex, nDocumentTypeId)
.head 8 -  Call setDocument(nIndex, sDocument)
.head 8 -  Call setTrustRegnum(nIndex,sTrustRegnum)
.head 8 -  Call setTrustRegdat(nIndex, dTrustRegdat)
.head 8 -  Call setBDate(nIndex, dBDate)
.head 8 -  Call setEDate(nIndex, dEDate)
.head 8 -  Call setNotaryName(nIndex, sNotaryName)
.head 8 -  Call setNotaryRegion(nIndex, sNotaryRegion)
.head 8 -  Call setSignPrivs(nIndex, nSignPrivs)
.head 8 -  Call setSignId(nIndex, nSignId)
.head 8 -  Call setNameR(nIndex, sNameR)
.head 7 -  Return TRUE
.head 5 +  Function: checkRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nCustomerRel
.head 7 -  Receive Number: nRelId
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sPar = ''
.head 7 -  Call checkExtern(nCustomerRel, sPar)
.head 7 +  If not sPar
.head 8 -  Return checkRelDetails(nCustomerRel, nRelId, sPar)
.head 7 -  Return TRUE
.head 5 +  Function: checkExtern
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nCustomerRel
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nDocType	! number(22)	Тип документа
.head 7 -  Number: nCusttype	! number(1)	Признак (1-ЮЛ, 2-ФЛ)
.head 7 -  String: sOkpo		! varchar2(10)	ОКПО
.head 7 -  Number: nCountry	! number(3)	Код страны
.head 7 -  String: sRegion		! varchar2(2)	Код региона
.head 7 -  String: sFs		! char(2)	Форма собственности (K081)
.head 7 -  String: sVed		! char(5)	Вид эк. деят-ти (K110)
.head 7 -  String: sSed		! char(4)	Орг.-правовая форма (K051)
.head 7 -  String: sIse		! char(5)	Инст. сектор экономики (K070)
.head 7 -  Boolean: bFound
.head 6 +  Actions
.head 7 -  Set nCustomerRel = NUMBER_Null
.head 7 -  Set sPar = STRING_Null
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].bDelete = FALSE
.head 9 -  ! Сначала проверка: есть связи?
.head 9 +  If not isRelationByCustomerRel(nIterator)
.head 10 -  Set sPar = REL_RELATIONS
.head 9 -  ! Для НЕклиентов банка проверка на заполнение обязат. полей
.head 9 +  Else If List[nIterator].nIntExt = 0
.head 10 -  Set nDocType  = List[nIterator].nDocType
.head 10 -  Set nCusttype = List[nIterator].nCusttype
.head 10 -  Set sOkpo     = List[nIterator].sOkpo
.head 10 -  Set nCountry  = List[nIterator].nCountry
.head 10 -  Set sRegion   = List[nIterator].sRegion
.head 10 -  Set sFs       = List[nIterator].sFs
.head 10 -  Set sVed      = List[nIterator].sVed
.head 10 -  Set sSed      = List[nIterator].sSed
.head 10 -  Set sIse      = List[nIterator].sIse
.head 10 -  ! Признак (1-ЮЛ, 2-ФЛ)
.head 10 +  If nCusttype = NUMBER_Null
.head 11 -  Set sPar = REL_CUSTTYPE
.head 10 -  ! Для ФЛ Тип документа
.head 10 +  Else If nCusttype = 2 and nDocType = NUMBER_Null
.head 11 -  Set sPar = REL_DOCTYPE
.head 10 -  ! ОКПО
.head 10 +  Else If sOkpo     = STRING_Null
.head 11 -  Set sPar = REL_OKPO
.head 10 -  ! Код страны
.head 10 +  Else If nCountry  = NUMBER_Null
.head 11 -  Set sPar = REL_COUNTRY
.head 10 -  ! Для резидентов
.head 10 +  Else If nCountry  = GetGlobalOptionEx('KOD_G')
.head 11 -  ! Код региона
.head 11 +  If sRegion   = STRING_Null
.head 12 -  Set sPar = REL_REGION
.head 11 -  ! Форма собственности (K081)
.head 11 +  Else If sFs  = STRING_Null
.head 12 -  Set sPar = REL_FS
.head 11 -  ! Код вида эконом. деят-ти (K110)
.head 11 +  Else If sVed = STRING_Null
.head 12 -  Set sPar = REL_VED
.head 11 -  ! Код орг.-правовой формы хозяйствования (K051)
.head 11 +  Else If sSed = STRING_Null
.head 12 -  Set sPar = REL_SED
.head 11 -  ! Код инст. сектора экономики (K070)
.head 11 +  Else If sIse = STRING_Null
.head 12 -  Set sPar = REL_ISE
.head 9 -  !
.head 9 +  If sPar
.head 10 -  Set nCustomerRel = nIterator
.head 10 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 -  !
.head 5 -  ! Relations
.head 5 +  Function: SaveRelation
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelRnk
.head 7 -  Number: nRelIntExt
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nRelParNum
.head 8 +  If getCustomerRel(nIterator) = nCustomerRel
.head 9 +  If getRelDelete(nIterator)
.head 10 +  If not DeleteRelation(hSql, nIterator, nRelRnk, nRelIntExt)
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 +  If not UpdateRelation(hSql, nIterator, nRelRnk, nRelIntExt)
.head 11 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: UpdateRelation
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Number: nRelListIndex
.head 7 -  Number: nRelRnk
.head 7 -  Number: nRelIntExt
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRelId			! number(22)	Код отношения
.head 7 -  Number: nVaga1			! number(6,2)	Удельный вес прямого участия в уставном фонде
.head 7 -  Number: nVaga2			! number(6,2)	Удельный вес опосредствованного участия в уставном фонде
.head 7 -  Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  String: sPosition		! varchar2(100)	Должность
.head 7 -  String: sPosition_r		! varchar2(100)	Должность в род. падеже
.head 7 -  String: sFirstName		! varchar2(70)	Имя
.head 7 -  String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 6 +  Actions
.head 7 +  If nRelListIndex != NUMBER_Null
.head 8 -  Set nRelId          = RelList[nRelListIndex].nRelId
.head 8 -  Set nVaga1          = RelList[nRelListIndex].nVaga1
.head 8 -  Set nVaga2          = RelList[nRelListIndex].nVaga2
.head 8 -  Set nTypeId         = RelList[nRelListIndex].nTypeId
.head 8 -  Set sPosition       = RelList[nRelListIndex].sPosition
.head 8 -  Set sPosition_r     = RelList[nRelListIndex].sPosition_r
.head 8 -  Set sFirstName      = RelList[nRelListIndex].sFirstName
.head 8 -  Set sMiddleName     = RelList[nRelListIndex].sMiddleName
.head 8 -  Set sLastName       = RelList[nRelListIndex].sLastName
.head 8 -  Set nDocumentTypeId = RelList[nRelListIndex].nDocumentTypeId
.head 8 -  Set sDocument       = RelList[nRelListIndex].sDocument
.head 8 -  Set sTrustRegnum    = RelList[nRelListIndex].sTrustRegnum
.head 8 -  Set dTrustRegdat    = RelList[nRelListIndex].dTrustRegdat
.head 8 -  Set dBDate          = RelList[nRelListIndex].dBDate
.head 8 -  Set dEDate          = RelList[nRelListIndex].dEDate
.head 8 -  Set sNotaryName     = RelList[nRelListIndex].sNotaryName
.head 8 -  Set sNotaryRegion   = RelList[nRelListIndex].sNotaryRegion
.head 8 -  Set nSignPrivs      = RelList[nRelListIndex].nSignPrivs
.head 8 -  Set nSignId         = RelList[nRelListIndex].nSignId
.head 8 -  Set sNameR          = RelList[nRelListIndex].sNameR
.head 8 +  If NOT SqlPLSQLCommand(hSql, 
"KL.setCustomerRel(nRnk, nRelId, nRelRnk, nRelIntExt, nVaga1, nVaga2, 
    nTypeId, sPosition, sPosition_r, sFirstName, sMiddleName, sLastName, 
    nDocumentTypeId, sDocument, sTrustRegnum, dTrustRegdat, 
    dBDate, dEDate, sNotaryName, sNotaryRegion, nSignPrivs, nSignId, sNameR, nFlagVisa)" )
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: DeleteRelation
.head 6 -  Description: Удалить значения из базы данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 7 -  Number: nRelListIndex
.head 7 -  Number: nRelRnk
.head 7 -  Number: nRelIntExt
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRelId
.head 6 +  Actions
.head 7 +  If nRelListIndex != NUMBER_Null
.head 8 -  Set nRelId = RelList[nRelListIndex].nRelId
.head 8 +  If not SqlPLSQLCommand(hSql, "KL.delCustomerRel(nRnk, nRelId, nRelRnk, nRelIntExt, nFlagVisa)" )
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: insRelation
.head 6 -  Description: Добавить связь + значения
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nListIndex
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId			! number(22)	Код отношения
.head 7 -  Number: nVaga1			! number(6,2)	Удельный вес прямого участия в уставном фонде
.head 7 -  Number: nVaga2			! number(6,2)	Удельный вес опосредствованного участия в уставном фонде
.head 7 -  Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  String: sPosition		! varchar2(100)	Должность
.head 7 -  String: sPosition_r		! varchar2(100)	Должность в род. падеже
.head 7 -  String: sFirstName		! varchar2(70)	Имя
.head 7 -  String: sMiddleName		! varchar2(70)	Отчество
.head 7 -  String: sLastName		! varchar2(70)	Фамилия
.head 7 -  Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 7 -  String: sDocument		! varchar2(70)	Документ доверенности
.head 7 -  String: sTrustRegnum		! varchar2(38)	Номер регистрации доверенности
.head 7 -  Date/Time: dTrustRegdat		! date		Дата регистрации доверенности
.head 7 -  Date/Time: dBDate		! date		Дата начала действия доверенности
.head 7 -  Date/Time: dEDate		! date		Дата окончания действия доверенности
.head 7 -  String: sNotaryName		! varchar2(70)	ФИО нотариуса
.head 7 -  String: sNotaryRegion		! varchar2(70)	Нотариальный округ
.head 7 -  Number: nSignPrivs		! number(1)	право подписи (0/1)
.head 7 -  Number: nSignId			! number(22)	Ид. графического представления подписи доверенного лица
.head 7 -  String: sNameR			! varchar2(100)	ФИО доверенного лица в родительном падеже
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nListIndex = nRelParNum
.head 7 -  Set RelList[nListIndex].nCustomerRel    = nCustomerRel
.head 7 -  Set RelList[nListIndex].nRelId          = nRelId
.head 7 -  Set RelList[nListIndex].nVaga1          = nVaga1
.head 7 -  Set RelList[nListIndex].nVaga2          = nVaga2
.head 7 -  Set RelList[nListIndex].nTypeId         = nTypeId
.head 7 -  Set RelList[nListIndex].sPosition       = sPosition
.head 7 -  Set RelList[nListIndex].sPosition_r     = sPosition_r
.head 7 -  Set RelList[nListIndex].sFirstName      = sFirstName
.head 7 -  Set RelList[nListIndex].sMiddleName     = sMiddleName
.head 7 -  Set RelList[nListIndex].sLastName       = sLastName
.head 7 -  Set RelList[nListIndex].nDocumentTypeId = nDocumentTypeId
.head 7 -  Set RelList[nListIndex].sDocument       = sDocument
.head 7 -  Set RelList[nListIndex].sTrustRegnum    = sTrustRegnum
.head 7 -  Set RelList[nListIndex].dTrustRegdat    = dTrustRegdat
.head 7 -  Set RelList[nListIndex].dBDate          = dBDate
.head 7 -  Set RelList[nListIndex].dEDate          = dEDate
.head 7 -  Set RelList[nListIndex].sNotaryName     = sNotaryName
.head 7 -  Set RelList[nListIndex].sNotaryRegion   = sNotaryRegion
.head 7 -  Set RelList[nListIndex].nSignPrivs      = nSignPrivs
.head 7 -  Set RelList[nListIndex].nSignId         = nSignId
.head 7 -  Set RelList[nListIndex].sNameR          = sNameR
.head 7 -  Set RelList[nListIndex].bDelete         = FALSE
.head 7 -  !
.head 7 -  Set nRelParNum = nRelParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: addRelation
.head 6 -  Description: Добавить связь
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nListIndex
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! может, уже есть (была, но удалили) такая связь?
.head 7 -  ! Если не нашли, добавляем
.head 7 +  If nListIndex = NUMBER_Null
.head 8 -  Set nListIndex = nRelParNum
.head 8 -  Set RelList[nListIndex].nCustomerRel    = nCustomerRel
.head 8 -  Set RelList[nListIndex].nRelId          = nRelId
.head 8 -  Set RelList[nListIndex].nVaga1          = NUMBER_Null
.head 8 -  Set RelList[nListIndex].nVaga2          = NUMBER_Null
.head 8 -  Set RelList[nListIndex].nTypeId         = NUMBER_Null
.head 8 -  Set RelList[nListIndex].sPosition       = STRING_Null
.head 8 -  Set RelList[nListIndex].sPosition_r     = STRING_Null
.head 8 -  Set RelList[nListIndex].sFirstName      = STRING_Null
.head 8 -  Set RelList[nListIndex].sLastName       = STRING_Null
.head 8 -  Set RelList[nListIndex].sPosition       = STRING_Null
.head 8 -  Set RelList[nListIndex].sPosition_r     = STRING_Null
.head 8 -  Set RelList[nListIndex].nDocumentTypeId = NUMBER_Null
.head 8 -  Set RelList[nListIndex].sDocument       = STRING_Null
.head 8 -  Set RelList[nListIndex].sTrustRegnum    = STRING_Null
.head 8 -  Set RelList[nListIndex].dTrustRegdat    = DATETIME_Null
.head 8 -  Set RelList[nListIndex].dBDate          = DATETIME_Null
.head 8 -  Set RelList[nListIndex].dEDate          = DATETIME_Null
.head 8 -  Set RelList[nListIndex].sNotaryName     = STRING_Null
.head 8 -  Set RelList[nListIndex].sNotaryRegion   = STRING_Null
.head 8 -  Set RelList[nListIndex].nSignPrivs      = 0
.head 8 -  Set RelList[nListIndex].nSignId         = NUMBER_Null
.head 8 -  Set RelList[nListIndex].sNameR          = STRING_Null
.head 8 -  Set RelList[nListIndex].bDelete         = FALSE
.head 8 -  !
.head 8 -  Set nRelParNum = nRelParNum + 1
.head 7 -  Set List[nListIndex].bDelete = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: delRelation
.head 6 -  Description: Удалить связь
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nListIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nListIndex < nRelParNum
.head 8 -  Set RelList[nListIndex].bDelete = TRUE
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getRelParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nRelParNum
.head 5 +  Function: getRelIndexById
.head 6 -  Description: получить индекс параметра в массиве по nCustomerRel и nRelId
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nListIndex
.head 6 +  Actions
.head 7 -  Set nListIndex = -1
.head 7 +  If nCustomerRel != NUMBER_Null and nRelId != NUMBER_Null
.head 8 -  Set nIterator = 0
.head 8 +  While nIterator < nRelParNum
.head 9 +  If RelList[nIterator].nCustomerRel = nCustomerRel and RelList[nIterator].nRelId = nRelId
.head 10 -  Set nListIndex = nIterator
.head 10 -  Break
.head 9 -  Set nIterator = nIterator + 1
.head 7 -  Return nListIndex
.head 5 +  Function: getRelation
.head 6 -  Description: есть связь?
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 7 -  Number: nRelId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nListIndex
.head 6 +  Actions
.head 7 -  Set nListIndex = NUMBER_Null
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nRelParNum
.head 8 +  If RelList[nIterator].nCustomerRel = nCustomerRel 
and RelList[nIterator].nRelId = nRelId
and RelList[nIterator].bDelete = FALSE
.head 9 -  Set nListIndex = nIterator
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return nListIndex
.head 5 +  Function: checkRelDetails
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive Number: nCustomerRel
.head 7 -  Receive Number: nRelId
.head 7 -  Receive String: sPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nTypeId			! number(22)	Ид. типа довереного лица
.head 7 -  Number: nDocumentTypeId		! number(22)	Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 6 +  Actions
.head 7 -  Set nCustomerRel = NUMBER_Null
.head 7 -  Set nRelId       = NUMBER_Null
.head 7 -  Set sPar         = STRING_Null
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nRelParNum
.head 8 +  If RelList[nIterator].nRelId = 20 and not RelList[nIterator].bDelete
.head 9 -  Set nTypeId         = RelList[nIterator].nTypeId
.head 9 -  Set nDocumentTypeId = RelList[nIterator].nDocumentTypeId
.head 9 +  If nTypeId = NUMBER_Null
.head 10 -  Set sPar = TRUSTEE_TYPEID
.head 9 +  Else If nDocumentTypeId = NUMBER_Null
.head 10 -  Set sPar = TRUSTEE_DOCUMENTTYPEID
.head 9 +  If sPar
.head 10 -  Set nCustomerRel = RelList[nIterator].nCustomerRel
.head 10 -  Set nRelId = RelList[nIterator].nRelId
.head 10 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return TRUE
.head 5 +  Function: isRelationByCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCustomerRel
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bFound
.head 7 -  Number: nIterator
.head 6 +  Actions
.head 7 -  Set bFound = FALSE
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nRelParNum
.head 8 +  If RelList[nIterator].nCustomerRel = nCustomerRel and RelList[nIterator].bDelete = FALSE
.head 9 -  Set bFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 -  Return bFound
.head 5 -  ! -----------------
.head 5 -  !
.head 5 +  Function: getRelRnk
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nRelRnk
.head 5 +  Function: setRelRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nRelRnk = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getIntExt
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nIntExt
.head 5 +  Function: setIntExt
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nIntExt = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getName
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sName
.head 5 +  Function: setName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sName = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocType
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nDocType
.head 5 +  Function: setDocType
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nDocType = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocSerial
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sDocSerial
.head 5 +  Function: setDocSerial
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sDocSerial = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocNumber
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sDocNumber
.head 5 +  Function: setDocNumber
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sDocNumber = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocDate
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].dDocDate
.head 5 +  Function: setDocDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Date/Time: dValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].dDocDate = dValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocIssuer
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sDocIssuer
.head 5 +  Function: setDocIssuer
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sDocIssuer = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getBirthday
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].dBirthday
.head 5 +  Function: setBirthday
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Date/Time: dValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].dBirthday = dValue
.head 7 -  Return TRUE
.head 5 +  Function: getBirthplace
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sBirthplace
.head 5 +  Function: setBirthplace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sBirthplace = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSex
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSex
.head 5 +  Function: setSex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSex = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getAdr
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sAdr
.head 5 +  Function: setAdr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sAdr = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getTel
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sTel
.head 5 +  Function: setTel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sTel = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getEMail
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sEMail
.head 5 +  Function: setEMail
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sEMail = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getCusttype
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nCusttype
.head 5 +  Function: setCusttype
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nCusttype = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getOkpo
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sOkpo
.head 5 +  Function: setOkpo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sOkpo = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getCountry
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nCountry
.head 5 +  Function: setCountry
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nCountry = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getRegion
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sRegion
.head 5 +  Function: setRegion
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sRegion = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getFs
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sFs
.head 5 +  Function: setFs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sFs = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getVed
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sVed
.head 5 +  Function: setVed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sVed = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSed
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sSed
.head 5 +  Function: setSed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sSed = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getIse
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sIse
.head 5 +  Function: setIse
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sIse = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getNotes
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return List[nIndex].sNotes
.head 5 +  Function: setNotes
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].sNotes = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getEditedFlag
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return List[nIndex].bEdit
.head 5 +  Function: setEditedFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Boolean: bValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].bEdit = bValue
.head 7 -  Return TRUE
.head 5 +  Function: getDeletedFlag
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return List[nIndex].bDelete
.head 5 +  Function: setDeletedFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Boolean: bValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].bDelete = bValue
.head 7 -  Return TRUE
.head 5 -  !
.head 5 -  ! Relations
.head 5 +  Function: getCustomerRel
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nCustomerRel
.head 5 +  Function: setCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nCustomerRel = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getRelId
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nRelId
.head 5 +  Function: setRelId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nRelId = nValue
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getVaga1
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nVaga1
.head 5 +  Function: setVaga1
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nVaga1 = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getVaga2
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nVaga2
.head 5 +  Function: setVaga2
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nVaga2 = nValue
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: getTypeId
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nTypeId
.head 5 +  Function: setTypeId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nTypeId = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getPosition
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sPosition
.head 5 +  Function: setPosition
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sPosition = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getPosition_r
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sPosition_r
.head 5 +  Function: setPosition_r
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sPosition_r = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getFirstName
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sFirstName
.head 5 +  Function: setFirstName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sFirstName = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getMiddleName
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sMiddleName
.head 5 +  Function: setMiddleName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sMiddleName = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getLastName
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sLastName
.head 5 +  Function: setLastName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sLastName = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocumentTypeId
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nDocumentTypeId
.head 5 +  Function: setDocumentTypeId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nDocumentTypeId = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getDocument
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sDocument
.head 5 +  Function: setDocument
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sDocument = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getTrustRegnum
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sTrustRegnum
.head 5 +  Function: setTrustRegnum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sTrustRegnum = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getTrustRegdat
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].dTrustRegdat
.head 5 +  Function: setTrustRegdat
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Date/Time: dValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].dTrustRegdat = dValue
.head 7 -  Return TRUE
.head 5 +  Function: getBDate
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].dBDate
.head 5 +  Function: setBDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Date/Time: dValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].dBDate = dValue
.head 7 -  Return TRUE
.head 5 +  Function: getEDate
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return DATETIME_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].dEDate
.head 5 +  Function: setEDate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Date/Time: dValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].dEDate = dValue
.head 7 -  Return TRUE
.head 5 +  Function: getNotaryName
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sNotaryName
.head 5 +  Function: setNotaryName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sNotaryName = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getNotaryRegion
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sNotaryRegion
.head 5 +  Function: setNotaryRegion
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sNotaryRegion = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getSignPrivs
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nSignPrivs
.head 5 +  Function: setSignPrivs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nSignPrivs = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getSignId
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return RelList[nIndex].nSignId
.head 5 +  Function: setSignId
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].nSignId = nValue
.head 7 -  Return TRUE
.head 5 +  Function: getNameR
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return ''
.head 7 +  Else
.head 8 -  Return RelList[nIndex].sNameR
.head 5 +  Function: setNameR
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].sNameR = sValue
.head 7 -  Return TRUE
.head 5 +  Function: getRelDelete
.head 6 -  Description: Получить значение по индексу
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return RelList[nIndex].bDelete
.head 5 +  Function: setRelDeleted
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Boolean: bValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set RelList[nIndex].bDelete = bValue
.head 7 -  Return TRUE
.head 3 +  Functional Class: cRelations
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCustomerRel	 ! Id из cCustRelList (RelRnk+RelIntExt)
.head 5 -  Number: nRelId		 ! number(22)    Код отношения
.head 5 -  Number: nVaga1		 ! number(6,2)   Удельный вес прямого участия в уставном фонде
.head 5 -  Number: nVaga2		 ! number(6,2)   Удельный вес опосредствованного участия в уставном фонде
.head 5 -  Number: nTypeId		 ! number(22)    Ид. типа довереного лица
.head 5 -  String: sPosition	 ! varchar2(100) Должность
.head 5 -  String: sPosition_r	 ! varchar2(100) Должность в род. падеже
.head 5 -  String: sFirstName	 ! varchar2(70)  Имя
.head 5 -  String: sMiddleName	 ! varchar2(70)  Отчество
.head 5 -  String: sLastName	 ! varchar2(70)  Фамилия
.head 5 -  Number: nDocumentTypeId	 ! number(22)    Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 5 -  String: sDocument	 ! varchar2(70)  Документ доверенности
.head 5 -  String: sTrustRegnum	 ! varchar2(38)  Номер регистрации доверенности
.head 5 -  Date/Time: dTrustRegdat	 ! date          Дата регистрации доверенности
.head 5 -  Date/Time: dBDate	 ! date          Дата начала действия доверенности
.head 5 -  Date/Time: dEDate	 ! date          Дата окончания действия доверенности
.head 5 -  String: sNotaryName	 ! varchar2(70)  ФИО нотариуса
.head 5 -  String: sNotaryRegion	 ! varchar2(70)  Нотариальный округ
.head 5 -  Number: nSignPrivs	 ! number(1)     право подписи (0/1)
.head 5 -  Number: nSignId		 ! number(22)    Ид. графического представления подписи доверенного лица
.head 5 -  String: sNameR		 ! varchar2(100) ФИО доверенного лица в родительном падеже
.head 5 -  Boolean: bDelete	 ! Признак: удалить связь
.head 4 -  Functions
.head 3 +  Functional Class: cCustRisk
.head 4 -  Description: Критерии рисков клиента
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRiskId
.head 5 -  Number: nRiskValue
.head 5 -  Boolean: bEdited
.head 4 -  Functions
.head 3 +  Functional Class: cCustRiskList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  : List[*]
.head 6 -  Class: cCustRisk
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk      = nRnkId
.head 7 -  Set bShowKK   = bParShowKK
.head 7 -  Set nFlagVisa = nParFlagVisa
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sStrPopulate
.head 7 -  Number: nRiskId
.head 7 -  Number: nRiskValue
.head 7 -  Boolean: bEdited
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If nRnk = 0
.head 8 -  Set sStrPopulate =
"select id, 0
   into :nRiskId, :nRiskValue
   from fm_risk_criteria
  order by id"
.head 7 +  Else
.head 8 -  Set sStrPopulate =
"select risk_id, value
   into :nRiskId, :nRiskValue
   from " || IifS(bShowKK=TRUE, "v_customer_risk", "v_clv_customer_risk") || "
  where rnk = :nRnk
  order by risk_id"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sStrPopulate)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nRiskId    = nRiskId
.head 8 -  Set List[nParNum].nRiskValue = nRiskValue
.head 8 -  Set List[nParNum].bEdited    = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nRiskId
.head 7 -  Number: nRiskValue
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].bEdited 
.head 9 -  Set nRiskId    = List[nIterator].nRiskId
.head 9 -  Set nRiskValue = List[nIterator].nRiskValue
.head 9 -  Set List[nIterator].bEdited = FALSE
.head 9 +  If NOT SqlPLSQLCommand(hSql, "kl.set_customer_risk(nRnk, nRiskId, nRiskValue, nFlagVisa)")
.head 10 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If not nFlagVisa
.head 8 +  If not SqlPLSQLCommand(hSql, "fm_set_rizik(nRnk)")
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexById
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nRiskId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nRiskId = nRiskId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 +  Function: getEditFlag
.head 6 -  Description: Получить значение признака редактирования по имени параметра
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nRiskId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return List[nIndex].bEdited
.head 5 +  Function: getValue
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nRiskId)
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nRiskValue
.head 5 +  Function: setValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRiskId
.head 7 -  Number: nRiskValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nRiskId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nRiskValue = nRiskValue
.head 7 -  Set List[nIndex].bEdited = TRUE
.head 7 -  Return TRUE
.head 3 +  Functional Class: cCustRept
.head 4 -  Description: Репутация клиента
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nReptId
.head 5 -  Number: nReptValue
.head 5 -  Boolean: bEdited
.head 4 -  Functions
.head 3 +  Functional Class: cCustReptList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  : List[*]
.head 6 -  Class: cCustRept
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk      = nRnkId
.head 7 -  Set bShowKK   = bParShowKK
.head 7 -  Set nFlagVisa = nParFlagVisa
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sStrPopulate
.head 7 -  Number: nReptId
.head 7 -  Number: nReptValue
.head 7 -  Boolean: bEdited
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If nRnk = 0
.head 8 -  Set sStrPopulate =
"select id, 0
   into :nReptId, :nReptValue
   from fm_rept_criteria
  order by id"
.head 7 +  Else
.head 8 -  Set sStrPopulate =
"select rept_id, value
   into :nReptId, :nReptValue
   from v_customer_rept
  where rnk = :nRnk
  order by rept_id"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sStrPopulate)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nReptId    = nReptId
.head 8 -  Set List[nParNum].nReptValue = nReptValue
.head 8 -  Set List[nParNum].bEdited    = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nReptId
.head 7 -  Number: nReptValue
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].bEdited 
.head 9 -  Set nReptId    = List[nIterator].nReptId
.head 9 -  Set nReptValue = List[nIterator].nReptValue
.head 9 -  Set List[nIterator].bEdited = FALSE
.head 9 +  If NOT SqlPLSQLCommand(hSql, "kl.set_customer_rept(nRnk, nReptId, nReptValue)")
.head 10 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If not SqlPLSQLCommand(hSql, "fm_set_rept(nRnk)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexById
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nReptId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nReptId = nReptId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 +  Function: getEditFlag
.head 6 -  Description: Получить значение признака редактирования по имени параметра
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nReptId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return List[nIndex].bEdited
.head 5 +  Function: getValue
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nReptId)
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nReptValue
.head 5 +  Function: setValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nReptId
.head 7 -  Number: nReptValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nReptId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nReptValue = nReptValue
.head 7 -  Set List[nIndex].bEdited = TRUE
.head 7 -  Return TRUE
.head 3 +  Functional Class: cCustCategory
.head 4 -  Description: Категории клиента
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCategoryId
.head 5 -  Number: nCategoryValue
.head 5 -  Boolean: bEdited
.head 4 -  Functions
.head 3 +  Functional Class: cCustCategoryList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  : List[*]
.head 6 -  Class: cCustCategory
.head 5 -  Number: nParNum
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: bShowKK
.head 5 -  Number: nFlagVisa
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Конструктор
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 7 -  Boolean: bParShowKK
.head 7 -  Number: nParFlagVisa
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk      = nRnkId
.head 7 -  Set bShowKK   = bParShowKK
.head 7 -  Set nFlagVisa = nParFlagVisa
.head 7 -  Return TRUE
.head 5 +  Function: setRnk
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRnkId
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nRnkId
.head 7 -  Return TRUE
.head 5 +  ! Function: setShowKK
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Boolean: bFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set bShowKK = bFlag
.head 7 -  Return TRUE
.head 5 +  ! Function: setFlagVisa
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: nFlag
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nFlagVisa = nFlag
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description: Населить данными из базы
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sStrPopulate
.head 7 -  Number: nCategoryId
.head 7 -  Number: nCategoryValue
.head 7 -  Boolean: bEdited
.head 6 +  Actions
.head 7 -  Set nParNum = 0
.head 7 +  If nRnk = 0
.head 8 -  Set sStrPopulate =
"select id, 0
   into :nCategoryId, :nCategoryValue
   from fm_category
  order by id"
.head 7 +  Else
.head 8 -  Set sStrPopulate =
"select category_id, value
   into :nCategoryId, :nCategoryValue
   from v_customer_category
  where rnk = :nRnk
  order by category_id"
.head 7 +  If NOT SqlPrepareAndExecute(hSql, sStrPopulate)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql, nFetchRes)
.head 8 -  Set List[nParNum].nCategoryId    = nCategoryId
.head 8 -  Set List[nParNum].nCategoryValue = nCategoryValue
.head 8 -  Set List[nParNum].bEdited    = FALSE
.head 8 -  Set nParNum = nParNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: Update
.head 6 -  Description: Сохранить значения в базе данных
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Number: nCategoryId
.head 7 -  Number: nCategoryValue
.head 6 +  Actions
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].bEdited 
.head 9 -  Set nCategoryId    = List[nIterator].nCategoryId
.head 9 -  Set nCategoryValue = List[nIterator].nCategoryValue
.head 9 -  Set List[nIterator].bEdited = FALSE
.head 9 +  If NOT SqlPLSQLCommand(hSql, "kl.set_customer_category(nRnk, nCategoryId, nCategoryValue)")
.head 10 -  Return FALSE
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  ! If not SqlPLSQLCommand(hSql, "fm_set_rept(nRnk)")
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: getParNum
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nParNum
.head 5 +  Function: getIndexById
.head 6 -  Description: получить индекс параметра в массиве по имени
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nCategoryId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nParNum
.head 8 +  If List[nIterator].nCategoryId = nCategoryId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 7 +  Else
.head 8 -  Return -1
.head 5 +  Function: getEditFlag
.head 6 -  Description: Получить значение признака редактирования по имени параметра
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nCategoryId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return List[nIndex].bEdited
.head 5 +  Function: getValue
.head 6 -  Description: Получить значение по имени параметра
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nCategoryId)
.head 7 +  If nIndex = -1
.head 8 -  Return NUMBER_Null
.head 7 +  Else
.head 8 -  Return List[nIndex].nCategoryValue
.head 5 +  Function: setValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCategoryId
.head 7 -  Number: nCategoryValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexById(nCategoryId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set List[nIndex].nCategoryValue = nCategoryValue
.head 7 -  Set List[nIndex].bEdited = TRUE
.head 7 -  Return TRUE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  MDI Window: CustomerFactory
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 0.281"
.head 4 -  Height Editable? Yes
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Form Window: ExemplarPrivatePerson
.head 4 -  Class: PrivatePerson
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Minimized
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Description:
.head 4 -  Named Menus
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Functions
.head 4 -  Window Parameters
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Form Window: ExemplarCorporation
.head 4 -  Class: Corporation
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Minimized
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Description:
.head 4 -  Named Menus
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Functions
.head 4 -  Window Parameters
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Form Window: ExemplarBank
.head 4 -  Class: Bank
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Minimized
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Description:
.head 4 -  Named Menus
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Functions
.head 4 -  Window Parameters
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: getCustomerObject
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 +  Parameters
.head 5 -  Number: nType
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hObject
.head 4 +  Actions
.head 5 +  Select Case nType
.head 6 +  Case 1
.head 7 -  Set hObject = SalCreateWindow( ExemplarBank, hWndMDI )
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set hObject = SalCreateWindow( ExemplarCorporation, hWndMDI )
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set hObject = SalCreateWindow( ExemplarPrivatePerson, hWndMDI )
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 5 -  Return hObject
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndMain
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowLoc(hWndMDI, 0, 20)
.head 4 -  Call SalHideWindow(hWndMDI)
