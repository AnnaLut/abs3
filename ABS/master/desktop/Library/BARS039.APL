Application Description: ДОКУМЕНТАРНІ ОПЕРАЦІЇ ( Гарантії / Акредитиви / Авалі )
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000060100 002C000000020000 0003000000000000 00BB010000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730C6672
0080: 6D5F4741525F4C49 4E45
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 33392E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: GENTBL.APL
		File Include: GENLIST.APL
		File Include: Xsalcpt.apl
		Dynalib: bars010.apd
		Dynalib: BARS013.APD
		Dynalib: BARS017.APD
		Dynalib: BARS017R.APD
		Dynalib: DEPO.APD
		Dynalib: CC_DOC.APD
		Dynalib: cc_input.apd
		Dynalib: custacnt.apd
		Dynalib: NSIAPI.APD
		Dynalib: OTCN.APD
		File Include: VTCOMM.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				! История изменений: -----------------------------------------------------|
				String: ApdNum   =  '39'
				String: ApdVer   =  'Версія: 1.33 від 10.09.2014 р.'
		Resources
		Variables
			Number: nFetchRes
			Boolean: bApdInited
			Boolean: b_MOS
			String: sBankMFO
			String: sDptBankType
			Window Handle: hWin1  !! Портфель договорів Документарних Операцій
			Window Handle: hWinG !! Кратка договору
			Window Handle: hWinL  !! Картка договору ЛІНІЇ
		Internal Functions
			Function: InitAPD
				Description: Ініціалізація бібліотеки
				Returns
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If ( Not bApdInited )
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\BARS039.LNG"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							! ! ====================================================
							Call CurrentLangTable.AddAtom('cTAt', 'Увага!')
							Call CurrentLangTable.AddAtom('cTErr','Помилка!')
							Call CurrentLangTable.AddAtom('cTInfo','Інформація')
							Call CurrentLangTable.AddAtom('cTMessage','Повідомлення')
							Call CurrentLangTable.AddAtom('cTFilial','Подразделение')
							Call CurrentLangTable.AddAtom('cTBranch','Отделение')
							! ! ====================================================
							Call CurrentLangTable.AddAtom( 'Tbl_GAR.cTWndTitle', 'Портфель Документарних Операцій банку' )
						! >>
						! МФО БАНКУ
						Set sBankMFO = GetBankMfo()
						! Назва схеми банку
						Set sDptBankType = GetGlobalOption( 'DPT_BANK_TYPE' )
						! <<
						Set bApdInited = TRUE
			Function: Sel039	! __exported
				Description: Bars039_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
				Actions
					! надо вставить инициализацию apd
					Call InitAPD()
					Select Case nMode
						! << Портфель гарантій >>
						! Повний доступ
						Case 10
							If not IsWindow( hWin1 )
								Set hWin1 = SalCreateWindow( Tbl_GAR, hWndParent, 0, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( Tbl_GAR )
							Break
						! "Кредитчик"
						Case 11
							If not IsWindow( hWin1 )
								Set hWin1 = SalCreateWindow( Tbl_GAR, hWndParent, 1, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( Tbl_GAR )
							Break
						! Бухгалтер
						Case 12
							If not IsWindow( hWin1 )
								Set hWin1 = SalCreateWindow( Tbl_GAR, hWndParent, 2, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( Tbl_GAR )
							Break
						! "Залоговик"
						Case 13
							If not IsWindow( hWin1 )
								Set hWin1 = SalCreateWindow( Tbl_GAR, hWndParent, 3, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( Tbl_GAR )
							Break
						! Супровід
						Case 14
							If not IsWindow( hWin1 )
								Set hWin1 = SalCreateWindow( Tbl_GAR, hWndParent, 4, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( Tbl_GAR )
							Break
						! Тільки перегляд
						Case 19
							If not IsWindow( hWin1 )
								Set hWin1 = SalCreateWindow( Tbl_GAR, hWndParent, 9, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( Tbl_GAR )
							Break
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbRefresh
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: Tbl_GAR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Портфель гарантий, предоставленных банком
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.354"
				Width:  19.0"
				Width Editable? Class Default
				Height: 6.643"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.702"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Group Box: Просмотр по портфелю
					Resource Id: 54237
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.238"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые ДГ' )
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Click
							                                                                                                                                                                                                                               If SetQueryDFilter(AccF)
								                                                                                                                                                                                                                               Call SalPostMsg(hWndForm,  UM_Populate, 0, 0)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbViewSWT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.238"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр SWIFT-сообщений 7**'
						On SAM_Click
							Call Sel013(hWndMDI,  8, 0, "sw_journal.MT>=700 and sw_journal.MT<=799 ", "")
				Pushbutton: pb_MOS_Ex
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							Set strTip = 'Сформировать отчет № '|| Str(KODZ) || '. '|| NAM_KATZ
						On SAM_Click
							Call ZAPROS1(hWndMDI, KODZ )
				Data Field: nKOLG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.183"
							Top:    0.238"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество отобранных записей' )
				!
				Group Box: Бух.сопровождение портфеля
					Resource Id: 54238
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.483"
						Top:    0.071"
						Width:  3.25"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Pushbutton: pb_Proc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.583"
						Top:    0.238"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Начислить Доходы по портфелю
									(процентные и амортизационные)'
						On SAM_Click
							Call Sel010( hWndMDI, 0, 0,
									" and (s.NBS like '90%' or s.NBS = '9122' or s.NBS = '3648' ) " ||
									" and s.acc in (select n.acc from nd_acc n, cc_deal d where n.nd=d.nd and d.vidd in (9,19,29,39) )",
									"A"  )
				Pushbutton: pb_2600
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.083"
						Top:    0.238"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Set strTip = 'Взыскание начисленных доходов по портфелю'
							Set strTip = CurrentLangTable.GetAtomTitle( 'Tbl_GAR.cBTipPaymentAccrualIncome' )
						On SAM_Click
							Call P_PAYMENTS( 2600, strTip )
				Pushbutton: pb_3579
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.583"
						Top:    0.238"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Set strTip = 'Вынос на просрочку начисленных доходов по портфелю'
							Set strTip = CurrentLangTable.GetAtomTitle( 'Tbl_GAR.cBTipOverdueAccrualIncome' )
						On SAM_Click
							Call P_PAYMENTS( 3579, strTip )
				!
				Group Box: Для работы с одним ДГ
					Resource Id: 54239
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.85"
						Top:    0.071"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
				! 'Открыть новую линию
				Pushbutton: pb_GAL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.983"
						Top:    0.24"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip1 = 'Генеральный Договор (линия)'
							Set strTip = 'Открыть новый ' || strTip1 || '
									1) с общим лимитом,
									2) с MAX-сроком действия'
						On SAM_Click
							If not IsWindow(hWinL)
								Set nND = NUMBER_Null
								Set hWinL = SalCreateWindow( frm_GAR_LINE, hWndMDI, nTypeClient, strTip1, nND  )
							Else
								Call SalBringWindowToTop ( hWinL )
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.486"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Ввести новый Договор'
						On SAM_Click
							If not IsWindow(hWinG)
								Set Tbl_GAR.nND = NUMBER_Null
								Set hWinG = SalCreateWindow(
										frm_GAR,
										hWndMDI,
										Tbl_GAR.nTypeClient,
										Tbl_GAR.nFun,
										Tbl_GAR.nGr,
										hWndForm.Tbl_GAR.pbRefresh,
										hWndForm.Tbl_GAR.nND, sPar1 )
							Else
								Call SalBringWindowToTop ( frm_GAR )
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.986"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр-Корректировка выбранного Договора'
						On SAM_Click
							If ND != NUMBER_Null
								Set nND = ND
								If ( NOT SalIsNull(Tbl_GAR.ND) AND (Tbl_GAR.ND = Tbl_GAR.NDI) )
									If not IsWindow(hWinL)
										Set hWinL = SalCreateWindow( frm_GAR_LINE, hWndMDI, nTypeClient, strTip || ' (линии) реф=' ||Str(nND) ,  nND  )
									Else
										Call SalBringWindowToTop ( hWinL )
								Else
									If not IsWindow(hWinG)
										Set hWinG = SalCreateWindow ( frm_GAR, hWndMDI, nTypeClient, nFun, nGr,  hWndForm.Tbl_GAR.pbRefresh, nND, sPar1 )
									Else
										Call SalBringWindowToTop ( frm_GAR )
				Pushbutton: pbZalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.486"
						Top:    0.238"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Новые Договора обеспечения к выбранному ДГ'
						On SAM_Click
							If Tbl_GAR.ACC !=NUMBER_Null
								Call Sel017( hWndMDI,
										IifN(Tbl_GAR.SOS=15,9,0), 2, 0, Str(Tbl_GAR.nGr), Str(Tbl_GAR.RNK), Tbl_GAR.ACC )
				Pushbutton: pbZalog_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.986"
						Top:    0.238"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Существующие Договора обеспечения к выбранному ДГ '
						On SAM_Click
							If Tbl_GAR.ACC !=NUMBER_Null
								Call Sel017(hWndMDI,
										IifN(Tbl_GAR.SOS=15,9,0), 11, 0, Str(Tbl_GAR.nGr), Str(Tbl_GAR.RNK), Tbl_GAR.ACC )
				Pushbutton: pbZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.486"
						Top:    0.238"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр связей обеспечений и и выбранного ДГ'
						On SAM_Click
							If Tbl_GAR.ACC !=NUMBER_Null
								Set Tbl_GAR.sTmp = " and KU_109.ACCK =" || Str(Tbl_GAR.ACC)
								! только просмотр
								Call Bars017r1 ( NUMBER_Null, NUMBER_Null, NUMBER_Null, Tbl_GAR.sTmp )
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.986"
						Top:    0.238"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Документы выбранного ДГ'
						On SAM_Click
							If Tbl_GAR.ND !=NUMBER_Null
								Call cdoc_ShowAllDocs( Tbl_GAR.ND, hWndForm )
				Pushbutton: pbSob
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.486"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'График событий выбранного ДГ'
						On SAM_Click
							Call Sel017f(hWndMDI,IifN(Tbl_GAR.SOS=15,9,0),16, Tbl_GAR.ND,
									Tbl_GAR.CC_ID||' от '||SalFmtFormatDateTime(Tbl_GAR.DAT1,'dd/MM/yyyy'),Tbl_GAR.NMK,'','','')
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.986"
						Top:    0.238"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Табличная форма счетов, связанных с выбранным ДГ"
						On SAM_Click
							If Tbl_GAR.ACC !=NUMBER_Null
								Set Tbl_GAR.sTmp =
										" a.acc in (select acc from nd_acc WHERE nd="||Str(Tbl_GAR.ND)||" union all
										  select acc from cc_accp WHERE accs in (select acc from nd_acc WHERE nd=" || Str(Tbl_GAR.ND) || "))"
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, Tbl_GAR.sTmp )
										
				Pushbutton: pb_MOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.486"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							Set strTip = 'Спец. реквизиты по выбранному ДГ'
						On SAM_Click
							If not SalIsNull(ND)
								Call DOP_MOS (ND, CC_ID, NMK, 'All')
								! If nTip_Fun =90
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call DOP_MOS (ND, CC_ID, NMK, 'ReadOnly')
								! Else
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call DOP_MOS (ND, CC_ID, NMK, 'All')
				!
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.186"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				! НЕвидимые кнопки
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54240
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  14.85"
						Begin Y:  0.155"
						End X:  14.85"
						End Y:  0.619"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 54241
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  14.783"
						Begin Y:  0.155"
						End X:  14.783"
						End Y:  0.619"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 54242
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  14.9"
						Begin Y:  0.155"
						End X:  14.9"
						End Y:  0.619"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						бранча
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = BRANCH
					On SAM_AnyEdit
						Set BRANCH = sTmpE
			Column: PROD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						прод
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = PROD
					On SAM_AnyEdit
						Set PROD = sTmpE
			Column: NDI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						Генер.
						договора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = NDI
					On SAM_AnyEdit
						Set NDI = nTmpE
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						Дог
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND
					On SAM_AnyEdit
						Set ND = nTmpE
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Рег.№
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛИЕНТ -
						ссудозаемщик
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NMK
					On SAM_AnyEdit
						Set BRANCH = sTmpE
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идентиф.
						договора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = CC_ID
					On SAM_AnyEdit
						Set CC_ID = sTmpE
			Column: sFIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фин
						сост
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: кат
						риска
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма по
						договору
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						заклю-
						чения
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set dTmpE = DAT1
					On SAM_AnyEdit
						Set DAT1 = dTmpE
			Column: DAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						вступления
						в силу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set dTmpE = DAT2
					On SAM_AnyEdit
						Set DAT2 = dTmpE
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						конца
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set dTmpE = DAT1
					On SAM_AnyEdit
						Set DAT1 = dTmpE
			!
			Column: FIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Фин
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Обс
						долга
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обс
						долга
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рачс.
						кат
						риска
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Об22
				Visible? No
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_9020
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лицевой
						счет
						гарантии
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS_9020
					On SAM_AnyEdit
						Set NLS_9020 = sTmpE
			Column: OST_9020
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущий
						остаток
						гарантии
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_2602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лицевой
						счет
						покрытия
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS_2602
					On SAM_AnyEdit
						Set NLS_2602 = sTmpE
			Column: OST_2602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущий
						остаток
						покрытия
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						ст
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гр
						дост
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						исп
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наимен.
						Лиц.счет
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC ссудного счета
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SOS
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: VIDD
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: INSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кр.
						инсп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: P_PAYMENTS
				Description:
				Returns
				Parameters
					Number: pMode
					String: sMessage
				Static Variables
				Local variables
					Number: nError
				Actions
					If SalMessageBox( "Виконати операцію " || sMessage || " ?",
							                                       CurrentLangTable.GetAtomTitle( 'cTAt' ),
							                                       MB_IconQuestion | MB_YesNo) = IDYES
						Call SalWaitCursor( TRUE )
						!
						If ( ( ( pMode = 2600 ) AND SqlPLSQLCommand( hSql(),"BARS.GAR.PAYMENT_COMMISSION( NUMBER_Null, nError )" ) ) Or
								     ( ( pMode = 3579 ) AND SqlPLSQLCommand( hSql(),"BARS.GAR.TRANSFER_OVERDUE( NUMBER_Null, nError )"     ) ) )
							Call SqlCommitEx( hSql(), sMessage )
							Call SalWaitCursor( FALSE )
							Call MessageNoWait( "Виконано " || sMessage || IifS( nError = -1, " з помилками!", " без помилок." ),
									                                             CurrentLangTable.GetAtomTitle( 'cTMess' ), 3, 0 )
							Return TRUE
						Else
							Call SqlRollback( hSql() )
							Call SalWaitCursor( FALSE )
							Call MessageError( CurrentLangTable.GetAtomTitle( 'cTErr' ) || sMessage )
							Return FALSE
		Window Parameters
			! Доступ ( 0 - Повний / 1 - Кред. / 2 - Бухг. / 3 - Залаговик / 4 - Супровід  / 9 - тільки перегляд
			Number: nFun
			! Тип клієнта (ВСІ / ФО / ЮО / БАНК )
			Number: nTypeClient
			String: sPar1
			String: sPar2
		Window Variables
			Number: nGr
			String: sTmpE
			Number: nTmpE
			Date/Time: dTmpE
			String: CC_GAR
			String: sTmp
			String: strTip1
			String: sf
			Number: nND
			Boolean: FL_Filtr
			Number: KODZ
			String: NAM_KATZ
			String: Sel1
			String: sR020
			: AccF
				Class: cGenDFilter
			Date/Time: dBankDate
			Number: nColor
		Message Actions
			On SAM_Create
				Set nColor =  SalColorFromRGB( 255,245,235 )
				! Call Debug ( Str (nTypeClient) || ','|| Str( nFun) ||','|| Str( nGr)||','|| sVID9 || ',' || sPar4 )
				Set b_MOS = SqlPrepareAndExecute( hSql(), "SELECT val from params where par='MOS_OTC' and val='1' " )
						and SqlFetchNext(hSql(), nFetchRes)
				If not b_MOS
					Call SalHideWindow( pb_MOS )
				If SqlPrepareAndExecute( hSql(),
						  "SELECT z.kodz, z.name INTO :KODZ, :NAM_KATZ  from params p, zapros z
						   where p.par='CC_KODZ' and to_number(p.val)=z.KODZ " ) and
						not SqlFetchNext(hSql(), nFetchRes)
					Call SalHideWindow( pb_MOS_Ex )
					Call SalHideWindow( pb_MOS )
				! Доступ
				If ( nFun = 2 OR nFun = 3 OR nFun = 9 )
					Call SalDisableWindow( pb_GAL )
					Call SalDisableWindow( pbIns )
				Else
					If ( sBankMFO = '380764' OR sDptBankType = 'SBER' )
						Call SalShowWindow( pb_GAL )
					Else
						Call SalHideWindow( pb_GAL )
						Call SalHideWindow( Tbl_GAR.NDI )
				If ( nFun = 1 OR nFun = 2 OR nFun = 9 )
					Call SalDisableWindow( pbZalog )
					Call SalDisableWindow( pbZalog_All )
				If ( nFun != 0 AND nFun != 2 AND nFun != 4 )
					Call SalDisableWindow( pb_Proc )
				!
				Set pb_Clos = FALSE
				Set Tbl_GAR.fFilterAtStart = 1
				Set Tbl_GAR.strFilterTblName = 'CC_GAR'
				Set Tbl_GAR.nTabInstance = 1
				Set Tbl_GAR.strPrintFileName = 'CC_GAR'
				Call SalTblSetLockedColumns( hWndForm, 6 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				! Вичитуєм банківську дату один раз перед наповненням
				Set dBankDate =  GetBankDate()
				If Tbl_GAR.fFilterAtStart
					If SetQueryFilter( cF )
						Set Tbl_GAR.fFilterAtStart = NOT Tbl_GAR.fFilterAtStart
				!
				If NOT Tbl_GAR.fFilterAtStart
					Call SalWaitCursor(TRUE)
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Set sf = ""
					! Set sf = AccF.GetFilterWhereClause(FALSE)
					Set sf = cF.GetFilterWhereClause( FALSE )
					! Call Debug ( sf )
					Set Tbl_GAR.strSqlPopulate =
							"SELECT CC_GAR.BRANCH, CC_GAR.PROD, CC_GAR.OB22, CC_GAR.NDI,
							        CC_GAR.VIDD,CC_GAR.ND, CC_GAR.INSP, CC_GAR.RNK, CC_GAR.NMK, CC_GAR.CC_ID,
							        CC_GAR.ACC ,CC_GAR.DAT1,CC_GAR.DAT4, CC_GAR.KV, CC_GAR.NLS_9020, CC_GAR.OST_9020,
							        CC_GAR.SOS ,CC_GAR.LIMIT,CC_GAR.OBS, CC_GAR.FIN, CC_GAR.SOBS, CC_GAR.SFIN,
							        CC_GAR.S080,CC_GAR.R080, CC_GAR.GRP, CC_GAR.ISP,CC_GAR.NMS,
							        acrn.FPROCN(CC_GAR.ACC, 0, CC_GAR.DAT4)
							 INTO :Tbl_GAR.BRANCH,:Tbl_GAR.PROD, :Tbl_GAR.OB22, :Tbl_GAR.NDI,
							      :Tbl_GAR.VIDD,  :Tbl_GAR.ND,   :Tbl_GAR.INSP, :Tbl_GAR.RNK, :Tbl_GAR.NMK, :Tbl_GAR.CC_ID,
							      :Tbl_GAR.ACC,   :Tbl_GAR.DAT1, :Tbl_GAR.DAT4, :Tbl_GAR.KV,  :Tbl_GAR.NLS_9020, :Tbl_GAR.OST_9020,
							      :Tbl_GAR.SOS,   :Tbl_GAR.LIMIT,:Tbl_GAR.OBS,  :Tbl_GAR.FIN, :Tbl_GAR.sOBS,:Tbl_GAR.sFIN,
							      :Tbl_GAR.S080,  :Tbl_GAR.R080, :Tbl_GAR.GRP,  :Tbl_GAR.ISP,:Tbl_GAR.NMS, :Tbl_GAR.PR
							 FROM CC_GAR
							 where sos " || IifS(pb_Clos,"=","<>") || " 15" ||
							 IifS( nTypeClient = 0, "", " AND custtype = " || Str(nTypeClient) ) ||
							 IifS( sf = STRING_Null, ""," AND " || sf ) ||
							" ORDER BY decode(ndi, null, 0, ndi) desc, decode (nd, ndi, 1, 2), nd desc "
					! Call Debug ( Subs (Tbl_GAR.strSqlPopulate, 600,400  ))
					Set nKOLG = 0
					Call SalTblPopulate(hWndForm, hSql(), Tbl_GAR.strSqlPopulate, TBL_FillAll)
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
				Else
					Call SalDestroyWindow( hWndForm )
				!
			On SAM_FetchRowDone
				! к-ть договорів
				Set nKOLG = nKOLG + 1
				! << Розфарбовуємо табличку >>
				! Лінія / нелінія
				If NDI = ND
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
				Else
					If NDI != NUMBER_Null
						Call XSalTblSetCellBackColor( Tbl_GAR.NDI, COLOR_Yellow )
					Else
						Call XSalTblSetRowBackColor( hWndForm, lParam, nColor )
				! Дати
				If DAT4 != DATETIME_Null
					! Прострочений договір (ЧЕРВОНИЙ)
					If DAT4 < dBankDate
						Call XSalTblSetCellBackColor( DAT1, COLOR_Salmon )
						Call XSalTblSetCellBackColor( DAT2, COLOR_Salmon )
						Call XSalTblSetCellBackColor( DAT4, COLOR_Salmon )
					! Завершується сьогодні (ЗЕЛЕНЫЙ)
					Else If DAT4 = dBankDate
						Call XSalTblSetCellBackColor( DAT1,  COLOR_LightGreen  )
						Call XSalTblSetCellBackColor( DAT2,  COLOR_LightGreen  )
						Call XSalTblSetCellBackColor( DAT4,  COLOR_LightGreen  )
					! Завершується через 7 днів (
					Else If DAT4 <= (dBankDate+7)
						Call XSalTblSetCellBackColor( DAT1, COLOR_LightAqua )
						Call XSalTblSetCellBackColor( DAT2, COLOR_LightAqua )
						Call XSalTblSetCellBackColor( DAT4, COLOR_LightAqua )
					! Завершується через 30 днів (СІРИЙ)
					Else If DAT4 <= (dBankDate+30)
						Call XSalTblSetCellBackColor( DAT1, COLOR_Gray )
						Call XSalTblSetCellBackColor( DAT2, COLOR_Gray )
						Call XSalTblSetCellBackColor( DAT4, COLOR_Gray )
				! Стан договору
				If (SOS = 0 )
					Call SetTblRowColor( Tbl_GAR, COLOR_DarkGreen )
				If Tbl_GAR.ACC != NUMBER_Null
					If SqlPrepareAndExecute( hSqlAux2(),
							 "SELECT min(fdat) into :Tbl_GAR.DAT2 from saldoa where dos>0 and acc=:Tbl_GAR.ACC " )
							and SqlFetchNext(hSqlAux2(), nFetchRes)
				If SqlPrepareAndExecute( hSqlAux2(),
						 "SELECT nls, ostc/100
						  into :Tbl_GAR.NLS_2602, :Tbl_GAR.OST_2602
						  from accounts a, nd_acc n
						  where n.nd = :Tbl_GAR.ND and n.acc= a.acc and a.tip ='SL '" )
						and SqlFetchNext(hSqlAux2(), nFetchRes)
			On UM_DoubleClick
				Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
			On UM_CreateDoc
				Call SalModalDialog( dlg_CreateDoc, hWndForm,  Tbl_GAR.ND )
	Form Window: frm_GAR_LINE
		Class:
		Property Template:
		Class DLL Name:
		Title: Вввод параметров Гарантийного договора
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? No
			Minimizable? Yes
			System Menu? Yes
			Resizable? No
			Window Location and Size
				Left:   1.438"
				Top:    1.042"
				Width:  11.24"
				Width Editable? Yes
				Height: 6.524"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.583"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			!
			Background Text: Реф Ген.Дог
				Resource Id: 54243
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.083"
					Top:    0.095"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.31"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold-Italic-Underline
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.65"
						Top:    0.095"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.31"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold-Italic-Underline
					Text Color: Midnight Blue
					Background Color: Gray
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.Генерального договора ' )
			! Договор
			Group Box: Тип продукту
				Resource Id: 54244
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.405"
					Width:  10.45"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Radio Button: rbGAR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гарантия
				Window Location and Size
					Left:   0.4"
					Top:    0.595"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Jade
				Background Color: Default
				Message Actions
					On SAM_Click
						Call F_Choice_Type()
					! On SAM_TooltipSetText
						                                                                                                              Return XSalTooltipSetText( lParam, 'БС='||IifS(nTypeClient=1,'9000','9020') )
			Radio Button: rbAKR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Акредитив
				Window Location and Size
					Left:   3.0"
					Top:    0.595"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Teal
				Background Color: Default
				Message Actions
					On SAM_Click
						Call F_Choice_Type()
					! On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'БС=9001' )
			Radio Button: rbAKC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Акцепт
				Window Location and Size
					Left:   5.7"
					Top:    0.595"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Chartreuse
				Background Color: Default
				Message Actions
					! On SAM_Click
						                                                                                                                                                                       Call F_RB()
					! On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'БС=9002' )
			Radio Button: rbAVL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Аваль
				Window Location and Size
					Left:   8.4"
					Top:    0.595"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Dark Green
				Background Color: Default
				Message Actions
					On SAM_Click
						Call F_Choice_Type()
					! On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'БС=9023' )
			!
			Group Box: Параметри лінії
				Resource Id: 54245
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    2.821"
					Width:  10.433"
					Width Editable? Yes
					Height: 1.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Background Text: Номер договору
				Resource Id: 54246
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.095"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 30
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.05"
						Top:    3.05"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ Генерального договора ')
			Background Text: Валюта
				Resource Id: 54247
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.76"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Data Field: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.05"
						Top:    3.75"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вал лимита суммы' )
			Background Text: Сума ліміту
				Resource Id: 54248
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.43"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Data Field: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.05"
						Top:    3.4"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ###000
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма Лимита ')
			Data Field: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   9.05"
						Top:    3.05"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала действия Генерального договора ' )
			Background Text: Дата початку
				Resource Id: 54249
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.28"
					Top:    3.095"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Data Field: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   9.05"
						Top:    3.4"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата действия Генерального договора ' )
			!
			Group Box: Бранч договору
				Resource Id: 54250
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    4.167"
					Width:  10.45"
					Width Editable? Yes
					Height: 0.6"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: DBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 30
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.3"
						Top:    4.357"
						Width:  2.85"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код Бранчу Договору')
			Data Field: BranchName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.2"
						Top:    4.357"
						Width:  6.8"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва Бранчу Договору')
			Pushbutton: pbBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbBrowse
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.0"
					Top:    4.357"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вибір Бранчу Договору')
					On SAM_Click
						If NOT FunNSIGet( "OUR_BRANCH", "NAME", DBRANCH, BranchName )
							Set DBRANCH = STRING_Null
							Set BranchName = STRING_Null
			!
			Data Field: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.683"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Несистемный счет договора')
					On SAM_SetFocus
						Set sTmpE = NLS
					On SAM_AnyEdit
						Set NLS = sTmpE
			Data Field: N_LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.083"
						Top:    4.821"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'НЕиспользованный Лимит ')
					On SAM_SetFocus
						Set nTmpE = N_LIM
					On SAM_AnyEdit
						Set N_LIM = nTmpE
			Data Field: N_KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.05"
						Top:    3.75"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Количество открытых ДО')
			Data Field: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.583"
						Top:    4.821"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Использованный Лимит ')
					On SAM_SetFocus
						Set nTmpE = OST
					On SAM_AnyEdit
						Set OST = nTmpE
			!
			Data Field: bgFindCust
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    2.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Group Box: Клієнт
				Resource Id: 54251
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.905"
					Width:  10.45"
					Width Editable? Yes
					Height: 1.2"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Background Text: Бранч
				Resource Id: 54252
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.2"
					Top:    1.155"
					Width:  1.333"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Background Text: Назва
				Resource Id: 54253
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.8"
					Top:    1.452"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Pushbutton: pbKlient
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    1.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Искать клиента/Принципала '
					On SAM_Click
						Call F_RNK ()
			Pushbutton: pbShowCust
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    1.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Паспорт клиента'
					On SAM_Click
						If nCusttype =2
							Call EditCustCorps( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
						Else If nCusttype=3
							Call EditCustPerson( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
						Else If nCusttype=1
							Call EditCustBanks( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
			Background Text: РНК
				Resource Id: 54254
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.8"
					Top:    1.155"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Background Text: Сегмент
				Resource Id: 54255
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.8"
					Top:    1.774"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.05"
						Top:    1.095"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Burgundy
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рег.№ клиента' )
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Background Text: РНОКПП
				Resource Id: 54256
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.5"
					Top:    1.155"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.75"
						Top:    1.095"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ид.код клиента' )
					On SAM_SetFocus
						Set sTmpE = OKPO
					On SAM_AnyEdit
						Set OKPO = sTmpE
			Data Field: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 70
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.05"
						Top:    1.405"
						Width:  8.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'наименование клиента/Принципала')
					On SAM_SetFocus
						Set sTmpE = NMK
					On SAM_AnyEdit
						Set NMK = sTmpE
			Data Field: KBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 22
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.6"
						Top:    1.095"
						Width:  2.85"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Бранч клиента')
					On SAM_SetFocus
						Set sTmpE = KBRANCH
					On SAM_AnyEdit
						Set KBRANCH = sTmpE
			Data Field: dfSEGM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.05"
						Top:    1.714"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: None
					Text Color: Black
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ид.код клиента' )
			Data Field: dfSegmName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.05"
						Top:    1.714"
						Width:  7.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сегмент клиента')
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сохранить
				Window Location and Size
					Left:   2.55"
					Top:    5.298"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If F_VALID ()
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отмена
				Window Location and Size
					Left:   5.65"
					Top:    5.298"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			Group Box: Вид продукту
				Resource Id: 54257
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    2.119"
					Width:  10.45"
					Width Editable? Yes
					Height: 0.65"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_Product
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.28"
					Top:    2.333"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CHART.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Вибрати "Продукт"'
					On SAM_Click
						! Для НАДРА з сегментами
						If ( sBankMFO = '380764' )
							Call FunNSIGetFiltered( "V_GAR_PRODUCTS", "NAME", "VIDD = " || Str(nVIDD) || " And ( SEGMENT is Null" ||
									IifS( SalIsNull( dfSEGM ), " ", " or SEGMENT=" || Subs(dfSEGM,1,1) ) || " )", dfProduct, dfProductName )
						Else
							Call FunNSIGetFiltered( "V_GAR_PRODUCTS", "NAME", "VIDD = " || Str(nVIDD), dfProduct, dfProductName )
			Data Field: dfProduct
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 6
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.8"
						Top:    2.333"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Код "Продукта"')
			Data Field: dfProductName
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.05"
						Top:    2.333"
						Width:  8.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Наименование "Продукта"')
			Combo Box: cmbKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.68"
					Top:    3.75"
					Width:  2.35"
					Width Editable? Class Default
					Height: 1.25"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbKV = STRING_Null
							Call cmbKV.Init(hWndItem)
							Call cmbKV.Populate( hSql(), "kv", "name", "tabval", " where d_close is null And PRV = 0 ")
							Call cmbKV.SetSelectById( KV )
					On SAM_Click
						Set KV = cmbKV.GetKey(SalListQuerySelection(cmbKV))
			Background Text: Дата завершення
				Resource Id: 54258
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.28"
					Top:    3.43"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Background Text: К-ть договорів
				Resource Id: 54259
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.28"
					Top:    3.76"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Pushbutton: pbCLOSE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.15"
					Top:    0.05"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Закрити Договір'
					On SAM_Click
						Call F_CLOSE( ND )
			Pushbutton: pbRECALCULATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.7"
					Top:    0.05"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\RECYCLE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Перерахувати використаний ліміт договору'
					On SAM_Click
						Call F_RECALCULATE_LIMIT()
		Functions
			Function: F_RNK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered ("CUSTOMER","NMK"," customer.DATE_OFF is null ", sTmp, NMK)
					If sTmp !=STRING_Null
						Set RNK =  Val(sTmp)
						Call F_RNK1()
			Function: F_RNK1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If RNK !=  NUMBER_Null
						Set OKPO = STRING_Null
						If aMfo = '380764'
							If SqlPrepareAndExecute( hSql(),
									"SELECT c.rnk, c.nmk,  c.okpo, c.segm, c.custtype, c.tobo
									        INTO :RNK, :NMK, :OKPO, :dfSEGM, :nCusttype, :KBRANCH
									      FROM customer c
									  WHERE c.rnk= :RNK " )
									And SqlFetchNext( hSql(), nFetchRes )
								If ( NOT SalIsNull( dfSEGM ) )
									Set dfSegmName = F_GET_SegmName( dfSEGM )
						Else
							If SqlPrepareAndExecute( hSql(),
									 "SELECT c.rnk, c.nmk,  c.okpo, c.custtype, c.tobo
									  INTO :RNK,  :NMK, :OKPO,:nCusttype, :KBRANCH
									  FROM customer c where c.rnk=:RNK " ) and SqlFetchNext( hSql(), nFetchRes )
			Function: F_VALID
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Set sTmp = STRING_Null
					If ( CC_ID = STRING_Null )
						Set sTmp = sTmp || PutCrLf() || ' № ген.договора !'
					If ( KV = NUMBER_Null )
						Set sTmp = sTmp || PutCrLf() || ' вал лимита !'
					If ( LIMIT = NUMBER_Null )
						Set sTmp = sTmp || PutCrLf() || ' сумма лимита !'
					If ( DAT1 = DATETIME_Null or DAT4 = DATETIME_Null or DAT1 >= DAT4 )
						Set sTmp = sTmp || PutCrLf() || ' даты договора !'
					If ( RNK = NUMBER_Null )
						Set sTmp = sTmp || PutCrLf() || ' клиент  !'
					If ( SalIsNull( dfProduct ) )
						Set sTmp = sTmp || PutCrLf() || ' продукт  !'
					!
					If sTmp = STRING_Null
						Call SalWaitCursor(TRUE)
						If ( SalIsNull( ND ) )
							! ВІДКРИТТЯ
							If SqlPLSQLCommand( hSql(), "GAR.Open_Guarantee_Line( RNK, nVIDD, LIMIT, KV, CC_ID, dfProduct, DAT1, DAT4, DBRANCH, ND )" ) 
								Call SqlCommitEx( hSql(), strPar01 || Str(ND) )
								Call F_START( ND )
								Call SalWaitCursor( FALSE )
								Set bCHANGED = TRUE
								Return TRUE
						Else
							! РЕДАГУВАННЯ
							If SqlPLSQLCommand( hSql(), "GAR.Update_Guarantee_Line( ND, LIMIT, CC_ID, DAT1, DAT4, DBRANCH )" ) 
								Call SqlCommit( hSql() )
								Call F_START( ND )
								Call SalWaitCursor( FALSE )
								Set bCHANGED = TRUE
								Call MessageInfo ( 'Ok!' )
								Return TRUE
					Call SalWaitCursor( FALSE )
					Call MessageError( CurrentLangTable.GetAtomTitle( 'cTErr' ) || sTmp )
					Return FALSE
					!
			Function: F_START
				Description:
				Returns
				Parameters
					Number: nNd
				Static Variables
				Local variables
					String: sTmp
					Number: nSOS
				Actions
					If nNd != NUMBER_Null
						! подробно
						If SqlPrepareAndExecute( hSql(),
								"SELECT d.nd, d.cc_id, d.limit, d.sdate, d.wdate, d.RNK, d.vidd, d.SOS,
								                    d.branch, (select NAME from BRANCH where BRANCH = d.branch),
								                    d.PROD, (select SubStr(TXT, 1 ,200) from SB_OB22 where R020 = Substr(d.PROD,1,4) and OB22 = SubStr(d.PROD,5,2) ),
								                    t.kv, t.name, a.nls, -a.ostb/100, ( -a.ostx+ a.ostb)/100 ,
								                    (select count(*) from accounts where accc= a.acc and dazs is null)
								        INTO :ND, :CC_ID, :LIMIT, :DAT1, :DAT4, :RNK, :nVIDD, :nSOS, :DBRANCH, :BranchName,
								                    :dfProduct, :dfProductName, :KV, :cmbKV, :NLS, :OST, :N_LIM, :N_KOL
								FROM cc_deal d , accounts a, nd_acc n, tabval$global t
								where d.nd = :nNd and d.nd= n.nd and n.acc = a.acc and a.nbs is null And a.KV = t.KV " )
								AND SqlFetchNext( hSql(), nFetchRes )
							Call F_RNK1()
							Select Case ( nVIDD )
								Case 9
									Set rbGAR = TRUE
									Break
								Case 19
									Set rbAKR = TRUE
									If ( OST = 0 )
										! Для покритого АКРЕДИТИВУ використаний ліміт = сумі сум договорів діючих траншів
										If SqlPrepareAndExecute( hSql(), 
												"SELECT nvl(sum(LIMIT),0) INTO :OST FROM cc_deal WHERE nvl(NDI,0) = :nNd AND nvl(NDI,0) <> ND AND SOS < 14" )
												AND SqlFetchNext( hSql(), nFetchRes )
											Set N_LIM = N_LIM - OST
									Break
								Case 29
									Set rbAKC = TRUE
									Break
								Case 39
									Set rbAVL = TRUE
									Break
						!
						If ( nSOS > 13 )
							Call F_SET_AVAILABILITY( 'CLOSED' )
						Else
							Call F_SET_AVAILABILITY( 'OPENED' )
			Function: F_GET_SegmName
				Description:
				Returns
					String:
				Parameters
					String: SEGM
				Static Variables
				Local variables
					String: sSql
					Number: nSegmLen
					String: sSEGMNAME
				Actions
					Set nSegmLen = SalStrLength( SEGM )
					If nSegmLen = 4
						Set sSql = 'select CATEGORY_NAME into :sSEGMNAME from KL_CUSTOMER_SEGMENT where CATEGORY = :SEGM '
					Else If nSegmLen = 1
						Set sSql = 'select NAME into :sSEGMNAME from KL_CUSTOMER_SEGMENT_NAME where SEGMENT = :SEGM '
					Else If nSegmLen = 2
						Set sSql = 'select NAME into sSEGMNAME from KL_CUSTOMER_SUBSEGMENT_NAME where SUBSEGMENT  = :SEGM '
					If SqlPrepareAndExecute( hSql(), sSql ) and SqlFetchNext( hSql(), nFetchRes )
						Return sSEGMNAME
			Function: F_Choice_Type
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sNBS
				Actions
					If rbGAR
						Set nVIDD=9
						Set sNBS = IifS(nTip_Kl=1,'9000','9020')
						Call SalSetWindowLabelText ( bgFindCust, "Пошук клієнта ПРИНЦИПІАЛА" )
					Else If rbAKR
						Set nVIDD=19
						! Set sNBS = '9001'
					Else If rbAKC
						Set nVIDD=29
						Set sNBS = '9002'
					! АВАЛЬ
					Else If rbAVL
						Set nVIDD=39
						Set sNBS = '9003'
						Call SalSetWindowLabelText ( bgFindCust, "Пошук клієнта ПРИНЦИПІАЛА" )
					! Call SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'NBS_AIM', sNBS, 'Бал.рах.' )" )
					! Set Frm_GAR.pb_DEB.strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipAddOption')
					! Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Open.cTWndTitle'))
			Function: F_CLOSE
				Description:
				Returns
				Parameters
					Number: nND
				Static Variables
				Local variables
					String: sTXT
				Actions
					Set sTXT = STRING_Null
					If SqlPLSQLCommand(hSql(), "GAR.CLOSE_LINE( ND, sTXT ) " )
						If sTXT = STRING_Null
							Set sTXT = "Лінію #" || Str( ND ) || " закрито!"
							Call SqlCommitEx( hSql(), sTXT )
							Call MessageNoWait( sTXT, 'Повідомлення: ',  3,  0 )
							Call F_SET_AVAILABILITY( 'CLOSED' )
						Else
							Call SqlRollback(  hSql() )
							Call MessageError( "Неможливо закрити лінію #" || Str( ND ) || PutCrLf() || sTXT )
					Else
						Call SqlRollback(hSql())
			Function: F_SET_AVAILABILITY
				Description:
				Returns
				Parameters
					String: sType
				Static Variables
				Local variables
				Actions
					If ( sType = 'CLOSED' )
						Call SalHideWindow( pbKlient )
						Call SalDisableWindow( pbCLOSE )
						Call SalDisableWindow( pbRECALCULATE )
						Call SalDisableWindow( pb_Product )
						Call SalDisableWindow( pbOk )
						Call SalDisableWindow( RNK )
						Call SalDisableWindow( OKPO )
						Call SalDisableWindow( KBRANCH )
						Call SalDisableWindow( NMK )
						Call SalDisableWindow( dfSegmName )
						Call SalDisableWindow( CC_ID )
						Call SalDisableWindow( LIMIT )
						Call SalDisableWindow( DAT1 )
						Call SalDisableWindow( DAT4 )
						Call SalDisableWindow( KV )
						Call SalDisableWindow( cmbKV )
						Call SalDisableWindow( N_LIM )
						Call SalDisableWindow( OST )
					If ( sType = 'OPENED' )
						Call SalHideWindow( pbKlient )
						Call SalDisableWindow( pb_Product )
						Call SalDisableWindow( rbGAR )
						Call SalDisableWindow( rbAKR )
						Call SalDisableWindow( rbAKC )
						Call SalDisableWindow( rbAVL )
						Call SalDisableWindow( KV )
						Call SalDisableWindow( cmbKV )
			Function: F_RECALCULATE_LIMIT
				Description: Перерахувати використаний ліміт
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTXT
				Actions
					Set sTXT = "Перераховано використаний ліміт лінії #" || Str( ND ) || "!"
					If SqlPLSQLCommand(hSql(), "GAR.RECALCULATE_LIMIT_LINE( ND )" )
						Call SqlCommitEx( hSql(), sTXT )
						Call MessageNoWait( sTXT, 'Повідомлення: ',  3,  0 )
						Call F_START( ND )
					Else
						Call SqlRollback(hSql())
						Call MessageError( "Неможливо перерахувати використаний ліміт лінії #" || Str( ND ) )
		Window Parameters
			Number: nTip_Kl
			String: strPar01
			Number: pND
		Window Variables
			String: aMfo
			Number: nCusttype
			Number: nVIDD
			String: sTmpE
			Number: nTmpE
			Boolean: bCHANGED
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalSetWindowText(hWndForm, strPar01 )
				Set aMfo = GetBankMfo()
				! Call DebugN(pNd)
				! Call SalDisableWindow( rbAKR )
				Call SalDisableWindow( rbAKC )
				Set DAT1 = GetBankDate()
				If pND = NUMBER_Null
					Call SalDisableWindow( pbCLOSE )
					Call SalDisableWindow( pbRECALCULATE )
					Set rbGAR = TRUE
					Call F_Choice_Type()
					Call SalHideWindow( NLS )
					Call SalHideWindow( N_LIM )
					Call SalHideWindow( OST )
					Call SalHideWindow( pbShowCust )
				Set bCHANGED = FALSE
			On SAM_CreateComplete
				Set ND = pND
				Call F_START( ND )
			On SAM_Destroy
				If ( bCHANGED )
					Call SalSendMsg( Tbl_GAR.pbRefresh, SAM_Click, 0, 0 )
	Form Window: frm_GAR
		Class:
		Property Template:
		Class DLL Name:
		Title: Вввод параметров Гарантийного договора
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? No
			Window Location and Size
				Left:   6.475"
				Top:    1.167"
				Width:  10.7"
				Width Editable? Yes
				Height: 7.2"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 1.214"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.18"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipRefresh' )
						On SAM_Click
							Call F_START()
				!
				! Кред
				Pushbutton: pbSAVE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipSave' )
						On SAM_Click
							If F_SAVE()
				! Бухг
				Pushbutton: pb_GRANT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Green
					Message Actions
						On SAM_Create
							Set strTip = "Предоставить " || strDO
						On SAM_Click
							If ( F_VALIDATE( 'SUM_GAR' ) )
								! Call F_Prov(1,strTip )
								Call P_PAYMENTS( 11, (frm_GAR.S * 100), STRING_Null, strTip )
							Else
								Call SalSetFocus( frm_GAR.S )
				Data Field: S
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.68"
							Top:    0.738"
							Width:  2.15"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipAMOUNT' ) )
						On SAM_SetFocus
							Call SalMapEnterToTab( TRUE )
				Pushbutton: pb_REVOKE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.88"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Doc_out.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = "Отозвать " || strDO
						On SAM_Click
							! Call F_Prov(0,strTip)
							Call P_PAYMENTS( 10, (frm_GAR.S * 100), STRING_Null, strTip )
				Pushbutton: pbDel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipClose' ) || strDO
						On SAM_Click
							Set sTxt = STRING_Null
							If SqlPLSQLCommand(hSql(), "GAR.CLOSE_DEAL  (ND, sTxt ) " )
								If sTxt = STRING_Null
									Set sTxt = "Закрыт договор гарантии, реф= "||Str(ND)
									Call SqlCommitEx( hSql(), sTxt )
									Call MessageNoWait(sTxt, 'Сообщение', 3, 0)
									Call F_START()
								Else
									Call SqlRollback(  hSql() )
									Call MessageError( "Невозможно закрыть договор "||Str(ND)||" / "||sTxt )
							Else
								Call SqlRollback(hSql())
				! Обеспечение
				! Ключик
				Pushbutton: pbZalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.38"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							! Нові Договора застави
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipNewPledge' )
						On SAM_Click
							! уровень функциональности 0 (полный)
							Call Sel017( hWndMDI, IifN(SOS=15,9,0), 2, ND, Str(nGr), Str(RNK), ACC )
				! Кубик
				Pushbutton: pbZalog_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.88"
						Top:    0.155"
						Width:  Class Default
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							! Существующие Договора залога
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipExistingPledge' )
						On SAM_Click
							Call Sel017(hWndMDI, IifN(SOS=15,9,0), 11, ND, Str(nGr), Str(RNK), ACC )
				! Коромысло
				Pushbutton: pbZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.38"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							! Связь залогов и гарант.счетов
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipRelationPledge' )
						On SAM_Click
							Set sTmp = " and KU_109.ACCK in (select acc from nd_acc where nd=" || Str(ND) || " )"
							Call Bars017r1 ( NUMBER_Null, NUMBER_Null, NUMBER_Null, sTmp )
				! Бухг.кнопки
				Pushbutton: pb_Proc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.08"
						Top:    0.155"
						Width:  0.43"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Начислить Доходы по данному Договору (процентные и амортизационные)'
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipAccrualIncome' )
						On SAM_Click
							Call Sel010( hWndMDI, 0, 0, " and (s.nbs = '" || Subs(dfProduct, 1, 4) || "' or s.nbs = '3648' ) and s.acc in (select acc from nd_acc where nd=" || Str(ND) || " )", "A"  )
				Pushbutton: pb_2600V
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Взыскание начисленных доходов по данному Договору
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipPaymentAccrualIncome' )
						On SAM_Click
							! Call F_Buch1(2600,strTip )
							Call P_PAYMENTS( 4, NUMBER_Null, STRING_Null, strTip )
				Pushbutton: pb_3579
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Вынос на просрочку начисленных доходов по данному Договору
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipOverdueAccrualIncome' )
						On SAM_Click
							! Call F_Buch1(3579,strTip )
							Call P_PAYMENTS( 3, NUMBER_Null, STRING_Null, strTip )
				!
				Pushbutton: pbPRINT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.783"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: D:\BARS98\RESOURCE\BMP\PRINT_X.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Друк документів по договору
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipPrint' )
						On SAM_Click
							! Повний доступ
							If ( nFun < 2)
								Call cdoc_ShowAllDocs( ND, hWndForm)
							! тільки перегляд
							If ( nFun = 9 )
								Call cdoc_ShowAllDocsReadOnly( ND, hWndForm)
								! Перегляд з правом підпису
								! Call cdoc_ShowAllDocsSign( ND, hWndForm)
				Pushbutton: pbSob
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! График событий
							Set strTip =  CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipScheduleEvents' )
						On SAM_Click
							Call Sel017f(hWndMDI, IifN(SOS=15,9,0),16, ND, CC_ID || ' от '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ), NMK,'','','' )
				Pushbutton: pb_Payments
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\payments.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Здійснення платежів по договору
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipPayments' )
						On SAM_Click
							Call SalModalDialog( dlg_GAR_Payments, hWndMDI, nND, frm_GAR.RNK, nFun, frm_GAR.dfProduct )
				Pushbutton: pbPrcAcc ! Все СЧета
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! счета клиента
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipCustomerAccounts' )
						On SAM_Click
							Call ShowCustAccountsEx(RNK)
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.783"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Табличная форма счетов договора
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipContractAccounts' ) || IifS ( nFun = 0 OR nFun = 2 OR nFun = 4, "(редагування)", "(перегляд)" )
						On SAM_Click
							! nFun ! 0 - Полная / 1 - Кред / 2 - Бухг / 3 - Залаговик / 9 - только просмотр
							Set sTmp =
									" a.acc in (select acc from nd_acc WHERE nd="||Str(ND)||" union all
									  select acc from cc_accp WHERE accs in (select acc from nd_acc WHERE nd=" || Str(ND) || "))"
							If ( nFun = 0  OR  nFun = 2  OR  nFun = 4 )
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_AllOptions, sTmp )
							Else
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				!
				Pushbutton: pbEXIT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipExit' )
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
				Frame
					Resource Id: 54283
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.655"
						Width:  3.85"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 54284
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.08"
						Top:    0.071"
						Width:  2.15"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 54285
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.283"
						Top:    0.071"
						Width:  1.65"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 54286
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.983"
						Top:    0.071"
						Width:  2.65"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Frame
					Resource Id: 54287
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.683"
						Top:    0.071"
						Width:  3.15"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pbViewSWT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.783"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Просмотр SWIFT-сообщений 7** по ДГ'
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipViewSWIFT' )
						On SAM_Click
							! Call FunNSIEditFFiltered("SW_JOURNAL",1, " MT>=700 and MT<=799 ")
							Call Sel013(hWndMDI,  8, 0,
									"sw_journal.MT between 700 and 799
									and exists (select 1 from sw_operw where swref = sw_journal.swref and tag in ('20','21')
									and substr(trim(value),1,50) ='" || CC_ID || "' )", "")
							! SW_MESSAGES
									
				Pushbutton: pb_MOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: D:\BARS98\RESOURCE\BMP\CABINET.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							If not b_MOS
								Call SalHideWindow( pb_MOS )
							! Доп.реквизиты по КД (для МОСКВЫ)'
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipMoscow' )
						On SAM_Click
							Call SalSendMsg( Tbl_GAR.pb_MOS, SAM_Click, 0, 0 )
				Pushbutton: pbACTIVATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: D:\BARS98\RESOURCE\BMP\APP1.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Активувати угоду
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipActivate' )
						On SAM_Click
							If F_ACTIVATE( ND )
								Call f_SET_AVAILABILITY( 'OPENED' )
								Set bCHANGED = TRUE
								Call SalMessageBox( 'Договір №' || Str( ND )|| ' активовано!', 'INFO', MB_Ok | MB_IconExclamation)
				Pushbutton: pb_AddOption
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\add.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Додаткові параметри договору
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipAddOption' )
						On SAM_Click
							Call SalModalDialog( dlg_GAR_Options, hWndMDI, nND, frm_GAR.RNK, VIDD, IifN(SOS=15,9,nFun) )
				Pushbutton: pb_PAYOUT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.38"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_down.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Dark Aqua
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipPayOut' )
						On SAM_Click
							! Виконання зобовязань по договору
							If ( VIDD = 39 )
								! << Для АВАЛЮ >>
								! Виконання зобов. за рахунок кред. лінії
								Call P_PAYMENTS( 2, (frm_GAR.S * 100), STRING_Null, "виконання зобовязань за рахунок кред. лінії" )
								! Перенесення застав з дог. АВАЛЮ на дог. кред. лінії
							Else
								Call P_PAYMENTS( 71, NUMBER_Null, STRING_Null, "виконання зобовязань" )
							! Списання зобов. по договору (анулювання)
							Call P_PAYMENTS( 10, NUMBER_Null, STRING_Null, "списання  зобовязань" )
				Pushbutton: pb_RETURN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.08"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_UP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipReturn' )
						On SAM_Click
							! Повернення покриття ( 72 )
							Call P_PAYMENTS( 72, NUMBER_Null, STRING_Null, "повернення покриття" )
				Pushbutton: pb_LIMIT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.738"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							! Орієнтовний графік сум сплати щомісячної комісії
							Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipGraph' )
						On SAM_Click
							Call FunNSIEditFFiltered( "GAR_LIMITS", 0, "GAR_LIMITS.ND = " || Str( frm_GAR.ND ) )
		Contents
			Background Text: Реф.Договору
				Resource Id: 54260
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.02"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.3"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold-Italic-Underline
				Text Color: System Text Color
				Background Color: Default
			Data Field: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.65"
						Top:    0.02"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold-Italic-Underline
					Text Color: System Text Color
					Background Color: Light Gray
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.договора' )
			Data Field: CC_ID_GL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.15"
						Top:    0.38"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.32"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Yellow
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Return XSalTooltipSetText( lParam, '№ генерального договора '  )
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipGenNum' ) )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_LINE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbChilds
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.05"
					Top:    0.381"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Childs.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Maize
				Message Actions
					On SAM_Create
						Set strTip = 'В рамках лінії'
					On SAM_Click
						Call F_Lim ()
			Radio Button: rbGAR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гарантия
				Window Location and Size
					Left:   2.7"
					Top:    0.405"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Jade
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'БС='||IifS(nTip_Kl=1,'9000','9020') )
					On SAM_Click
						Set VIDD = 9
						Call F_RB()
			Radio Button: rbAKR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Акредитив
				Window Location and Size
					Left:   4.6"
					Top:    0.405"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Teal
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'БС=9001' )
					On SAM_Click
						Set VIDD = 19
						Call F_RB()
			Radio Button: rbAKC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Акцепт
				Window Location and Size
					Left:   6.5"
					Top:    0.405"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Chartreuse
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'БС=9002' )
					On SAM_Click
						Set VIDD = 29
						Call F_RB()
			Radio Button: rbAVL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Аваль
				Window Location and Size
					Left:   8.4"
					Top:    0.405"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Dark Green
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'БС=9023' )
					On SAM_Click
						Set VIDD = 39
						Call F_RB()
			Background Text: РНК
				Resource Id: 54262
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.05"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.7"
						Top:    1.0"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Burgundy
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ( CurrentLangTable.GetAtomTitle('frm_GAR.cBTipRNK') ) )
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Pushbutton: pbKlient
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.2"
					Top:    0.98"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Клієнт'
					On SAM_Click
						If ( SalIsNull( ND ) )
							Call F_RNK ()
						Else
							If ( nCusttype = 2 )
								Call EditCustCorps( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
							Else If nCusttype=3
								Call EditCustPerson( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
							Else If nCusttype=1
								Call EditCustBanks( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
			Background Text: РНОКПП
				Resource Id: 54263
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    1.05"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.483"
						Top:    1.0"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_GAR.cBTipOKPO') )
			Background Text: Клас
				Resource Id: 54264
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.95"
					Top:    1.05"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: FIN_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.0"
						Top:    1.0"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Фінансовий стан клієнта' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Назва
				Resource Id: 54265
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.4"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.7"
						Top:    1.35"
						Width:  8.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.ClientName' ) )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Бранч
				Resource Id: 54266
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.75"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: BR_KL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.7"
						Top:    1.7"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_GAR.cBTipCustBranch') )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: sBR_KL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.55"
						Top:    1.7"
						Width:  5.55"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ( CurrentLangTable.GetAtomTitle('frm_GAR.cBTipCustBranchName') ) )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Рах. для комісії
				Resource Id: 54267
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    2.1"
					Width:  1.97"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: NLS_2600_KOMIS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.25"
						Top:    2.05"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок клієнта в національній валюті' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_2600_KOMIS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.03"
					Top:    2.03"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Вибір рахунка для утримання комісії '
					On SAM_Click
						Call F_GET_NLS2600( n980, 'KOMIS' )
			Background Text: Рах. для покриття
				Resource Id: 54268
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.35"
					Top:    2.1"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: NLS_2600_POKR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.87"
						Top:    2.05"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок клієнта в валюті покриття' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_2600_POKR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.65"
					Top:    2.03"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Вибір рахунка'
					On SAM_Click
						If ( dfKV_2602 = NUMBER_Null )
							Call SalSetFocus( dfKV_2602 )
							Call SalMessageBox( "Спочатку необхідно вказати валюту покриття!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
						Else
							Call F_GET_NLS2600( dfKV_2602, 'POKR' )
			Background Text: Код продукту
				Resource Id: 54269
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.65"
					Top:    2.7"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Назва продукту
				Resource Id: 54270
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.5"
					Top:    2.7"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: System Text Color
				Background Color: Default
			Data Field: dfProduct
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 6
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.65"
						Top:    2.9"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Код продукту по договору')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_Product
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.95"
					Top:    2.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CHART.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Вибрати "Продукт"'
					On SAM_Click
						If ( NOT SalIsNull( RNK ) )
							If ( f_SET_PUL() )
								! Для НАДРА з сегментами
								If ( sBankMFO = '380764' )
									Call FunNSIGetFiltered( "V_GAR_PRODUCTS", "NAME", "VIDD = " || Str(VIDD) || "And SEGMENT is Null" ||
											IifS(nSEGM = NUMBER_Null, "", " or SEGMENT = " || Subs(Str(nSEGM),1,1) ), sTmp2, sTmp )
								Else
									Call FunNSIGet( "V_GAR_PRODUCTS", "NAME", sTmp2, sTmp )
								If ( sTmp2 != STRING_Null )
									Set dfProduct = sTmp2
									Set sProduct = sTmp
									! Пошук параметрів продукту
									Call F_GET_PROD_PARAMS()
						Else
							Call SalMessageBox( "Виберіть спочатку клієнта!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
			Data Field: sProduct
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    2.9"
						Width:  7.6"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Назва продукту по договору')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Номер договору
				Resource Id: 54271
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    3.28"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    3.25"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ договора ' || strDO )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Сума договору
				Resource Id: 54273
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    3.63"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
			Data Field: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    3.6"
						Width:  1.65"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ###000
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума договору ' || strDO )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If ( F_VALIDATE( 'SUM_DEAL' ) )
							Return VALIDATE_Ok
						Else
							Return VALIDATE_Cancel
					On SAM_KillFocus
						If ( frm_GAR.SOS = 0 )
							Set SUMK = F_GET_COMIS()
						If ( SalIsNull( KV ) )
							Call SalSetFocus( KV )
			Data Field: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.6"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Валюта договору ' || strDO )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If ( F_VALIDATE( 'KV_DEAL' ) )
							Return VALIDATE_Ok
						Else
							Return VALIDATE_Cancel
					On SAM_KillFocus
						If ( SalIsNull( dfKV_2602 ) )
							Set dfKV_2602 = KV
						If ( frm_GAR.SOS = 0 )
							Set SUMK = F_GET_COMIS()
						If ( SalIsNull( LIMIT ) )
							Call SalSetFocus( LIMIT )
			Background Text: Сума покриття
				Resource Id: 54275
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    3.98"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: dfSUM_2602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    3.95"
						Width:  1.65"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума грошового покриття ' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If ( F_VALIDATE( 'SUM_2602' ) )
							Return VALIDATE_Ok
						Else
							Return VALIDATE_Cancel
			Data Field: dfKV_2602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.95"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Валюта покриття ' || strDO )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If F_VALIDATE( 'KV_2602' )
							If ( F_VALIDATE( 'SUM_2602' ) )
								Return VALIDATE_Ok
						Return VALIDATE_Cancel
			Background Text: Початкова комісія
				Resource Id: 54277
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    4.33"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: IK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    4.3"
						Width:  0.75"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_TooltipSetText
						If ( aMfo ='300205' )
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_GAR.cBTipCommisRate') )
						Else
							! Return XSalTooltipSetText( lParam, 'Код тарифу початкової комісії' )
							Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_GAR.cBTipCommisTariff') )
					On SAM_Validate
						If ( NOT SalIsNull( IK ) AND ( IK > 0 ) )
							Return VALIDATE_Ok
						Else
							Return VALIDATE_Cancel
					On SAM_KillFocus
						If ( frm_GAR.SOS = 0 )
							Set SUMK = F_GET_COMIS()
			Data Field: SUMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 8
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.3"
						Top:    4.3"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ###000
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума початкової комісії в національній валюті' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If ( F_VALIDATE( 'SUM_COMIS' ) )
							Return VALIDATE_Ok
						Else
							Return VALIDATE_Cancel
			Background Text: Дата заключення
				Resource Id: 54272
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.45"
					Top:    3.28"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: System Text Color
				Background Color: Default
			Data Field: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.7"
						Top:    3.25"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата заключення договору ' || strDO )
					On SAM_Validate
						! Якщо дата Заключення менша за Банківську і це не УПБ
						If ( ( aMfo != '300205' ) AND ( DAT1 < bDAT ) )
							Set frm_GAR.DAT1 = bDAT
							Call SalMessageBox( "Дата заключення повинна бути >= банківській даті !",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Return VALIDATE_Cancel
						Set dTmp = CorrectDate( GetBaseVal(), DAT1, (DAT1 + 1) )
						If ( DAT1 != dTmp )
							Set frm_GAR.DAT1 = dTmp
							! Call SaveInfoToLog( 'DAT1 => CorrectDate' )
							Return VALIDATE_Cancel
						Call SaveInfoToLog( 'DAT1 => VALIDATE_Ok' )
						Return VALIDATE_Ok
			Background Text: Дата початку
				Resource Id: 54274
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.45"
					Top:    3.63"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Green
				Background Color: Default
			Data Field: dfDAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.7"
						Top:    3.6"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата початку дії договору ' || strDO )
					On SAM_SetFocus
						Call SaveInfoToLog( 'dfDAT2 => SetFocus' )
					On SAM_Validate
						If ( dfDAT2 < DAT1 )
							Set frm_GAR.dfDAT2 = DAT1
							Call SaveInfoToLog( 'DAT2 => (dfDAT2 = DAT1)' )
							Call SalMessageBox( "Дата початку повинна бути >= даті заключення !",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Return VALIDATE_Cancel
						Set dTmp = CorrectDate( GetBaseVal(), dfDAT2, (dfDAT2 +1) )
						If ( dfDAT2 != dTmp )
							Set frm_GAR.dfDAT2 = dTmp
							Call SaveInfoToLog( 'DAT2 => CorrectDate' )
							Return VALIDATE_Cancel
						Call SaveInfoToLog( 'DAT2 =>  VALIDATE_Ok' )
						Return VALIDATE_Ok
			Background Text: Дата завершення
				Resource Id: 54276
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.45"
					Top:    3.98"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
			Data Field: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.7"
						Top:    3.95"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершення дії договору ' || strDO )
					On SAM_Validate
						If ( ( DAT4 < DAT1 ) OR ( DAT4 < dfDAT2) )
							Call SalMessageBox( "Вказано недопустиму дату завершення!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Return VALIDATE_Cancel
						! Для УПБ дата завершення може бути небанківська
						If ( aMfo != '300205' )
							Set dTmp = CorrectDate( GetBaseVal(), DAT4, DAT4 +1 )
							If ( DAT4 != dTmp )
								Set frm_GAR.DAT4 = dTmp
								Return VALIDATE_Cancel
						If ( frm_GAR.SOS = 0 )
							Set SUMK = F_GET_COMIS()
						Return VALIDATE_Ok
			Background Text: Щомісячна комісія (%)
				Resource Id: 54278
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.983"
					Top:    4.33"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 5
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.7"
						Top:    4.3"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ###000
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ставка' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Бранч договору
				Resource Id: 54279
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    4.68"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: BR_DG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    4.65"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Return XSalTooltipSetText( lParam, 'Код бранча Договора' )
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_GAR.cBTipDealBranch') )
					On SAM_SetFocus
						Set sTmpE = BR_DG
					On SAM_AnyEdit
						Set BR_DG = sTmpE
					On VTM_LeftDoubleClick
						Call FunNSIGet( "OUR_BRANCH", "NAME", BR_DG, sBR_DG )
			Data Field: sBR_DG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.0"
						Top:    4.65"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipDealBranchName' ) )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Відповідальний виконавець
				Resource Id: 54280
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    5.03"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: INSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.9"
						Top:    5.0"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Return XSalTooltipSetText( lParam, 'Код Інспектора по договору' )
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipInspCode' ) )
					On SAM_SetFocus
						Set nTmpE = INSP
					On SAM_AnyEdit
						Set INSP = nTmpE
					On VTM_LeftDoubleClick
						If FunNSIGetFiltered( "STAFF", "FIO", "TYPE = 1", sTmp, sINSP )
							Set INSP = Val( sTmp )
			Data Field: sINSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.0"
						Top:    5.0"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipInspName' ) )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Group Box: Умови договору
				Resource Id: 54282
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    2.5"
					Width:  10.1"
					Width Editable? Yes
					Height: 2.93"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Pushbutton: pbVERSION
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.8"
					Top:    0.01"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F1
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalMessageBox ( ApdVer || PutCrLf() ||
								'package_body_version: ' || get_OneStringValue( "SELECT SubStr(gar.body_version,1,100) INTO :sResult FROM dual " ), 'Version Info', MB_Ok )
			Data Field: lbClient
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cFieldLabel
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   0.3"
						Top:    0.8"
						Width:  3.1"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Frame
				Resource Id: 54261
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.65"
					Top:    0.33"
					Width:  7.6"
					Width Editable? Yes
					Height: 0.41"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Drop-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 54281
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.9"
					Width:  10.08"
					Width Editable? Yes
					Height: 1.55"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
		Functions
			Function: F_START
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					! >> Створення нового договору
					If ( ND = NUMBER_Null )
						Set VIDD = 9
						Set SOS  = 0
						Set ACC = NUMBER_Null
						Set ACCC = NUMBER_Null
						Set RNK  = NUMBER_Null
						Set NMK  = STRING_Null
						Set OKPO = STRING_Null
						Set BR_KL = STRING_Null
						Set sBR_KL = STRING_Null
						Set CC_ID = STRING_Null
						! Дати
						Set DAT1 = bDAT
						Set dfDAT2 = bDAT
						! Set DAT4 = AddMonths( DAT1, 12 )
						! Set DAT4 = CorrectDate( GetBaseVal(), DAT4, DAT4 +1 )
						!
						Set LIMIT= 0
						Set KV = NUMBER_Null
						Set dfSUM_2602 = 0
						Set dfKV_2602 = NUMBER_Null
						Set dfProduct = STRING_Null
						Set sProduct = STRING_Null
						Set IK = NUMBER_Null
						Set nCusttype = NUMBER_Null
						Set CC_ID_GL = STRING_Null
						Set BR_DG = get_OneStringValue( "SELECT SubStr(sys_context('bars_context','user_branch'),1,30) INTO :sResult FROM dual" )
						Set sBR_DG = STRING_Null
						Set INSP = nUSER
						Set sINSP = STRING_Null
						Call f_SET_AVAILABILITY( 'NEW_DEAL' )
					! >> Перегляд/Редагування договору
					Else
						If SqlPrepareAndExecute( hSql(),
								"SELECT g.NDI, (select cc_id from cc_deal where nd= g.NDI), g.CC_ID, g.LIMIT,
								                    g.VIDD, g.SOS, g.PRODUCT, g.PRODUCT_NAME, g.DAT1, g.DAT2, g.DAT4,
								                    g.BR_DEAL, g.BR_DEAL_NAME, g.USERID, g.USERFIO, g.IR, decode(q.OST_SDI, 0, -g.SUMK, q.OST_SDI),
								                    g.RNK, g.CUSTTYPE, g.OKPO, g.NMK, g.FIN_NAME, g.BR_CUST, g.BR_CUST_NAME,
								                    g.ACC_COVER, q.ACCC, q.acc, nvl(q.kv,g.kv), acrN.FPROCN(q.ACC, 0, BANKDATE)
								        INTO :NDI, :CC_ID_GL, :CC_ID, :LIMIT, :VIDD, :SOS, :dfProduct, :sProduct, :DAT1, :dfDAT2, :DAT4,
								                    :BR_DG, :sBR_DG, :INSP, :sINSP, :IK, :SUMK,
								                    :RNK, :nCusttype, :OKPO, :NMK, :FIN_NAME, :BR_KL,  :sBR_KL,
								                    :ACC_COVER, :ACCC, :ACC, :KV, :IR
								      FROM v_guarantees g, ( select min(ad.ACCC) as ACCC, min(ad.ACC) as ACC, min(ad.KV) as KV, nvl(min(ac.ostc), 0)/100 as OST_SDI
								                                                           from BARS.ND_ACC n
								                                                      left join BARS.ACCOUNTS ad on ( ad.acc = n.acc AND ad.tip = 'SS ' ) 
								                                                      left join BARS.ACCOUNTS ac on ( ac.acc = n.acc AND ac.tip = 'SDI' )
								                                                        where n.nd =:ND ) q
								  WHERE g.nd = :ND
								" ) And SqlFetchNext( hSql(), nFetchRes )
							! >> Пошук параметрів продукту
							Call F_GET_PROD_PARAMS()
							! >> Рахунок утримання комісії
							If SqlPrepareAndExecute( hSql(),
									"SELECT a.nls
									        INTO :NLS_2600_KOMIS
									      FROM accounts a, nd_acc n
									  WHERE n.nd = :ND AND a.acc = n.acc
									         AND a.nbs in ('2600','1600','2620') AND a.dazs is Null
									         AND a.rnk = :RNK AND a.kv = :n980
									" ) And SqlFetchNext( hSql(), nFetchRes )
							If ( ( SUMK < 0 ) AND ( DAT4 > bDAT ) )
								! якщо продукт з коміс. а по діючому дог. вона відсутня
								Call SalColorSet ( SUMK, COLOR_IndexWindow, COLOR_Red )
								Call SalColorSet ( SUMK, COLOR_IndexWindowText, COLOR_Yellow )
							! >> Сума покриття
							If SqlPrepareAndExecute( hSql(),
									"SELECT ostc/100, KV INTO :dfSUM_2602, :dfKV_2602
									      FROM accounts a, nd_acc n
									  WHERE n.nd = :ND and n.acc= a.acc AND a.tip ='SL '
									" ) And SqlFetchNext( hSql(), nFetchRes)
								! Якщо договір з покриттям та діючий, а сума покриття = 0
								If ( IsCovered AND ( dfSUM_2602 = 0 ) AND ( bDAT > DAT4 ) )
									Call SalColorSet ( dfSUM_2602, COLOR_IndexWindow, COLOR_Red )
									! Call SalColorSet ( dfSUM_2602, COLOR_IndexWindowText, COLOR_Yellow )
							! >> Рахунок повернення покриття
							If ( ACC_COVER = NUMBER_Null ) OR NOT SqlPrepareAndExecute( hSql(),
									"SELECT a.nls
									        INTO :NLS_2600_POKR
									      FROM accounts a
									  WHERE a.acc = :ACC_COVER
									         AND a.nbs in ('2600','1600','2620','2650')
									         AND a.rnk = :RNK
									         AND a.kv  = :dfKV_2602
									         AND a.dazs is null
									" ) And SqlFetchNext( hSql(), nFetchRes )
								Set NLS_2600_POKR = STRING_Null
						! >> СТАН договору (по доступу)
						If ( ( SOS >= 14 ) OR ( nFun = 9 ) )
							Call f_SET_AVAILABILITY( 'CLOSED' )
						Else
							If ( SOS = 0 )
								Call f_SET_AVAILABILITY( 'NOT_ACTIVE' )
							Else
								Call f_SET_AVAILABILITY( 'OPENED' )
						! >> Договір без основного рахунка
						If ( ( ACC = NUMBER_Null ) OR ( ACC = 0 ) )
							Call SalDisableWindow( pbZalog )
							Call SalDisableWindow( pbZalog_All )
							Call SalDisableWindow( pbZ )
							Call SalDisableWindow( pb_GRANT )
							Call SalDisableWindow( pb_REVOKE )
							Call SalDisableWindow( pb_Proc )
							Call SalDisableWindow( pb_2600V )
							Call SalDisableWindow( pb_3579 )
					! >> ВИД договору
					Call F_RB()
					Set strDO = sVIDD [VIDD]
					! >> Пошук клієнта / Перегляд картки
					If ( SalIsNull( ND ) )
						Call SalPicSetFile( pbKlient, GetDir() || '\\RESOURCE\\BMP\\Filter.bmp' )
						Set frm_GAR.pbKlient.strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipCustFind' )
						Set frm_GAR.pbSAVE.strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipOpen' )
					Else
						Call SalPicSetFile( pbKlient, GetDir() || '\\RESOURCE\\BMP\\CUSTPERS.bmp' )
						Set frm_GAR.pbKlient.strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipCustCard' )
						Set frm_GAR.pbSAVE.strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipSave' )
					!
					Call SalWaitCursor( FALSE )
			Function: F_SAVE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Boolean: bOk
					Number: nS
					Number: p_ND
					String: sSql
					String: s9819
					String: sErr
				Actions
					Call SalWaitCursor(TRUE)
					Set sErr = STRING_Null
					If ( SalIsNull( RNK ) )
						Set sErr = sErr || PutCrLf() || "Код клієнта"
					If ( SalIsNull( CC_ID ) )
						Set sErr = sErr || PutCrLf() || "Номер договору"
					If ( SalIsNull( LIMIT ) )
						Set sErr = sErr || PutCrLf() || "Ліміт договору"
					If ( SalIsNull( KV ) )
						Set sErr = sErr || PutCrLf() || "Валюту договору"
					If ( SalIsNull( DAT1 ) )
						Set sErr = sErr || PutCrLf() || "Дата заключення"
					If ( SalIsNull( dfDAT2 ) )
						Set sErr = sErr || PutCrLf() || "Дата початку"
					If ( SalIsNull( DAT4 ) )
						Set sErr = sErr || PutCrLf() || "Дата завершення"
					! if ( (DAT1 > dfDAT2) OR ( dfDAT2 >= DAT4 ) )
					If ( SalIsNull( dfProduct ) )
						Set sErr = sErr || PutCrLf() || "Код продукта"
					! Якщо продуктом передбачено рах.щоміс.коміс. то має бути вказна ставка коміс.
					If ( IsMonthCommis AND ( IR = NUMBER_Null OR IR = 0 ) )
						Set sErr = sErr || PutCrLf() || "% щомісячної комісії"
					! Рахунок утримання разової комісії
					If ( SUMK > 0 ) AND ( SalIsNull( NLS_2600_KOMIS ) ) AND 
							SalMessageBox( "Ви не вказали рахунок для утримання комісії!" || PutCrLf() || "Бажаєте продовжити?",
							                                    CurrentLangTable.GetAtomTitle( 'cMsgWarning' ),
							                                    MB_IconQuestion | MB_YesNo) != IDYES
						Set sErr = sErr || PutCrLf() || "Рахунок утримання початкової комісії"
					!
					If ( sErr != STRING_Null )
						Call SalWaitCursor(FALSE)
						Call MessageError( CurrentLangTable.GetAtomTitle( 'cTErr' ) || PutCrLf() || 'Не заповнено: ' || sErr )
						Return FALSE
					!
					Set sTxt = IifS (nND =NUMBER_Null, 'Открыт',  'Обновлен') || ' Договор гарантии.'|| CC_ID
					Set p_ND = nND
					If SqlPrepareAndExecute( hSql(),
							"Insert into tmp_par ( n01, n02, n03, n04, n05, n06, n07, n08, n09, n10, s01, S02, d01, d02)
							Values( :RNK, :VIDD, :LIMIT, :dfSUM_2602, :KV, :nTip_Kl, :IK, :IR, :frm_GAR.ACCC, :NDI, :CC_ID, :dfProduct, :DAT1, :DAT4 )
							" ) And SqlPLSQLCommand( hSql(), "GAR.modi_gar( p_ND, dfDAT2, (SUMK * 100), NLS_2600_KOMIS, dfKV_2602, NLS_2600_POKR, BR_DG )" )
							And SqlCommitEx( hSql(), sTxt )
						! Call Debug(Str(p_ND))
						Set ND  = p_ND
						Set nND = p_ND
						Call F_START()
						Call SalWaitCursor(FALSE)
						Call MessageNoWait(sTxt ||' Реф='||Str(ND),'Сообщение',3,0)
						Set bCHANGED = TRUE
						Return TRUE
					!
					Call SalWaitCursor(FALSE)
					Call SqlRollback(hSql())
					Call MessageNoWait( 'Неуспешное сохранение ' || CC_ID, 'Ошибка', 0, 1)
					Return FALSE
			Function: F_RB
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Select Case ( VIDD )
						! ГАРАНТІЯ
						Case 9
							Set rbGAR = TRUE
							Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_GAR.cTWndTitle_GAR' ) )
							Set frm_GAR.pb_GRANT.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipGRANT_GAR')
							Set frm_GAR.pb_REVOKE.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipREVOKE_GAR')
							Set frm_GAR.pb_PAYOUT.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipPAYOUT_GAR' )
							Set frm_GAR.lbClient = CurrentLangTable.GetAtomTitle( 'frm_GAR.Client' ) || ' / ' || CurrentLangTable.GetAtomTitle( 'frm_GAR.Principal' )
							Break
						! АКРЕДИТИВ
						Case 19
							Set rbAKR = TRUE
							Set frm_GAR.pb_GRANT.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipGRANT_AKR' )
							Set frm_GAR.pb_REVOKE.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipREVOKE_AKR' )
							Set frm_GAR.pb_PAYOUT.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipPAYOUT_AKR' )
							Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_GAR.cTWndTitle_AKR' ) )
							Set frm_GAR.lbClient = CurrentLangTable.GetAtomTitle( 'frm_GAR.Client' ) || ' / ' || CurrentLangTable.GetAtomTitle( 'frm_GAR.Applicant' )
							Break
						! АКЦЕПТ
						Case 29
							Set rbAKC = TRUE
							Set frm_GAR.pb_GRANT.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipGRANT_AKC' )
							Set frm_GAR.pb_REVOKE.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipREVOKE_AKC' )
							Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_GAR.cTWndTitle_AKC' ) )
							Set frm_GAR.lbClient = CurrentLangTable.GetAtomTitle( 'frm_GAR.Client' )
							Break
						! АВАЛЬ
						Case 39
							Set rbAVL = TRUE
							Set frm_GAR.pb_GRANT.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipGRANT_AVL' )
							Set frm_GAR.pb_REVOKE.strTip = CurrentLangTable.GetAtomTitle('frm_GAR.cBTipREVOKE_AVL' )
							Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_GAR.cTWndTitle_AVL' ) )
							Set frm_GAR.lbClient = CurrentLangTable.GetAtomTitle( 'frm_GAR.Client' ) || ' / ' || CurrentLangTable.GetAtomTitle( 'frm_GAR.Issuer' )
							Break
			! Function: F_Prov
				                                                                   Description: 
				                                                                   Returns 
				                                                                   Parameters 
					                                                                   Number: nDk
					                                                                   String: sTxt
				                                                                   Static Variables 
				                                                                   Local variables 
					                                                                   String: sTxt1
				                                                                   Actions 
					                                                                   Set sTxt1 =  sTxt || ' на сумму ' || SalNumberToStrX( S, 2 )
					                                                                   If ( S > 0 ) And
							SalMessageBox( "Вы действительно хотите " || sTxt1 || "?",
							                                    CurrentLangTable.GetAtomTitle( 'cTAt' ),
							                                    MB_IconQuestion | MB_YesNo) = IDYES
						                                                                   If ( ND > 0 ) And SqlPLSQLCommand( hSql(),"GAR.PAY( ND, VIDD, nDk, (S*100), CC_ID, DAT1 )" )
								And SqlCommitEx( hSql(), sTxt1 )
							                                                                   Call SalMessageBox( sTxt1, 'Виконано по плановому залишку!', MB_Ok )
							                                                                   Return TRUE
					                                                                   Return FALSE
			Function: F_Lim
				Description: Вибір договору лінії
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					Number: nRnk
					! Number: nKv
					Number: nLim
					Date/Time: dDat1
					Date/Time: dDat4
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered( "CC_GAR", "CC_ID", " CC_GAR.NDI = CC_GAR.ND and SOS < 14 " || 
							IifS ( RNK != NUMBER_Null, " and CC_GAR.RNK=" || Str(RNK),""), sTmp, CC_ID_GL )
					If sTmp !=STRING_Null
						Set NDI = Val(sTmp)
						If SqlPrepareAndExecute( hSql(),
								"SELECT rnk, kv,  acc, vidd, greatest(gl.bd, DAT1), DAT4, ( LIMIT - OST_9020 ), PROD,
								                    (select SubStr(TXT, 1 ,250) from SB_OB22 where R020 = Substr(PROD,1,4) and OB22 = SubStr(PROD,5,2) )
								        INTO :nRnk, :KV, :ACCC, :VIDD :dDat1, :dDat4, :nLim, :dfProduct, :sProduct
								      FROM CC_GAR
								  WHERE nd = " || Str(NDI)  ) and SqlFetchNext( hSql(), nFetchRes )
							If ( SalIsNull( RNK ) )
								Call F_RNK1 ( nRnk )
							If ( ( SalIsNull( DAT1 ) ) OR ( dDat1 > DAT1 ) )
								Set DAT1 = dDat1
							If ( ( SalIsNull( DAT4 ) ) OR ( dDat4 < DAT4 ) )
								Set DAT4 = dDat4
							! If ( KV = nKv And LIMIT = NUMBER_Null )
								                                                                                                                                 Set LIMIT = nLim
							If ( KV = n980 )
								Set dfKV_2602 = KV
								Call SalDisableWindow( dfKV_2602 )
							Call F_RB()
							If ( NOT SalIsNull( dfProduct ) )
								Call F_GET_PROD_PARAMS()
							Call SalDisableWindow( pbKlient )
							Call SalDisableWindow( pb_Product )
							Call SalDisableWindow( KV )
							Call f_SET_AVAILABILITY( 'DISABLE_RB' )
			Function: F_RNK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							("CUSTOMER","NMK"," customer.DATE_OFF is null and customer.custtype in ( "||IifS ( nTip_Kl = 0, "2,3", Str(nTip_Kl) ) ||")", sTmp, NMK)
					If sTmp !=STRING_Null
						Call F_RNK1(  Val(sTmp) )
			Function: F_RNK1
				Description:
				Returns
				Parameters
					Number: nRnk
				Static Variables
				Local variables
				Actions
					Set RNK=NUMBER_Null
					Set OKPO=STRING_Null
					!
					If SqlPrepareAndExecute( hSql(),
							 "SELECT c.nmk, c.rnk, c.okpo, nvl(f.NAME, 'НЕ визначений'), c.custtype, c.SEGM, c.branch, b.name
							         INTO :NMK, :RNK, :OKPO, :FIN_NAME, :nCusttype, :nSEGM, :BR_KL, :sBR_KL
							      FROM customer c ,  stan_fin f,  branch b
							  WHERE c.CRISK = f.FIN(+) AND c.RNK = :nRnk AND c.BRANCH = b.BRANCH
							" ) And SqlFetchNext( hSql(), nFetchRes )
						If NLS_2600_KOMIS  != STRING_Null
							! Якщо у клієнта тільки один поточний рахунок у Нацвалюті   and rownum=1)
							! If Not SqlPrepareAndExecute( hSql(),
									"SELECT a.nls
									        INTO :NLS_2600_KOMIS
									      FROM accounts a
									  WHERE nbs = decode(c.custtype,1,'1600',2,'2600','2620')
									         AND kv = :n980 AND rnk = :nRnk AND dazs is null
									" ) And SqlFetchNext( hSql(), nFetchRes )
			Function: F_GET_NLS2600
				Description: Пошук поточного рахунка клієнта
				Returns
				Parameters
					Number: nKV
					String: sNlsType
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					If RNK != NUMBER_Null
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered( "ACCOUNTS", "NLS", "ACCOUNTS.KV = " || Str(nKV) ||
								" And ACCOUNTS.NBS in ( '2600', '2620', '2650' ) And ACCOUNTS.DAZS is Null And ACCOUNTS.RNK = " || Str(RNK), sTmp, sTmp1 )
						If sTmp !=STRING_Null
							If ( sNlsType = 'KOMIS' )
								Set NLS_2600_KOMIS = sTmp1
							If ( sNlsType = 'POKR' )
								Set ACC_COVER = Val( sTmp )
								Set NLS_2600_POKR = sTmp1
			Function: F_GET_COMIS
				Description: Повертає суму початкової комісії
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					Number: nCOMIS
				Actions
					! Якщо вказно суму та валюту договору
					If ( ( LIMIT > 0 ) AND ( IK > 0 ) AND ( NOT SalIsNull( KV ) ) AND ( NOT SalIsNull( DAT4 ) ) )
						If SqlPrepareAndExecute( hSql(),
								"SELECT GAR.GET_COMMISSION( :dfDAT2, :DAT4, :IK , (:LIMIT * 100), :KV ) / 100 INTO :nCOMIS  FROM dual
								" ) And SqlFetchNext( hSql(), nFetchRes )
							Return nCOMIS
						Else
							Return NUMBER_Null
			Function: F_Buch1
				Description:
				Returns
				Parameters
					Number: pMode
					String: pTip
				Static Variables
				Local variables
					String: sErr
					String: sTxt
					Number: nNd
				Actions
					Set nNd = ND
					If nNd != NUMBER_Null
						Set sTxt = pTip  || " реф дог=" ||Str(nNd)
					If SalMessageBox(
							'Вы действительно хотите выполнить' || sTxt || ' ?', 'В Н И М А Н И Е ! ',
							MB_IconQuestion | MB_YesNo) = IDYES
						If SqlPLSQLCommand( hSql(),"GAR.BUCH1( pMode, nNd, sErr ) ")
							If sErr = STRING_Null
								Call SqlCommitEx( hSql(), pTip )
								Call SalMessageBox( sTxt ,'Выполнено по план.ост. ! ',  MB_Ok)
								Return TRUE
							Else
								Call SqlRollback(hSql())
								Call MessageError( "Ошибка !" ||sErr )
								Return FALSE
						!
						Return FALSE
			Function: F_ACTIVATE
				Description:
				Returns
				Parameters
					Number: nND
				Static Variables
				Local variables
				Actions
					If SalMessageBox( 'Виконати активацію поточного договору?',
							                                       CurrentLangTable.GetAtomTitle('cTAt'),
							                                       MB_IconQuestion|MB_YesNo ) = IDYES
						If SqlPLSQLCommand( hSql(), "BARS.GAR.ACTIVATE( ND ) " )
							Call SqlCommit( hSql() )
							Return TRUE
						Else
							Return FALSE
			Function: f_CHECK_USER_RIGHT
				Description: перевірка прав користувача на активацію договору
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Boolean: nRIGHT
				Actions
					If SqlPrepareAndExecute(hSql(),
							 "select GAR.CHECK_USER_RIGHT into :nRIGHT from DUAL" )
							And SqlFetchNext( hSql(), nFetchRes)
						If ( nRIGHT = 1 )
							Return TRUE
						Else
							Return FALSE
			Function: f_SET_AVAILABILITY
				Description: Управління доступністю елементів на формі
				Returns
				Parameters
					String: sType
				Static Variables
				Local variables
				Actions
					! >> Новий договір
					If ( sType = 'NEW_DEAL' )
						Call SalDisableWindow( pbACTIVATE)
						Call SalDisableWindow( pbDel )
						!
						Call SalDisableWindow ( pbZalog )
						Call SalDisableWindow ( pbZalog_All )
						Call SalDisableWindow ( pbZ )
						!
						Call SalDisableWindow ( pb_Proc )
						Call SalDisableWindow ( pb_2600V )
						Call SalDisableWindow ( pb_3579 )
						Call SalDisableWindow( pb_AddOption )
						Call SalDisableWindow( pb_Payments )
						!
						Call SalDisableWindow( pbPRINT )
						Call SalDisableWindow( pbSob )
						Call SalDisableWindow( pbViewSWT )
						Call SalDisableWindow( pbPrcAcc )
						Call SalDisableWindow( pbTabAcc )
						If ( SalIsWindowVisible( pb_MOS ) )
							Call SalDisableWindow( pb_MOS )
						!
						Call SalDisableWindow ( pb_GRANT )
						Call SalDisableWindow ( pb_REVOKE )
						Call SalDisableWindow ( pb_PAYOUT )
						Call SalDisableWindow ( pb_RETURN )
						!
						Call SalEnableWindow( pb_Product )
						Call SalEnableWindow( pbKlient )
						! Для УПБ
						If ( aMfo ='300205' )
							Call SalDisableWindow( dfDAT2 )
					! >> НЕ активний договір
					If ( sType = 'NOT_ACTIVE' )
						! pbACTIVATE
						If ( ( nFun = 0 ) AND f_CHECK_USER_RIGHT() )
							Call SalEnableWindow( pbACTIVATE )
						Else
							Call SalDisableWindow( pbACTIVATE )
						!
						Call SalDisableWindow ( pbZalog )
						Call SalDisableWindow ( pbZalog_All )
						Call SalDisableWindow ( pbZ )
						!
						Call SalDisableWindow( pb_Proc )
						Call SalDisableWindow( pb_2600V )
						Call SalDisableWindow( pb_3579 )
						Call SalEnableWindow( pb_AddOption )
						Call SalDisableWindow( pb_Payments )
						Call SalEnableWindow( pbPrcAcc )
						Call SalEnableWindow( pbTabAcc )
						!
						Call SalDisableWindow ( pb_GRANT )
						Call SalDisableWindow ( pb_REVOKE )
						Call SalDisableWindow ( pb_PAYOUT )
						Call SalDisableWindow ( pb_RETURN )
						! Для УПБ
						If ( sBankMFO = '300205' )
							Call SalDisableWindow( dfDAT2 )
							Call SalShowWindow( pb_LIMIT )
						! Якщо договір є траншем ЛІНІЇ
						If ( NDI > 0 )
							Call SalDisableWindow( pb_LINE )
							Call SalDisableWindow( pb_Product )
							Call SalDisableWindow ( KV )
						Call f_SET_AVAILABILITY( 'DISABLE_RB' )
					! >> Діючий договір (після активації) по рівню доступу вказаному в nFun
					If ( sType = 'OPENED' )
						If ( SalIsWindowVisible( pb_LINE ) )
							Call SalDisableWindow( pb_LINE )
						! Якщо договір є траншем ЛІНІЇ
						If ( NDI > 0 )
							Call SalDisableWindow( LIMIT )
							Call SalDisableWindow( dfSUM_2602 )
						Call SalDisableWindow( KV )
						Call SalDisableWindow( dfKV_2602 )
						Call SalDisableWindow( IK )
						Call SalDisableWindow( SUMK )
						! Call SalDisableWindow( pb_2600_KOMIS )
						Call SalDisableWindow( IR )
						Call SalDisableWindow( INSP )
						! << Після активації договору >>
						Call SalDisableWindow( pbACTIVATE )
						Call SalEnableWindow( pbPRINT )
						Call SalEnableWindow( pbSob )
						Call SalEnableWindow( pbViewSWT )
						Call SalEnableWindow( pbPrcAcc )
						Call SalEnableWindow( pbTabAcc )
						Call SalEnableWindow( pb_AddOption )
						If ( SalIsWindowVisible( pb_MOS ) )
							Call SalEnableWindow( pb_MOS )
						! nFun ( 0 - Полная / 1 - Кред / 2 - Бухг / 3 - Залаговик / 4 - супровід / 9 - только просмотр )
						If ( nFun = 0 OR nFun = 1OR nFun = 4 )
							Call SalEnableWindow( pbSAVE )
							If ( f_CHECK_USER_RIGHT() AND ( NDI != NUMBER_Null ) )
								Call SalEnableWindow( pb_Product )
							Else
								Call SalDisableWindow( pb_Product )
						Else
							Call SalDisableWindow( pbSAVE )
						! Проводки
						If ( nFun = 0 OR nFun = 2 OR nFun = 4 )
							! Для покритого Акредитиву суму дог. не вішаємо на осн.рах.
							If ( ( VIDD = 19 ) AND (IsCovered) )
								Call SalDisableWindow( pb_GRANT )
								Call SalDisableWindow( S )
								Call SalDisableWindow( pb_REVOKE )
							Else
								Call SalEnableWindow( pb_GRANT )
								Call SalEnableWindow( pb_REVOKE )
							Call SalEnableWindow( pbDel )
							Call SalEnableWindow( pb_Proc )
							! Якщо немає рах.2600 - немає звідки списувати комісію
							If ( SalIsNull( NLS_2600_KOMIS ) )
								Call SalDisableWindow( pb_2600V )
							Else
								Call SalEnableWindow( pb_2600V )
							Call SalEnableWindow( pb_3579 )
							If ( aMfo != '300205' )
								Call SalEnableWindow( pb_Payments )
							! Повернення покриття / оплата за рахунок покриття
							! If ( f_CHECK_USER_RIGHT() )
								                                                                                        Call SalEnableWindow( pbACTIVATE )
							If ( dfSUM_2602 > 0 )
								Call SalEnableWindow( pb_PAYOUT )
								Call SalEnableWindow( pb_RETURN )
							Else If ( VIDD = 39 )
								! Для АВАЛЬ оплата за рахунок кредитної лінії
								Call SalEnableWindow( pb_PAYOUT )
							Else
								Call SalDisableWindow( pb_PAYOUT )
								Call SalDisableWindow( pb_RETURN )
						Else
							Call SalDisableWindow( pbDel )
							Call SalDisableWindow( pb_GRANT )
							Call SalDisableWindow( pb_REVOKE )
							Call SalDisableWindow( pb_Proc )
							Call SalDisableWindow( pb_2600V )
							Call SalDisableWindow( pb_3579 )
							Call SalDisableWindow( pb_Payments )
							Call SalDisableWindow( pb_PAYOUT )
							Call SalDisableWindow( pb_RETURN )
						! Застава
						If ( nFun = 0 OR nFun = 3 OR nFun = 4 )
							Call SalEnableWindow( pbZalog )
							Call SalEnableWindow( pbZalog_All )
							Call SalEnableWindow( pbZ )
						Else
							Call SalDisableWindow( pbZalog )
							Call SalDisableWindow( pbZalog_All )
							Call SalDisableWindow( pbZ )
						! Для УПБ
						If ( aMfo ='300205' )
							Call SalDisableWindow( dfDAT2 )
							Call SalShowWindow( pb_LIMIT )
						! RB
						Call f_SET_AVAILABILITY( 'DISABLE_RB' )
					! >> Закритий договір / Режим "ТІЛЬКИ ПЕРЕГЛЯД"
					If ( sType = 'CLOSED' )
						Call SalDisableWindow( pbSAVE )
						Call SalDisableWindow( pbACTIVATE )
						Call SalDisableWindow( pbDel )
						If ( SalIsWindowVisible( pb_LINE ) )
							Call SalDisableWindow( pb_LINE )
						Call SalDisableWindow( pbZalog )
						Call SalDisableWindow( pbZalog_All )
						Call SalDisableWindow( pbZ )
						!
						Call SalDisableWindow( pb_Proc )
						Call SalDisableWindow( pb_2600V )
						Call SalDisableWindow( pb_3579 )
						! Call SalDisableWindow( pb_AddOption )
						Call SalDisableWindow( pb_Payments )
						!
						Call SalDisableWindow( pbPRINT )
						Call SalDisableWindow( pbTabAcc )
						If ( SalIsWindowVisible( pb_MOS ) )
							Call SalDisableWindow( pb_MOS )
						!
						Call SalHideWindow( pb_REVOKE )
						Call SalHideWindow( S )
						Call SalHideWindow( pb_GRANT )
						Call SalHideWindow( pb_PAYOUT )
						Call SalHideWindow( pb_RETURN )
						!
						Call SalDisableWindow( pbKlient )
						Call SalDisableWindow( pb_2600_KOMIS )
						Call SalDisableWindow( pb_2600_POKR )
						!
						Call SalDisableWindow( pb_Product )
						Call SalDisableWindow( ND )
						Call SalDisableWindow( CC_ID )
						Call SalDisableWindow( LIMIT )
						Call SalDisableWindow( KV )
						Call SalDisableWindow( DAT1 )
						Call SalDisableWindow( dfDAT2 )
						Call SalDisableWindow( DAT4 )
						Call SalDisableWindow( dfSUM_2602 )
						Call SalDisableWindow( dfKV_2602 )
						Call SalDisableWindow( IK )
						Call SalDisableWindow( SUMK )
						Call SalDisableWindow( IR )
						Call SalDisableWindow( BR_DG )
						Call SalDisableWindow( INSP )
						Call f_SET_AVAILABILITY( 'DISABLE_RB' )
					! >>
					If ( sType = 'PROD_PARAMS' )
						! Якщо договір з покриттям
						If ( IsCovered )
							Call SalEnableWindow( pb_2600_POKR )
							Call SalEnableWindow( dfSUM_2602 )
							Call SalEnableWindow( dfKV_2602 )
						Else
							Call SalDisableWindow( pb_2600_POKR )
							Call SalDisableWindow( dfSUM_2602 )
							Call SalDisableWindow( dfKV_2602 )
						! Якщо договір з щомісячною комісією
						If ( IsMonthCommis )
							Call SalEnableWindow( IR )
						Else
							Set IR = NUMBER_Null
							Call SalDisableWindow( IR )
						! Початкова КОМІСІЯ
						If ( aMfo ='380764' )
							! НАДРА - можна міняти суму
							Call SalDisableWindow( IK )
							Call SalEnableWindow( SUMK )
						Else If ( aMfo ='300205' )
							! УПБ - хочуть міняти і суму і ставку комісії
							Call SalEnableWindow( IK )
							Call SalEnableWindow( SUMK )
						Else
							! ІНШІ БАНКИ - можна міняти ставку
							Call SalEnableWindow( IK )
							Call SalDisableWindow( SUMK )
					! >>
					If ( sType = 'DISABLE_RB' )
						Call SalDisableWindow( rbGAR )
						Call SalDisableWindow( rbAKR )
						Call SalDisableWindow( rbAKC )
						Call SalDisableWindow( rbAVL )
			Function: f_SET_PUL
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sNBS
				Actions
					! ГАРАНТІЯ
					If ( VIDD = 9 )
						Set sNBS = IifS(nTip_Kl=1,'9000','9020')
					!
					Else If ( VIDD=19 )
						Set sNBS = '9001'
					!
					Else If ( VIDD=29 )
						Set sNBS = '9002'
					! АВАЛЬ
					Else If ( VIDD=39 )
						Set sNBS = '9003'
					!
					If SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'NBS_AIM', sNBS, 'Бал.рах.' )" )
						Return TRUE
					Else
						Return FALSE
			Function: F_VALIDATE
				Description:
				Returns
					Boolean:
				Parameters
					String: sName
				Static Variables
				Local variables
					Number: nTmp
				Actions
					If ( sName = 'SUM_2602' )
						If ( IsCovered AND ( LIMIT > 0 ) )
							If ( ( KV != n980 ) AND ( dfKV_2602 = n980 ) )
								! Покриття в гривні для валютних договорів має бути 110% від суми договору
								If SqlPrepareAndExecute(hSql(),
										"SELECT round( gl.p_icurval (:KV, (:LIMIT * 100), :bDAT) * 0.011 ) INTO :nTmp FROM dual
										" ) And SqlFetchNext( hSql(), nFetchRes )
									If ( dfSUM_2602 < nTmp )
										Set dfSUM_2602 = nTmp
										Call SalMessageBox( "Вказано недостатню суму покриття!",
												                                             CurrentLangTable.GetAtomTitle('cTErr'),
												                                             MB_Ok | MB_IconStop )
										Return FALSE
							Else
								Set nTmp = IifN( dfSUM_2602 = NUMBER_Null, 0, dfSUM_2602 )
								If (  nTmp < LIMIT )
									Set dfSUM_2602 = LIMIT
									Call SalMessageBox( "Вказано недостатню суму покриття!",
											                                             CurrentLangTable.GetAtomTitle('cTErr'),
											                                             MB_Ok | MB_IconStop )
									Return FALSE
						Return TRUE
					If ( sName = 'SUM_GAR' )
						If ( SalIsNull( frm_GAR.S ) OR ( frm_GAR.S = 0 ) )
							Call SalMessageBox( "Cума має бути більша нуля!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Set frm_GAR.S = frm_GAR.LIMIT
							Return FALSE
						If ( ( Not SalIsNull( CC_ID_GL ) ) OR ( SalIsNull( CC_ID_GL ) AND aMfo = '380764' ) )
							! Сума гарантії != сумі договору АБО Сума гарантії більша за суму покриття
							If ( ( S != LIMIT ) OR ( IsCovered AND S > dfSUM_2602 AND VIDD != 39 ) )
								Call SalMessageBox( "Вказано невірну суму!",
										                                             CurrentLangTable.GetAtomTitle('cTErr'),
										                                             MB_Ok | MB_IconStop )
								Set S = IifN( LIMIT > dfSUM_2602, dfSUM_2602, LIMIT )
								Return FALSE
						Return TRUE
					If ( sName = 'SUM_DEAL' )
						! Для договору в межах лінії перевіряємо на перевищення загальної суми лінії
						If ( NDI > 0 )
							If SqlPrepareAndExecute( hSql(),
									"SELECT limit INTO :nTmp FROM cc_deal WHERE ND = :NDI
									" ) And SqlFetchNext( hSql(), nFetchRes ) And frm_GAR.LIMIT > nTmp
								Set frm_GAR.LIMIT = nTmp
								Call SalMessageBox( "Вказана сума перевищує загальну суму лінії!",
										                                             CurrentLangTable.GetAtomTitle('cTErr'),
										                                             MB_Ok | MB_IconStop )
								Return FALSE
						Else
							If ( ( LIMIT = NUMBER_Null ) OR ( LIMIT = 0 ) )
								Return FALSE
						Return TRUE
					If ( sName = 'SUM_COMIS' )
						Set nTmp = F_GET_COMIS()
						If ( SUMK < nTmp )
							Set SUMK = nTmp
							Call SalMessageBox( "Вказана сума комісії менша за мінімально допустиму (" || Str( nTmp ) || ")!" ,
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Return FALSE
						Else
							Return TRUE
					If ( sName = 'KV_DEAL' )
						If ( ( KV = 980 ) OR ( KV = 840 ) OR ( KV = 978 ) OR ( KV = 643 ) )
							Return TRUE
						Else
							Call SalMessageBox( "Вказаний недопустимий код валюти!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Return FALSE
					If ( sName = 'KV_2602' )
						! If ( ( dfKV_2602 != NUMBER_Null ) AND ( ( dfKV_2602 != KV ) AND ( dfKV_2602 != n980 ) ) )
						If ( ( dfKV_2602 != KV ) AND ( dfKV_2602 != n980 ) )
							Set dfKV_2602 = KV
							Call SalMessageBox( "Вказано недопустимий код валюти для покриття!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							Return FALSE
						Else
							Return TRUE
					!
					! If ( sName = 'DAT_DEAL' )
						                                                                     If ( (DAT1 > dfDAT2) OR ( dfDAT2 >= DAT4 ) )
							! Set dfDAT2 = DAT1
							                                                                     Call SalMessageBox( "Вказано недопустиму дату початку!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							                                                                     Return FALSE
						                                                                     Else 
							                                                                     Return TRUE
					! If ( sName = 'DAT_BEGIN' )
						                                                              If ( dfDAT2 < DAT1 )
							                                                              Call SalMessageBox( "Дата початку повинна бути >= даті заключення !",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							                                                              Return FALSE
						                                                              Else 
							                                                              Return TRUE
					! If ( sName = 'DAT_END' )
						                                                     If ( ( DAT4 > DAT1 ) AND ( DAT4 > dfDAT2) )
							                                                     Return TRUE
						                                                     Else 
							                                                     Call SalMessageBox( "Вказано недопустиму дату завершення!",
									                                             CurrentLangTable.GetAtomTitle('cTErr'),
									                                             MB_Ok | MB_IconStop )
							                                                     Return FALSE
			Function: F_GET_PROD_PARAMS
				Description: Пошук параметрів продукту
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT " || IifS( frm_GAR.ND = NUMBER_Null, " tar1, ", " " ) || " nvl2( SL, 1, 0 ), nvl2( SK0, 1, 0 )
							        INTO " || IifS( frm_GAR.ND = NUMBER_Null, " :IK, ", " " ) || " :IsCovered, :IsMonthCommis
							      FROM cck_ob22
							  WHERE nbs = SubStr(:dfProduct,1,4) AND ob22 = SubStr(:dfProduct,5,2)
							" ) And SqlFetchNext( hSql(), nFetchRes )
						If ( frm_GAR.SOS = 0 )
							Call f_SET_AVAILABILITY( 'PROD_PARAMS' )
			Function: get_OneNumberValue
				Description: ф-я повертає результат виконання переданого запиту в строку nResult
				Returns
					Number:
				Parameters
					String: sSqlText
				Static Variables
				Local variables
					Number: nResult
				Actions
					If SqlPrepareAndExecute( hSql(), sSqlText ) And Not SqlFetchNext( hSql(), nFetchRes )
						Set nResult = NUMBER_Null
					Return nResult
			Function: P_PAYMENTS
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTypePay
					Number: nSumPay
					String: sNbsOB22
					String: sMessage
				Static Variables
				Local variables
					Number: nREF
				Actions
					If SalMessageBox( "Виконати операцію " || sMessage || " по договору " || Str(frm_GAR.ND) || " ?",
							                                       CurrentLangTable.GetAtomTitle( 'cTAt' ),
							                                       MB_IconQuestion | MB_YesNo) = IDYES
						If SqlPLSQLCommand( hSql(),"GAR.PAYMENT( frm_GAR.ND, nTypePay, nSumPay, sNbsOB22, nREF )" )
							Call SqlCommitEx( hSql(), ( sMessage || Str(nREF) ) )
							! Call SalMessageBox( "Створено операцію REF #" || Str(nREF),
									                                            CurrentLangTable.GetAtomTitle( 'cTMess' ),
									                                            MB_Ok | MB_IconExclamation )
							Call MessageNoWait( 'Виконано ' || sMessage || IifS( nREF > 0, " REF # " || Str(nREF), ""),
									                                             CurrentLangTable.GetAtomTitle( 'cTMess' ), 3, 0 )
							Return TRUE
						Else
							Call SqlRollback( hSql() )
							Return FALSE
			Function: get_OneStringValue
				Description: ф-я повертає результат виконання переданого запиту в строку sResult
				Returns
					String:
				Parameters
					String: sSqlText
				Static Variables
				Local variables
					String: sResult
				Actions
					If SqlPrepareAndExecute( hSql(), sSqlText ) And Not SqlFetchNext( hSql(), nFetchRes )
						Set sResult = STRING_Null
					Return sResult
		Window Parameters
			Number: nTip_Kl
			Number: nFun ! 0 - Полная
					               1 - Кред
					               2 - Бухг
					               3 - Залаговик
					               4 - Супровід (Кред + Бухг + Зал) для НАДРА
					               9 - только просмотр
			Number: nGr
			Window Handle: pbRefreshG
			Receive Number: nND
			String: sPar4
		Window Variables
			Number: ACCC
			Number: NDI
			Number: ACC
			! Number: ACC_Add
			! Number: ACCN
			! Number: ACC_3648
			! Number: ACC_2099
			! Number: ACC_SD_SDI
			Number: ACC_COVER
			Number: nCusttype
			Number: nSEGM
			Number: SOS
			Number: FIN
			Number: VIDD
			Number: n980
			Number: nTmpE
			Number: nUSER
			Date/Time: bDAT
			Date/Time: dTmp
			String: sTmp
			String: sTmp2
			String: sTmpE
			String: aMfo
			String: strDO
			String: sTxt
			String: MASKID
			String: sVIDD[*]
			! >> Guarantee
			Boolean: bCHANGED
			Boolean: IsCovered  !!! - Наявність покриття по договору
			Boolean: IsMonthCommis  !!! - Наявність щомісячної комісії по договору
		Message Actions
			On SAM_CreateComplete
				! nFun ( 0 - Полная / 1 - Кред / 2 - Бухг / 3 - Залаговик / 9 - только просмотр )
				! Call DebugN(nFun)
				Call SalWaitCursor( TRUE )
				Set n980 =  GetBaseVal()
				Set bDAT = GetBankDate()
				Set aMfo = GetBankMfo()
				Set nUSER = GetUserId()
				!
				Set sVIDD[09] = 'Гарантії'
				Set sVIDD[19] = 'Акредитиву'
				Set sVIDD[29] = 'Акцепту'
				Set sVIDD[39] = 'Авалю'
				!
				Set bCHANGED = FALSE
				Call SalMapEnterToTab( TRUE )
				If SqlPrepareAndExecute( hSql(),
						"SELECT nlsm INTO :sTmp FROM tts WHERE tt = 'ZAL' " )
						And Not SqlFetchNext(hSql(), nFetchRes)
					Call SalMessageBox('Не описана операция ZAL', 'Ошибка', MB_IconExclamation)
					Call SalDestroyWindow(hWndForm)
					Return FALSE
				Set ND = IifN( nND = 0, NUMBER_Null, nND)
				! << наповнення форми >>
				Call SalHideWindow( pb_LIMIT )
				Call F_START()
				!
				If nTip_Kl =1
					Call SalDisableWindow( rbAVL )
				Else
					Call SalDisableWindow( rbAKC )
				If SalStrLength ( sPar4 ) = 4
					If Subs(sPar4,1,1) = '0'
						Call SalDisableWindow( rbGAR )
					If Subs(sPar4,2,1) = '0'
						Call SalDisableWindow( rbAKR )
					If Subs(sPar4,3,1) = '0'
						Call SalDisableWindow( rbAKC )
					If Subs(sPar4,4,1) = '0'
						Call SalDisableWindow( rbAVL )
				!
				If ( aMfo = '380764' )
					Call SalHideWindow( pb_MOS )
				If ( aMfo = '300205' )
					Call SalHideWindow( pb_LINE )
					! Call SetWindowFullSize( frm_GAR )
				! << END >>
			On SAM_Destroy
				If ( bCHANGED )
					Call SalSendMsg( pbRefreshG, SAM_Click, 0, 0 )
			On UM_CreateDoc
				Call SalModalDialog( dlg_CreateDoc, hWndForm, ND )
	Dialog Box: dlg_GAR_Options
		Class:
		Property Template:
		Class DLL Name:
		Title: Додаткові параметри договору
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.6"
				Width Editable? Yes
				Height: 5.94"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Рахунки пов'язані з договором
				Resource Id: 54288
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    0.02"
					Width:  4.1"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Green
				Background Color: Default
			Child Table: tbY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.25"
						Width:  5.8"
						Width Editable? Yes
						Height: 1.95"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Green
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № рахунка
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								Set sTmpE = NLS
							On SAM_AnyEdit
								Set NLS = sTmpE
					Column: TIP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва рахунку
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.82"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Залишок
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nRowCurr
				Message Actions
			Background Text: Рахунки НЕ пов'язані з договором
				Resource Id: 54289
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.5"
					Top:    0.02"
					Width:  4.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Child Table: tbN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.45"
						Top:    0.25"
						Width:  5.8"
						Width Editable? Yes
						Height: 1.95"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.533"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								Set sTmpE = NLS
							On SAM_AnyEdit
								Set NLS = sTmpE
					Column: TIP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наимен.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ост
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nRowCurr
				Message Actions
			Pushbutton: pb_Add
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.0"
					Top:    0.321"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Arr2tol.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Привязать счет к договору'
					On SAM_Click
						Set tbN.nRowCurr = TBL_MinRow
						While SalTblFindNextRow( tbN, tbN.nRowCurr, ROW_Selected, 0)
							Call SalTblSetContext( tbN, tbN.nRowCurr )
							If SqlPrepareAndExecute( hSql(),
									 " INSERT into nd_acc(nd, acc) values (:nND, :tbN.ACC) ")
								Call SqlCommitEx( hSql(),strTip  || tbN.NLS || " -> " ||Str(nND)  )
								Call F_Tab()
							Else
								Call SqlRollback( hSql() )
			Pushbutton: pb_Min
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.0"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Вилучити рахунок із договору'
					On SAM_Click
						Set tbY.nRowCurr = TBL_MinRow
						While SalTblFindNextRow( tbY, tbY.nRowCurr, ROW_Selected, 0)
							Call SalTblSetContext( tbY, tbY.nRowCurr )
							If tbY.TIP != 'SS ' and
									   tbY.TIP != 'SL ' and
									   tbY.TIP != 'SK0' and
									   tbY.TIP != 'SK9' and
									   tbY.TIP != 'SDI'
								If SqlPrepareAndExecute( hSql(),
										 " delete from nd_acc where nd =:nND and acc = :tbY.ACC ")
									Call SqlCommitEx( hSql(), strTip || tbY.NLS || "<- " ||Str(nND)  )
									Call F_Tab()
							Else
								Call SqlRollback( hSql() )
			Background Text: Детально про ціль
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 54290
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.217"
					Top:    2.298"
					Width:  5.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
			Multiline Field: ml_Aim
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.183"
						Top:    2.488"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.857"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
				Message Actions
					On SAM_SetFocus
						Set sTmpE = ml_Aim
					On SAM_KillFocus
						If sTmpE != ml_Aim
								and SalMessageBox('Сохранить изменения ? ', 'Внимание ! ',MB_IconQuestion | MB_YesNo) = IDYES
							If SqlPLSQLCommand( hSql(),"CCK_APP.SET_ND_TXT( nND, 'AIM', ml_Aim)")
									  and SqlCommitEx( hSql(), 'Реф.ND='|| Str( nND) || ' ' || ml_Aim )
					! On SAM_Validate
						!
			Background Text: Детально про забезпечення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 54291
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.45"
					Top:    2.298"
					Width:  5.617"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Multiline Field: ml_Pawn
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   6.45"
						Top:    2.488"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.857"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
				Message Actions
					On SAM_SetFocus
						Set sTmpE = ml_Pawn
					! On SAM_Validate
					On SAM_KillFocus
						If sTmpE != ml_Pawn
								and SalMessageBox('Сохранить изменения ? ', 'Внимание ! ',MB_IconQuestion | MB_YesNo) = IDYES
							If SqlPLSQLCommand( hSql(),"CCK_APP.SET_ND_TXT( nND, 'PAWN', ml_Pawn)")
									  and SqlCommitEx( hSql(), 'Реф.ND='|| Str( nND) || ' ' || ml_Pawn )
			!
			Group Box: Бенефіціар
				Resource Id: 54292
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    3.45"
					Width:  12.2"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: МФО
				Resource Id: 54293
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    3.65"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: System Text Color
				Background Color: Default
			Data Field: dfMFO_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.3"
						Top:    3.85"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Рахунок
				Resource Id: 54294
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.75"
					Top:    3.65"
					Width:  2.133"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: System Text Color
				Background Color: Default
			Data Field: dfNLS_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.7"
						Top:    3.85"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Назва
				Resource Id: 54295
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.25"
					Top:    3.65"
					Width:  2.467"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: System Text Color
				Background Color: Default
			Data Field: dfNAME_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 38
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.85"
						Width:  6.1"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: ЄДРПОУ
				Resource Id: 54296
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.45"
					Top:    3.65"
					Width:  1.533"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: System Text Color
				Background Color: Default
			Data Field: dfOKPO_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.4"
						Top:    3.85"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pb_Save
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Ok
				Window Location and Size
					Left:   3.0"
					Top:    5.012"
					Width:  3.0"
					Width Editable? Class Default
					Height: 0.4"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Dark Green
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If ( F_FILL_BENEFICIARY() )
							Call SalMessageBox ( CurrentLangTable.GetAtomTitle( 'frm_GarOptions.cTMessChangedBenef' ),
									                                             CurrentLangTable.GetAtomTitle( 'cTMess' ), MB_Ok | MB_IconAsterisk )
							Call SalEndDialog( dlg_GAR_Options, TRUE)
						Else
							! Помилка збереження реквізитів бенефіціара
							Call SalMessageBox ( CurrentLangTable.GetAtomTitle( 'frm_GarOptions.cTErrSaveBenef' ),
									                                             CurrentLangTable.GetAtomTitle( 'cTErr' ), MB_IconStop )
			Pushbutton: pb_Cancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Повернутись
				Window Location and Size
					Left:   6.4"
					Top:    5.012"
					Width:  3.0"
					Width Editable? Class Default
					Height: 0.4"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Red
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( dlg_GAR_Options, FALSE)
			Data Field: dfCreditNUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.8"
						Top:    4.5"
						Width:  3.317"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Номер договору кредитної лінії
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.CreditNUM' ) )
			Data Field: dfCreditDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    4.5"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Дата заключення договору кредитної лінії
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.CreditDAT' ) )
			Pushbutton: pb_CREDIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    4.5"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\FILTER.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.FindCredit' )
					On SAM_Click
						If (nCreditID = NUMBER_Null)
							Call FunNSIGetFiltered( "CC_DEAL", "ND", "CC_DEAL.RNK = " || Str(frm_GAR.RNK) || 
									" And CC_DEAL.VIDD = 2 And CC_DEAL.SOS < 14", sTmp, sTmpE )
						Else
							Set nCreditID = NUMBER_Null
							Set sTmpE = STRING_Null
						Call F_GET_DETAILS( 'CREDIT_LINE', sTmpE )
			Group Box: Кредитна лінія
				Resource Id: 64446
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    4.3"
					Width:  12.2"
					Width Editable? Yes
					Height: 0.62"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
		Functions
			Function: F_DOP
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTag
					String: sTxt
				Actions
					If SqlPrepareAndExecute(hSql(),
							"SELECT tag, SubStr(txt, 1, 250) INTO :sTag, :sTxt FROM ND_TXT
							  WHERE nd = :nND AND tag in ('AIM', 'PAWN')" )
						While SqlFetchNext( hSql(), nFetchRes )
							If sTag='AIM'
								Set ml_Aim = sTxt
							Else If sTag='PAWN'
								Set ml_Pawn = sTxt
			Function: F_Tab
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Call Debug('11')
					Call SalTblPopulate(tbY, hSql(),
							"select a.KV, a.NLS, a.TIP, a.NMS, a.OSTb/100, a.ACC
							 into :tbY.KV,:tbY.NLS,  :tbY.TIP, :tbY.NMS, :tbY.OSTC, :tbY.ACC
							 from accounts a, nd_acc n
							 where a.acc=n.acc AND n.nd = :nND and a.rnk = :nRNK ", TBL_FillAll )
					! Call Debug('12')
					Call SalTblPopulate(tbN, hSql(),
							"select a.KV, a.NLS, a.TIP, a.NMS, a.OSTb/100, a.ACC
							 into :tbN.KV, :tbN.NLS, :tbN.TIP, :tbN.NMS, :tbN.OSTC, :tbN.ACC
							 from accounts a
							 where a.rnk = :nRNK and a.dazs is null
							   and a.nbs in ( '2602', '2622', '3578', '3648' )
							   and a.acc not in (select acc from nd_acc )", TBL_FillAll )
					! Call Debug('13')
			Function: F_FILL_BENEFICIARY
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					! Змінено реквізити бенефіціара
					If SqlPLSQLCommand( hSql(), "GAR.fill_beneficiary_details( nND, dfMFO_B, dfNLS_B, dfNAME_B, dfOKPO_B, nCreditID )" )
							AND SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle( 'frm_GarOptions.cTMessChangedBenef' ) || " #" || Str( nND ) )
						Return TRUE
					Else
						Call SqlRollback( hSql() )
						Return FALSE
			Function: F_GET_DETAILS
				Description:
				Returns
					Boolean:
				Parameters
					String: sType
					String: sID
				Static Variables
				Local variables
				Actions
					If ( sType = 'CREDIT_LINE' )
						! Кредитна лінія
						If ( sID != STRING_Null )
							If SqlPrepareAndExecute( hSql(),
									"SELECT ND, CC_ID, SDATE  
									        INTO :nCreditID, :dfCreditNUM, :dfCreditDAT
									      FROM CC_DEAL
									  WHERE nd = " || sID ) And SqlFetchNext( hSql(), nFetchRes )
								Call SalPicSetFile( dlg_GAR_Options.pb_CREDIT, GetDir() || '\\RESOURCE\\BMP\\Delrec.bmp' )
								Set dlg_GAR_Options.pb_CREDIT.strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.DeleteCredit' )
								Return TRUE
						Else
							Call SalPicSetFile( dlg_GAR_Options.pb_CREDIT, GetDir() || '\\RESOURCE\\BMP\\Filter.bmp' )
							Set dlg_GAR_Options.pb_CREDIT.strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.FindCredit' )
							Set dfCreditNUM = STRING_Null
							Set dfCreditDAT = DATETIME_Null
					Return FALSE
		Window Parameters
			Number: nND
			Number: nRNK
			Number: nVIDD
			Number: nFun  !!! nFun ( 0 - Полная / 1 - Кред / 2 - Бухг / 3 - Залаговик / 9 - только просмотр )
		Window Variables
			String: sTmp
			String: sTmpE
			Number: nCreditID !!! реф. дог. кредитної лінії
		Message Actions
			On SAM_Create
				! Доп.рекв
				Call F_DOP()
				! Рахунки
				Call F_Tab()
				!
				Set sTmp = STRING_Null
				! Реквізити Бенефіціара
				If SqlPrepareAndExecute( hSql(),
						"SELECT mfokred, acckred, namkred, okpokred, refP
						        INTO :dfMFO_B, :dfNLS_B, :dfNAME_B, :dfOKPO_B, :nCreditID
						      FROM cc_add 
						  WHERE nd  = :nND AND adds = 0
						" ) And Not SqlFetchNext(hSql(), nFetchRes)
					Set sTmp = CurrentLangTable.GetAtomTitle( 'frm_GAR.cTMessEmptyBenef' )
				Else
					If ( SalIsNull( dfMFO_B ) AND SalIsNull( dfNLS_B ) AND SalIsNull( dfNAME_B ) AND SalIsNull( dfOKPO_B ) )
						Set sTmp = CurrentLangTable.GetAtomTitle( 'frm_GAR.cTMessEmptyBenef' )
				! Договір кредитної лінії (для АВАЛЮ / непокритого акредитиву / непокритої гарантії )
				If ( ( nVIDD = 39 ) OR ( nVIDD = 19 AND NOT frm_GAR.IsCovered ) OR ( nVIDD = 9 AND NOT frm_GAR.IsCovered ) )
					Call SalEnableWindow ( pb_CREDIT )
					If (nCreditID = NUMBER_Null)
						Set sTmp = IifS( sTmp = STRING_Null, "", sTmp || PutCrLf() ) || CurrentLangTable.GetAtomTitle( 'frm_GAR.cTMessEmptyCredit' )
					!
					Call F_GET_DETAILS( 'CREDIT_LINE', Str( nCreditID ) )
				Else
					! Set dfCreditNUM = STRING_Null
					! Set dfCreditDAT = DATETIME_Null
					Call SalDisableWindow ( pb_CREDIT )
				! Режим "тільки перегляд"
				If ( nFun = 9 )
					Call SalDisableWindow ( tbY )
					Call SalDisableWindow ( tbN )
					Call SalDisableWindow ( ml_Aim )
					Call SalDisableWindow ( ml_Pawn )
					Call SalDisableWindow( dfMFO_B )
					Call SalDisableWindow( dfNLS_B )
					Call SalDisableWindow( dfNAME_B )
					Call SalDisableWindow( dfOKPO_B )
					Call SalHideWindow ( pb_CREDIT )
					Call SalHideWindow( pb_Add )
					Call SalHideWindow( pb_Min )
					Call SalHideWindow( pb_Save )
				Else
					! Для дог. в інвалюті виплата Бенефіціару через транзитний рах.
					If ( frm_GAR.KV != GetBaseVal() )
						Set dfMFO_B = GetBankMfo()
						Set dfOKPO_B = GetBankOkpoS()
						Call SalDisableWindow( dfMFO_B )
						Call SalDisableWindow( dfOKPO_B )
					! Показуємо Mess про незаповненні поля якщо має право їх редагувати
					If ( sTmp != STRING_Null )
						Call SalMessageBox ( sTmp, CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok )
						Set sTmp = STRING_Null
			On SAM_CreateComplete
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'frm_GarOptions.cTWndTitle' ) )
	Dialog Box: dlg_GAR_Payments
		Class:
		Property Template:
		Class DLL Name:
		Title: Виконання фінансових операцій по договору
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.217"
				Width Editable? Yes
				Height: 2.679"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dfRazKomis
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.3"
						Top:    0.25"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Combo Box: cmbRazKomis
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   1.4"
					Top:    0.25"
					Width:  7.5"
					Width Editable? Class Default
					Height: 7.0"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalSendMsg( cmbRazKomis, SAM_User, 0, 0 )
					On SAM_Click
						Set dfRazKomis = cmbRazKomis.GetKey(SalListQuerySelection( cmbRazKomis ) )
						If SqlPrepareAndExecute( hSql(),
								"SELECT bars.GAR.get_single_commission( p.TARIF, :nND, :frm_GAR.LIMIT ), p.NBS_OB22
								        INTO :dfSumRazKomis, :sTmp
								      FROM bars.CC_PROD_KOMIS p
								  WHERE p.prod =  :sProduct
								         AND p.komis = :dfRazKomis
								") And SqlFetchNext( hSql(), nFetchRes )
							Call SalEnableWindow( pb_RazKomis )
					On SAM_User
						Call cmbRazKomis.Init( hWndItem )
						Call cmbRazKomis.Populate( hSql(), "KOMIS", "NAME", "CC_RAZ_KOMIS", 
								"WHERE komis in (select KOMIS from CC_PROD_KOMIS where PROD = '" || sProduct || "') ORDER BY komis ")
						! Call cmbRazKomis.SetSelectById( dfVIDD )
			Data Field: dfSumRazKomis
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 7
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.967"
						Top:    0.25"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: ###000
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума разової комісії' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_RazKomis
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.383"
					Top:    0.23"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! 61 - РАЗОВІ комісії
						If ( dfSumRazKomis > 0 ) 
							Call frm_GAR.P_PAYMENTS( 61, (dfSumRazKomis * 100), sTmp, ("утримання комісії в розмірі " || Str(dfSumRazKomis) ) )
			Group Box: Разові комісії
				Resource Id: 54297
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.02"
					Width:  10.833"
					Width Editable? Yes
					Height: 0.631"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_Save
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Ok
				Window Location and Size
					Left:   2.267"
					Top:    1.786"
					Width:  3.0"
					Width Editable? Class Default
					Height: 0.4"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Dark Green
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( dlg_GAR_Payments, TRUE)
			Pushbutton: pb_Cancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Повернутись
				Window Location and Size
					Left:   5.667"
					Top:    1.786"
					Width:  3.0"
					Width Editable? Class Default
					Height: 0.4"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Red
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( dlg_GAR_Payments, FALSE)
			Pushbutton: pb_GRANT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.65"
					Top:    0.762"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Doc_in.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Green
				Message Actions
					On SAM_Create
						Set strTip = "Предоставить " || frm_GAR.strDO
					On SAM_Click
						If ( dlg_GAR_Payments.F_VALIDATE( 'SUM_GAR' ) )
							! Call F_Prov( 1,strTip )
							Call frm_GAR.P_PAYMENTS( 11, (dfSUM * 100), STRING_Null,  "надання " || frm_GAR.strDO )
			Data Field: dfSUM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.15"
						Top:    0.762"
						Width:  2.15"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipAMOUNT' ) )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_REVOKE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.35"
					Top:    0.762"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Doc_out.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Salmon
				Message Actions
					On SAM_Create
						Set strTip = "Отозвать " || frm_GAR.strDO
					On SAM_Click
						! Call F_Prov( 0, strTip )
						Call frm_GAR.P_PAYMENTS( 10, NUMBER_Null, STRING_Null, "анулювання " || frm_GAR.strDO )
			Pushbutton: pb_PAYOUT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.65"
					Top:    1.179"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DOC_down.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Dark Aqua
				Message Actions
					On SAM_Create
						Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipPayOut' )
					On SAM_Click
						! Виконання зобовязань по договору
						If ( frm_GAR.VIDD = 39 )
							! << Для АВАЛЮ >>
							! Виконання зобов. за рахунок кред. лінії
							Call frm_GAR.P_PAYMENTS( 2, NUMBER_Null, STRING_Null, "виконання зобовязань за рахунок кред. лінії" )
							! Списання зобов. по дог.
							Call frm_GAR.P_PAYMENTS( 9, NUMBER_Null, STRING_Null, "списання  зобовязань" )
							! Перенесення застав з дог. АВАЛЮ на дог. кред. лінії
						Else
							Call frm_GAR.P_PAYMENTS( 71, NUMBER_Null, STRING_Null, "виконання зобовязань" )
			Pushbutton: pb_RETURN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.35"
					Top:    1.179"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DOC_UP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Orchid
				Message Actions
					On SAM_Create
						Set strTip = CurrentLangTable.GetAtomTitle( 'frm_GAR.cBTipReturn' )
					On SAM_Click
						! Повернення покриття ( 72 )
						Call frm_GAR.P_PAYMENTS( 72, NUMBER_Null, STRING_Null, "повернення покриття" )
			Combo Box: cmbPaymentTypes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.3"
					Top:    0.774"
					Width:  7.2"
					Width Editable? Class Default
					Height: 6.964"
					Height Editable? Class Default
				Visible? Class Default
				Editable? No
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: 10
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalSendMsg( cmbRazKomis, SAM_User, 0, 0 )
					On SAM_Click
						Set dfRazKomis = cmbRazKomis.GetKey(SalListQuerySelection( cmbRazKomis ) )
						If SqlPrepareAndExecute( hSql(),
								"SELECT bars.GAR.get_single_commission( p.TARIF, :nND, :frm_GAR.LIMIT ), p.NBS_OB22
								        INTO :dfSumRazKomis, :sTmp
								      FROM bars.CC_PROD_KOMIS p
								  WHERE p.prod =  :sProduct
								         AND p.komis = :dfRazKomis
								") And SqlFetchNext( hSql(), nFetchRes )
							Call SalEnableWindow( pb_RazKomis )
					On SAM_User
						Call cmbRazKomis.Init( hWndItem )
						Call cmbRazKomis.Populate( hSql(), "KOMIS", "NAME", "CC_RAZ_KOMIS", 
								"WHERE komis in (select KOMIS from CC_PROD_KOMIS where PROD = " || sProduct || ") ORDER BY komis ")
						! Call cmbRazKomis.SetSelectById( dfVIDD )
		Functions
			Function: F_VALIDATE
				Description:
				Returns
					Boolean:
				Parameters
					String: sName
				Static Variables
				Local variables
					Number: nTmp
				Actions
					If ( sName = 'SUM_GAR' )
						If ( ( Not SalIsNull(  frm_GAR.CC_ID_GL ) ) OR ( SalIsNull(  frm_GAR.CC_ID_GL ) AND  frm_GAR.aMfo = '380764' ) )
							! Сума гарантії != сумі договору АБО Сума гарантії більша за суму покриття
							If ( ( dfSUM !=  frm_GAR.LIMIT ) OR ( frm_GAR.IsCovered AND dfSUM >  frm_GAR.dfSUM_2602 AND  frm_GAR.VIDD != 39 ) )
								Call SalMessageBox( "Вказано невірну суму!",
										                                             CurrentLangTable.GetAtomTitle('cTErr'),
										                                             MB_Ok | MB_IconStop )
								Set dfSUM = IifN(  frm_GAR.LIMIT >  frm_GAR.dfSUM_2602,  frm_GAR.dfSUM_2602,  frm_GAR.LIMIT )
								Return FALSE
						Return TRUE
		Window Parameters
			Number: nND
			Number: nRNK
			Number: nFun  !!! nFun ( 0 - Полная / 1 - Кред / 2 - Бухг / 3 - Залаговик / 9 - только просмотр )
			String: sProduct
		Window Variables
			! Number: nTmp
			String: sTmp
		Message Actions
			On SAM_CreateComplete
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'frm_GarPayments.cTWndTitle' ) )
			On SAM_Create
				If ( ( frm_GAR.ACC = NUMBER_Null ) OR ( frm_GAR.ACC = 0 ) )
					Call SalDisableWindow( pb_GRANT )
					Call SalDisableWindow( pb_REVOKE )
					If NOT ( ( frm_GAR.VIDD = 19 ) AND (frm_GAR.dfProduct = '999999' ) )
						Call SalDisableWindow( pb_PAYOUT )
						Call SalDisableWindow( pb_RETURN )
				Call SalDisableWindow( cmbPaymentTypes )
	Dialog Box: dlg_CreateDoc
		Class:
		Property Template:
		Class DLL Name:
		Title: Новый документ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.5"
				Width Editable? Yes
				Height: 6.0"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Номер дополнительного соглашения:
				Resource Id: 54298
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.286"
					Top:    0.177"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			List Box: lbAdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenListBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    0.146"
					Width:  1.186"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Yes
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalListPopulate(lbAdd, hSql(),
								"SELECT adds FROM cc_add WHERE nd=:nND")
			Group Box: Выбор шаблона
				Resource Id: 54299
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.08"
					Top:    0.49"
					Width:  8.2"
					Width Editable? Yes
					Height: 4.6"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tblTemplates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.16"
						Top:    0.74"
						Width:  8.0"
						Width Editable? Yes
						Height: 4.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? No
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Идентификатор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Boolean: bSortOrd
				Message Actions
					On SAM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
						Call SalTblPopulate(hWndForm, hSql(),
								"SELECT r.id, s.name
								 INTO :hWndForm.tblTemplates.colId, :hWndForm.tblTemplates.colName
								 FROM cc_deal d, doc_root r, doc_scheme s
								 WHERE d.vidd = r.vidd
								   AND s.id = r.id
								   AND d.nd = :nND
								 ORDER BY s.name", TBL_FillAll)
						If SalTblAnyRows(hWndForm, 0, 0) != TRUE
							Call SalMessageBox('Для договора не указаны шаблоны!', 'Ошибка', MB_IconStop | MB_Ok)
							Call SalEndDialog(dlg_CreateDoc, 0)
						Else
							Call SalTblSetContext(hWndForm, TBL_MinRow)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Создать
				Window Location and Size
					Left:   5.6"
					Top:    5.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! Call SalMessageBox( 'Дополнительное соглашение:'||SalListQueryTextX( lbAdd, 0 )||' Код шаблона:'||dlg_CreateDoc.tblTemplates.colId, 'Результат', MB_IconStop | MB_Ok  )
						! Call cdoc_CreateDocFromTemplate(hSql(),hSqlAux(),tblTemplates.colId,nND,)
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), tblTemplates.colId,  nND,lbAdd.GetCurrentKey())
							If sDoc
								! Показываем документ с редактированием
								If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
									! Сохраняем документ в БД
									If NOT cdoc_SetDocText(hSql(), TRUE,
											  tblTemplates.colId, nND, 0, DATETIME_Null, sDoc)
										Call SqlRollback(hSql())
									Else
										Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:' || SalNumberToStrX(lbAdd.GetCurrentKey(),0) || ' сохранен в БД!' )
									! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
											 VALUES (:tblTemplates.colId,:nND,:sDoc,0)' )
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          If SqlSetLongBindDatatype( 3, 23 )
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          If SqlExecute( hSql() )
												                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!' )
												! Return 1
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
						Call SalEndDialog( dlg_CreateDoc, 0 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.967"
					Top:    5.15"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(dlg_CreateDoc, 0)
		Functions
		Window Parameters
			Number: nND
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCnc2
				Class: cABSConnect
			Long String: sDoc
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Новый документ к договору №' ||
						                      SalNumberToStrX(nND, 0) )
				Call SalCenterWindow(hWndForm)
				Call SalSetFocus(pbCancel)
