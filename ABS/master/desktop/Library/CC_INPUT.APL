Application Description:
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000001A0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFF000000 0000000000C30300 0003020000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773096672
0080: 6D5F4B61727461
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001C71 3A5C626172733938 5C6C696272617279 5C524547434C4E2E
0020: 646C6C1C713A5C62 61727339385C6C69 62726172795C5245 47434C4E2E617063
0040: 00000101011C713A 5C6261727339385C 6C6962726172795C 524547434C4E2E72
0060: 756E1C713A5C6261 727339385C6C6962 726172795C524547 434C4E2E646C6C1C
0080: 713A5C6261727339 385C6C6962726172 795C524547434C4E 2E61706300000101
00A0: 01185C4241525339 385C62696E5C6363 5F696E7075742E61 7064185C42415253
00C0: 39385C62696E5C63 7573746F6D65722E 646C6C185C424152 5339385C62696E5C
00E0: 637573746F6D6572 2E61706300000101 01001C713A5C6261 727339385C6C6962
0100: 726172795C524547 434C4E2E646C6C1C 713A5C6261727339 385C6C6962726172
0120: 795C524547434C4E 2E61706300000101 01
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? No
		Reject Multiple Window Instances? Yes
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Global.apd
		Dynalib: Absapi.apd
		Dynalib: Docview.apd
		Dynalib: Message.apd
		Dynalib: Custacnt.apd
		Dynalib: Nsiapi.apd
		Dynalib: Bars010.apd
		Dynalib: Bars017.apd
		Dynalib: Bars017r.apd
		Dynalib: Cc_doc.apd
		Dynalib: V_balans.apd
		Dynalib: DEPO.apd
		Dynalib: OTCN.apd
		Dynalib: Bars027.apd
		Dynalib: Bars013.apd
		! Dynalib: MSOFFICE.apd
		!
		File Include: Vtfile.apl
		File Include: vttblwin.apl
		File Include: Winbars2.apl
		File Include: Gentbl.apl
		File Include: GENTBLS.APL
		! File Include: GentblS.apl
		File Include: Genlist.apl
		! File Include: Docwis6.apl
		File Include: Winapi.apl
		File Include: Xsalcpt.apl
		File Include: QCKTABS.APL
		File Include: msoffice.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: Arial Cyr
				Font Size: 8
				Font Enhancement: Bold
				Text Color: System Default
				Background Color: System Window Color
			Data Field
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
			Radio Button
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
			Group Box
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Arial Cyr
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Use Parent
				Background Color: System Window Color
			List Box
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Input: 99999999
			Input: 9999999999
			Date/Time: dd.MM.yyyy
			Number: ###000;'($'###000')'
			Number: #000
			Date/Time: dd-MM-yyyy
			Number: 00000'%'
			Number: ###00000
			Number: 00000
			Number: 000
			Date/Time: MM.yyyy
			Number: #00000
			Number: 000#
			Number: ###00000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
				! Low level Tab frame messages.  Processing these messages may change the default behavior of 
						the tab frame.
			User
				! <VERSION>
				String: ApdNum   =  'CCI'
				String: ApdVer   =  '310'
				! ! Версионность
		Resources
		Variables
			Number: nHaveTOBO
			! параметр в ini-файле CC_FL_ACC=1;  :просмотр счетов при открытии дог = РАЗРЕШЕН
			String: CC_FL_ACC 
			String: USER_TOBO 
			String: gOB22
			Date/Time: CCK_MIGR
			!
			String: CC_FSC
			String: sComm
			String: sVal
			String: FIN_2 
			String: ASG_SN
			String: CC_GPK
			Date/Time: D_REZ_
			String: U_REZ_
			Number: N_REZ_
			Boolean: bApdInited
			Window Handle: hKD
			Window Handle: hTN
			Window Handle: hWin0
			Window Handle: hWin297
			Window Handle: hWin1 
			Window Handle: h_DPK 
			Window Handle: h_RST 
			Window Handle: hWinMn
			Window Handle: hWinZ1
			Window Handle: hWin12
			Window Handle: hWin20
			Window Handle: hWin21
			Window Handle: hWin22
			Window Handle: hWin23
			Window Handle: hWin13
			Window Handle: hWin14
			Window Handle: hWin15
			Window Handle: hWin16
			Window Handle: hWin26
			Window Handle: hWin17
			Window Handle: hWin18
			Window Handle: hWin19
			Window Handle: hWin99
			Window Handle: hWin96
			Window Handle: hWin2
			Window Handle: hWinR
			! Window Handle: hWinG
			! Window Handle: hWinGAL
			Window Handle: hWinVR_1
			Window Handle: hWinVR_0 
			Window Handle: hWin_DR
			Window Handle: h_CKL
			Number: nFetchRes
			Boolean: b_MOS
		Internal Functions
			Function: Sel017f                                  ! __exported
				Description:
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nTip_Ur
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
					String: sKV1
					String: sKV2
					String: sKV3
				Static Variables
				Local variables
					Date/Time: dTmp
					Number: nRet
					String: sRet
					String: sTT
				Actions
					!
					Set CCK_MIGR = SalStrToDate(GetGlobalOption('CCK_MIGR'))
					Select Case nMode
						Case 1 !!  Ввод и кор-ка нового договора
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow(DEAL1, hWndMDI, nTip_Ur, nPar, strPar01, strPar02, sKV1, sKV2, sKV3 )
							Else
								Call SalBringWindowToTop ( DEAL1 )
								! Call SalCreateWindow(DEAL1, hWndMDI, nTip_Ur, nPar, strPar01, strPar02, sKV1, sKV2, sKV3 )
							Break
						Case 12 !! Построение ГПК
							If not IsWindow (hWin12)
								Set hWin12 = SalCreateWindow( Tbl_GPK, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( Tbl_GPK )
							Break
						! Case 112 !! Прогноз модификации ГПК
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalCreateWindow( GM, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Break 
						! Case 113 !! Інформаційна виписка
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalCreateWindow( AKD, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Break 
						Case 114 !! Інформаційна виписка + Прогноз модификации ГПК
							Call SalCreateWindow( FSC, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							Break
						Case 115 !! Что видно на ВЄБ-сайте ?
							Call SalCreateWindow( FSW, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							Break
						Case 13 !! Построение ГЛК
							If not IsWindow(hWin13)
								Set hWin13 = SalCreateWindow(Tbl_Lim, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( Tbl_Lim )
							Break
						Case 14 !! Просмотр ГПК (производная от ГЛК) 
							If not IsWindow(hWin14)
								Set hWin14 = SalCreateWindow(Tbl_Kal, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( Tbl_Kal )
							Break
						Case 15 !! * Прогноз суммы погашения зп период
							! If not IsWindow(hWin15)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set hWin15 = SalCreateWindow(Tbl_SumPog, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							! Else
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Call SalBringWindowToTop ( Tbl_SumPog )
							Call SalCreateWindow(Tbl_SumPog, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							Break
						Case 16 !! * Календарь событий по 1 КД
							! If not IsWindow(hWin16)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set hWin16 = SalCreateWindow(Tbl_Sob, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							! Else
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Call SalBringWindowToTop ( Tbl_Sob )
							Call SalCreateWindow( Tbl_Sob, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02,sKV1)
							Break
						Case 17 !! * Календарь событий по всему КП
							! If not IsWindow(hWin17)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set hWin17 = SalCreateWindow(Tbl_Sob_All, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							! Else
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Call SalBringWindowToTop ( Tbl_Sob_All )
							Call SalCreateWindow(Tbl_Sob_All, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							Break
						Case 18 !! График погашения % (производная от ГЛК) 
							If not IsWindow(hWin18)
								Set hWin18 = SalCreateWindow(TN, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
								! Set hWin18 = SalCreateWindow(Tbl_KalP, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( TN )
								! Call SalBringWindowToTop ( Tbl_KalP )
							Break
						Case 19 !! * Анализ ресурса, ставок, сроков
							! If not IsWindow(hWin19)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set hWin19 = SalCreateWindow( Tbl_An, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							! Else
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Call SalBringWindowToTop ( Tbl_An )
							Call SalCreateWindow( Tbl_An, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02 )
							Break
						! Case 20 !! Коррекция параметров КД ДО авторизации
							                                                                                                                                                                                                                                                                                                                                                              If not IsWindow (hWin20)
								                                                                                                                                                                                                                                                                                                                                                              Set hWin20 = SalCreateWindow( KOR1, hWndMDI,nTip_Ur,  nPar, strPar01, strPar02)
							                                                                                                                                                                                                                                                                                                                                                              Else 
								                                                                                                                                                                                                                                                                                                                                                              Call SalBringWindowToTop ( KOR1 )
							                                                                                                                                                                                                                                                                                                                                                              Break 
						Case 121 !! Построение ГПК
							If not IsWindow(h_DPK)
								Set h_DPK = SalCreateWindow(Tbl_DPK, hWndMDI, nMode, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( h_DPK )
							Break
						Case 122 !! Реструктуризация ГПК
							If not IsWindow(h_RST)
								Set h_RST = SalCreateWindow(Tbl_DPK, hWndMDI, nMode, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( h_RST ) 
							Break
						Case 21 !! * Сведения о прологгациях КД
							! If not IsWindow (hWin21)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set hWin21 = SalCreateWindow( Tbl_Prol, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02)
							! Else
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Call SalBringWindowToTop ( Tbl_Prol )
							Call SalCreateWindow( Tbl_Prol, hWndMDI, nTip_Ur,  nPar, strPar01, strPar02 )
							Break
						! Case 22 !! test Построение ГПК 
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    If not IsWindow (hWin22)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set hWin22 = SalCreateWindow( Frm_Mod, hWndMDI, nTip_Ur )
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Else 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalBringWindowToTop ( Frm_Mod )
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Break 
						Case 23 !! * Претенденты (Заявки) на кредит 
							! If not IsWindow (hWin23)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set hWin23 = SalCreateWindow( Tbl_Zay, hWndMDI, nTip_Ur, nPar, strPar01, strPar02)
							! Else
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Call SalBringWindowToTop ( Tbl_Zay )
							Call SalCreateWindow( Tbl_Zay, hWndMDI, nTip_Ur, nPar, strPar01, strPar02)
							Break
						Case 26 !! Расчет Эф.% ставки по 1 КД
							Call Sel017(hWndMDI,nTip_Ur, nMode, nPar, strPar01, strPar02, NUMBER_Null)
							Break
						Case 27 !! * Информация о страховке по выбранному КД
							Call SalCreateWindow( CCI, hWndMDI, nTip_Ur, nPar, strPar01, strPar02)
							Break
						! Case 28 !!  Информация о КД
							! Call SalCreateWindow(frm_KD, hWndMDI, nTip_Fun, 
									ND, nTip_Kl, nGr, sKV1, sKV2, sKV3, SDOG, nTip_Dop)
							! Number: nTip_Ur = nTip_Fun
							! Number: nMode = 28
							! Number: nPar = ND
							! String: strPar01
							! String: strPar02
							! String: sKV1
							! String: sKV2
							! String: sKV3
							                                                                                                                                                                                                                                                                                                                                                 Call SalCreateWindow(frm_KD, hWndMDI, nTip_Ur, 
									nPar, nTip_Kl, nGr, sKV1, sKV2, sKV3, SDOG, nTip_Dop)
							                                                                                                                                                                                                                                                                                                                                                 Break 
			Function: Sel017с                                  ! __exported
				Description:
				Returns
				Parameters
					Number: nTip_Fun
					Number: ND
					Number: nTip_Kl
					Number: nGr
					String: sKV1
					String: sKV2
					String: sKV3
					Number: SDOG
					Number: nTip_Dop	! пока используется только в функции просмотра 
				Static Variables
				Local variables
				Actions
					Call SalCreateWindow(frm_KD, hWndMDI, nTip_Fun, 
							ND, nTip_Kl, nGr, sKV1, sKV2, sKV3, SDOG, nTip_Dop)
			Function: CC_INKRE                           ! __exported
				Description: ввод кредитных договоров
				Returns
				Parameters
					Window Handle: hW
					Number: nTip_Kl
					Number: nMode
					Number: nGr  !! Группа доступа по открываемым счетам
				Static Variables
				Local variables
					String: sKV1
					String: sKV2
					String: sKV3
					!
					String: sPar
					Number: nLength
					Number: nPar2
					String: sPar4
					String: sVID9
				Actions
					!
					Set gOB22 = GetGlobalOption('OB22')
					Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
					Set CCK_MIGR = SalStrToDate(GetGlobalOption('CCK_MIGR'))
					Set CC_GPK = GetGlobalOption('CC_GPK')
					Set CC_FSC = GetGlobalOption('CC_FSC')
					! Уходим от ini-файла в таблицу параметров для пользователей
							 If SqlPrepareAndExecute( hSql(),
							"SELECT substr(pul.Get_Mas_Ini_Val('CC_FL_ACC'),1,1) 
							 INTO :CC_FL_ACC from dual" )
							and not SqlFetchNext( hSql(), nFetchRes )
						                                                                                                                                                                                                                                                                                                                       Set CC_FL_ACC = '0'
					If SqlPrepareAndExecute( hSql(),
							"SELECT val  INTO :CC_FL_ACC from cck_staff_params where user_id=USER_ID and par='CC_FL_ACC' " )
							and not SqlFetchNext( hSql(), nFetchRes )
						Set CC_FL_ACC = GetGlobalOption('CC_FL_ACC')
						If CC_FL_ACC=STRING_Null
							Set CC_FL_ACC = '0'
					! Call Debug(CC_FL_ACC)
					If nMode = 297  ! Договор со страховой компанией
						Set hWin297 =  SalCreateWindow(INSU, hW, nTip_Kl, nMode, nGr )
						Return TRUE
					If nMode = 298 
						Call Sel017 (hW, NUMBER_Null, nMode, NUMBER_Null, STRING_Null,STRING_Null, NUMBER_Null)
						Return TRUE
					If nMode = 700
						Call SalModalDialog(dlg_700, hWndForm, nTip_Kl )
						Return TRUE
					If nMode = 701 ! Вызов разных просрочек по бранчам
						Call SalCreateWindow( SP, hWndMDI, Val(Subs(Str(nTip_Kl),2,1)), Val(Subs(Str(nTip_Kl),1,1)), Str(nGr),'' )
						Return TRUE
					Else If nMode = 970     !  Анализ ресурсов, ставок, сроков
						Set hWin99 = SalCreateWindow( Tbl_An, hWndMDI, Val(Subs(Str(nTip_Kl),2,1)), Val(Subs(Str(nTip_Kl),1,1)), Str(nGr),'' )
						Return TRUE
					Set sPar  = Str(nTip_Kl)
					Set nLength = SalStrLength ( sPar )
					Set nPar2 = Val( Subs(sPar,1,2) ) 
					If nLength = 6
						Set sPar4= Subs( sPar,3,4)
					!
					If SqlPrepareAndExecute( hSql(),
							 "SELECT val into :FIN_2 from params where par='FIN_2' " ) and
							not SqlFetchNext( hSql(),nFetchRes)
						Set FIN_2 = STRING_Null
					If nTip_Kl = NUMBER_Null ! все залоги 
						Call Bars017r ( nTip_Kl, 0 ,0  )
					! !!  КРЕДИТНЫЙ ПОРТФЕЛЬ
					Else If nTip_Kl = 92 or nTip_Kl = 93  OR nTip_Kl = 91 ! 100% КП вход (без транзакций)
						Set hWin0 =  SalCreateWindow(cc_dog, hW, nTip_Kl, nMode, nGr, '', '', '')
					! !!  КРЕДИТНЫЙ ПОРТФЕЛЬ
					Else If nTip_Kl = 82 or nTip_Kl = 83  OR nTip_Kl = 81  ! 100% КП вход (без транзакций c АВТОРИЗАЦИЕЙ)
						Set hWin0 =  SalCreateWindow(cc_dog, hW, nTip_Kl, nMode, nGr, '', '', '' )
					! !!!!!!!!!!!!!!!!!!!!
					! Else If nTip_Kl = 97     ! Анализ ГП% (АЖИО)
						! If not IsWindow(hWin99)
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set hWin99 = SalCreateWindow( Tbl_An2, hWndMDI, nTip_Kl, nMode, nGr )
						! Else
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call SalBringWindowToTop ( Tbl_An2 )
					Else If nTip_Kl = 98     ! Анализ ГПК (АЖИО)
						! If not IsWindow(hWin99)
							                                                                                                                                                                                                                                                                                                                                                                                                                                    Set hWin99 = SalCreateWindow( Tbl_An2, hWndMDI, nTip_Kl, nMode, nGr )
						! Else
							                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalBringWindowToTop ( Tbl_An2 )
					Else If nTip_Kl = 99     ! Анализ КП (ПЕТРОКОМЕРЦ)
						If not IsWindow(hWin99)
							Set hWin99 = SalCreateWindow( Tbl_An1, hWndMDI, nTip_Kl, nMode, nGr )
						Else
							Call SalBringWindowToTop ( Tbl_An1 )
					!
					Else If nTip_Kl >99      ! РАСЧЕТ РЕЗЕРВОВ
						Call Bars017r ( nTip_Kl, nMode ,0  )
					!
					Else ! КРЕДИТНЫЙ ПОРТФЕЛЬ
						Set sKV1='KK1'
						Set sKV2='KK2'
						Set sKV3='KK3'
						Set hWin0 = SalCreateWindow(cc_dog, hW, nTip_Kl, nMode, nGr, sKV1, sKV2, sKV3)
			Function: CC_RAZR                            ! __exported
				Description:
				Returns
				Parameters
					Window Handle: hW
				Static Variables
				Local variables
				Actions
					! If not IsWindow(hWinR)
						                                                                                                                                                                                                                                                                                                                                                                                                                                    Set hWinR =SalCreateWindow(tbl_RAZR, hW)
					! Else
						                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalBringWindowToTop ( tbl_RAZR )
			Function: CC_LIM_NULL
				Description:
				Returns
					Boolean:
				Parameters
					Number: ND_
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand(hSql(), "CCK.CC_LIM_NULL( ND_) " )
						Call SqlCommit( hSql() )
						Return TRUE
					Else
						Call SqlRollback(hSql())
						Call MessageNoWait('Неуспешное наполнение ГЛК 1 зап. ', 'Ошибка', 0, 1)
						Return FALSE
			Function: F_EXPRS ! __exported
				Description:
				Returns
				Parameters
					Number: ND_
				Static Variables
				Local variables
				Actions
					! Call SalModalDialog(dlg_EXPRS, hWndForm, ND_ ) 
					Call SalCreateWindow( Frm_EXPRS, hWndForm, ND_ ) 
					Return TRUE
			Function: F_IBOX ! __exported
				Description:
				Returns
				Parameters
					String: CC_ID_
				Static Variables
				Local variables
				Actions
					Call SalCreateWindow( Frm_IBOX, hWndForm, CC_ID_ ) 
					Return TRUE
			Function: NBS_AIM_All
				Description: Получение Ьал сч от цели
				Returns
					String:
				Parameters
					Number: nVID
					Number: nAi
					Date/Time: DAT4
					Date/Time: DAT1
				Static Variables
				Local variables
					Number: nSrok
					String: sNBS
					String: sSqlAim
				Actions
					! определение БС для SS
					If SqlPrepareAndExecute(hSql(),
							  "SELECT months_between(:DAT4, :DAT1) INTO :nSrok FROM dual ")
							and SqlFetchNext(hSql(), nFetchRes)
					Set sSqlAim = 'SELECT '
					If nSrok      < 12 and nVID < 10 ! короткий ЮЛ
						Set sSqlAim = sSqlAim || 'nbs'
					Else If nSrok > 11 and nVID < 10 ! длиный   ЮЛ
						Set sSqlAim = sSqlAim || 'nbs2'
					Else If nSrok < 12 and nVID > 10 ! короткий ФЛ
						Set sSqlAim = sSqlAim || 'nbsf'
					Else If nSrok > 11 and nVID > 10 ! длиный   ФЛ
						Set sSqlAim = sSqlAim || 'nbsf2'
					Set sSqlAim = sSqlAim || ' INTO :sNBS FROM cc_aim WHERE aim='||Str(nAi)
					If SqlPrepareAndExecute( hSqlAux(), sSqlAim ) 
							and SqlFetchNext( hSqlAux(), nFetchRes) 
							and SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'NBS_AIM', sNBS, 'Бал.рах по цілі кредиту' )" ) 
					Return sNBS
			Function: ShowApdVersion
				Description:
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||'.'||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
			Functional Class: cNdTxtTab
				Description:
				Derived From
				Class Variables
				Instance Variables
					Number: TabNum
					String: Label
					String: Name
					String: DlgName
					Window Handle: hWnd
				Functions
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field: cFieldLabel
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column: cGenColComboBox_NumId
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Form Window: FSC
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Інфо-виписка по КД та Модификация ГПК
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.013"
				Top:    0.01"
				Width:  17.267"
				Width Editable? Class Default
				Height: 8.417"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.762"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23678
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23679
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23680
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.071"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф КД' )
				Data Field: dStr1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.383"
							Top:    0.071"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							! Return XSalTooltipSetText( lParam, 'Продукт' )
				Data Field: dStr2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.071"
							Width:  5.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						! On SAM_TooltipSetText
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Return XSalTooltipSetText( lParam, 'Базовый год для расчета %%' )
				!
				Data Field: dProd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.383"
							Top:    0.405"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Продукт' )
				Data Field: IR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.405"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Номинальная годовая % ставка' )
				Data Field: Basey
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.405"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Базовый год для расчета %%' )
				Data Field: Metr90
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.983"
							Top:    0.405"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Метод расчета ежемесячной комисии' )
				Data Field: IRK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.405"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ставка для расчета комисии' )
				Pushbutton: pb_WEB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						!
						On SAM_Create
							Set strTip = 'Что видно на ВЄБ-сайте ?'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Fun, 115, nPar,
									strTip, strPar01||' '||strPar02,'','','' )
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.833"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: AKD
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  16.683"
						Width Editable? Class Default
						Height: 2.833"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: FDAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								Руху
								
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.067"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					! Счет гашения
					Column: SG_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рахунок
								 2909
								-----------
								SG-Кред
								Надійшло
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.05"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SG ')
					Column: SG_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: для
								ПОГАШ.
								----------
								SG-Дебет
								Списано
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SG ')
					! Норм.долг
					Column: SS_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Норм.
								2202/3
								-------------
								SS-Дебет
								Видано
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.333"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SS ')
					Column: SS_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ТIЛО
								кредиту
								------------
								SS-Кред
								Погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SS ')
					Column: SN_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Проценти
								2208
								----------
								SN-Кред
								Погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.983"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SN ')
					Column: SK0_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Комісія
								3578
								----------
								SK0-Кред
								Погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.033"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SK0')
					! Пеня
					Column: SN8_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пеня
								8008
								----------
								SN8-Кред
								Погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.967"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SK8')
					! Просроч долг + Сомнител долг + Внеb.долг
					Column: SP_D  ! + SL_D 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Проср
								2207+2090
								----------
								SP/SL-Деб
								Нарахов
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.033"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SP ')
					Column: SP_K  ! + SL_K  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ТІЛО
								кредиту
								----------
								SP/SL-Кр
								Погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.017"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SP ')
					Column: SPN_D ! + SLN_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Проср+Сумн
								2209+2096
								-------------
								SPN/SLN-Д
								Нараховано
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.283"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SPN')
					Column: SPN_K ! + SLN_K + S9N_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Проценти
								2209+2096+9603
								---------------
								SPN/SLN/S9N-К
								Погашено
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.483"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SPN')
					Column: SK9_D ! + SLK_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Проср+Сумн
								3579+2480
								-------------
								SK9/SLK-Д
								Нараховано
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SK9')
					Column: SK9_K ! + SLK_K + S9K_K
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Комісія
								3579+2480+9603
								-------------------
								SK9/SLK/S9K-К
								Погашено
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.45"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_VYP('SK9')
				Functions
					Function: F_VYP
						Description:
						Returns
						Parameters
							String: sTip
						Static Variables
						Local variables
							Number: nAcc
							String: sNls
							Number: nKv
							String: sDat   !! MM-dd-yyyy
						Actions
							Set sDat= Subs(FDAT,4,2)||'-'||Subs(FDAT,1,2)||'-'||Subs(FDAT,7,4)
							If SqlPrepareAndExecute( hSql(),
									 "select a.acc,a.nls,a.kv into :nAcc,:sNls, :nKv 
									  from accounts a, nd_acc n
									  where n.nd=:nPar and a.acc=n.acc and a.tip=:sTip" ) 
									and SqlFetchNext( hSql(), nFetchRes) 
								Call ShowTurnForAccountHist (nAcc,sNls,nKv,sDat )
					Function: F_COL_AKD
						Description:
						Returns
							Boolean:
						Parameters
							Number: nCol
						Static Variables
						Local variables
						Actions
							Call SalTblSetCellTextColor(FDAT,nCol,FALSE )
							Call SalTblSetCellTextColor(SG_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SG_D,nCol,FALSE )
							Call SalTblSetCellTextColor(SS_D,nCol,FALSE )
							Call SalTblSetCellTextColor(SS_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SN_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SK0_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SN8_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SP_D,nCol,FALSE )
							Call SalTblSetCellTextColor(SP_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SPN_D,nCol,FALSE )
							Call SalTblSetCellTextColor(SPN_K,nCol,FALSE )
							Call SalTblSetCellTextColor(SK9_D,nCol,FALSE )
							Call SalTblSetCellTextColor(SK9_K,nCol,FALSE )
							Return TRUE
				Window Variables
					String: sSQL
					Number: nRow
					!
					Number: IG_K
					Number: IG_D
					Number: IS_D
					Number: IS_K
					Number: IN_K
					Number: IK0_K
					Number: IN8_K
					Number: IP_D
					Number: IP_K
					Number: IPN_D 
					Number: IPN_K
					Number: IK9_D
					Number: IK9_K
					!
				Message Actions
					On SAM_Create
						Call SalWaitCursor(TRUE)
						Call SalTblSetLockedColumns( hWndForm, 3 )
						Set sSQL = "select to_char(s.Fdat, 'dd/mm/yyyy'), 
								   sum(Decode(a.tip,'SS ',s.DOS,0))/100 SS_D, 
								   sum(Decode(a.tip,'SS ',s.KOS,0))/100 SS_K,    
								   sum(Decode(a.tip,'SN ',s.KOS,0))/100 SN_K, 
								   sum(Decode(a.tip,'SK0',s.KOS,0))/100 SK0_K,    
								   sum(Decode(a.tip,'SN8',s.KOS,0))/100 SN8_K, 
								   sum(Decode(a.tip,'SG ',s.DOS,0))/100 SG_D, 
								   sum(Decode(a.tip,'SG ',s.KOS,0))/100 SG_K, 
								   sum(Decode(a.tip,'SP ',s.DOS,0) 
								      +Decode(a.tip,'SL ',s.DOS,0))/100 SP_D, 
								   sum(Decode(a.tip,'SP ',s.KOS,0) 
								      +Decode(a.tip,'SL ',s.KOS,0))/100 SP_K, 
								   sum(Decode(a.tip,'SPN',s.DOS,0) 
								      +Decode(a.tip,'SLN',s.DOS,0))/100 SPN_D,
								   sum(Decode(a.tip,'SPN',s.KOS,0)
								      +Decode(a.tip,'SLN',s.KOS,0)
								      +Decode(a.tip,'S9N',s.KOS,0))/100 SPN_K, 
								   sum(Decode(a.tip,'SK9',s.DOS,0)
								      +Decode(a.tip,'SLK',s.DOS,0))/100 SK9_D,
								   sum(Decode(a.tip,'SK9',s.KOS,0)
								      +Decode(a.tip,'SLK',s.KOS,0)
								      +Decode(a.tip,'S9K',s.KOS,0))/100 SK9_K 
								 into :AKD.FDAT, :AKD.SS_D, :AKD.SS_K, :AKD.SN_K, :AKD.SK0_K, :AKD.SN8_K,
								      :AKD.SG_D, :AKD.SG_K, :AKD.SP_D, :AKD.SP_K,
								      :AKD.SPN_D,:AKD.SPN_K,:AKD.SK9_D,:AKD.SK9_K
								 from accounts a, nd_acc n, saldoa s 
								 where n.acc=a.acc and n.nd=:nPar and a.acc=s.acc 
								   and (a.tip in ( 'SG ','SS ','SP ','SPN','SK9','SL ','SLN','SLK') 
								    OR  a.tip in ('SN ','SK0','SN8','S9N','S9K') and s.kos>0      )   
								 group by s.fdat  ORDER BY s.fdat "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Set IG_K = 0
						Set IG_D = 0
						Set IS_D = 0
						Set IS_K = 0
						Set IN_K = 0
						Set IK0_K = 0
						Set IN8_K = 0
						Set IP_D = 0
						Set IP_K = 0
						Set IPN_D = 0
						Set IPN_K = 0
						Set IK9_D = 0
						Set IK9_K = 0
						Call SalTblPopulate(hWndForm,hSql(), sSQL, TBL_FillAll)
						!
						Call SalTblDefineSplitWindow (hWndForm, 2, TRUE)
						! Підсумок
						Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
						Call SalTblSetContext(hWndForm, nRow)
						Set FDAT = 'Підсумок'
						Set SG_K  = IG_K  
						Set SG_D  = IG_D  
						Set SS_D  = IS_D  
						Set SS_K  = IS_K  
						Set SN_K  = IN_K 
						Set SK0_K = IK0_K 
						Set SN8_K = IN8_K 
						Set SP_D  = IP_D  
						Set SP_K  = IP_K  
						Set SPN_D = IPN_D 
						Set SPN_K = IPN_K 
						Set SK9_D = IK9_D 
						Set SK9_K = IK9_K 
						Call F_COL_AKD ( COLOR_DarkRed )
						! Сальдо
						Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
						Call SalTblSetContext(hWndForm, nRow)
						Call F_COL_AKD ( COLOR_DarkBlue )
						If SqlPrepareAndExecute( hSql(),
								 "select 'Зал.рах.', 
								   sum(Decode(a.tip,'SS ',-a.ostc,0))/100 SS, 
								   sum(Decode(a.tip,'SN ',-a.ostc,0))/100 SN,  
								   sum(Decode(a.tip,'SK0',-a.ostc,0))/100 SK0,    
								   sum(Decode(a.tip,'SN8',-a.ostc,0))/100 SN8, 
								   sum(Decode(a.tip,'SG ', a.ostc,0))/100 SG, 
								   sum(Decode(a.tip,'SP ',-a.ostc,0)
								      +Decode(a.tip,'SL ',-a.ostc,0))/100 SP, 
								   sum(Decode(a.tip,'SPN',-a.ostc,0)
								      +Decode(a.tip,'SLN',-a.ostc,0)
								      +Decode(a.tip,'S9N',-a.ostc,0))/100 SPN,  
								   sum(Decode(a.tip,'SK9',-a.ostc,0)
								      +Decode(a.tip,'SLK',-a.ostc,0)
								      +Decode(a.tip,'S9K',-a.ostc,0))/100 SK9
								 into :AKD.FDAT, :AKD.SS_K, :AKD.SN_K, :AKD.SK0_K,
								      :AKD.SN8_K,:AKD.SG_K, :AKD.SP_K, :AKD.SPN_K, :AKD.SK9_K
								 from accounts a, nd_acc n
								 where n.acc=a.acc and n.nd=:nPar and a.tip in 
								('SG ','SS ','SP ','SPN','SK9','SL ','SLN','SLK','SN ','SK0','SN8','S9N','S9K') " )
								and SqlFetchNext( hSql(), nFetchRes) 
						Call SalTblSetContext(hWndForm, 0)
						Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
						Call SalWaitCursor(FALSE)
						!
					On SAM_FetchRowDone
						! серый
						Call XSalTblSetCellBackColor( FDAT, nSG )
						Call XSalTblSetCellBackColor( SG_K, nSG )
						Call XSalTblSetCellBackColor( SG_D, nSG )
						! желтій - тело
						Call XSalTblSetCellBackColor( SS_D, nSS )
						Call XSalTblSetCellBackColor( SS_K, nSS )
						! Проценті
						Call XSalTblSetCellBackColor( SN_K, nSN )
						! Комис
						Call XSalTblSetCellBackColor( SK0_K,nSK )
						! розовій Пеня + Разные просрочки
						Call XSalTblSetCellBackColor( SN8_K,nSP )
						Call XSalTblSetCellBackColor( SP_D, nSP )
						Call XSalTblSetCellBackColor( SP_K, nSP )
						Call XSalTblSetCellBackColor( SPN_D,nSP )
						Call XSalTblSetCellBackColor( SPN_K,nSP )
						Call XSalTblSetCellBackColor( SK9_D,nSP )
						Call XSalTblSetCellBackColor( SK9_K,nSP )
						!
						Set IG_K  = IG_K  + SG_K
						Set IG_D  = IG_D  + SG_D
						Set IS_D  = IS_D  + SS_D
						Set IS_K  = IS_K  + SS_K
						Set IN_K  = IN_K  + SN_K
						Set IK0_K = IK0_K + SK0_K
						Set IN8_K = IN8_K + SN8_K
						Set IP_D  = IP_D  + SP_D
						Set IP_K  = IP_K  + SP_K
						Set IPN_D = IPN_D + SPN_D 
						Set IPN_K = IPN_K + SPN_K 
						Set IK9_D = IK9_D + SK9_D
						Set IK9_K = IK9_K + SK9_K
			Child Table: GM
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.905"
						Width:  16.683"
						Width Editable? Class Default
						Height: 1.786"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: FDAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.067"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VXOD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вхідний
								залишок
								Кредиту
								на дату
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.217"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Заг.Сума 
								погашення
								по тілу
								Кредиту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PR_L
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Розрах.
								%%
								
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Розрах.
								комісія
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.9"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Загальна
								План-Сума
								погашення
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.233"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: IXOD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вихідний
								залишок
								Кредиту
								на дату
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              List Values 
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Message Actions 
					Column: VXOD1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вхідний
								залишок
								Кредиту
								на пот.дату
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMG1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сума 
								погашення 
								по Тілу
								Кредиту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.117"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMS1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 
								Просрочене
								Тіло
								кредиту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.033"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PR_L1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Розрах.
								%%
								
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.867"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMK1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Розрах.
								комісія
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.833"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMP1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Просроч.
								%%   +
								Комісія +
								Пеня 
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.933"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SUMO1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пл-Сума
								погашення
								загальна
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.25"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: IXOD1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вихідний
								залишок
								Кредиту
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.317"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: DDAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.067"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F_COL_GM
						Description:
						Returns
							Boolean:
						Parameters
							Number: nCol
						Static Variables
						Local variables
						Actions
							Call SalTblSetCellTextColor(FDAT,nCol,FALSE )
							Call SalTblSetCellTextColor(VXOD,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMG,nCol,FALSE )
							Call SalTblSetCellTextColor(PR_L,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMK,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMO,nCol,FALSE )
							Call SalTblSetCellTextColor(IXOD,nCol,FALSE )
							!
							Call SalTblSetCellTextColor(VXOD1,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMG1,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMS1,nCol,FALSE )
							Call SalTblSetCellTextColor(PR_L1,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMK1,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMP1,nCol,FALSE )
							Call SalTblSetCellTextColor(SUMO1,nCol,FALSE )
							Call SalTblSetCellTextColor(IXOD1,nCol,FALSE )
							Return TRUE
				Window Variables
					Number: I_SUMG
					Number: I_PR_L
					Number: I_SUMK
					Number: I_SUMO
					Number: I_SUMG1
					Number: I_SUMS1
					Number: I_PR_L1
					Number: I_SUMK1
					Number: I_SUMP1
					Number: I_SUMO1
					Number: nRow
					!
					Number: nIR
					String: sBasey
					String: sMetr90
					String: sProd
					Number: nIRK
					!
					String: sSQL
				Message Actions
					On SAM_Create
						Call SalWaitCursor(TRUE)
						Call SalTblSetLockedColumns( hWndForm, 7 )
						!
						If SqlPLSQLCommand(hSql(),
								 "CC_GPKF ( nPar, nIR, sBasey, sMetr90, nIRK, sProd ) " ) 
							! Call Debug('3 '|| sProd )
							Set IR = nIR
							Set IRK= nIRK
							Set Basey = sBasey
							Set Metr90= sMetr90
							Set dProd  = sProd
							! Call Debug('4 '|| dProd )
							! 
									OST - вход.ост тела кредита      по ГПК = cc_lim.lim2 - cc_lim.sumg
									F06 - сумма гашения комиссии     по ГПК = cc_lim.sumk
									F07 - сумма гашения тела кредита по ГПК = cc_lim.sumg
									F08 - сумма гашения др.задолженн по ГПК = cc_lim.sumo - cc_lim.sumg
									F09 - общая сумма гашения        по ГПК = cc_lim.sumo 
									F10 - исх.ост тела кредита       по ГПК = cc_lim.lim2
									--------------
									OSTD - реальные просрочки % и комис + пеня  
									OTMP - реальные просрочки по телу кредита  
									OSTI - расчетный вход.ост тела кредита 
									F11  - расчетная сумма гашения комиссии 
									F12  - расчетная сумма гашения тела кредита 
									F13  - расчетная сумма гашения др.задолженн 
									F14  - расчетная общая сумма гашения    
									F15  - расчетный исх.ост тела кредита 
							!
							Set I_SUMG  = 0
							Set I_PR_L  = 0
							Set I_SUMK  = 0
							Set I_SUMO  = 0
							Set I_SUMG1 = 0
							Set I_PR_L1 = 0
							Set I_SUMK1 = 0
							Set I_SUMO1 = 0
							Set I_SUMP1 = 0
							Set I_SUMS1 = 0
							Set sSQL =
									 "select fdat, ost/100 ,f06/100, f07/100, f08/100, f09/100, f10/100,
									      osti/100,f11/100, f12/100, f13/100, f14/100, f15/100,ostd/100, OTMP/100  
									  INTO :GM.DDAT, :GM.VXOD, :GM.SUMK, :GM.SUMG, :GM.PR_L, :GM.SUMO, :GM.IXOD,
									                 :GM.VXOD1,:GM.SUMK1,:GM.SUMG1,:GM.PR_L1,
									                 :GM.SUMO1,:GM.IXOD1,:GM.SUMP1,:GM.SUMS1 
									  FROM CCK_INT order by fdat " 
							Call SalTblPopulate(hWndForm, hSql(), sSQL , TBL_FillAll) 
							! Итог
							Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
							Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
							Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
							Call SalTblSetContext(hWndForm, nRow)
							Set FDAT = 'Підсумок'
							Set SUMG = I_SUMG
							Set PR_L = I_PR_L
							Set SUMK = I_SUMK
							Set SUMO = I_SUMO
							!
							Set SUMG1 = I_SUMG1
							Set PR_L1 = I_PR_L1
							Set SUMK1 = I_SUMK1
							Set SUMO1 = I_SUMO1
							Set SUMS1 = I_SUMS1
							Set SUMP1 = I_SUMP1
							Call F_COL_GM( COLOR_DarkRed )
							!
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE )
							Call SalTblSetContext(hWndForm, 0)
							Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor(FALSE)
						!
					On SAM_FetchRowDone
						Set FDAT = SalFmtFormatDateTime( DDAT, 'dd/MM/yyyy' )
						If DDAT < GetBankDate()
							Call XSalTblSetRowBackColor( hWndForm, lParam, nSG ) ! серый
						Else
							Call XSalTblSetCellBackColor( SUMG, nSG )
							Call XSalTblSetCellBackColor( SUMO, nSG )
							Call XSalTblSetCellBackColor( PR_L, nSG )
							Call XSalTblSetCellBackColor( VXOD, nSG )
							Call XSalTblSetCellBackColor( IXOD, nSG )
							Call XSalTblSetCellBackColor( SUMK, nSG )
							!
							Call XSalTblSetCellBackColor( SUMG1, nSS )
							Call XSalTblSetCellBackColor( PR_L1, nSN )
							Call XSalTblSetCellBackColor( SUMK1,nSK )
							If SUMP1 != NUMBER_Null and SUMP1 > 0 
								Call XSalTblSetCellBackColor( SUMP1, nSP )
							If SUMS1 != NUMBER_Null and SUMS1 > 0 
								Call XSalTblSetCellBackColor( SUMS1, nSP )
							If SUMO1 > SUMO 
								Call XSalTblSetCellBackColor( SUMO1, nSP )
							!
							Set SUMG1 = SUMG1 - SUMS1
							!
							Set I_SUMG1 = I_SUMG1 + SUMG1
							Set I_PR_L1 = I_PR_L1 + PR_L1
							Set I_SUMK1 = I_SUMK1 + SUMK1
							Set I_SUMO1 = I_SUMO1 + SUMO1
							Set I_SUMS1 = I_SUMS1 + SUMS1
							Set I_SUMP1 = I_SUMP1 + SUMP1
						Set I_SUMG  = I_SUMG  + SUMG
						Set I_PR_L  = I_PR_L  + PR_L
						Set I_SUMK  = I_SUMK  + SUMK
						Set I_SUMO  = I_SUMO  + SUMO
						!
		Functions
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nSS
			Number: nSN
			Number: nSK
			Number: nSP
			Number: nSG
			String: sTitle
		Message Actions
			On SAM_Create
				Set sTitle = 'Інфо-виписка та ГПК'|| strPar01 || ' ' || strPar02 
				Call SalSetWindowText( hWndForm, sTitle )
				Call ShowApdVersion('15')
				Set nSS = SalColorFromRGB( 255,255,220) !! желтій
				Set nSN = SalColorFromRGB( 230,255,230 ) !! Зел
				Set nSK = SalColorFromRGB( 220,255,255 ) !! Голуб
				Set nSP = SalColorFromRGB( 255,210,255) !! Розовый 
				Set nSG = COLOR_LightGray  !! Серый
				!
				Set hWndForm.FSC.strPrintFileName = Str(nPar)||'V'
				Set dND = nPar
				Set dStr1 = strPar01
				Set dStr2 = strPar02
			On UM_Print
				Call SalSendClassMessage(UM_Print, 0, 0)
				! Call SalGetWindowText(tbl, strOldTitle, 100)
				Call TablePrint(GM, sTitle, GetPrnDir() || '\\' || Str(nPar)||'G', '')
	Form Window: FSW
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.363"
				Top:    2.979"
				Width:  7.167"
				Width Editable? Yes
				Height: 3.952"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: sTitle
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  6.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата поточного щомісячного платежу
				Resource Id: 17366
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.929"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: D_cur_date
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    0.905"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Поточний платіж
				Resource Id: 17367
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.179"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: N_cur_payment
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    1.155"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата останнього зарахованого платежу
				Resource Id: 17368
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.429"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: D_last_date
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    1.405"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Сума останнього зарахованого платежу
				Resource Id: 17369
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.679"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: N_last_payment
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    1.655"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Сума попереднього несплаченого боргу
				Resource Id: 17370
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.929"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: N_prev_payments
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    1.905"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Пеня
				Resource Id: 17371
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.179"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Загальна сума до сплати
				Resource Id: 17372
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.429"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Сума для дострокового погашення
				Resource Id: 17373
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.679"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: N_peny
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    2.155"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: N_total
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    2.405"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: N_final_payment
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    2.655"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			! String:  
					 (p_nd            in  number,   -- РЕФ КД
					   p_res_code      out number,   -- Код результата
					   p_res_text      out varchar2, -- Текст результата
					   p_cur_date      out date,     -- Дата текущего ежемесячного платежа
					   p_cur_payment   out number,   -- Текущий ежемесячный платеж
					   p_last_date     out date,     -- Дата последнего зачисленного платежа
					   p_last_payment  out number,   -- Сумма последнего зачисленного платежа
					   p_prev_payments out number,   -- Сумма предыдущих неоплаченных платежей
					   p_peny          out number,   -- Пеня
					   p_total         out number,   -- Итого платёж банку
					   p_final_payment out number    -- Сумма для досрочного платежа
			Number: p_res_code
			String: p_res_text
			!
			Date/Time: p_cur_date
			Number: p_cur_payment
			Date/Time: p_last_date
			Number: p_last_payment
			Number: p_prev_payments
			Number: p_peny
			Number: p_total
			Number: p_final_payment
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, strPar01 )
				Set sTitle =  strPar02 
				If SqlPLSQLCommand(hSql(),
						 "wcs_exchange.ccinteractive_getcreditinfo( nPar, 
						p_res_code, p_res_text, 
						p_cur_date, p_cur_payment, 
						p_last_date,p_last_payment, 
						p_prev_payments, p_peny, p_total, p_final_payment ) " ) 
					Set D_cur_date = p_cur_date
					Set N_cur_payment = p_cur_payment
					Set D_last_date= p_last_date
					Set N_last_payment= p_last_payment
					Set N_prev_payments=p_prev_payments
					Set N_peny = p_peny
					Set N_total = p_total
					Set N_final_payment=p_final_payment
	Table Window: SP
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  12.7"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.5"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48104
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48105
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48106
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_ProsrB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\TOCENTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip =
									'Перенос основного долга на просрочку -
									 по отмеченным бранчам'
						On SAM_Click
							Call Prosr( ROW_Selected )
							Call SalWaitCursor(FALSE)
				Pushbutton: pb_Prosr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip =
									'Перенос основного долга на просрочку -
									 по ВСЕМ бранчам'
						On SAM_Click
							Call Prosr( 0 )
							Call SalWaitCursor(FALSE)
				Frame
					Resource Id: 58145
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.983"
						Top:    0.071"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ЮЛ
					Window Location and Size
						Left:   7.283"
						Top:    0.155"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb11
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ФЛ
					Window Location and Size
						Left:   8.483"
						Top:    0.155"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_Null
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ФЛ
					Window Location and Size
						Left:   8.483"
						Top:    0.155"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код Бранча
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование Бранча
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: V_01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во ЮЛ
						стандартные
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: V_02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во ЮЛ
						кред.линия
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: V_03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во ЮЛ
						М/В линия
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: V_11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во ФЛ
						стандартные
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: V_12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во ФЛ
						кред.линия
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: V_13
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во ФЛ
						М/В линия
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SP_KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Prosr
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipRow
				Static Variables
				Local variables
					Number: nRow
					Number: p_ND
					String: sTxt
					String: sTxtB
					String: sSP_KOL
					Number: nDay
				Actions
					Call SalWaitCursor(TRUE)
					Set nDay = 1
					!
					If rb1 
						Set p_ND = -1
						Set sTxt = 'ЮЛ'
					Else If rb11 
						Set p_ND = -11
						Set sTxt = 'ФЛ'
					Else
						Set p_ND = 0
						Set sTxt = 'ЮЛ + ФЛ'
					!
					Set sTxt = 'Перенос на просрочку '|| sTxt
					If nTipRow = 0
						If SqlPLSQLCommand( hSql(),"PUL.Set_Mas_Ini( 'BRANCH', '', 'BRANCH' ) ")
								and SqlPLSQLCommand(hSql(),"CCK.CC_ASP( p_ND, nDay) " ) 
								and SqlPrepareAndExecute(hSql(),
								"SELECT substr(pul.Get_Mas_Ini_Val('SP_KOL'),1,10)  
								 INTO :sSP_KOL from dual") 
								and SqlFetchNext(hSql(), nFetchRes) 
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( sTxt || ' '||sSP_KOL  ,'Сообщение',2,0)
							Return TRUE
						!
						Call SqlRollbackEx(  hSql(), "Ош."||sTxt )
						Return FALSE
					! !!!!!!
					Set nRow = TBL_MinRow 
					While SalTblFindNextRow( hWndForm, nRow, nTipRow, 0)
						Call SalTblSetContext( hWndForm, nRow)
						Set sTxtB = sTxt || ' ' || BRANCH 
						If SqlPLSQLCommand( hSql(),"PUL.Set_Mas_Ini( 'BRANCH', BRANCH, 'BRANCH' ) ")
								and SqlPLSQLCommand(hSql(), "CCK.CC_ASP( p_ND, nDay) " ) 
								and SqlPrepareAndExecute(hSql(),
								"SELECT substr(pul.Get_Mas_Ini_Val('SP_KOL'),1,10)  
								 INTO :SP_KOL from dual") 
								and SqlFetchNext(hSql(), nFetchRes) 
							Call SqlCommitEx( hSql(), sTxtB )
						Else
							Call SqlRollbackEx(  hSql(), "Ош."||sTxtB )
							Return FALSE
					Return TRUE
		Window Parameters
			Number: nTip_Ur
			Number: nTip_Kl
			String: sGr
			String: strPar02
		Window Variables
			Number: I_01
			Number: I_02
			Number: I_03
			Number: I_11
			Number: I_12
			Number: I_13
			Number: nTmp
			String: sSql
		Message Actions
			On SAM_Create
				Set hWndForm.SP.strPrintFileName = 'SP'
				Set rb_Null = TRUE
				Set rb11 = FALSE
				Set rb1  = FALSE
				! Set hWndForm.SP.strFilterTblName = 'CC_DEAL'
				Call SalTblSetLockedColumns( hWndForm, 2 )
				! Set bDat = GetBankDate()
				Set sSql = 
						"SELECT d.branch, TOBO.name, d.V_01,d.V_02,d.V_03, d.V_11,d.V_12,d.V_13
						 FROM TOBO,
						     (select branch ,
						            sum(decode(vidd, 1,1,0)) V_01, 
						            sum(decode(vidd, 2,1,0)) V_02, 
						            sum(decode(vidd, 3,1,0)) V_03, 
						            sum(decode(vidd,11,1,0)) V_11, 
						            sum(decode(vidd,12,1,0)) V_12, 
						            sum(decode(vidd,13,1,0)) V_13 
						      from cc_deal where sos<14 and sos>=10 and vidd in (1,2,3,11,12,13) 
						      group by branch 
						     ) d 
						 INTO :hWndForm.SP.BRANCH, :hWndForm.SP.NAME,
						      :hWndForm.SP.V_01,   :hWndForm.SP.V_02, :hWndForm.SP.V_03, 
						      :hWndForm.SP.V_11,   :hWndForm.SP.V_12, :hWndForm.SP.V_13 
						 WHERE d.branch=TOBO.tobo order by d.branch "
				Call SalSetWindowText(hWndForm, 'КП банка ' )
				Call ShowApdVersion('17')
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				Set I_01 = I_01 + V_01
				Set I_02 = I_02 + V_02
				Set I_03 = I_03 + V_03
				Set I_11 = I_11 + V_11
				Set I_12 = I_12 + V_12
				Set I_13 = I_13 + V_13
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set I_01 = 0
				Set I_02 = 0
				Set I_03 = 0
				Set I_11 = 0
				Set I_12 = 0
				Set I_13 = 0
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
				! Итог
				Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
				Set nTmp = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nTmp)
				Set V_01 = I_01
				Set V_02 = I_02
				Set V_03 = I_03
				Set V_11 = I_11
				Set V_12 = I_12
				Set V_13 = I_13
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
				Call SalTblSetContext( hWndForm, 0 )
				Call SalTblSetRowFlags( hWndForm, 0, ROW_Selected, TRUE )
				Call SalSendMsg( hWndForm, SAM_RowSetContext, 0,0)
				Call SalWaitCursor(FALSE)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
	Table Window: MANY
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Потоки денежных средств, Стоимость, Амортизация
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    1.031"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.631"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 17612
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 17613
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 17614
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: DAT_ROZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.65"
							Top:    0.095"
							Width:  1.733"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Прогноз-дата' )
						! On SAM_Create
				Frame
					Resource Id: 17615
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.183"
						Top:    0.071"
						Width:  7.1"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все дни (платежные + отчетные)
					Window Location and Size
						Left:   7.483"
						Top:    0.155"
						Width:  3.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Только ПЛАТЕЖНЫЕ дни
					Window Location and Size
						Left:   10.983"
						Top:    0.155"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				!
				! Frame
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  0.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Gray
.end
				! Background Text: - Факт.суммы погашений
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.095"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				! Frame
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.238"
						Width:  0.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Light Green
.end
				! Background Text: - План-суммы погашений
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.262"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
				! Frame
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.405"
						Width:  0.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Light Periwinkle
.end
				! Background Text: - Разница
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    0.429"
						Width:  3.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
		Contents
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.333"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DNEY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Днів
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.75"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поток
						Всего
						1 = 3 + 4 - 5
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поток
						Эталон
						2 = 3 + 4
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поток
						Номинал
						3
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.погаш
						Номинал
						3п
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поток
						Проценты
						4
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.погаш.
						Проценты
						4п
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поток
						Диск/Прем
						5
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стоимость
						Реальная
						6
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стоимость
						Эталонная
						7
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Норма
						Диск/Прем
						8
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Амортизация
						Диск/Прем
						9
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
		Window Parameters
			Number: ND
			Number: ACC8
			String: NMK
			String: CC_ID
		Window Variables
			Number: I1
			Number: I2
			Number: I3
			Number: Ip3
			Number: I4
			Number: Ip4
			Number: I5
			Number: I9
			Number: Q
			Number: nTmp
			Number: NONIMAL
			!
			Number: IRR
			Number: IRE
			Date/Time: DAT1
			Date/Time: DAT2
			Date/Time: DATi
			Date/Time: bDat
			String: CC_MANY
			String: CC_MANY30
		Message Actions
			! План: Потоки денежных средств, Стоимость, Амортизация
			On SAM_Create
				Call SalSetWindowText( hWndForm, "Потоки по КД № "|| CC_ID ||" "||NMK )
				Call ShowApdVersion('06')
				Set MANY.strPrintFileName = 'СC_MANY'
				Call SalTblSetLockedColumns( hWndForm, 9 )
				Set bDat = GetBankDate()
				If SqlPrepareAndExecute( hSql(),
						  "select IR, acrn.FPROCN(:ACC8,-2,:bDat) INTO :IRE, :IRR from cc_deal  where nd=:ND and ir is not null " )
						and SqlFetchNext( hSql(), nFetchRes)
					Call SalTblSetColumnTitle( G6,
							"Стоимость
							 по реал.ЭС
							"||SalNumberToStrX( IRR,6 )
							 )
					Call SalTblSetColumnTitle( G7,
							"Стоимость
							 по этал.ЭС
							"||SalNumberToStrX( IRE,6 )
							 )
					If SqlPrepareAndExecute( hSql(),
							  "select min(fdat), max(fdat) into :DAT1, :DAT2  from CC_MANY where nd =:ND " )
							and SqlFetchNext( hSql(), nFetchRes)
						! Set DAT_ROZ = IifD (bDat >= DAT1 ,bDat, DAT1 ) + 5
				Set rb1 = TRUE
				Set rb2 = FALSE
				! Set rb3 = FALSE
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set I1 =0
				Set I2 =0
				Set I3 =0
				Set Ip3 =0
				Set I4 =0
				Set Ip4 =0
				Set I5 =0
				Set I9 =0
				Set CC_MANY = "SELECT FDAT,(-SS1+SS2) SS1,SN2,SDP,P_SS,P_SN from CC_MANY where ND=:ND and fdat> :DAT1 "
				If DAT_ROZ = DATETIME_Null
					Set DAT_ROZ = bDat
				If SqlPrepareAndExecute( hSql(),  "select 1 from CC_MANY where ND =:ND and fdat=:DAT_ROZ " )
						and NOT SqlFetchNext( hSql(), nFetchRes)
					Set CC_MANY =  CC_MANY || " union all SELECT to_date(:DAT_ROZ), 0,0,0,0,0 from dual "
				If DAT_ROZ != bDat 
						and SqlPrepareAndExecute( hSql(),  "select 1 from CC_MANY where ND = :ND and fdat=:bDat " )
						and NOT SqlFetchNext( hSql(), nFetchRes)
					Set CC_MANY =  CC_MANY || " union all SELECT to_date(:bDat), 0,0,0,0,0 from dual "
				If rb1 
					Set CC_MANY30 =
							"(SELECT last_day(add_MONTHS(:DAT1,num-1 )) FDAT
							 from conductor  where add_MONTHS(:DAT1,num-1 ) < :DAT2  ) q "
					Set CC_MANY =  CC_MANY || " union all
							select FDAT,0,0,0,0,0 from "|| CC_MANY30 ||
							" where fdat not in (to_date(:DAT_ROZ),to_date(:bDat))
							    and fdat not in (select fdat from CC_MANY where ND=:ND) "
				Else
					Set CC_MANY30 =""
				!
				Set Q = NUMBER_Null
				Set MANY.strSqlPopulate =
						"SELECT m.FDAT, m.SS1, nvl(m.P_SS,m.SS1), m.SN2, nvl(m.P_SN, m.SN2), m.SDP, 
						       (select SUM( (-SS1+SS2+SN2) / power( 1 + (:IRR)/100,(FDAT-m.FDAT)/365 ))
						        from CC_MANY where ND= :ND and fdat >= m.FDAT
						         ) SR,
						       (select SUM( (-SS1+SS2+SN2)  / power( 1 + (:IRE)/100,(FDAT-m.FDAT)/365 ))
						        from CC_MANY where ND= :ND and fdat >= m.FDAT
						         ) SE
						 INTO :MANY.FDAT,:MANY.G3,:MANY.P3,:MANY.G4,:MANY.P4,:MANY.G5,:MANY.G6,:MANY.G7 
						 FROM (" || CC_MANY || ") m
						union ALL
						 SELECT m.FDAT,(-m.SS1+m.SS2),0, m.SN2,0, m.SDP,
						       -(-m.SS1+m.SS2+m.SN2+m.SDP) SR,
						       -(-m.SS1+m.SS2+m.SN2      ) SE
						 FROM CC_MANY m where ND = :ND and fdat = :DAT1
						ORDER BY 1"
				Call SalTblPopulate(hWndForm, hSql(), MANY.strSqlPopulate, TBL_FillAll )
				! Итог
				Call SalTblDefineSplitWindow (hWndForm, 3, TRUE)
				Set nTmp = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nTmp)
				Set G1 = I1
				Set G2 = I2
				Set G3 = I3
				Set P3 = Ip3
				Set G4 = I4
				Set P4 = Ip4
				Set G5 = I5
				Set G9 = I9
				Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
				Call SalTblSetContext( hWndForm, 0 )
				Call SalTblSetRowFlags( hWndForm, 0, ROW_Selected, TRUE )
				Call SalSendMsg( hWndForm, SAM_RowSetContext, 0,0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set G1 = G3 + G4 +G5
				Set G2 = G3 + G4
				Set G8 = G7 - G6
				If Q != NUMBER_Null
					Set G9 = Q - G8
					Set DNEY = FDAT - DATi
				Set Q = G8
				Set DATi = FDAT
				Set I1 = I1 + G1
				Set I2 = I2 + G2
				Set I3 = I3 + G3
				Set Ip3 = Ip3 + P3
				Set I4 = I4 + G4
				Set Ip4 = Ip4 + P4
				Set I5 = I5 + G5
				! Set I6 = I6 + G6
				! Set I7 = I7 + G7
				! Set I8 = I8 + G8
				Set I9 = I9 + G9
				If FDAT < bDat !- серый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray  )
				Else If FDAT = bDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 ) )
				Else If FDAT = DAT_ROZ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
				Else If G1 !=0 ! желтій для буд пл дат
					Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 255,255,180) )
				If G3 != P3 ! ! розовый
					Call XSalTblSetCellBackColor( G3, SalColorFromRGB( 255,210,250 ) )
				If G4 != P4 ! ! розовый
					Call XSalTblSetCellBackColor( G4, SalColorFromRGB( 255,210,250 ) )
			On SAM_ColumnSelectClick
	Table Window: cc_dog 
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Кредитные договора
		Icon File:
		Accesories Enabled? Class Default
		Visible? No
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.038"
				Top:    0.354"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.345"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? No
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.571"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SetQueryDFilter(AccF)
								Call SalPostMsg(hWndForm,  UM_Populate, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Ввести изменения в Портфель'
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.783"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				! ========================
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Изъять ошибочную запись из портфеля'
						On SAM_Click
							If hWndForm.cc_dog.SOS < 10 
								If SalMessageBox("Внимание ! Договор реф="||
										Str(hWndForm.cc_dog.ND)||", № ="|| hWndForm.cc_dog.CC_ID ,
										"Техническое удаление ош.записи из портеля ?", 
										 MB_YesNo | MB_IconHand) = IDYES
									If SqlPLSQLCommand(hSql(), "CCK.CC_DELETE( hWndForm.cc_dog.ND )" )
										Call SqlCommitEx( hSql(), 'Удален КД.'|| Str(hWndForm.cc_dog.ND)  )
										Call MessageNoWait( 'Удален КД.'|| Str(hWndForm.cc_dog.ND) ,'Сообщение',3,0)
									Else
										Call SqlRollback( hSqlAux() )
										Call MessageError( "Невозможно удалить КД."||Str(hWndForm.cc_dog.ND) )
				Pushbutton: pbIns ! ОдноОконная
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Ввести новый Договор'
						On SAM_Click
							Set sKV1=STRING_Null
							Set sKV2=STRING_Null
							Set sKV3=STRING_Null
							Call Sel017f(hWndMDI, nTip_Fun, 1,nTip_Kl, Str(nGr) ,sTITL ||' '|| sFunkcional,
									 sKV1, sKV2, sKV3)
				Pushbutton: pbKorr !            ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Коррекция параметров Договора ДО авторизации'
						On SAM_Click
							! If not SalIsNull(hWndForm.cc_dog.ND) and (hWndForm.cc_dog.SOS <=0 or CCK_MIGR>GetBankDate())
							If not SalIsNull(hWndForm.cc_dog.ND) 
								! Вызов процедуры на виз-ную форму kor1
								! Call Sel017f(hWndMDI, nTip_Fun, 20, hWndForm.cc_dog.ND ,
										hWndForm.cc_dog.CC_ID || ' від '|| SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
								!
								! Новый вызов на единую форму отк кред договора
								Call Sel017f(hWndMDI,  nTip_Fun, 1,nTip_Kl, Str(nGr) ,
										sTITL ||' '|| sFunkcional, Str(hWndForm.cc_dog.ND), hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), hWndForm.cc_dog.NMK)
							!
							! Данный вызов исполь-ся при открытии договора
							! Call Sel017f(hWndMDI, nTip_Fun, 1,nTip_Kl, Str(nGr) ,sTITL ||' '|| sFunkcional,
									 sKV1, sKV2, sKV3)
				Pushbutton: pb_Karta !        ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Attach.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Карта ввода выбранного Договора'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								If not IsWindow(hWin_K)
									Set hWin_K = SalCreateWindow( frm_Karta, hWndMDI, nTip_Fun, hWndForm.cc_dog.ND, nGr )
								Else
									Call SalBringWindowToTop ( hWin_K )
				Pushbutton: pbDetails ! МногоОконная
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Параметры выбранного Договора' 
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017с(  nTip_Fun, ND, nTip_Kl, nGr, sKV1, sKV2, sKV3, SDOG, nTip_Dop)
				Pushbutton: pbAcc !     МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Accounts.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Счета и % ставки по выбранному Договору'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017(hWndMDI, nTip_Fun,  0, hWndForm.cc_dog.ND, hWndForm.cc_dog.CC_ID, 
										Str(nGr) ,0 )
				Pushbutton: pb_Modify
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\CURRCONV.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Periwinkle
					Message Actions
						On SAM_Create
							! If nPar > 0
							Set strTip = 'Изменение условий Договора'
						On SAM_Click
							If ND > 0 and SOS>=10 and SOS<14
								! If SalModalDialog(dlg_Modify, hWndForm, ND, strTip ) = 1
									                                                                                                                                                                                                                                                                                                                                                                                                                           Call SalSendMsg( pb_Hel_GPK, SAM_Click, 0, 0 )
								Call Sel027(hWndForm, 10, ND, strTip,"")
				! ================================
				Pushbutton: pb_MOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.283"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							Set strTip = 'Доп.реквизиты по Договору (для СПЕЦ.отчетов)'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								If nTip_Fun =90 
									Call DOP_MOS ( hWndForm.cc_dog.ND, hWndForm.cc_dog.CC_ID, 
											hWndForm.cc_dog.NMK, 'ReadOnly')
								Else
									Call DOP_MOS (hWndForm.cc_dog.ND, hWndForm.cc_dog.CC_ID, hWndForm.cc_dog.NMK, 'All')
				Pushbutton: pbTabAcc ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Табличная форма счетов выбранного Договора'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017(hWndMDI,NUMBER_Null, 17, hWndForm.cc_dog.ND, hWndForm.cc_dog.CC_ID, hWndForm.cc_dog.NMK, NUMBER_Null )
				!
				Pushbutton: pbSob !   МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.733"
						Top:    0.845"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'График событий выбранного Договора'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017f(hWndMDI, nTip_Fun, 16, hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID|| ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,Str(nTip_Kl),'','' )
				!
				Data Field: nKOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.383"
							Top:    0.155"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Black
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество отобранных записей' )
				Data Field: sTITL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.983"
							Top:    0.155"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 8
						Font Enhancement: Default
						Text Color: Black
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Вид Кредитного портфеля' )
				Data Field: sFunkcional
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.083"
							Top:    0.155"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 8
						Font Enhancement: Default
						Text Color: Black
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Функционал пользователя КП 
									'|| GetUserRealName() )
				Data Field: sUrDostup
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.383"
							Top:    0.155"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 8
						Font Enhancement: Default
						Text Color: Black
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Уровень доступа пользователя КП 
									'|| GetUserRealName() )
				!
				Line
					Resource Id: 43622
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 43623
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 43624
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				! Кнопки залоговые
				Pushbutton: pbZalog !     Пока ОдноОконная (в Bars017r.apd)
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.733"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Новые Договора обеспечения 
									к 
									выбранному Договору займа'
						On SAM_Click
							If hWndForm.cc_dog.ACCS >0
								Call Sel017( hWndMDI, nTip_Fun, 2, hWndForm.cc_dog.ND, Str(nGr),
										Str(hWndForm.cc_dog.RNK), hWndForm.cc_dog.ACCS )
							Else
								! Call Debug('Не открыт осн.счет')
								Call SalMessageBox('Не открыт основной счет!', 'Ошибка', MB_IconExclamation)
				Pushbutton: pbZalog_All ! Пока ОдноОконная (в Bars017r.apd)
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.233"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Существующие Договора обеспечения 
									к 
									выбранному Договору займа"
						On SAM_Click
							If hWndForm.cc_dog.ACCS >0
								Call Sel017(hWndMDI,  nTip_Fun, 11, hWndForm.cc_dog.ND, Str(nGr),
										Str(hWndForm.cc_dog.RNK), hWndForm.cc_dog.ACCS ) 
							Else
								! Call Debug('Не открыт осн.счет')
								Call SalMessageBox('Не открыт основной счет!', 'Ошибка', MB_IconExclamation)
				! cTBarButton: pbZ !         Пока ОдноОконная (в Bars017r.apd)
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.733"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Single
					Text Color: Default
					Background Color: Light Gray
.end
					                           Message Actions 
						                           On SAM_Create
							                           Set strTip = 'Связь счетов обеспечения 
									и 
									счетов займа выбранного Договора'
						                           On SAM_Click
							                           Set sTmp = " and KU_109.ACCK in (select acc from nd_acc where nd=" ||
									Str(hWndForm.cc_dog.ND) || " )"
							                           If nTip_Fun =90 !! 'Закрываем в связях залога и обеспечений все возможные кнопки'
								                           Call Bars017r1 ( 107, NUMBER_Null, NUMBER_Null, sTmp )
							                           Else 
								                           Call Bars017r1 ( NUMBER_Null, NUMBER_Null, NUMBER_Null, sTmp )
				Pushbutton: pb_MOS_Ex
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.783"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							Set strTip = 'Сформировать отчет № '|| Str(KODZ) || '. '|| NAM_KATZ
						On SAM_Click
							Call ZAPROS1(hWndMDI, KODZ )
				Pushbutton: pb_T8 ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахунок ІНТЕГРОВАНОГО показника фін/стану позичальника' 
						On SAM_Click
							If FIN_2 = STRING_Null
								Call MessageError( "Не установлено модуль
										"|| strTip )
							Else
								If SqlPrepareAndExecute(hSql(), 
										"SELECT to_number(okpo) INTO :nOkpo from customer where rnk=:hWndForm.cc_dog.RNK " ) and
										 SqlFetchNext(hSql(), nFetchRes) 
									! Call DEPO(hWndMDI, IifN(nTip_Fun=90, -1, 0), nOkpo)
									Call DEPO(hWndMDI, IifN(nTip_Fun=90, IifN(nTip_Dop=2, 0, -1), 0), nOkpo)
				!
				! Доп.рекв Клиента
				Pushbutton: pb_dop !  Пока ОдноОконная (в CustAcnt.apd)
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Доп.сведения о клиенте-заемщике'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.RNK)
								If nTip_Fun =90 
									Call F_Frm_DR( hWndForm.cc_dog.RNK, nTip_Kl, CVIEW_ReadOnly )
								Else
									Call F_Frm_DR( hWndForm.cc_dog.RNK, nTip_Kl, 0 )
				Pushbutton: pb_dop1 ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Включить Доп.реквизит Клиента в таблицу'
						On SAM_Click
							Set DOP_TAG = STRING_Null
							Call FunNSIGetFiltered
									("CUSTOMER_FIELD","NAME","(U is NOT null OR F is NOT null) ORDER BY TAG ",
									 DOP_TAG, DOP_NAME )
				Data Field: DOP_TAG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.983"
							Top:    0.821"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ТЕГ Доп.реквизита Клиента' )
				Data Field: DOP_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.983"
							Top:    0.821"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Название Доп.реквизита Клиента' )
				!
				! Доп.рекв КД
				Pushbutton: pb_dop2 ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Включить Доп.реквизит КД в таблицу'
						On SAM_Click
							Set DOP_TAG2 = STRING_Null
							If FunNSIGetFiltered("CC_TAG","NAME","(tagtype ='CCK') ORDER BY TAG ", DOP_TAG2, DOP_NAM2)
								Call SqlPrepareAndExecute(hSql(), 
										"select table_name, nsisqlwhere, edit_in_form,
										        (select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and showretval=1 and  mt.tabname=t.table_name),
										        (select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and INSTNSSEMANTIC=1 and  mt.tabname=t.table_name)
										   into :sNsiTableName, :sNsiSqlWhere, :nEditInFrom, :sPKName, :sSKName
										   from cc_tag t where tag=:DOP_TAG2")
								Call SqlFetchNext(hSql(), nFetchRes)
				Data Field: DOP_TAG2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.983"
							Top:    1.155"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ТЕГ Доп.реквизита КД' )
				Data Field: DOP_NAM2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.983"
							Top:    1.155"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Название Доп.реквизита КД' )
				!
				Pushbutton: pbPrcAcc ! Все СЧета Клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Открытые счета клиента'
							If CC_FL_ACC = '1'
								Call SalEnableWindow( pbPrcAcc )
							Else
								Call SalDisableWindow( pbPrcAcc )
						On SAM_Click
							! Call ShowCustAccountsEx(RNK)
							! If SOS<15
							Set sTmp=  " not exists  (select  1 from accountsw  where acc=a.acc and tag='CCNLS_NO' ) and a.rnk="||Str(RNK)
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp)
				!
				! Data Field: sOTL
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   13.283"
							Top:    0.821"
							Width:  3.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Message Actions 
				! кнопки ОБЩИЕ
				Pushbutton: pbMod ! ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Query.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = " Моделирование произвольного ГПК "
						On SAM_Click
							! Call Sel017f(hWndMDI, nTip_Fun, 22, 0 ,"" , "",'','','' )
							Call Sel017f(hWndMDI, nTip_Fun, 12, 0 ,
									"ТЕСТОВЫЙ договор", "ТЕСТОВЫЙ клиент",'','','' )
				Option Button: op_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.155"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Показать Открытые/Закрытые договора Портфеля' )
						On SAM_Click
							If op_Clos
								Set sFilter0 = " >= 15 "
								Call SalDisableWindow( pbIns ) 
								Call SalDisableWindow( pbDel ) 
								Call SalDisableWindow( pbUpdate ) 
								Call SalDisableWindow( pb_Proc ) 
								Call SalDisableWindow( pbAcc )  
								! Call SalDisableWindow( pbZay )  
								Call SalDisableWindow( pbMod )  
								Call SalDisableWindow( pb_Lim8 )  
								Call SalDisableWindow( pbMdate )  
								Call SalDisableWindow( pb_F7 )  
								Call SalDisableWindow( pbSV12 )  
								Call SalDisableWindow( pbDel )  
								Call SalDisableWindow( pb_T8 )  
								Call SalDisableWindow( pbKorr)  
								! Call SalDisableWindow( pb_Karta)  
								Call SalDisableWindow( pb_KAL)  
								Call SalDisableWindow( pbHelpP)  
								Call SalDisableWindow( pb_SumPog)  
								Call SalDisableWindow( pb_Analiz)  
								Call SalDisableWindow( pb_SG)  
								Call SalDisableWindow( pb_Lim9)  
								Call SalDisableWindow( pb_IRR)  
								! Call SalDisableWindow( pb_PBS)  
								Call SalDisableWindow( pbZalog)  
								Call SalDisableWindow( pb_Insu_Prob)  
								Call SalDisableWindow( op_Link)  
								Call SalShowWindow( DAZS )
							Else
								! Set sFilter0 = " < 15 "
								Set sFilter0 = " < 14 "
								Call SalEnableWindow( pbIns ) 
								Call SalEnableWindow( pbDel ) 
								Call SalEnableWindow( pbUpdate ) 
								Call SalEnableWindow( pb_Proc )
								Call SalEnableWindow( pbAcc )
								! Call SalEnableWindow( pbZay )
								Call SalEnableWindow( pbMod )
								Call SalEnableWindow( pb_Lim8 )  
								Call SalEnableWindow( pbMdate )  
								Call SalEnableWindow( pb_F7 )  
								Call SalEnableWindow( pbSV12 )  
								Call SalEnableWindow( pbDel )  
								Call SalEnableWindow( pb_T8 )  
								Call SalEnableWindow( pbKorr)  
								Call SalEnableWindow( pb_Karta)  
								Call SalEnableWindow( pb_KAL)  
								Call SalEnableWindow( pbHelpP)  
								Call SalEnableWindow( pb_SumPog)  
								Call SalEnableWindow( pb_Analiz)  
								Call SalEnableWindow( pb_SG)  
								Call SalEnableWindow( pb_Lim9)  
								Call SalEnableWindow( pb_IRR)  
								! Call SalEnableWindow( pb_PBS)  
								Call SalEnableWindow( pbZalog)  
								Call SalEnableWindow( pb_Insu_Prob)  
								Call SalEnableWindow( op_Link)  
								Call SalHideWindow( DAZS )
								! Call SalEnableWindow( hWndForm )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Option Button: op_Link
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.155"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать "слитые" договора КП' )
						On SAM_Click
							If op_Link
								Set sFilter0 = " = 14 "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pbDel )
								Call SalDisableWindow( pbUpdate )
								Call SalDisableWindow( pb_Proc )
								Call SalDisableWindow( pbAcc )
								! Call SalDisableWindow( pbZay )  
								Call SalDisableWindow( pbMod )  
								Call SalDisableWindow( pb_Lim8 )  
								Call SalDisableWindow( pbMdate )  
								Call SalDisableWindow( pb_F7 )  
								Call SalDisableWindow( pbSV12 )  
								Call SalDisableWindow( pbDel )  
								Call SalDisableWindow( pb_T8 )  
								Call SalDisableWindow( pbKorr)  
								Call SalDisableWindow( pb_Karta)  
								Call SalDisableWindow( pb_KAL)  
								Call SalDisableWindow( pbHelpP)  
								Call SalDisableWindow( pb_SumPog)  
								Call SalDisableWindow( pb_Analiz)  
								Call SalDisableWindow( pb_SG)  
								Call SalDisableWindow( pb_Lim9)  
								Call SalDisableWindow( pb_IRR)  
								! Call SalDisableWindow( pb_PBS)  
								Call SalDisableWindow( pbZalog)  
								Call SalDisableWindow( pb_Insu_Prob)  
								Call SalDisableWindow( op_Clos)  
								Call SalShowWindow( DAZS )
							Else
								! Set sFilter0 = " < 15 "
								Set sFilter0 = " < 14 "
								Call SalEnableWindow( pbIns )
								Call SalEnableWindow( pbDel )
								Call SalEnableWindow( pbUpdate )
								Call SalEnableWindow( pb_Proc )
								Call SalEnableWindow( pbAcc )
								! Call SalEnableWindow( pbZay )
								Call SalEnableWindow( pbMod )
								Call SalEnableWindow( pb_Lim8 )  
								Call SalEnableWindow( pbMdate )  
								Call SalEnableWindow( pb_F7 )  
								Call SalEnableWindow( pbSV12 )  
								Call SalEnableWindow( pbDel )  
								Call SalEnableWindow( pb_T8 )  
								Call SalEnableWindow( pbKorr)  
								Call SalEnableWindow( pb_Karta)  
								Call SalEnableWindow( pb_KAL)  
								Call SalEnableWindow( pbHelpP)  
								Call SalEnableWindow( pb_SumPog)  
								Call SalEnableWindow( pb_Analiz)  
								Call SalEnableWindow( pb_SG)  
								Call SalEnableWindow( pb_Lim9)  
								Call SalEnableWindow( pb_IRR)  
								! Call SalEnableWindow( pb_PBS)  
								Call SalEnableWindow( pbZalog)  
								Call SalEnableWindow( pb_Insu_Prob)  
								Call SalEnableWindow( op_Clos)  
								Call SalHideWindow( DAZS )
								Call SalEnableWindow( hWndForm )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pb_Lim8
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F8
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Bf8_.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Установить остатки на счете консолидации по всему КП'
						On SAM_Click
							Call F_LIM8()
							!
				Pushbutton: pb_Analiz  ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.383"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_fins.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Анализ ресурса, ставок, сроков '
						On SAM_Click
							Call Sel017f(hWndMDI, nMode, 19, nTip_Kl, Str(nGr), sTITL ||' '|| sFunkcional,
									'','','' )
				Pushbutton: pb_SumPog !      МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.933"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Summ.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Прогноз суммы погашения КП за период '
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Fun, 15, nTip_Kl ,'',  sTITL ||' '|| sFunkcional,
									'','','' )
				Pushbutton: pb_Sob_All ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.233"
						Top:    0.845"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Childs.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'График событий по Портфелю'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Par, 17, nMode ,'',  sTITL ||' '|| sFunkcional,
									'','','' )
				! По одному договору
				Pushbutton: pb_F7 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F7
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Bf7_.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Установить другую базовую валюту в выбранном КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND) 
								If hWndForm.cc_dog.VIDD = 3 or hWndForm.cc_dog.VIDD = 13
									Call SalModalDialog (dlg_SV12, hWndForm, 1, 
											hWndForm.cc_dog.ND, hWndForm.cc_dog.RNK, hWndForm.cc_dog.NMK, 
											hWndForm.cc_dog.CC_ID, hWndForm.cc_dog.DAT1, hWndForm.cc_dog.KV )
								Else
									Call MessageError( "Режим 
											"||strTip||"
											применяется только для МультиВал КД !" )
				Pushbutton: pbSV12
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Relation.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Объединить выбранный КД с другим КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND) 
								Call SalModalDialog (dlg_SV12, hWndForm, 0, 
										hWndForm.cc_dog.ND, hWndForm.cc_dog.RNK, hWndForm.cc_dog.NMK, 
										hWndForm.cc_dog.CC_ID, hWndForm.cc_dog.DAT1, hWndForm.cc_dog.KV )
				Pushbutton: pbMdate		
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\RETRIEVE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							! Установка даты пролонгации
							Set strTip = 'Установить дату окончания договора (пролонгация)'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND) 
								Set dTmp = DAT4
								If SalModalDialog(dlg_SetDat,hWndForm,ND,dTmp,dTmpD)
									If SqlPrepareAndExecute( hSql(), 
											"select NVL(kprolog,0) + 1,sos into :kprolog, :sos  from cc_deal where nd=:ND ")
											 and SqlFetchNext(hSql(),nFetchRes)
										If SqlPrepareAndExecute( hSql(),"Insert into CC_PROL (ND, FDAT, NPP, MDATE, TXT,  ACC, DMDAT) 
												 Values (:ND, bankdate, :kprolog, :dTmp, NULL, NULL, :dTmpD)")
											If GetBankDate() = dTmpD
												If not SqlPLSQLCommand(hSql(), "CC_PROLONG (hWndForm.cc_dog.ND, hWndForm.cc_dog.dTmpD  ) " )
													Call SqlRollbackEx( hSql(), "Неуспешное выполнение пролонгации текущей датой по "|| Str(hWndForm.cc_dog.ND))
													Call MessageNoWait('Неуспешное выполнение пролонгации текущей датой ', 'Ошибка', 0, 1)
												Else
													Call SqlCommitEx(hSql(), "Успешное выполнение пролонгации текущей датой по "|| Str(hWndForm.cc_dog.ND))
													Call SalMessageBox("Пролонгация выполнена успешно!", 'В н и м а н и е !', 0)
											Else
												Call SqlCommitEx(hSql(),'Успешно сохранена новая дата пролонгации по дог.'|| Str(hWndForm.cc_dog.ND))
												Call SalMessageBox('Успешно сохранена новая дата пролонгации', 'В н и м а н и е !', 0)
										Else
											Call SqlRollbackEx(hSql(),'')
											Call SalMessageBox('Неуспешное сохранение даты пролонгации', 'О ш и б к а !', 0)
							! Set nRow = TBL_MinRow
							! Set i = 0
							! If SalTblAnyRows(hWndForm, ROW_Selected, 0)
								                                                                                                                                                                                                                                                             While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									                                                                                                                                                                                                                                                             Call SalTblSetContext(hWndForm, nRow)
									                                                                                                                                                                                                                                                             Set i = i + 1
								                                                                                                                                                                                                                                                             If i = 1
									                                                                                                                                                                                                                                                             Set dTmp = DAT4
									                                                                                                                                                                                                                                                             If SalModalDialog(dlg_SetDat,hWndForm,ND,dTmp,dTmpD)
										! Set sTmp = SalFmtFormatDateTime(DAT4, 'dd/MM/yyyy')
										                                                                                                                                                                                                                                                             If SqlPrepareAndExecute( hSql(), 'select NVL(kprolog,0) + 1,sos into :kprolog, :sos  from cc_deal where nd=:ND') and SqlFetchNext(hSql(),nFetchRes)
											                                                                                                                                                                                                                                                             If SqlPrepareAndExecute( hSql(),"Insert into CC_PROL (ND, FDAT, NPP, MDATE, TXT,  ACC, DMDAT)  Values
													   (:ND, bankdate, :kprolog, :dTmp, NULL, NULL, :dTmpD)")
												                                                                                                                                                                                                                                                             If GetBankDate() = dTmpD
													                                                                                                                                                                                                                                                             If not SqlPLSQLCommand(hSql(), "CC_PROLONG (hWndForm.cc_dog.ND, hWndForm.cc_dog.dTmpD  ) " )
														                                                                                                                                                                                                                                                             Call SqlRollbackEx( hSql(), "Неуспешное выполнение пролонгации текущей датой по "|| Str(hWndForm.cc_dog.ND))
														                                                                                                                                                                                                                                                             Call MessageNoWait('Неуспешное выполнение пролонгации текущей датой ', 'Ошибка', 0, 1)
													                                                                                                                                                                                                                                                             Else 
														                                                                                                                                                                                                                                                             Call SqlCommitEx(hSql(), "Успешное выполнение пролонгации текущей датой по "|| Str(hWndForm.cc_dog.ND))
														                                                                                                                                                                                                                                                             Call SalMessageBox("Пролонгация выполнена успешно!", 'В н и м а н и е !', 0)
												                                                                                                                                                                                                                                                             Else 
													                                                                                                                                                                                                                                                             Call SqlCommitEx(hSql(),'Успешно сохранена новая дата пролонгации по дог.'|| Str(hWndForm.cc_dog.ND))
													                                                                                                                                                                                                                                                             Call SalMessageBox('Успешно сохранена новая дата пролонгации', 'В н и м а н и е !', 0)
											                                                                                                                                                                                                                                                             Else 
												                                                                                                                                                                                                                                                             Call SqlRollbackEx(hSql(),'')
												                                                                                                                                                                                                                                                             Call SalMessageBox('Неуспешное сохранение даты пролонгации', 'О ш и б к а !', 0)
								                                                                                                                                                                                                                                                             Else 
									                                                                                                                                                                                                                                                             Call SalMessageBox('Выбрано больше одного договора', 'В н и м а н и е !', 0)
							! Else
								                                                                                                                                                                                                                                                             Call SalMessageBox('Не выбран договор', 'В н и м а н и е !', 0)
				Pushbutton: pb_INSU !     МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.783"
						Top:    0.821"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FRCENTER.BMP
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Информация о СД по выбранному КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.RNK)
								Call Sel017f(hWndMDI,  nTip_Fun , 27, hWndForm.cc_dog.RNK,
										'', hWndForm.cc_dog.NMK,'','','' )
				Pushbutton: pb_Lim !    ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Построение Графика Лимита Кредитования (ГЛК) выбранного КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017f( hWndMDI, nTip_Fun , 13, hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
				Pushbutton: pb_KAL ! ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр Ожидаемого Графика Погашения Кредита (ГПК) выбранного КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017f(hWndMDI, nTip_Fun, 14, hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
				! Стардарный КД = ГПК
				Pushbutton: pbGPK !     ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.488"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F12
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Построение Графика Погашения Кредита (ГПК) выбранного КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017f(hWndMDI, nTip_Fun, 12, hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
				! Иначе КЛ График траншей
				Pushbutton: pb_CKL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.476"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\CHILDS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip ='Графiк погашення Траншів для Кредитних Лiнiй '
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								If IsWindow( h_CKL )
									Call SalDestroyWindow( h_CKL )
								Set h_CKL = SalCreateWindow( CKL, hWndMDI,
										 nTip_Fun, 
										hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd.MM.yyyy' )||' ' || 
										hWndForm.cc_dog.NMK, Str(hWndForm.cc_dog.VIDD) )
				!
				Pushbutton: pbHelpP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Light Periwinkle
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Ожидаемый ГЛК + ГПК + ГП% выбранного КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017f(hWndMDI,  nTip_Fun, 18, hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
				Pushbutton: pb_ProL ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.733"
						Top:    0.845"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Сведения об изменениях КД '
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call Sel017f(hWndMDI,  nTip_Fun, 21, hWndForm.cc_dog.ND,
										strTip||' '||hWndForm.cc_dog.CC_ID || ' от '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
				Pushbutton: pbHelp ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Справка о состоянии выбранного КД'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								Call SalCreateWindow(frm_Help, hWndMDI, 
										hWndForm.cc_dog.ND, hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ),
										hWndForm.cc_dog.NMK, hWndForm.cc_dog.OST, 
										hWndForm.cc_dog.KV, hWndForm.cc_dog.DAT3, hWndForm.cc_dog.DAT4 )
				! Для бухгалтера
				Pushbutton: pb_Lim9 ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.233"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Bf9_.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Актуализация лимитов по требованию c 9129 всего портфеля'
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Set nRow = TBL_MinRow
							Set j = 0
							While SalTblFindNextRow( hWndForm, nRow, 0, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If not SqlPLSQLCommand(hSql(), "CCK.CC_DAY_LIM ( bDat, hWndForm.cc_dog.ND ) " )
										or not SqlPLSQLCommand(hSql(), "CCK.CC_9129 ( bDat,hWndForm.cc_dog.ND, nTip_Kl ) " )
									Call SqlRollbackEx( hSql(), "Неуспешное выполнение "||strTip||" по "|| Str(hWndForm.cc_dog.ND))
									Call MessageNoWait('Неуспешно '|| strTip, 'Ошибка', 0, 1)
									Set j = j+1
								Else
									Call SqlCommit(hSql())
							If j = 0
								Call SalWaitCursor(FALSE)
								Call MessageNoWait('Успешно выполнено '|| strTip, 'Сообщение', 0, 1)
							Else
								Call SalWaitCursor(FALSE)
								Call MessageNoWait('Неуспешное выполнение '|| strTip|| '! Имеется '|| Str(j) ||' ошибок. Проверьте протокол!' , 'Ошибка', 0, 1)
				Pushbutton: pb_SG !   МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.783"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							If CC_FSC ='1'
								Set sTit_CC_ASG = "Авто-разбор счетов гашения SG(в т.ч.пеня)"  
							Else
								Set sTit_CC_ASG = "Разбор поступлений на счета SG по уровню доступа:
										" || sUrDostup 
							Set strTip = sTit_CC_ASG 
						On SAM_Click
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand( hSql(), sSql_CC_ASG  )
								Call SqlCommit( hSql())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait('Разобраны кредитовые остатки на счетах SG','Сообщение',3,0)
							Else
								Call SqlRollback(hSql())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait('Неуспешный Разбор', 'Ошибка', 0, 1)
				Check Box: cb_SG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сч.SG
					Window Location and Size
						Left:   12.283"
						Top:    0.155"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Message Actions
				Check Box: cb_SN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сч.SN
					Window Location and Size
						Left:   14.783"
						Top:    0.488"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pb_Proc ! Пока ОдноОконная (в Bars010.apd)
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Начислить %%(комиссию) по счетам Портфеля'
						On SAM_Click
							Set sFilter_Pr = 
									" AND i.id not in (1,3) and s.TIP <>'LIM' and 
									 s.acc in (select n.acc from nd_acc n, cc_v" ||
									IifS ( nGr =9 ,"9", "") ||" v WHERE n.nd=v.nd " || 
									sFilter || ")"
							! Для НБУ вызываем ведомость с параметром "Счета" (наименование счета), для остальных - "Клиенты"
							! Call Sel010(hWndMDI, 0, IifN( nTip_Fun=20 or nTip_Fun=0, 0, 1 ), sFilter_Pr, "A" ) ! непонятно, что этим хотели сказать, если нужно по accounts - нужно чтоб второй символ был А, 
									иначе в любом случае, если длина 1, может принимать значение только K(клиенты) S (счета) P(для Инны)
							If CCK_NBU
								Call Sel010(hWndMDI, 0, IifN( nTip_Fun=20 or nTip_Fun=0, 0, 1 ), sFilter_Pr, "S" )
							Else
								Call Sel010(hWndMDI, 0, IifN( nTip_Fun=20 or nTip_Fun=0, 0, 1 ), sFilter_Pr, " " )
				! Irr и бал стоимость
				Pushbutton: pb_IRR ! МногоОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = "Формування визнаних доходів (ЕПС) по " || sTITL
						On SAM_Click
							Call BAB_ALL (nTip_Kl) 
				Check Box: cb_FSC
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: С доп.кол.
					Window Location and Size
						Left:   14.783"
						Top:    0.821"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							! If cb_IRR
								                               Call SalShowWindow( IRR ) 
								                               Call SalShowWindow( PBS ) 
								                               Call SalShowWindow( FBS ) 
								                               Call SalShowWindow( PBS_FBS ) 
								                               Call SalEnableWindow( pb_IRR )
								                               Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							! Else
								                               Call SalHideWindow( IRR ) 
								                               Call SalHideWindow( PBS ) 
								                               Call SalHideWindow( FBS ) 
								                               Call SalHideWindow( PBS_FBS ) 
								                               Call SalDisableWindow( pb_IRR )
				Pushbutton: pb_Insu_Prob
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.283"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\HELP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 'Информация о ПРОБЛЕМНЫХ СД '
						On SAM_Click
							If SqlPrepareAndExecute( hSql(),"DELETE from TMP_IRR " )
								Set nRow = TBL_MinRow
								While SalTblFindNextRow( hWndForm, nRow, 0, 0)
									Call SalTblSetContext(hWndForm, nRow)
									If SqlPrepareAndExecute( hSql(),"insert into TMP_IRR (n) values (:hWndForm.cc_dog.ND)" )
								Call Sel017f(hWndMDI, NUMBER_Null, 27, 0,' and CC_V.nd in (select n from TMP_IRR)' ,strTip,'','','' )
								Return TRUE
				! ЦФР
				Pushbutton: pb_Hel_GPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\HELP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Інфо-виписка та Прогноз ГПК по КД '
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Fun, 114, hWndForm.cc_dog.ND,
									hWndForm.cc_dog.CC_ID || ' від '|| 
									SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
									hWndForm.cc_dog.NMK,'','','' )
				Pushbutton: pb_WEB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Что видно на ВЄБ-сайте ?'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Fun, 115, hWndForm.cc_dog.ND,
									strTip, 
									hWndForm.cc_dog.CC_ID || ' від '|| 
									SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' )||
									' '||hWndForm.cc_dog.NMK,'','','' )
				Pushbutton: pb_EXPRS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.821"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\help2.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Експрес-довідка по КД '
						On SAM_Click
							Call F_EXPRS(hWndForm.cc_dog.ND)
				Pushbutton: pb_IBOX
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.983"
						Top:    0.821"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\CUSTCLSD.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'IBOX-довідка по КД '
						On SAM_Click
							Call F_IBOX(hWndForm.cc_dog.CC_ID)
				Pushbutton: pb_SGR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.483"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Индивидуальный Ручной разбор кредитовых остатков'
						On SAM_Click
							If ND > 0 and SOS>=10 and SOS<14
								Call Sel027(hWndForm, 7, ND, Str(cc_dog.RNK),
										cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( cc_dog.DAT1, 'dd/MM/yyyy' )||
										' '|| cc_dog.NMK)
				Pushbutton: pb_Loans
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Dark Gray
					Message Actions
						On SAM_Create
							If GetBankMfo() != '380764'
								Call SalHideWindow( pb_Loans ) 
							Set strTip = 'Історія погашення КД в ЛОАНС'
						On SAM_Click
							Call FunNSIEditFFiltered ('V_LOANS_PR',1,'ND='||Str(ND))
				Frame
					Resource Id: 43625
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.483"
						Top:    1.155"
						Width:  4.8"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Data Field: SOS_NANE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   5.583"
							Top:    1.238"
							Width:  4.5"
							Width Editable? Class Default
							Height: 0.25"
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Radio Button: rb_Res1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Рестр=ДА
					Window Location and Size
						Left:   5.583"
						Top:    1.238"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Message Actions
						On SAM_Click
							If rb_Res1 
								Call F_Restr(1, ND, NDI)
				Radio Button: rb_Res0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Рестр=НЕТ
					Window Location and Size
						Left:   7.083"
						Top:    1.238"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Gray
					Message Actions
						On SAM_Click
							If rb_Res0 
								Call F_Restr(0, ND, NDI)
				Radio Button: rb_Res_Null
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Рестр=???
					Window Location and Size
						Left:   8.483"
						Top:    1.238"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Pushbutton: pb_REST
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.086"
						Top:    0.156"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip =
									 'Перебудова ГПК без дострокового погашення'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND) and 
									( hWndForm.cc_dog.VIDD = 11 OR hWndForm.cc_dog.VIDD = 1)
								Call Sel017f(hWndMDI,  nTip_Fun, 122, hWndForm.cc_dog.ND,
										strTip||' '||hWndForm.cc_dog.CC_ID || ' от '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), strTip ,'','','' )
				Pushbutton: pb_DPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\USERS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Дострокове Погаш.Кредиту з перебудовою ГПК'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND) and 
									( hWndForm.cc_dog.VIDD = 11 OR hWndForm.cc_dog.VIDD = 1)
								Call Sel017f(hWndMDI,  nTip_Fun, 121, hWndForm.cc_dog.ND,
										strTip||' '||hWndForm.cc_dog.CC_ID || ' от '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), strTip ,'','','' )
				Pushbutton: pbV_Restr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.265"
						Top:    0.821"
						Width:  0.5"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\TABLER.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Інф-ція про реструктуризацію'
						On SAM_Click
							If not SalIsNull(hWndForm.cc_dog.ND)
								! Call Sel017f( hWndMDI, nTip_Fun , 13, hWndForm.cc_dog.ND,
										hWndForm.cc_dog.CC_ID || ' від '|| 
										SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ), 
										hWndForm.cc_dog.NMK,'','','' )
								Call FunNSIEditFFiltered ('CCK_RESTR',1,'nd in (select nd from cc_deal where sos<>15) and CCK_RESTR.custtype='|| Str(nTip_Kl))
							Else
								! Call Debug('Не открыт осн.счет')
								Call SalMessageBox('Не вибраний номер договору!', 'Ошибка', MB_IconExclamation)
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: BRANCH
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = BRANCH
					On SAM_AnyEdit
						Set BRANCH = sTmpE
			Column: PROD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						прод
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = PROD
					On SAM_AnyEdit
						Set PROD = sTmpE
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Состо-
						яние
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						Дог.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND
					On SAM_AnyEdit
						Set ND = nTmpE
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Исп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Рег.№
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: КЛИЕНТ -
						заемщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOP_VAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Доп.
						рекв
						Клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOP_VAL2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Доп.
						рекв
						Дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On VTM_KeyDown
						If wParam = VK_F4
							If nTip_Fun <= 10 and nEditInFrom
								If sNsiTableName != STRING_Null and sPKName != STRING_Null and sSKName != STRING_Null
									If FunNSIGetFilteredAltPK(sNsiTableName, sPKName, sSKName, 
											   IifS(sNsiSqlWhere!='', VisStrSubstitute(sNsiSqlWhere, ':ND', Str(ND)), ''),
											   sPk, sSk) > 0
										Set DOP_VAL2 = sPk
										Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
					On SAM_AnyEdit
						If sNsiTableName != STRING_Null
							! Call SalSendMsg(DOP_VAL2, VTM_KeyDown, VK_F4, 0)
							Set DOP_VAL2 = sTmpVal2
							! Call SalMessageBox('Виберіть значення з довідника (F4)', 'Увага!', MB_Ok | MB_IconAsterisk)
					On SAM_SetFocus
						Set sTmpVal2 = DOP_VAL2
			Column: SDOG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Начальная 
						сумма 
						по дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Summa
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущая
						 сумма
						лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: col56
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title:
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идентиф.
						договора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.871"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						завершения
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.cc_dog.DAT4 = CorrectDate( 
								hWndForm.cc_dog.n980, hWndForm.cc_dog.DAT4, hWndForm.cc_dog.DAT4 +1)
						Return F_DAT()
			Column: DAZS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						факт.закр.
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BLK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: БЛК
						досроч
						гашения
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Number
				Justify: Center
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: FIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ф
						и
						н
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: О
						б
						с
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Катег
						риска
						S080
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S090
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид 
						задол
						S090
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISTVAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Источ
						вал
						выруч
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Number
				Justify: Center
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.786"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срок
						разм
						в днях
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BASEM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ан.
						Нов.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.557"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RDAY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: День
						выплаты
						 долга
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.883"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RDAYSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: День
						оплаты
						  %%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_SS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ссудный 
						счет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS_SS
					On SAM_AnyEdit
						Set NLS_SS = sTmpE
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гр.
						дост
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Непогашеный 
						остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Непогашеный 
						остаток
						по %%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: sVIDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						договора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						Call SqlPrepareAndExecute(hSql(),
								 " SELECT name,vidd INTO :sTmp,:nVidd
								   FROM cc_vidd WHERE tipd=1 AND custtype =:nTip_Kl and vidd in (1,2,3,11,12,13) 
								   ORDER by name")
						Set nTmp=0
						Call SalArraySetUpperBound(mVidd, 1, -1)
						Call SalListClear(hWndItem)
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd(hWndItem, sTmp)
							Set mVidd[nTmp] = nVidd
							Set nTmp = nTmp + 1
					On SAM_Validate
						Set nTmp = SalListQuerySelection(hWndItem)
						Set hWndForm.cc_dog.VIDD = IifN(nTmp>=0, mVidd[nTmp], 0)
						Return VALIDATE_Ok
					On SAM_SetFocus
						Set sVidd = hWndForm.cc_dog.sVIDD
			Column: VIDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						договора
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  2.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: sSOUR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Источник
						финансир.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						Call SqlPrepareAndExecute(hSql(), T("
								     SELECT name,sour
								     INTO :sTmp,:nSour
								     FROM cc_source
								     ORDER BY name"))
						Set nTmp=0
						Call SalArraySetUpperBound(mSour, 1, -1)
						Call SalListClear(hWndItem)
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd(hWndItem, sTmp)
							Set mSour[nTmp] = nSour
							Set nTmp = nTmp + 1
					On SAM_Validate
						Set nTmp = SalListQuerySelection(hWndItem)
						Set hWndForm.cc_dog.SOUR = IifN(nTmp>=0, mSour[nTmp], 0)
						Return VALIDATE_Ok
					On SAM_SetFocus
						Set sIsto = hWndForm.cc_dog.sSOUR
			Column: SOUR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Источник
						кредитования
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  3.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						заключения
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.cc_dog.DAT1 = CorrectDate(
								hWndForm.cc_dog.n980, hWndForm.cc_dog.DAT1, hWndForm.cc_dog.DAT1 +1)
						Return F_DAT()
			Column: DAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						начала дейст.
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set DAT2 = CorrectDate(
								hWndForm.cc_dog.n980, hWndForm.cc_dog.DAT2, hWndForm.cc_dog.DAT2 +1)
						Return F_DAT()
			Column: DAT3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						выдачи кред
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  0.95"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.cc_dog.DAT3 = CorrectDate(
								hWndForm.cc_dog.n980, hWndForm.cc_dog.DAT3, hWndForm.cc_dog.DAT3 +1)
						Return F_DAT()
			!
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						для
						выдачи
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						для 
						выдачи
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLS_SG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет гашения
						SG
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS_SG
					On SAM_AnyEdit
						Set NLS_SG = sTmpE
			Column: OST_SG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						на SG
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACCS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC ссудного счета
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SOS
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC8
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: IRR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Эф.%
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.786"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.
						Бал.
						стоимость
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт.
						Бал.
						стоимость
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PBS_FBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отклонение 
						ФБС-ПБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KPROLOG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						пролонгаций
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! FSC:
					Необходимо добавить три столбца КП:Кред+Бух+Зал с информацией по каждому кредиту:
					Сумма  перечисленная клиенту ("выдана на руки"); 
					Сумма  комиссионного вознаграждения за выданный кредит (разовая комиссия); 
					Сумма дополнительных услуг по кредиту (страховка).
			Column: S_KK1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Cумма 
						"Нетто"
						клиенту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S_KKK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Cумма 
						начальной
						комиссии
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S_KKD 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Cумма 
						дополн.
						услуг
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Реф 
						пов'язаних 
						договорів
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Standard
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: RCOUN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						реструкту-
						ризаций
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						последней
						реструктуризации
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_DAT
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.cc_dog.DAT1 > hWndForm.cc_dog.DAT2 
							OR hWndForm.cc_dog.DAT2 > hWndForm.cc_dog.DAT3 
							OR hWndForm.cc_dog.DAT3 > hWndForm.cc_dog.DAT4
						Call Debug('Ош.дат '||
								 SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' ) ||'  '||
								 SalFmtFormatDateTime( hWndForm.cc_dog.DAT2, 'dd/MM/yyyy' ) ||'  '||
								 SalFmtFormatDateTime( hWndForm.cc_dog.DAT3, 'dd/MM/yyyy' ) ||'  '||
								 SalFmtFormatDateTime( hWndForm.cc_dog.DAT4, 'dd/MM/yyyy' ) ) 
						Return FALSE
					Return TRUE
			Function: F_LIM8
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If SqlPLSQLCommand(hSql(), "CCK.cc_START(hWndForm.cc_dog.ND) " )
							Call SqlCommitEx( hSql(),'Остатки на 89990'|| Str(hWndForm.cc_dog.ND) )
							Call MessageNoWait('Установлено остатки для '||Str(hWndForm.cc_dog.ND) ,'Сообщение',0.1,0)
						Else
							Call SqlRollback(hSql())
							Call MessageNoWait('Неуспешное завершение для '||Str(hWndForm.cc_dog.ND), 'Ошибка', 0, 1)
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return TRUE
			Function: BAB_ALL
				Description:
				Returns
					Boolean:
				Parameters
					Number: nCust
				Static Variables
				Local variables
					String: sTitl
					String: sFdat1
				Actions
					Set sFdat1 = "MDAT=to_date(pul.get_mas_ini_val('sFdat1'),'dd.mm.yyyy') and PRVN_BV_ALL.vidd in "
					If nCust = 2
						Set sTitl = "Юр"
						Set sFdat1 = sFdat1 || "(1,2,3) "
					Else If nCust = 2
						Set sTitl = "Фіз"
						Set sFdat1 = sFdat1 || "(11,12,13) "
					!
					If SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'MODE_', Str(nCust), 'Режим начисления' )" ) 
					If SalMessageBox( "Переформувати IRR1:Пiдсумковий Протокол ?", "Увага: КП "||sTitl||".осіб", 
							 MB_IconQuestion | MB_YesNo) = IDYES
						Call FunNSIEditFFiltered(
								"PRVN_BV_ALL[NSIFUNCTION]" ||
								"[PROC=>PRVN_FLOW.BAB_ALL("||Str(nCust)||",0,:D)]"||
								"[PAR=>:D(SEM=Звітна_дата,TYPE=D)]"||
								"[EXEC=>BEFORE]", 2, sFdat1 ) 
					Else
						Call FunNSIEditFFiltered(
								"PRVN_BV_ALL[NSIFUNCTION][PROC=>PUL_DAT(:D,STRING_Null)][PAR=>:D(SEM=Звітна_дата,TYPE=S)][EXEC=>BEFORE]",2,sFdat1 ) 
					!
					! PROCEDURE BAB_ALL (MOD_ int, MOD1_ int, p_DAT2 date            ) is
							10.03.2015 начисление проц.доходов на бал. стоимость по эф.ставке
							   затвердженого постановою Правління НБУ від 25.01.2012 № 23,
							  зареєстрованого в Міністерстві юстиції України 15.02.2012 за № 231/20544 (зі змінами)
							   TT_  = 'IRR' код операции
							   MOD_ = 0  По всем КД
							   MOD_ > 0  По одному КД с nd=MOD_
							
					Return TRUE
			Function: F_NAM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nTmp
					String: sTmp
				Actions
					If SqlPrepareAndExecute( hSqlAux(),"SELECT fin,name INTO :nTmp,:sTmp FROM STAN_FIN " )
						While SqlFetchNext(hSqlAux(), nFetchRes) 
							Set NAM_FIN[nTmp] = sTmp
					If SqlPrepareAndExecute( hSqlAux(),"SELECT obs,name INTO :nTmp,:sTmp FROM STAN_OBS " )
						While SqlFetchNext(hSqlAux(), nFetchRes) 
							Set NAM_OBS[nTmp] = sTmp
					If SqlPrepareAndExecute( hSqlAux(),"SELECT sos,name INTO :nTmp,:sTmp FROM CC_SOS " )
						While SqlFetchNext(hSqlAux(), nFetchRes) 
							Set NAM_SOS[nTmp] = sTmp
					If SqlPrepareAndExecute(hSqlAux(),"SELECT sour,name INTO :nTmp,:sTmp FROM CC_SOURCE where sour>0 " )
						While SqlFetchNext(hSqlAux(), nFetchRes) 
							Set NAM_SOU[nTmp] = sTmp
					If SqlPrepareAndExecute(hSqlAux(),"SELECT vidd,name INTO :nTmp,:sTmp FROM CC_VIDD where vidd in (1,2,3,11,12,13) " )
						While SqlFetchNext(hSqlAux(), nFetchRes) 
							Set NAM_VID[nTmp] = sTmp
					If SqlPrepareAndExecute(hSqlAux(),"SELECT CRISK,name INTO :nTmp,:sTmp FROM CRISK " )
						While SqlFetchNext(hSqlAux(), nFetchRes) 
							Set NAM_S080[nTmp] = sTmp
			Function: F_FSC
				Description: Особенности типа ЦФР
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If CC_FSC ='1'
						! Call SalHideWindow( pbZay )
						Call SalShowWindow( cb_FSC )
						Call SalHideWindow( pb_Lim8 )
						Set sSql_CC_ASG = "RUNFS_GB(bDat)"
						Set sTit_CC_ASG = "Авто-разбор счетов гашения SG(в т.ч.пеня)"  
						Call SalHideWindow( pb_F7 )
						Call SalHideWindow( pbSV12   )
						Call SalHideWindow( pb_T8 )
						Call SalHideWindow( pbHelp ) 
						Call SalTblSetColumnTitle( cc_dog.KPROLOG,
								 "Реф.
								реструкт.
								КД" )
						! Call SalHideWindow( pb_PBS )
						Set SEL3 = 
								",CCK_rep.S1_ND(ND, 'KK1')/100, CCK_rep.S1_ND(ND, 'KKK')/100, CCK_rep.S1_ND(ND, 'KKD')/100 "
						Set INT3 = ",:hWndForm.cc_dog.S_KK1, :hWndForm.cc_dog.S_KKK, :hWndForm.cc_dog.S_KKD "
					Else
						Set sSql_CC_ASG = "CCK.CC_ASG(nMode,1)"
						Set sTit_CC_ASG = "Разбор поступлений на счета SG по уровню доступа:
								" || sUrDostup 
						Call SalHideWindow( pb_Modify )
						Call SalHideWindow( cb_FSC )
						Call SalHideWindow( pb_Hel_GPK )
						Call SalHideWindow( pb_EXPRS )
						Call SalHideWindow( pb_IBOX )
						Call SalHideWindow( pb_WEB )
						Set SEL3 = ''
						Set INT3 = ''
					!
			Function: F_C13
				Description:
				Returns
					String:
				Parameters
					String: sPar
				Static Variables
				Local variables
					String: sTmp
					String: C13
				Actions
					Set sTmp = sPar
					Set C13 = SalNumberToChar( 13 )||SalNumberToChar( 10 )
					Set sTmp = VisStrSubstitute( sTmp, '~', C13 )
					Set sTmp = VisStrSubstitute( sTmp, ' ', C13 )
					Return sTmp
			Function: F_Restr
				Description:
				Returns
					String:
				Parameters
					Number: p_Mode
					Number: p_Nd
					Number: p_Ndi
				Static Variables
				Local variables
					Number: Ndg
					String: sTmp
				Actions
					Set Ndg = IifN(p_Ndi= NUMBER_Null, p_Nd, p_Ndi)
					Set sTmp = "Реструктуризацию "||IifS (p_Mode = 1,"УТВЕРДИТЬ ","ОТМЕНИТЬ") 
					If SalMessageBox( sTmp || " ? ","Внимание !",
							 MB_IconQuestion | MB_YesNo) = IDYES
						If SqlPLSQLCommand(hSql(), "cck_rstr.restr_AUTHOR( Ndg, p_Mode ) " ) 
							Call SqlCommit( hSql())
							Call MessageNoWait( sTmp ,'Сообщение',0.1,0)
		Window Parameters
			Number: nTip_Par
			Number: nMode
			Number: nGr  !! 9= гарантии, иначе кредиты 
			String: sKV1
			String: sKV2
			String: sKV3
		Window Variables
			!
			String: sTmpE
			Number: nTmpE
			Date/Time: dTmpE 
			!
			: AccF
				Class: cGenDFilter
			String: VID9
			String: NAM_FIN [*]
			String: NAM_OBS [*]
			String: NAM_SOS [*]
			String: NAM_SOU [*]
			String: NAM_VID [*]
			String: NAM_S080 [*]
			Window Handle: hWin_K
			!
			Date/Time: Dat_IRR 
			Date/Time: Dat_next
			Number: nRow
			Number: n980
			Number: nFILTER_ID
			String: sFILTER_ID
			String: sTemp
			Number: nLimit
			Number: nOkpo
			Number: KODZ
			String: NAM_KATZ
			Boolean: bOk
			Number: nTemp
			Number: nTmp
			Number: mVidd[*]
			String: sTmp
			Number: mAim[*]
			Number: mSour[*]
			Number: mKV[*]
			String: sMfo
			String: sNazn
			Number: nSk
			Number: nSumma
			String: sPolu
			Number: nFreq
			Number: nVidd
			Number: nRnk
			Number: nAim
			Number: nSour
			Number: nKV
			String: sSS
			String: sNlsSS
			Number: nKvSS
			String: sPlat
			Long String: lsSign
			String: sNlsSP
			String: sNlsSN
			Number: nKvA
			Number: nKv
			String: sSource
			Number: mRnk[*]
			Number: mFreq[*]
			String: sLcv
			String: sBankPolu
			Number: nAcc
			Number: nUserID
			Number: nKlientRnk
			String: sKlient
			Number: nNd
			Number: nNDI
			String: sKV
			String: sAccKred
			String: sVidd
			String: sCel
			String: sIsto
			String: sMfoKred
			String: sCC_ID
			String: sFreq
			!
			String: SS
			String: sNmk
			String: sAdr2
			String: TT
			!
			String: sUserId
			Long String: sFilter   !! Суммарный фильтр : тип (ЮЛ,ФЛ) + sFilter1
			Long String: sFilter1  !! предустановленный фильтр
			Long String: sFilter2  !! динамический фильтр
			Long String: sFilter_Pr  !! Суммарный фильтр для процентов
			String: sFilter0       !! фильтр по кнопке "Закрытые-Открытые-Слитые(несуществующие)"
			String: SEL
			String: SEL1
			String: SEL123
			String: SEL2
			String: SEL3
			String: INT1
			String: INT2
			String: INT3
			String: INT123
			String: ORD
			!
			String: sNls
			String: sTip
			Number: nTek
			Number: nCurrentRow
			String: sID
			Long String: sTEXT
			Boolean: bOld
			Number: nBLPos
			String: sBLSql
			Number: nCeln
			Date/Time: bDat
			!
			Number: nRowE
			Window Handle: hWndColE
			Number: nColSortOrder
			!
			Number: nTip_Kl
			! Number: nTip_Kl1
			Number: nTip_Fun
			Number: nTip_Dop
			Number: cc_ACC
			String: CC_TAG
			Number: CC_GPK ! Учет досрочно пог.платежей с конца=1, иначе с начала - т.е. по остатку
			!
			String: sTit_CC_ASG
			String: sSql_CC_ASG
			Boolean: CCK_NBU
			! Date/Time: CCK_MIGR
			Number: i
			Number: j
			Date/Time: dTmp
			Date/Time: dTmpD
			String: V_PROC
			Number: n_Vob
			Date/Time: dVdat
			String: Day_ZO
			Number: kprolog
			Number: sos
			! Number: FL_Sos0
			String: sNsiTableName
			String: sNsiSqlWhere
			Number: nEditInFrom
			String: sPKName
			String: sSKName
			String: sPk
			String: sSk
			String: sTmpVal2
			Number: nPRTR
		Message Actions
			On SAM_Create
				Call SalHideWindow( pbMod)
				Call SalHideWindow( pb_DPK ) 
				Call SalHideWindow( pb_REST ) 
				Set sTITL = "Кред.П"
				Set VID9 = " CC_V"
				Call SalWaitCursor(TRUE)
				Call SalMapEnterToTab(TRUE)
				Call SetWindowFullSize(hWndForm)
				! Set CCK_MIGR = SalStrToDate(GetGlobalOption('CCK_MIGR'))
				! Учет досрочно пог.платежей с конца=1, иначе с начала - т.е. по остатку
				Set CC_GPK  = GetGlobalOptionEx('CC_GPK')
				Set CCK_NBU = GetGlobalOption('CCK_NBU') = '1'
				Set n980 = GetBaseVal()
				Set bDat = GetBankDate()
				Set cb_FSC = FALSE
				Set nEditInFrom = 0
				Call F_NAM()
				!
				If SqlPrepareAndExecute( hSqlAux(),"select val into :ASG_SN from params where par='ASG-SN' ") 
						 and not SqlFetchNext( hSqlAux(), nFetchRes) 
					Set ASG_SN = '0' 
				Set cb_SG = FALSE
				Set cb_SN = FALSE
				! Set cb_IRR = FALSE
				! Call SalSendMsg( cb_IRR, SAM_Click, 0, 0 )
				If SqlPrepareAndExecute(hSql(),
						"SELECT TO_NUMBER(pul.Get_Mas_Ini_Val('CC_SG')),      TO_NUMBER(pul.Get_Mas_Ini_Val('CC_FILT_ID')) 
						 INTO :cb_SG, :nFILTER_ID from dual") 
						and SqlFetchNext(hSql(), nFetchRes) 
				!
				Set b_MOS =
						SqlPrepareAndExecute(hSql(), "SELECT val from params where par='MOS_OTC' and val='1'") 
						and SqlFetchNext(hSql(), nFetchRes) 
				If not b_MOS
					Call SalHideWindow( pb_MOS ) 
				!
				If CCK_NBU
					Call SalHideWindow( pb_INSU ) 
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT z.kodz, z.name  INTO :KODZ, :NAM_KATZ  from params p, zapros z 
						   where p.par='CC_KODZ' and to_number(p.val)=z.KODZ") and
						not SqlFetchNext(hSql(), nFetchRes) 
					Call SalHideWindow( pb_MOS_Ex ) 
				Set hWndForm.cc_dog.nTabInstance = 1
				! nTip_Par = FK
				If nTip_Par = 03 or nTip_Par = 13 OR nTip_Par = 02 or nTip_Par = 12
					Call SalShowWindow( pb_DPK ) 
					Call SalShowWindow( pb_REST ) 
				! ! F - функциональность
						      = 0 - ПОЛНАЯ (Кредитчик + Бухгалтер + Залоговик )
						      = 1 - Кредитчик
						      = 2 - Бухгалтер
						      = 3 - Залоговик
						      = 9 - Просмотр
				! ! K - тип заемщика 
						      = 2 ЮЛ
						      = 3 ФЛ 
						      = 1 БАНКИ
				! nMode = DU
				! ! D - дополнительный параметр 
						    2 - менеджер отделений, просмотр договоров с правом подписи
				! ! U - уровень доступа      
						    0 - Весь портфель
						    1 - 1 кред Инспектор
						    2 - отдел 
						    3 - свое ТОБО
				! nGr - умолчательная группа доступа для счетов
				! ! участвует в фильтре только для залоговика
				Set nTip_Kl  = SalNumberMod(nTip_Par, 10)
				! Банки, как ЮЛ
				Set nTip_Fun = nTip_Par - nTip_Kl
				Set nTip_Dop = (nMode - SalNumberMod(nMode, 10))/10
				Set nMode    = SalNumberMod(nMode, 10)
				Set sFunkcional = 'К+Б+З'
				If nTip_Fun = 90 OR nTip_Fun = 80  ! Полный просмотр или Авторизация (Без транзакций)
					Set sFunkcional = 'Без транз.'
					If nTip_Fun = 80
						Set sFunkcional = 'Авторизация'
					Else
						Call SalHideWindow( pb_Karta ) 
					Call SalHideWindow( pbIns ) 
					Call SalHideWindow( pbSV12 )
					Call SalHideWindow( pbDel ) 
					Call SalHideWindow( pbUpdate ) 
					Call SalHideWindow( pb_Lim8 ) 
					Call SalHideWindow( pbKorr )
					Call SalHideWindow( pbAcc )
					Call SalHideWindow( pb_Lim9 ) 
					Call SalHideWindow( pb_SG )
					Call SalHideWindow( pb_IRR ) 
					!
					Call SalHideWindow( pbZalog ) 
					Call SalHideWindow( pbZalog_All ) 
					! Вся таблица
					! Call SalDisableWindow( cc_dog )
				Else If nTip_Fun  = 20 ! Бухгалтер
					Set sFunkcional = 'Бухг.'
					Call SalHideWindow( pbIns )
					Call SalHideWindow( pbDel )
					!
					Call SalHideWindow( pbZalog ) 
					Call SalHideWindow( pbZalog_All ) 
					! Колонки
					Call SalDisableWindow( ISP )
					Call SalDisableWindow( CC_ID )
					Call SalDisableWindow( NDI )
					Call SalDisableWindow( DAT1 )
					Call SalDisableWindow( DAT2 )
					Call SalDisableWindow( DAT3 )
					Call SalDisableWindow( DAT4 ) 
					Call SalDisableWindow( sVIDD )
					Call SalDisableWindow( sSOUR )
					Call SalDisableWindow( BLK )
				Else If nTip_Fun  = 10 ! Кредитчик
					Set sFunkcional = 'Кред.'
					Call SalHideWindow( pb_Lim9 ) 
					Call SalHideWindow( pb_SG )
					Call SalHideWindow( pb_IRR ) 
					If SqlPrepareAndExecute( hSql(),
							"SELECT val from params where par='CC_KRED' and val='2' " )
							and not SqlFetchNext(hSql(), nFetchRes)
						Call SalDisableWindow( pbZalog ) 
						Call SalDisableWindow( pbZalog_All ) 
				Else If nTip_Fun  = 30 ! Залоговик
					Set sFunkcional = 'Залог.'
					Call SalHideWindow( pb_Proc )
					Call SalHideWindow( pbAcc )
					Call SalHideWindow( pbIns )
					Call SalHideWindow( pbDel )
					Call SalHideWindow( pbUpdate ) 
					Call SalHideWindow( pbSV12 ) 
					Call SalHideWindow( pb_Lim8 ) 
					Call SalHideWindow( pb_Lim ) 
					Call SalHideWindow( pb_KAL ) 
					Call SalHideWindow( pbHelpP ) 
					Call SalHideWindow( pbHelp ) 
					Call SalHideWindow( pbGPK ) 
					Call SalHideWindow( pb_SumPog ) 
					Call SalHideWindow( pb_Analiz ) 
					Call SalHideWindow( pb_Lim9 ) 
					Call SalHideWindow( pb_SG )
					Call SalHideWindow( pb_IRR ) 
					! Колонки
				! !
				Set sTITL = sTITL ||" " || IifS ( nTip_Kl =2, 'ЮЛ', IifS ( nTip_Kl =1, 'Банки', 'ФЛ' ) ) 
				Call SalSetWindowText(hWndForm, sTITL )
				Call ShowApdVersion('01')
				Call PrepareWindowEx(hWndForm)
				Set SS = ''
				!
				Set sUserId = Str(GetUserId())
				If SqlPrepareAndExecute( hSqlAux(),"select nvl(tobo,'0') into :USER_TOBO  
						 from staff where Id=" || sUserId ) 
						 and not SqlFetchNext( hSqlAux(), nFetchRes) 
				!
				Set nTek = TBL_MinRow+1
				Set ORD = " ORDER BY nd desc"
				Set SEL1 = 
						"SELECT DAZS, kprolog,
						  BRANCH, PROD, SDOG,  acc8, SOS, id, nd, cc_id,ndi, vidd, NAMK, rnk,  
						  grp, sour, kv, s, to_char(OBS), acckred, mfokred, dsdate, abdate,
						  dwdate, awdate,  S080, S090, ISTVAL,
						  PR, ostc/100, NLS,  acc, SROK, to_char(CRISK), PRIM, BASEM, DAY, DAYSN, RDAT, RCOUN "
				Set INT1 =
						"INTO :hWndForm.cc_dog.DAZS, :hWndForm.cc_dog.KPROLOG, :hWndForm.cc_dog.BRANCH, :hWndForm.cc_dog.PROD, :hWndForm.cc_dog.SDOG,
						 :hWndForm.cc_dog.ACC8, :hWndForm.cc_dog.SOS,  :hWndForm.cc_dog.ISP, :hWndForm.cc_dog.ND,
						 :hWndForm.cc_dog.CC_ID,:hWndForm.cc_dog.NDI, :hWndForm.cc_dog.VIDD, :hWndForm.cc_dog.NMK,
						 :hWndForm.cc_dog.RNK,  :hWndForm.cc_dog.GRP,  :hWndForm.cc_dog.SOUR,:hWndForm.cc_dog.KV,
						 :hWndForm.cc_dog.Summa,:hWndForm.cc_dog.OBS,  :hWndForm.cc_dog.NLSB,:hWndForm.cc_dog.MFOB,
						 :hWndForm.cc_dog.DAT1, :hWndForm.cc_dog.DAT2, :hWndForm.cc_dog.DAT4,:hWndForm.cc_dog.DAT3,
						 :hWndForm.cc_dog.S080, :hWndForm.cc_dog.S090, :hWndForm.cc_dog.ISTVAL, 
						 :hWndForm.cc_dog.RATE, :hWndForm.cc_dog.OST,  :hWndForm.cc_dog.NLS_SS,
						 :hWndForm.cc_dog.ACCS, :hWndForm.cc_dog.DNI,  :hWndForm.cc_dog.FIN, :hWndForm.cc_dog.BLK,
						 :hWndForm.cc_dog.BASEM,:hWndForm.cc_dog.RDAY,  :hWndForm.cc_dog.RDAYSN, :hWndForm.cc_dog.RDAT, :hWndForm.cc_dog.RCOUN "
				Set SEL2 = 
						",Round(acrn.fprocN(acc8,-2,:bDat),4),cck.PBS(ND,ACC8,:bDat)/100,cck.FBS(ND,ACC8,:bDat)/100 "
				Set INT2 = ",:hWndForm.cc_dog.IRR, :hWndForm.cc_dog.PBS, :hWndForm.cc_dog.FBS "
				! Set sFilter0 = " < 15 "
				Set sFilter0 = " < 14 "
				!
				Set hWndForm.cc_dog.strFilterTblName = 'CC_V'
				Set hWndForm.cc_dog.strPrintFileName = 'KD.txt'
				Set hWndForm.cc_dog.fFilterAtStart = FALSE
				Call SalHideWindow( rb_Res1 )
				Call SalHideWindow( rb_Res0 )
				Call SalHideWindow( rb_Res_Null )
				! New filters
				Call AccF.Init('CC_V', 'CC_V')
				! Call F_FSC()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call F_FSC()
				Set sFilter1 = ""
				If nFILTER_ID > 0
					If SqlPrepareAndExecute( hSql(),
							"SELECT TRIM(WHERE_CLAUSE), SEMANTIC
							 INTO :sFilter1,:sFILTER_ID
							 from DYN_FILTER where FILTER_ID=:nFILTER_ID " ) 
							and SqlFetchNext( hSql(), nFetchRes) 
					If sFilter1 != STRING_Null
						Set cF.strUserWhereClause = sFilter1
						Set cF.fUserFilterInUse   = TRUE
						Set sFilter1 = ' and ' || cF.GetFilterWhereClause( FALSE )
						Set cF.fUserFilterInUse   = FALSE
				! !!!
				! nMode = 0 - портфель всех инспекторов
				If nMode = 0 
					Set sUrDostup = "КП банка"
				! nMode = 1 - портфель Кред инспектора
				Else If nMode = 1
					Set sUrDostup = "КП инсп."
					Set sFilter1 =  sFilter1 || " and id=" || sUserId
					Call SalHideWindow( cc_dog.ISP )
				! nMode = 2 - портфель всех инспекторов отдела 
				Else If nMode = 2
					Set sUrDostup = "КП подразд."
					Set sFilter1 =  sFilter1 || " and id in 
							(SELECT uk.userid from OTD_USER uk, OTD_USER un WHERE uk.OTD=un.OTD and un.USERID="|| sUserId || ") " 
				! nMode = 3 - портфель всвоего ТОБО 
				Else If nMode = 3
					Set sUrDostup = "КП ТОБО"
					Set sFilter1 =  sFilter1 || " and branch='" || USER_TOBO ||"'"
					Call SalHideWindow( cc_dog.ISP )
				!
				! If (nTip_Fun=30 or nTip_Fun=90 ) and nGr > 0 
					! Set sFilter1 = sFilter1 || " and CC_V.grp="|| Str( nGr )
					                                                                                                                                                                                                                                Set sFilter1 = sFilter1 || " and sec.fit_gmask(CC_V.sec," || Str(nGr) || ")>0"
				!
				Set sUrDostup = sUrDostup || '.' ||sFILTER_ID
				! 1111
				Set sFilter = " AND custtype ="||Str(nTip_Kl) || sFilter1 
				!
				If SetQueryDFilter( AccF )
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Else
					Call SalDestroyWindow( hWndForm )
				!
				Call SalWaitCursor(FALSE)
			On UM_Populate
				! спросить фильтр
				!
				Set sFilter2 = AccF.GetFilterWhereClause(FALSE)
				Call SalWaitCursor(TRUE)
				! Показать-спрятать доп.реквизит
				If DOP_TAG != STRING_Null
					Call SalShowWindow( DOP_VAL ) 
					Call SalTblSetColumnTitle ( DOP_VAL, F_C13 (DOP_NAME)  )
				Else
					Call SalHideWindow( DOP_VAL ) 
				If DOP_TAG2 != STRING_Null
					Call SalShowWindow( DOP_VAL2 ) 
					Call SalTblSetColumnTitle ( DOP_VAL2, F_C13 (DOP_NAM2)  )
					If nTip_Fun <= 10 and nEditInFrom ! Кредитчик
						Call SalEnableWindow(DOP_VAL2)
					Else
						Call SalDisableWindow(DOP_VAL2)
				Else
					Call SalHideWindow( DOP_VAL2 ) 
				! Показать-спрятать счет гашения
				If cb_SG
					Call SalShowWindow( NLS_SG ) 
					Call SalShowWindow( OST_SG ) 
				Else
					Call SalHideWindow( NLS_SG ) 
					Call SalHideWindow( OST_SG ) 
				! Показать-спрятать остатки по %% (SN+SPN)
				If cb_SN
					Call SalShowWindow( OST_SN ) 
				Else
					Call SalHideWindow( OST_SN ) 
				! Показать-спрятать IRR 
				Set SEL123 = SEL1 
				Set INT123 = INT1 
				! If cb_IRR 
					                               Set SEL123 = SEL123 || SEL2 
					                               Set INT123 = INT123 || INT2 
				If cb_FSC
					Call SalShowWindow( S_KK1 ) 
					Call SalShowWindow( S_KKK ) 
					Call SalShowWindow( S_KKD ) 
					Set SEL123 = SEL123 || SEL3 
					Set INT123 = INT123 || INT3 
				Else
					Call SalHideWindow( S_KK1 ) 
					Call SalHideWindow( S_KKK ) 
					Call SalHideWindow( S_KKD ) 
				! Построить полный  SELECT для населения таблицы-портфеля
				Set SEL = SEL123 || INT123 || " FROM " || VID9 || "  WHERE sos "
				Set nKOL = 0 
				! Set sFilter2 = cF.GetFilterWhereClause(FALSE)
				Set hWndForm.cc_dog.strSqlPopulate = 
						SEL || sFilter0 || IifS(sFilter2=STRING_Null, '', ' AND ' || sFilter2) || 
						sFilter || IifS (nTip_Fun = 80,' and sos < 10 ','' ) || ORD
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,0001, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,0401, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,0801, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,1201, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,1601, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,2001, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,2401, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,2801, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,3201, 400))
				! Call Debug (Subs( hWndForm.cc_dog.strSqlPopulate,3601, 400))
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.cc_dog.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If cb_SG
					If SqlPrepareAndExecute( hSqlAux(),
							  "SELECT a.NLS, a.OSTC/100 INTO :hWndForm.cc_dog.NLS_SG , :hWndForm.cc_dog.OST_SG 
							   FROM accounts a, nd_acc n 
							   WHERE n.acc=a.acc and a.tip='SG ' and n.nd=:ND and a.dazs is null" )
							and NOT SqlFetchNext(hSqlAux(), nFetchRes) 
						If SqlPrepareAndExecute( hSqlAux(),
								  "SELECT a.NLS, a.OSTC/100 INTO :hWndForm.cc_dog.NLS_SG , :hWndForm.cc_dog.OST_SG 
								   FROM accounts a, nd_acc n 
								   WHERE n.acc=a.acc and a.tip='DEP' and n.nd=:ND and a.dazs is null" )
								and NOT SqlFetchNext(hSqlAux(), nFetchRes) 
				If cb_SN
					If SqlPrepareAndExecute( hSqlAux(),
							  "SELECT -sum(a.OSTC)/100 INTO :hWndForm.cc_dog.OST_SN 
							   FROM accounts a, nd_acc n 
							   WHERE n.acc=a.acc and a.tip in ('SN ', 'SPN') and n.nd=:ND and a.dazs is null" )
							and SqlFetchNext(hSqlAux(), nFetchRes) 
				! If cb_IRR
					                               If hWndForm.cc_dog.IRR != NUMBER_Null and hWndForm.cc_dog.IRR !=0 
						                               Set hWndForm.cc_dog.PBS_FBS = hWndForm.cc_dog.FBS - hWndForm.cc_dog.PBS
					                               Else 
						                               Set hWndForm.cc_dog.IRR = NUMBER_Null
						                               Set hWndForm.cc_dog.PBS = NUMBER_Null
				!
				Set hWndForm.cc_dog.FIN   = NAM_FIN [ Val( hWndForm.cc_dog.FIN  ) ]
				Set hWndForm.cc_dog.OBS   = NAM_OBS [ Val( hWndForm.cc_dog.OBS  ) ]
				Set hWndForm.cc_dog.sSOS  = NAM_SOS [      hWndForm.cc_dog.SOS    ]
				Set hWndForm.cc_dog.sSOUR = NAM_SOU [      hWndForm.cc_dog.SOUR   ]
				Set hWndForm.cc_dog.sVIDD = NAM_VID [      hWndForm.cc_dog.VIDD   ]
				Set hWndForm.cc_dog.S080 = NAM_S080 [ Val( hWndForm.cc_dog.S080 ) ]
				!
				If hWndForm.cc_dog.RATE =0 or hWndForm.cc_dog.RATE = NUMBER_Null
					If SqlPrepareAndExecute( hSqlAux(),
							  "SELECT ir INTO :hWndForm.cc_dog.RATE FROM int_ratn 
							   WHERE acc=:hWndForm.cc_dog.ACC8 and id=0 " )
							and SqlFetchNext(hSqlAux(), nFetchRes) 
				If hWndForm.cc_dog.RATE = 0
					Set hWndForm.cc_dog.RATE = NUMBER_Null
				Set nKOL=nKOL+1
				!
				If SOS >= 14
					! Уже закрыт, но Был просрочен, - КРАСНЫЙ
					If DAZS - 1  > DAT4 
						If SqlPrepareAndExecute( hSqlAux(),
								  "SELECT NP_BDATE( :DAT4,1) into :Dat_next from dual " )
								and SqlFetchNext(hSqlAux(), nFetchRes) 
							If DAZS > Dat_next 
								Call XSalTblSetRowBackColor( hWndForm, lParam,COLOR_Salmon )
				Else If SOS = 0
					Call XSalTblSetCellBackColor( sSOS, COLOR_LightGreen )
				Else If SOS = 2
					Call XSalTblSetCellBackColor( sSOS, COLOR_Green )
				Else If SOS = 4
					Call XSalTblSetCellBackColor( sSOS, COLOR_DarkGreen )
				Else If SOS = 9
					Call XSalTblSetCellBackColor( sSOS, COLOR_Sky)
				Else
					! Безнадежно просрочен - КРАСНЫЙ
					If hWndForm.cc_dog.DAT4 < bDat 
						Call XSalTblSetRowBackColor( hWndForm, lParam,COLOR_Salmon )
					! СЕГОДНЯ последняя дата - ЗЕЛЕНЫЙ
					Else If hWndForm.cc_dog.DAT4 = bDat
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen ) 
					Else
						! Нарушен календарь - РОЗОВІЙ (с точностью до целых)
						If nGr != 9 and hWndForm.cc_dog.Summa < hWndForm.cc_dog.OST - 0.5
							Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 )) 
						! В ближайшие 7 дней - ГОЛУБОЙ
						Else If hWndForm.cc_dog.DAT4 < bDat + 7
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )  ! голубой
						! В ближайший месяцй - СЕРЫЙ
						Else If hWndForm.cc_dog.DAT4 < bDat + 30
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
						! !!
						If nGr != 9 and CC_GPK = 1 !  Учет досрочно пог.платежей с конца=1(пока только в СЕБ )
							If SqlPrepareAndExecute( hSqlAux(),
									"SELECT 1 from cc_lim where nd=:hWndForm.cc_dog.ND and fdat<:bDat and nvl(otm,0)=0 
									   and ( nvl(sumo,0)>0 OR nvl(sumg,0)>0 ) " )
									and SqlFetchNext(hSqlAux(), nFetchRes) 
								! Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )  ! голубой
								Call XSalTblSetCellBackColor( ND, SalColorFromRGB( 255,255,180) )
								Call XSalTblSetCellBackColor( CC_ID, SalColorFromRGB( 255,255,180) )
								! Call XSalTblSetCellBackColor( CC_ID, SalColorFromRGB( 255,255,180) )
				If DOP_TAG != STRING_Null
					If SqlPrepareAndExecute( hSqlAux(),
							"SELECT Substr(value,1,25) into :hWndForm.cc_dog.DOP_VAL 
							 from CUSTOMERW where rnk=:hWndForm.cc_dog.RNK and tag=:DOP_TAG")
							and SqlFetchNext(hSqlAux(), nFetchRes) 
					Call XSalTblSetCellBackColor( DOP_VAL, COLOR_Sky )
				If DOP_TAG2 != STRING_Null
					If SqlPrepareAndExecute( hSqlAux(),
							"SELECT Substr(txt,1,25) into :hWndForm.cc_dog.DOP_VAL2 
							 from nd_txt where nd=:hWndForm.cc_dog.ND and tag=:DOP_TAG2")
							and SqlFetchNext(hSqlAux(), nFetchRes) 
					Call XSalTblSetCellBackColor( DOP_VAL2, COLOR_LightGreen )
				If nGr != 9 and cc_dog.KPROLOG = '0'
					Set cc_dog.KPROLOG = STRING_Null
			On UM_Update
				Call SalWaitCursor(TRUE)
				Set nRow = TBL_MinRow
				! корректировка
				While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If nTip_Fun = 20 ! Бухгалтер
						If not SqlPrepareAndExecute(hSql(), "UPDATE cc_add SET acckred=:NLSB,mfokred=:MFOB WHERE nd=:ND and adds=0")
							Call SqlRollback(hSql())
							Call MessageNoWait('Неуспешная операция при сохранении реквизитов кредитного договора ' || Str(ND), 'Ошибка', 0, 1)
							Return FALSE
						Else
							Set sTemp = 'Бух.Cохранение реквизитов КД, реф=' || Str(ND)
							Call SqlCommitEx(hSql(), sTemp)
							Call MessageNoWait(sTemp, 'Сообщение', 3, 0)
					Else
						! Реквизиты кредитчика: cc_deal: DAT1, DAT4, nVidd, CC_ID, limit, user_id  
								                        cc_add : DAT2 DAT3, sour, NLSB, MFOB , S
						If SqlPrepareAndExecute(hSql(),"SELECT cc_vidd.vidd FROM cc_vidd INTO :nVidd WHERE cc_vidd.name=:sVIDD and  cc_vidd.tipd=1") 
								and SqlFetchNext(hSql(), nFetchRes) 
								and SqlPrepareAndExecute(hSql(),"SELECT sour FROM cc_source INTO :sSource WHERE cc_source.name=:sSOUR ") 
								and SqlFetchNext(hSql(), nFetchRes) 
							If not SqlPLSQLCommand(hSql(),
									"CCK.CC_UPDATE(ND, DAT1, DAT2, DAT3, DAT4,  nVidd, CC_ID, Summa, ISP, sSource, BLK, NLSB, MFOB, ACC8, ACCS, RDAY, NDI)")
								Call SqlRollback(hSql())
								Return FALSE
							If not SqlPrepareAndExecute(hSql(),
									"Update specparam s
									    set s.S090=:S090, 
									        s.ISTVAL=decode( nvl(:ISTVAL,0),1,1,null) 
									  where s.S080 is not null 
									    and ( nvl(s.S090,' ') <> :S090 OR nvl(s.ISTVAL,0) <> nvl(:ISTVAL,0) )
									    and s.acc in (select n.acc from nd_acc n, accounts a where n.acc=a.acc and a.rnk = :RNK  and n.nd=:ND) ")
								Call SqlRollback(hSql())
								Return FALSE
							If DOP_TAG2 != STRING_Null
								If not SqlPLSQLCommand(hSql(), "cck_app.set_nd_txt(ND, DOP_TAG2, DOP_VAL2)")
									Call SqlRollback(hSql())
									Return FALSE
							Set sTemp = 'Кред.Cохранение реквизитов КД, реф=' || Str(ND)
							Call SqlCommitEx(hSql(), sTemp)
							Call MessageNoWait(sTemp, 'Сообщение', 3, 0)
				Call SalWaitCursor(FALSE)
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_ColumnSelectClick
				Set nColSortOrder=wParam
				Call SalSendClassMessage(SAM_ColumnSelectClick,wParam,0)
			On SAM_DoubleClick
				! Call SalSendMsg( pbAcc , SAM_Click, 0, 0 )
				Set cc_ACC = 0
				If SqlPrepareAndExecute( hSql(),
						"SELECT TO_NUMBER(pul.Get_Mas_Ini_Val('CC_ACC')) INTO :cc_ACC from dual " ) 
						and SqlFetchNext( hSql(), nFetchRes)
					If cc_ACC=1
						Call SalSendMsg( pbDetails , SAM_Click, 0, 0 )
					Else
						Call SalSendMsg( pbAcc , SAM_Click, 0, 0 )
			!
			On SAM_TblDoDetails
				If SqlPrepareAndExecute( hSqlAux(),"select to_number(nvl(f_get_nd_txt(:ND,'PR_TR',gl.bd),0)) into :nPRTR from dual" ) 
						 and SqlFetchNext( hSqlAux(), nFetchRes) 
				If VIDD = 1 or  VIDD = 11  or  VIDD = 12  or  VIDD = 13 or (nPRTR = 0 and VIDD = 2) or (nPRTR = 0 and VIDD = 3)
					Call SalHideWindow( pb_CKL )
					Call SalShowWindow( pbGPK )
				Else If nGr != 9
					Call SalHideWindow( pbGPK )
					Call SalShowWindow( pb_CKL )
				!
				If SOS = 9 and nGr != 9
					!
					Call SalShowWindow( rb_Res1 )
					Call SalShowWindow( rb_Res0 )
					Call SalShowWindow( rb_Res_Null ) 
					Call SalHideWindow( SOS_NANE )
					Set rb_Res_Null = TRUE
					!
				Else
					Call SalHideWindow( rb_Res1 )
					Call SalHideWindow( rb_Res0 )
					Call SalHideWindow( rb_Res_Null )
					Set SOS_NANE = sSOS
					Call SalShowWindow( SOS_NANE )
	Table Window: Tbl_Sob
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Календарь событий
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    0.917"
				Width:  13.533"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.726"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44760
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Ist(ID)
						On SAM_Create
							Set strTip = 'Історія змін (F2)'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44761
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44762
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.405"
							Width:  3.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.583"
							Top:    0.405"
							Width:  3.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: nND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.083"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала' )
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.783"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения' )
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Несистемные
					Window Location and Size
						Left:   3.883"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb1
								! Call SalHideWindow( DAT_s )
								! Call SalHideWindow( DAT_po)
								Call NASELENIE()
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Else
								! Call SalShowWindow( DAT_s )
								! Call SalShowWindow( DAT_po)
								Call NASELENIE()
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: DAT_s
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.071"
							Width:  1.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call F_DAT()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Начало периода для анализа' )
				Data Field: DAT_po
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.683"
							Top:    0.071"
							Width:  1.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call F_DAT()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Конец периода для анализа' )
				Pushbutton: pb_Ist
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.25"
						Top:    0.845"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Історія модифікації події (F2)'
						On SAM_Click
							Call F_Ist(ID)
		Contents
			Column: kSort
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Для сорт
				Visible? No
				Editable? Yes
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  10.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If hWndForm.Tbl_Sob.FDAT < hWndForm.Tbl_Sob.dDat
							Call Debug('Невірно вказана дата')
			!
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If hWndForm.Tbl_Sob.FDAT < hWndForm.Tbl_Sob.dDat
							Call Debug('Невірно вказана дата')
							Set hWndForm.Tbl_Sob.FDAT = hWndForm.Tbl_Sob.dDat+Call_Last_Day
			Column: FACT_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-
						Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                        If hWndForm.Tbl_Sob.FACT_DAT < hWndForm.Tbl_Sob.dDat
							                                                                                                                                                                                                        Call Debug('Невірно вказана дата')
							                                                                                                                                                                                                        Set hWndForm.Tbl_Sob.FACT_DAT = hWndForm.Tbl_Sob.dDat+Call_Last_Day
					On UM_DoubleClick
						Set hWndForm.Tbl_Sob.FACT_DAT = GetBankDate() 
			Column: DIFF_DAY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Откл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: sSYS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Т
						и
						п
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Left
				Width:  0.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						Исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фио
						исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отметка 
						о вып
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(hSql(), 
								"SELECT name,otm 
								 INTO :hWndForm.Tbl_Sob.sTmp, :hWndForm.Tbl_Sob.nOtm 
								 FROM cc_otm ORDER by otm ")
							Set Tbl_Sob.nTmp=0
							Call SalArraySetUpperBound(hWndForm.Tbl_Sob.mOtm, 1, -1)
							Call SalListClear(hWndItem)
							While SqlFetchNext(hSql(), nFetchRes)
								Call SalListAdd(hWndItem, hWndForm.Tbl_Sob.sTmp)
								Set hWndForm.Tbl_Sob.mOtm[hWndForm.Tbl_Sob.nTmp] = hWndForm.Tbl_Sob.nOtm
								Set hWndForm.Tbl_Sob.nTmp = hWndForm.Tbl_Sob.nTmp + 1
					On SAM_Validate
						Set hWndForm.Tbl_Sob.nTmp = SalListQuerySelection(hWndItem)
						Set hWndForm.Tbl_Sob.OTM = IifN (
								hWndForm.Tbl_Sob.nTmp >=0, 
								hWndForm.Tbl_Sob.mOtm[hWndForm.Tbl_Sob.nTmp], 0)
						! при несист событиях и ометке о выполнении 6, 
								  генерировать это же событие на ближайшую дату согласно периоду
								  с учетом выходных (после - для ежедневных, до - для остальных ),
								  но не более конца дог - для периодичности 1, 3 5 7 180 360
						Set hWndForm.Tbl_Sob.dTmp = DATETIME_Null
						If hWndForm.Tbl_Sob.nSYS>0 AND hWndForm.Tbl_Sob.OTM = 6 
							If hWndForm.Tbl_Sob.FREQ = 1 ! Ежедневно
								Set hWndForm.Tbl_Sob.dTmp = CorrectDate(
										hWndForm.Tbl_Sob.n980, 
										hWndForm.Tbl_Sob.FDAT,
										hWndForm.Tbl_Sob.FDAT  + 1 )
							Else If hWndForm.Tbl_Sob.FREQ = 3 ! Еженедельно
								Set hWndForm.Tbl_Sob.dTmp = hWndForm.Tbl_Sob.FDAT + 7
								Set hWndForm.Tbl_Sob.dTmp = CorrectDate(
										hWndForm.Tbl_Sob.n980, 
										hWndForm.Tbl_Sob.dTmp, 
										hWndForm.Tbl_Sob.dTmp -1 )
							Else If hWndForm.Tbl_Sob.FREQ = 5 ! Ежемесячно
								Set hWndForm.Tbl_Sob.dTmp = AddMonths( hWndForm.Tbl_Sob.FDAT ,1) 
								Set hWndForm.Tbl_Sob.dTmp = CorrectDate(
										hWndForm.Tbl_Sob.n980, 
										hWndForm.Tbl_Sob.dTmp, 
										hWndForm.Tbl_Sob.dTmp -1 )
							Else If hWndForm.Tbl_Sob.FREQ = 7 ! Ежеквартально
								Set hWndForm.Tbl_Sob.dTmp = AddMonths( hWndForm.Tbl_Sob.FDAT ,3) 
								Set hWndForm.Tbl_Sob.dTmp = CorrectDate(
										hWndForm.Tbl_Sob.n980, 
										hWndForm.Tbl_Sob.dTmp, 
										hWndForm.Tbl_Sob.dTmp -1 )
							Else If hWndForm.Tbl_Sob.FREQ = 180 ! Полугодие
								Set hWndForm.Tbl_Sob.dTmp = AddMonths( hWndForm.Tbl_Sob.FDAT ,6) 
								Set hWndForm.Tbl_Sob.dTmp = CorrectDate(
										hWndForm.Tbl_Sob.n980,
										hWndForm.Tbl_Sob.dTmp, 
										hWndForm.Tbl_Sob.dTmp -1 )
							Else If hWndForm.Tbl_Sob.FREQ = 360 ! Год
								Set hWndForm.Tbl_Sob.dTmp = AddMonths( hWndForm.Tbl_Sob.FDAT ,12) 
								Set hWndForm.Tbl_Sob.dTmp = CorrectDate(
										hWndForm.Tbl_Sob.n980, 
										hWndForm.Tbl_Sob.dTmp, 
										hWndForm.Tbl_Sob.dTmp -1 )
							If hWndForm.Tbl_Sob.dTmp != DATETIME_Null 
									AND hWndForm.Tbl_Sob.dTmp <= hWndForm.Tbl_Sob.DAT4
								If SqlPrepareAndExecute( hSql(),
										 "INSERT INTO cc_sob (ND,FDAT,ISP,TXT, psys, freq ) VALUES 
										(:hWndForm.Tbl_Sob.nND, :hWndForm.Tbl_Sob.dTmp, :hWndForm.Tbl_Sob.nUser,
										 :hWndForm.Tbl_Sob.TXT, :hWndForm.Tbl_Sob.nSYS, :hWndForm.Tbl_Sob.FREQ )" )
									Call SqlCommit( hSql() )
								Else
									Call SqlRollback( hSql() )
			Column: FREQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sFREQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Перио-
						дичность
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(hSql(), 
								  "SELECT name,freq INTO :hWndForm.Tbl_Sob.sTmp,:hWndForm.Tbl_Sob.nFreq 
								   FROM freq ORDER by freq ")
							Set hWndForm.Tbl_Sob.nTmp=0
							Call SalArraySetUpperBound(hWndForm.Tbl_Sob.mFreq, 1, -1)
							Call SalListClear(hWndItem)
							While SqlFetchNext(hSql(), nFetchRes)
								Call SalListAdd(hWndItem, hWndForm.Tbl_Sob.sTmp)
								Set hWndForm.Tbl_Sob.mFreq[hWndForm.Tbl_Sob.nTmp] = hWndForm.Tbl_Sob.nFreq
								Set hWndForm.Tbl_Sob.nTmp = hWndForm.Tbl_Sob.nTmp + 1
					On SAM_Validate
						Set hWndForm.Tbl_Sob.nTmp = SalListQuerySelection(hWndItem)
						Set hWndForm.Tbl_Sob.FREQ = IifN ( 
								hWndForm.Tbl_Sob.nTmp >=0, 
								hWndForm.Tbl_Sob.mFreq[hWndForm.Tbl_Sob.nTmp], 0)
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  8.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? Yes
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(hSql(), 
								  "SELECT id,txt INTO  :hWndForm.Tbl_Sob.nTXT,  :hWndForm.Tbl_Sob.sTmp
								   FROM cc_sob_txt  where custtype=to_number(:sTip_Kl) or custtype is null and id>0  ORDER by id ")
							Set hWndForm.Tbl_Sob.nTmp=0
							Call SalArraySetUpperBound(hWndForm.Tbl_Sob.mTXT, 1, -1)
							Call SalListClear(hWndItem)
							While SqlFetchNext(hSql(), nFetchRes)
								Call SalListAdd(hWndItem, hWndForm.Tbl_Sob.sTmp)
								Set hWndForm.Tbl_Sob.mTXT[hWndForm.Tbl_Sob.nTmp] = hWndForm.Tbl_Sob.nTXT
								Set hWndForm.Tbl_Sob.nTmp = hWndForm.Tbl_Sob.nTmp + 1
						! If TXT.Init( hWndItem )
							                                                                                                                                                                                                                                                                                                Call TXT.Populate( hSql(), "ID", "TXT", "CC_SOB_TXT", " custtype is null  ORDER by id" )
					! On SAM_Validate
						! Set nTXT = SalListQuerySelection(hWndItem)
						! Set hWndForm.cc_dog.TXT = IifN(nTmp>=0, mSour[nTmp], 0)
						                                                                                                                                                                                                                                                                                              Set hWndForm.Tbl_Sob.nTmp = SalListQuerySelection(hWndItem)
						! Set hWndForm.Tbl_Sob.nSYS = IifN ( 
								hWndForm.Tbl_Sob.nTmp >=0, 
								hWndForm.Tbl_Sob.mTXT[hWndForm.Tbl_Sob.nTmp], 1)
						                                                                                                                                                                                                                                                                                              If hWndForm.Tbl_Sob.nTmp >=0
							                                                                                                                                                                                                                                                                                              Set hWndForm.Tbl_Sob.nSYS=hWndForm.Tbl_Sob.mTXT[hWndForm.Tbl_Sob.nTmp]
						                                                                                                                                                                                                                                                                                              Else 
							                                                                                                                                                                                                                                                                                              Set hWndForm.Tbl_Sob.nSYS=1
						                                                                                                                                                                                                                                                                                              Return VALIDATE_Ok
					On SAM_AnyEdit
						! Set dCC_ID=Str(SalListQuerySelection(hWndItem))
						Set nTXT = SalListQuerySelection(hWndItem)
						Set hWndForm.Tbl_Sob.nTmp = SalListQuerySelection(hWndItem)
						! Set hWndForm.Tbl_Sob.nSYS = IifN ( 
								hWndForm.Tbl_Sob.nTmp >=0, 
								hWndForm.Tbl_Sob.mTXT[hWndForm.Tbl_Sob.nTmp], 1)
						If hWndForm.Tbl_Sob.nTmp >=0
							Set hWndForm.Tbl_Sob.nSYS=hWndForm.Tbl_Sob.mTXT[hWndForm.Tbl_Sob.nTmp]
							Set hWndForm.Tbl_Sob.sSYS=Str(hWndForm.Tbl_Sob.mTXT[hWndForm.Tbl_Sob.nTmp])
						If hWndForm.Tbl_Sob.nSYS= NUMBER_Null
							Set hWndForm.Tbl_Sob.nSYS=1
						! Set dCC_ID=Str(hWndForm.Tbl_Sob.nSYS)
					On UM_DoubleClick
						Set hWndForm.Tbl_Sob.sAIM = hWndForm.Tbl_Sob.TXT 
						Set hWndForm.Tbl_Sob.bTmp = FALSE
						If hWndForm.Tbl_Sob.FDAT >= hWndForm.Tbl_Sob.dDat
							Set hWndForm.Tbl_Sob.bFL_Edit = TRUE
						Else
							Set hWndForm.Tbl_Sob.bFL_Edit = FALSE
						Call Sel017t( hWndForm, 'Подробности о событии ', 
								hWndForm.Tbl_Sob.bTmp, 
								hWndForm.Tbl_Sob.sAIM, 
								hWndForm.Tbl_Sob.bFL_Edit )
						If Tbl_Sob.bTmp and Tbl_Sob.bFL_Edit
							Set Tbl_Sob.TXT = Tbl_Sob.sAIM
							If SqlPrepareAndExecute( hSql(), "select id from cc_sob WHERE id=:Tbl_Sob.ID" ) 
									and SqlFetchNext(hSql(), nFetchRes) 
								Set Tbl_Sob.sTmpT = Tbl_Sob.strSqlUpdate
								Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Else
								Set Tbl_Sob.sTmpT = Tbl_Sob.strSqlInsert
								Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
							If SqlPrepareAndExecute( hSql(), Tbl_Sob.sTmpT )
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback(hSql())
						Call SalWaitCursor(FALSE)
			Column: nSYS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_DISA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.Tbl_Sob.nSYS >= 1 OR hWndForm.Tbl_Sob.nSYS = NUMBER_Null 
						Call SalEnableWindow( hWndForm.Tbl_Sob.sOTM )
						Call SalEnableWindow( hWndForm.Tbl_Sob.sFREQ )
						Call SalEnableWindow( hWndForm.Tbl_Sob.TXT )
						Call SalEnableWindow( hWndForm.Tbl_Sob.FDAT )
					Else
						Call SalDisableWindow( hWndForm.Tbl_Sob.sOTM )
						Call SalDisableWindow( hWndForm.Tbl_Sob.sFREQ )
						Call SalDisableWindow( hWndForm.Tbl_Sob.TXT )
						Call SalDisableWindow( hWndForm.Tbl_Sob.FDAT )
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.Tbl_Sob.DAT_s > hWndForm.Tbl_Sob.DAT_po 
						Call SalMessageBox('Дата-1 больше Дата-2 !' ,"В Н И М А Н И Е ! ", MB_IconStop)
						Set hWndForm.Tbl_Sob.DAT_po = AddMonths( hWndForm.Tbl_Sob.DAT_s, 1 )
			Function: F_STROKA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow 
				Actions
					Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow)
					Call SalTblSetContext( hWndForm, nRow )                               
					Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE )
					Set hWndForm.Tbl_Sob.FDAT = FDAT_
					Set hWndForm.Tbl_Sob.FACT_DAT = FACT_DA_
					Set hWndForm.Tbl_Sob.DIFF_DAY = DIFF_DA_
					Set hWndForm.Tbl_Sob.ID = ID_
					Set hWndForm.Tbl_Sob.TXT = TX_
					Set hWndForm.Tbl_Sob.OTM = OTM_
					Set hWndForm.Tbl_Sob.sOTM = sOTM_
					Set hWndForm.Tbl_Sob.nSYS = nSYS_
					Set hWndForm.Tbl_Sob.sSYS = sSYS_
					Set hWndForm.Tbl_Sob.FREQ = FREQ_
					Set hWndForm.Tbl_Sob.sFREQ = sFREQ_
					If nISP_=nISP_OLD AND nISP_ != NUMBER_Null
							OR sLOG_=sLOG_OLD AND sLOG_ != STRING_Null
					Else
						If SqlPrepareAndExecute( hSqlAux2(), 
								"SELECT id,fio,logname into :nISP_,:sISP_OLD,:sLOG_ from STAFF where " ||
								IifS(nISP_ != NUMBER_Null," id=:nISP_" ," logname=:sLOG_") )
								and SqlFetchNext( hSqlAux2(), nFetchRes) 
							Set nISP_OLD = nISP_
							Set sLOG_OLD = sLOG_
					!
					Set hWndForm.Tbl_Sob.nISP = nISP_OLD
					Set hWndForm.Tbl_Sob.sISP = sISP_OLD
					If hWndForm.Tbl_Sob.FDAT < hWndForm.Tbl_Sob.dDat 
						Call XSalTblSetRowBackColor( hWndForm, nRow, COLOR_LightGray ) ! серый
					If hWndForm.Tbl_Sob.FDAT = hWndForm.Tbl_Sob.dDat 
						Call XSalTblSetRowBackColor( hWndForm, nRow, COLOR_LightAqua )  ! голубой
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql1
					String: WER0
					String: WER2
					String: WER 
				Actions
					Call SalTblReset( hWndForm )
					Set nISP_OLD = GetUserId()
					Set sISP_OLD = GetUserRealName()
					Set sLOG_OLD = GetUserLoginName()
					Set sLOG_ = STRING_Null
					!
					Set WER = " BETWEEN :DAT_s and :DAT_po and   "
					Set WER0 = IifS (cb1, " V_CC_SOB.psys>0"," (V_CC_SOB.psys<=0 or V_CC_SOB.psys is null)") || " and "
					Set WER2 = cF.GetFilterWhereClause( FALSE )
					If WER2 != STRING_Null
						Set WER0 = WER0 || WER2 || " and "
					! 1- из графика (ручные + системные из модуля)
					Set sSql1 = 
							"SELECT TO_date(V_CC_SOB.fdat, 'dd/mm/yyyy'),
							        V_CC_SOB.id, V_CC_SOB.ISP,  
							        Substr(V_CC_SOB.TXT,1,250) txt,   V_CC_SOB.OTM, 
							        t.name, nvl(V_CC_SOB.psys,0), 
							(case when nvl(V_CC_SOB.psys,0)>0 
							 then nvl(to_char(ct.id),'N') else 'S' end),
							       V_CC_SOB.FREQ,     q.NAME ,
							       TO_date(V_CC_SOB.fact_date , 'dd/mm/yyyy') ,
							       V_CC_SOB.diff_days
							 INTO :hWndForm.Tbl_Sob.FDAT_,:hWndForm.Tbl_Sob.ID_,   :hWndForm.Tbl_Sob.nISP_,
							      :hWndForm.Tbl_Sob.TX_ , :hWndForm.Tbl_Sob.OTM_,  :hWndForm.Tbl_Sob.sOTM_,
							      :hWndForm.Tbl_Sob.nSYS_, :hWndForm.Tbl_Sob.sSYS_, :hWndForm.Tbl_Sob.FREQ_,
							      :hWndForm.Tbl_Sob.sFREQ_,
							      :hWndForm.Tbl_Sob.FACT_DA_,
							      :hWndForm.Tbl_Sob.DIFF_DA_ 
							 FROM V_CC_SOB, cc_otm t, freq q, cc_sob_txt ct
							 WHERE TO_date(V_CC_SOB.fdat, 'dd/mm/yyyy') " ||
							       WER ||WER0||" V_CC_SOB.psys=ct.id(+) 
							   AND V_CC_SOB.freq = q.freq (+) AND V_CC_SOB.otm = t.otm (+) 
							   AND V_CC_SOB.nd="|| Str(nND ) || "
							 ORDER BY V_CC_SOB.ISP "
					! Call Debug ('1/'|| sSql1)
					If SqlPrepareAndExecute( hSql(), sSql1 )
						While SqlFetchNext(hSql(), nFetchRes) 
							Set sLOG_ = STRING_Null
							Call F_STROKA()
							Set kSort = SalFmtFormatDateTime( FDAT_, "yyyyMMdd" ) || SalStrRightX( Str(ID_), 3 )
					!
					! 2 - движения по счетам (кроме нач %)
					If not hWndForm.Tbl_Sob.cb1
						Set sLOG_ = STRING_Null
						Set OTM_ = 6 
						Set nSYS_ = 0 
						Set sSYS_ = 'F'
						Set sFREQ_ =''
						Set FREQ_ = 0
						Set sSql1 = 
								"SELECT o.fdat,o.ref,p.userid, 
								   Substr(a.nls||'/'||a.kv||' = '||o.s/100||' '||p.nazn, 1,250) txt , 
								   Decode(o.dk,1,'КР','ДБ')||'.сч.'
								 INTO :hWndForm.Tbl_Sob.FDAT_, :hWndForm.Tbl_Sob.ID_,
								      :hWndForm.Tbl_Sob.nISP_, :hWndForm.Tbl_Sob.TX_, :hWndForm.Tbl_Sob.sOTM_ 
								 FROM opldok o, oper p, nd_acc n, accounts a
								 WHERE o.FDAT " || WER || " o.sos=5 and o.ref=p.ref and o.acc=a.acc 
								   and ( a.tip in ('SS ','SL ','SP ', 'SPN') or o.dk=1 and a.tip='SN ') 
								   and a.acc=n.acc and n.nd="||Str(nND ) ||"
								 ORDER BY p.userid "
						! Call Debug ('2/'|| sSql1)
						If SqlPrepareAndExecute( hSql(), sSql1)
							While SqlFetchNext(hSql(), nFetchRes) 
								Set sLOG_ = STRING_Null
								Call F_STROKA()
								Set kSort = SalFmtFormatDateTime( FDAT_, "yyyyMMdd" ) || 'AAA' 
					!
					! 3 - % ставка
					If not hWndForm.Tbl_Sob.cb1
						Set sLOG_ = STRING_Null
						Set ID_ = NUMBER_Null
						Set OTM_ = 6 
						Set sOTM_ = ' % ст.'
						Set nSYS_ = 0 
						Set sSYS_ = 'F'
						Set sFREQ_ =''
						Set FREQ_ = 0
						Set sSql1 = 
								"SELECT r.bdat, r.idu, Substr(a.nls||'/'||a.kv||'='||r.ir, 1, 250 ) txt 
								 INTO :hWndForm.Tbl_Sob.FDAT_, :hWndForm.Tbl_Sob.nISP_, :hWndForm.Tbl_Sob.TX_  
								 FROM int_ratn r, nd_acc n, accounts a
								 WHERE r.BDAT " || WER || " r.id=0 and r.acc=a.acc 
								   and a.tip in ('SS ','SL ','SP ') and a.acc=n.acc and n.nd="||Str(nND )|| " 
								 ORDER BY r.idu "
						! Call Debug ('3/'|| sSql1)
						If SqlPrepareAndExecute( hSql(), sSql1 )
							While SqlFetchNext(hSql(), nFetchRes) 
								Set sLOG_ = STRING_Null
								Call F_STROKA()
								Set kSort = SalFmtFormatDateTime( FDAT_, "yyyyMMdd" ) || 'BBB' 
					If not hWndForm.Tbl_Sob.cb1
						Set nISP_ = NUMBER_Null
						Set ID_ = NUMBER_Null
						Set OTM_ = 6 
						Set sOTM_ = ' Кат.риска'
						Set nSYS_ = 0 
						Set sSYS_ = 'F'
						Set FREQ_ = 0
						Set sFREQ_ =''
						Set sSql1 = 
								"SELECT distinct s.fdat, s.USER_NAME, Substr(a.nls||'/'||a.kv||'='||s.s080, 1, 250 ) txt  
								 INTO :hWndForm.Tbl_Sob.FDAT_, :hWndForm.Tbl_Sob.sLOG_, :hWndForm.Tbl_Sob.TX_ 
								 FROM SPECPARAM_UPDATE s, nd_acc n, accounts a
								 WHERE trunc(s.FDAT) " || WER ||" s.acc=a.acc and a.acc=n.acc
								   and a.tip in ('SS ','SL ','SP ') and n.nd="||Str(nND )|| "
								 ORDER BY s.USER_NAME "
						! Call Debug ('4/'|| sSql1)
						If SqlPrepareAndExecute( hSql(), sSql1 )
							While SqlFetchNext(hSql(), nFetchRes) 
								Call F_STROKA()
								Set kSort = SalFmtFormatDateTime( FDAT_, "yyyyMMdd" ) || 'CCC' 
					!
					Call SalTblSortRows( hWndForm, 1, TBL_SortDecreasing )
			Function: F_Ist
				Description:
				Returns
				Parameters
					Number: pID
				Static Variables
				Local variables
					String: sWhere
					String: sTmp
					String: sTmp1
				Actions
					Set sWhere = " CC_SOB_UPDATE.id = " || Str(pID)
					! Call FunNSIGetFiltered ("CC_SOB_UPDATE","ID",
							sWhere , sTmp, sTmp1 )
					Call FunNSIEditFFiltered('CC_SOB_UPDATE',1,sWhere)
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
			String: sTip_Kl
		Window Variables
			Number: nUser
			Date/Time: dDat
			Boolean: bTmp
			Number: bFL_Edit
			Long String: sAIM
			String: sTmpT 
			String: sSql1
			!
			Number: n980
			Date/Time: dTmp
			String: sTmp
			Number: nTmp
			Number: nOtm
			Number: nTXT
			Number: nFreq
			Number: mOtm[*]
			Number: mFreq[*]
			Number: mTXT[*]
			!
			Number: nISP_OLD 
			String: sISP_OLD
			String: sLOG_OLD
			Date/Time: FDAT_
			Date/Time: FACT_DA_
			Number: DIFF_DA_
			Number: ID_
			Number: nISP_
			String: TX_
			String: sISP_ 
			Number: OTM_
			String: sOTM_
			Number: nSYS_
			String: sSYS_
			Number: FREQ_
			String: sFREQ_
			String: sLOG_
			Number: Call_Last_Day
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Календарь событий КД реф=' || Str(hWndForm.Tbl_Sob.nPar) )
				Call ShowApdVersion('09')
				Set hWndForm.Tbl_Sob.strFilterTblName = 'V_CC_SOB'
				Set hWndForm.Tbl_Sob.strPrintFileName = 'СС_SOB'
				Set hWndForm.Tbl_Sob.cb1 = TRUE
				Call SalShowWindow(  hWndForm.Tbl_Sob.DAT_s )
				Call SalShowWindow(  hWndForm.Tbl_Sob.DAT_po)
				If hWndForm.Tbl_Sob.nTip_Ur = 90  !! 'Полный просмотр (Без транзакций)'
					Call SalDisableWindow( pbIns ) 
					Call SalDisableWindow( pbDel ) 
					Call SalDisableWindow( pbUpdate ) 
				Set hWndForm.Tbl_Sob.nTabInstance = 1
				Set hWndForm.Tbl_Sob.dCC_ID='ГC: '|| hWndForm.Tbl_Sob.strPar01
				Set hWndForm.Tbl_Sob.dNMK  = hWndForm.Tbl_Sob.strPar02
				Set hWndForm.Tbl_Sob.nND   = hWndForm.Tbl_Sob.nPar
				Set hWndForm.Tbl_Sob.nUser = GetUserId()
				Set Call_Last_Day=SalStrToNumber(GetGlobalOption('CC_CCSOB') )
				Set hWndForm.Tbl_Sob.dDat  = GetBankDate()-Call_Last_Day
				Set hWndForm.Tbl_Sob.DAT_po = hWndForm.Tbl_Sob.dDat+Call_Last_Day
				Set hWndForm.Tbl_Sob.DAT_s = AddMonths( hWndForm.Tbl_Sob.dDat+Call_Last_Day, - 1 )
				Set hWndForm.Tbl_Sob.n980  = GetBaseVal()
				Call SalTblSetLockedColumns( hWndForm, 9 )
				If SqlPrepareAndExecute( hSql(),
						 "SELECT sdate, wdate INTO :hWndForm.Tbl_Sob.DAT1, :hWndForm.Tbl_Sob.DAT4 
						  FROM cc_deal WHERE nd=:hWndForm.Tbl_Sob.nND ")
						and SqlFetchNext(hSql(), nFetchRes) 
				!
				Set hWndForm.Tbl_Sob.strSqlDelete =
						"DELETE FROM cc_sob 
						 WHERE id=:hWndForm.Tbl_Sob.ID and FDAT >= :hWndForm.Tbl_Sob.dDat and psys >0 "
				!
				Set hWndForm.Tbl_Sob.strSqlInsert =
						"INSERT INTO cc_sob (ND,FDAT,ISP,TXT, psys, otm, freq ) 
						(select :hWndForm.Tbl_Sob.nND,  :hWndForm.Tbl_Sob.FDAT,
						 :hWndForm.Tbl_Sob.nUser,:hWndForm.Tbl_Sob.TXT,  :hWndForm.Tbl_Sob.nSYS, 
						 :hWndForm.Tbl_Sob.OTM,  :hWndForm.Tbl_Sob.FREQ  from dual where :hWndForm.Tbl_Sob.TXT is not null )"
				!
				Set hWndForm.Tbl_Sob.strSqlUpdate =
						"UPDATE cc_sob Set 
						     FDAT= :hWndForm.Tbl_Sob.FDAT, 
						fact_date= :hWndForm.Tbl_Sob.FACT_DAT, 
						     TXT = :hWndForm.Tbl_Sob.TXT, 
						     otm = :hWndForm.Tbl_Sob.OTM, 
						     freq= :hWndForm.Tbl_Sob.FREQ, 
						     psys=:hWndForm.Tbl_Sob.nSYS
						 where id=:hWndForm.Tbl_Sob.ID 
						   and :hWndForm.Tbl_Sob.FDAT >= :hWndForm.Tbl_Sob.dDat and  psys >0 "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On SAM_FetchRowDone
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   If hWndForm.Tbl_Sob.FDAT < hWndForm.Tbl_Sob.dDat
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   If hWndForm.Tbl_Sob.FDAT = hWndForm.Tbl_Sob.dDat
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )  ! голубой
			! On UM_DoubleClick
				                                                       Set hWndForm.Tbl_Sob.sAIM = hWndForm.Tbl_Sob.TXT 
				                                                       Set hWndForm.Tbl_Sob.bTmp = FALSE
				                                                       If hWndForm.Tbl_Sob.FDAT >= hWndForm.Tbl_Sob.dDat
					                                                       Set hWndForm.Tbl_Sob.bFL_Edit = TRUE
				                                                       Else 
					                                                       Set hWndForm.Tbl_Sob.bFL_Edit = FALSE
				                                                       Call Sel017t( hWndForm, 'Подробности о событии ', 
						hWndForm.Tbl_Sob.bTmp, 
						hWndForm.Tbl_Sob.sAIM, 
						hWndForm.Tbl_Sob.bFL_Edit )
				                                                       If Tbl_Sob.bTmp and Tbl_Sob.bFL_Edit
					                                                       Set Tbl_Sob.TXT = Tbl_Sob.sAIM
					                                                       If SqlPrepareAndExecute( hSql(), "select id from cc_sob WHERE id=:Tbl_Sob.ID" ) 
							and SqlFetchNext(hSql(), nFetchRes) 
						                                                       Set Tbl_Sob.sTmpT = Tbl_Sob.strSqlUpdate
						                                                       Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
					                                                       Else 
						                                                       Set Tbl_Sob.sTmpT = Tbl_Sob.strSqlInsert
						                                                       Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
					                                                       If SqlPrepareAndExecute( hSql(), Tbl_Sob.sTmpT )
						                                                       Call SqlCommit( hSql() )
					                                                       Else 
						                                                       Call SqlRollback(hSql())
				                                                       Call SalWaitCursor(FALSE)
			On SAM_RowSetContext
				Call hWndForm.Tbl_Sob.F_DISA()
			On SAM_SetFocus
				Call hWndForm.Tbl_Sob.F_DISA()
			!
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call NASELENIE()
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
			On UM_Insert
				Call SalSendClassMessage(UM_Insert, 0, 0)
				Set Tbl_Sob.FDAT=GetBankDate()
	Table Window: Tbl_Zay
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Претенденты (заявки) на кредит
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.1"
				Top:    0.729"
				Width:  16.933"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.512"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Нова заявка'
						! On SAM_Click
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        If not IsWindow (hWinZ1)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Set hWinZ1 = SalCreateWindow( Frm_Zay, hWndMDI, nTip_Ur)
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Else 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Call SalBringWindowToTop ( hWinZ1 )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.567"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.05"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.533"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12460
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  6.317"
						Begin Y:  0.036"
						End X:  6.317"
						End Y:  0.5"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.017"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.5"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.95"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Печать заявки'
						On SAM_Click
							Call PrintZAYData()
				Line
					Resource Id: 12461
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.65"
						Begin Y:  0.036"
						End X:  5.65"
						End Y:  0.5"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.433"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12462
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pb_Kli ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт клиента-ссудозаемщика'
						On SAM_Click
							If CUSTTYPE=2 and RNK >0
								If CC_FL_ACC = '1'
									Call EditCustCorps( RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else
									Call EditCustCorps( RNK, CVIEW_ReadOnly , hWndMDI)
							Else If CUSTTYPE=3 and RNK > 0
								If CC_FL_ACC = '1'
									Call EditCustPerson( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else
									Call EditCustPerson( RNK , CVIEW_ReadOnly , hWndMDI)
							!
				Pushbutton: pbAcc ! Все СЧета
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.467"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Открытые счета клиента'
						On SAM_Click
							Call ShowCustAccountsEx(Tbl_Zay.RNK)
				Pushbutton: pb_T8
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахунок ІНТЕГРОВАНОГО показника фін/стану позичальника' 
						On SAM_Click
							If FIN_2 = STRING_Null
								Call MessageError( "Не установлено модуль
										"|| strTip )
							Else
								If Val(OKPO) > 0
									Call DEPO( hWndMDI, IifN(nTip_Ur =90 ,-1,0), Val(OKPO) )
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показать Актуальные/НеАктуальные заявки' )
						On SAM_Click
							If pb_Clos or nTip_Ur =90  !! 'Полный просмотр (Без транзакций)'
								Call F_DISA( )
							Else
								Call F_ENA( )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: sKLA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Классиф.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(hSql(), 
								"SELECT name,id INTO :hWndForm.Tbl_Zay.sTmp, :hWndForm.Tbl_Zay.nKla FROM cc_KLA")
							Set hWndForm.Tbl_Zay.nTmp=0
							Call SalArraySetUpperBound( hWndForm.Tbl_Zay.mKla, 1, -1)
							Call SalListClear(hWndItem)
							While SqlFetchNext(hSql(), nFetchRes)
								Call SalListAdd(hWndItem, hWndForm.Tbl_Zay.sTmp)
								Set hWndForm.Tbl_Zay.mKla[hWndForm.Tbl_Zay.nTmp] = hWndForm.Tbl_Zay.nKla
								Set hWndForm.Tbl_Zay.nTmp = hWndForm.Tbl_Zay.nTmp + 1
					On SAM_Validate
						Set hWndForm.Tbl_Zay.nTmp = SalListQuerySelection(hWndItem)
						Set hWndForm.Tbl_Zay.KLA = IifN( 
								hWndForm.Tbl_Zay.nTmp >=0, 
								hWndForm.Tbl_Zay.mKla[hWndForm.Tbl_Zay.nTmp], 0)
						Return VALIDATE_Ok
			Column: KLA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Классиф
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  2.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						ввода
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  0.817"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Отделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						Отделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фио
						исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.
						№
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Return hWndForm.Tbl_Zay.F_RNK(hWndForm.Tbl_Zay.RNK)
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заемщик
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set hWndForm.Tbl_Zay.sTmp=Str(hWndForm.Tbl_Zay.RNK)
						Call FunNSIGet('CUSTOMER','NMK',hWndForm.Tbl_Zay.sTmp, hWndForm.Tbl_Zay.NMK )
						Set hWndForm.Tbl_Zay.RNK=Val(hWndForm.Tbl_Zay.sTmp)
						Call SalSendMsg( hWndForm.Tbl_Zay.RNK, SAM_Validate, 0, 0 )
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ОКПО
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CUSTTYPE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2-ЮЛ
						23-ЧП
						3-ФЛ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						заявки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If hWndForm.Tbl_Zay.DATZ = DATETIME_Null
							Set hWndForm.Tbl_Zay.DATZ = hWndForm.Tbl_Zay.bDat
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SOS
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.65"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Статус
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If hWndForm.Tbl_Zay.SOS = 0 OR hWndForm.Tbl_Zay.SOS=2 OR hWndForm.Tbl_Zay.SOS=4
							Set hWndForm.Tbl_Zay.sTmp = STRING_Null
							Call FunNSIGetFiltered
									("CC_sos", "NAME", " sos > " || Str(hWndForm.Tbl_Zay.SOS) ||" and sos<=6 ", 
									hWndForm.Tbl_Zay.sTmp, hWndForm.Tbl_Zay.sSOS )
							If hWndForm.Tbl_Zay.sTmp !=STRING_Null
								Set hWndForm.Tbl_Zay.SOS = Val(hWndForm.Tbl_Zay.sTmp)
								Call SalTblSetRowFlags(hWndForm,SalTblQueryContext(hWndForm), ROW_Edited,TRUE )
								If hWndForm.Tbl_Zay.DATZ = DATETIME_Null OR hWndForm.Tbl_Zay.DATZ < hWndForm.Tbl_Zay.bDat
									Set hWndForm.Tbl_Zay.DATU = hWndForm.Tbl_Zay.bDat 
			Column: DATU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						утв(отк)
						на Ан/КК
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						закл.КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						займа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.65"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Конт.
						тел.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Примечания
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  3.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Popup Edit
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_RNK
				Description:
				Returns
					Boolean:
				Parameters
					Number: nRNK
				Static Variables
				Local variables
				Actions
					If nRNK > 0
						Return 
								 SqlPrepareAndExecute( hSql(),
								  "SELECT c.okpo, c.nmk, 
								    decode( c.CUSTTYPE,3,decode(c.sed,91,23,3),c.CUSTTYPE), 
								    substr( LTRIM(RTRIM(decode( c.CUSTTYPE,2,u.telr||','||u.telb, f.teld||','||f.telw))),1, 41)
								   INTO :hWndForm.Tbl_Zay.OKPO, :hWndForm.Tbl_Zay.NMK, 
								        :hWndForm.Tbl_Zay.CUSTTYPE, :hWndForm.Tbl_Zay.TEL
								   FROM customer c, corps u, person f
								   WHERE c.DATE_OFF is null and c.rnk=:nRNK 
								     and c.rnk=u.rnk (+) and c.rnk=f.rnk (+) " )
								and SqlFetchNext(hSql(), nFetchRes)
					Return TRUE
			Function: F_DISA
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbAcc )
					Call SalDisableWindow( pbUpdate )
			Function: F_ENA
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.Tbl_Zay.nTip_Ur != 90 
						Call SalEnableWindow( pbIns )
						Call SalEnableWindow( pbDel )
						Call SalEnableWindow( pbAcc )
						Call SalEnableWindow( pbUpdate )
			Function: PrintZAYData
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					String: sTemplateId
					Long String: sDoc
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
					String: sValue
				Actions
					If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
							" ID LIKE 'CCZAY_%' ", sTemplateId )
						Return 0
					If sTemplateId
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc = cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId, 
									 hWndForm.Tbl_Zay.NZ, 0)
							If sDoc
								Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: CC_ZAY_YES
			String: sFilter
			String: sTmp
			Number: nTmp
			Boolean: bTmp
			String: sSql
			Number: nRow
			Number: nCol
			Date/Time: bDat
			!
			Number: mKla[*]
			Number: nKla
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Претенденты (заявки) на кредит ' || strPar02  )
				Call ShowApdVersion('00')
				Set hWndForm.Tbl_Zay.strPrintFileName = 'СС_ZAY'
				Set hWndForm.Tbl_Zay.strFilterTblName = 'CC_ZAYV'
				Set hWndForm.Tbl_Zay.fFilterAtStart = 1
				Set hWndForm.Tbl_Zay.nTabInstance = 1
				Call SalDisableWindow( pbAcc )
				If CC_FL_ACC = '1'
					Call SalEnableWindow( pbAcc )
				!
				Set hWndForm.Tbl_Zay.bDat = GetBankDate()
				If hWndForm.Tbl_Zay.nTip_Ur =90  !! 'Полный просмотр (Без транзакций)'
					Call hWndForm.Tbl_Zay.F_DISA( )
				If SqlPrepareAndExecute( hSql(),
						"SELECT TO_NUMBER(pul.Get_Mas_Ini_Val('CC_ZAY_YES'))
						 INTO :hWndForm.Tbl_Zay.CC_ZAY_YES from dual " )
						and SqlFetchNext( hSql(), nFetchRes)
					If hWndForm.Tbl_Zay.CC_ZAY_YES='1'
						Call SalEnableWindow( pbIns )
						Call SalEnableWindow( pbDel )
						Call SalEnableWindow( pbUpdate )
				Call SalTblSetLockedColumns( hWndForm, 5 )
				If nHaveTOBO = 2
					Call SalHideWindow( BRANCH )
					Call SalHideWindow( SBRANCH )
					Set hWndForm.Tbl_Zay.sSql =
							 "SELECT CC_ZAYV.sos,CC_ZAYV.KLA, k.NAME, 
							        CC_ZAYV.okpo,CC_ZAYV.FDAT,CC_ZAYV.ID, CC_ZAYV.FIO, CC_ZAYV.RNK,
							        CC_ZAYV.NMK, CC_ZAYV.CUSTTYPE, CC_ZAYV.TEL, CC_ZAYV.S, CC_ZAYV.KV, CC_ZAYV.NZ, 
							        CC_ZAYV.TXT, CC_ZAYV.DATZ, CC_ZAYV.DATU, CC_ZAYV.DATW, s.name,
							        CC_ZAYV.BRANCH, b.name 
							 INTO :hWndForm.Tbl_Zay.SOS, :hWndForm.Tbl_Zay.KLA, :hWndForm.Tbl_Zay.sKLA,
							      :hWndForm.Tbl_Zay.OKPO,:hWndForm.Tbl_Zay.FDAT,:hWndForm.Tbl_Zay.ID,
							      :hWndForm.Tbl_Zay.FIO, :hWndForm.Tbl_Zay.RNK, :hWndForm.Tbl_Zay.NMK,
							      :hWndForm.Tbl_Zay.CUSTTYPE, :hWndForm.Tbl_Zay.TEL, :hWndForm.Tbl_Zay.S,
							      :hWndForm.Tbl_Zay.KV,  :hWndForm.Tbl_Zay.NZ,  :hWndForm.Tbl_Zay.TXT,
							      :hWndForm.Tbl_Zay.DATZ,:hWndForm.Tbl_Zay.DATU,:hWndForm.Tbl_Zay.DATW,
							      :hWndForm.Tbl_Zay.sSOS,:hWndForm.Tbl_Zay.BRANCH,:hWndForm.Tbl_Zay.SBRANCH 
							 FROM CC_ZAYV, cc_sos s , cc_kla k, BRANCH b
							 WHERE CC_ZAYV.BRANCH = b.BRANCH (+) 
							   and CC_ZAYV.sos = s.sos and CC_ZAYV.SOS <7 and CC_ZAYV.kla =k.id (+) "
				Else
					Set hWndForm.Tbl_Zay.sSql =
							 "SELECT CC_ZAYV.sos,CC_ZAYV.KLA, k.NAME, 
							        CC_ZAYV.okpo,CC_ZAYV.FDAT,CC_ZAYV.ID, CC_ZAYV.FIO, CC_ZAYV.RNK,
							        CC_ZAYV.NMK, CC_ZAYV.CUSTTYPE, CC_ZAYV.TEL, CC_ZAYV.S, CC_ZAYV.KV, CC_ZAYV.NZ, 
							        CC_ZAYV.TXT, CC_ZAYV.DATZ, CC_ZAYV.DATU, CC_ZAYV.DATW, s.name
							 INTO :hWndForm.Tbl_Zay.SOS, :hWndForm.Tbl_Zay.KLA, :hWndForm.Tbl_Zay.sKLA,
							      :hWndForm.Tbl_Zay.OKPO,:hWndForm.Tbl_Zay.FDAT,:hWndForm.Tbl_Zay.ID,
							      :hWndForm.Tbl_Zay.FIO, :hWndForm.Tbl_Zay.RNK, :hWndForm.Tbl_Zay.NMK,
							      :hWndForm.Tbl_Zay.CUSTTYPE, :hWndForm.Tbl_Zay.TEL, :hWndForm.Tbl_Zay.S,
							      :hWndForm.Tbl_Zay.KV,  :hWndForm.Tbl_Zay.NZ,  :hWndForm.Tbl_Zay.TXT,
							      :hWndForm.Tbl_Zay.DATZ,:hWndForm.Tbl_Zay.DATU,:hWndForm.Tbl_Zay.DATW,
							      :hWndForm.Tbl_Zay.sSOS
							 FROM CC_ZAYV, cc_sos s , cc_kla k
							 WHERE CC_ZAYV.sos = s.sos and CC_ZAYV.SOS <7 and CC_ZAYV.kla =k.id (+) "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If hWndForm.Tbl_Zay.fFilterAtStart
					Set hWndForm.Tbl_Zay.fFilterAtStart = NOT hWndForm.Tbl_Zay.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				Call SalWaitCursor(TRUE)
				Set hWndForm.Tbl_Zay.sFilter = cF.GetFilterWhereClause( FALSE )
				Set hWndForm.Tbl_Zay.strSqlPopulate = 
						hWndForm.Tbl_Zay.sSql ||  
						IifS (hWndForm.Tbl_Zay.sFilter = "", "", " and " || hWndForm.Tbl_Zay.sFilter ) || 
						IifS (hWndForm.Tbl_Zay.pb_Clos, 
						" and ( CC_ZAYV.SOS in (1,3,5) or CC_ZAYV.DATW is not null ) ",
						" and ( CC_ZAYV.SOS in (0,2,4,6) and CC_ZAYV.DATW is null )") ||
						" ORDER BY nz "
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_Zay.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Call SalWaitCursor(TRUE)
				Set hWndForm.Tbl_Zay.nRow = TBL_MinRow
				Set hWndForm.Tbl_Zay.bTmp = FALSE
				While SalTblFindNextRow(hWndForm, hWndForm.Tbl_Zay.nRow,  ROW_New | ROW_Edited | ROW_MarkDeleted, 0)
					Call SalTblSetContext(hWndForm, hWndForm.Tbl_Zay.nRow)
					! Удаление
					If SalTblQueryRowFlags ( hWndForm, hWndForm.Tbl_Zay.nRow, ROW_MarkDeleted )
						Set hWndForm.Tbl_Zay.bTmp = 
								SqlPrepareAndExecute( hSql(),
								 "DELETE FROM CC_ZAY WHERE nz=:hWndForm.Tbl_Zay.NZ ") 
								and SqlPrepareAndExecute( hSql(), 
								 "DELETE FROM nd_txt WHERE tag='ZAY' and nd=:hWndForm.Tbl_Zay.NZ ") 
								and SqlCommitEx(hSql(),'Удалена заявка на кредит № '||Str(NZ))
					! Вставка
					Else If SalTblQueryRowFlags ( hWndForm, hWndForm.Tbl_Zay.nRow, ROW_New )
						If SqlPrepareAndExecute( hSql(),
								    "SELECT S_CC_DEAL.NEXTVAL into :Tbl_Zay.nTmp from dual ")
								 and SqlFetchNext(hSql(), nFetchRes) 
							If SqlPrepareAndExecute( hSql(),
									    "INSERT INTO CC_ZAY (FDAT,ID,RNK,TEL,S,KV,NZ,NMK,CUSTTYPE, DATZ, sos, kla ) VALUES
									     (sysdate, USER_ID,
									      :hWndForm.Tbl_Zay.RNK, :hWndForm.Tbl_Zay.TEL,  :hWndForm.Tbl_Zay.S, 
									      :hWndForm.Tbl_Zay.KV,  :hWndForm.Tbl_Zay.nTmp,
									      decode(:hWndForm.Tbl_Zay.RNK, 0, :hWndForm.Tbl_Zay.NMK,      to_char(null) ),
									      decode(:hWndForm.Tbl_Zay.RNK, 0, :hWndForm.Tbl_Zay.CUSTTYPE, to_number(null)), 
									      :hWndForm.Tbl_Zay.DATZ, :hWndForm.Tbl_Zay.SOS, :hWndForm.Tbl_Zay.KLA) ") 
								If SqlPrepareAndExecute( hSql(),
										   "INSERT INTO nd_txt(nd,tag,txt) VALUES (
										    :hWndForm.Tbl_Zay.nTmp, 'ZAY', :hWndForm.Tbl_Zay.TXT) ") 
									Call SqlCommitEx(hSql(),'Введена заявка на кредит № '||Str(hWndForm.Tbl_Zay.NZ))
					! Модификация
					Else If SalTblQueryRowFlags ( hWndForm, hWndForm.Tbl_Zay.nRow, ROW_Edited )
						Set hWndForm.Tbl_Zay.bTmp=
								SqlPrepareAndExecute( hSql(),
								  "UPDATE CC_ZAY
								     Set RNK=:hWndForm.Tbl_Zay.RNK,
								         TEL=:hWndForm.Tbl_Zay.TEL,
								         S  =:hWndForm.Tbl_Zay.S,
								         KV =:hWndForm.Tbl_Zay.KV,
								         nmk=     decode(:hWndForm.Tbl_Zay.RNK, 0, :hWndForm.Tbl_Zay.NMK,      to_char(null) ),
								         custtype=decode(:hWndForm.Tbl_Zay.RNK, 0, :hWndForm.Tbl_Zay.CUSTTYPE, to_number(null) ),
								         DATZ=:hWndForm.Tbl_Zay.DATZ,
								         DATU=:hWndForm.Tbl_Zay.DATU,
								         DATW=:hWndForm.Tbl_Zay.DATW,
								         SOS =:hWndForm.Tbl_Zay.SOS, 
								         KLA =:hWndForm.Tbl_Zay.KLA 
								   where nz  =:hWndForm.Tbl_Zay.NZ " ) and
								SqlPrepareAndExecute( hSql(),
								  "UPDATE nd_txt Set 
								   txt=:hWndForm.Tbl_Zay.TXT WHERE nd=:hWndForm.Tbl_Zay.NZ and tag='ZAY' ") and
								SqlCommitEx(hSql(),'Изменена заявка на кредит № '||Str(hWndForm.Tbl_Zay.NZ))
					If not hWndForm.Tbl_Zay.bTmp
						Call SqlRollback(hSql())
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If hWndForm.Tbl_Zay.SOS > 0
					If hWndForm.Tbl_Zay.SOS = 1
						Set hWndForm.Tbl_Zay.nCol = SalColorFromRGB( 255,240,255 )
					Else If hWndForm.Tbl_Zay.SOS = 2
						Set hWndForm.Tbl_Zay.nCol = SalColorFromRGB( 230,255,230 )
					Else If hWndForm.Tbl_Zay.SOS = 3
						Set hWndForm.Tbl_Zay.nCol = SalColorFromRGB( 255,210,250 )
					Else If hWndForm.Tbl_Zay.SOS = 4
						Set hWndForm.Tbl_Zay.nCol = COLOR_LightGreen
					Else If hWndForm.Tbl_Zay.SOS = 5
						Set hWndForm.Tbl_Zay.nCol = COLOR_Salmon
					Else If hWndForm.Tbl_Zay.SOS = 6  and DATW = DATETIME_Null
						Set hWndForm.Tbl_Zay.nCol = SalColorFromRGB( 255,255,180)
					Else
						Set hWndForm.Tbl_Zay.nCol = COLOR_LightGray
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Zay.sSOS, hWndForm.Tbl_Zay.nCol )
	Table Window: Tbl_Sob_All
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Общий Календарь событий 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    0.917"
				Width:  13.533"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.7"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54602
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.65"
						Begin Y:  -0.024"
						End X:  3.65"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.15"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.017"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Все события по выбранному КД'
						On SAM_Click
							If hWndForm.Tbl_Sob_All.ND != NUMBER_Null
								Call Sel017f(hWndMDI,
										hWndForm.Tbl_Sob_All.nTip_Ur, 16, 
										hWndForm.Tbl_Sob_All.ND, 
										hWndForm.Tbl_Sob_All.CC_ID, 
										hWndForm.Tbl_Sob_All.NMK, '','','' )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.45"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54603
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.983"
						Begin Y:  -0.024"
						End X:  2.983"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.117"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54604
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Несистемные
					Window Location and Size
						Left:   4.167"
						Top:    0.119"
						Width:  1.917"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: DAT_s
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.25"
							Top:    0.083"
							Width:  1.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call F_DAT()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Начало периода для анализа' )
				Data Field: DAT_po
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.85"
							Top:    0.083"
							Width:  1.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call F_DAT()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Конец периода для анализа' )
		Contents
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FACT_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-
						Дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIFF_DAY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Откл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						 КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sISPK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Инспектор
						по договору
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nISPK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						инсп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						 КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заемщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Исполнитель
						по событию
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отметка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(hSql(), 
								  "SELECT name,otm INTO :Tbl_Sob_All.sTmp,:Tbl_Sob_All.nOtm FROM cc_otm ORDER by otm ")
							Set Tbl_Sob_All.nTmp=0
							Call SalArraySetUpperBound(Tbl_Sob_All.mOtm, 1, -1)
							Call SalListClear(hWndItem)
							While SqlFetchNext(hSql(), nFetchRes)
								Call SalListAdd(hWndItem, Tbl_Sob_All.sTmp)
								Set Tbl_Sob_All.mOtm[Tbl_Sob_All.nTmp] = Tbl_Sob_All.nOtm
								Set Tbl_Sob_All.nTmp = Tbl_Sob_All.nTmp + 1
					On SAM_Validate
						Set hWndForm.Tbl_Sob_All.nTmp = SalListQuerySelection(hWndItem)
						Set hWndForm.Tbl_Sob_All.OTM = IifN ( 
								hWndForm.Tbl_Sob_All.nTmp >=0,
								hWndForm.Tbl_Sob_All.mOtm[hWndForm.Tbl_Sob_All.nTmp], 0)
						! при несист событиях и ометке о выполнении 6, 
								  генерировать это же событие на ближайшую дату согласно периоду
								  с учетом выходных (после - для ежедневных, до - для остальных ),
								  но не более конца дог - для периодичности 1, 3 5 7 180 360
						Set hWndForm.Tbl_Sob_All.dTmp = DATETIME_Null
						If hWndForm.Tbl_Sob_All.nSYS >=0 and hWndForm.Tbl_Sob_All.OTM = 6 
							If hWndForm.Tbl_Sob_All.FREQ = 1 ! Ежедневно
								Set hWndForm.Tbl_Sob_All.dTmp = CorrectDate(
										hWndForm.Tbl_Sob_All.n980, 
										hWndForm.Tbl_Sob_All.FDAT, 
										hWndForm.Tbl_Sob_All.FDAT + 1 )
							Else If hWndForm.Tbl_Sob_All.FREQ = 3 ! Еженедельно
								Set hWndForm.Tbl_Sob_All.dTmp = hWndForm.Tbl_Sob.FDAT + 7
								Set hWndForm.Tbl_Sob_All.dTmp = CorrectDate(
										hWndForm.Tbl_Sob_All.n980, 
										hWndForm.Tbl_Sob_All.dTmp, 
										hWndForm.Tbl_Sob_All.dTmp -1 )
							Else If hWndForm.Tbl_Sob_All.FREQ = 5 ! Ежемесячно
								Set hWndForm.Tbl_Sob_All.dTmp = AddMonths( hWndForm.Tbl_Sob_All.FDAT ,1) 
								Set hWndForm.Tbl_Sob_All.dTmp = CorrectDate(
										hWndForm.Tbl_Sob_All.n980, 
										hWndForm.Tbl_Sob_All.dTmp, 
										hWndForm.Tbl_Sob_All.dTmp - 1 )
							Else If hWndForm.Tbl_Sob_All.FREQ = 7 ! Ежеквартально
								Set hWndForm.Tbl_Sob_All.dTmp = AddMonths( hWndForm.Tbl_Sob_All.FDAT, 3 ) 
								Set hWndForm.Tbl_Sob_All.dTmp = CorrectDate(
										hWndForm.Tbl_Sob_All.n980, 
										hWndForm.Tbl_Sob_All.dTmp, 
										hWndForm.Tbl_Sob_All.dTmp - 1 )
							Else If hWndForm.Tbl_Sob_All.FREQ = 180 ! Полугодие
								Set hWndForm.Tbl_Sob_All.dTmp = AddMonths( hWndForm.Tbl_Sob_All.FDAT ,6) 
								Set hWndForm.Tbl_Sob_All.dTmp = CorrectDate(
										hWndForm.Tbl_Sob_All.n980, 
										hWndForm.Tbl_Sob_All.dTmp, 
										hWndForm.Tbl_Sob_All.dTmp - 1 )
							Else If hWndForm.Tbl_Sob_All.FREQ = 360 ! Год
								Set hWndForm.Tbl_Sob_All.dTmp = AddMonths( hWndForm.Tbl_Sob_All.FDAT ,12) 
								Set hWndForm.Tbl_Sob_All.dTmp = CorrectDate(
										hWndForm.Tbl_Sob_All.n980, 
										hWndForm.Tbl_Sob_All.dTmp, 
										hWndForm.Tbl_Sob_All.dTmp - 1 )
							If hWndForm.Tbl_Sob_All.dTmp != DATETIME_Null 
								If SqlPrepareAndExecute( hSql(),
										 "INSERT INTO cc_sob (ND,FDAT,ISP,TXT, psys, freq ) VALUES 
										(:hWndForm.Tbl_Sob_All.ND, :hWndForm.Tbl_Sob_All.dTmp, null,
										 :hWndForm.Tbl_Sob_All.TXT, :hWndForm.Tbl_Sob_All.nSYS, :hWndForm.Tbl_Sob_All.FREQ )" )
									Call SqlCommit( hSql() )
								Else
									Call SqlRollback( hSql() )
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  10.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On UM_DoubleClick
						Set hWndForm.Tbl_Sob_All.sAIM = hWndForm.Tbl_Sob_All.TXT 
						Set hWndForm.Tbl_Sob_All.bTmp = FALSE
						Call Sel017t(
								hWndForm, 'Подробности о событии ',
								hWndForm.Tbl_Sob_All.bTmp, 
								hWndForm.Tbl_Sob_All.sAIM, FALSE )
						Call SalWaitCursor(FALSE)
			Column: nSYS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FREQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.Tbl_Sob_All.DAT_s > hWndForm.Tbl_Sob_All.DAT_po 
						Call SalMessageBox('Дата-1 больше Дата-2 !' ,"В Н И М А Н И Е ! ", MB_IconStop)
						Set hWndForm.Tbl_Sob_All.DAT_po = AddMonths( hWndForm.Tbl_Sob.DAT_s, 1 )
		Window Parameters
			Number: nTip_Par
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nUser
			Date/Time: dDat
			Boolean: bTmp
			Long String: sAIM
			Number: bFL_Edit
			String: sTmpT
			Number: nCustType
			Number: nTip_Ur
			! Number: nDostup
			Number: nId
			String: sId
			Number: nTmp
			Number: nOtm
			String: sTmp
			String: sSql
			String: WHE2
			Number: mOtm[*]
			Number: mFreq[*]
			Date/Time: dTmp
			Number: n980
			Number: nTp_Kl
			Number: nTp_Fun
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Общий Календарь событий ' || strPar02 )
				Call ShowApdVersion('10')
				Set hWndForm.Tbl_Sob_All.nTp_Kl = SalNumberMod( hWndForm.Tbl_Sob_All.nTip_Par, 10 )
				Set hWndForm.Tbl_Sob_All.cb1 = TRUE
				Set hWndForm.Tbl_Sob_All.nTp_Fun = hWndForm.Tbl_Sob_All.nTip_Par - hWndForm.Tbl_Sob_All.nTp_Kl
				Set hWndForm.Tbl_Sob_All.strPrintFileName = 'СС_SALL'
				Set hWndForm.Tbl_Sob_All.nTabInstance = 1
				If hWndForm.Tbl_Sob_All.nTp_Fun  > 20 ! Бухгалтер
					Call SalDisableWindow( pbUpdate )
				Set hWndForm.Tbl_Sob_All.strFilterTblName = 'V_CC_SOB'
				Call SalTblSetLockedColumns( hWndForm, 10 )
				Set hWndForm.Tbl_Sob_All.dDat  = GetBankDate()
				Set hWndForm.Tbl_Sob_All.DAT_po = hWndForm.Tbl_Sob_All.dDat
				Set hWndForm.Tbl_Sob_All.DAT_s = hWndForm.Tbl_Sob_All.dDat
				! nTip_Par = 2,3   12,13   22,23 
				Set hWndForm.Tbl_Sob_All.nCustType= SalNumberMod( hWndForm.Tbl_Sob_All.nTip_Par, 10 )
				Set hWndForm.Tbl_Sob_All.nTip_Ur  = hWndForm.Tbl_Sob_All.nTip_Par - hWndForm.Tbl_Sob_All.nCustType
				! nPar = 0, 1
				Set hWndForm.Tbl_Sob_All.nId = GetUserId()
				Set hWndForm.Tbl_Sob_All.sId = Str(hWndForm.Tbl_Sob_All.nId)
				Set hWndForm.Tbl_Sob_All.n980 = GetBaseVal()
				! Set hWndForm.Tbl_Sob_All.strSqlUpdate =
						"UPDATE cc_sob Set otm=:hWndForm.Tbl_Sob_All.OTM WHERE 
						 id=:hWndForm.Tbl_Sob_All.ID and :hWndForm.Tbl_Sob_All.FDAT >= :hWndForm.Tbl_Sob_All.dDat "
				Set hWndForm.Tbl_Sob_All.strSqlUpdate =
						"UPDATE cc_sob Set otm=:hWndForm.Tbl_Sob_All.OTM WHERE 
						 id=:hWndForm.Tbl_Sob_All.ID "
				!
				Set hWndForm.Tbl_Sob_All.sSql =
						"SELECT TO_date(V_CC_SOB.fdat, 'dd/mm/yyyy'), 
						        V_CC_SOB.nd, V_CC_SOB.cc_id, 
						        V_CC_SOB.NMK, s.fio, V_CC_SOB.txt, 
						        o.name, V_CC_SOB.INSP, sk.fio,
						        nvl(V_CC_SOB.psys,0), V_CC_SOB.freq, V_CC_SOB.id,
						        V_CC_SOB.ND,
						        TO_date(V_CC_SOB.FACT_DATE, 'dd/mm/yyyy'),
						        V_CC_SOB.DIFF_DAYS 
						 INTO :hWndForm.Tbl_Sob_All.FDAT, :hWndForm.Tbl_Sob_All.ND,   :hWndForm.Tbl_Sob_All.CC_ID,
						      :hWndForm.Tbl_Sob_All.NMK,  :hWndForm.Tbl_Sob_All.sISP, :hWndForm.Tbl_Sob_All.TXT,
						      :hWndForm.Tbl_Sob_All.sOTM, :hWndForm.Tbl_Sob_All.nISPK,:hWndForm.Tbl_Sob_All.sISPK,
						      :hWndForm.Tbl_Sob_All.nSYS, :hWndForm.Tbl_Sob_All.FREQ, :hWndForm.Tbl_Sob_All.ID,
						      :hWndForm.Tbl_Sob_All.ND,
						      :hWndForm.Tbl_Sob_All.FACT_DAT, 
						      :hWndForm.Tbl_Sob_All.DIFF_DAY  
						 FROM V_CC_SOB, staff s, cc_vidd v, 
						      cc_otm o, staff sk
						 WHERE sk.id = V_CC_SOB.INSP 
						   AND o.otm = V_CC_SOB.otm 
						   AND s.id(+)  = V_CC_SOB.isp 
						   AND TO_date(V_CC_SOB.fdat, 'dd/mm/yyyy') >= :hWndForm.Tbl_Sob_All.DAT_s 
						   AND TO_date(V_CC_SOB.fdat, 'dd/mm/yyyy') <= :hWndForm.Tbl_Sob_All.DAT_po 
						   AND V_CC_SOB.vidd = v.vidd and v.CUSTTYPE="||
						       Str(hWndForm.Tbl_Sob_All.nCustType) 
				If hWndForm.Tbl_Sob_All.nPar = 1 !! КП инспектора 
					Set Tbl_Sob_All.sSql = Tbl_Sob_All.sSql ||
							" and " || Tbl_Sob_All.sId || " in ( nvl(d.USER_id,0), nvl(CC_SOB.isp,0) )"
				Else If hWndForm.Tbl_Sob_All.nPar =2 !! КП начальника отдела
				Else If hWndForm.Tbl_Sob_All.nPar =0 !! КП общий
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If hWndForm.Tbl_Sob_All.FDAT < hWndForm.Tbl_Sob_All.dDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
				If hWndForm.Tbl_Sob_All.FDAT = hWndForm.Tbl_Sob_All.dDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )  ! голубой
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set hWndForm.Tbl_Sob_All.WHE2 = cF.GetFilterWhereClause( FALSE )
				If hWndForm.Tbl_Sob_All.cb1 
					Set hWndForm.Tbl_Sob_All.strSqlPopulate = 
							hWndForm.Tbl_Sob_All.sSql || ' and V_CC_SOB.psys>0 '
				Else
					Set hWndForm.Tbl_Sob_All.strSqlPopulate = 
							hWndForm.Tbl_Sob_All.sSql||
							' and (V_CC_SOB.psys<=0 or V_CC_SOB.psys is null) '
				Set 
						hWndForm.Tbl_Sob_All.strSqlPopulate = 
						hWndForm.Tbl_Sob_All.strSqlPopulate ||
						IifS( hWndForm.Tbl_Sob_All.WHE2 = STRING_Null, '' ,' AND ' || hWndForm.Tbl_Sob_All.WHE2 ) ||
						" ORDER BY 1,2 "
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_Sob_All.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
	Form Window: frm_Help
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.175"
				Top:    0.646"
				Width:  13.317"
				Width Editable? Yes
				Height: 7.286"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.512"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.933"
						Top:    0.107"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.583"
							Top:    0.107"
							Width:  1.433"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.107"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Print.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Печать справки'
						On SAM_Click
							! вызов функции печати календаря погашений
							Call SalWaitCursor(TRUE)
							Set strFa = GetPrnDir() || "\\H" || Str(ND) || ".txt"
							Set strREP = 'dCC_ID,dNMK,dSUMMA,dKV,dDAT_BEG,dDAT_END,KV,NLS,PR,OST,OSTN,OSTN1,OSTN2,OSTN3,OSTNK,'||
									'bDat,bDat1,bDat2,bDat3,bDatK'
							Set strCEN = 'dCC_ID,dNMK,dSUMMA,dKV,dDAT_BEG,dDAT_END,'||
									             'tb1.KV,tb1.NLS,tb1.PR,tb1.OST,tb1.OSTN,tb1.OSTN1,tb1.OSTN2,tb1.OSTN3,tb1.OSTNK,'||
									'bDat,bDat1,bDat2,bDat3,bDatK'
							! rtf
							If SalMessageBox("Желаете просмотреть справку  " || strFa || " в редакторе?",
									   "Отчет сформирован успешно!", MB_IconQuestion | MB_YesNo ) = IDYES
								Set strFa = GetPrnDir() || "\\H" || Str(ND) || ".rtf"
								Call SalReportPrintToFile(hWndForm,
										     GetTemplateDir() || "\\CC_HELPW.QRP",
										     strFa,
										     strCEN, strREP, 1, RPT_PrintAll, 1, 1, TRUE,
										     nInd)
								Call SalLoadApp (GetEditorPath(), strFa)
							Else
								Call SalReportPrintToFile(hWndForm,
										     GetTemplateDir() || "\\CC_HELP.QRP", strFa,
										     strCEN, strREP, 1, RPT_PrintAll, 1, 1, FALSE,
										     nInd)
							Call SalWaitCursor(FALSE)
				Data Field: bDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.033"
							Top:    0.107"
							Width:  1.983"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_Dat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.033"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить расчет на заданную дату'
						On SAM_Click
							Call NASELENIE()
		Contents
			Data Field: dCC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.567"
						Top:    0.071"
						Width:  10.9"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.567"
						Top:    0.369"
						Width:  10.9"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: Початок
				Resource Id: 8744
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.817"
					Top:    0.726"
					Width:  1.533"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dDAT_BEG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.717"
						Top:    0.929"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Вал
				Resource Id: 8743
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.533"
					Top:    0.726"
					Width:  0.717"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.517"
						Top:    0.929"
						Width:  0.783"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Ліміт осн.боргу
				Resource Id: 63425
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.533"
					Top:    0.726"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dLIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.4"
						Top:    0.929"
						Width:  2.067"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Основний борг
				Resource Id: 8742
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.683"
					Top:    0.726"
					Width:  1.85"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dSUMMA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.567"
						Top:    0.929"
						Width:  2.067"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Процентний борг
				Resource Id: 10873
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.75"
					Top:    0.726"
					Width:  1.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dSUMN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.733"
						Top:    0.929"
						Width:  2.067"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Завершення
				Resource Id: 8745
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.067"
					Top:    0.726"
					Width:  1.533"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dDAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.9"
						Top:    0.929"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Child Table: tb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.65"
						Top:    1.202"
						Width:  11.683"
						Width Editable? Yes
						Height: 4.833"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал 
								боргу
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Right
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рахунок 
								боргу
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: % 
								ст
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OST
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Залишок 
								осн.боргу
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.317"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Борг %
								на пот.дату
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.35"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTN1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: + 1
								день
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTN2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: + 2
								дні
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.367"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTN3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: + 3
								дні
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.25"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: В Кінці
								сроку
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.217"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: ItogKv
						Description:
						Returns
						Parameters
							Number: nKv1
						Static Variables
						Local variables
						Actions
							If nKv1 >0
								! 1
								Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))                               
								Set tb1.NLS='Разом'
								Set tb1.KV  = nKv1 
								Set tb1.OST   = iOST
								Set tb1.OSTN  = iOSTN
								Set tb1.OSTN1 = iOSTN1
								Set tb1.OSTN2 = iOSTN2
								Set tb1.OSTN3 = iOSTN3
								Set tb1.OSTNK = iOSTNK
								! 2
								Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))                               
								Set tb1.NLS='Сплачено'
								If SqlPrepareAndExecute(  hSqlAux2(), 
										"SELECT NVL( sum(s.kos)-sum(decode(a.tip,'SPN',s.dos,0)),0)/100
										 INTO :nTmp 
										 FROM accounts a, nd_acc n, saldoa S
										 WHERE a.tip in ('SN ','SPN') and a.acc=n.acc and n.nd=:ND 
										   and a.acc=S.acc and a.kv=:nKv1 " ) 
										and SqlFetchNext( hSqlAux2(), nFetchRes)
									Set tb1.KV  = nKv1 
									Set tb1.OSTN  =nTmp
									Set tb1.OSTN1 =nTmp
									Set tb1.OSTN2 =nTmp
									Set tb1.OSTN3 =nTmp
									Set tb1.OSTNK =nTmp
									! 3
									Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))                               
									Set tb1.NLS='До сплати'
									Set tb1.KV  = nKv1 
									Set tb1.OSTN  = iOSTN  - nTmp
									Call SalTblSetCellTextColor(tb1.OSTN, COLOR_Red, FALSE)
									Set tb1.OSTN1 = iOSTN1 - nTmp
									Set tb1.OSTN2 = iOSTN2 - nTmp
									Set tb1.OSTN3 = iOSTN3 - nTmp
									Set tb1.OSTNK = iOSTNK - nTmp
									Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))                               
									! Set tb1.NLS='---------'
							Set iOST  =0
							Set iOSTN =0
							Set iOSTN1=0
							Set iOSTN2=0
							Set iOSTN3=0
							Set iOSTNK=0
				Window Variables
					Number: nKv1
					Number: nKv
					Number: nAcc
					Number: nPr
					Number: nOst
					String: sNls
					!
					Number: nTmp
					Number: iOST
					Number: iOSTN
					Number: iOSTN1
					Number: iOSTN2
					Number: iOSTN3
					Number: iOSTNK
					! Number: ACC8
				Message Actions
					! On SAM_User
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set nKv1 = 0
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              If SqlPrepareAndExecute( hSqlAux(), 
								  "SELECT l.lim2/100, -(s.ostf-s.dos+s.kos)/100 , -cck.SUM_INT(:dKV,:ND,:bDat)/100 
								   INTO :dLIMIT, :dSUMMA, :dSUMN 
								   FROM cc_lim l, saldoa s 
								   WHERE s.acc=l.acc and l.nd=:ND and
								        (l.nd ,l.fdat)=(select  nd,max(fdat) from cc_lim where nd=:ND and fdat<=:bDat group by nd)
								    and (s.acc,s.fdat)=(select acc,max(fdat) from saldoa where acc=l.acc and fdat<=:bDat group by acc) ")
								and not SqlFetchNext( hSqlAux(), nFetchRes)
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set dSUMMA = nSUMMA
						!
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call SalTblSetLockedColumns( tb1, 8 )
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call SalTblReset ( tb1 )
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              If SqlPrepareAndExecute( hSqlAux(), 
								"SELECT a.kv, a.nls, a.acc, acrn.FPROCN(a.acc,0, :bDat ), 
								 -(s.ostf - s.dos + s.kos)/100          
								 INTO   :nKv, :sNls, :nAcc, :nPr, :nOst
								 FROM accounts a,  int_accn i, nd_acc d, saldoa s     
								 WHERE a.tip<>'LIM' AND a.acc=i.acc and i.id=0 and d.nd=:ND and a.acc=d.acc and
								       a.acc=s.acc and 
								      (s.acc,s.fdat)=(select acc,max(fdat) from saldoa where acc=a.acc and fdat<=:bDat group by acc) 
								 ORDER BY a.kv, a.nls" )
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              While SqlFetchNext( hSqlAux(), nFetchRes)
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              If nKv1 != nKv 
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call tb1.ItogKv (nKv1)  
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set nKv1=nKv
								!
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))                               
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.NLS = sNls
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.KV  = nKv 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.ACC = nAcc
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.PR  = nPr
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.OST = nOst
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.OSTN = -p_intN( tb1.ACC,0, DAT_BEG, bDat -1, NUMBER_Null, 0) /100 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.OSTN1= -p_intN( tb1.ACC,0, DAT_BEG, bDat1-1, NUMBER_Null, 0) /100 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.OSTN2= -p_intN( tb1.ACC,0, DAT_BEG, bDat2-1, NUMBER_Null, 0) /100 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.OSTN3= -p_intN( tb1.ACC,0, DAT_BEG, bDat3-1, NUMBER_Null, 0) /100 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set tb1.OSTNK= -p_intN( tb1.ACC,0, DAT_BEG, bDatK-1, NUMBER_Null, 0) /100 
								!
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set iOST  = iOST   + OST
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set iOSTN = iOSTN  + OSTN
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set iOSTN1= iOSTN1 + OSTN1
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set iOSTN2= iOSTN2 + OSTN2
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set iOSTN3= iOSTN3 + OSTN3
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set iOSTNK= iOSTNK + OSTNK
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call tb1.ItogKv (nKv1)  
					On SAM_User
						Set nKv1 = 0
						If SqlPrepareAndExecute( hSqlAux(), 
								  "SELECT l.lim2/100, -(s.ostf-s.dos+s.kos)/100 , -cck.SUM_INT(:dKV,:ND,:bDat)/100 
								   INTO :dLIMIT, :dSUMMA, :dSUMN 
								   FROM cc_lim l, saldoa s 
								   WHERE s.acc=l.acc and l.nd=:ND and
								        (l.nd ,l.fdat)=(select  nd,max(fdat) from cc_lim where nd=:ND and fdat<=:bDat group by nd)
								    and (s.acc,s.fdat)=(select acc,max(fdat) from saldoa where acc=l.acc and fdat<=:bDat group by acc) ")
								and not SqlFetchNext( hSqlAux(), nFetchRes)
							Set dSUMMA = nSUMMA
						!
						! Call Debug('1) dSUMMA='||Str(dSUMMA))
						Call SalTblSetLockedColumns( hWndForm, 8 )
						Call SalTblReset ( tb1 )
						Set ACRA1_ = - 11111
						If SqlPrepareAndExecute( hSqlAux(), 
								"SELECT a.kv, a.nls, a.acc, acrn.FPROCN(a.acc,0, :bDat ), 
								 -(s.ostf - s.dos + s.kos)/100, i.acr_dat, i.ACRA       
								 INTO   :nKv, :sNls, :nAcc, :nPr, :nOst, :ACR_DAT_, :ACRA_
								 FROM accounts a,  int_accn i, nd_acc d, saldoa s     
								 WHERE a.tip<>'LIM' AND a.acc=i.acc and i.id=0 and d.nd=:ND and a.acc=d.acc and
								       a.acc=s.acc and 
								      (s.acc,s.fdat)=(select acc,max(fdat) from saldoa where acc=a.acc and fdat<=:bDat group by acc) 
								 ORDER BY a.kv, i.ACRA, a.nls" )
							While SqlFetchNext( hSqlAux(), nFetchRes)
								If nKv1 != nKv 
									Call ItogKv (nKv1)  
									Set nKv1=nKv
								!
								Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))                               
								Set NLS = sNls
								Set KV  = nKv 
								Set ACC = nAcc
								Set PR  = nPr
								Set OST = nOst
								! Call Debug('2) nKv='||Str(nKv)|| ', sNls='||sNls||
										', nAcc='||Str(nAcc)||', nPr='||Str(nPr)||', nOst='||Str(nOst)||
										', ACR_DAT_='|| SalFmtFormatDateTime( ACR_DAT_, 'dd/MM/yyyy' )|| 
										', ACRA_='||Str(ACRA_))
								If ACR_DAT_ != DATETIME_Null
									If SqlPrepareAndExecute( hSqlAux2(),
											 "select sum(dos)/100 into :OSTN from saldoa where acc=:ACRA_ and fdat<= :bDat " )
											and SqlFetchNext( hSqlAux2(), nFetchRes)
									! Call Debug('3) OSTN='||Str(OSTN)|| 
											', bDat='|| SalFmtFormatDateTime( bDat, 'dd/MM/yyyy' )||
											', ACRA1_='||Str(ACRA1_))
									Set ACR_DAT_ = ACR_DAT_ + 1
									If ACRA1_ = ACRA_
										Set OSTN=0
									Else
										Set ACRA1_ = ACRA_
								Else
									Set OSTN = 0
									Set OSTN1 = 0
									Set OSTN2 = 0
									Set OSTN3 = 0
									Set OSTNK = 0
									Set ACR_DAT_ = DAT_BEG
								! Call Debug('4) ACR_DAT_='|| SalFmtFormatDateTime( ACR_DAT_, 'dd/MM/yyyy' )|| 
										', OSTN='||Str(OSTN)||
										', bDat='|| SalFmtFormatDateTime( bDat, 'dd/MM/yyyy' ) )
								If bDat > ACR_DAT_
									Set OSTN = OSTN -p_intN( ACC,0,ACR_DAT_,bDat -1,NUMBER_Null,0)/100 
									! Call Debug('5) OSTN='||Str(OSTN)||', bDat='|| SalFmtFormatDateTime( bDat, 'dd/MM/yyyy' ) )
								If bDat1 > ACR_DAT_
									Set OSTN1=OSTN -p_intN( ACC,0,ACR_DAT_,bDat1-1,NUMBER_Null,0)/100 
									! Call Debug('6) OSTN1='||Str(OSTN1)||', bDat1 ='|| SalFmtFormatDateTime( bDat1, 'dd/MM/yyyy' ) )
								If bDat2 > ACR_DAT_
									Set OSTN2=OSTN -p_intN( ACC,0,ACR_DAT_,bDat2-1,NUMBER_Null,0)/100 
									! Call Debug('7) OSTN2='||Str(OSTN2)||', bDat2 ='|| SalFmtFormatDateTime( bDat2, 'dd/MM/yyyy' ) )
								If bDat3 > ACR_DAT_
									Set OSTN3=OSTN -p_intN( ACC,0,ACR_DAT_,bDat3-1,NUMBER_Null,0)/100 
									! Call Debug('8) OSTN3='||Str(OSTN3)||', bDat3 ='|| SalFmtFormatDateTime( bDat3, 'dd/MM/yyyy' ) )
								If bDatK > ACR_DAT_
									Set OSTNK=OSTN -p_intN( ACC,0,ACR_DAT_,bDatK-1,NUMBER_Null,0)/100 
									! Call Debug('9) tb1.OSTNK='||Str(tb1.OSTNK)||', bDatK ='|| SalFmtFormatDateTime( bDatK, 'dd/MM/yyyy' ) )
								!
								Set iOST  = iOST   + OST
								Set iOSTN = iOSTN  + OSTN
								Set iOSTN1= iOSTN1 + OSTN1
								Set iOSTN2= iOSTN2 + OSTN2
								Set iOSTN3= iOSTN3 + OSTN3
								Set iOSTNK= iOSTNK + OSTNK
							Call ItogKv (nKv1)  
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set bDat1=bDat+1
					Set bDat2=bDat+2
					Set bDat3=bDat+3
					Set bDatK=DAT_END
					Call SalTblSetColumnTitle(  tb1.OSTN, '% на 
							'||SalFmtFormatDateTime( bDat, 'dd-MM-yyyy' ) )
					Call SalTblSetColumnTitle(  tb1.OSTN1,'% на 
							'||SalFmtFormatDateTime( bDat1, 'dd-MM-yyyy' ) )
					Call SalTblSetColumnTitle(  tb1.OSTN2,'% на 
							'||SalFmtFormatDateTime( bDat2, 'dd-MM-yyyy' ) )
					Call SalTblSetColumnTitle(  tb1.OSTN3,'% на 
							'||SalFmtFormatDateTime( bDat3, 'dd-MM-yyyy' ) )
					Call SalTblSetColumnTitle(  tb1.OSTNK,'% на 
							'||SalFmtFormatDateTime( bDatK, 'dd-MM-yyyy' ) )
					Call SalSendMsg( tb1, SAM_User, 0, 0 )
		Window Parameters
			Number: ND
			String: CC_ID
			String: NMK  
			Number: nSUMMA
			Number: KV
			Date/Time: DAT_BEG
			Date/Time: DAT_END
			!
		Window Variables
			Date/Time: ACR_DAT_
			Date/Time: bDat1
			Date/Time: bDat2
			Date/Time: bDat3
			Date/Time: bDatK
			String: strCEN
			String: strREP
			String: strFa
			Number: nInd
			Number: i
			Number: n980 
			Number: ACRA_
			Number: ACRA1_
		Message Actions
			On SAM_Create
				Set dND=ND
				Set n980 = GetBaseVal()
				Set dCC_ID='Довідка про стан кредитного договору '||CC_ID
				Call SalSetWindowText( hWndForm, dCC_ID )
				Call ShowApdVersion('14')
				! Call SalSetWindowText(tb1, dCC_ID  )
				Set dNMK=NMK
				! Set dSUMMA=SUMMA
				Set dKV=KV
				Set dDAT_BEG=DAT_BEG
				Set dDAT_END=DAT_END
				Set bDat = GetBankDate()
				Call NASELENIE()
			!
			On SAM_ReportStart
				Set i = TBL_MinRow
			On SAM_ReportFetchInit
				Return TRUE
			On SAM_ReportFetchNext
				If SalTblFindNextRow(tb1, i, 0, 0)
					Call SalTblFetchRow(tb1, i)
					Return TRUE
				Return FALSE
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
				Call DosDirectPrint(strFa)
	Table Window: Tbl_Lim
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Построение Графика Лимита Кредитования (ГЛК)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.525"
				Top:    0.958"
				Width:  16.3"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.786"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: nND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф. КД' )
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55259
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: FDAT_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.783"
							Top:    0.071"
							Width:  1.433"
							Width Editable? Yes
							Height: 0.31"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата начала построения ГЛК' )
						On SAM_Validate
							If hWndForm.Tbl_Lim.FDAT_ < hWndForm.Tbl_Lim.dDat 
								Call Debug('Ош.дата')
								Set hWndForm.Tbl_Lim.FDAT_ = hWndForm.Tbl_Lim.dDat 
				Pushbutton: pb_LIM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Sort.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'По(До)строить график погашения равными долями'
						On SAM_Click
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), 
									"CCK.CC_grf_LIM (1, hWndForm.Tbl_Lim.nND, hWndForm.Tbl_Lim.nAcc8, hWndForm.Tbl_Lim.FDAT_) " )
								Call SqlCommit( hSql() )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Else
								Call SqlRollback(hSql())
								Call MessageNoWait('Неуспешное построение графика', 'Ошибка', 0, 1)
							Call SalWaitCursor(FALSE)
				Pushbutton: pb_KAL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр Ожидаемого Графика Погашения Кредита (ГПК) выбранного КД'
						On SAM_Click
							Call Sel017f( hWndMDI, 
									 hWndForm.Tbl_Lim.nTip_Ur, 14,
									 hWndForm.Tbl_Lim.nPar,
									 hWndForm.Tbl_Lim.strPar01 || ' Вал.' || Str(hWndForm.Tbl_Lim.KV8), 
									 hWndForm.Tbl_Lim.strPar02, '', '', '' )
				Pushbutton: pbGPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.283"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F12
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Построение Графика Погашения Кредита (ГПК) выбранного КД'
						On SAM_Click
							Call Sel017f( hWndMDI, 
									hWndForm.Tbl_Lim.nTip_Ur, 12, 
									hWndForm.Tbl_Lim.nPar, 
									hWndForm.Tbl_Lim.strPar01, 
									hWndForm.Tbl_Lim.strPar02, '', '', '' )
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55260
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55261
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfFREQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.783"
							Top:    0.071"
							Width:  2.517"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Периодичность погашения КД' )
				Data Field: dfDAT3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.283"
							Top:    0.071"
							Width:  1.433"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата выдачи КД' )
				Background Text: ГЛК
					Resource Id: 61359
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   12.75"
						Top:    0.095"
						Width:  1.117"
						Width Editable? Yes
						Height: 0.393"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 14
					Font Enhancement: Bold-Italic-Underline
					Text Color: Blue
					Background Color: Default
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.31"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Клиент-Заемщик' )
				Data Field: D9129
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.783"
							Top:    0.405"
							Width:  1.433"
							Width Editable? Yes
							Height: 0.31"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дельта для отражения лимита на 9129' )
						On SAM_SetFocus
							Set hWndForm.Tbl_Lim.D9129_OLD = hWndForm.Tbl_Lim.D9129
						On SAM_KillFocus
							Call F_D9129( hWndForm.Tbl_Lim.nPar )
						! On SAM_Validate
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Call F_D9129( hWndForm.Tbl_Lim.nPar )
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Return VALIDATE_Ok
						!
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.183"
							Top:    0.405"
							Width:  6.083"
							Width Editable? Yes
							Height: 0.31"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dfDAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.283"
							Top:    0.405"
							Width:  1.433"
							Width Editable? Yes
							Height: 0.31"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения КД' )
		Contents
			Column: KV8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						Лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сч.
						Лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If hWndForm.Tbl_Lim.FDAT < hWndForm.Tbl_Lim.dDat 
							Set hWndForm.Tbl_Lim.FDAT = hWndForm.Tbl_Lim.FDAT_old
			Column: NOT_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пог.
						без
						 %
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						Лимита
						для 9129
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						Лимита
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.Tbl_Lim.LIM100 = hWndForm.Tbl_Lim.LIM2*100
			Column: NOT_9129
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не
						9129
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM_Y
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Использ.
						лимит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM_N
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Свободный
						лимит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SS(ссудн)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SP(просроч)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SL(сомнит)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SN(нач %)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SPN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SPN(проср.%)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SN8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SP8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_SG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						SG
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: acc
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						Лимита
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кор
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_GPK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: FLAGS2
				Actions
					Call SalWaitCursor(TRUE)
					! 1 - CC_LIM_GPK Расчитать суммы погашения Тела по суммам лимитов
					If SqlPLSQLCommand(hSql(),
							 "CCK.CC_LIM_GPK ( hWndForm.Tbl_Lim.nND, 
							                   hWndForm.Tbl_Lim.nAcc8, 
							                   hWndForm.Tbl_Lim.FDAT_
							                 )" )
						! 2 - cc_TMP_GPK Пересчитать прогноз процентов по новым суммам  лимитов
						If SqlPLSQLCommand(hSql(),
								"CCK.cc_TMP_GPK ( hWndForm.Tbl_Lim.nND, 
								                  hWndForm.Tbl_Lim.nVid, 
								                  hWndForm.Tbl_Lim.nAcc8, 
								                  hWndForm.Tbl_Lim.dfDAT3, 
								                  hWndForm.Tbl_Lim.dfDAT4, 
								                  FLAGS2, 
								                  NUMBER_Null,
								                  hWndForm.Tbl_Lim.dDat
								                )"  )
							! 3 - Пересмотреть текущий лимит LIM_BDATE (p_nd number, p_dat date) is 
							If SqlPLSQLCommand(hSql(),
									"CCK.LIM_BDATE( hWndForm.Tbl_Lim.nND, 
									                hWndForm.Tbl_Lim.dDat
									               )"  )
								Call SqlCommit( hSql() )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							! Пересмотреть текущий лимит PROCEDURE LIM_BDATE (p_nd number, p_dat date) is 
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Else
						Call SqlRollback(hSql())
						Call MessageNoWait('Неуспешное превращение ГЛК -> ГПК ', 'Ошибка', 0, 1)
					Call SalWaitCursor(FALSE)
			Function: F_D9129
				Description:
				Returns
				Parameters
					Number: ND_
				Static Variables
				Local variables
					String: sSql
					String: sTxt
					String: sD
					Number: nD
					Number: oD
				Actions
					Call SalWaitCursor(TRUE)
					If hWndForm.Tbl_Lim.D9129 = NUMBER_Null 
						Set hWndForm.Tbl_Lim.D9129 = 0
					Set nD = hWndForm.Tbl_Lim.D9129
					Set oD = hWndForm.Tbl_Lim.D9129_OLD 
					If oD != nD
						Set sD = Str( nD * 100)
						If oD = 0  AND nD != 0
							Set sSql = "INSERT into nd_txt (nd,tag,txt) values ( :ND_, 'D9129', :sD  ) "
						Else If oD != 0 AND nD = 0
							Set sSql = "DELETE from nd_txt WHERE nd=:ND_ AND tag='D9129' "
						Else
							Set sSql = "UPDATE nd_txt SET txt= :sD WHERE nd=:ND_ AND tag='D9129' "
						Set sTxt = "Новая дельта для 9129 = " || SalNumberToStrX( nD, 2 )
						If SqlPrepareAndExecute( hSqlAux(), sSql ) 
								and SqlPrepareAndExecute( hSqlAux(), 
								   "INSERT INTO cc_sob (ND,FDAT,ISP,TXT,otm) 
								   VALUES (:ND_, :hWndForm.Tbl_Lim.dDat, :hWndForm.Tbl_Lim.nUser, :sTxt ,6 )" ) 
							Call SqlCommit( hSqlAux() )
						Else
							Call SqlRollback( hSqlAux() )
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: dDat
			Date/Time: dLim !!  Дата установки актуального лимита
			Number: Day_Pog
			Number: Day_Pog_SN
			String: sTmp
			Number: nTmp
			Number: nLim_Tek
			Number: LIMIT
			Number: nSOS
			Number: nKV8
			String: sNLS8
			Number: nAcc8
			Number: nOSTC
			Number: nVid 
			Number: D9129_OLD
			Number: nUser
			String: I_CR9
			! substr( Trim ( cck_app.Get_ND_TXT (k.ND, 'I_CR9' ) ), 1, 1 ), 
		Message Actions
			On SAM_Create
				Set hWndForm.Tbl_Lim.strPrintFileName = 'СС_LIM'
				Set hWndForm.Tbl_Lim.nTabInstance = 1
				Set hWndForm.Tbl_Lim.dDat = GetBankDate()
				Set hWndForm.Tbl_Lim.nUser = GetUserId()
				Set hWndForm.Tbl_Lim.dCC_ID = 
						'Графік лімітів кредитування по договору ' || hWndForm.Tbl_Lim.strPar01
				Set hWndForm.Tbl_Lim.dNMK = hWndForm.Tbl_Lim.strPar02
				Set hWndForm.Tbl_Lim.nND  = hWndForm.Tbl_Lim.nPar
				Call SalTblSetLockedColumns( hWndForm, 5 )
				Call CC_LIM_NULL( hWndForm.Tbl_Lim.nND)
				!
				Call SalHideWindow(Tbl_Lim.NOT_SN)
				!
				! acc сч 8999, состояние, дата заверщ, период гашения
				If SqlPrepareAndExecute( hSql(),
						  "SELECT 
						 Nvl(cck_app.to_number2(cck_app.Get_ND_TXT (:nPar,'D9129' )),0)/100,
						           substr( Trim(cck_app.Get_ND_TXT (:nPar,'I_CR9' )),1,1 )
						    INTO :D9129  , :I_CR9 
						  FROM dual")
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Set hWndForm.Tbl_Lim.D9129 = 0
				If SqlPrepareAndExecute( hSql(),
						  "SELECT d.sos, d.wdate, f.name||' по ', a.acc, a.kv, a.nls, ad.wdate, nvl(a.vid,0),to_number(trunc(i.s))
						   INTO :hWndForm.Tbl_Lim.nSOS,  :hWndForm.Tbl_Lim.dfDAT4,:hWndForm.Tbl_Lim.dfFREQ,
						        :hWndForm.Tbl_Lim.nAcc8, :hWndForm.Tbl_Lim.nKV8,  :hWndForm.Tbl_Lim.sNLS8,
						        :hWndForm.Tbl_Lim.dfDAT3,:hWndForm.Tbl_Lim.nVid, :hWndForm.Day_Pog
						   FROM cc_deal d, cc_add ad, freq f, cc_lim l, accounts a, int_accn I
						   WHERE d.nd = ad.nd AND ad.freq = f.freq AND d.nd = :hWndForm.Tbl_Lim.nPar 
						     AND i.id =0 AND i.acc = a.acc AND l.nd = d.nd AND l.acc=a.acc " )
						and SqlFetchNext(hSql(), nFetchRes)
				Set FDAT_ = hWndForm.Tbl_Lim.dDat 
				!
				If hWndForm.Tbl_Lim.nTip_Ur  = 20 or hWndForm.Tbl_Lim.nTip_Ur  = 90 or 
						   hWndForm.Tbl_Lim.nSOS    >= 14 ! Бухгалтер(или закрыт ), Править нельзя
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( FDAT_ )
					Call SalDisableWindow( pb_LIM )
				Else If hWndForm.Tbl_Lim.nTip_Ur  = 10 ! Кредитчик
				!
				Set hWndForm.Tbl_Lim.strSqlDelete =
						"DELETE FROM cc_lim  
						 WHERE nd=:hWndForm.Tbl_Lim.nPar   
						   AND fdat >= :hWndForm.Tbl_Lim.dDat 
						   AND fdat  = :hWndForm.Tbl_Lim.FDAT_old "
				!
				Set hWndForm.Tbl_Lim.strSqlUpdate =
						"UPDATE cc_lim SET 
						 lim2    = :hWndForm.Tbl_Lim.LIM100, 
						 sumg    = sumg + (lim2 - :hWndForm.Tbl_Lim.LIM100 ) , 
						 sumo    = sumg + (lim2 - :hWndForm.Tbl_Lim.LIM100 ) , 
						 fdat    = :hWndForm.Tbl_Lim.FDAT, 
						 NOT_9129= :hWndForm.Tbl_Lim.NOT_9129, 
						 NOT_SN  = decode(:hWndForm.Tbl_Lim.NOT_SN,1,1,null)  
						 WHERE nd= :hWndForm.Tbl_Lim.nPar  
						   AND fdat >= :hWndForm.Tbl_Lim.dDat 
						   AND fdat  = :hWndForm.Tbl_Lim.FDAT_old "
				!
				Set hWndForm.Tbl_Lim.strSqlInsert =
						"INSERT Into cc_lim (nd, fdat, lim2, acc, not_9129,not_sn ) values
						(:hWndForm.Tbl_Lim.nPar,
						 :hWndForm.Tbl_Lim.FDAT, 
						 :hWndForm.Tbl_Lim.LIM100, 
						 :hWndForm.Tbl_Lim.nAcc8,
						 :hWndForm.Tbl_Lim.NOT_9129 ,
						 decode(:hWndForm.Tbl_Lim.NOT_SN,1,1,null)
						)"
				!
				If SqlPrepareAndExecute( hSql(),
						  "SELECT to_number(max(txt)) 
						   INTO :Day_Pog_SN
						   FROM nd_txt
						   WHERE nd=:Tbl_Lim.nND and tag='DAYSN' " )
						and not SqlFetchNext(hSql(), nFetchRes)
					Set Day_Pog_SN=NUMBER_Null
				!
				Call SalSetWindowText(hWndForm, 'Построение графика лимита кредитования (ГЛК) КД ' || strPar01 )
				Call ShowApdVersion('07')
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				! для тех, кому не надо две колонки - прячем по условию D9129 = 0 (будет как раньше)
				If hWndForm.Tbl_Lim.D9129 = 0
					Call SalHideWindow( hWndForm.Tbl_Lim.LIM9 )
				Else
					Call SalShowWindow( hWndForm.Tbl_Lim.LIM9 )
				Call CC_LIM_NULL( nND)
				! лимит текущего дня ПРОЧИТАТЬ и УСТАНОВИТЬ (м.б., его корректировали)
				If SqlPrepareAndExecute( hSqlAux(),
						  "SELECT max(fdat) INTO :hWndForm.Tbl_Lim.dLim FROM cc_lim 
						   WHERE nd=:hWndForm.Tbl_Lim.nPar and fdat<=:hWndForm.Tbl_Lim.dDat " )
						and SqlFetchNext(hSqlAux(), nFetchRes) 
						and SqlPrepareAndExecute( hSqlAux(),
						   "SELECT lim2, -FOST_H(acc,:hWndForm.Tbl_Lim.dDat)/100 
						    INTO :hWndForm.Tbl_Lim.nLim_Tek, :hWndForm.Tbl_Lim.nOSTC  
						    FROM cc_lim 
						    WHERE nd=:hWndForm.Tbl_Lim.nPar AND fdat=:hWndForm.Tbl_Lim.dLim " )
						and SqlFetchNext(hSqlAux(), nFetchRes)
					Set hWndForm.Tbl_Lim.LIMIT = hWndForm.Tbl_Lim.nLim_Tek / 100
					If SqlPrepareAndExecute( hSqlAux(), 
							  "UPDATE accounts 
							   SET ostx= -:hWndForm.Tbl_Lim.nLim_Tek 
							   WHERE acc= :hWndForm.Tbl_Lim.nAcc8 " )
							and SqlPrepareAndExecute( hSqlAux(),
							   "UPDATE cc_deal 
							    SET limit= :hWndForm.Tbl_Lim.LIMIT 
							    WHERE nd=:hWndForm.Tbl_Lim.nPar" )
							and SqlCommit( hSqlAux() )
				Set hWndForm.Tbl_Lim.strSqlPopulate  = ''
				If hWndForm.Tbl_Lim.dLim < GetBankDate()
					Set hWndForm.Tbl_Lim.strSqlPopulate = 
							"SELECT to_date  (:hWndForm.Tbl_Lim.dDat), 
							        to_number(:hWndForm.Tbl_Lim.nLim_Tek),
							        to_number(:hWndForm.Tbl_Lim.nOSTC), 0, 0 ,0  
							 FROM dual 
							 UNION ALL "
				Set hWndForm.Tbl_Lim.strSqlPopulate = hWndForm.Tbl_Lim.strSqlPopulate || 
						"SELECT fdat, lim2, -FOST_H(acc,fdat)/100, 1, nvl(NOT_9129 ,0),nvl(not_sn,0)
						 FROM cc_lim WHERE nd = :hWndForm.Tbl_Lim.nPar 
						 INTO :hWndForm.Tbl_Lim.FDAT, :hWndForm.Tbl_Lim.LIM100, :hWndForm.Tbl_Lim.LIM_Y,
						      :hWndForm.Tbl_Lim.OTM,  :hWndForm.Tbl_Lim.NOT_9129, :hWndForm.NOT_SN 
						 ORDER BY 1 "
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_Lim.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
			On SAM_FetchRowDone
				Set hWndForm.Tbl_Lim.ACC8 = hWndForm.Tbl_Lim.nAcc8
				Set hWndForm.Tbl_Lim.KV8  = hWndForm.Tbl_Lim.nKV8
				Set hWndForm.Tbl_Lim.NLS8 = hWndForm.Tbl_Lim.sNLS8
				Set hWndForm.Tbl_Lim.LIM2 = hWndForm.Tbl_Lim.LIM100/100
				!
				If I_CR9 = '1'
					! If SqlPrepareAndExecute( hSqlAux(),
							  "SELECT NVL(sum(gl.p_Ncurval(:KV8,FDOSQ(a.acc, a.daos,:FDAT),:FDAT)),0)/100  
							   INTO :LIM_Y
							   from nd_acc n, accounts a  
							   where n.nd = :nPar and n.acc = a.acc  and a.tip = 'SS '  ")
							and SqlFetchNext(hSqlAux(), nFetchRes)
					! OLGA77
					If SqlPrepareAndExecute( hSqlAux(),
							  "SELECT NVL(sum(gl.p_Ncurval(:KV8, gl.p_Icurval(a.kv,FDOS(a.acc, a.daos,:FDAT),:FDAT), :FDAT)),0)/100
							   INTO :LIM_Y
							   from nd_acc n, accounts a
							   where n.nd = :nPar and n.acc = a.acc  and a.tip = 'SS '  ")
							and SqlFetchNext(hSqlAux(), nFetchRes)
				If SqlPrepareAndExecute( hSqlAux(),
						  "SELECT a.tip, 
						    - gl.p_Ncurval (:hWndForm.Tbl_Lim.KV8,
						      gl.p_Icurval(a.kv, FOST_H(a.acc,:hWndForm.Tbl_Lim.FDAT), :hWndForm.Tbl_Lim.FDAT ),
						                    :hWndForm.Tbl_Lim.FDAT) / 100
						   INTO :hWndForm.Tbl_Lim.sTmp, :hWndForm.Tbl_Lim.nTmp
						   FROM accounts a, nd_acc n
						   WHERE a.acc=n.acc AND n.nd=:hWndForm.Tbl_Lim.nPar AND
						         a.tip in ('SS ','SL ','SP ','SN ','SPN','SN8','SG ') ")
					While SqlFetchNext(hSqlAux(), nFetchRes)
						If Tbl_Lim.sTmp = 'SS '
							Set Tbl_Lim.OST_SS = Tbl_Lim.OST_SS+ Tbl_Lim.nTmp
							! Set Tbl_Lim.LIM_Y  = Tbl_Lim.LIM_Y + Tbl_Lim.nTmp
						Else If Tbl_Lim.sTmp = 'SL '
							Set Tbl_Lim.OST_SL = Tbl_Lim.OST_SL+ Tbl_Lim.nTmp
						Else If Tbl_Lim.sTmp = 'SP '
							Set Tbl_Lim.OST_SP = Tbl_Lim.OST_SP+ Tbl_Lim.nTmp
						Else If Tbl_Lim.sTmp = 'SG '
							Set Tbl_Lim.OST_SG = Tbl_Lim.OST_SG+ Tbl_Lim.nTmp
						Else If Tbl_Lim.sTmp = 'SN '
							Set Tbl_Lim.OST_SN = Tbl_Lim.nTmp
						Else If Tbl_Lim.sTmp = 'SPN'
							Set Tbl_Lim.OST_SPN = Tbl_Lim.nTmp
						Else If Tbl_Lim.sTmp = 'SN8'
							Set Tbl_Lim.OST_SN8 = Tbl_Lim.nTmp
						!
				Set hWndForm.Tbl_Lim.LIM_N = hWndForm.Tbl_Lim.LIM2 - Tbl_Lim.LIM_Y
				Set hWndForm.Tbl_Lim.FDAT_old = hWndForm.Tbl_Lim.FDAT
				If hWndForm.Tbl_Lim.FDAT  < hWndForm.Tbl_Lim.dDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
				If hWndForm.Tbl_Lim.FDAT = hWndForm.Tbl_Lim.dDat 
					If hWndForm.Tbl_Lim.OTM =  0  !- ПСЕВДО-запись
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Salmon )  ! красный
					Else
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )  ! голубой
				If hWndForm.Tbl_Lim.FDAT >= hWndForm.Tbl_Lim.dfDAT4
					Set hWndForm.Tbl_Lim.LIM9 = 0
				Else
					Set hWndForm.Tbl_Lim.LIM9 = SalNumberMax( hWndForm.Tbl_Lim.LIM2 + hWndForm.Tbl_Lim.D9129, 0)
				If NOT_SN=1 or (Day_Pog!=Day_Pog_SN and Day_Pog_SN !=NUMBER_Null)    
					Call SalShowWindow(Tbl_Lim.NOT_SN)
			On UM_Update
				If SalMessageBox(
						'Вы действительно хотите внести изменения в ГЛК?',
						'В Н И М А Н И Е ! ', 
						MB_IconQuestion | MB_YesNo) = IDYES
					Call SalSendClassMessage(UM_Update, 0, 0)
					Call F_GPK()
					!
	Table Window: Tbl_SumPog
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Прогноз суммы погашения за период
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.2"
				Top:    1.833"
				Width:  13.717"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 3000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.524"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.117"
							Top:    0.131"
							Width:  1.717"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call hWndForm.Tbl_SumPog.F_DAT()
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.85"
							Top:    0.131"
							Width:  1.717"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call hWndForm.Tbl_SumPog.F_DAT()
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Выполнить расчет за заданный период"
						On SAM_Click
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "CCK.cc_Sum_POG (
									hWndForm.Tbl_SumPog.DAT1, 
									hWndForm.Tbl_SumPog.DAT2, 
									hWndForm.Tbl_SumPog.nTip_Kl ) " )
								Call SqlCommit( hSql() )
								Call NASELENIE()
							Else
								Call SqlRollback(hSql())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait( 'Ошибка при выполнении процедуры !',
										                    "CCK.cc_Sum_POG " , 30, 1 )
				Option Button: pbSum_KD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.967"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Sky
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,  
									"Свернуть/Развернуть по ДОГОВОРАМ" )
						On SAM_Click
							Call hWndForm.Tbl_SumPog.NASELENIE()
				Option Button: pbSum_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.433"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Light Green
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,  
									"Свернуть/Развернуть по ПРОМЕЖУТОЧНИМ ДАТАМ" )
						On SAM_Click
							Call hWndForm.Tbl_SumPog.NASELENIE()
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55262
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.05"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.417"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.867"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55263
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.933"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 55264
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: DATG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расчетная
						дата гашения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.45"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						дог
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заемщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идент.ДОГОВОРА
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						завершения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.5"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф. КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расчетная Сумма
						 ГАШЕНИЯ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.55"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ПРОсрочка +
						ДОсрочка   - 
						 ГАШЕНИЯ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.55"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MANAGER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Менеджер договора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: INIC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Инициатива
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.217"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.Tbl_SumPog.DAT1 < GetBankDate()
						Call Debug ('Дата-1 меньше текущей !')
						Set hWndForm.Tbl_SumPog.DAT1 = GetBankDate()
					If hWndForm.Tbl_SumPog.DAT1 > hWndForm.Tbl_SumPog.DAT2 
						Call Debug ('Дата-1 больше Дата-2 !')
						Set hWndForm.Tbl_SumPog.DAT2 = AddMonths(hWndForm.Tbl_SumPog.DAT1,1)
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Set hWndForm.Tbl_SumPog.nCol_KD =  SalColorFromRGB( 220,255,255 ) ! голубой
					Set hWndForm.Tbl_SumPog.nCol_DAT = SalColorFromRGB( 230,255,230 ) ! бледнозеленый
					Set hWndForm.Tbl_SumPog.nCol = SalColorFromRGB( 255,255,220)  !  желтій
					If hWndForm.Tbl_SumPog.pbSum_KD
						Call SalTblSetColumnTitle(  hWndForm.Tbl_SumPog.CC_ID, 'Ид.Договора'  )
						Call SalTblSetColumnTitle(  hWndForm.Tbl_SumPog.NMK, 'Заемщик'  )
						Call SalShowWindow( hWndForm.Tbl_SumPog.DAT4 ) 
						Call SalShowWindow( hWndForm.Tbl_SumPog.ND )
						Call SalShowWindow( hWndForm.Tbl_SumPog.MANAGER )
						Call SalShowWindow( hWndForm.Tbl_SumPog.INIC )
					Else
						Call SalTblSetColumnTitle(  hWndForm.Tbl_SumPog.CC_ID, 'Код по ISO'  )
						Call SalTblSetColumnTitle(  hWndForm.Tbl_SumPog.NMK, 'Наименование вал'  )
						Call SalHideWindow( hWndForm.Tbl_SumPog.DAT4 )
						Call SalHideWindow( hWndForm.Tbl_SumPog.ND )
						Call SalHideWindow( hWndForm.Tbl_SumPog.MANAGER )
						Call SalHideWindow( hWndForm.Tbl_SumPog.INIC )
					If hWndForm.Tbl_SumPog.pbSum_DAT
						Call SalShowWindow( hWndForm.Tbl_SumPog.DATG ) 
					Else
						Call SalHideWindow( hWndForm.Tbl_SumPog.DATG )
					! С договорами и С датами
					If hWndForm.Tbl_SumPog.pbSum_KD AND hWndForm.Tbl_SumPog.pbSum_DAT 
						Set hWndForm.Tbl_SumPog.strSqlPopulate =
								"SELECT to_date(g.CC_ID,'dd/mm/yyyy'), g.KV, g.ND, 
								        d.CC_ID, g.NMK, d.WDATE,  g.G1/100, g.G2/100, 
								        d.user_id||'/'||st.fio, substr(nt.txt,1,250)    
								 INTO :hWndForm.Tbl_SumPog.DATG, :hWndForm.Tbl_SumPog.KV, :hWndForm.Tbl_SumPog.ND,
								      :hWndForm.Tbl_SumPog.CC_ID,:hWndForm.Tbl_SumPog.NMK,:hWndForm.Tbl_SumPog.DAT4,
								      :hWndForm.Tbl_SumPog.G1,   :hWndForm.Tbl_SumPog.G2,
								      :hWndForm.Tbl_SumPog.MANAGER,:hWndForm.Tbl_SumPog.INIC
								 FROM  cck_Sum_POG g, cc_deal d, nd_txt nt, staff st
								 WHERE g.g1 is not null AND g.nd=d.nd 
								   AND nt.nd (+) = d.nd  AND nt.tag (+) ='INIC' AND d.user_id=st.id
								 ORDER BY to_date(g.CC_ID,'dd/mm/yyyy'), g.KV, g.ND "
					! БЕЗ договоров и С датами
					Else If not hWndForm.Tbl_SumPog.pbSum_KD AND hWndForm.Tbl_SumPog.pbSum_DAT 
						Set hWndForm.Tbl_SumPog.nCol = hWndForm.Tbl_SumPog.nCol_DAT
						Set hWndForm.Tbl_SumPog.nCol_KD = hWndForm.Tbl_SumPog.nCol_DAT
						Set hWndForm.Tbl_SumPog.strSqlPopulate =
								"SELECT to_date(g.CC_ID,'dd/mm/yyyy'), g.KV, t.lcv, t.name,  
								        sum(G1)/100,  sum(G2)/100 
								 INTO :hWndForm.Tbl_SumPog.DATG, :hWndForm.Tbl_SumPog.KV, :hWndForm.Tbl_SumPog.CC_ID,
								      :hWndForm.Tbl_SumPog.NMK, 
								      :hWndForm.Tbl_SumPog.G1,:hWndForm.Tbl_SumPog.G2     
								 FROM  cck_Sum_POG g, tabval t 
								 WHERE t.kv=g.kv and g.g1 is not null 
								 group by to_date(g.CC_ID,'dd/mm/yyyy'), g.KV, t.lcv, t.name
								 ORDER BY to_date(g.CC_ID,'dd/mm/yyyy'), g.KV "
					! С договорами и БЕЗ дат
					Else If hWndForm.Tbl_SumPog.pbSum_KD AND NOT hWndForm.Tbl_SumPog.pbSum_DAT 
						Set hWndForm.Tbl_SumPog.nCol = hWndForm.Tbl_SumPog.nCol_KD
						Set hWndForm.Tbl_SumPog.strSqlPopulate =
								"SELECT g.KV, g.ND, d.CC_ID, g.NMK, d.WDATE,  g.G1/100, g.G2/100, 
								        d.user_id||'/'||st.fio, substr(nt.txt,1,250)    
								 INTO :hWndForm.Tbl_SumPog.KV, :hWndForm.Tbl_SumPog.ND,  :hWndForm.Tbl_SumPog.CC_ID,
								      :hWndForm.Tbl_SumPog.NMK,:hWndForm.Tbl_SumPog.DAT4,
								      :hWndForm.Tbl_SumPog.G1, :hWndForm.Tbl_SumPog.G2, 
								      :hWndForm.Tbl_SumPog.MANAGER, :hWndForm.Tbl_SumPog.INIC
								 FROM  cck_Sum_POG g, cc_deal d, nd_txt nt, staff st
								 WHERE g.g1 is not null AND g.nd=d.nd 
								   AND nt.nd (+) = d.nd AND nt.tag (+) ='INIC' AND d.user_id=st.id 
								 ORDER BY g.KV, g.ND "
					! БЕЗ договоров и БЕЗ дат
					Else If NOT hWndForm.Tbl_SumPog.pbSum_KD AND NOT hWndForm.Tbl_SumPog.pbSum_DAT
						Set hWndForm.Tbl_SumPog.nCol_KD = hWndForm.Tbl_SumPog.nCol
						Set hWndForm.Tbl_SumPog.strSqlPopulate =
								"SELECT g.KV, t.lcv, t.name,  sum(G1)/100 , sum(G2)/100   
								 INTO  :hWndForm.Tbl_SumPog.KV, :hWndForm.Tbl_SumPog.CC_ID,
								       :hWndForm.Tbl_SumPog.NMK,
								       :hWndForm.Tbl_SumPog.G1,:hWndForm.Tbl_SumPog.G2 
								 FROM  cck_Sum_POG g, tabval t  WHERE t.kv=g.kv and g.g1 is not null 
								 group by g.KV, t.lcv, t.name  ORDER BY g.KV "
					!
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_SumPog.strSqlPopulate, TBL_FillAll)
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nTip_Ur
			Number: nTip_Kl
			String: strPar01
			String: strPar02
		Window Variables
			Number: nCol_KD
			Number: nCol_DAT
			Number: nCol
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Прогноз суммы погашения за период ' || strPar02 )
				Call ShowApdVersion('11')
				Set hWndForm.Tbl_SumPog.strPrintFileName = 'СС_KALi'
				Set hWndForm.Tbl_SumPog.nTabInstance = 1
				Set hWndForm.Tbl_SumPog.pbSum_KD = FALSE
				Set hWndForm.Tbl_SumPog.pbSum_DAT = FALSE
				!
				Set hWndForm.Tbl_SumPog.DAT1 = GetBankDate()
				Set hWndForm.Tbl_SumPog.DAT2 = AddMonths(DAT1,1)
				Call SalTblSetLockedColumns( hWndForm, 6 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
			On SAM_FetchRowDone
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.DATG, hWndForm.Tbl_SumPog.nCol_DAT )
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.DAT4, hWndForm.Tbl_SumPog.nCol_KD )
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.ND, hWndForm.Tbl_SumPog.nCol_KD )
				!
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.NMK, hWndForm.Tbl_SumPog.nCol_KD )
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.CC_ID,hWndForm.Tbl_SumPog.nCol_KD )
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.G1, hWndForm.Tbl_SumPog.nCol )
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.G2, hWndForm.Tbl_SumPog.nCol )
				Call XSalTblSetCellBackColor( hWndForm.Tbl_SumPog.KV, hWndForm.Tbl_SumPog.nCol )
	Table Window: Tbl_Kal
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Просмотр Графика Погашения Кредита (ГПК)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.2"
				Top:    1.833"
				Width:  13.533"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.067"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6740
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.417"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.867"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.967"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6741
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.317"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6742
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.65"
							Top:    0.071"
							Width:  6.017"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.833"
							Top:    0.071"
							Width:  2.783"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: nND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.05"
							Top:    0.071"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_Lim
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.417"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Построение Графика Лимита Кредитования (ГЛК) выбранного КД'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Ur, 13, nPar, strPar01, strPar02,'','','' )
				Pushbutton: pbGPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.867"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F12
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Построение Графика Погашения Кредита (ГПК) выбранного КД'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Ur, 12, nPar, strPar01, strPar02,'','','' )
		Contents
			Column: DEN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По
						гр
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						Лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 If FDAT < dDat
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Set FDAT=FDAT_old
			Column: G1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма Лимита
						УСТАНОВЛЕННАЯ
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.633"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set LIM100 = G1 *100
			Column: G2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный ост.
						ВХОДЯЩИЙ
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расчетная Сумма
						 ГАШЕНИЯ
						3 = 2 - 1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.733"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный 
						ДЕБЕТ
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный 
						КРЕДИТ
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный ост.
						ИСХОДЯЩИЙ
						6 = 2 + 4 - 5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Просрочено
						(Невыбрано)
						7 = 6 - 1 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G7_SP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: В т.ч. 
						на SP
						7 (пр.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: G8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пеня
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: FOST
			Number: nAcc
			Number: G2a
			Number: nDel
			Number: nDelK
			Number: nDelD
			Number: nKv
			Number: nRow
			Date/Time: bDat
			Date/Time: FDAT1
		Message Actions
			On SAM_Create
				Set Tbl_Kal.strPrintFileName = 'СС_KAL'
				Set Tbl_Kal.nTabInstance = 1
				Set Tbl_Kal.dCC_ID='Графік погашення кредиту по угоді '|| Tbl_Kal.strPar01
				Set Tbl_Kal.dNMK  = Tbl_Kal.strPar02
				Set Tbl_Kal.nND   = Tbl_Kal.nPar
				Set Tbl_Kal.bDat  = GetBankDate()
				Call SalTblSetLockedColumns( hWndForm, 4 )
				!
				If SqlPrepareAndExecute( hSql(),
						  "SELECT  a.kv, a.acc
						   INTO :Tbl_Kal.nKv, :Tbl_Kal.nAcc
						   FROM cc_lim l, accounts a 
						   WHERE l.acc=a.acc AND l.nd=:Tbl_Kal.nND and rownum=1" )
						and SqlFetchNext(hSql(), nFetchRes) 
				! если сегодня что-то было (изменение лимита или реальное движение)
				If SqlPrepareAndExecute( hSql(),
						  "SELECT 1 from saldoa s, cc_lim l where s.acc=:Tbl_Kal.nAcc and s.acc=l.acc
						   and (s.fdat=:Tbl_Kal.bDat or l.fdat=:Tbl_Kal.bDat )" )
						and SqlFetchNext(hSql(), nFetchRes) 
					! Call Debug('ect')
					Set Tbl_Kal.strSqlPopulate =
							"SELECT fdat, lim2/100, 1
							 INTO :Tbl_Kal.FDAT, :Tbl_Kal.G1, :Tbl_Kal.DEN
							 FROM cc_lim WHERE nd="||Str(Tbl_Kal.nND)||" 
							 union all
							 select s.fdat, l.lim2/100, 0
							 FROM saldoa s, cc_lim l
							 where s.fdat<=BANKDATE AND
							       s.acc= "||Str(nAcc)||"  and s.acc = l.acc
							   and s.fdat not in (select fdat from cc_lim where acc=s.acc )
							   and l.fdat = (select max(fdat) from cc_lim where acc=s.acc and fdat < s.fdat) 
							 ORDER BY 1"
				! ничего не было: но строка для информации
				Else
					Set Tbl_Kal.strSqlPopulate =
							"SELECT fdat, lim2/100,1
							 INTO :Tbl_Kal.FDAT, :Tbl_Kal.G1, :Tbl_Kal.DEN
							 FROM cc_lim WHERE nd="||Str(Tbl_Kal.nND)||" 
							 union all
							 select s.fdat, l.lim2/100, 0
							 FROM saldoa s, cc_lim l
							 where s.fdat<=BANKDATE AND
							       s.acc= "||Str(nAcc)||"  and s.acc = l.acc
							   and s.fdat not in (select fdat from cc_lim where acc=s.acc )
							   and l.fdat = (select max(fdat) from cc_lim where acc=s.acc and fdat < s.fdat)
							 union all 
							 select bankdate, lim2/100, 0
							 FROM  cc_lim  
							 where acc= "||Str(Tbl_Kal.nAcc)||" 
							   and fdat = (select max(fdat) from cc_lim where acc="||Str(Tbl_Kal.nAcc)||" and fdat < bankdate)
							 ORDER BY 1"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set nDel  = 0
				Set nDelK = 0
				Set nDelD = 0
				Set G2a = -1 
				Call SalTblPopulate(hWndForm, hSql(), Tbl_Kal.strSqlPopulate, TBL_FillAll)
				Set Tbl_Kal.nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
				Call SalTblSetContext(hWndForm, Tbl_Kal.nRow )                               
				Call SalTblSetRowFlags( hWndForm, Tbl_Kal.nRow, ROW_New, FALSE )
				Set Tbl_Kal.G3 =  nDel
				Set Tbl_Kal.KOS = nDelK
				Set Tbl_Kal.DOS = nDelD
				Set Tbl_Kal.G6 =  nDelD -  nDelK
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
			On SAM_FetchRowDone
				Set KV8 = nKv
				! истекший период
				If FDAT <= bDat 
					Set FDAT1 = FDAT - 1
					If SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT -FOST_H(:nAcc,:FDAT1)/100 INTO :G2 FROM dual " ) 
							and SqlFetchNext( hSqlAux2(), nFetchRes) 
					!
					If SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT DOS/100,KOS/100 INTO :DOS,:KOS FROM saldoa WHERE acc=:nAcc and fdat=:FDAT" ) 
							and not SqlFetchNext( hSqlAux2(), nFetchRes) 
						Set DOS=0
						Set KOS=0
					! в т.ч. уже перенесено на просрочку
					If SqlPrepareAndExecute( hSqlAux2(), 
							"SELECT gl.p_Ncurval( :nKv,
							                      -SUM(gl.p_Icurval(a.kv, s.ostf+s.kos-s.dos, :FDAT)),
							                      :FDAT ) /100 
							 INTO :G7_SP 
							 FROM saldoa s, nd_acc n, accounts a
							 where n.nd=:nND and n.acc=s.acc and a.acc=n.acc and a.tip='SP ' and 
							   (s.acc,s.fdat)=
							   (select acc, max(fdat) from saldoa where acc=a.acc and fdat<=:FDAT  group BY acc)" ) 
							and  SqlFetchNext( hSqlAux2(),  nFetchRes)
					Set G6 = G2 + DOS - KOS 
					!
					If DEN = 1
						If G2 +DOS > G1
							Set G3 = G2 +DOS - G1
						Else
							Set G3 = 0
					Set G2a = IifN ( G2a = -1,  G1, G6)
					Set G7 = G6 - G1
					! цвет тек дня
					If FDAT = bDat 
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )  ! голубой
					! просрочка
					If G7 > 0 
						! превішен лимит - розовій
						Call XSalTblSetCellBackColor( G7, SalColorFromRGB( 255,210,250 ) )
					Else If G7 < 0 
						! невібран лимит - желтій
						Call XSalTblSetCellBackColor( G7, SalColorFromRGB( 255,255,180) )
					Set nDel = nDel + KOS
					Set nDelK = nDelK + KOS
					Set nDelD = nDelD + DOS
				! будущий период
				Else
					! движения еще не было
					If G2a = -1 
						Set G2a = G1
					!
					If G2a > G1
						Set G3 = G2a - G1
					Else
						Set G3 = 0
					!
					Set G2a = G1
					Set nDel = nDel + G3
	Form Window: frm_Karta
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.788"
				Top:    0.385"
				Width:  13.0"
				Width Editable? Yes
				Height: 7.31"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.869"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Background Text: Кредитный договор 
					Resource Id: 41638
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.012"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dfCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.1"
							Top:    0.238"
							Width:  1.567"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ид.КД' )
				Data Field: dfDAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.683"
							Top:    0.238"
							Width:  1.267"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата заключения КД' )
				Group Box: Авторизация
					Resource Id: 41640
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.983"
						Top:    0.024"
						Width:  8.7"
						Width Editable? Yes
						Height: 0.798"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
				Data Field: FIO1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.117"
							Top:    0.238"
							Width:  1.75"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кред.инспектор' )
				Combo Box: cmb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   4.883"
						Top:    0.238"
						Width:  3.567"
						Width Editable? Yes
						Height: 2.583"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? Yes
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
				Data Field: dfAUTOR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Long String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.467"
							Top:    0.238"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_Podpis
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Edit.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Подтвердить/Авторизировать карту ввода'
						On SAM_Click
							If dfAUTOR = STRING_Null
								Set sAIM = 'Авторизация КД реф='||Str(dfND)||' '|| GetUserRealName()|| ' '||
										           SalFmtFormatDateTime ( SalDateCurrent(  ), 'dd/MM/yyyy hh:mm:ss ' )
							Else
								Set sAIM = dfAUTOR 
							! предупреждения
							If SqlPrepareAndExecute( hSqlAux(),
									  "SELECT a.acc, a.nls 
									   INTO :frm_Karta.ACC_SS, :frm_Karta.NLS_SS 
									   FROM accounts a, nd_acc n 
									   WHERE nd=:frm_Karta.ND and n.acc=a.acc and a.tip='SS '" )
									and SqlFetchNext(hSqlAux(), nFetchRes) 
								If SqlPrepareAndExecute( hSqlAux(),
										   "SELECT acc FROM cc_accp WHERE accs=:frm_Karta.ACC_SS " )
										and not SqlFetchNext(hSqlAux(), nFetchRes) 
									If SalMessageBox("Внимание АВТОРИЗАЦИЯ КД !" ,"Не открыты счета обеспечения", 
											 MB_YesNo | MB_IconHand) != IDYES
										Return FALSE
							Else
								If SalMessageBox("Внимание АВТОРИЗАЦИЯ КД !" ,"Не открыт ссудный счет", 
										 MB_YesNo | MB_IconHand) != IDYES
								Return FALSE
							!
							Set bTmp= FALSE
							Call Sel017t( frm_Karta, 'Подробности об Авторизации кредита', frm_Karta.bTmp, frm_Karta.sAIM, TRUE)
							If SqlPLSQLCommand(hSql(), "CCK.CC_AUTOR (ND, sAIM, cmb1 )" )
								Call SqlCommitEx( hSql(), sAIM )
								Set dfAUTOR = sAIM
								Call SalDisableWindow( cmb1 )
								Call SalDisableWindow(  pb_Podpis_All )
								Call SalDisableWindow(  pb_Podpis )
								Call MessageNoWait('Авторизація КД '|| dfCC_ID||' закінчена', 'Повідомлення', 0, 0)
							Else
								Call SqlRollback(hSql())
								Call MessageNoWait('Неуспешная авторизация КД '|| dfCC_ID, 'Ошибка', 0, 1)
							Call SalWaitCursor(FALSE)
				Pushbutton: pb_Podpis_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.083"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Edit.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 
									' Полная Авторизация заявки с :
									1.Открытием счетов,
									2.Построением ГПК и денежных потоков,
									3.Расчетом Эфф.ставки
									4.Учетом обеспечения'
						On SAM_Click
							If CCK_NBU
								If MFOKRED = STRING_Null OR  ACCKRED = STRING_Null
									If SalMessageBox("Не заполнены платежные инструкции. Продолжить авторизацию?" ,"Внимание!",  MB_YesNo | MB_IconHand) = IDNO
										Return FALSE
							If dfAUTOR = STRING_Null
								Set sAIM = 'Авторизація КД реф='||Str(dfND)||' '|| GetUserRealName()|| ' '||
										           SalFmtFormatDateTime ( SalDateCurrent(  ), 'dd/MM/yyyy hh:mm:ss ' )
							Else
								Set sAIM = dfAUTOR 
							! Открыть и привязать счета SS+SN+SG+SD`
							! Открыть и привязать счета ZAL
							! Выполнить проводку по обеспечениям
							! Построить ден.потоки + Эф.ставки
							! Открыть счет дисконта
							Set bTmp= FALSE
							Call Sel017t( frm_Karta, 'Подробиці про Авторизацію кредиту ', frm_Karta.bTmp, frm_Karta.sAIM, TRUE)
							If SqlPLSQLCommand(hSql(), "CCK_DOP.CC_AUTOR (ND, sAIM, cmb1 )" )
								! If SqlPrepareAndExecute( hSqlAux(),"SELECT fin,name INTO :nTmp,:sTmp FROM STAN_FIN " )
								! Выбираем все шаблоны договоров в которых идентификатор имеет структуру 
								! KD_xxx_ZZZZ  где xxx - это код продукта при чем данный код может быть короче кода продукта тем самым  
								! использоватся при гениррации в разных продуктах (благодаря добавлению знака %), а _ZZZZ отбрасывается
								! А наименование текста должно ОБЯЗАТЕЛЬНО НАЧИНАТСЯ СО ЗНАКА ЗВЕЗДАЧКА    *
								Call SqlCommitEx( hSql(), sAIM )
								Call XConnectGetParams( cCnc )
								If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE ) 
									Set i = 0
									If SqlPrepareAndExecute( hSqlAux()," SELECT distinct r.id, s.name
											                                                            INTO  :sID,:sNAME
												                                    FROM cc_deal d, doc_root r, doc_scheme s
													             WHERE  decode(d.vidd,1,1,2,1,3,1,11,11,12,11,13,11,-1) = decode(r.vidd,1,1,2,1,3,1,11,11,12,11,13,11,-100) 
													                                AND s.id = r.id
														          AND substr(r.id,1,3)='KD_'
											                                                                          AND ( INSTR(r.id, '_' ,1,2)>0 and d.PROD like substr(r.id,4,INSTR(r.id, '_' ,1,2)-4)||'%'   OR
											                                                                                       INSTR(r.id, '_' ,1,2)=0 and d.PROD like substr(r.id,4,100)||'%'
											                                                                                  )
											        				            AND s.name like '*%'
															            AND d.nd = :dfND
											                                                                       " )
										While SqlFetchNext(hSqlAux(), nFetchRes) 
											Set smID[i] = sID
											Set i = i + 1
										Set j = 0
										While j < i
											Call MessageNoWait('Створення документу - '|| sNAME, 'Повідомлення', 5, 0)
											Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sID,  dfND,0)
											If sDoc
												! Сохраняем документ в БД
												If NOT  cdoc_SetDocText(hSql(), TRUE,  smID[j], dfND, 0, DATETIME_Null, sDoc)
													Call SqlRollback(hSql())
												Else
													Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(dfND,0) || ', доп. соглашение: 0  сохранен в БД!' )
											Set j = j + 1
									Call cCnc.Disconnect()
									Call cCnc2.Disconnect()
								Call SalDisableWindow(  pb_Podpis_All )
								Call SalDisableWindow(  pb_Podpis )
								Call SalDisableWindow( cmb1 )
								Call MessageNoWait('Повна авторизація КД '|| dfCC_ID||' закінчена', 'Повідомлення', 0, 0)
							Else
								Call SqlRollback(hSql())
								Call MessageNoWait('Неуспішна Повна авторизація КД '|| dfCC_ID, 'Помилка', 0, 1)
							Call SalWaitCursor(FALSE)
				Pushbutton: pb_Print
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Печать тикета'
						On SAM_Click
							! вызов функции печати карты ввода
							If not CCK_NBU
								Call SalWaitCursor(TRUE)
								Set strFa = GetPrnDir() || "\\KV" || Str(ND) || ".txt"
								! Call Debug (strFa)
								! Set strREP = 
										 'dfCC_ID,dfDAT1,dfAUTOR,dfRNK,dfOKPO,dfNMK,dfADR,dfOE,rbR,dfND,sRISK,dfAIM_PODR,dfDAT2,dfDAT4,'||
										 'dfAIM,dfSROK,dfKV,dfLIMIT,dfDAT3,dfPROC,dfPERIOD,dfDEN,dfNACHALO,dfBASA,'||
										 'dfKV1,dfPROC1,dfKV2,dfPROC2,dfKV3,dfPROC3,dfKV4,dfPROC4,'||
										 'dfKDO,dfKNL,dfNLS1,dfSSKPS,cb_KL,cb_LIMNN,dfSUM_ZAL,dfOP_ZAL'
								Set strREP = 
										 'dfCC_ID,dfDAT1,dfAUTOR,dfRNK,dfOKPO,dfNMK,dfADR,dfOE,rbR,dfND,sRISK,dfAIM_PODR,dfDAT2,dfDAT4,'||
										 'dfAIM,dfSROK,dfKV,dfLIMIT,dfDAT3,dfPROC,dfPERIOD,dfDEN,dfNACHALO,dfBASA,'||
										 'dfKV1,dfPROC1,dfBASA1,dfKV2,dfPROC2,dfBASA2,dfKV3,dfPROC3,dfBASA3,dfKV4,dfPROC4,dfBASA4,'||
										 'dfKDO,dfKNL,dfNLS1,dfSSKPS,cb_KL,cb_LIMNN,dfSUM_ZAL,dfOP_ZAL'
								Set strCEN = strREP
								! Call Debug (strREP)
								! rtf
								If SalMessageBox("Желаете просмотреть карту ввода " || strFa || " в редакторе?",
										   "Отчет сформирован успешно!", MB_IconQuestion | MB_YesNo ) = IDYES
									Set strFa = GetPrnDir() || "\\KV" || Str(ND) || ".rtf"
									Call SalReportPrintToFile(hWndForm,
											     GetTemplateDir() || "\\CC_KVW.QRP", strFa,
											     strCEN, strREP, 1, RPT_PrintAll, 1, 1, TRUE,
											     nInd)
									! Call Debug ('W')
									Call SalLoadApp (GetEditorPath(), strFa)
								! txt
								Else
									Call SalReportPrintToFile(hWndForm,
											     GetTemplateDir() || "\\CC_KV.QRP", strFa,
											     strCEN, strREP, 1, RPT_PrintAll, 1, 1, FALSE,
											     nInd)
									! Call Debug ('T')
								! конец
								Call SalWaitCursor(FALSE)
							Else
								! nTipd = 1
								Call SqlPrepareAndExecute(hSql(), "SELECT name  INTO :Vidd_Name  FROM cc_vidd WHERE vidd=(SELECT vidd FROM cc_deal WHERE nd=:ND)")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT sum(sumo-sumg)/100  INTO :SumProc FROM cc_lim WHERE nd=:ND")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT bic  INTO :bicA FROM forex_alien WHERE mfo=f_ourmfo")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT bic  INTO :bicB FROM forex_alien WHERE mfo=:MFOKRED")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT num_nd INTO :Num_ND FROM custbank WHERE rnk=:dfRNK")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT a.nls INTO :Nls_SS FROM accounts a, nd_acc na WHERE na.nd=:ND AND na.acc=a.acc AND a.rnk=:dfRNK AND a.tip='SS' ")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT a.nls INTO :Nls_SN FROM accounts a, nd_acc na WHERE na.nd=:ND AND na.acc=a.acc AND a.rnk=:dfRNK AND a.tip='SN' ")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SqlPrepareAndExecute(hSql(), "SELECT substr(f_ourokpo(),1,14) INTO :OKPOA FROM dual")
								Call SqlFetchNext(hSql(), nFetchRes)
								Set BANKNAME=GetGlobalOption('NAME')
								If F_PRINT_MB('tic_kd.qrd', ' ',
										     0, ND, Num_ND, dfCC_ID, Vidd_Name, dfKV, sdog, dfPROC, SumProc, 1,
										    dfDAT1, dfDAT3, dfDAT4, dfNMK, MFOKRED, ACCKRED, MFOKRED, '', MFOKRED,
										    bicB, dfNMK, bicB, dfOKPO, '', BANKNAME, GetBankMfo(),  Nls_SS, Nls_SN,
										    bicA, BANKNAME, bicA, OKPOA, '', NUMBER_Null, NUMBER_Null, strRepName)
									Call SalMessageBox('Тикет успешно помещен в ' || strRepName,  'Информация', 0)
				Pushbutton: pb_Skoring
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Скоринг-расчет'
						On SAM_Click
							Call PRINT_SURVEY()
				Data Field: nametp_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.083"
							Top:    0.488"
							Width:  6.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кред.инспектор' )
				Pushbutton: pb13
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перечитать'
						On SAM_Click
							Call NASELENIE()
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.183"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Group Box: Обеспечение возврата кредита
				Resource Id: 41630
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    4.571"
					Width:  12.0"
					Width Editable? Yes
					Height: 0.881"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: 3
				Resource Id: 41631
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   11.383"
					Top:    4.762"
					Width:  0.517"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 14
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Сумма обеспечения
				Resource Id: 41636
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    4.929"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfSUM_ZAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.683"
						Top:    4.905"
						Width:  2.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма-1 обеспечения' )
			Background Text: (в валюте кредита)
				Resource Id: 41637
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.117"
					Top:    4.929"
					Width:  2.85"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfOP_ZAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Long String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.65"
						Top:    5.155"
						Width:  8.733"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Описание обеспечения' )
			Background Text: Описание обеспечения
				Resource Id: 41635
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.467"
					Top:    5.155"
					Width:  2.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_PAWN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.483"
					Top:    5.071"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set bTmp=FALSE
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :sAIM FROM nd_txt WHERE ND="||Str(ND)||" and tag='PAWN' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT ="UPDATE nd_txt SET txt=:sAIM WHERE nd="||Str(ND)||" AND tag='PAWN' "
						Else
							Set sTmpT ="INSERT INTO nd_txt (nd,tag,txt) VALUES (:ND,'PAWN',:sAIM)"
							Set sAIM=STRING_Null
						Call Sel017t( frm_Karta, 'Подробно: Описание обеспечения', frm_Karta.bTmp, frm_Karta.sAIM, TRUE )
						If bTmp
							If SqlPrepareAndExecute(hSql(), sTmpT )
								Call SqlCommit( hSql() )
								Set dfOP_ZAL = sAIM
							Else
								Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Подробно: Описание обеспечения'
			Background Text: Ком. за :
				Resource Id: 53436
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    3.583"
					Width:  0.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: дт.об.
				Resource Id: 41624
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.383"
					Top:    3.583"
					Width:  0.667"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfKDO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Long String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.067"
						Top:    3.583"
						Width:  3.417"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ком. за дт.об.' )
			Pushbutton: pb_KDO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.483"
					Top:    3.571"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set bTmp=FALSE
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :sAIM FROM nd_txt WHERE ND="||Str(ND)||" and tag='KDO' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT ="UPDATE nd_txt SET txt=:sAIM WHERE nd=:dfND AND tag='KDO' "
						Else
							Set sTmpT ="INSERT INTO nd_txt (nd,tag,txt) VALUES (:ND,'KDO',:sAIM)"
							Set sAIM=STRING_Null
						Call Sel017t( frm_Karta, 'Подробности о Ком. за дт.об.', frm_Karta.bTmp, frm_Karta.sAIM, TRUE )
						If bTmp
							If SqlPrepareAndExecute(hSql(), sTmpT )
								Call SqlCommit( hSql() )
								Set dfKDO = sAIM
							Else
								Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Подробности о Ком. за дт.об.'
			Background Text: нез.лим.
				Resource Id: 41625
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.7"
					Top:    3.595"
					Width:  0.933"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_KNL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.483"
					Top:    3.548"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set bTmp=FALSE
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :sAIM FROM nd_txt WHERE ND="||Str(ND)||" and tag='KNL' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT ="UPDATE nd_txt SET txt=:sAIM WHERE nd=:dfND AND tag='KNL' "
						Else
							Set sTmpT ="INSERT INTO nd_txt (nd,tag,txt) VALUES (:ND,'KNL',:sAIM)"
							Set sAIM=STRING_Null
						Call Sel017t( frm_Karta, 'Подробности о Ком. за нез. лимит', frm_Karta.bTmp, frm_Karta.sAIM, TRUE )
						If bTmp
							If SqlPrepareAndExecute(hSql(), sTmpT )
								Call SqlCommit( hSql() )
								Set dfKNL = sAIM
							Else
								Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Подробности о Ком. за нез. лимит'
			Data Field: dfKNL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Long String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.717"
						Top:    3.583"
						Width:  3.75"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ком. за нез. лимит' )
			Background Text: Выдача на сч
				Resource Id: 41626
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    3.881"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfNLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    3.905"
						Width:  3.417"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Счет, на который выдается ссуда' )
			Background Text: Погашение со сч
				Resource Id: 41628
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.483"
					Top:    3.929"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfSSKPS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.683"
						Top:    3.905"
						Width:  3.75"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt FROM nd_txt WHERE ND="||Str(ND)||" and tag='SSKPS' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT ="UPDATE nd_txt SET txt=:dfSSKPS WHERE nd=:dfND AND tag='SSKPS' "
						Else
							Set sTmpT ="INSERT INTO nd_txt (nd,tag,txt) VALUES (:ND,'SSKPS',:dfSSKPS)"
						If SqlPrepareAndExecute(hSql(), sTmpT )
							Call SqlCommit( hSql() )
						Else
							Call SqlRollback(hSql())
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Счет, с которого погашается ссуда' )
			Check Box: cb_KL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кредитная линия
				Window Location and Size
					Left:   0.383"
					Top:    4.167"
					Width:  2.183"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Check Box: cb_LIMNN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Из лимита на неотложные нужды
				Window Location and Size
					Left:   2.75"
					Top:    4.167"
					Width:  4.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						! Call DebugN(cb_LIMNN)
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt FROM nd_txt WHERE ND="||Str(ND)||" and tag='LIMNN' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT ="UPDATE nd_txt SET txt=:cb_LIMNN WHERE nd=:dfND AND tag='LIMNN' "
						Else
							Set sTmpT ="INSERT INTO nd_txt (nd,tag,txt) VALUES (:ND,'LIMNN',:cb_LIMNN)"
						If SqlPrepareAndExecute(hSql(), sTmpT )
							Call SqlCommit( hSql() )
						Else
							Call SqlRollback(hSql())
			Data Field: dfKV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.333"
						Top:    2.524"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    2.524"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.333"
						Top:    2.786"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    2.786"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.333"
						Top:    3.036"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    3.036"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.333"
						Top:    3.286"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    3.286"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			!
			!
			Background Text: Проценты
				Resource Id: 41618
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.583"
					Top:    3.012"
					Width:  0.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPROC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.033"
						Top:    2.274"
						Width:  0.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Background Text: Период уплаты
				Resource Id: 41620
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.233"
					Top:    2.524"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPERIOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.233"
						Top:    2.667"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Периодичность гашения %' )
			Background Text: День
				Resource Id: 41621
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.283"
					Top:    2.524"
					Width:  0.85"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDEN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.933"
						Top:    2.667"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Кал.день гашения %' )
			Background Text: Начало
				Resource Id: 41622
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.833"
					Top:    2.524"
					Width:  0.85"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfNACHALO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.633"
						Top:    2.667"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Начало гашения %' )
			Background Text: База начисл.
				Resource Id: 41623
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.733"
					Top:    2.131"
					Width:  1.25"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfBASA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    2.274"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% База' )
			!
			Group Box: Информация о кредите
				Resource Id: 41606
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.321"
					Width:  12.0"
					Width Editable? Yes
					Height: 3.167"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_MOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.433"
					Top:    1.524"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Marigold
				Message Actions
					On SAM_Create
						If not b_MOS
							Call SalHideWindow( pb_MOS ) 
						Set strTip = 'Спец. реквізити по КД (внутрішньобанківські)'
					On SAM_Click
						Call SalSendMsg( cc_dog.pb_MOS, SAM_Click, 0, 0 )
			Background Text: 2 
				Resource Id: 41607
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   11.417"
					Top:    1.488"
					Width:  0.517"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 14
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Номер кредита
				Resource Id: 41608
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    1.595"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.733"
						Top:    1.56"
						Width:  1.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.КД' )
			Background Text: Группа риска
				Resource Id: 41609
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.133"
					Top:    1.595"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: sRISK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.383"
						Top:    1.536"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Группа риска' )
			Data Field: dfAIM_PODR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Long String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.933"
						Top:    1.56"
						Width:  4.05"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Цел. использование' )
			Pushbutton: pb_AIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.083"
					Top:    1.464"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set bTmp=FALSE
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :sAIM FROM nd_txt WHERE ND="||Str(ND)||" and tag='AIM' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT ="UPDATE nd_txt SET txt=:sAIM WHERE nd=:dfND AND tag='AIM' "
						Else
							Set sTmpT ="INSERT INTO nd_txt (nd,tag,txt) VALUES (:ND,'AIM',:sAIM)"
							Set sAIM=STRING_Null
						Call Sel017t( frm_Karta, 'Подробности о целевом использовании кредита', frm_Karta.bTmp, frm_Karta.sAIM, TRUE )
						If bTmp
							If SqlPrepareAndExecute(hSql(), sTmpT )
								Call SqlCommit( hSql() )
								Set dfAIM_PODR = sAIM
							Else
								Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Подробности о целевом использовании'
			Background Text: Дата начала
				Resource Id: 41611
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.333"
					Top:    2.095"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    2.238"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата нанача действия КД' )
			Background Text: Дата окончания
				Resource Id: 41612
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.533"
					Top:    2.095"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.533"
						Top:    2.238"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения КД' )
			Background Text: Тип КД
				Resource Id: 41613
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.033"
					Top:    2.583"
					Width:  0.75"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfAIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.833"
						Top:    2.524"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Тип' )
			Background Text: Подтип
				Resource Id: 41614
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.033"
					Top:    2.833"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfSROK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.833"
						Top:    2.81"
						Width:  1.567"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Подтип' )
			Background Text: Валюта
				Resource Id: 41615
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.333"
					Top:    2.083"
					Width:  0.75"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.333"
						Top:    2.274"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Background Text: Лимит
				Resource Id: 41616
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.533"
					Top:    2.262"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfLIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.433"
						Top:    2.238"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма(Лимит) Договора' )
			Background Text: Дата выдачи
				Resource Id: 41617
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.983"
					Top:    2.083"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDAT3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.883"
						Top:    2.238"
						Width:  1.567"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата первой выдачи' )
			!
			!
			Group Box: Информация о заемщике
				Resource Id: 41599
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.06"
					Width:  12.0"
					Width Editable? Yes
					Height: 1.226"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: 1 
				Resource Id: 41600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   11.483"
					Top:    0.19"
					Width:  0.517"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 14
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Номер клиента
				Resource Id: 41601
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.262"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.167"
						Top:    0.262"
						Width:  1.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рег №' )
			Background Text: ОКПО
				Resource Id: 41602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.567"
					Top:    0.262"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfOKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.7"
						Top:    0.262"
						Width:  1.567"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код ОКПО' )
			Background Text: Клиент
				Resource Id: 41603
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.512"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.167"
						Top:    0.512"
						Width:  9.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Клиент' )
			Background Text: Адрес клиента
				Resource Id: 41604
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.762"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfADR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.167"
						Top:    0.762"
						Width:  9.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Адрес клиента' )
			Background Text: Отрасль клиента
				Resource Id: 41605
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    1.012"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfOE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.167"
						Top:    1.012"
						Width:  9.85"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Отрасль клиента' )
			Radio Button: rbR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Резидент
				Window Location and Size
					Left:   6.617"
					Top:    0.25"
					Width:  1.783"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rbN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не резидент
				Window Location and Size
					Left:   8.767"
					Top:    0.25"
					Width:  2.067"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			!
			Pushbutton: pbSave
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.017"
					Top:    2.179"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
						If SqlPLSQLCommand(hSql(), "CCK.MULTI_INT
								 (dfND, dfKV1,dfPROC1, dfKV2,dfPROC2, dfKV3,dfPROC3, dfKV4,dfPROC4 )" )
							Call SqlCommit( hSql())
						Else
							Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Сохранить мультивалютные % ставки'
			!
			Pushbutton: pbZalog
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.183"
					Top:    4.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Новые Договора залога'
					On SAM_Click
						Call Sel017(hWndMDI,nTip_Ur, 2, ND , Str(nGr),Str(dfRNK), nAcc )
			Pushbutton: pbZalog_All
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.683"
					Top:    4.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Существующие Договора залога'
					On SAM_Click
						Call Sel017(hWndMDI,nTip_Ur,11, ND ,Str(nGr),Str(dfRNK), nAcc )
			Pushbutton: pbZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.183"
					Top:    4.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Gray
				Message Actions
					On SAM_Create
						Set strTip = 'Связь залогов и ссудных счетов'
					On SAM_Click
						Call Bars017r1
								( NUMBER_Null,NUMBER_Null,NUMBER_Null,
								"and KU_109.ACCK in (select acc from nd_acc where nd="||Str(ND)||" )" )
			Data Field: NLS_SS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    3.238"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ссудный счет' )
			Data Field: sProduct
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    1.845"
						Width:  9.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Наименование "Продукта"')
			Data Field: Product
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    1.845"
						Width:  1.467"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Код "Продукта"')
			Background Text: Ставка
				Resource Id: 47944
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.133"
					Top:    2.083"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Основной долг
				Resource Id: 47945
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.583"
					Top:    2.726"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPERIODP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.25"
						Top:    2.929"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Периодичность гашения %' )
			Data Field: dfDenSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.95"
						Top:    2.929"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Кал.день гашения %' )
			Data Field: DATNPSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.65"
						Top:    2.929"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Начало гашения %' )
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nAcc_Lim
					!
					Number: nTmp_Kv
					Number: nTmp_Int
					String: sTmp_Basey
					String: sTmpM
					! String: sNBS
					Number: nSos_A
				Actions
					!
					Set dfND = ND 
					If SqlPrepareAndExecute( hSqlAux(),
							  "SELECT substr(TXT,1,100) into :nametp_ from ND_TXT where nd=:ND  and tag='VIDK'")
							and SqlFetchNext(hSqlAux(), nFetchRes) 
						Call SalEnableWindow( pb_Skoring )
						Call SalShowWindow( nametp_)
					Else
						Call SalDisableWindow( pb_Skoring )
						Call SalHideWindow( nametp_)
					If SqlPrepareAndExecute( hSqlAux(), sSql ) and SqlFetchNext(hSqlAux(), nFetchRes) 
						Call SalDisableWindow( rbR )
						Call SalDisableWindow( rbN )
						Call SalDisableWindow( cb_KL)
						Call SalDisableWindow( cmb1 )
						! Прoдукт
						If SqlPrepareAndExecute( hSql(),
								"SELECT Substr(name,1,100) INTO :sProduct FROM CC_POTRA where id=:Product ")
								and SqlFetchNext(hSql(), nFetchRes) 
						If SqlPrepareAndExecute( hSql(),
								"SELECT max(sos) INTO :nSos_A FROM cc_sos where sos<6 ")
								and SqlFetchNext(hSql(), nFetchRes) 
						!
						Call SalDisableWindow( pb_Podpis )
						Call SalDisableWindow( pb_Podpis_All )
						!
						If nSos = 0  OR nSos = nSos_A
							If nSos = 0 OR nSos = 2 
								Call SalEnableWindow( pb_Podpis_All )
							! If nSos = nSos_A После появления sos = 6 частичная авторизация стала невозможна
								 Call SalEnableWindow( pb_Podpis )
							If nSos = nSos_A or nSos = 0
								Call SalEnableWindow( pb_Podpis )
							!
							If SqlPrepareAndExecute(  hSqlAux(), "SELECT name from  MS_UR_K ORDER BY id INTO :sTmpM " )
								While SqlFetchNext(  hSqlAux(), nFetchRes )
									Call SalListAdd( cmb1, sTmpM )
								Call SalListSetSelect( cmb1, 0 )
							Call SalEnableWindow( cmb1 )
						Else If nSos >= 14
							Call SalDisableWindow( pbZalog )
						If nSrok <= 12
							Set dfSROK = 'До года'
						Else
							Set dfSROK = 'Более года'
						If nCountry=804
							Set rbR=TRUE
						Else
							Set rbN=TRUE
						If nFIN != NUMBER_Null and nOBS != NUMBER_Null 
							Call F_s080(nFIN, nOBS, S080, sRISK )
						Set cb_KL= nVidd - 1
						If nVidd = 3
							If SqlPrepareAndExecute(hSql(),
									  "SELECT t.kv, to_number(n.txt), y.name
									   INTO :nTmp_Kv, :nTmp_Int, :sTmp_Basey
									   FROM nd_txt n, basey y, tabval t 
									   WHERE n.ND=:ND and substr(n.tag,2,3)=to_char(t.kv) and t.basey=y.basey ")
								If SqlFetchNext(hSql(), nFetchRes)
									Set dfKV1   = nTmp_Kv
									Set dfPROC1 = nTmp_Int
									If SqlFetchNext(hSql(), nFetchRes)
										Set dfKV2   = nTmp_Kv
										Set dfPROC2 = nTmp_Int
										If SqlFetchNext(hSql(), nFetchRes)
											Set dfKV3   = nTmp_Kv
											Set dfPROC3 = nTmp_Int
											If SqlFetchNext(hSql(), nFetchRes)
												Set dfKV4   = nTmp_Kv
												Set dfPROC4 = nTmp_Int
						Else
							Call SalHideWindow( dfKV1 )
							Call SalHideWindow( dfKV2 )
							Call SalHideWindow( dfKV3 )
							Call SalHideWindow( dfKV4 )
							Call SalHideWindow( dfPROC1 )
							Call SalHideWindow( dfPROC2 )
							Call SalHideWindow( dfPROC3 )
							Call SalHideWindow( dfPROC4 )
							Call SalHideWindow( pbSave )
						If SqlPrepareAndExecute( hSqlAux(),
								  "SELECT LIM2/100, acc 
								   INTO :dfLIMIT, :nAcc_Lim 
								   FROM cc_lim WHERE nd=:ND and rownum=1 ORDER BY fdat ") 
								and SqlFetchNext(hSqlAux(), nFetchRes) 
						If SqlPrepareAndExecute( hSqlAux(),
								  "SELECT  b.name, f.name , i.S, i.apl_dat,  r.IR 
								   INTO  :dfBASA, :dfPERIODP, :dfDEN, :dfNACHALO, :dfPROC
								   FROM  basey b, int_accn i , freq f, int_ratn r 
								   WHERE i.acc=:nAcc_Lim and b.BASEY=i.BASEY and f.freq=i.freq AND i.acc=r.acc 
								     and i.id=0 and i.id=r.id
								   ORDER BY r.BDAT") 
								and SqlFetchNext(hSqlAux(), nFetchRes) 
						Else
							If SqlPrepareAndExecute( hSqlAux(),
									  "SELECT b.name INTO :dfBASA
									   FROM basey b, tabval t where t.kv=:dfKV and b.BASEY=t.BASEY ") 
									and SqlFetchNext(hSqlAux(), nFetchRes) 
						!
						If nAcc != NUMBER_Null and nSos < 14
							If SqlPrepareAndExecute( hSqlAux(),
									  "SELECT  gl.p_Ncurval(:dfKV, sum(gl.p_Icurval(a.kv,a.ostc,:bDat)),:bDat) /100
									   INTO  :dfSUM_ZAL
									   FROM cc_accp p, accounts a
									   WHERE  p.accs=:nAcc and p.acc=a.acc  ") 
									and SqlFetchNext(hSqlAux(), nFetchRes) 
							Call SalEnableWindow( pbZalog )
							Call SalEnableWindow( pbZalog_All )
						Else
							Call SalDisableWindow( pbZalog )
							Call SalDisableWindow( pbZalog_All )
						! Разное
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :dfAUTOR FROM nd_txt WHERE ND=:ND and tag='AUTOR' ")
								and SqlFetchNext(hSql(), nFetchRes) 
						If SqlPrepareAndExecute(hSql(),
								  "SELECT substr(txt,1,35) INTO :cmb1 FROM nd_txt WHERE ND=:ND and tag='MS_UR' ")
								and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :dfAIM_PODR FROM nd_txt WHERE ND=:ND and tag='AIM' ")
								and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :dfOP_ZAL FROM nd_txt WHERE ND=:ND and tag='PAWN' ")
								and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :dfKDO FROM nd_txt WHERE ND=:ND and tag='KDO' ")
								and SqlFetchNext(hSql(), nFetchRes)
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :dfKNL FROM nd_txt WHERE ND=:ND and tag='KNL' ")
								and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute(hSql(),
								  "SELECT substr(txt,1,50) INTO :dfSSKPS FROM nd_txt WHERE ND=:ND and tag='SSKPS' ")
								and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute(hSql(),
								  "SELECT substr(txt,1,1) INTO :cb_LIMNN FROM nd_txt WHERE ND=:ND and tag='LIMNN' ")
								and SqlFetchNext(hSql(), nFetchRes)
						!
						If SqlPrepareAndExecute(hSql(),"SELECT tag,Substr(txt,1,250) INTO :sTag,:sTxt FROM ND_TXT WHERE nd=:ND and tag in ('DAYSN','DATSN') ")
							While SqlFetchNext( hSql(), nFetchRes )
								If sTag='DAYSN'
									Set dfDenSN=Val( sTxt )
									Call SalShowWindow(dfDenSN)
									Call SalShowWindow(  DATNPSN)
								Else If sTag='DATSN'
									Set DATNPSN=SalStrToDate( sTxt )
								! Else If sTag='MS_NX'
									                                                                                                                                                                                                                                                                                                                                                                        Set MS_NX = sTxt
								! Else If sTag='INIC'
									                                                                                                                                                                                                                                                                                                                                                                        Set cmb_INIC = sTxt
								! Else If sTag='PAWN'
									                                                                                                                                                                                                                                                                                                                                                                        Set ml_Pawn = sTxt
								! Else If sTag='S_SDI'
									                                                                                                                                                                                                                                                                                                                                                                        Set sTxt = DEAL1.DecToch(sTxt) 
									                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.S_SDI = Val( sTxt )
								! Else If sTag='R_CR9'
									                                                                                                                                                                                                                                                                                                                                                                        Set sTxt = DEAL1.DecToch(sTxt) 
									                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.R_CR9 = Val( sTxt )
								! Else If sTag='V_CR9'
									                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.V_CR9 = Val(sTxt)
								! Else If sTag='I_CR9'
									                                                                                                                                                                                                                                                                                                                                                                        If sTxt='0'
										                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.rb_V = TRUE
										                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.rb_N =FALSE
									                                                                                                                                                                                                                                                                                                                                                                        Else 
										                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.rb_N = TRUE
										                                                                                                                                                                                                                                                                                                                                                                        Set DEAL1.rb_V =FALSE
								! Else If sTag='EMAIL'
									                                                                                                                                                                                                                                                                                                                                                                        Call SalListAdd( cmb_Email,sTxt )
									                                                                                                                                                                                                                                                                                                                                                                        Set cb_Email = TRUE
									                                                                                                                                                                                                                                                                                                                                                                        Set cmb_Email = sTxt
								! Else If Subs(sTag,1,1)='P' 
									                                                                                                                                                                                                                                                                                                                                                                        Set sKv = Subs(sTag,2,3)
									                                                                                                                                                                                                                                                                                                                                                                        If SqlPrepareAndExecute( hSqlAux2(),"SELECT kv INTO :nTmp_Kv FROM tabval WHERE to_char(kv)=:sKv ") 
											and SqlFetchNext( hSqlAux2(), nFetchRes)
										                                                                                                                                                                                                                                                                                                                                                                        Set i = i + 1
										                                                                                                                                                                                                                                                                                                                                                                        If i = 1
											                                                                                                                                                                                                                                                                                                                                                                        Set dfKV1   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                        Set dfPROC1 = Val(sTxt)
										                                                                                                                                                                                                                                                                                                                                                                        Else If i = 2
											                                                                                                                                                                                                                                                                                                                                                                        Set dfKV2   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                        Set dfPROC2 = Val(sTxt)
										                                                                                                                                                                                                                                                                                                                                                                        Else If i = 3
											                                                                                                                                                                                                                                                                                                                                                                        Set dfKV3   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                        Set dfPROC3 = Val(sTxt)
										                                                                                                                                                                                                                                                                                                                                                                        Else If i = 4
											                                                                                                                                                                                                                                                                                                                                                                        Set dfKV4   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                        Set dfPROC4 = Val(sTxt)
								! Else If sTag='FLAGS'
									                                                                                                                                                                                                                                                                                                                                                                        If Subs(sTxt,1,1)='1'
										                                                                                                                                                                                                                                                                                                                                                                        Set rb_KN = TRUE
									                                                                                                                                                                                                                                                                                                                                                                        Else 
										                                                                                                                                                                                                                                                                                                                                                                        Set rb_KY = TRUE
									                                                                                                                                                                                                                                                                                                                                                                        If Subs(sTxt,2,1)='1'
										                                                                                                                                                                                                                                                                                                                                                                        Set rb_M = TRUE
									                                                                                                                                                                                                                                                                                                                                                                        Else 
										                                                                                                                                                                                                                                                                                                                                                                        Set rb_D = TRUE
								! Else If sTag='SN8_R'
									                                                                                                                                                                                                                                                                                                                                                                        Set sTxt = DEAL1.DecToch(sTxt) 
									                                                                                                                                                                                                                                                                                                                                                                        Set SN8_Pr=Val( sTxt )
									                                                                                                                                                                                                                                                                                                                                                                        Set cb_SN8_Enable =FALSE
									                                                                                                                                                                                                                                                                                                                                                                        Call SalEnableWindow(SN8_Pr)
								! Else If sTag='CCRNG'
									                                                                                                                                                                                                                                                                                                                                                                        Call cmbRANG.SetSelectById (Val(sTxt))
									                                                                                                                                                                                                                                                                                                                                                                        Set nRANG = cmbRANG.GetKey(SalListQuerySelection(cmbRANG))
									                                                                                                                                                                                                                                                                                                                                                                        If SalListQueryCount ( cmbRANG )>1 or cmbRANG = STRING_Null
										                                                                                                                                                                                                                                                                                                                                                                        Call SalIsWindowEnabled (cmbRANG)
									                                                                                                                                                                                                                                                                                                                                                                        Else 
										                                                                                                                                                                                                                                                                                                                                                                        Call SalDisableWindow(cmbRANG)
			Function: PRINT_SURVEY
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: ID_SESS_
					Number: ID_POTR_
					String: pShablon
					String: strFa
					Number: Answer_Key_
					String: Answer_Value_
					Number: Quest_id_
					String: Quest_Name_
					Date/Time: SDATE_
					Number: Rat_O_
					Number: Rat_B_
					Number: Rat_S_
					Number: KV_
				Actions
					If SqlPrepareAndExecute( hSql(), 
							"select p.shablon,to_number(n1.txt),to_number(n2.txt) ,session_date 
								into :pShablon,:ID_SESS_ ,:ID_POTR_,:SDATE_ 
								from nd_txt n1,nd_txt n2, survey_session s,cc_potr p 
								where n1.nd=:dfND AND n1.tag='ANKET' and n2.nd=n1.nd and to_number(n1.txt)=s.session_id and n2.tag='VID_K' and p.id=to_number(n2.txt)" )
							and  not SqlFetchNext( hSql(), nFetchRes) 
						Call MessageNoWait( 'В базе данных нет заполненной анкеты на данный договор!','Сообщение',5,0)
						Return TRUE
					! Полное имя шаблона1
					Set pShablon = GetTemplateDir() || "\\" || pShablon
					Set strFa = GetPrnDir() || "\\SUR" || Str(dfND)||".XLS"
					Call VisFileDelete(strFa)
					If VisFileCopy( pShablon, strFa )<0
						Call MessageNoWait( 'Не удалось найти файл - '||pShablon||' или скопировать его в папку - '||strFa,'Ошибка',10,0) 
						Return FALSE
					! говорим что хотим работать с Excel
					Set excel.nTargetApp = atExcel
					! создаем excel 
					If excel.OpenApplication()
						Call excel.LoadDoc( strFa )
						! пример заполнения отдельной ячейки (X=1, Y=3)
						! Call excel.SetTableCell(11,2,"до Кредитного договору № " || dfCC_ID ) 
						If SqlPrepareAndExecute( hSql(),
								"select QUEST_ID_P,ANSWER_KEY, ANSWER_VALUE,substr(QUEST_NAME,1,100) Into :Quest_id_,:Answer_Key_,:Answer_Value_,:Quest_Name_ from v_survey_response 
									where session_id=:ID_SESS_ and quest_id_p in (1,17,19,22,32,34,35,37,39,41,60,72,75,76,79,90,91,92,95,96,102)  order by QUEST_ID_P" )
							While SqlFetchNext( hSql(), nFetchRes) 
								Call excel.SetTableCell(27,Quest_id_,Str(Answer_Key_)) 
								Call excel.SetTableCell(28,Quest_id_,Answer_Value_ )
								Call excel.SetTableCell(29,Quest_id_,Quest_Name_ )
								If Quest_id_=72                              ! Запоминаем валюту договора из Анкеты
									Set KV_=Answer_Key_
						! Используем функцию по расчету доходов
						If SqlPLSQLCommand(hSql(),"ccWebPK.SUR_DOX( ID_SESS_ , 0, Answer_Key_)")
							Call excel.SetTableCell(33,1,Str(Answer_Key_))
							Call excel.SetTableCell(34,1,'Сумарный доход')
						! Узнаем Сумму платежа за 3-й мес
						If SqlPrepareAndExecute( hSql(), 
								"select to_char(ccWebPK.SUR_INB(:ID_SESS_,:ID_POTR_,1),'99999999D99') into :Answer_Value_ from dual " )
								and SqlFetchNext( hSql(), nFetchRes) 
							Call excel.SetTableCell(33,2,Answer_Value_)
							Call excel.SetTableCell(34,2,'Сумма платежа за 3-й мес')
						! Курс валюты 
						If SqlPLSQLCommand(hSql(),"gl.x_rat (Rat_O_, Rat_B_ , Rat_S_, KV_ , GetBaseVal(),SDATE_)")
							Call excel.SetTableCell(33,3,Str(Rat_O_))
							Call excel.SetTableCell(34,3,'Курс НБУ')
							Call excel.SetTableCell(33,4,Str(Rat_B_))
							Call excel.SetTableCell(34,4,'Курс покупки')
							Call excel.SetTableCell(33,5,Str(Rat_S_))
							Call excel.SetTableCell(34,5,'Курс продажи')
						Call excel.SetTableCell(33,6,SalFmtFormatDateTime(SDATE_,'dd/MM/yyyy') )
						Call excel.SetTableCell(34,6,'Дата заведения анкеты')
						Call excel.ShowApplication()
						Return TRUE
					Else
						Return FALSE
			Function: F_PRINT_MB
				Description:
				Returns
					Boolean:
				Parameters
					String: strTempl1
					String: TEMA
					Number: KPROLOG
					Number: ND
					String: dfND
					String: CC_ID
					String: cmb_VIDD
					Number: nKv
					Number: colSumma
					Number: colProcStavka
					Number: colSummaP
					Number: nTipd
					Date/Time: dDAT1
					Date/Time: colDatWidKre
					Date/Time: colDatEndDog
					String: NMKB
					String: MFOB
					String: NLSB
					String: MFOB_
					String: NLSNB
					String: MFONB_
					String: BICKB
					String: NBKB
					String: BICB
					String: OKPOB
					String: SSLB
					String: NMKA
					String: MFOA
					String: NLSA
					String: NLSNA
					String: BICKA
					String: NBKA
					String: BICA
					String: OKPOA
					String: SSLA
					Number: colKvZ
					Number: colSummaZ
					!
					Receive String: strReport
				Static Variables
				Local variables
					String: strTempl
					String: sTmp
					Long String: sTiket
					File Handle: hFile
					String: sTicName
					String: sVars
					String: sVals
				Actions
					Set sTicName = strTempl1
					If SalStrScan(sTicName, '.') != -1
						Set sTicName = Subs(sTicName, 1, SalStrScan(sTicName, '.'))
					If not SqlPLSQLCommand(hSql(), "mbk.get_print_value(ND, sTicName, sVars, sVals)")
						Return FALSE
					! ---------------     Печатаем тикет            -----------------
					Set strReport = GetPrnDir()||'\\tc'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
							    '.D' || SalStrRightX('0' || SalNumberToStrX(SalDateDay(SalDateCurrent()), 0), 2)
					! Set strTempl=GetTemplateDir()||'\\tic_kdo.qrd'
					Set strTempl = GetTemplateDir() || '\\' || strTempl1
					Set sTmp = sVals || '~'
					Set sTmp = sTmp || dfND || '~'
					Set sTmp = sTmp || CC_ID || IifS(KPROLOG>0, '/' || Str(KPROLOG), '') || '~'
					Set sTmp = sTmp || SalFmtFormatDateTime(dfDAT1,'dd/MM/yyyy') || '~'
					Set sTmp = sTmp || ' ' || '~'
					Set sTmp = sTmp || cmb_VIDD || '~' || TEMA || '~' || Str(nKv) || '~'
					Set sTmp = sTmp || SalNumberToStrX(colSumma,2) || '~'
							                || SalNumberToStrX(colProcStavka,4) || '~'
							                || SalNumberToStrX(colSummaP,2) || '~'
					If nTipd = 1
						Set sTmp = sTmp || SalFmtFormatDateTime(colDatWidKre,'dd/MM/yyyy') || '~'
								                || SalFmtFormatDateTime(colDatEndDog,'dd/MM/yyyy') || '~'
					Else
						Set sTmp = sTmp || SalFmtFormatDateTime(colDatEndDog,'dd/MM/yyyy') || '~'
								                || SalFmtFormatDateTime(colDatWidKre,'dd/MM/yyyy') || '~'
					Set sTmp = sTmp || NMKB || '~' || MFOB || '~' || NLSB || '~' || NLSNB || '~' ||
							                  BICKB || '~' || NBKB || '~' || BICB || '~' || OKPOB || '~' || SSLB || '~' || MFOB_ || '~' || MFONB_ || '~'
					Set sTmp = sTmp || NMKA || '~' || MFOA || '~' || NLSA || '~' || NLSNA || '~' ||
							                  BICKA || '~' || NBKA || '~' || BICA || '~' || OKPOA || '~' || SSLA || '~'
					If colSummaZ != NUMBER_Null and colSummaZ > 0
						Set sTmp = sTmp || "Застава: Вал " || Str(colKvZ) || '~' || ' сума ' || SalNumberToStrX(colSummaZ,2)
					Else
						Set sTmp = sTmp || '~'
					!
					!
					Call DosReport(strTempl, strReport,
							     sVars || '~CC_ID~dTiket~ODate~OTime~TIPD~TEMA~LCV~colS~colP~colR~colDB~colDE~' ||
							     'NBB~MFOB~NLSB~NLSNB~BICKB~NBKB~BICB~OKPOB~SSLB~MFOB_~MFONB_~' ||
							     'NBA~MFOA~NLSA~NLSNA~BICKA~NBKA~BICA~OKPOA~SSLA~LCVZ~colZ',
							     sTmp, 0)
					Call DosDirectPrint(strReport)
					Return TRUE
		Window Parameters
			Number: nTip_Ur
			Number: ND
			Number: nGr
		Window Variables
			Boolean: bTmp
			Long String: sAIM
			String: sSql
			String: sID
			String: sNAME
			String: ERROR
			: cCnc
				Class: cABSConnect
			: cCnc2
				Class: cABSConnect
			Long String: sDoc
			! String: dfBASA1
			! String: dfBASA2
			! String: dfBASA3
			! String: dfBASA4
			String: sTmp
			String: sTmpT
			Date/Time: bDat
			Number: nId 
			Number: nInd
			Number: ACC_SS
			!
			Number: nCountry
			Number: nFIN
			Number: nOBS
			String: S080
			Number: nAcc
			Number: nVidd
			Number: nSos
			Number: nSrok
			!
			String: strFa
			String: strREP
			String: strCEN
			Number: i
			: excel
				Class: cReportConstructor
			String: smID[*]
			Number: j
			!
			String: strRepName
			String: Vidd_Name
			String: Num_ND
			Number: sdog
			Number: SumProc
			String: bicB
			String: bicA
			String: Nls_SS
			String: Nls_SN
			String: OKPOA
			String: ACCKRED
			String: MFOKRED
			Boolean: CCK_NBU
			String: BANKNAME
			String: sTag
			String: sTxt
		Message Actions
			On SAM_Create
				Set CCK_NBU = GetGlobalOption('CCK_NBU') = '1'
				Call SalHideWindow(dfDenSN)
				Call SalHideWindow( DATNPSN)
				If gOB22 = '1' OR CCK_NBU
					Call SalShowWindow( pb_Podpis_All )
				Else
					Call SalHideWindow( pb_Podpis_All )
				If nTip_Ur = 90
					Call SalDisableWindow( pb_Podpis ) 
					Call SalDisableWindow( pb_Podpis_All ) 
					Call SalDisableWindow( pb_PAWN ) 
					Call SalDisableWindow( pb_KNL ) 
					Call SalDisableWindow( pb_KDO ) 
					Call SalDisableWindow( cb_KL ) 
					Call SalDisableWindow( cb_LIMNN ) 
					Call SalDisableWindow( dfKV1 ) 
					Call SalDisableWindow( dfPROC1 ) 
					Call SalDisableWindow( dfKV2 ) 
					Call SalDisableWindow( dfPROC2 ) 
					Call SalDisableWindow( dfKV3 ) 
					Call SalDisableWindow( dfPROC3 ) 
					Call SalDisableWindow( dfKV4 ) 
					Call SalDisableWindow( dfPROC4 ) 
					Call SalDisableWindow( dfSSKPS )
					Call SalDisableWindow( pb_AIM ) 
					Call SalDisableWindow( pbSave ) 
					Call SalDisableWindow( pbZ ) 
					Call SalDisableWindow( cmb1 ) 
				Set sSql = 
						"SELECT c.rnk,  c.okpo, c.nmk, c.adr, k9.txt, c.COUNTRY, d.cc_id, d.sdate,
						       nvl(c.CRISK,1), nvl(d.obs, 1), ai.name, ad.BDATE, d.wdate, ad.kv,
						       ad.WDATE, ad.MFOKRED||' / '||ad.ACCKRED, d.VIDD, d.sos, ad.accs, 
						       months_between (d.wdate,ad.BDATE),   f.fio, d.PROD, ad.MFOKRED, ad.ACCKRED, sdog,q.name
						 INTO :dfRNK, :dfOKPO, :dfNMK, :dfADR,:dfOE,:nCountry, :dfCC_ID, :dfDAT1,
						      :nFIN, :nOBS, :dfAIM, :dfDAT2, :dfDAT4, :dfKV, :dfDAT3,
						      :dfNLS1, :nVidd, :nSos, :nAcc, :nSrok, :FIO1, :Product  , :MFOKRED, :ACCKRED, :sdog, :dfPERIOD
						 FROM customer c, kl_k090 k9, cc_deal d, cc_aim ai, cc_add ad , staff f,freq q
						 WHERE d.nd=:ND AND d.rnk=c.rnk AND c.oe=k9.K090 (+) AND ai.aim=ad.aim AND 
						       d.nd=ad.nd AND ad.adds=0 AND f.id=d.USER_ID AND ad.freq=q.freq " 
				Set frm_Karta.bDat = GetBankDate()
				Set nId  = GetUserId () 
				Call SalSetWindowText(hWndForm, 'Карта ввода КД ' )
				Call ShowApdVersion('03')
				Call NASELENIE()
			!
			On SAM_ReportStart
				Set i = 1
			On SAM_ReportFetchInit
				Return TRUE
			On SAM_ReportFetchNext
				If i = 1
					Set i =0
					Return TRUE
				Return FALSE
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
				Call DosDirectPrint(strFa)
			!
	Table Window: Tbl_An
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Анализ ресурса, ставок, сроков 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.2"
				Top:    1.833"
				Width:  14.3"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.75"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! 'Порядок сортировки'
							Set strTip = 'Порядок сортировки'
						On SAM_Click
							Call SalTblSortRows( tbl1, 1, TBL_SortIncreasing)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.167"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54563
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.117"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.567"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.25"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call Sel00V( hWndMDI, 3, 
									hWndForm.Tbl_An.KV_ID,
									hWndForm.Tbl_An.NBS_ID, 
									SalFmtFormatDateTime( hWndForm.Tbl_An.DAT2, 'dd-MM-yyyy')  ) 
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54564
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.417"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54565
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    1.298"
							Width:  1.717"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call hWndForm.Tbl_An.F_DAT()
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.117"
							Top:    1.298"
							Width:  1.717"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call hWndForm.Tbl_An.F_DAT()
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.15"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Выполнить расчет"
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Call SalTblSetColumnTitle(  hWndForm.Tbl_An.S0, 
									'Вх.Остатки
									 на начало 
									'||SalFmtFormatDateTime( hWndForm.Tbl_An.DAT1, 'dd-MM-yyyy' ) )
							Call SalTblSetColumnTitle(  hWndForm.Tbl_An.S ,
									'Исх.Остатки 
									 на конец 
									'||SalFmtFormatDateTime(hWndForm.Tbl_An.DAT2, 'dd-MM-yyyy' ) )
							If SqlPLSQLCommand(hSql(),
									 "cck.cc_ANALIZ ( hWndForm.Tbl_An.nTip_Ur, 
									                  hWndForm.Tbl_An.nTip_Kl, 
									                  hWndForm.Tbl_An.nGr, 
									                  hWndForm.Tbl_An.DAT1,
									                  hWndForm.Tbl_An.DAT2 ) " )
								Call SqlCommit( hSql() )
								Call SalSendMsg( pbSum, SAM_Click, 0, 0 )
							Else
								Call SqlRollback(hSql())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait( 'Ошибка при выполнении процедуры !',"CCK.cc_ANALIZ  " , 30, 1 )
				Pushbutton: pbSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.726"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Свернуть/Развернуть по БС"
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Set hWndForm.Tbl_An.FL = NOT hWndForm.Tbl_An.FL
							Call SalTblSortRows(tbl1, 1, TBL_SortIncreasing)
							Set SELE = ""
							Set INTO = ""
							Set ORDE=""
							Set nTmp = TBL_MinRow
							Loop
								If SalTblFindNextRow(tbl1, nTmp, 0, 0)
									Call SalTblSetContext(tbl1, nTmp)
									If tbl1.nFLAG = 1
										Set SELE = SELE||','||tbl1.sSELE
										Set INTO = INTO||','||tbl1.sINTO
										If tbl1.sINTO=':Tbl_An.NBS_ID,:Tbl_An.NBS' 
											Call SalShowWindow( Tbl_An.NBS )
											Call SalShowWindow( Tbl_An.NBS_ID )
										If tbl1.sINTO=':Tbl_An.NLS_ID,:Tbl_An.NLS' 
											Call SalShowWindow(Tbl_An.NLS )
											Call SalShowWindow(Tbl_An.NLS_ID )
										If tbl1.sINTO=':Tbl_An.KV_ID,:Tbl_An.KV' 
											Call SalShowWindow( Tbl_An.KV)
											Call SalHideWindow( Tbl_An.KV_ID)
											Set fKV = TRUE
										If tbl1.sINTO=':Tbl_An.BRANCH_ID,:Tbl_An.BRANCH' 
											Call SalShowWindow( Tbl_An.BRANCH )
											Call SalHideWindow( Tbl_An.BRANCH_ID )
										If tbl1.sINTO=':Tbl_An.AIM_ID,:Tbl_An.AIM' 
											Call SalShowWindow(Tbl_An.AIM )
											Call SalHideWindow(Tbl_An.AIM_ID )
										If tbl1.sINTO=':Tbl_An.USER_ID,:Tbl_An.USER' 
											Call SalShowWindow( Tbl_An.USER)
											Call SalHideWindow( Tbl_An.USER_ID )
										If tbl1.sINTO=':Tbl_An.CRISK_ID,:Tbl_An.CRISK' 
											Call SalShowWindow( Tbl_An.CRISK)
											Call SalHideWindow( Tbl_An.CRISK_ID )
										If tbl1.sINTO=':Tbl_An.OE_ID,:Tbl_An.OE' 
											Call SalShowWindow( Tbl_An.OE)
											Call SalHideWindow( Tbl_An.OE_ID )
										If tbl1.sINTO=':Tbl_An.CREG_ID,:Tbl_An.CREG' 
											Call SalShowWindow( Tbl_An.CREG)
											Call SalHideWindow( Tbl_An.CREG_ID )
										If tbl1.sINTO=':Tbl_An.PRINSIDER_ID,:Tbl_An.PRINSIDER' 
											Call SalShowWindow( Tbl_An.PRINSIDER)
											Call SalHideWindow( Tbl_An.PRINSIDER_ID )
									Else
										If tbl1.sINTO=':Tbl_An.NBS_ID,:Tbl_An.NBS' 
											Call SalHideWindow( Tbl_An.NBS )
											Call SalHideWindow( Tbl_An.NBS_ID )
										If tbl1.sINTO=':Tbl_An.NLS_ID,:Tbl_An.NLS' 
											Call SalHideWindow(Tbl_An.NLS )
											Call SalHideWindow(Tbl_An.NLS_ID )
										If tbl1.sINTO=':Tbl_An.KV_ID,:Tbl_An.KV' 
											Call SalHideWindow( Tbl_An.KV)
											Call SalHideWindow( Tbl_An.KV_ID)
											Set fKV = FALSE
										If tbl1.sINTO=':Tbl_An.BRANCH_ID,:Tbl_An.BRANCH' 
											Call SalHideWindow( Tbl_An.BRANCH )
											Call SalHideWindow( Tbl_An.BRANCH_ID )
										If tbl1.sINTO=':Tbl_An.AIM_ID,:Tbl_An.AIM' 
											Call SalHideWindow(Tbl_An.AIM )
											Call SalHideWindow(Tbl_An.AIM_ID )
										If tbl1.sINTO=':Tbl_An.USER_ID,:Tbl_An.USER' 
											Call SalHideWindow( Tbl_An.USER)
											Call SalHideWindow( Tbl_An.USER_ID )
										If tbl1.sINTO=':Tbl_An.CRISK_ID,:Tbl_An.CRISK' 
											Call SalHideWindow( Tbl_An.CRISK)
											Call SalHideWindow( Tbl_An.CRISK_ID )
										If tbl1.sINTO=':Tbl_An.OE_ID,:Tbl_An.OE' 
											Call SalHideWindow( Tbl_An.OE)
											Call SalHideWindow( Tbl_An.OE_ID )
										If tbl1.sINTO=':Tbl_An.CREG_ID,:Tbl_An.CREG' 
											Call SalHideWindow( Tbl_An.CREG)
											Call SalHideWindow( Tbl_An.CREG_ID )
										If tbl1.sINTO=':Tbl_An.PRINSIDER_ID,:Tbl_An.PRINSIDER' 
											Call SalHideWindow( Tbl_An.PRINSIDER)
											Call SalHideWindow( Tbl_An.PRINSIDER_ID )
								Else
									Break
								If SalIsWindowVisible(hWndForm.Tbl_An.NBS) and SalIsWindowVisible(hWndForm.Tbl_An.KV) 
									Call SalEnableWindow(pbDetails)
								Else
									Call SalDisableWindow(Tbl_An.pbDetails)
							! --------------------------------SELECT--------------------------------
							Set hWndForm.Tbl_An.strSqlPopulate =
									"SELECT  c.DL "||SELE||"  ,
									                     decode(sum(N1), 0, 0, sum(N1*PR  )/sum(N1))SR_PR,
									                     decode(sum(N1), 0, 0, sum(N1*SROK)/sum(N1))SR_SROK,
									                     sum(-c.N1/100), sum(c.N2/100), sum(c.N3/100),
									                     sum(c.N4/100), sum(c.N5/100),
									                     count(distinct a.rnk)count_rnk,count (distinct c.nd)  count_nd,count (distinct a.acc)count_acc 
									INTO  :hWndForm.Tbl_An.DL "||INTO||" , 
									             :hWndForm.Tbl_An.PR, :hWndForm.Tbl_An.SROK,
									             :hWndForm.Tbl_An.S ,              :hWndForm.Tbl_An.DOS, :hWndForm.Tbl_An.KOS,
									             :hWndForm.Tbl_An.DOSN,     :hWndForm.Tbl_An.KOSN,
									             :hWndForm.Tbl_An.COUNT_RNK, :hWndForm.Tbl_An.COUNT_ND,:hWndForm.Tbl_An.COUNT_NLS 
									"  
							! ---------------------------------FROM--------------------------------------
							If fKV = TRUE 
								Set hWndForm.Tbl_An.strSqlPopulate =hWndForm.Tbl_An.strSqlPopulate||
										                                                 "FROM cck_an_tmp c,
										                                                 ps p, tabval t , staff f,cc_aim aim,tobo,accounts a,customer r,stan_fin sf,oe,spr_obl so,prinsider pr "
							Else
								Set hWndForm.Tbl_An.strSqlPopulate =hWndForm.Tbl_An.strSqlPopulate||
										                 " FROM (select gl.p_icurval(kv,n1,:DAT2) N1,gl.p_icurval(kv,n2,:DAT2) N2,
										                                                gl.p_icurval(kv,n3,:DAT2) N3,gl.p_icurval(kv,n4,:DAT2) N4,
										                                                gl.p_icurval(kv,n5,:DAT2) N5,dl,pr,srok,branch,aim,userid,acc,nd  from cck_an_tmp) c, 
										                                                ps p, tabval t  , staff f,cc_aim aim,
										                                                (select decode(tobo.tobo,'/','0',tobo.tobo)tobo,name from tobo) tobo,
										                                                accounts a,customer r,stan_fin sf,oe,spr_obl so,prinsider pr"
							! ---------------------------------WHERE-----------------------------------------
							Set hWndForm.Tbl_An.strSqlPopulate =hWndForm.Tbl_An.strSqlPopulate||
									              " WHERE t.kv=a.kv AND p.NBS=a.NBS and f.id=c.userid and aim.aim=c.aim and c.branch=tobo.tobo and c.acc=a.acc
									                  and a.rnk=r.rnk and r.crisk=sf.fin(+) and r.oe=oe.oe(+) and r.c_reg=so.c_reg(+) and r.prinsider=pr.prinsider(+)                   
									                GROUP BY  c.DL "||SELE||" 
									                ORDER BY  "||Subs(SELE,2,500)|| IifS(SalStrLength(SELE)>1,",","")||"c.DL desc "
							! Call SalMessageBox ( Tbl_An.strSqlPopulate,'Error', MB_Ok )
							! If hWndForm.Tbl_An.FL  !! по БС
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Call SalShowWindow( hWndForm.Tbl_An.NBS )
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Call SalShowWindow( hWndForm.Tbl_An.NAME )
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Set hWndForm.Tbl_An.strSqlPopulate =
										"SELECT  c.NBS,c.nls , substr(p.NAME,1,40), c.KV, t.NAME, 
										                     c.PR, c.SROK, -c.N1/100,
										                     c.N2/100, c.N3/100,
										                     c.N4/100, c.N5/100, c.DL , 
										                     c.USERID,c.BRANCH,c.AIM
										 INTO :hWndForm.Tbl_An.NBS,         :hWndForm.Tbl_An.NLS,  :hWndForm.Tbl_An.NAME, :hWndForm.Tbl_An.KV,
										             :hWndForm.Tbl_An.NAMEV,  :hWndForm.Tbl_An.PR, :hWndForm.Tbl_An.SROK,
										             :hWndForm.Tbl_An.S ,              :hWndForm.Tbl_An.DOS, :hWndForm.Tbl_An.KOS,
										             :hWndForm.Tbl_An.DOSN,     :hWndForm.Tbl_An.KOSN,:hWndForm.Tbl_An.DL,
										             :hWndForm.Tbl_An.USERID, :hWndForm.Tbl_An.BRANCH, :hWndForm.Tbl_An.AIM
										 FROM   cck_an_tmp c, ps p, tabval t 
										 WHERE t.kv=c.kv AND p.NBS=c.NBS  ORDER BY c.KV, c.NBS "
							! Else !! итоги
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Call SalHideWindow( hWndForm.Tbl_An.NBS )
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Call SalHideWindow( hWndForm.Tbl_An.NAME )
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Set hWndForm.Tbl_An.strSqlPopulate =
										"SELECT  c.KV, c.DL, t.NAME, 
										      decode( sum(c.S),0, 0, sum(c.PR  *c.S)/sum(c.S)), 
										      decode( sum(c.S),0, 0, sum(c.SROK*c.S)/sum(c.S)),
										     -sum(c.S)/100, sum(c.DOS)/100, sum(c.KOS)/100,
										      sum(c.DOSN)/100, sum(c.KOSN)/100  
										 INTO :hWndForm.Tbl_An.KV, :hWndForm.Tbl_An.DL, :hWndForm.Tbl_An.NAMEV,
										      :hWndForm.Tbl_An.PR, :hWndForm.Tbl_An.SROK,:hWndForm.Tbl_An.S,
										      :hWndForm.Tbl_An.DOS,:hWndForm.Tbl_An.KOS,:hWndForm.Tbl_An.DOSN,
										      :hWndForm.Tbl_An.KOSN 
										 FROM  cck_analiz c,  tabval t WHERE t.kv=c.kv 
										 GROUP by c.KV, c.DL, t.NAME  ORDER BY c.KV , c.DL desc"
							Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
							Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_An.strSqlPopulate, TBL_FillAll)
							Call SalWaitCursor(FALSE)
				Child Table: tbl1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.26"
							Width:  4.7"
							Width Editable? Yes
							Height: 1.333"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? No
					Contents
						Column: nSORT
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title: Порядок
							Visible? Yes
							Editable? No
							Maximum Data Length: 1
							Data Type: Number
							Justify: Center
							Width:  0.85"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: sSELE
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: sINTO
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: sNAME
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title: Разрез
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.833"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: nFLAG
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title: Отм
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.517"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Check Box
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value: 1
									Uncheck Value: 0
									Ignore Case? No
							List Values
							Message Actions
								On SAM_AnyEdit
									If nFLAG != 0
										Set n3 = n3 + 1
										Set colN = n3
										Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
										Set nN = 0
										Set nRw = TBL_MinRow
										While SalTblFindNextRow(hWndForm, nRw, 0, 0)
											Call SalTblSetContext(hWndForm, nRw)
											If nFLAG
												Set nN = nN + 1
												Set nSORT = nN
									Else
										Set colN = 0
										Set nSORT = NUMBER_Null
										Set nN = 0
										Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
										Set nRw = TBL_MinRow
										While SalTblFindNextRow(hWndForm, nRw, 0, 0)
											Call SalTblSetContext(hWndForm, nRw)
											If nFLAG
												Set nN = nN + 1
												Set nSORT = nN
						Column: colN
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Class Default
							Data Type: Number
							Justify: Class Default
							Width:  Class Default
							Width Editable? Class Default
							Format: Class Default
							Country: Class Default
							Input Mask: Class Default
							Cell Options
								Cell Type? Class Default
								Multiline Cell? Class Default
								Cell DropDownList
									Sorted? Class Default
									Vertical Scroll? Class Default
									Auto Drop Down? Class Default
									Allow Text Editing? Class Default
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Class Default
							List Values
							Message Actions
					Functions
					Window Variables
						Number: nRw
						Number: nN
						String: SELE
						String: INTO
						String: ORDE
						Boolean: fKV
					Message Actions
						On SAM_Create
							Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						On SAM_DoubleClick
							Set nFLAG=1-nFLAG
							Call SalSendMsg( nFLAG,SAM_AnyEdit,0,0)
							! SalTblFetchRow ( Tbl1, TBL_MaxRow )
							Call SalTblSetFocusRow ( hWndForm, 9 )
							! Call SalScrollSetPos ( hWndForm, SalTblFindPrevRow(hWndForm,TBL_MaxRow,0,0) )
							Call SalScrollSetPos ( hWndForm,8)
						On SAM_FetchRowDone
							Set colN = 0
				Frame
					Resource Id: 51899
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    1.071"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Etched
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Background Text: Задайте период
					Resource Id: 62908
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.25"
						Top:    1.0"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: 3D Shadow Color
					Background Color: Default
				Background Text: Критерии формирования
					Resource Id: 62909
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.367"
						Top:    0.07"
						Width:  3.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: 3D Shadow Color
					Background Color: Default
				Pushbutton: pbTable
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Табличная форма счетов для выбранного ресурса'
						On SAM_Click
							Set nTmp = TBL_MinRow
							Set sTmp="a.acc in (select cck_a.acc from cck_an_tmp cck_t,customer cck_r,accounts cck_a 
									        where cck_t.acc=cck_a.acc and cck_a.rnk=cck_r.rnk and cck_t.dl='"||Tbl_An.DL||"' "
							Loop
								If SalTblFindNextRow(tbl1, nTmp, 0, 0)
									Call SalTblSetContext(tbl1, nTmp)
									If tbl1.nFLAG = 1
										If tbl1.sINTO=':Tbl_An.NBS_ID,:Tbl_An.NBS' 
											Set sTmp=sTmp||" and cck_a.nbs="||Tbl_An.NBS_ID
										If tbl1.sINTO=':Tbl_An.NLS_ID,:Tbl_An.NLS' 
											Set sTmp=sTmp||" and cck_a.nls="||Tbl_An.NLS_ID
										If tbl1.sINTO=':Tbl_An.KV_ID,:Tbl_An.KV' 
											Set sTmp=sTmp||" and cck_a.kv="||Str(Tbl_An.KV_ID)
										If tbl1.sINTO=':Tbl_An.BRANCH_ID,:Tbl_An.BRANCH' 
											Set sTmp=sTmp||" and cck_t.branch='"||Tbl_An.BRANCH_ID||"'"
										If tbl1.sINTO=':Tbl_An.AIM_ID,:Tbl_An.AIM' 
											Set sTmp=sTmp||" and cck_t.aim="||Tbl_An.AIM_ID
										If tbl1.sINTO=':Tbl_An.USER_ID,:Tbl_An.USER' 
											Set sTmp=sTmp||" and cck_t.userid="||Tbl_An.USER_ID
										If tbl1.sINTO=':Tbl_An.CRISK_ID,:Tbl_An.CRISK' 
											If Tbl_An.CRISK_ID="" 
												Set sTmp=sTmp||" and cck_r.crisk is null"
											Else
												Set sTmp=sTmp||" and cck_r.crisk="||Tbl_An.CRISK_ID
										If tbl1.sINTO=':Tbl_An.OE_ID,:Tbl_An.OE' 
											If Tbl_An.OE_ID="" 
												Set sTmp=sTmp||" and cck_r.oe is null "
											Else
												Set sTmp=sTmp||" and cck_r.oe="||Tbl_An.OE_ID
										If tbl1.sINTO=':Tbl_An.CREG_ID,:Tbl_An.CREG' 
											Set sTmp=sTmp||" and cck_r.c_reg="||Tbl_An.CREG_ID
											If Tbl_An.CREG_ID=""
												Set sTmp=sTmp||" and cck_r.c_reg is null"
											Else
												Set sTmp=sTmp||" and cck_r.c_reg="||Tbl_An.CREG_ID
										If tbl1.sINTO=':Tbl_An.PRINSIDER_ID,:Tbl_An.PRINSIDER' 
											If Tbl_An.PRINSIDER_ID=""
												Set sTmp=sTmp||" and cck_r.prinsider is null"
											Else
												Set sTmp=sTmp||" and cck_r.prinsider="||Tbl_An.PRINSIDER_ID
								Else
									Break
							Set sTmp=sTmp||")"
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				Frame
					Resource Id: 18328
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.183"
						Top:    0.155"
						Width:  4.9"
						Width Editable? Yes
						Height: 1.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Picture: pic1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   9.983"
						Top:    0.071"
						Width:  4.1"
						Width Editable? Yes
						Height: 1.0"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					File Name: Centura:BMP
.data RESOURCE 5 32 1 2676983112
0000: 1A2F0100E4570000 0000000000000000 02000043656E7475 72613A00424D5000
0020: 062F010000040000 00424D062F330000 3600000000280000 0030010200550000
0040: 0001003018000000 D02EF001000000FF 83CED3D7CED3FFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0100: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0120: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0140: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0200: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0220: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0240: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0280: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
02A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
02C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
02E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0300: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0320: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0340: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0360: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0380: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
03A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
03C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
03E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0400: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0420: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0440: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0460: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0480: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
04A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
04C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
04E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0500: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0520: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0540: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0560: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0580: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
05A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
05C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
05E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0600: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0620: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0640: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0660: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0680: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
06A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
06C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
06E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0700: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0720: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0740: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0760: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0780: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
07A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
07C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
07E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0800: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0820: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0840: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0860: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0880: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
08A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
08C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
08E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0900: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0920: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0940: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0960: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0980: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
09A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
09C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
09E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0A00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0A20: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0A40: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0A60: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0A80: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0AA0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0AC0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0AE0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0B00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0B20: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF1FA7A7A7A096 9696CED3CEFFFFFF
0B40: FF038C8C8C909090 F4CED3CEFFFFFF7F B100B1B18A8A8AAA AAAAF4CED3CEFFFF
0B60: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0B80: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0BA0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FF3F929280924444 442D2D2D1F494949
0BC0: A0A8A8A8CED3CE0F A5A5A574807474AB ABABCED3FECE0179 79793333332D1C2D
0BE0: 2D313131005C5C5C A7A7A7CED3017A7A 7A3232322D1C2D2D 30303000626262BB
0C00: BBBBB4B480B45454 542D2D2DFFFFFF1F 212121005D5D5D90 90904040F0402D2D
0C20: 2DFFFFFF03141414 5E5E5E0078787839 39392D2DFE2DFFFF 7F250025252C2C2C
0C40: 95959504CED34A4A 4A2D2D2E2D30305C 805C5CB2B2B2CED3 FECE0F7B7B7B2DFC
0C60: 2D2D003333336B6B 6BB6B600B6BDBDBD 5959592DFC2D2DA0 575757CED3CEFF1F
0C80: 7F7F7FC03131312D 2D2D053030686868 CE02D3AFAFAF5C5C 5CC02F2F2F2D2D2D
0CA0: 01363636818181CE FAD3CE077474744B 4BA04B3333332D2D FF073838385C5CE8
0CC0: 5CCED3CEFF007C7C 7C3434342D2D0E2D 41414190D89090CE CE075B5B5B9696EC
0CE0: 96CECE435454542D 2D3F3E3E403EA3A3 A3CED3CEFFFFFFFF FFFFFFFFFFFFFFFF
0D00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0D20: FFFFFFFFFFFFFFFF FF81676767000000 030D0D0D7E7E7EF4 CED3CE2F7F7F1700
0D40: 17175B5B5BB9B9B9 F4CED3CE0F2C2C2C 001C00001A1A1AA0 8A8A8ACED3CE0F38
0D60: 3838001C00002727 27C0A4A4A4C0C0C0 0192929211111100 FC0000FFFFFF205A
0D80: 5A5ACED359598059 020202000000FFFF FF1F5E5E5E00B1B1 B14141410000FE00
0DA0: FFFFFF1B20959595 36CECE00002E0020 2096D89696CECEFF 01BDBDBD71717200
0DC0: FC000000313131A2 A2A2C0C00EC0A1A1 A114001414000000 161616B0AAAAAACE
0DE0: CEFF0BBDBD707071 C00B0B0C00000001 2D2D2DB0B0B0CE1A D3CE8F8F8FC01D1D
0E00: 1D00000041464646 CED3CE1FBCBCBCC0 3E3D3E000000FFF1 010101FA00000516
0E20: 166C6C6CCEFAD3CE 0732323200000000 0404045F5F5FCEFA D3CE006565650404
0E40: 055D5D405DBEBEBE CED3CE5F00003F72 72E872CED3CEFFFF FFFFFFFFFFFFFFFF
0E60: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0E80: FFFFFFFFFFFFFFFF FFFFFF05676A0200 0F0202000F0D1B7F 7E83F4CED3CE05A5
0EA0: A635333C02020025 232F9F9EA0F4CED3 CE0F2E2C38021A00 021B1A26A08A8A8C
0EC0: CED3CE0F39384102 1A0002282731C0A4 A4A5C0C0C0059294 13111F021A00021D
0EE0: 1B26C03C3A423B3A 4240433B3A423C3A 3B1F2D2B3520605F 66CED35A59005F03
0F00: 021103000F088005 1427252F3B3AFE3B FF01431C1A255F5E 6210B1B1B1414802
0F20: 000D020B07163BD8 39423C3C93433B42 3B653C423B330031 3A302F3895959734
0F40: CED3CE02002D0221 2B96D09698CED3CE 3FB2B100B268676D 120F1E02FA000280
0F60: 33313BA2A2A2C02E C0A1A31610142202 00181623B0AAAAAB CECE7FB000B0B165
0F80: 646A130F1EF70201 2E2D37B0B0B0CE5B CE8F91201E1D2902 0003004147464DCE
0FA0: D3CE5F5A60A00705 1402000300100E0B 19302F374D004B52 5250574F4D540222
0FC0: 2A0F0D1A02000D02 161321A9D8A9AACE CE0733323D020001 0604145F5F64CE1A
0FE0: D3CEA6A6A8301E1C 2902171540238382 86CED3CE1F03000F 1E03107372E878CE
1000: D3CEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1020: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF01 68676E06001F0500
1040: 001E120D29807E87 34CED3CEBABA00BA 6B68730F09260502 00080221484555F4
1060: CED3CE0F302C4406 0E001F1E1A32A08A 8A8ECED3CE0F3B38 490600001E05001E
1080: 2A273CC0A4A4A6C0 C0C0019392981611 2C06120006005D5B 64F6CECEFF1FACAB
10A0: AD309C9CA0CE5B59 0865070206001F18 C0132D7D7C83CEFE CEFF039493979797
10C0: 9900B1B1B243414F 0600641E061F1EBE D8BEBECECEFF7FB3 00B3B4929295AEAD
10E0: AF34CED3CE06002D 05243797D0969BCE D3CE07AEAEAF5F5C 406A16112D060006
1100: C8001E051F050035 3145A2A2A3C0C00E C0A2A1A51900142E 06001F1A162FA0AA
1120: AAACCED3CE4FA9A9 5C80596616102D05 00BE050601312D41 B0B0B1CE1AD3CE90
1140: 8F95C0211D340500 1E41484654CED3CE 03A6A5A7312D4334 060006120D016160
1160: 69ACACADCE5AD3CE BDBD009C9C9E6765 6F1611682B050005 65D0636BCED3CE07
1180: 3632490500001F09 0422615F6ACE0AD3 A7A8454254600802 220600030022423E
11A0: 51A7A6A9CE9AD3CE 050012061E061F74 72EC7ECECEFFFFFF FFFFFFFFFFFFFFFF
11C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
11E0: FFFFFFFFFFFFFFFF FFFF016967710900 2F0800002F150D37 807E8CB6CECEB140
1200: B4251E420800081F 0F0633B0828287CE CE0F322C4F081A00 08201A3FB08B8A90
1220: CECE0F3D3851081A 00082D2746C0A4A4 A8C0C0C005939B18 1139081A00085E5B
1240: 68F6CECEFFFFBF5B 406B0A0230080019 80133A7E7C88CED3 FECEFFFF02B1B244
1260: 41570800002E0800 2F211A3FBED8BEBE CECEFFFFFF3F0800 262E2F264297D096
1280: 9DCED3CE00B2B2B4 585466130A483609 00090008FF803631 4DA2A2A4C02EC0A2
12A0: A71B10143B08001D 163CA0AAAAAECED3 CE0F55516415D00D 38090009FE080132
12C0: 2D4AB0B0B2CE5BCE 9097A0221D400800 086149465CCECE03 8D8C91221B403409
12E0: 000937324052B7B7 B8CED3CEFF07A0A0 A13630684D090008 4DD84B5FCECE0737
1300: 32540800002E0C04 31625F70CE02D37C 7A861A133AD40900 082F09130A5B5668
1320: B09CB0B109003E09 7572E884CED3CEFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1340: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1360: FFFFFFFF016A6775 0B003E0B0200170D 45827E9134CED3CE 545068670B000B0E
1380: 00033F0D013E0C00 3E80332A57B7B7B9 CE0DCE352C5C0C1A 000C231A4CA08C8A
13A0: 92CED3CE0F3F385A 0B1A000B2E2752C0 A5A4AAC0C0C00194 929F1B11470C1A00
13C0: 0B5F5B6CF6CECEFF FF3F5E5940710D02 3F0C001DC013487F 7C8CCEFECEFFFF02
13E0: B1B347415F0C000D 0C20164AA980A7B0 ABA9B2ABA93F5651 406D625F6ECED3CE
1400: FF3F0C002D0C294E 981896A0CEB4B3B6 00514D660F04410C 000D0C1A0F454DD0
1420: 48630B000B803931 56A2A2A6C00EC0A3 A1AA1E5014490C00 204930ABAAB0CEA8
1440: A700AA514C661409 430C1A000C160B44 A04F49660C000C01 352D54B0B0B3CE1A
1460: D3CE918F9AA0261D 4C0C000C414C4662 CED3CE038C8B9324 1B4C240B000D014A
1480: 43EC68CECEFF3F5A 5368750C000C4ED0 4965CED3CE073B32 600C000110044163
14A0: 5F759B809BA0332B 550B00060B190F44 100528400C00294F 989897A0CE0B003E
14C0: 0B7672E88BCED3CE FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
14E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF056A79
1500: 0E004E0E02001A0D 53827E9606CE9E9D A41F1100550F004E 11024F48803F6E2D
1520: 215D0F0000150650 696480CED30DCE37 2C670F00004D0E00 4D251A57A08C8A94
1540: CED3CE0F4038630E 02000F004E31275D C0A5A4ACC0C0C001 9592A21E11540F18
1560: 004D0E5F5B71F4CE D3CEFFFF3F5F5920 770F024D0F4E1FC0 1355807C90CEFECE
1580: FFFF02B1B4484166 0F00A44D0F4E0E4E CD4D4D0EFB4E6162 5F72CECEFF3F0E00
15A0: 210F004E2A599800 96A2A4A2A8484169 3012034E0F100100 4E2A1F587E7B8A61
15C0: 405E720E004D0F4D 003A3161A2A2A7C0 C0AEC0A3AB101456 0E0022165620ABAA
15E0: B1A1A14B44006A17 09520F004E0F0325 1A56807D8D809B99 A80E004E0F004D36
1600: 2D5FB0B0B4CE1AD3 CE928F9D80271D58 0E004D0E604E4D46 6ACECE0B8C95261B
1620: 58040F000F014E4C 43EC71CECEFF3F5B 53687E0E000E4FD8 496CCECE073D326B
1640: 0F000112044F5B55 746A90648417090E 00001608507A7788 4741286610010E4D
1660: 45003C67B7B6B90E 004E1A0F4E4D7772 EC90CECEFFFFFFFF FFFFFFFFFFFFFFFF
1680: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
16A0: FFFFFFFFFFFFFFFF FF016B677C11005D 1102001D0D61837E 9A04CED3483F7312
16C0: 00085D1200261863 8D00899D6B658215 045E04120032246C 98950CA3CE392C73
16E0: 121B11271A64B08C 8A96CECE0F41386C 111A0012332767C0 A5A4ADC0C0C01196
1700: 92A51162121A0011 605B75F4CED3CEFF FFBF5F607E12025D 1222C01362807C94
1720: CEFECEFFFF06B149 416D1200ED1211DB 1211FF69635FCECE FF3F11002D122D65
1740: 72006F8641367014 025E061213015D33 260066878494BBBB BC62D05E75110012
1760: 803C316AA3A2A8C0 2EC0A3AE23101463 1100241663008280 8E41366E1706685F
1780: 120012318024668F 8C9CCED3A09C99AB 11001201382D69B1 B0B5CE5AD3CE92A0
17A0: A02A1D6411001161 4E4672CECE038D8B 97291B6404120012 015D4D43E87ACED3
17C0: CEFF3F5D53688711 001150D04973CED3 CE073F3276120009 1504443A6D27D818
17E0: 6411110049406DBD BDBD8D8B40992D1F 6511001980086077 728B11003C120078
1800: 72EC97CECEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1820: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF016C677F1400
1840: 6D1402001F0D6F84 7E9F007F7C8E1C09 6E14000117036D61 568FBC00BCBDBBBA
1860: BC37287604140018 056E4B410078A5A5 A73B2C7F141B1429 1A70B08D8A98CECE
1880: 0F433875141A0014 342772C0A5A4AFC0 C0C00596A923116F 141A0014615B79F4
18A0: CED3CEFFFF3F6159 608415026D1424C0 136F817C98CEFECE FFFF80B2B1B54A41
18C0: 75140D14291870B1 80B0B8B3B2B9B3B2 3F594F6080645F79 CECEFF3F14000D14
18E0: 26147028E0177017 026D0016006D3526 71908E609BBEBDBE CE63D05E79140014
1900: 003D3173A3A2A9C0 C00EC0A4A1B02510 1470140023106F80 2D1D7116016D140D
1920: 14352771998096A5 BFBEBFCED3A29CAE 14001401392D73B1 B0B6CE5AD3CE92A3
1940: A42D1D140014614F 4679CECE0B8D982A 1B70061415016D4F 43EC83CECEFF3F5E
1960: 53689014001452D0 497BCED3CE074032 821400091601200E 6E1558006D143071
1980: 30ADACB4CEBEBE00 BE7E779B1F0C6F14 C323126F143E1479 72EC9DCECEFFFFFF
19A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
19C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF016D67841700 7C1800007C220D7C
19E0: 79709D0042328918 007D1700012F1C80 8F8BA1CE1AD3CE7C 778E201C057B1700
1A00: 2916007D857F9E3A 28881700007D1800 7C2D1A7DB08D8A9B CECE0F46387D180B
1A20: 187D37277DC0A6A4 B1C0C0C0019792AC 25117C180D7C7D62 5B7DF4CED3CEFFFF
1A40: 3F6259208A19027D 187C27C0137C827C 9CCEFECEFFFF06B2 4D417E1800211700
1A60: 7C2D7CBEDCBEBFCE FF7FBAD0B9BBB7B6 CE3ECE1800FD1829 7D187C017C803B2A
1A80: 7E93919DCE7DCE64 B85E7D1700004031 7DA3A2ABC0C02EC0 A4B22858147C1718
1AA0: 7D3B7C1A02007C3E 2F809895A7CEFBCE A09D99B118001801 3C2D7DB1B0B7CE1A
1AC0: D3CE948FA6D02F1D 7C187D61514681CE CE038E8B9C2D1B7C 02187C19017C5143
1AE0: EC8CCECEFF3F6053 689918001854D049 82CED3CE0743328D 18007D171803210A
1B00: 7C6A6387A0BABABB CED3CE01A3A2A946 38821ADA0218183F 7B72ECA3CECEFFFF
1B20: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1B40: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF056D871A00 8C1A0200250D8A3C
1B60: 2A8820240B8B1A00 1D03608B605495CE CEFF204B3E831A00 1C01008C4737872B
1B80: 13891A00008B1B00 8C2F1A89B08D8A9D CECE0F4738861A18 008C1A392788C0A6
1BA0: A4B2C0C0C0019892 AF28118A1B1A001A 625B83F6CECEFFFF 3F635960911B028B
1BC0: 1A2AC0138A837CA0 CEFECEFFFF02B2B6 4D41851A006D1A2A 89C082A68A84A68A
1BE0: FF7F73806A9C837B A4CED33ECE1A00FD 1A031D028B443685 B09B99A4CECE7F65
1C00: D85E831A1A804131 87A3A2ACC00EC0A5 A1B42AD014891B00 1A071B008B473760
1C20: 8B9D99ABCECEFFA0 9E99B41A001A013E 2D87B1B0B8CE5BCE 94A990311D891B8C
1C40: 1A41524689CED3CE 0B8E9D2F1B89061A 1B018B5343EC95CE CEFF3F615368A21A
1C60: 001A55D8498ACECE 074532991A007D1A 1D03594A97B0AEB7 F6CECE0F86819B2D
1C80: 4817891A8B1A8C3E 1A7C72ECAACECEFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1CA0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1CC0: FFFFFFFF016E678B 1E009B1E02002103 9B22059A001E009C 1D009C3219609AAC
1CE0: AAB4CECEFF00A09D AC3219951E00109B 24089A039B1D1800 9B1E311A95A08E8A
1D00: 9FCED3CE0F48388F 1D1A001E3B2792C0 A7A4B4C0C0C00598 B32B11971E1A001E
1D20: 635B87F6CECEFFFF 3F645940971F029A 1D002B801397837C A5CED3FECEFFFF02
1D40: B2B74F418D1E004D 1E20032A80109A2B 10992B10C72A1099 6F2B27C00B9A6F61
1D60: ADCE3ECE1E007D1E 21019A51438BAAA9 B0F6CECE7F65D187 1E001E80433190A4
1D80: A2ADC02EC0A5B72D D814971E1E074D3E 8EAAA8ECB4CECEFF A29EB81D001D013F
1DA0: 2D91B1B0B9CE5BCE 94ACB0331D951E1E 61534690CECE0B8E A0321B95061E1F01
1DC0: 9A5443E89ECED3CE FF3F635368AB1E00 1E56D84991CECE07 4832A41E006D1E1D
1DE0: 31C019958F89AACE FECE0FB5B4B663C0 589521049A1E3E1E 7D72ECB0CECEFFFF
1E00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1E20: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF016F678F21 00AB21FE003F665B
1E40: EC94CECEFF80B8B8 BA5D528F213D21AC 210E00AB341AA2A0 8E8AA2CED3CE097C
1E60: 7A3B239E211000AA 21003318A200A29D B7BFBFBFB6B500B9 5F538F2808A72108
1E80: 00AB21AA524394F6 CECEFFFF07929199 4A3700982101A921 00AB2AC00CA67A6E
1EA0: ADCEFECEFFFF00AD ABB8402B9C2100FC AA217FABFA21AAFF C37160B6CE06CE66
1EC0: 5E8B21007D212D80 10A4A8A4BACED3FE CE7F54D045932100 21003C259E9D99B0
1EE0: BFBF00BFBDBDBE65 5C8B28D80AA72121 877B7984CEFDCE1F BCBBBEB05D518F21
1F00: 2101361CA1AEACBA CE03B0AFB362588D A02E12A421002161 452F9ECECE838178
1F20: A72E121BABA93E27 609D94939ACECEFF 079B98AA3F29649C 21AA2148D8329FCE
1F40: CE008F8C9F351BA1 21007D2136C01DA0 928CADCEFECE7F78 4070992606A721AB
1F60: 3F4F3D6096ABAAB2 CECEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
1F80: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF01
1FA0: 7067922300BA231E 002400BA83BB3A1E ABCEFDCEFF07A29D B63E25E8A8230023
1FC0: 0B24BA361AAEB08F 8AA4CECE01847E9D 7064A670FE64207D 759EBCBCB7B540BB
1FE0: 756BA1706470FFB0 8F8D9CCECEFFFF07 9793A97368E8A370 647003786EA1A9A6
2000: B3F6CECEFFFFA085 8099706470FFFFFF 7F5EC04DA67D70B4 CEA6CE706470FF93
2020: 8580CED3FECE2F91 9C70FA647007817B 9BB8B708B9BDBD76 6CA170FB7087827D
2040: 9CCEFDCE1FBDBCBE F47064700F7F789C CE03B2B0B87A719F F470647007A58F8A
2060: A3AA00A9AF7B739E 7064A63F726660A4 948EACCECEFF079F 9BB570647D7071D8
2080: 65A58FCEA0928AB0 706470FFC39E99B4 CEFECE7F84D07AAB 706470FF61ACA9B9
20A0: CECEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
20C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF01 7067942500C4267C
20E0: 00C4C3802A06BF8C 83AFCEFDCEFF27B7 B6716380AD2D0ABD 2600C41F381AB6B0
2100: 8F8AA5CECEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF7F B3C0B1B8ACAAB5CE
2120: FECEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2140: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2160: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF3F918E 409D452BAD250026
2180: 71C32600C4802702 C26E629ECEFDCEFF 07AFADB3625278A0 2D0A261F2C09BE80
21A0: 5C4BA2A7A5ADCEFD CEFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
21C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
21E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2200: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2220: FFFFFFFFFFFF0FBD BDBDB9E0B9B9B8B8 B83FB7B7FEB7FFC7 B8B8B80FB9B9B9BB
2240: D8BBBBCECEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2280: FFC0AAAAAA9F9F9F FFFFFFFFFFFF01A0 A0A0A1A1A1A200A2 A2A4A4A4A5A5A5B0
22A0: B8B8B8CECEFFFFFF 01B0B0B0A0A0A09F FC9F9FFF7FA0C1A0 B0B0B0CEFECEFFFF
22C0: FFFFFFC0B2B2B29F 9F9FFFFF3FA6A6E8 A6CED3CE1FA4A4A4 F89F9F9FFFFF82A0
22E0: A0B4B4B4CEFDCEFF FFFFFFD2A4A49F9F FFFFFF61A5A5A5CE CEFF07A8A8A8A5A5
2300: 00A5A2A2A28B8B8B 720072726E6E6E6D 6D6D006A6A6A6969 696666FE66FF0067
2320: 67676A6A6A6B6B00 6B6D6D6D72727282 008282A1A1A1A5A5 A5B0BBBBBBCECEFF
2340: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2360: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFC08686866666
2380: 66FFFFFFFFFFFF8F 686868036B6B6B6C 6C6C007F7F7F8B8B 8B9393E893CED3CE
23A0: FFFF05B0B0787878 66FC6666FF7F6881 688F8F8FCED3FECE FFFFFFFFFFC09A9A
23C0: 9A666666FFFF3F7D 7DEC7DCECE1F7878 78FA6666FFFF8268 689E9E9ECEFDCEFF
23E0: FFFFFFC06C6C6C66 6666FFFF3F696960 69A3A3A3CECE1FA1 A1A1008C8C8C6F6F
2400: 6F6B6B806B686868 666666FFFFFFFFFF FF0B68686C6C6C00 8383839090909C9C
2420: EC9CCECEFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2440: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF008C
2460: 8C8C6767676666FE 66FFFFFFFFFFFFFF BF6700677272727D 7D7DA3D8A3A3CECE
2480: FF0F8A8A8A67E867 676666FFFF036F6F 6FA2A2A2F6CECEFF FFFFFF5FB0B0C076
24A0: 7676666666FFFF3F 8080EC80CECE1F7E 7E7EF8666666FFFF 07777777B2B2ECB2
24C0: CECEFFFFFF5F7F7F F8666666FFFF3F76 764076BDBDBDCED3 AC00ACAC79797969
24E0: 6969FA6666FFFFFF FFFFFFFFFF176767 6D6D606D939393CE CEFFFFFFFFFFFFFF
2500: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2520: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF009999996A 6A6A6666FE66FFFF
2540: FFFFFFFFFFFF7F6E 406E6EA0A0A0B4B4 F6CECE7F79E17966 6666FFFF1F727272
2560: B0ADADADCECEFFFF FFFF5FAEAEC07070 70666666FFFFBFCE FDCEFFD267676666
2580: FFFF07707070AFAF ECAFCECEFFFFFF03 B5B5B56A6A6AFA66 66FFFF176E6EB0B0
25A0: ECB0CECE03959595 666666FFFFFFFFFF FFFFFFFFFF256767 7272A0C0A0A0BEBE
25C0: BECEFECEFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
25E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF87767676
2600: 66FE66FFFFFFFFFF FFFFFFFF0B696973 7373B0A3A3A3CECE 7F9E009E9E6B6B6B
2620: 666666FFFF1F6A6A 6A00939393BCBCBC CED3FDCEFFFFFF1F ADADADC06E6E6E66
2640: 6666FFFF176969CE D3FDCEFFD06E6E6E 6666FFFF076B6B6B ADADECADCECEFFFF
2660: 7FAD01AD7A7A7A66 6666FFFFFF026868 8A8A8AB8B8ECB8CE CE03989898686868
2680: FA6666FFFFFFFFFF FFFFFFFF2F67676F C06F6F9B9B9BCEFE CEFFFFFFFFFFFFFF
26A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
26C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FF077D7D7D6666FE 66FFFFFFFFFFFFFF
26E0: FFFF5F6767A07474 74CED3CEFF03A6A6 A6676767FA6666FF FF826F6FB7B7B7CE
2700: FDCEFFFFFF5FADAD C06D6D6D666666FF FF976E6ECEFDCEFF C0757575666666FF
2720: FF176767ABABECAB CECEFFFF7F914091 916969696666FFFF FF80868686B8B8B8
2740: CEFDCE039F9A9A7A 5E5E00884F4F9058 58A9750075AB7070 AE4545BD002525D0
2760: 1C1CD31C1C3FC625 0025B82F2FAC3535 9D0040407D55556A 6262F8666666FFFF
2780: FFFF8B6F6FCED3FE CEFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
27A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF3FDE
27C0: 4A004AFB0404FE02 02FEFE0207FD0101 FD01FFFFFF0FF101 01CB001818B44242
27E0: B67777009B686882 57576B61F0616666 66FFFF7F84006666 C04F4FCD2E2E00D2
2800: 1818D21919CF2300 23D04040D96B6BDD 0474743333C61A1A C07C5656666666FF
2820: FF177777CED3FDCE FF3FD5754075FA05 05FE02FE1FF70303 00D90F0FCE2F2FD2
2840: 540054D766669B6B 6B66FD6607AC6B6B D55D005DD45A5AD2 5252D20252D04949
2860: CF272720DB0C0CFD 01E31180118A4C4C 666666FFBF766076 BCBCBCCECEFF3FB9
2880: 476847FE02FEFD03 E60404CD292900D9 6C6CE28383D66200 62D25555D1515183
28A0: 48626266666969B0 979797CECE01887A 7AAA5353CD0229E0 0F0FDA0B0B00CF26
28C0: 26D15050E28301E1 7B7BD13838E0000C 0CFA0000FF00003F FE00FE0003FD0000
28E0: F7060600D92323A3 53537B7300737070 7067676766FD66FF FF5F7676F4CED3CE
2900: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2920: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF3FC95E 405EF60707FF00FF
2940: FFFFFFFFFF0FF300 00D8000F0FCF3838 E27F7F00DD6F6FD0 3434D4160C16C9B3
2960: 3A3A8B805656755F 5F6866FE66FF039B 5555CA2E2EE0D11D 1DD21901D03D3DDD
2980: 7373E0807B7BCF36 36D80FC0B330306C 6161FE66FF176A6A A8A8FEA8FF07A9A7
29A0: A7CE62E862FF00FF 1FF7010100DA1212 D03939D5590059DA 6A6A7F686866FD66
29C0: 079A7474D55A005A D35353D65C5CD400 5656D14A4ACF2E2E 04D90FF90000F505
29E0: 00059B4141666565 66FC6666BF6F606F BBBBBBCECEFF07BB A4A4F30A680AFF00
2A00: FFFC000000DF0A0A CF343400DD7171E1 7E7ED7610861D14A A85151670C656566
2A20: 83828200BBA8A8B3 6B6BBE2F002FE006 06E70202EB000101 E20505D6121200CF
2A40: 2929D35555EB9500 95DF7575D23232E1 D00A0AFA00FFFFFF FF3FF4090009C43A
2A60: 3A9D5F5F7C406C6C 6969696666FFFF5F 6868B2B0B0CECEFF FFFFFFFFFFFFFFFF
2A80: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2AA0: FFFFFFFFFFFFFFFF FFFFFFFF3FAE7A40 7AF00D0DFF00FFFF FFFFFFFF0FEE0101
2AC0: D6001313CF3939E0 787800EA8F8FD34E 4ED1240024DB0B0B EF0101EF000B0BD2
2AE0: 25259D4949D06F62 626666FF036E6363 B43A3A00D02323D1 1E1ECF280028D03E
2B00: 3EDB6D6DEA009393 D14848D7151500DB 0F0F9447476764F0 64666666FFFFFFFF
2B20: 076C6060B430E830 FF00FF1FF5030300 D51B1BD24646DB6D 01E07A7A6F666666
2B40: FF07A29999D25B08 5BD456D45858D606 5C5757CF3A3A00D7 1212F30101FF0041
2B60: B132326B6166FD66 BF696069BBBBBBCE CEFF27CF34FF007D FFF2000000D81212
2B80: D1454520E58888E1 7ED65D005DC14E4E 7B5F5F6602656C6C 6C807D7D20AA6A6A
2BA0: CF3AD21A001AD90D 0DDE0808DF900808 D80FD11E00D03C3C D96666F3A500A5D9
2BC0: 6262D12828E1D008 08FA00FFFFFFFFFF 0FF20C0CCB803131 8F59596966FE66FF
2BE0: FFB28080CECEFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2C00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF3FBAB440B4
2C20: F21B1BFF00FFFFFF FFFFFF01F70000E4 0505D3001818CF3C 3CDC707000E88E8E
2C40: D96464D0380038D2 1C1CDC0A0AE91003 03F700ED090900BE 2A2A745B5B6666FE
2C60: 661F7B5A5A00CA26 26D02222CF26033A 3ADC6F6FF800B1B1 D75F5FD1222200E5
2C80: 0707C82222775AF0 5A666666FFFFFFFF 07705E5EBE29E829 FF00FF1BFDEA0505
2CA0: 00D22424D45353DF 7AA07AD67E7E6666 FF07B9B9B9C66840 68D35454D55AD702
2CC0: 61DB6C6CD24F4F04 D11EE80505FF008D CC755B5BFD66FF61 878787CECEFF80B5
2CE0: 7979F70707FF7DFF E9000606D12121D7 606000F7AEAEDE74 74CF4C004C965555
2D00: 6964646601667A7A 7ABFBFBF009F6F6F C94242D12101D511 11DA0D0DD8100E0E
2D20: D416D0292920D24A 4AE07BE88D008DD4 5050D21F1FE2D007 07FA00FFFFFFFFFF
2D40: 7FFC000101E41616 984646D069626266 66FFFFB07B7B7BCE CEFFFFFFFFFFFFFF
2D60: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2D80: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF41 D83A3AFF00FFFFFF FFFFB6FEFDF701E5
2DA0: 0505D80D0DD40015 15CF2A2AD4545400 E28080E78D8DD659 4059CF3030D318D9
2DC0: 020DDF0707E50303 00E30404CB171770 5DF05D666666FF00 994848CF2424CF25
2DE0: 4825CF38D65CEB02 95DD7272D0353504 DB0FEF05059F3F80 3F686363666666FF
2E00: FFFFFF07785959D1 1EE9FF00FF13FC00 E10B0B00D13636DF 7676E9908090C171
2E20: 71666666FF026B6B B9B9B9AD6C486CD4 57D354D8106363DD 71D65E5E20CF3131
2E40: DB0CF4000000E90D 0D80535366FC6666 FF657676CECE1F9F 9090A0D92424FE00
2E60: FF0DFEF40101DA80 1010D13D3DE78D00 E58787D35050B442 29775A666670E070
2E80: 70BFBFBF00957676 C24949D02241D217 17D511D49412121D D03424D456DD73DB
2EA0: 6B006BD14141D418 18E3D00606F400FE BFFDEFFCDFFDB7FE FFFF1FEC0B0BC088
2EC0: 4E4E666666FFFFB0 757575CECEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2EE0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
2F00: FFFFFF41B65D5DFF 00FFFFFFFFC3FB00 00F728ED030306E0 074007DD0909DA0B
2F20: D4801313D11A1ACF 3000D24B4BDA6767 DA6B086BD55AD146 46D0102C2CD21CD5
2F40: 141400D71010D512 12BC2AA02A745D5D 6666FF046863B335 35CF2401CF2D2DD0
2F60: 4545E1827BE78C8C D34E00D11F1FE607 07E013A0137E5656 6666FFFFFFFF077B
2F80: 5656D818E818FF00 FF03F40202D51818 00D54E4EEC9595E9 8FA08FAC67676666
2FA0: FF006D6D6DB9B9B9 A7860086D04242D1 4949D6025DDE7676 E17C7C00D34C4CD4
2FC0: 1A1AEA030803FC00 90484866EA656666 FF456D6DCED3CE03 B7B4B4C45B5BA0F5
2FE0: 0909FF00FF09FA00 E30909D1002B2BD7 5E5EEB969604D75E C636368E4B204B66
3000: 66666A6A7DE07D7D BFBFBF00897C7CBA 5858CF32C032D01F 1FD11DB02121CF2D
3020: 4204D454D96767D0 4A004ACA3A3AC628 28CB202222D32222 2B2B00D22B2BCC2B
3040: 2BC72C002CC72828 C62727CA002323D6 1616DC101000E20A 0AED0404F801E801
3060: FE00FFFF06E97959 596666FE66FFB275 75CECEFFFFFFFFFF FFFFFFFFFFFFFFFF
3080: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
30A0: FFFFFFFFFFFFFFFF FF41987B7BFF00FF FFFF7FD8001717A3 3939983F3F009442
30C0: 4292434391440844 92439A4040AC0042 42BB3333C5282820 D02525D038D34D00
30E0: 4DD55858D96969D4 1256D03ECF2B2B24 D11DD21AD01D001D A73D3D6A636366FD
3100: 6605657F5555C22C 082CCF28CF3535D4 905555DF76D75E20 D03131D812EE0280
3120: 02C32A2A666666FF FFFFFF07815353E8 0FE80FFF00FF03E3 0505D12E2E04DB6B
3140: EC9696DD7281965E 5E666666FF027070 BABABAC0B300B3C8 3B3BCF3737D19248
3160: DA6AE88E04DD71D1 3131DB0E080EF101 AF323268EE6366FF 456767CED3CE03B5
3180: 8F8FDB2222B4FE00 FFFC01E70606D41D 1DD3904949E280DC 7000CD3333AB3636
31A0: 6E5F205F66666675 757FE07F7FBFBFBF 00817E7EB05C5CCD 37C837CF28D02102
31C0: 27CF3333CF3F3F20 CC4C4CB65DA36200 62986464916A6A8B 007171877575807F
31E0: 7FFBBF0185797989 757590006D6D9D60 60BA4D4D24D039D2 25DC116011F00101
3200: FFFFFF37CD6666FE 66FFB27676CECEFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3220: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3240: FFFFFFFFFF01BAB8 B8E91414FFFA00FF FF4FF900C1437559 596666FF4F67657E
3260: 3078788579737340 A15454C726262341 D03B3BD454D6925C D559D14824CF2ECF
3280: 23D11D01C32C2C84 575766FC66660769 63639944C044CF1F 1FCF27923CD353D5
32A0: 5920D04747D128DC 0C000CEB0303ED0B 0BED1E0BE50B0B00 D41111C42929C653
32C0: 0053C75252C72525 E0D00E0EED0BED07 F00909FC016FFFF7 83D90E0ED03900DF
32E0: 7777E17A7AD351B0 5186575766FF0073 7373BABABABEB4C0 B4B73E3ED021002F
3300: 2FD24D4DE17F7F24 EA93D34ED2220822 DE08C91B1B6AE861 616666FF2F707072
3320: 026EAD4040F80404 34FF00FFE90301D7 1111D13535DB926B DC70CF3A00CB1A1A
3340: 7F5151666600666E 6E6E7C7C7C7FE87F 7FBFBF07A35E5ECA 310831CF24D02424
3360: CF0226C73434AB57 57008B7575847C7C 807EF07EBFBFBFFF FFFF13807F887979
3380: 40B66A6AD65A5A3D C1D31919EE01FBFF 07FB0101884EF566 66FFB27A7ACECEFF
33A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
33C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF0FCA33 33FFFA00FFFF0DFC
33E0: EA0404C44023237D 57576666FF7F75E1 7580808007906A6A C4284028D41414CF
3400: 27D09245D558D456 214343CF2ED02301 CD2424A1434367EA 6566663F80630063
3420: C03A3AD21B1BCF92 26CF30D14520D34F 4FCF39D11E59DB0C 01F4D200FB00F330
3440: E10606D1D0444844 D148D224E9D00505 FB00FFFF7FE91002 02D21AD2444404DD
3460: 71D65B5BCF38816E 6060666666FF007F 7F7FBBBBBBBCB640 B6AA4848D415D190
3480: 1C1CCF2ED45404EC 96E58383D13F003F D21E1ED311116EE8 5E5E6666FF5F6579
34A0: 105555CB1AF80000 00F60000ED0000DC 0B480BD025D34EDB 026CD14343D51515
34C0: 00AA313166666668 6800687878787F7F 7FBFFDBF07976868 C6340834CF24CB28
34E0: 28B41043438C6FBF BFBFFFFFFFFF017F 7F7F7E7E7E7D007D 7D7A7A7A72727200
3500: 855F5FC15454D55B 405BD04141DA10FC FA00FF37FEB033F0 33666666FFB08383
3520: 83CECEFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3540: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FF0FA25C5CFFFA00
3560: FFFF0DF9DC0E0ECC 802F2F8859596665 FA66667F6CE06C6C 7575753F8C584058
3580: DD0E0ED711D09026 26D042D35120D046 46CF32D02049D318 B33071E85D5D6666
35A0: 9768688F008FB977 77CC1B1BD69212D2 17D02308D032323F 3FCF3249D11ED710
35C0: E08206E70303E503 24DC0AD11ECF3909 D041D12626E1D208 F900FFFF6FF9E092
35E0: 06D022D35124D75E D040C42CB02C6D60 6066FF30AAAAAACE BDBB40BBAF7070D9
3600: 0DD7B00F0FD21E33 04DB6BF0A0A0DD6D 086DD03BD21D1D82 E05050666666FF4F
3620: 68639C803F3FDC09 09E70324EB01DF07 D5164816D03BD65E D4105252D222CE15
3640: 15106F5F5F666668 6800687070707676 767CE07C7CBFBFBF 07867777BA3F003F
3660: C034349E5A5A81E8 7D7DBFBFFFFFFF07 7E7E7E7A7A007A74 74746F6F6F6AE86A
3680: 6A666600735C5CB5 3C3CD24C084CD55B D22323EDD203FF00 FF37FED21DF16666
36A0: 665F6D6DB0A0A0A0 CECEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
36C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
36E0: 0FB1A5A5FAD80404 FFFFFF01F70202D3 1D1DD002429E5959 6A6464FA6666FFFF
3700: 3F676441D61818E9 03D694141433D24F 24D148CF2DD31760 17D61010BF7BE054
3720: 54666666077C7C7C B2B200B2B8B0B0C3 4646E0900808DE08 D90E04D218D02A2A
3740: CF3849CF29D11FD6 901111DA0BDC0A24 D80DD01FCF3549D0 41CF2BDAC01111F2
3760: 0101FEFEFF4FEF01 D8120DCF31D35252 254ACF2ABD27B027 6C6060661F696969
3780: B0ABABABCECE01C3 9696D91414E69204 DA0DD21B20D14747 E078E78C01D86060
37A0: D036369CE0434366 6666FF0F785C5CC7 9228D90DE00720DE 0909D512D02609D3
37C0: 51D55656D1003030 D81010874D4DF866 66660F6767676B00 6B6B7474747D7D7D
37E0: 3ABFBF8E70A0708D 6F6FBFBFFFFFFFFF 007777776E6E6E69 69F4696666FF0081
3800: 5050C02525D03909 D55BD13232E6DA07 FFFF3FE411F01166 6666CB6B6BCEFECE
3820: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3840: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF0FC0 BEBEDED01F1FFF00
3860: FFBFFE41F00303D2 23D10247B157576E 6464FA6666FFFFFF 41C92323FD00DB92
3880: 0CD025D14364D149 CF2E1601DA0C0CC7 1A1A804850506666 6969807D7D7DBDBD
38A0: BDCE0DCE9C8484DD 801313F50000EB01 64DE08D5122049CF 2ACF29D09221D219
38C0: D41664D416D11C2C 482CCF3ACF2DD582 15E50404FC00FEFF 6DFAE5D3801A1ACF
38E0: 3D3DD24C04CF35D4 1919B22AA02A6B60 6066665F6C6CB0AC ACACCECE01BC9F9F
3900: D02828F68200EB02 02DA0C24D022D452 E28049DE76D24CBB E03D3D666666FF0F
3920: AC5353D09225D413 D80D28D60F0F1BD0 3E49D351D143D480 1B1BB929296962FA
3940: 6666FF5F6A6AD07A 7A7ABFBFFFFFFFFF 037A7A7A696969FA 6666FF9F745B20C2
3960: 2424E108D02541D2 5050D135E6D00808 FF00FFBFE477666D C16DB0B0B0CEFECE
3980: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
39A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF7FC4 DA3AFFFFBFFE09EA
39C0: 05D12727D003C544 44726060FB66FFFF 3F6C6141DE1515FE 00E9D00404D21ED0
39E0: 24D03FCF2BD60F19 E503151589005555 808080B9B9B9F6CE CE7FC0806868FB03
3A00: 03FD0004F400E804 04DB0C49D218CF26 CF1226D11DCF1C1C 24CC20CB22C82E40
3A20: 2EC83434C82ECA12 23D60FE3070724F5 05FB01FC004DEEDB 0CCF102222D03ECF
3A40: 3B3B26D1DB0CA833 B8336962665F6E6E B0ADADADCECE01B9 ACACCC4343FF1A00
3A60: FFED010104D710D0 3333D8640864E17E D86666D102497E5C 5C7E5A5A007E5D5D
3A80: 7F6161816740678C 6A6AD24DCF822DD1 1B1BD41420D31616 CF2BD03E09D148D0
3AA0: 2E2EC8801F1F7F53 536665FB66FFFF02 69697676767F7FF4 7FBFBFFFFF2F7E7E
3AC0: 7540757567676766 66FF096A62745C5C 82005252AE3434E5 101084FB00E20808
3AE0: D101D14B4BD12323 E9DA05FFFF37FED7 1A001A7171718585 85AED8AEAECECEFF
3B00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3B20: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF7FBD D07777FF00FFBFFE
3B40: 41F30404D222CF12 3CCF34805555F866 6666FFFF276D60A6 3A483AF505FE00ED
3B60: 980202D5D03904D0 3FD02727DC0941F1 0000D11D7D006060 888888999999F6CE
3B80: CEFF83C83535FF00 36FFFCEF024802DD 09D413D1121ECF26 C92929009D42428C
3BA0: 4D4D8C5000508C53 538C51518D004B4B 8F464695414100A0 3C3CE10D0DEC0148
3BC0: 01DF08D319CF9229 D043CF2A04D516E6 05059840A0406664 6466665F7272B0AE
3BE0: AEAECECE0FD37474 F8D00606FF00FB04 E703D61919D13B40 3BD96565DA6AD482
3C00: 57CF4040CF38253B D24DD96709DB6DD2 4E4ECF9236CF23D1 1E2CD02232D04209
3C20: D03DCE2424A30045 45736A6A686868FA 6666FFFF17686874 74A0747F7F7FBFBF
3C40: FFFF057E7E747474 68E8686866660469 638451519D4051B9 2D2D1EF0DA09FFFF
3C60: 04F700DE0B0BD023 49CF33D618F2DA01 FFFF37FEC0436043 A8A8A8CECEFFFFFF
3C80: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3CA0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF7FC680 A1A1EE1010FF00FE
3CC0: FF49F703D21BCF92 34CF309D40F86666 66FF1765854F4F04 9D40CA2121F30768
3CE0: 07FE00FEF1900202 D515D036253AD020 E2040804F703B331 31670E6466696969
3D00: 827D7D959595CEFD CE03BAA3A3E61818 B6FFFFFD49F200DF 07D41E13CD2828A0
3D20: A346466A6366FE66 FF066DD01212E205 49D80FD11FCF9230 D03CD02026DBF201
3D40: 8D4BA9666566661F 929292B0BCBCBCCE CE0FC28585E7D017 17FF00FF84F800E1
3D60: 0707D149D246D863 D6925CD045CF3A24 CF37D043D35249D9 66D24FD09241CF31
3D80: CF2924CF2ACF33CF 3D09CF31C62A2A9C E05A5A7F7F7FC072 7272666666FFFFBF
3DA0: 678067797979BFBF BFFFFF857A7A6A6A 6A02628C4C4CB62F 2F04DE15EA0D0DF5
3DC0: 06E806FD00FFFF06 F0D71313CF2709CF 25DE0C0CFDFA00FF 27F706997BEC7BCE
3DE0: CEFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3E00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FF7FC090A8A8D924
3E20: FF00FEFF69F801D6 D0F6342D24D416D5 12D31959D02325D4 93DF08F700FEFF6F
3E40: FEF0900202D418D1 3F253CD319E90289 E3117B5555FD6617 686890906090BEBE
3E60: BECECE13BDBBA75C 5CB0F80505FFFF4F F500DC9209D414D0 23C0CB2E2E7A5F5F
3E80: FE66FF246E5FD511 D413C1D01E1ECF29 123BCF31D5171704 E804E90B0B8451F5
3EA0: 66660B67679C9C9C F6CECE0FB49393DA D02323FF00FF07F6 0101D8134A1332D2
3EC0: 4BD38251CF4444CF 396CCF3338420042 D14F4FD14D4DCFB6 3A342E24CF2BCF32
3EE0: CF3A4B2ED318EB00 0404E51717A65858 007F7F7F75747467 67F4676666FFFF05
3F00: 67677F7F7FBFFDBF 3F817C407C8B6363 B92DEED80A0AFFFF FFFF9BFEF40120DB
3F20: 0A0AD218D02149D3 16F100FFFF84FD01 B84D4DCEFDCEFFFF FFFFFFFFFFFFFFFF
3F40: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
3F60: FFFFFFFFFFFFFFFF FFFFFFFFFFFF7FB9 80AEAEBE3F3FFF00 FEFF6DF9DED09225
3F80: CF2ED0212517D413 D3185B1F27D39218 DD09EE01F6FFFF6F FEE893D21CD03E04
3FA0: CF39D01818C81CA0 1C8450506666FFBF 6B606B9E9E9ECECE 1FC0ACAC00D64141
3FC0: FC0202FF006DFFFE EF9201DC0CD11A04 CF2BBB46466D65F6 6566FF24755BD21B
3FE0: D021C9CF2ACF3692 39CF26DB0F04F400 E113137F54F65466 0B68689D9D9DF6CE
4000: CE0FAFAAAAD0D23D FD01FF36FFFAE507 0B1FD14242D2B24D CF3B2F6CCF292A2F
4020: 4B36D040CFB43E3E 322D64CF2BCF2B32 4B29D219E2DA08FA FF00E21C1CA75353
4040: 7966FD66FFFF2F76 76BFFCBFBF208777 77A25CCE2F61F606 06FFFFFFFF6FFCF8
4060: 1200ED01DD0A0A24 D514D11BD71371E5 0606FF1FF10D0DA0 CF5151CED3CEFFFF
4080: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
40A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF7F BB80BABAC26D6DFA
40C0: 04F6FFFF89FD00E9 0707962131CF2644 D21CD417171749D1 1DCF2FD09221D611
40E0: E405F4F800FF6FF9 E106072525C94444 00B74B4B9D545470 5EF56666FFFF057F
4100: 7FB3B3B3CEFBCE00 BF8D8DE21B1BFF00 7DFFFC13ED03D910 1024D11FCF2D9E57
4120: F4576666FF208552 52CF29CF3049CF3A D043CF9235D11DE2 0706FACE1F1F7759
4140: F059666666036A6A 6A9F9F9FF6CECEFF C06464F50808FF36 FFFDEF0241D61515
4160: CF2DD09244CF35CF 2524D021D021CF25 49CF26CF2FCFB237 CF342A6D26262E49
4180: CF2CD021D8D20FF3 01FE06FFF60808C3 2E802E7B58586666 66FFFF0F6D6D6DBF
41A0: 1CBFBF916D6DE0CB 3232F706FDFFFFBF FA09F301EC0202E0 9207D90DD41624D6
41C0: 13DE0BEB0269FA00 FFF80205D62828BF 707078C0B7B7D3FF FFFFFFFFFFFFFFFF
41E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4200: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FF83C68C8CE914F6 FFFF0FF10404D3B2
4220: 19CF342C66D2D21C 1959D11A27CF9224 D416DC0AF0F00000 FF0FEF0000DC000D
4240: 0DC73232A85D5D24 8975807F6C6CF46C 6666FFFF056868A8 A8A8CEFBCE00BEBA
4260: BACD6161F409EDFF FF1BFDEA060624D5 14CF22C739B03985 5E5E66FF28965252
4280: 3CD04349D14AD147 CF9235D610EC0224 FE00BE2A6F5EF65E 660B6D6DA1A1A1F6
42A0: CECE7FB8807A7AEC 1111FF00BEFFF949 E10BD020D0D23CCF 2ACAE0BB2929BB29
42C0: 01BA2C2CB92E2EB8 A03636C233332634 D024D0CF245B2B26 D29219E107FD003E
42E0: FFFB020002CE1E1E 765A5A66FD66FF2F 69697E007E7E926C 6CD82525B4FC02FF
4300: FFFFFF36FCEFE802 4802DE08DB0BD492 14D90DDA0C24E305 F401FD000DFEDA24
4320: 24B4206E6EBFAEAE BBBBF6CECEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4340: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4360: FFFFFFFFFFFFFF83 BB9797D924F6FFFF 6FF5DB901010CF2A CF2CE4D023D21C59
4380: D21A25CF922BD11C D60FA4E306F600FD 69F700E7D78211D0 3030D04100C93131
43A0: B044448066A86668 636666FFFF0F9F9F 9FBED8BEBECECE07 A89898D62CE82CFD
43C0: 00FFDFFA20EA0202 D80DCF2201B23D3D 6F646466FD6620A0 5050D146D14B59D4
43E0: 5649CF922BE107F8 0006FFAF34346962 F5666603717171A5 A5A5F6CECE7FAB80
4400: 9191E61B1BFE00FE FF19EB041B1BCF12 31CF28B72D2DD46B 616666FF03686868
4420: 7D717100966464B9 3737CA24D824CF24 2A9E26E504F6FCFF 0FCF1E1E6EEA5F66
4440: 66FF2F686885806E 6ECC2E2EFF00FEFF FF9BFEFB0036EADE D70E080ED412D90C
4460: 0CE01207EB02EE04 0400EF0A0AEB1D1D CB436043967979CE CEFFFFFF1FB5B5B5
4480: 0279797373739D9D EC9DCECEFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
44A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
44C0: FFFF83B7ADADD244 F4FD00FF6FFDE690 0909D11ECF310523 C42121BE260026BC
44E0: 2828BA2E2EBAC039 39BB2E2EC524D60F EB02F30049F300E2 05D49214D02ED03F
4500: 24D126E008EC0E40 0EA83838745C66FC 6666FF0F737373B7 D8B7B7CECE3FC088
4520: 4088F21212FF00FF FFA6FBEF02DA01CB 2121974E4E69EC65 656628B04F4F48D4
4540: 5649D454CF3ED2D2 1AEC01FF04FB01A2 3C3C6666FE66C38B 8B8BCEFECEFF83DF
4560: 3C3CFD00FEFF4DEF D712CF13D022C123 23C07E5252666666 FF1F7575753A7F7F
4580: 93668066BC3434CE 2525962E27D218B4 E307F8FF7FB4E230 666666FF0F686767
45A0: 9BC05454EC0A0AFF FEFF7FFC9BEFDF07 34D710D5D70F49DE 09DB0FD4101F1FD0
45C0: 36CF6262A0B37E7E B7ADCEFDCEFFFF7F AE00AEAEA1A1A170 7070026767696969
45E0: 9898EC98CECEFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4600: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF1FD36969
4620: B4F607FFFF7FEEB0 0303D6152A05249E 3E3E785848587759 775A77105B5B7759
4640: 7D5454008D5050AE 4343D8154815ED01 DF07D486142D2DD0 3DA4D029E008FF49
4660: F804B92E6EEE5F66 FF2F7373B7D9B7CE CEFF41B95252FF00 FFFFBFF40DDBBF29
4680: 297FE85A5A666620 BC4B4BD14AD55B49 D350CF2FD7D210FA 00FF00F108089844
46A0: 446666FE66C38F8F 8FCEFECEFF03C558 58FA0303F6FFFF0D F3DA0E0ECF1224D0
46C0: 22CA1B1BD0904343 6666FF5F7070C07D 7D7D7F7F7F09906A BD3434D09229CF37
46E0: CF2824D31AE804FB 007DFFF810030381 53666666FF0F6D63 63B6D03939F600FF
4700: FF7FF0DBDDD504D2 19CC1717B6270027 993F3F874F4F80C0 60608A8686CEFECE
4720: FFFFFF05B0B08E8E 8E774077776A6A6A 66663F9494EC94CE CEFFFFFFFFFFFFFF
4740: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4760: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF1F C07D7DA0EA1313FF 00FF7FF59BDBCF28
4780: 00CE2A2AA6393966 66FE66FF026A6A77 7474816F806FCA22 22E10505FFA12B2B
47A0: E008FF0DFFF40505 A0E03E3E666666FF 2F7575B7D8B7B7CE CEFF4DBEDB22FFFA
47C0: 00FFBFFE4DF7E008 A9503B3B6E636666 20CE3D3DD24BD65C 49D24AD025E0DA07
47E0: FFFF84E311894D4D 667E6667C1679090 90CEFECEFF83A874 74F805F6FFFF4DF9
4800: DF0AD09222CF27D4 14C0A53434666666 FF1F6C6C6CC07777 777979790378789E
4820: 5050CDB02323CF37 3B24CF27D810EC01 EDFCFF03B52F2F66 6666FF0F726161C7
4840: D02727F300FFFF6F F7DE900A0AD414D0 2200993D3D705C5C 6963BB65664B6A6A
4860: 7A7AB09F9F9FCECE FFFF177E7E7777A0 776C6C6C6666FF3F 72726072AAAAAACE
4880: CEFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
48A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFF1F AC9090A6DEFF00FF
48C0: 7FFB8200E40707D1 1D04CF28BD2F2F69 63F36666FFFF8970 5DD90B0B93D128CF
48E0: 3BA52AE008FF7DFF D2421C7A58586666 FF01686868A7A7A7 CEFAD3CEFF0F9E79
4900: 79EFD80F0FFFFFFF 6FF7DB8012128B51 51715D24CF31D148 D35549D043D21EED
4920: DA01FFFFA0DB1717 8252667E6669C169 939393CEFECEFF1F F51111F6FFFF0FE6
4940: 0606D09220CF28D4 15C4B627735A5AFE 66FFFF0F834D4DC2 9224CF26D04224CF
4960: 33D31DE406E806F8 00FF83E410106764 FA66660F7B6767CB F3F201FEFF4DF9E5
4980: 05D68213C8262677 59FA6666FFFF1769 696D6D806D6F6F6F 707070036D6D6D6B
49A0: 6B6BFA6666FFFFBF 6C606CA6A6A6CECE FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
49C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
49E0: FFFFFFFFFFFF1FB0 ACACE0D83939FD01 FDFF9BEBD61124D0 20C32A7F53F766FF
4A00: FF0FAE2D2DD39218 D128CF38E4CF28E0 087DFFF61005058D 4B666666FF017070
4A20: 70ABABABCEFBCEFF 0FC0BBBBCCD06262 FA04FFFEFF7FF802 00CA25258D4D4D24
4A40: D022D041D24E49CF 3BD517F7DE01FFA4 CF1F755B667E666A 816A969696CED3FE
4A60: CEFF1FD53131F4FF 00FF0FE70404D390 1515CF2CD319A0C2 1D1D805066FE66FF
4A80: FF0F805151BF9023 23D020D03B24CF36 D123DE0A79F601FF 13ED0B755A5AFB66
4AA0: 056A6A9F8B8BCAF2 21F101BEFFFE49F4 00DD09D39218A93B 6665FB66FFFFFFFF
4AC0: FF2F65705F485F82 526C6166FD66BF69 6069A5A5A5CECEFF FFFFFFFFFFFFFFFF
4AE0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4B00: FFFFFFFFFFFFFFFF FFFFFFFFFFFFA6C9 F706FFFDFF93F600 DC0B04D218C82727
4B20: 9149F049666666FF FF0FA43535D39014 14CF28CF34E4D024 E008FDFF93A63A69
4B40: 623A66666D6D006D 959595BBBBBBCEFB CEFF7FBC90A5A5D0 2DFF00FEFFFF03F4
4B60: 0303CD1A1A24D21A CF3AD04449CF32DB 0FFBFA00FFE0C227 2769637E666BC16B
4B80: 989898CEFECEFF1F B05757F4FF00FF4F EF00D69210CF27D1 1C04D3118F454566
4BA0: 66FE66FFFF0F874B 4BC7901B1BD11FCF 3424CF37D120DD0C 780CF601FF93EF0A
4BC0: 8053BB66690069AA AAAABCAEAEBFF02F 2FF001BEFFFE49F4 01DB0CD1821DAD3D
4BE0: 3D6866FE66FFFFFF FFFF07825151D21D 49D41B854F66FC66 66FF01818181B7B7
4C00: B7CEFBCEFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4C20: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF00B47474F10C
4C40: 0CFF00FDFF9FE703 20D51010D01EA53D A83D66656666FFFF 896764C41C1CBE14
4C60: 33A4D122E605FFFD FF83AD36366A6213 666F6F9696EC96CE CEFFFFFF83C88484
4C80: EC11F4FE00FFFF9F F00024D511CF30CF 3D09D025E30808FD 9A00FFFB01C0B82D
4CA0: 2D6666667F7CD17C CED3CEFFFF1F9476 76F4FE00FF7FDCD7 1CD204D80D9F3939
4CC0: 6962F766FF7F6501 6D5F5FA83232D692 12D11BCF3324CF29 D21CE306E9F900FF
4CE0: 93EE0A7F5383666E 6E6EB00CB0CEBAB2 B2B2D04242F201FF FEFFC1F50101DA0B
4D00: 021DCD2222837070 D06A6A6A6666FFFF FFFF926567656E5F B4B033FFFF01F207
4D20: 079E3F3F66FC6666 FF057171B4B4B4CE FBCEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4D40: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4D60: FFFFFFFFFFFFFFFF 80A89999EB1818FF FDFFDFFA24DF07D5 11B42F482F755A6D
4D80: 606DB2606E605F04 6F5E765959815041 B12B2BD90DD39216 CF26CF2CA4D219ED
4DA0: 02FFFDFF03AB3B3B 716A6AB08B8B8BCE CEFFFFFFFF03B2A9 A9C64848B4F706FF
4DC0: FFFFFF20E20606CF 23CF3149D120E905 FD1A00FFF30606C0 A53B3B6666667F82
4DE0: D88282CECEFFFFFF A0E71616FF00FF7F E59203D316D02104 D612B428287955C9
4E00: 705E6F5E936E5F6E 5F24705E755A834E 404EAD2E2ED80DD6 B6101F302524D613
4E20: EC03EC03FCFF03EA 0E0E7C6D6D808888 88ADADADCE7DCEC6 C3E80D0DFFFEFFC9
4E40: F601DC09121AD11D D01919009D595982 66666F6AA5686866 66FFFF496E607C56
4E60: 91004848B72F2FEA 0C0CF6FDFF0FB530 3068EE6366976868 6C206C818181B7B7
4E80: CEFBCEFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
4EA0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FF07DB3636FF00FD
4EC0: FFFF34F102DDCD19 0019B52D2DAE3333 AF003131B03030B1 2C2C80B62828C11E
4EE0: 1ED349DD09D90DD4 9213D023D023A4D7 10F601FF7DFFF900 0404BD6F6FA3A2A2
4F00: F7CEFFFFFFFF1FC0 A0A0A0E72B2BFD00 FFFFFF20F20202D3 17CF2509D416F103
4F20: 03FE1A00FFEE0B0B C09946466969697F 85D08585CED3CEFF FFFFB8C73636FF7F
4F40: F19200D710D12024 D414D012C11F001F C22121C12121BC00 2323B62626B22B2B
4F60: 04B330BA2B2BCC19 4819D70FD70FD4D6 1524D024D414E108 F600FDFF43D72F2F
4F80: AAAAF6CECE7FB490 A2A2C834FD01F7FF 49F900E505D79610 1DD60F04E20ADC22
4FA0: 22C4350035B03E3E 9E484896804D4D93 4B4B914900984343 A43C3CB82E002EC8
4FC0: 2323D91515F09005 05F500F500BFFA09 FB00CB232379005D 5D6D6D6D70707000
4FE0: 9A9A9A9D9D9DA1A1 60A1B6B6B6CECEFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5000: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5020: FFFFFFFFFFFF07BD 5555FF00FDFFFF86 FEEA0101DF49DA0C D610D59211D90ED9
5040: 0C24DF07E105E205 49DF08DD09D39217 D11FD21AB4DE08FA FF7FE0E01D1DC298
5060: 98FECEFFFFFFFFFF A0B16F6FF607FFFD FFFF26FBDD0AD318 09D90EF50202FF1B
5080: FFE91313C4AC79B2 B2B27FB6D8B6B6CE CEFFFFFFA4A658FF 00FF7FFDD3DC0AD2
50A0: 24D317DB0BE20449 E802E902E79203E0 06D80D24D315D022 D21B69D416D4D292
50C0: 19D11ED217A4DA0B ED02FEFDFFC3AA65 65CEFECE7FBD00BC BCB18585E11C1CF4
50E0: FF00FF4DFEF201DE 9209D21AD31624E1 06F500FD0149FA04 F608F3100909F309
5100: F2080820F40606F8 04FD006DF8F0EF92 00EC01E902A4EE01 EF00F70DF9E31818
5120: B9008888B3B3B3B4 B4B4F6CECEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5140: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5160: FFFFFFFFFF87A777 77FFFDFFFF37FCEB 0149E006DB0ADA86 0C0909DF0824E006
5180: E305E3054DDFD90D D493D21AD710B0E8 0303FCFF0DFEF40A 0AB5E05050B0ADAD
51A0: FECEFFFFFFFFFF07 CD3D3DFE00FDFFFF 24FD00E604D80E49 DD09F700FF1FE617
51C0: 17B0AB8888CECEFF FFFFFFFFA0C5ADAD FC02FFFDFF93E205 D41524D11DD710DF
51E0: 064806E205E803E6 900303E106DB0B28 D513131BD21C49D2 1CD11ED1921DD512
5200: DE08B4E703FFFF4F FC02C7D04343CED3 CEFFFF1FB67F7FA0 E81818FD00FF6FF7
5220: E7BA02D81634DB0B EBF800EDFEFFFFB6 FEF8EF49ED01E803 E8FE03A7EF00F74D
5240: F9F30AC8E08383BF BEBEFECEFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5280: FFFFFFFF3FF30BE8 0BFF00FFFFBFFB4D EDE305E0B207E007 06F6E3E349E006DA
52A0: 0BD39216D218DC0C B6F2FDFE01EE0F0F C24E4EB4DCA6A6CE FFFFFFFFFFFF07A4
52C0: 9393E31AE81AFF00 FFFF26FEF002D90D 69E008F9FF1FE623 23B0ABA5A5CECEFF
52E0: FFFFFFFFB0C1B1B1 DEFFFDFF93EF01D9 0E24D219D511DC09 49E205E603E39205
5300: E105DC0924D70ED4 13D51349D317D512 D89A0EDDE603F4FA 00FF09F10DDB4949
5320: C0D8BCBCCECEFFFF FF00B78787D22D2D F7076DFFFFF593E3 05D61234D513DFEA
5340: 0269F500FDFF9FFC 0026F5EE01E70249 E304E106E1DA06E2 E3A4E902EF00F76D
5360: FBFFB4C04A4AB8B2 B2CEFECEFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5380: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
53A0: FFFFFFFFBFCAEDFF FFFFFF4DFBEF00E6 D00202E603E607E4 0404E50349E304DA
53C0: 0BD5961214E20726 F8FA03D52C002CC7 8A8AB7ACACCEFBCE FFFFFFFFFFFF3FC3
53E0: 896889F607FFFFFF 26FEF501DD0969E3 06F9FF13FD01DF3E 3EF4CED3CEFFFFFF
5400: FFFF00BDB4B4C13D 3DFF00FDFFDBF9DF 24D417D316DA0B49 DF07E304E593E305
5420: E00724DF07DB0ADC 0AC9D90DDC0BD3E9 02F826FFF805D627 8827C171C0B6B6FB
5440: CEFFFFFF27B1A1CD 774077DD2121FB02 FFDBEDDD26D4D611 DD0A49E404EE01F3
5460: 9200F400F100A6E8 E305E049E007DF09 DF9209E107E30534 ED01F4F8004DFFFB
5480: 02C3E03A3ABCAFAF FECEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
54A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
54C0: FFFF3FAA54E854FF 00FFFFFF6FFEF69A 00EEEC01F4E903E8 69E007D9D493D711
54E0: D81700BF3E3E9569 69C0B5ECB5CECEFF FFFFFFFFFFFF3FBD B860B8BA4343FFFF
5500: FF37F8E10749E606 FA00FF1BFBD14C4C F4CED3CEFFFFFFFF FF00BAB7B7A85656
5520: FF00FDFFDBFCE324 D514D315DB0A49E1 05E802EED3EB01E8 24E304E205DE0949
5540: DE09DF07E593F800 E91400C63838A977 77C0B579BFBDCEFF FFFFFF3FBFBE01C0
5560: B4B4BD7F7FD68227 F90303E20424D70F D21AD61149DD09E2 04E3FE0434E105DF
5580: DA0BC9DE09DF099B E1E60324ED01F700 F10B400BCD3030A2 5CAFD09E9EBFBECE
55A0: FECEFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
55C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF3F9383C083D9
55E0: 3E3ED93EFFFF7FD4 803E3ED33E3ECF3E 00CD3E3ECC3F3FC8 404040B85252AF5C
5600: A2E06D6DA69494FE CEFFFFFFFFFFFFFF FFFF01C0A6A6CD49 49D9FA3ED907D53E
5620: 3EC8424042C94141 D53ED903D54040B5 7A7AF6CECEFFFFFF FFFF07C2A0A0D145
5640: E9D93ED903D73E3E C8414100C04848BF 4949C4440044C741 41CC3E3ECFDFCD3E
5660: CCC74101BE4C4CB3 5C5CA9806A6A9580 80BDBCF7CEFFFFFF FFFFFFFF039F8A8A
5680: AB656500BD4D4DC8 3E3ECA2E61CB1E1E D2D81210D910D811 1120D61414D215D0
56A0: 1849D019D11AD290 2121D232C84280B6 5A5AA47272CEFDCE FFFFFFFFFFFFFFFF
56C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
56E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5700: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5720: FFFFBFB201A88E8E AF8585B6007C7CB8 7B7BB77B7B017C7C B67D7DB2800080AA
5740: 8C8CA98E8EACD8A3 A3CECEFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5760: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
5780: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
57A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
57C0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
57E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF03
.enddata
					Storage: Internal
					Picture Transparent Color: Gray
					Fit: Scale
					Scaling
						Width:  100
						Height:  100
					Corners: Square
					Border Style: No Border
					Border Thickness: 1
					Tile To Parent? No
					Border Color: Default
					Background Color: 3D Face Color
					Message Actions
		Contents
			Column: DL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отделение
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: USER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Исполнитель
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Цель
						договора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: БС
				Visible? Yes
				Editable? No
				Maximum Data Length: 4
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лицевой счет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Валюта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						БС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование счета
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CRISK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фин. стан
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отрасль
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CREG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Регион
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRINSIDER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Инсайдер
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сред.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SROK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сред.
						срок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вх.Остатки
						 на начало
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Выдано
						кредита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашено
						кредита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Перенос
						на просроч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Перенос
						на сомнит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Исх.Остатки 
						на конец
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COUNT_RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						Контрагентов
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COUNT_ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COUNT_NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						счетов
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: USER_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AIM_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Цель
						договора
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код Валюти
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CRISK_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OE_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CREG_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRINSIDER_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.Tbl_An.DAT1 > hWndForm.Tbl_An.DAT2 
						Call Debug ('Дата-1 больше Дата-2 !')
						Set hWndForm.Tbl_An.DAT2 = AddMonths(hWndForm.Tbl_An.DAT1,1)
			Function: NASEL_TBL1
				Description:
				Returns
					Boolean: bOK
				Parameters
					Date/Time: DAT1
					Date/Time: DAT2
				Static Variables
				Local variables
				Actions
		Window Parameters
			Number: nTip_Ur
			Number: nTip_Kl
			String: sGr
			String: strPar02
		Window Variables
			Boolean: FL
			Number: nGr
			! !!!!!!!!!!
			Date/Time: BD
			Number: nTmp
			Number: n3
			Window Handle: hColumn
			Window Handle: hColumnHandle
			Number: nOrderBy
			String: sTmp
			! --- for position
			Number: nWW
			Number: nWH
			Number: nX
			Number: nY
			Number: nW
			Number: nH
			Number: nCH
			Number: nCX
			Number: nCY
			Number: nCW
		Message Actions
			On SAM_Create
				If SalFontSet ( Tbl_An.S0, 'Default', 10, 8 )
				Set hWndForm.Tbl_An.strPrintFileName = 'CC_AN'
				Set hWndForm.Tbl_An.nTabInstance = 1
				Call SalTblSetLockedColumns( hWndForm, 11 )
				Set hWndForm.Tbl_An.DAT2 = GetBankDate()
				Set hWndForm.Tbl_An.DAT1 = AddMonths( hWndForm.Tbl_An.DAT2, -1 )
				Set hWndForm.Tbl_An.nGr  = Val(hWndForm.Tbl_An.sGr)
				Call SalSetWindowText(hWndForm, 'Анализ ресурса, ставок, сроков ' || strPar02 )
				Call SalDisableWindow(Tbl_An.pbDetails)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				! !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! кредит
				Call PrepareWindowEx(hWndForm)
				Call XSalTooltipSetUserDefault()
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				! ! Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Tbl_An.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
				Set DAT1 = GetBankDate()
				Set DAT2 = GetBankDate()
				! If nHaveTOBO = 0
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalHideWindow(sBRANCH)
				! Else If nHaveTOBO = 2
					! Код подразделения
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblSetColumnTitle(sBRANCH, CurrentLangTable.GetAtomTitle('Tbl_An.sSUBBRANCH'))
				! Call ZAGOLOVOK(dfDate1,dfDate2)
				Call SalHideWindow(Tbl_An.KV )
				Call SetWindowFullSize(hWndForm)
				Call SalTblPopulate(tbl1, hSql(),
						                                                  "  select  a,b,c,d  INTO :tbl1.sSELE,:tbl1.sINTO,:tbl1.sNAME,:tbl1.nFLAG from (
						                                                                SELECT 'c.branch,tobo.name' a,':Tbl_An.BRANCH_ID,:Tbl_An.BRANCH' b,' Отделение ' c,0 d 
									FROM dual
									UNION ALL
									SELECT 'c.userid,f.fio',':Tbl_An.USER_ID,:Tbl_An.USER','Исполнитель', 0
									FROM dual
									UNION ALL
									SELECT 'a.kv,t.name',':Tbl_An.KV_ID,:Tbl_An.KV',' Валюта ',0
									FROM dual
									UNION ALL
									SELECT 'a.nbs,substr(p.NAME,1,40)',':Tbl_An.NBS_ID,:Tbl_An.NBS',' Бал. счет ',0
									FROM dual 
									UNION ALL
									SELECT 'c.aim,aim.name',':Tbl_An.AIM_ID,:Tbl_An.AIM',' Цель договора ', 0
									FROM dual 
									UNION ALL
									SELECT 'a.nls,a.nms',':Tbl_An.NLS_ID,:Tbl_An.NLS',' Лицевой счет ', 0
									FROM dual 
									UNION ALL
									SELECT 'sf.fin,sf.name',':Tbl_An.CRISK_ID,:Tbl_An.CRISK',' Фин. сост. контрагента ',0
									FROM dual
									UNION ALL
									SELECT 'oe.oe,oe.name',':Tbl_An.OE_ID,:Tbl_An.OE',' Отрасль ',0
									FROM dual
									UNION ALL
									SELECT 'so.c_reg,so.name_reg',':Tbl_An.CREG_ID,:Tbl_An.CREG',' По региону ', 0
									FROM dual 
									UNION ALL
									SELECT 'pr.PRINSIDER,pr.name',':Tbl_An.PRINSIDER_ID,:Tbl_An.PRINSIDER',' Инсайдер ', 0
									FROM dual  ) ",  TBL_FillAll)
				Set n3 = 0
				Set BD = GetBankDate()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
			On SAM_FetchRowDone
				Set hWndForm.Tbl_An.KOS  = - hWndForm.Tbl_An.KOS
				If hWndForm.Tbl_An.DL = 'S'
					Set hWndForm.Tbl_An.DOSN = - hWndForm.Tbl_An.DOSN 
					Set hWndForm.Tbl_An.KOSN = - hWndForm.Tbl_An.KOSN 
				Else If hWndForm.Tbl_An.DL = 'P'
					Set hWndForm.Tbl_An.KOSN = - hWndForm.Tbl_An.KOSN 
				Else If hWndForm.Tbl_An.DL = 'L'
					Set hWndForm.Tbl_An.DOSN = - hWndForm.Tbl_An.DOSN 
				Set hWndForm.Tbl_An.S0 = 
						hWndForm.Tbl_An.S - hWndForm.Tbl_An.DOS - 
						hWndForm.Tbl_An.KOS - hWndForm.Tbl_An.DOSN - hWndForm.Tbl_An.KOSN
				! Красный
				If hWndForm.Tbl_An.DOS != 0
					Call XSalTblSetCellBackColor(hWndForm.Tbl_An.DOS, SalColorFromRGB( 255,210,250 ) )
				! голубой
				If hWndForm.Tbl_An.KOS != 0
					Call XSalTblSetCellBackColor(hWndForm.Tbl_An.KOS, COLOR_Sky )
				! слобо-зеленые 
				If hWndForm.Tbl_An.DOSN != 0
					Call XSalTblSetCellBackColor( hWndForm.Tbl_An.DOSN, SalColorFromRGB( 230,255,230 ))
				If hWndForm.Tbl_An.KOSN != 0
					Call XSalTblSetCellBackColor( hWndForm.Tbl_An.KOSN, SalColorFromRGB( 230,255,230 ))
			On SAM_DoubleClick
				Call SalSendMsg( pbTable, SAM_Click, 0, 0 )
			On SAM_ColumnSelectClick
				Call SalWaitCursor( TRUE )
				Set hColumn = SalNumberToWindowHandle( wParam )
				Set nOrderBy = Not nOrderBy
				Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nOrderBy )
				Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
				Call SalWaitCursor( FALSE )
			On WM_Size
				Call SalGetWindowSize( hWndForm, nWW, nWH )
				If nWW >= 14
					If nWH < 4.5
						Call SalSetWindowSize( hWndForm, nWW,4.5 )
				Else
					If nWH < 4.5
						Call SalSetWindowSize( hWndForm, 14, 4.5 )
					Else
						Call SalSetWindowSize( hWndForm, 14, nWH )
				Call GetClientRect( hWndForm, nX, nY, nW, nH )
				Call SalGetWindowSize( hWndForm.Tbl_An.pic1, nCW, nCH )
				Call SalGetWindowLoc( hWndForm.Tbl_An.pic1, nCX, nCY )
				Call SalSetWindowLoc( hWndForm.Tbl_An.pic1,
						       SalPixelsToFormUnits( hWndForm, nW, FALSE )-nCW-0.1, nCY )
				Call SalInvalidateWindow( hWndForm )
	Table Window: Tbl_An1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Анализ КП банка
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.288"
				Top:    0.083"
				Width:  13.533"
				Width Editable? Class Default
				Height: 6.726"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.464"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.467"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15796
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.967"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.483"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Установить фильтр...'
						On SAM_Click
							If rb_A and SetQueryFilter( cF_A ) 
								Set sFilt_A = ""
								Set sFilt_A = cF_A.GetFilterWhereClause( FALSE )
							Else If rb_T and SetQueryFilter( cF_T )
								Set sFilt_T = ""
								Set sFilt_T = cF_T.GetFilterWhereClause( FALSE )
							Call NASELENIE()
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.1"
						Top:    0.083"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.433"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15797
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.9"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15798
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.083"
							Width:  1.45"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call Tbl_An1.F_DAT()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Начало периода для анализа' )
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.867"
							Top:    0.095"
							Width:  1.45"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call Tbl_An1.F_DAT()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Конец периода для анализа' )
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.3"
						Top:    0.083"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Выполнить расчет за заданный период"
						On SAM_Click
							If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand(hSql(), "CCK.cc_ANALIZ1 
										(Tbl_An1.BKV, Tbl_An1.DAT1, Tbl_An1.DAT2 ) " )
									Call SqlCommit( hSql() )
									Call SalEnableWindow(pbFilter)
									Call SalWaitCursor(FALSE)
								Else
									Call SqlRollback(hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait( 'Ошибка при выполнении процедуры !',"CCK.cc_ANALIZ  " , 30, 1 )
				!
				Data Field: BKV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.85"
							Top:    0.083"
							Width:  0.667"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Базавая валюта эквивалента сумм' )
						On SAM_Create
							Set BKV = GetBaseVal()
							Call SalSendMsg( BKV, SAM_Validate, 0, 0 )
						On SAM_Validate
							If SqlPrepareAndExecute( hSql(),
									  "SELECT lcv INTO :SKV  FROM tabval WHERE kv=:BKV " )
									 and SqlFetchNext(  hSql(), nFetchRes )
								Call SalEnableWindow( pb_Run )
							Else
								Call SalDisableWindow( pb_Run )
				Data Field: SKV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.567"
							Top:    0.083"
							Width:  0.667"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код ISO баз.вал.' )
				Frame
					Resource Id: 15799
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.75"
						Top:    0.071"
						Width:  3.617"
						Width Editable? Yes
						Height: 0.345"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb_T
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: По клиентам
					Window Location and Size
						Left:   7.55"
						Top:    0.119"
						Width:  1.617"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Свод
					Window Location and Size
						Left:   6.1"
						Top:    0.119"
						Width:  1.317"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
		Contents
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заемщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_KVL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						лим
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIM 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тек.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сред.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						долга
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Задолж
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: UV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %Уд.
						вес
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ост.нач.%
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Нач.%
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пог.%
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ZAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залог
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Резерв
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Q
			Column: LIMQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит
						экв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Задолж
						экв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SNQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ост.нач.%
						экв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VNQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Нач.%
						экв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пог.%
						эвк
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ZALQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залог
						экв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REZQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Резерв
						экв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						БС
				Visible? Yes
				Editable? No
				Maximum Data Length: 4
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_S080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						риска
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						типа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_SROK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						сроч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_POR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						порога
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_OE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						отрасли
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_REG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						области
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_INS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						инсайд
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол
						сч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.65"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KVL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						лим
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						типа
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						риска
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SROK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сроч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						отрас
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: INSIDER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						инсайд
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: POROG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						порога
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						обл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			!
			Column: NAME_NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						БС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If Tbl_An1.DAT1 > Tbl_An1.DAT2 
						Call Debug ('Дата-1 больше Дата-2 !')
						Set Tbl_An1.DAT2 = AddMonths(Tbl_An1.DAT1,1)
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSQLI
					String: sSQLC
				Actions
					Call SalWaitCursor(TRUE)
					If rb_A  !! по БС
						Call SalHideWindow( Tbl_An1.CC_ID )
						Call SalHideWindow( Tbl_An1.NMK )
						! 
								DOS = LIM_  n1  -лимиты разные
								S   = S_    n2  -остаток долга
								DOSN= VN_   n4  -расчетные %
								SN  = SN_   n3  -остатки на сч нач %
								KOS = KOS_  n5  -уплаченные % (кред обороты минус внутр.переброски)
						Set sSQLC = 
								"(select a.KV KVL, T.KV, T.NBS, T.DL, T.SROK, T.OE, T.INSIDER, T.TIP,T.POROG,T.REG,
								         ABS(decode(sum(T.N2),0,0,sum(T.N2*T.PR)/sum(T.N2))) PR,
								         count(*) KOSN, ABS(sum(T.N1)) DOS, ABS(sum(T.N2)) S,
								         ABS(sum(T.N3)) SN, ABS(sum(T.N4)) DOSN,    ABS(sum(T.N5)) KOS,
								         sum(zal) ZAL, sum(zalQ) ZALQ, sum(rez) REZ, sum(rezQ) REZQ, sum(uv) UV
								  from cck_an_tmp T, accounts a  where a.acc=T.accL
								  group by  a.kv, t.kv,t.nbs,t.dl,t.srok,t.oe,t.insider,t.tip,t.porog,t.REG ) "
						Set Tbl_An1.strSqlPopulate =
								"SELECT  tl.lcv, c.KV, c.NBS, c.TIP, c.DL, c.SROK, c.OE, c.INSIDER, c.REG, 
								         c.DOS, c.POROG, c.S, c.KOSN, 
								         c.ZAL, c.zalQ, c.rez, c.rezQ, c.UV, c.PR,  
								         c.SN, c.DOSN, c.KOS, substr(p.name,1,10), 
								         substr(r.name,1,10),  substr(t.name,1,10), substr(o.name,1,35), 
								         substr(i.name,1,10),  substr(g.name,1,10), s.NAME_REG,
								    gl.p_icurval( c.KV, c.DOS, :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.S  , :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.SN , :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.DOSN,:Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.KOS, :Tbl_An1.DAT2 ),
								    v.LCV, substr(b.name,1,50) 
								 FROM "|| sSQLC ||" C,  cck_tip P,  CRISK R,  cck_term T, OE O,  PRINSIDER I,
								      cck_size G, SPR_OBL S, tabval V, ps B, tabval tl 
								WHERE " || IifS( sFilt_A !='', sFilt_A || ' and ','') || 
								      " ( c.DOS<>0 or c.S<>0 or c.SN<>0 or c.DOSN<>0 or c.KOS<>0 ) and 
								      c.nbs is not null and  c.kv=v.KV and c.nbs=b.nbs and 
								      c.TIP   =p.id (+) and  c.DL  = r.CRISK (+) and 
								      c.SROK  =t.id (+) and  c.OE  = o.oe    (+) and 
								      c.POROG =g.id (+) and  c.REG = s.C_REG (+) and
								      c.INSIDER =i.PRINSIDER (+) and c.kvl=tl.kv 
								ORDER BY c.KV, c.NBS 
								 INTO :Tbl_An1.NAME_KVL,
								      :Tbl_An1.KV, :Tbl_An1.NBS,:Tbl_An1.TIP, :Tbl_An1.S080, :Tbl_An1.SROK,:Tbl_An1.OE,
								      :Tbl_An1.INSIDER,:Tbl_An1.REG,
								      :Tbl_An1.LIM, :Tbl_An1.POROG, :Tbl_An1.S, 
								      :Tbl_An1.KOL,
								      :Tbl_An1.ZAL, :Tbl_An1.ZALQ, :Tbl_An1.REZ, :Tbl_An1.REZQ, :Tbl_An1.UV,
								      :Tbl_An1.PR, :Tbl_An1.SN, :Tbl_An1.VN, :Tbl_An1.KOS, :Tbl_An1.NAME_TIP,
								      :Tbl_An1.NAME_S080,:Tbl_An1.NAME_SROK,:Tbl_An1.NAME_OE, 
								      :Tbl_An1.NAME_INS, :Tbl_An1.NAME_POR, :Tbl_An1.NAME_REG,
								      :Tbl_An1.LIMQ, :Tbl_An1.SQ, :Tbl_An1.SNQ, :Tbl_An1.VNQ, :Tbl_An1.KOSQ,
								      :Tbl_An1.NAME_KV, :Tbl_An1.NAME_NBS " 
								
						Set sSQLI = 
								"SELECT sum(gl.p_icurval( a.KV, c.n1, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n2, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n4, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n3, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n5, :Tbl_An1.DAT2 ) ),
								        sum(zalQ),  sum(rezQ)
								   INTO :Tbl_An1.LIM, :Tbl_An1.S, :Tbl_An1.VN, :Tbl_An1.SN, :Tbl_An1.KOS, 
								        :Tbl_An1.ZAL, :Tbl_An1.REZ
								   FROM  cck_an_tmp C, accounts a
								   WHERE " || IifS( sFilt_A !='', sFilt_A || ' and ','')  || 
								         " c.accl=a.acc AND c.nbs is not null " 
					Else !! по клиентам
						Call SalShowWindow( Tbl_An1.CC_ID )
						Call SalShowWindow( Tbl_An1.NMK )
						Set Tbl_An1.strSqlPopulate =
								"SELECT  a.kv, tl.lcv, c.PRS, 
								         c.KV, c.NBS, c.TIP, c.DL, c.SROK, c.OE, c.INSIDER, c.REG, 
								         c.n1, c.POROG, c.n2,
								         c.zal, c.zalQ, c.rez, c.rezQ, c.uv,
								         c.PR,  c.n3, c.n4, c.n5, substr(p.name,1,10), 
								         substr(r.name,1,10),  substr(t.name,1,10), substr(o.name,1,35), 
								         substr(i.name,1,10),  substr(g.name,1,10), s.NAME_REG,
								         c.cc_id, c.name,
								    gl.p_icurval( a.KV, c.n1, :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.n2, :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.n3, :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.n4, :Tbl_An1.DAT2 ), 
								    gl.p_icurval( c.KV, c.n5, :Tbl_An1.DAT2 ),
								    v.LCV, substr(b.name,1,50) 
								 INTO :Tbl_An1.KVL, :Tbl_An1.NAME_KVL, :Tbl_An1.PRS,
								      :Tbl_An1.KV, :Tbl_An1.NBS,:Tbl_An1.TIP, :Tbl_An1.S080, :Tbl_An1.SROK, :Tbl_An1.OE, 
								      :Tbl_An1.INSIDER,:Tbl_An1.REG,
								      :Tbl_An1.LIM,:Tbl_An1.POROG, :Tbl_An1.S, 
								      :Tbl_An1.ZAL, :Tbl_An1.ZALQ, :Tbl_An1.REZ, :Tbl_An1.REZQ, :Tbl_An1.UV,
								      :Tbl_An1.PR, :Tbl_An1.SN, :Tbl_An1.VN, :Tbl_An1.KOS, :Tbl_An1.NAME_TIP,
								      :Tbl_An1.NAME_S080,:Tbl_An1.NAME_SROK,:Tbl_An1.NAME_OE, 
								      :Tbl_An1.NAME_INS, :Tbl_An1.NAME_POR, :Tbl_An1.NAME_REG,
								      :Tbl_An1.CC_ID, :Tbl_An1.NMK,
								   :Tbl_An1.LIMQ, :Tbl_An1.SQ, :Tbl_An1.SNQ, :Tbl_An1.VNQ, :Tbl_An1.KOSQ,
								   :Tbl_An1.NAME_KV, :Tbl_An1.NAME_NBS
								 FROM  cck_an_tmp C, cck_tip   P, CRISK    R, cck_term T,
								       OE         O, PRINSIDER I, cck_size G, SPR_OBL  S,
								       tabval     V, ps        B, accounts a , tabval tl 
								 WHERE " || IifS( sFilt_T !='', sFilt_T || ' and ','') || 
								      "( c.n1<>0 or c.n2<>0 or c.n3<>0 or c.n4<>0 or c.n5<>0 ) and 
								       c.nbs is not null and  c.kv=v.KV and c.nbs=b.nbs and 
								       c.TIP   =p.id (+) and  c.DL  = r.CRISK (+) and 
								       c.SROK  =t.id (+) and  c.OE  = o.oe    (+) and 
								       c.POROG =g.id (+) and  c.REG = s.C_REG (+) and
								       c.INSIDER =i.PRINSIDER (+) and
								       c.accL=a.acc and a.kv=tl.kv 
								 ORDER BY c.name, nvl(c.CC_ID, c.nbs) "
						Set sSQLI = 
								"SELECT sum(gl.p_icurval( a.KV, c.n1, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n2, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n4, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n3, :Tbl_An1.DAT2 ) ),
								        sum(gl.p_icurval( c.KV, c.n5, :Tbl_An1.DAT2 ) ),
								        sum(zalQ),  sum(rezQ)
								   INTO :Tbl_An1.LIM, :Tbl_An1.S, :Tbl_An1.VN, :Tbl_An1.SN, :Tbl_An1.KOS, 
								        :Tbl_An1.ZAL, :Tbl_An1.REZ
								   FROM  cck_an_tmp C, accounts a
								   WHERE " || IifS( sFilt_T !='', sFilt_T || ' and ','')  || 
								         " c.accl=a.acc AND c.nbs is not null " 
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Call SalTblPopulate(hWndForm, hSql(), Tbl_An1.strSqlPopulate, TBL_FillAll)
					!
					Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
					Set Tbl_An1.nRow = SalTblInsertRow( hWndForm, TBL_MinRow  )
					Call SalTblSetContext ( hWndForm, Tbl_An1.nRow )                               
					Call SalTblSetRowFlags( hWndForm, Tbl_An1.nRow, ROW_New, FALSE )
					!
					If SqlPrepareAndExecute( hSqlAux2(), sSQLI)  and SqlFetchNext( hSqlAux2(), nFetchRes )
						If Tbl_An1.BKV !=  Tbl_An1.n980 
							If SqlPrepareAndExecute( hSqlAux2(),                  " SELECT gl.p_Ncurval(:BKV,:LIM,:DAT2), 
									 gl.p_Ncurval(:BKV,:S,  :DAT2), gl.p_Ncurval(:BKV,:SN, :DAT2), gl.p_Ncurval(:BKV,:VN, :DAT2),
									 gl.p_Ncurval(:BKV,:KOS,:DAT2), gl.p_Ncurval(:BKV,:ZAL,:DAT2), gl.p_Ncurval(:BKV,:REZ,:DAT2) 
									INTO :LIM, :S, :SN, :VN, :KOS, :ZAL, :REZ  FROM dual " )
									and SqlFetchNext( hSqlAux2(),  nFetchRes )
						Set LIM  = LIM  / 100
						Set S    = S    / 100
						Set SN   = SN   / 100
						Set VN   = VN   / 100
						Set KOS  = KOS  / 100
						Set REZ  = REZ  / 100
						Set ZAL  = ZAL  / 100
					Set Tbl_An1.NAME_KVL = SKV
					Set Tbl_An1.NAME_KV = SKV
					Call SalTblSetContext( hWndForm, 0)
					Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
			! Function: NASELENIE
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Description: 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Returns 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Parameters 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Static Variables 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Local variables 
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    String: sSQLI
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    String: sSQLC
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Actions 
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalWaitCursor(TRUE)
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    If rb_A  !! по БС
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalHideWindow( Tbl_An1.CC_ID )
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalHideWindow( Tbl_An1.NMK )
						! 
								DOS = LIM_  n1  -лимиты разные
								S   = S_    n2  -остаток долга
								DOSN= VN_   n4  -расчетные %
								SN  = SN_   n3  -остатки на сч нач %
								KOS = KOS_  n5  -уплаченные % (кред обороты минус внутр.переброски)
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set sSQLC = 
								"(select a.KV KVL, T.KV, T.NBS, T.DL, T.SROK, T.OE, T.INSIDER, T.TIP,T.POROG,T.REG,
								         ABS(decode(sum(T.N2),0,0,sum(T.N2*T.PR)/sum(T.N2))) PR,
								         count(*) KOSN, ABS(sum(T.N1)) DOS, ABS(sum(T.N2)) S,
								         ABS(sum(T.N3)) SN, ABS(sum(T.N4)) DOSN,    ABS(sum(T.N5)) KOS,
								         sum(zal) ZAL, sum(zalQ) ZALQ, sum(rez) REZ, sum(rezQ) REZQ, sum(uv) UV
								  from cck_an_tmp T, accounts a  where a.acc=T.accL
								  group by  a.kv, t.kv,t.nbs,t.dl,t.srok,t.oe,t.insider,t.tip,t.porog,t.REG ) "
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set Tbl_An1.strSqlPopulate =
								"SELECT  tl.lcv, c.KV, c.NBS, c.TIP, c.DL, c.SROK, c.OE, c.INSIDER, c.REG, 
								         c.DOS/100, c.POROG, c.S/100, c.KOSN, 
								         c.ZAL/100, c.zalQ/100, c.rez/100, c.rezQ/100, c.UV, c.PR,  
								         c.SN/100, c.DOSN/100, c.KOS/100, substr(p.name,1,10), 
								         substr(r.name,1,10),  substr(t.name,1,10), substr(o.name,1,35), 
								         substr(i.name,1,10),  substr(g.name,1,10), s.NAME_REG,
								    gl.p_icurval( c.KV, c.DOS, :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.S  , :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.SN , :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.DOSN,:Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.KOS, :Tbl_An1.DAT2 )/100,
								    v.LCV, substr(b.name,1,50) 
								 FROM "|| sSQLC ||" C,  cck_tip P,  CRISK R,  cck_term T, OE O,  PRINSIDER I,
								      cck_size G, SPR_OBL S, tabval V, ps B, tabval tl 
								WHERE " || IifS( sFilt_A !='', sFilt_A || ' and ','') || 
								      " ( c.DOS<>0 or c.S<>0 or c.SN<>0 or c.DOSN<>0 or c.KOS<>0 ) and 
								      c.nbs is not null and  c.kv=v.KV and c.nbs=b.nbs and 
								      c.TIP   =p.id (+) and  c.DL  = r.CRISK (+) and 
								      c.SROK  =t.id (+) and  c.OE  = o.oe    (+) and 
								      c.POROG =g.id (+) and  c.REG = s.C_REG (+) and
								      c.INSIDER =i.PRINSIDER (+) and c.kvl=tl.kv 
								ORDER BY c.KV, c.NBS 
								 INTO :Tbl_An1.NAME_KVL,
								      :Tbl_An1.KV, :Tbl_An1.NBS,:Tbl_An1.TIP, :Tbl_An1.S080, :Tbl_An1.SROK,:Tbl_An1.OE,
								      :Tbl_An1.INSIDER,:Tbl_An1.REG,
								      :Tbl_An1.LIM, :Tbl_An1.POROG, :Tbl_An1.S, 
								      :Tbl_An1.KOL,
								      :Tbl_An1.ZAL, :Tbl_An1.ZALQ, :Tbl_An1.REZ, :Tbl_An1.REZQ, :Tbl_An1.UV,
								      :Tbl_An1.PR, :Tbl_An1.SN, :Tbl_An1.VN, :Tbl_An1.KOS, :Tbl_An1.NAME_TIP,
								      :Tbl_An1.NAME_S080,:Tbl_An1.NAME_SROK,:Tbl_An1.NAME_OE, 
								      :Tbl_An1.NAME_INS, :Tbl_An1.NAME_POR, :Tbl_An1.NAME_REG,
								      :Tbl_An1.LIMQ, :Tbl_An1.SQ, :Tbl_An1.SNQ, :Tbl_An1.VNQ, :Tbl_An1.KOSQ,
								      :Tbl_An1.NAME_KV, :Tbl_An1.NAME_NBS " 
								
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set sSQLI = 
								"SELECT sum(gl.p_icurval( a.KV, c.n1, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n2, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n4, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n3, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n5, :Tbl_An1.DAT2 )/100 ),
								        sum(zalQ)/100,  sum(rezQ)/100
								   INTO :Tbl_An1.LIM, :Tbl_An1.S, :Tbl_An1.VN, :Tbl_An1.SN, :Tbl_An1.KOS, 
								        :Tbl_An1.ZAL, :Tbl_An1.REZ
								   FROM  cck_an_tmp C, accounts a
								   WHERE " || IifS( sFilt_A !='', sFilt_A || ' and ','')  || 
								         " c.accl=a.acc AND c.nbs is not null " 
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Else !! по клиентам
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalShowWindow( Tbl_An1.CC_ID )
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalShowWindow( Tbl_An1.NMK )
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set Tbl_An1.strSqlPopulate =
								"SELECT  a.kv, tl.lcv, c.PRS, 
								         c.KV, c.NBS, c.TIP, c.DL, c.SROK, c.OE, c.INSIDER, c.REG, 
								         c.n1/100, c.POROG, c.n2/100,
								         c.zal/100, c.zalQ/100, c.rez/100, c.rezQ/100, c.uv,
								         c.PR,  c.n3/100, c.n4/100, c.n5/100, substr(p.name,1,10), 
								         substr(r.name,1,10),  substr(t.name,1,10), substr(o.name,1,35), 
								         substr(i.name,1,10),  substr(g.name,1,10), s.NAME_REG,
								         c.cc_id, c.name,
								    gl.p_icurval( a.KV, c.n1, :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.n2, :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.n3, :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.n4, :Tbl_An1.DAT2 )/100, 
								    gl.p_icurval( c.KV, c.n5, :Tbl_An1.DAT2 )/100,
								    v.LCV, substr(b.name,1,50) 
								 INTO :Tbl_An1.KVL, :Tbl_An1.NAME_KVL, :Tbl_An1.PRS,
								      :Tbl_An1.KV, :Tbl_An1.NBS,:Tbl_An1.TIP, :Tbl_An1.S080, :Tbl_An1.SROK, :Tbl_An1.OE, 
								      :Tbl_An1.INSIDER,:Tbl_An1.REG,
								      :Tbl_An1.LIM,:Tbl_An1.POROG, :Tbl_An1.S, 
								      :Tbl_An1.ZAL, :Tbl_An1.ZALQ, :Tbl_An1.REZ, :Tbl_An1.REZQ, :Tbl_An1.UV,
								      :Tbl_An1.PR, :Tbl_An1.SN, :Tbl_An1.VN, :Tbl_An1.KOS, :Tbl_An1.NAME_TIP,
								      :Tbl_An1.NAME_S080,:Tbl_An1.NAME_SROK,:Tbl_An1.NAME_OE, 
								      :Tbl_An1.NAME_INS, :Tbl_An1.NAME_POR, :Tbl_An1.NAME_REG,
								      :Tbl_An1.CC_ID, :Tbl_An1.NMK,
								   :Tbl_An1.LIMQ, :Tbl_An1.SQ, :Tbl_An1.SNQ, :Tbl_An1.VNQ, :Tbl_An1.KOSQ,
								   :Tbl_An1.NAME_KV, :Tbl_An1.NAME_NBS
								 FROM  cck_an_tmp C, cck_tip   P, CRISK    R, cck_term T,
								       OE         O, PRINSIDER I, cck_size G, SPR_OBL  S,
								       tabval     V, ps        B, accounts a , tabval tl 
								 WHERE " || IifS( sFilt_T !='', sFilt_T || ' and ','') || 
								      "( c.n1<>0 or c.n2<>0 or c.n3<>0 or c.n4<>0 or c.n5<>0 ) and 
								       c.nbs is not null and  c.kv=v.KV and c.nbs=b.nbs and 
								       c.TIP   =p.id (+) and  c.DL  = r.CRISK (+) and 
								       c.SROK  =t.id (+) and  c.OE  = o.oe    (+) and 
								       c.POROG =g.id (+) and  c.REG = s.C_REG (+) and
								       c.INSIDER =i.PRINSIDER (+) and
								       c.accL=a.acc and a.kv=tl.kv 
								 ORDER BY c.name, nvl(c.CC_ID, c.nbs) "
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set sSQLI = 
								"SELECT sum(gl.p_icurval( a.KV, c.n1, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n2, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n4, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n3, :Tbl_An1.DAT2 )/100 ),
								        sum(gl.p_icurval( c.KV, c.n5, :Tbl_An1.DAT2 )/100 ),
								        sum(zalQ)/100,  sum(rezQ)/100
								   INTO :Tbl_An1.LIM, :Tbl_An1.S, :Tbl_An1.VN, :Tbl_An1.SN, :Tbl_An1.KOS, 
								        :Tbl_An1.ZAL, :Tbl_An1.REZ
								   FROM  cck_an_tmp C, accounts a
								   WHERE " || IifS( sFilt_T !='', sFilt_T || ' and ','')  || 
								         " c.accl=a.acc AND c.nbs is not null " 
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblPopulate(hWndForm, hSql(), Tbl_An1.strSqlPopulate, TBL_FillAll)
					!
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set Tbl_An1.nRow = SalTblInsertRow( hWndForm, TBL_MinRow  )
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblSetContext ( hWndForm, Tbl_An1.nRow )                               
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblSetRowFlags( hWndForm, Tbl_An1.nRow, ROW_New, FALSE )
					!
					! Call Debug (sSQLI)
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    If SqlPrepareAndExecute( hSqlAux2(), sSQLI)  and SqlFetchNext( hSqlAux2(), nFetchRes )
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set Tbl_An1.NAME_KVL = SKV
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Set Tbl_An1.NAME_KV = SKV
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalTblSetContext( hWndForm, 0)
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nTip_Par
			Number: nMode
			Number: nGr
		Window Variables
			Number: nRow
			Number: n980
			!
			: cF_A
				Class: cGenFilter
			: cF_T
				Class: cGenFilter
			String: sFilt_A
			String: sFilt_T
		Message Actions
			On SAM_Create
				Set Tbl_An1.strPrintFileName = 'CC_AN1'
				Set Tbl_An1.n980 = GetBaseVal()
				Set Tbl_An1.nTabInstance = 1
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Set Tbl_An1.DAT2 = GetBankDate()
				Set Tbl_An1.DAT1 = AddMonths( Tbl_An1.DAT2, -1 )
				! Set Tbl_An1.strFilterTblName = 'CCK_ANALIZ'
				Call cF_A.Init( 'CCK_ANALIZ' , 'C' )
				Call cF_T.Init( 'CCK_AN_TMP', 'C' )
				Set rb_A = TRUE
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
			On SAM_FetchRowDone
				If Tbl_An1.BKV !=  Tbl_An1.n980 
					If SqlPrepareAndExecute( hSqlAux2(),                  " SELECT gl.p_Ncurval(:BKV,:LIMQ,:DAT2), 
							 gl.p_Ncurval(:BKV,:SQ,  :DAT2), gl.p_Ncurval(:BKV,:SNQ, :DAT2), gl.p_Ncurval(:BKV,:VNQ, :DAT2),
							 gl.p_Ncurval(:BKV,:KOSQ,:DAT2), gl.p_Ncurval(:BKV,:ZALQ,:DAT2), gl.p_Ncurval(:BKV,:REZQ,:DAT2) 
							INTO :LIMQ, :SQ, :SNQ, :VNQ, :KOSQ, :ZALQ, :REZQ  FROM dual " )
							and SqlFetchNext( hSqlAux2(),  nFetchRes )
				Set LIM  = LIM  / 100
				Set LIMQ = LIMQ / 100
				Set S    = S    / 100
				Set SQ   = SQ   / 100
				Set SN   = SN   / 100
				Set SNQ  = VNQ  / 100
				Set VN   = VN   / 100
				Set VNQ  = SNQ  / 100
				Set KOS  = KOS  / 100
				Set KOSQ = KOSQ / 100
				Set REZ  = REZ  / 100
				Set REZQ = REZQ / 100
				Set ZAL  = ZAL  / 100
				Set ZALQ = ZALQ / 100
	!
	Dialog Box: dlg_SV12
		Class:
		Property Template:
		Class DLL Name:
		Title: Объединение КД-1 с КД-2
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  10.483"
				Width Editable? Yes
				Height: 2.036"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Выполнить
				Window Location and Size
					Left:   2.671"
					Top:    1.031"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If MODE =0 
							Set sTmp = "Внимание ! КД реф="||Str(ND)||" присоединяется к КД реф="||Str(ND2)
							Set sTmp1 = "Техническое удаление КД реф="||Str(ND)
							Set pTmp = "CCK.CC_SV12( ND1, ND2)"
						Else If MODE = 1
							Set sTmp = "Внимание ! КД реф="||Str(ND)||" устанавливается баз.вал="||Str(KV2)
							Set sTmp1 = "Переустановка баз.вал КД реф="||Str(ND)
							Set pTmp = "CCK.CC_KV( ND1, KV1, KV2 )"
						If SalMessageBox
								(sTmp, sTmp1, MB_YesNo | MB_IconHand) = IDYES
							If SqlPLSQLCommand( hSql(), pTmp )
								Call SqlCommitEx( hSql(), sTmp )
								Call MessageNoWait( sTmp,'Сообщение',3,0)
								Call SalEndDialog( hWndForm,1)
							Else
								Call SqlRollback( hSql() )
								Call MessageError( "Невозможно выполнить " || pTmp )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   3.871"
					Top:    1.031"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm,0 )
			!
			Background Text: 2
				Resource Id: 64979
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.512"
					Width:  0.35"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: KV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    0.488"
						Width:  0.683"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ВАЛ-исх.КД ' )
			Data Field: ND2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.9"
						Top:    0.5"
						Width:  1.083"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.КД-2' )
					On SAM_Validate
			Data Field: CC_ID2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.533"
						Top:    0.5"
						Width:  1.55"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ид.КД-2' )
			Data Field: DAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.633"
						Top:    0.512"
						Width:  1.55"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата КД-2' )
			!
			Data Field: KV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    0.179"
						Width:  0.683"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ВАЛ-вх.КД ' )
			Data Field: ND1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.9"
						Top:    0.179"
						Width:  1.083"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.КД-1' )
			Data Field: CC_ID1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.533"
						Top:    0.179"
						Width:  1.55"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ид.КД-1' )
			Data Field: NMK1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    0.167"
						Width:  3.483"
						Width Editable? Yes
						Height: 0.595"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Заемщик КД-1' )
			Data Field: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.633"
						Top:    0.19"
						Width:  1.55"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата КД-1' )
			Background Text: 1
				Resource Id: 64978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.179"
					Width:  0.35"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Pushbutton: pb3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.0"
					Top:    0.429"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Проверить искомый Код'
					On SAM_Click
						If MODE =0 
							If not SalIsNull(ND2)
								If SqlPrepareAndExecute( hSql(), 
										  "SELECT distinct cc_id, rnk, dsdate INTO :CC_ID2, :nRnk2, :DAT2 
										   FROM cc_V WHERE sos<14 AND rnk =:nRnk and nd=:ND2") 
										and SqlFetchNext(hSql(), nFetchRes) 
									Call SalShowWindow( pbOk )
						Else If MODE =1 
							If not SalIsNull(KV2)
								If SqlPrepareAndExecute( hSql(), 
										  "SELECT name INTO :CC_ID2 
										   FROM tabval WHERE kv = :KV2 and kv<>:KV1 ") 
										and SqlFetchNext(hSql(), nFetchRes) 
									Call SalShowWindow( pbOk )
		Functions
		Window Parameters
			Number: MODE
			Number: ND
			Number: nRnk
			String: NMK
			String: CC_ID
			Date/Time: DAT
			Number: KV
		Window Variables
			Number: nRnk2
			String: sTmp
			String: sTmp1
			String: pTmp
		Message Actions
			On SAM_Create
				Call SalHideWindow( pbOk )
				Call SalCenterWindow(hWndForm)
				Set ND1= ND
				Set CC_ID1= CC_ID
				Set NMK1= NMK
				Set DAT1= DAT
				Set KV1 = KV
				If MODE = 1
					Call SalHideWindow( ND2 )
					! Call SalHideWindow( CC_ID2 )
					Call SalHideWindow( DAT2 )
					Call SalSetWindowText( hWndForm, "Присвоение КД другой базовой валюты" )
				Else If MODE = 0
					Call SalHideWindow( KV2 )
	Dialog Box: dlg_700
		Class:
		Property Template:
		Class DLL Name:
		Title: Выбор доп.реквизита для редактирования
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  7.617"
				Width Editable? Yes
				Height: 4.429"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			!
			Child Table: tbl1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.155"
						Width:  6.6"
						Width Editable? Yes
						Height: 3.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TAG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код 
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.433"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование доп.реквизита
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sTmp
				Message Actions
					On SAM_DoubleClick
						Call SalHideWindow( tbl1 )
						Set sTmp = 'КД и доп.реквізит "'|| NAME||'"'
						If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini( 'CC_TAG', TAG, NAME )" ) 
								and SqlPrepareAndExecute( hSql(),
								   "UPDATE meta_tables set SEMANTIC=:sTmp where TABID=:nTab" ) 
								and SqlPrepareAndExecute( hSql(), 
								   "UPDATE META_COLUMNS set SEMANTIC=:NAME where TABID=:nTab and COLNAME='TAG'")
							Call FunNSIEditFFiltered( sV_CC, 2, sFiltr  )
							Call SalEndDialog(dlg_700, 1)
		Functions
		Window Parameters
			Number: nTip_Kl
		Window Variables
			Number: nTab
			String: sFiltr
			String: sV_CC
		Message Actions
			On SAM_Create
				Set sV_CC = 'V_CC_INS_TAG'
				If SqlPrepareAndExecute( hSql(),"select tabid into :nTab from meta_tables where TABNAME=:sV_CC")
						and NOT SqlFetchNext(hSql(), nFetchRes) 
					Call MessageError( "Не встановлено ПЗ для даної функції ! ")
					Call SalEndDialog(dlg_700, 0)
				Call SalWaitCursor(TRUE)
				Set sFiltr = IifS( nTip_Kl=3, "vidd in (11,12,13)", "vidd in (1,2,3)" ) 
				Call SalTblPopulate(tbl1, hSql(),
						"select tag, name into :tbl1.TAG, :tbl1.NAME from cc_tag where tagtype='CCK'", TBL_FillAll)
				Call SalCenterWindow(hWndForm)
	Dialog Box: dlg_GPK
		Class:
		Property Template:
		Class DLL Name:
		Title: Выбор способа погашения:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  6.333"
				Width Editable? Yes
				Height: 4.655"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Способ разбивки
				Resource Id: 1550
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.167"
					Top:    0.071"
					Width:  5.867"
					Width Editable? Yes
					Height: 1.226"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Radio Button: rbReset !! 1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Погашение кредита равными суммами
				Window Location and Size
					Left:   0.383"
					Top:    0.321"
					Width:  5.25"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rbLast  !! 2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.Возврат всей суммы кредита в конце срока
				Window Location and Size
					Left:   0.383"
					Top:    0.631"
					Width:  5.25"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rbEqual !! 3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 3.Погашение кредита равными долями с %% ( аннуитет )
				Window Location and Size
					Left:   0.383"
					Top:    0.94"
					Width:  5.25"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			!
			Group Box: Способ округления
				Resource Id: 1551
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.067"
					Top:    1.536"
					Width:  5.867"
					Width Editable? Yes
					Height: 2.083"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Radio Button: rb0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0. Коп  1123.45
				Window Location and Size
					Left:   0.383"
					Top:    1.845"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1. 10 "Коп"  1123.50
				Window Location and Size
					Left:   0.383"
					Top:    2.119"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.  100 "коп" 1124.00
				Window Location and Size
					Left:   0.383"
					Top:    2.393"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 3. 1000 "Коп"   1120.00
				Window Location and Size
					Left:   0.383"
					Top:    2.667"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 4. 10000 "Коп"   1100.00
				Window Location and Size
					Left:   0.383"
					Top:    2.94"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 5. 100000 "Коп"   1000.00
				Window Location and Size
					Left:   0.383"
					Top:    3.214"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Переразбить
				Window Location and Size
					Left:   0.35"
					Top:    3.667"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nSelected = 0
						If rbReset
							Set nSelected = 1
						Else If rbLast
							Set nSelected = 2
						Else If rbEqual
							Set nSelected = 3
						!
						If rb0
							Set nDig = 0
						Else If rb1
							Set nDig = 1
						Else If rb2
							Set nDig = 2
						Else If rb3
							Set nDig = 3
						Else If rb4
							Set nDig = 4
						Else If rb5
							Set nDig = 5
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   1.583"
					Top:    3.655"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive Number: nSelected 
			Receive Number: nDig
		Window Variables
		Message Actions
			On SAM_Create
				If nSelected = 1
					Set rbReset = TRUE
				Else If nSelected = 2
					Set rbLast = TRUE
				Else If nSelected = 3
					Set rbEqual = TRUE
				!
				If nDig = 0
					Set rb0 = TRUE
				Else If nDig = 1
					Set rb1 = TRUE
				Else If nDig = 2
					Set rb2 = TRUE
				Else If nDig = 3
					Set rb3 = TRUE
				Else If nDig = 4
					Set rb4 = TRUE
				Else If nDig = 5
					Set rb5 = TRUE
				!
				Call SalCenterWindow(hWndForm)
	Dialog Box: dlg_CreateDoc
		Class:
		Property Template:
		Class DLL Name:
		Title: Новый документ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.5"
				Width Editable? Yes
				Height: 6.0"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Номер дополнительного соглашения:
				Resource Id: 63291
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.286"
					Top:    0.177"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			List Box: lbAdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenListBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    0.146"
					Width:  1.186"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Yes
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalListPopulate(lbAdd, hSql(), 
								"SELECT adds FROM cc_add WHERE nd=:nND")
			Group Box: Выбор шаблона
				Resource Id: 63292
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.08"
					Top:    0.49"
					Width:  8.2"
					Width Editable? Yes
					Height: 4.6"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tblTemplates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.16"
						Top:    0.74"
						Width:  8.0"
						Width Editable? Yes
						Height: 4.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? No
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Идентификатор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Boolean: bSortOrd
				Message Actions
					On SAM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
						Call SalTblPopulate(hWndForm, hSql(),
								"SELECT r.id, s.name
								 INTO :hWndForm.tblTemplates.colId, :hWndForm.tblTemplates.colName
								 FROM cc_deal d, doc_root r, doc_scheme s
								 WHERE d.vidd = r.vidd
								   AND s.id = r.id
								   AND d.nd = :nND 
								 ORDER BY s.name", TBL_FillAll)
						If SalTblAnyRows(hWndForm, 0, 0) != TRUE
							Call SalMessageBox('Для договора не указаны шаблоны!', 'Ошибка', MB_IconStop | MB_Ok)
							Call SalEndDialog(dlg_CreateDoc, 0)
						Else
							Call SalTblSetContext(hWndForm, TBL_MinRow)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Создать
				Window Location and Size
					Left:   5.6"
					Top:    5.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						! Call SalMessageBox( 'Дополнительное соглашение:'||SalListQueryTextX( lbAdd, 0 )||' Код шаблона:'||dlg_CreateDoc.tblTemplates.colId, 'Результат', MB_IconStop | MB_Ok  )
						! Call cdoc_CreateDocFromTemplate(hSql(),hSqlAux(),tblTemplates.colId,nND,)
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), tblTemplates.colId,  nND,lbAdd.GetCurrentKey())
							If sDoc
								! Показываем документ с редактированием
								If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
									! Сохраняем документ в БД
									If NOT cdoc_SetDocText(hSql(), TRUE,
											  tblTemplates.colId, nND, 0, DATETIME_Null, sDoc)
										Call SqlRollback(hSql())
									Else
										Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:' || SalNumberToStrX(lbAdd.GetCurrentKey(),0) || ' сохранен в БД!' )
									! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
											 VALUES (:tblTemplates.colId,:nND,:sDoc,0)' )
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    If SqlSetLongBindDatatype( 3, 23 )
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    If SqlExecute( hSql() )
												                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!' )
												! Return 1
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
						Call SalEndDialog( dlg_CreateDoc, 0 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.967"
					Top:    5.15"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(dlg_CreateDoc, 0)
		Functions
		Window Parameters
			Number: nND
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCnc2
				Class: cABSConnect
			Long String: sDoc
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Новый документ к договору №' ||
						                      SalNumberToStrX(nND, 0) )
				Call SalCenterWindow(hWndForm)
				Call SalSetFocus(pbCancel)
	Dialog Box: dlg_SetDat
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.0"
				Width Editable? Yes
				Height: 2.25"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Новая дата
				Resource Id: 11913
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.217"
					Top:    0.571"
					Width:  1.817"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfDat1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.55"
						Top:    0.571"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: dd/MM/yyyy
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99/99/9999
				Message Actions
			Background Text: Дата начала действия
				Resource Id: 1946
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    0.155"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfDat2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.55"
						Top:    0.155"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: dd/MM/yyyy
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99/99/9999
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Применить
				Window Location and Size
					Left:   0.333"
					Top:    1.226"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.524"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If SalIsNull(dfDat1)
							Call SalMessageBox('Не указана дата пролонгациии', 'О ш и б к а !', 0)
							Call SalSetFocus(dfDat1)
							Return FALSE
						If SalIsNull(dfDat2)
							Call SalMessageBox('Не указана дата начала действия', 'О ш и б к а !', 0)
							Call SalSetFocus(dfDat2)
							Return FALSE
						If dfDat2 < GetBankDate()
							Call SalMessageBox('Дата начала действия новой даты пролонгации болжна быть больше банковской', 'В н и м а н и е !', 0)
							Call SalSetFocus(dfDat2)
							Return FALSE
						If dfDat1 <= dDat1
							If SalMessageBox('Дата пролонгации меньше текущей даты окончания договора. Продолжить?', 'В н и м а н и е !', MB_YesNo) = IDNO
								Set dfDat1 = dDat1
								Call SalSetFocus(dfDat1)
								Return FALSE
							Call SalMessageBox("ГПК содержит записи с датой, большей указанной! Не забудьте ПЕРЕСТРОИТЬ ГПК!", "В н и м а н и е !", 0)
						! Call SqlPrepareAndExecute(hSql(), "select count(*) into :nCountL from cc_lim where  nd=:ND and fdat>:dfDat1")
						! Call SqlFetchNext(hSql(), nFetchRes)
						! If nCountL>0
							                                                                                                                                                                                                                                                                                                                                          Call SalMessageBox("Изменение невозможно! ГПК содержит записи с датой, большей указанной!", "О ш и б к а !", 0)
							                                                                                                                                                                                                                                                                                                                                          Set dfDat1 = dDat1
							                                                                                                                                                                                                                                                                                                                                          Call SalSetFocus(dfDat1)
							                                                                                                                                                                                                                                                                                                                                          Return FALSE
						! Call SqlPrepareAndExecute(hSql(), "select count(*) into :nCountM from cc_many where  nd=:ND and fdat>:dfDat1")
						! Call SqlFetchNext(hSql(), nFetchRes)
						! If nCountM>0
							                                                                                                                                                                                                                                                                                                                                          Call SalMessageBox("Изменение невозможно! Потоки содержат записи с датой, большей указанной!", "О ш и б к а !", 0)
							                                                                                                                                                                                                                                                                                                                                          Set dfDat1 = dDat1
							                                                                                                                                                                                                                                                                                                                                          Call SalSetFocus(dfDat1)
							                                                                                                                                                                                                                                                                                                                                          Return FALSE
						Set dDat1 = dfDat1
						Set dDat2 = dfDat2
						Call SalEndDialog(hWndForm, TRUE)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   3.333"
					Top:    1.226"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.524"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, FALSE)
			Frame
				Resource Id: 11914
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.08"
					Top:    0.06"
					Width:  4.75"
					Width Editable? Yes
					Height: 1.0"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: окончания КД
				Resource Id: 49949
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.726"
					Width:  1.817"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 11915
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.095"
					Width:  4.75"
					Width Editable? Yes
					Height: 0.726"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
		Functions
		Window Parameters
			Number: ND
			Receive Date/Time: dDat1
			Receive Date/Time: dDat2
		Window Variables
			Number: nCountL
			Number: nCountM
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, 'Укажите дату пролонгации...')
				! Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetDat.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Set dfDat1 = dDat1
				Set dfDat2 = GetBankDate()
	Table Window: TN
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    0.688"
				Width:  14.0"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.357"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.4"
						Top:    -0.012"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20525
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.833"
						Top:    -0.012"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.267"
						Top:    -0.012"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20526
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.7"
						Top:    -0.012"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20527
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.05"
							Top:    0.06"
							Width:  4.35"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.267"
							Top:    0.06"
							Width:  2.783"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: nND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.267"
							Top:    0.06"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: FDAT ! дата на оси !! FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						долга
						1
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM  ! дата из ГПК !! OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По
						ГПК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST  ! Лимит       !! OST   
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит
						
						2
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F10  ! Остаток SS  !! F10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт
						SS-долг
						3
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F11  ! Остаток SP  !! F11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт
						SP-долг
						4
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DS   ! невыбр-проср!! -(OST-F10-F11)
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отклон.
						долга
						5=2-(3+4)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DSP  ! план-проср  ! DS - F11 > 0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						SP-долг
						6=5-4
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTMP ! дата из ГП% !! OTMP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По
						ГП%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OSTD ! % на лимит  !! OSTD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Прогноз
						 %лимит
						7= %(2)
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTI ! нарас итог  !! OSTI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Прогноз
						 %лимит
						7= %(2)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.883"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: F06  ! Нач %                 ! F06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Начис
						SN - %
						8= %(3+4)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.95"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F07  ! Погаш нач %           ! F07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погаш
						SN - %
						9
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F12  ! Остаток SN            !! F12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не погаш
						SN - %
						10
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.95"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F08  ! Перенесено на проср % ! F08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сформир
						SPN - %
						11
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.883"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F09  ! Погашено проср %      ! F09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погаш
						SPN - %
						12
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F13  ! не Погашено проср %   !! F13 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не погаш
						SPN - %
						13
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F14  ! План-проср %          !! F14
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						SPN- %
						14
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nS
			Number: nS4
			Number: nS14
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Set TN.strPrintFileName = 'СС_KALP'
				Set TN.nTabInstance = 1
				Set TN.dCC_ID='Графік погашення по угоді '|| TN.strPar01
				Set TN.dNMK  = TN.strPar02
				Set TN.nND=TN.nPar
				Call SalTblSetLockedColumns( hWndForm, 7 )
				Set bDat=GetBankDate()
				!
				Call SalSetWindowText(hWndForm, 'Просмотр ГЛК + ГПК + ГП% ' || strPar01 )
				Call ShowApdVersion('12')
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set nS = 0
				Set nS4 = 0
				Set nS14=0
				If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
					Set TN.strSqlPopulate =
							"SELECT   FDAT,     OTM,    OTMP, OST/100, F10/100, F11/100, (OST-F10-F11)/100,
							      OSTD/100,OSTI/100, F12/100, F13/100, F14/100,
							       F06/100, F07/100, F08/100, F09/100           
							 INTO :TN.FDAT,:TN.OTM ,:TN.OTMP, :TN.OST, :TN.F10,  :TN.F11, :TN.DS,
							      :TN.OSTD,:TN.OSTI,:TN.F12 , :TN.F13, :TN.F14,
							      :TN.F06 ,:TN.F07 ,:TN.F08 , :TN.F09       
							 FROM  cck_Int  ORDER BY fdat "
					If SqlPLSQLCommand(hSql(), "CCK.cc_INTN (TN.nND ) " )
						Call SqlCommit( hSql() )
						Call SalTblPopulate(hWndForm, hSql(), TN.strSqlPopulate, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					Else
						Call SqlRollback(hSql())
						Call SalWaitCursor(FALSE)
						Call MessageNoWait( 'Ошибка при выполнении процедуры !',"CCK.cc_INTN " , 30, 1 )
			On SAM_FetchRowDone
				If FDAT >=bDat and FDAT<=bDat +3
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )  ! голубой
				If DS < 0 
					! превішен лимит - розовій
					Call XSalTblSetCellBackColor( DS, SalColorFromRGB( 255,210,250 ) )
				! Else If DS > 0 
					! невібран лимит - желтій
					                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Call XSalTblSetCellBackColor( DS, SalColorFromRGB( 255,255,180) )
				If DS < 0 and DS + F11 < 0
					Set DSP = -(DS + F11 )
					Call XSalTblSetCellBackColor( DSP, SalColorFromRGB( 255,210,250 ) )
				! слобо-зеленые кол про лимиты 
				Call XSalTblSetCellBackColor( OST , SalColorFromRGB( 230,255,230 ))
				Call XSalTblSetCellBackColor( OSTD, SalColorFromRGB( 230,255,230 ))
				Call XSalTblSetCellBackColor( OSTI, SalColorFromRGB( 230,255,230 ))
				! Про долг и его проц - желтій
				Call XSalTblSetCellBackColor( F10 ,SalColorFromRGB( 255,255,180))
				Call XSalTblSetCellBackColor( F11, SalColorFromRGB( 255,255,180))
				Call XSalTblSetCellBackColor( F06, SalColorFromRGB( 255,255,180))
				Call XSalTblSetCellBackColor( F07, SalColorFromRGB( 255,255,180))
				Call XSalTblSetCellBackColor( F12, SalColorFromRGB( 255,255,180))
				! Про проср %
				Call XSalTblSetCellBackColor( F08, COLOR_LightGray)
				Call XSalTblSetCellBackColor( F09, COLOR_LightGray)
				Call XSalTblSetCellBackColor( F13, COLOR_LightGray)
				If F14 > 0 
					Call XSalTblSetCellBackColor( F14, SalColorFromRGB( 255,210,250 ) )
	Table Window: Tbl_Prol
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.488"
				Top:    0.417"
				Width:  13.783"
				Width Editable? Class Default
				Height: 5.845"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.631"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 255
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 256
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 257
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dTXT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.65"
							Top:    0.071"
							Width:  5.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dTXT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.65"
							Top:    0.333"
							Width:  5.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						изменений
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.3"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIDP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид 
						изменений
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новая
						 дата
						 погашения 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.217"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новая 
						%
						ставка 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новая 
						сумма 
						лимита 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Номер счета
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Валюты
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текст
				Visible? Yes
				Editable? No
				Maximum Data Length: 4000
				Data Type: Long String
				Justify: Left
				Width:  4.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              If NPP = NUMBER_Null or NPP = 0
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Set TXT = STRING_Null
			! Column: SS
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пролонгированная 
						сумма
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  2.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         List Values 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Message Actions 
		Functions
			Function: F_INS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
				Actions
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetContext(hWndForm, nRow)                               
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sTmp
			Long String: sAIM
			Boolean: bTmp
			Number: bFL_Edit
			!
			Date/Time: FDAT0
			Date/Time: MDATE0
			Number: RATE0
			Number: S0
			String: nls_s
			Number: kv_s
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, strPar01 ||' '|| strPar02 )
				Call ShowApdVersion('08')
				Set hWndForm.Tbl_Prol.dTXT1 = hWndForm.Tbl_Prol.strPar01 
				Set hWndForm.Tbl_Prol.dTXT2 = hWndForm.Tbl_Prol.strPar02
				Set hWndForm.Tbl_Prol.strPrintFileName = 'СС_PROL'
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Call SalDisableWindow( pbDetails )
				Call SalDisableWindow( pbIns )
				Call SalDisableWindow( pbDel )
				Call SalDisableWindow( pbUpdate )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblReset ( hWndForm )
				! Начальные значения - только одно - СЕРЫЙ
				Call hWndForm.Tbl_Prol.F_INS()
				If SqlPrepareAndExecute( hSql(),
						"select  p.fdat , p.mdate,  i.ir,   lim2/100, a2.nls, a2.kv  
						 INTO :hWndForm.Tbl_Prol.FDAT0, :hWndForm.Tbl_Prol.MDATE0, :hWndForm.Tbl_Prol.RATE0,
						      :hWndForm.Tbl_Prol.S0,    :hWndForm.Tbl_Prol.nls_s,  :hWndForm.Tbl_Prol.kv_s
						  from cc_prol p, int_ratn i, nd_acc n, accounts a, cc_lim l,accounts a2
						  where p.nd=:hWndForm.Tbl_Prol.nPar AND p.npp=0 and p.nd = l.nd and p.nd = n.nd and 
						        n.acc=a.acc and a.tip='LIM' and a.acc= i.acc and i.id=0 and 
						        l.fdat=p.fdat and p.acc=a2.acc (+)" ) 
						and SqlFetchNext( hSql(), nFetchRes )
					Set hWndForm.Tbl_Prol.NPP  = 0
					Set hWndForm.Tbl_Prol.FDAT = hWndForm.Tbl_Prol.FDAT0
					Set hWndForm.Tbl_Prol.VIDP = 'Начальные значения'
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.VIDP, COLOR_LightGray)
					Set hWndForm.Tbl_Prol.MDATE = hWndForm.Tbl_Prol.MDATE0
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.MDATE, COLOR_LightGray)
					Set hWndForm.Tbl_Prol.NLS = hWndForm.Tbl_Prol.nls_s
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.NLS, COLOR_LightGray)
					Set hWndForm.Tbl_Prol.KV = hWndForm.Tbl_Prol.kv_s
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.KV, COLOR_LightGray)
					Set hWndForm.Tbl_Prol.RATE = hWndForm.Tbl_Prol.RATE0
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.RATE, COLOR_LightGray)
					Set hWndForm.Tbl_Prol.S = hWndForm.Tbl_Prol.S0
					Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.S, COLOR_LightGray)
					! Пролонгация - м.б. много
					If SqlPrepareAndExecute( hSql(),
							  "SELECT p.npp, p.fdat, p.mdate, p.txt, a2.nls,  a2.kv
							   INTO :hWndForm.Tbl_Prol.S0, :hWndForm.Tbl_Prol.FDAT0, :hWndForm.Tbl_Prol.MDATE0,
							        :hWndForm.Tbl_Prol.sAIM,:hWndForm.Tbl_Prol.nls_s,:hWndForm.Tbl_Prol.kv_s 
							   FROM cc_prol p,accounts a2 WHERE p.nd=:hWndForm.Tbl_Prol.nPar AND p.npp>0 and 
							        a2.acc(+) = p.acc ")
						While SqlFetchNext( hSql(), nFetchRes)
							Call hWndForm.Tbl_Prol.F_INS()
							Set hWndForm.Tbl_Prol.FDAT = hWndForm.Tbl_Prol.FDAT0
							Set hWndForm.Tbl_Prol.NPP  = hWndForm.Tbl_Prol.S0
							Set hWndForm.Tbl_Prol.VIDP = 'Пролонгация'
							Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.VIDP, SalColorFromRGB( 230,255,230 ))
							Set hWndForm.Tbl_Prol.MDATE = hWndForm.Tbl_Prol.MDATE0
							Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.MDATE, SalColorFromRGB( 230,255,230 ))
							Set hWndForm.Tbl_Prol.NLS = hWndForm.Tbl_Prol.nls_s
							Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.NLS, SalColorFromRGB( 230,255,230 ))
							Set hWndForm.Tbl_Prol.KV = hWndForm.Tbl_Prol.kv_s
							Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.KV, SalColorFromRGB( 230,255,230 ))
							Set hWndForm.Tbl_Prol.TXT = hWndForm.Tbl_Prol.sAIM
							Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.TXT, SalColorFromRGB( 230,255,230 ))
					! Изменение ставки - м.б. много
					If SqlPrepareAndExecute( hSql(),
							  "SELECT i.ir, i.bdat, a.nls, a.kv,'(исп.'||i.idu||' '||s.FIO||')' 
							   INTO :hWndForm.Tbl_Prol.S0,  :hWndForm.Tbl_Prol.FDAT0, :hWndForm.Tbl_Prol.nls_s,
							        :hWndForm.Tbl_Prol.kv_s,:hWndForm.Tbl_Prol.sTmp  
							   FROM int_ratn i, nd_acc n, accounts a,staff s
							   WHERE n.nd=:hWndForm.Tbl_Prol.nPar AND n.acc=i.acc and i.id=0 and a.acc=n.acc 
							     and a.tip='SS ' and i.ir<>:RATE0 and i.idu=s.id (+)") 
						While SqlFetchNext( hSql(), nFetchRes)
							Call F_INS()
							Set FDAT = FDAT0
							Set VIDP = 'Изменение ставки'
							Call XSalTblSetCellBackColor( VIDP, SalColorFromRGB( 255,255,180) )
							Set RATE = S0
							Call XSalTblSetCellBackColor( RATE, SalColorFromRGB( 255,255,180) )
							Set NLS=nls_s
							Call XSalTblSetCellBackColor( NLS, SalColorFromRGB( 255,255,180) )
							Set KV=kv_s
							Call XSalTblSetCellBackColor( KV, SalColorFromRGB( 255,255,180) )
							Set TXT = sTmp
							Call XSalTblSetCellBackColor( TXT, SalColorFromRGB( 255,255,180) )
					! Изменение суммы - м.б. много
					If SqlPrepareAndExecute( hSql(), 
							  "SELECT l2.LIM2/100, l2.fdat 
							   INTO :hWndForm.Tbl_Prol.S0, :hWndForm.Tbl_Prol.FDAT0 
							   FROM cc_lim l1, cc_lim l2
							   WHERE l1.nd=:hWndForm.Tbl_Prol.nPar and l1.nd=l2.nd and l1.fdat<l2.fdat 
							     and l2.LIM2>l1.LIM2 and   (l2.nd,l2.fdat) =
							  (select nd, min(fdat) from cc_lim where nd=l1.nd and fdat>l1.fdat  group by nd) ") 
						While SqlFetchNext( hSql(), nFetchRes)
							Call hWndForm.Tbl_Prol.F_INS()
							Set hWndForm.Tbl_Prol.FDAT = hWndForm.Tbl_Prol.FDAT0
							Set hWndForm.Tbl_Prol.VIDP = 'Изменение суммы'
							Call XSalTblSetCellBackColor( hWndForm.Tbl_Prol.VIDP, COLOR_Sky )
							Set hWndForm.Tbl_Prol.S = hWndForm.Tbl_Prol.S0
							Call XSalTblSetCellBackColor( S, COLOR_Sky )
					Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hWndForm.Tbl_Prol.FDAT ), TBL_SortIncreasing )
					!
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
				!
			On UM_DoubleClick
				If hWndForm.Tbl_Prol.NPP != NUMBER_Null
					Set hWndForm.Tbl_Prol.sAIM = hWndForm.Tbl_Prol.TXT 
					Set hWndForm.Tbl_Prol.bTmp = FALSE
					!
					Set hWndForm.Tbl_Prol.bFL_Edit = TRUE
					Call Sel017t( hWndForm, 
							hWndForm.Tbl_Prol.strPar01 ||' '|| hWndForm.Tbl_Prol.strPar02,
							hWndForm.Tbl_Prol.bTmp, 
							hWndForm.Tbl_Prol.sAIM, 
							hWndForm.Tbl_Prol.bFL_Edit)
					If hWndForm.Tbl_Prol.bTmp AND hWndForm.Tbl_Prol.bFL_Edit
						Set hWndForm.Tbl_Prol.TXT = hWndForm.Tbl_Prol.sAIM
						!
						If SqlPrepareAndExecute( hSql(), 
								 "UPDATE cc_prol Set TXT=:hWndForm.Tbl_Prol.TXT 
								  WHERE npp=:hWndForm.Tbl_Prol.NPP AND nd=:hWndForm.Tbl_Prol.nPar " ) 
								and SqlCommit( hSql() )
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						Else
							Call SqlRollback(hSql())
					Call SalWaitCursor(FALSE)
	Table Window: CCI
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Информация о страховке по КД
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.525"
				Top:    0.875"
				Width:  17.267"
				Width Editable? Class Default
				Height: 4.107"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.821"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: dRNK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.683"
							Top:    0.321"
							Width:  1.367"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Рег.№ Заемщ." )
						On SAM_SetFocus
							Set nEdit = dRNK
						On SAM_AnyEdit
							Set dRNK = nEdit
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.321"
							Width:  7.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Наименование заемщика" )
						On SAM_SetFocus
							Set sEdit = dNMK
						On SAM_AnyEdit
							Set dNMK = sEdit
				Data Field: dRNKI
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.683"
							Top:    0.071"
							Width:  1.367"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Рег.№ СК" )
						On SAM_SetFocus
							Set nEdit = dRNKI
						On SAM_AnyEdit
							Set dRNKI = nEdit
				Data Field: dNMKI
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.071"
							Width:  7.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Наименование СК" )
						On SAM_SetFocus
							Set sEdit = dNMKI
						On SAM_AnyEdit
							Set dNMKI = sEdit
				!
				Data Field: dDOGS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.683"
							Top:    0.571"
							Width:  1.367"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "№ (Ид.)СД" )
				Data Field: dDATS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.571"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Дата начала действия СД" )
				Data Field: dDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.783"
							Top:    0.571"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Дата окончания действия СД" )
				Data Field: dNAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.483"
							Top:    0.571"
							Width:  3.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, "Наименование вида страховки" )
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 4230
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 4231
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 4232
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег №
						Заемщ.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заемщик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № (Ид.)
						КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp =Str(hWndForm.CCI.ND)
						Call FunNSIGetFiltered
								('CC_DEAL','CC_ID', " CC_DEAL.rnk="||Str(hWndForm.CCI.dRNK),sTmp, sTmp1 )
						If sTmp != STRING_Null
							Set hWndForm.CCI.ND=Val(sTmp)
							Set hWndForm.CCI.CC_ID=sTmp1
			Column: NLSZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Договор
						залога
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp =Str(hWndForm.CCI.ACCZ)
						Call FunNSIGetFiltered
								('ACCOUNTS','NLS', 
								" ACC in (select z.acc from cc_accp z, nd_acc n where z.accs=n.acc and n.nd="||Str(hWndForm.CCI.ND)||")",
								sTmp, sTmp1 )
						If sTmp != STRING_Null
							Set hWndForm.CCI.ACCZ=Val(sTmp)
							Set hWndForm.CCI.NLSZ=sTmp1
			Column: RNKI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег №
						СК
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: INSU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование 
						СК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp=Str(hWndForm.CCI.RNKI)
						Call FunNSIGetFiltered
								('INSU_CORPS','NMK', " DAT4 > gl.BD ",sTmp, hWndForm.CCI.INSU )
						Set hWndForm.CCI.RNKI=Val(sTmp)
						If CCK_MIGR > GetBankDate()
							Call SalTblSetRowFlags(CCI, SalTblQueryContext (CCI ), ROW_Edited, TRUE )
			Column: VID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Вида
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						вида страховки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp=Str(hWndForm.CCI.VID)
						! Call FunNSIGet('INSU_VID','NAME',sTmp, hWndForm.CCI.NAME )
						Call FunNSIGetFiltered
								('INSU_VID','NAME', 
								" nvl(ZAL,0)" || IifS(hWndForm.CCI.ACCZ=NUMBER_Null,"<>","=")||"1",
								sTmp, hWndForm.CCI.NAME )
						Set hWndForm.CCI.VID=Val(sTmp)
						If CCK_MIGR > GetBankDate()
							Call SalTblSetRowFlags(CCI, SalTblQueryContext (CCI ), ROW_Edited, TRUE )
			Column: DOGS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № (Ид.)
						СД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата нач. 
						СД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Set hWndForm.CCI.DAT = CorrectDate(hWndForm.CCI.n980, hWndForm.CCI.DAT, hWndForm.CCI.DAT +1)
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата дейст
						СД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.15"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.CCI.DAT = CorrectDate(hWndForm.CCI.n980, hWndForm.CCI.DAT, hWndForm.CCI.DAT +1)
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Страховая 
						сумма
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Сумма 
						ОПЛ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						Дата 
						ОПЛ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Set hWndForm.CCI.DAT = CorrectDate(hWndForm.CCI.n980, hWndForm.CCI.DAT, hWndForm.CCI.DAT +1)
			Column: SF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-
						Сумма
						ОПЛ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACCZ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол
						дней 
						ОПЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: ZAL
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обесп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            List Values 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Message Actions 
		Functions
		Window Parameters
			Number: nTip_Ur
			Number: nRNK
			String: strFiltr
			String: strPar02
		Window Variables
			Date/Time: bDat
			Date/Time: Dat30
			Number: nUserId
			Number: nEdit
			String: sEdit
			Number: nRed
			Number: nRed1
			Number: nGre
			Number: n980
			Number: nRow
			Number: nTmp
			String: sTmp
			String: sTmp1
			Boolean: bTmp
			String: sIns_RNK
			String: sIns_ACC
			String: sUpd_RNK
			String: sUpd_ACC
			String: sDel_RNK
			String: sDel_ACC
			String: sSql 
			String: sFilter
			String: sProbl
			Date/Time: CCK_MIGR
		Message Actions
			On SAM_Create
				Set hWndForm.CCI.bDat = GetBankDate()
				Set Dat30 = bDat + 30
				Set hWndForm.CCI.nUserId = GetUserId()
				Set hWndForm.CCI.n980 = GetBaseVal()
				Set hWndForm.CCI.nTabInstance = 1
				Call SetWindowFullSize(hWndForm)
				Call PrepareWindowEx(hWndForm)
				Set hWndForm.CCI.strPrintFileName = 'CCI'
				Call SalTblSetLockedColumns( hWndForm, 13 )
				Set nRed = SalColorFromRGB( 255,210,210 )
				Set nGre = COLOR_LightGreen 
				Set nRed1 = COLOR_Salmon
				Set CCK_MIGR = SalStrToDate(GetGlobalOption('CCK_MIGR'))
				Call SalHideWindow( hWndForm.CCI.RNKI )
				If nRNK > 0 ! ВВод СД по одному клиенту 
					Set hWndForm.CCI.dRNK = nRNK
					Set hWndForm.CCI.dNMK = strPar02
					Call SalSetWindowText( hWndForm, "Информация о СД по клиенту "|| Str(nRNK)||' '||strPar02 )
					Call ShowApdVersion('13')
					Set sIns_RNK = 
							"INSERT INTO insu_RNK (rnk,rnki,vid,DAT,S,SP, DATS,DOGS,DATP,SF ) 
							 VALUES (:hWndForm.CCI.dRNK, :hWndForm.CCI.RNKI,:hWndForm.CCI.VID,
							         :hWndForm.CCI.DAT,:hWndForm.CCI.S,:hWndForm.CCI.SP,
							         :hWndForm.CCI.DATS,:hWndForm.CCI.DOGS,:hWndForm.CCI.DATP,:hWndForm.CCI.SF )" 
					Set sIns_ACC = 
							"INSERT INTO insu_ACC (acc,rnki,vid,DAT,S,SP, DATS,DOGS,DATP,SF ) 
							 VALUES (:hWndForm.CCI.ACCZ,:hWndForm.CCI.RNKI,:hWndForm.CCI.VID,
							         :hWndForm.CCI.DAT,:hWndForm.CCI.S,:hWndForm.CCI.SP,
							         :hWndForm.CCI.DATS,:hWndForm.CCI.DOGS,:hWndForm.CCI.DATP,:hWndForm.CCI.SF )" 
					Set sUpd_RNK = 
							"UPDATE insu_RNK
							 Set DAT =:hWndForm.CCI.DAT,     S=:hWndForm.CCI.S , SP=:hWndForm.CCI.SP ,
							     DATS=:hWndForm.CCI.DATS, DOGS=:hWndForm.CCI.DOGS,
							     DATP=:hWndForm.CCI.DATP,   SF=:hWndForm.CCI.SF     
							 WHERE rnk=:hWndForm.CCI.dRNK and rnki=:hWndForm.CCI.RNKI and vid=:hWndForm.CCI.VID " 
					If CCK_MIGR > GetBankDate()
						Set sUpd_ACC = 
								"UPDATE insu_ACC
								 Set DAT =:hWndForm.CCI.DAT,     S=:hWndForm.CCI.S , SP=:hWndForm.CCI.SP ,
								     DATS=:hWndForm.CCI.DATS, DOGS=:hWndForm.CCI.DOGS,
								     DATP=:hWndForm.CCI.DATP,   SF=:hWndForm.CCI.SF,     
								      RNKI=:hWndForm.CCI.RNKI , VID=:hWndForm.CCI.VID  
								 WHERE acc=:hWndForm.CCI.ACCZ " 
					Else
						Set sUpd_ACC = 
								"UPDATE insu_ACC
								 Set DAT =:hWndForm.CCI.DAT,     S=:hWndForm.CCI.S , SP=:hWndForm.CCI.SP ,
								     DATS=:hWndForm.CCI.DATS, DOGS=:hWndForm.CCI.DOGS,
								     DATP=:hWndForm.CCI.DATP,   SF=:hWndForm.CCI.SF       
								 WHERE acc=:hWndForm.CCI.ACCZ and rnki=:hWndForm.CCI.RNKI and vid=:hWndForm.CCI.VID " 
					Set sDel_RNK = 
							"DELETE FROM insu_RNK 
							 WHERE rnk=:hWndForm.CCI.dRNK and rnki=:hWndForm.CCI.RNKI and vid=:hWndForm.CCI.VID "
					Set sDel_ACC = 
							"DELETE FROM insu_ACC
							 WHERE acc=:hWndForm.CCI.ACCZ and rnki=:hWndForm.CCI.RNKI and vid=:hWndForm.CCI.VID "
				Else If nRNK < 0 !  Просмотр СД по одной СК
					Set hWndForm.CCI.strFilterTblName = 'CCI1'
					Set hWndForm.CCI.dRNKI = -nRNK
					Set hWndForm.CCI.dNMKI = strPar02
					Call SalSetWindowText( hWndForm, "Информация о СД по СК "|| Str(-nRNK)||' '||strPar02 )
				Else If nRNK = 0 ! Информация о ПРОБЛЕМНЫХ СД по ВСЕМ СК
					Call SalSetWindowText( hWndForm, strPar02  )
					Set sProbl = 
							'( i.DATP is null 
							OR i.DAT  is null 
							OR i.S is null
							OR i.SP is null 
							OR i.SF is null 
							OR i.SF<i.SP AND i.DATP < :hWndForm.CCI.Dat30 
							OR i.DATP >i.DAT )' 
					Set hWndForm.CCI.strFilterTblName = 'CCI2'
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalHideWindow( VID )
				Call SalHideWindow( ACCZ )
				Set sFilter = ""
				If nRNK > 0 ! ВВод СД по одному клиенту
					Call SalHideWindow( hWndForm.CCI.NMK )
					Call SalHideWindow( hWndForm.CCI.RNK )
					Call SalHideWindow( hWndForm.CCI.pbFilter )
					Set hWndForm.CCI.strSqlPopulate = 
							"SELECT d.nd, d.cc_id, to_number(null) ACCZ, to_char(null) NLSZ,
							        i.RNKi, c.nmk, i.vid, v.name, i.dat, i.s,i.sp, i.DATS, i.DOGS, i.SF, i.DATP       
							 INTO :hWndForm.CCI.ND,   :hWndForm.CCI.CC_ID,:hWndForm.CCI.ACCZ,:hWndForm.CCI.NLSZ,
							      :hWndForm.CCI.RNKI, :hWndForm.CCI.INSU, :hWndForm.CCI.VID, 
							      :hWndForm.CCI.NAME, :hWndForm.CCI.DAT,  :hWndForm.CCI.S, :hWndForm.CCI.SP,
							      :hWndForm.CCI.DATS, :hWndForm.CCI.DOGS, :hWndForm.CCI.SF,:hWndForm.CCI.DATP
							 from insu_RNK i, customer c, INSU_Vid v,  cc_deal d
							 where d.rnk=:hWndForm.CCI.dRNK and i.rnkI=c.rnk and i.vid=v.insu 
							   and d.rnk=i.rnk and d.sos<15 
							 UNION ALL 
							 select d.nd, d.cc_id, i.acc, a.nls,
							        i.RNKi, c.nmk, i.vid, v.name, i.dat, i.s, i.sp, i.DATS, i.DOGS, i.SF, i.DATP   
							 from insu_acc i, customer c, INSU_Vid v,  accounts a,
							  (select distinct e.nd, e.cc_id, z.acc from cc_accp z, nd_acc n, cc_deal e 
							   where e.rnk=:hWndForm.CCI.dRNK and e.nd=n.nd and n.acc=z.accs and e.sos<15 ) d
							 where i.rnkI=c.rnk and i.vid=v.insu  and i.acc = d.acc and i.acc=a.acc 
							 order by 1"
				Else
					Call SalHideWindow( hWndForm.CCI.DOGS )
					Call SalHideWindow( hWndForm.CCI.DATS )
					Call SalHideWindow( hWndForm.CCI.DAT )
					Call SalHideWindow( hWndForm.CCI.NAME )
					!
					Set sFilter = cF.GetFilterWhereClause(FALSE)
					Set sFilter = IifS(sFilter="", ""," and "|| sFilter )
					If nRNK < 0 !  Просмотр СД по одной СК
						Call SalHideWindow( hWndForm.CCI.RNKI )
						Call SalHideWindow( hWndForm.CCI.INSU )
						Call SalHideWindow( hWndForm.CCI.pbIns )
						Call SalHideWindow( hWndForm.CCI.pbDel )
						Call SalHideWindow( hWndForm.CCI.pbUpdate )
						Set hWndForm.CCI.strSqlPopulate = 
								"SELECT CCI1.ND,CCI1.CC_ID,CCI1.ACCZ, CCI1.NLSZ, CCI1.RNK, CCI1.NMK, CCI1.VID, 
								        v.NAME, CCI1.DAT,  CCI1.S,    CCI1.SP,   CCI1.DATS,CCI1.DOGS,CCI1.SF , CCI1.DATP
								 INTO :hWndForm.CCI.ND,  :hWndForm.CCI.CC_ID,:hWndForm.CCI.ACCZ,:hWndForm.CCI.NLSZ,
								      :hWndForm.CCI.RNK, :hWndForm.CCI.NMK, :hWndForm.CCI.VID, 
								      :hWndForm.CCI.NAME,:hWndForm.CCI.DAT, :hWndForm.CCI.S, :hWndForm.CCI.SP,
								      :hWndForm.CCI.DATS,:hWndForm.CCI.DOGS,:hWndForm.CCI.SF,:hWndForm.CCI.DATP   
								 FROM (select d.nd, d.cc_id, to_number(null) ACCZ, to_char(null) NLSZ,
								              c.RNK, c.nmk, i.vid, i.dat, i.s, i.sp, i.DATS, i.DOGS, i.SF, i.DATP  
								       from insu_RNK i, customer c, cc_deal d
								       where i.rnki=:hWndForm.CCI.dRNKI and d.rnk=c.rnk and d.sos<15 and i.rnk=d.rnk 
								       UNION ALL 
								       select d.nd,d.cc_id,i.acc,a.nls,
								              c.RNK, c.nmk, i.vid, i.dat, i.s, i.sp, i.DATS, i.DOGS, i.SF, i.DATP     
								       from insu_acc i, customer c, accounts a,
								           (select distinct e.nd,e.cc_id,z.acc,e.RNK 
								            from cc_accp z, nd_acc n, cc_deal e 
								            where e.nd=n.nd and n.acc=z.accs and e.sos<15 ) d
								       where i.rnkI=:hWndForm.CCI.dRNKI and i.acc=d.acc and i.acc=a.acc and d.rnk=c.rnk
								      ) CCI1 , INSU_Vid v
								  WHERE CCI1.vid=v.insu " || sFilter || "
								  ORDER BY CCI1.ND"
					Else If nRNK = 0 ! Информация о ПРОБЛЕМНЫХ ДС по ВСЕМ СК
						! Call SalHideWindow( hWndForm.CCI.dRNK )
						Call SalHideWindow( hWndForm.CCI.pbIns )
						Call SalHideWindow( hWndForm.CCI.pbDel )
						Call SalHideWindow( hWndForm.CCI.pbUpdate )
						! strFiltr CC_V
						Set hWndForm.CCI.strSqlPopulate = 
								"SELECT CCI2.ND,CCI2.CC_ID,CCI2.ACCZ,CCI2.NLSZ,CCI2.RNK, CCI2.NMK, CCI2.VID,
								        v.name, CCI2.DAT,  CCI2.S,   CCI2.SP,  CCI2.DATS,CCI2.DOGS,CCI2.SF,CCI2.DATP,
								        CCI2.RNKI, CCI2.NMKI, CCI2.DNI
								 INTO :hWndForm.CCI.ND,   :hWndForm.CCI.CC_ID,:hWndForm.CCI.ACCZ,:hWndForm.CCI.NLSZ,
								      :hWndForm.CCI.RNK,  :hWndForm.CCI.NMK,  :hWndForm.CCI.VID, 
								      :hWndForm.CCI.NAME, :hWndForm.CCI.DAT,  :hWndForm.CCI.S,   :hWndForm.CCI.SP,
								      :hWndForm.CCI.DATS, :hWndForm.CCI.DOGS, :hWndForm.CCI.SF,  :hWndForm.CCI.DATP,
								      :hWndForm.CCI.RNKI, :hWndForm.CCI.INSU, :hWndForm.CCI.DNI
								 FROM (SELECT CC_V.nd, CC_V.cc_id, to_number(null) ACCZ, to_char(null) NLSZ,
								              c.RNK,c.nmk,i.vid,i.dat,i.s,i.sp,i.DATS,i.DOGS,
								              i.SF,i.DATP,i.rnki,ci.nmk NMKI, (i.DATP-gl.BD) DNI
								       from insu_RNK i, customer c, cc_deal CC_V, customer ci
								       where i.rnki=ci.rnk and CC_V.rnk=c.rnk and CC_V.sos<15 and i.rnk=c.rnk and 
								" || sProbl || strFiltr || "             
								       UNION ALL 
								       select d.nd,d.cc_id,i.acc,a.nls,c.RNK,c.nmk,i.vid,i.dat,i.s,i.sp,i.DATS,i.DOGS,
								              i.SF,i.DATP,i.rnki,ci.nmk, (i.DATP-gl.BD)        
								       from insu_acc i, customer c,  accounts a, customer ci,
								           (select distinct CC_V.nd,CC_V.cc_id,z.acc,CC_V.RNK from cc_accp z,nd_acc n,cc_deal CC_V 
								            where CC_V.nd=n.nd and n.acc=z.accs and CC_V.sos<15 "|| strFiltr || " ) d
								       where i.rnkI=ci.rnk and i.acc = d.acc and i.acc=a.acc and d.rnk=c.rnk and 
								" || sProbl ||"            
								      ) CCI2, INSU_Vid v
								 WHERE CCI2.vid=v.insu " || sFilter || " 
								 ORDER BY CCI2.ND "  
						! Set hWndForm.CCI.strSqlPopulate = 
								"SELECT CCI2.ND,CCI2.CC_ID,CCI2.ACCZ,CCI2.NLSZ,CCI2.RNK, CCI2.NMK, CCI2.VID,
								        v.name, CCI2.DAT,  CCI2.S,   CCI2.SP,  CCI2.DATS,CCI2.DOGS,CCI2.SF,CCI2.DATP,
								        CCI2.RNKI, CCI2.NMKI, CCI2.DNI
								 INTO :hWndForm.CCI.ND,   :hWndForm.CCI.CC_ID,:hWndForm.CCI.ACCZ,:hWndForm.CCI.NLSZ,
								      :hWndForm.CCI.RNK,  :hWndForm.CCI.NMK,  :hWndForm.CCI.VID, 
								      :hWndForm.CCI.NAME, :hWndForm.CCI.DAT,  :hWndForm.CCI.S,   :hWndForm.CCI.SP,
								      :hWndForm.CCI.DATS, :hWndForm.CCI.DOGS, :hWndForm.CCI.SF,  :hWndForm.CCI.DATP,
								      :hWndForm.CCI.RNKI, :hWndForm.CCI.INSU, :hWndForm.CCI.DNI
								 FROM (SELECT d.nd, d.cc_id, to_number(null) ACCZ, to_char(null) NLSZ,
								              c.RNK,c.nmk,i.vid,i.dat,i.s,i.sp,i.DATS,i.DOGS,
								              i.SF,i.DATP,i.rnki,ci.nmk NMKI, (i.DATP-gl.BD) DNI
								       from insu_RNK i, customer c, cc_deal d, customer ci
								       where i.rnki=ci.rnk and d.rnk=c.rnk and d.sos<15 and i.rnk=d.rnk and "|| sProbl ||"             
								       UNION ALL 
								       select d.nd,d.cc_id,i.acc,a.nls,c.RNK,c.nmk,i.vid,i.dat,i.s,i.sp,i.DATS,i.DOGS,
								              i.SF,i.DATP,i.rnki,ci.nmk, (i.DATP-gl.BD)        
								       from insu_acc i, customer c,  accounts a, customer ci,
								           (select distinct e.nd,e.cc_id,z.acc,e.RNK from cc_accp z,nd_acc n,cc_deal e 
								            where e.nd=n.nd and n.acc=z.accs and e.sos<15 ) d
								       where i.rnkI=ci.rnk and i.acc = d.acc and i.acc=a.acc and d.rnk=c.rnk and "|| sProbl ||"            
								      ) CCI2, INSU_Vid v
								 WHERE CCI2.vid=v.insu " || sFilter || " 
								 ORDER BY CCI2.ND "  
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.CCI.strSqlPopulate, TBL_FillAll)
				Call SalTblSetLockedColumns( hWndForm , 13 )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				!
				!
				If hWndForm.CCI.nRNK > 0
					Set hWndForm.CCI.RNK = hWndForm.CCI.dRNK 
					Set hWndForm.CCI.NMK = hWndForm.CCI.dNMK
				Else If hWndForm.CCI.nRNK < 0
					Set hWndForm.CCI.RNKI = hWndForm.CCI.dRNKI 
					Set hWndForm.CCI.INSU = hWndForm.CCI.dNMKI
				!
				If hWndForm.CCI.ACCZ != NUMBER_Null
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray  )
				Call XSalTblSetCellBackColor( hWndForm.CCI.SP, nGre )
				Call XSalTblSetCellBackColor( hWndForm.CCI.SF, nGre )
				Call XSalTblSetCellBackColor( hWndForm.CCI.DATP, nGre )
				!
				If hWndForm.CCI.S  = NUMBER_Null
					Call XSalTblSetCellBackColor( hWndForm.CCI.S, nRed )
				If hWndForm.CCI.DAT = DATETIME_Null
					Call XSalTblSetCellBackColor( hWndForm.CCI.DAT, nRed )
				Else If hWndForm.CCI.DATP != DATETIME_Null and hWndForm.CCI.DATP > hWndForm.CCI.DAT 
					Call XSalTblSetCellBackColor( hWndForm.CCI.DAT, nRed )
					Call XSalTblSetCellBackColor( hWndForm.CCI.DATP, nRed )
				!
				If hWndForm.CCI.SP = NUMBER_Null  
						OR hWndForm.CCI.SF = NUMBER_Null 
						OR hWndForm.CCI.DATP = DATETIME_Null 
					If hWndForm.CCI.SP = NUMBER_Null 
						Call XSalTblSetCellBackColor( hWndForm.CCI.SP, nRed )
					If hWndForm.CCI.SF = NUMBER_Null 
						Call XSalTblSetCellBackColor( hWndForm.CCI.SF, nRed )
					If hWndForm.CCI.DATP = DATETIME_Null
						Call XSalTblSetCellBackColor( hWndForm.CCI.DATP, nRed )
				Else
					If hWndForm.CCI.SF < hWndForm.CCI.SP
						Set hWndForm.CCI.DNI = hWndForm.CCI.DATP - bDat
						If hWndForm.CCI.DATP < bDat
							Call XSalTblSetCellBackColor( hWndForm.CCI.SF, nRed1 )
							Call XSalTblSetCellBackColor( hWndForm.CCI.DATP, nRed1 )
							Call XSalTblSetCellBackColor( hWndForm.CCI.DNI, nRed1 )
						Else If hWndForm.CCI.DATP < Dat30
							Call XSalTblSetCellBackColor( hWndForm.CCI.SF, nRed )
							Call XSalTblSetCellBackColor( hWndForm.CCI.DATP, nRed )
							Call XSalTblSetCellBackColor( hWndForm.CCI.DNI, nRed )
			On SAM_TblDoDetails
				If nRNK >= 0
					Set dRNKI = hWndForm.CCI.RNKI
					Set dNMKI = hWndForm.CCI.INSU
				If nRNK <= 0
					Set dRNK = hWndForm.CCI.RNK
					Set dNMK = hWndForm.CCI.NMK
				Set dDOGS = hWndForm.CCI.DOGS
				Set dDATS = hWndForm.CCI.DATS
				Set dDAT  = hWndForm.CCI.DAT
				Set dNAME = hWndForm.CCI.NAME
			On UM_Update
				Call SalWaitCursor(TRUE)
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_Edited | ROW_MarkDeleted, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
						Set sSql = IifS(hWndForm.CCI.ACCZ=NUMBER_Null,sIns_RNK,sIns_ACC)
					Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited )
						Set sSql = IifS(hWndForm.CCI.ACCZ=NUMBER_Null,sUpd_RNK,sUpd_ACC)
					Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted )
						Set sSql = IifS(hWndForm.CCI.ACCZ=NUMBER_Null,sDel_RNK,sDel_ACC)
					If SqlPrepareAndExecute( hSql(), sSql ) and SqlCommit(hSql())
				Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			! On SAM_DoubleClick
	! cGenericTable: Tbl_DPK
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.825"
				Top:    1.031"
				Width:  18.457"
				Width Editable? Yes
				Height: 7.262"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                                        Description: Доср.пог. Показать стоп-дату
		                                        Named Menus 
		                                        Menu 
		                                        Tool Bar 
			                                        Contents 
				! Инфо-блок <Задолженности>
				                                        Group Box: Z:Заборгованість
				                                        Data Field: Z1
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Z1. Терміново ! 
									SLN+SLK+SL+SPN+SK9+SP+SN8' )
				!
				                                        Background Text: Z2. Поточні %% + коміс.SN+SN`+SK0
				                                        Data Field: Z2
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Z2. Поточні %% + коміс. 
									SN+SN`+SK0' )
				!
				                                        Background Text: Z3. Черговий платіж <тіло кредиту> SS`
				                                        Data Field: Z3
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Z3. Черговий платіж <тіло кредиту> 
									SS ' )
				!
				                                        Background Text: Z4. Разом обов`язкового платежу = Z1 + Z2 + Z3
				                                        Data Field: Z4
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Z4. Разом обов`язкового платежу 
									 Z1 + Z2 + Z3' )
				!
				                                        Background Text: Z5. План-залишок по тілу =  SS - Z3 
				                                        Data Field: Z5
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Z5. План-залишок по тілу 
									 SS - Z3 ' )
				! Инфо-Брок <Рессурс>
				                                        Group Box: R:Ресурс
				                                        Background Text: R1. Загальний ресурс SG / 262* 
				                                        Data Field: R1
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'R1. Загальний ресурс 
									SG / 262*' )
				                                        Data Field: NLS_2620
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Рахунок 
									SG / 262*' )
				                                        Data Field: KV_2620
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Код вал рахунку  
									SG / 262*' )
				!
				                                        Background Text: R2. Вільний ресурс SG / 262* = R1 - Z4
				                                        Data Field: R2
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'R2. Вільний ресурс 
									SG / 262*' )
				! Блок сбора инф.
				                                        Frame 
				                                        Check Box: K0
					                                        Message Actions 
				                                        Check Box: K01
					                                        Message Actions 
				                                        Background Text: K1. Сума для дострокового погашення
				                                        Data Field: K1
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'K1. Сума для дострокового погашення' )
				!
				                                        Data Field: K2_OLD
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'K2. Платіжний день(попередній)' )
				                                        Background Text: K2. Платіжний день
				                                        Data Field: K2
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'K2. Платіжний день' )
				! Check Box: K3
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: K3. Зі збереженняс суми 1-го платежу
					Window Location and Size
						Left:   7.183"
						Top:    1.738"
						Width:  4.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
.end
					                                                                                                                                                                               Message Actions 
				!
				                                        Pushbutton: pbUpdate
					                                        Message Actions 
						                                        On SAM_Create
							                                        Set strTip = strPar02
						                                        On SAM_Click
							                                        If SalMessageBox('Ви дійсно бажаєте виконати 
									'|| strTip || ' ? ', 
									'У В А Г А !  Рах.' || Str(KV_2620) ||'/' || NLS_2620 ,
									MB_IconQuestion | MB_YesNo) = IDYES
								                                        Call SetInfo(nPar)
								                                        Call Part1 ()
				                                        Pushbutton: pb_GPK_New
					                                        Message Actions 
						                                        On SAM_Create
							                                        Set strTip = 'Діюча версія ГПК'
						                                        On SAM_Click
							                                        Call FunNSIEditFFiltered("CC_W_LIM",1,"CC_W_LIM.ND =" || Str(nPar))
				                                        Pushbutton: pb_GPK_Old
					                                        Message Actions 
						                                        On SAM_Create
							                                        Set strTip = 'Попередня версія ГПК'
						                                        On SAM_Click
							                                        Call FunNSIEditFFiltered("CC_W_LIM_ARC",1,"CC_W_LIM_ARC.ND =" || Str(nPar))
				                                        Pushbutton: pbDel
					                                        Message Actions 
						                                        On SAM_Create
							                                        Set strTip = 'Повернути із архіву Попередню версія ГПК'
						                                        On SAM_Click
							                                        If SalMessageBox('Ви дійсно бажаєте 
									'|| strTip || ' ? ', 
									'У В А Г А ! ',
									MB_IconQuestion | MB_YesNo) = IDYES
								                                        Call RetGpk ( nPar, REF)
								                                        Call Part1 ()
				                                        Data Field: REF
					                                        Message Actions 
						                                        On VTM_LeftDoubleClick
							                                        If REF > 0
								                                        Call DocViewContentsEx(hWndForm, REF )
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Референс сформованого документу ' )
						                                        On SAM_SetFocus
							                                        Set nTmpE = REF
						                                        On SAM_AnyEdit
							                                        Set REF = nTmpE
				!
				                                        Pushbutton: pbDetails
					                                        Message Actions 
				                                        Pushbutton: pbSearch
					                                        Message Actions 
				                                        Pushbutton: pbIns
					                                        Message Actions 
				                                        Pushbutton: pbRefresh
					                                        Message Actions 
						                                        On SAM_Create
							                                        Set strTip = 'Поновити дані на екрані'
						                                        On SAM_Click
							                                        Call Part1 ()
				                                        Line 
				                                        Pushbutton: pbFilter
					                                        Message Actions 
				                                        Pushbutton: pbPrint
					                                        Message Actions 
				                                        Line 
				                                        Pushbutton: pbExit
					                                        Message Actions 
				                                        Line 
				                                        Radio Button: K3_0
					                                        Message Actions 
				                                        Radio Button: K3_1
					                                        Message Actions 
				                                        Group Box: К3. Зі збереженням
				                                        Data Field: ND
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Референс КД' )
						                                        On SAM_SetFocus
							                                        Set nTmpE = ND
						                                        On SAM_AnyEdit
							                                        Set ND = nTmpE
				                                        Data Field: SUM1
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Сума 1 платежу' )
				                                        Data Field: WDATE
					                                        Message Actions 
						                                        On SAM_TooltipSetText
							                                        Return XSalTooltipSetText( lParam, 'Кiнцевий Термiн' )
				                                        Background Text: Iд.КД
				                                        Data Field: CC_ID
					                                        Message Actions 
				                                        Background Text: Бранч
				                                        Data Field: BRANCH
					                                        Message Actions 
				                                        Background Text: Позичальник
				                                        Data Field: NMK
					                                        Message Actions 
				                                        Data Field: sErr
					                                        Message Actions 
				                                        Background Text: Місяців
				                                        Data Field: MES
					                                        Message Actions 
				                                        Background Text: Поч.дата
				                                        Data Field: DAT1
					                                        Message Actions 
				                                        Background Text: Попередня пл. дата
				                                        Data Field: DAT_PREV
					                                        Message Actions 
				                                        Background Text: Поперед.дата модиф ГПК
				                                        Data Field: DAT_MOD
					                                        Message Actions 
				                                        Background Text: Поточна банк.дата
				                                        Data Field: DAT_CURR
					                                        Message Actions 
				                                        Background Text: Наступна пл. дата
				                                        Data Field: DAT_NEXT
					                                        Message Actions 
				                                        Background Text: Кін.дата
				                                        Data Field: DAT4
					                                        Message Actions 
				                                        Pushbutton: pb_SP
					                                        Message Actions 
						                                        On SAM_Click
							                                        If Z1 > 0
								                                        Set sTmp = 'КД='|| Str( nPar) || ': Погашення простроч.боргу Z1=' || SalNumberToStrX( Z1, 2 )|| ' з рах.'|| NLS_2620 
								                                        If SalMessageBox( sTmp || ' ? ', 'У В А Г А ! ', MB_IconQuestion | MB_YesNo) = IDYES
									                                        Call F_SP (sTmp )
									                                        Call Part1 ()
		                                        Contents 
			                                        Column: TIP
				                                        List Values 
				                                        Message Actions 
			                                        Column: NBS
				                                        List Values 
				                                        Message Actions 
			                                        Column: KV
				                                        List Values 
				                                        Message Actions 
			                                        Column: NLS
				                                        List Values 
				                                        Message Actions 
			                                        Column: NMS
				                                        List Values 
				                                        Message Actions 
			                                        Column: OSTB
				                                        List Values 
				                                        Message Actions 
			                                        Column: OSTC
				                                        List Values 
				                                        Message Actions 
			                                        Column: US1
				                                        List Values 
				                                        Message Actions 
					                                        On SAM_AnyEdit
						                                        If US1 = 1 and ( NBS = '2620' OR NBS = '2625' OR TIP = 'SG ') 
							                                        Set NLS_2620 = NLS 
							                                        Set KV_2620 = KV
							                                        Set ACC_2620 = ACC
							                                        Call Part2 ( )
						                                        Else 
							                                        Set US1 = 0
			                                        Column: IR
				                                        List Values 
				                                        Message Actions 
			                                        Column: ACR_DAT
				                                        List Values 
				                                        Message Actions 
			                                        Column: ACC
				                                        List Values 
				                                        Message Actions 
			                                        Column: STP_DAT
				                                        List Values 
				                                        Message Actions 
		                                        Functions 
			                                        Function: Part1
				                                        Description: 
				                                        Returns 
					                                        Boolean: 
				                                        Parameters 
					! Number: nRez
				                                        Static Variables 
				                                        Local variables 
					                                        Number: nR2
				                                        Actions 
					                                        If SqlPrepareAndExecute( hSql(), sSql2 )  and NOT SqlFetchNext(hSql(),  nFetchRes)  
						                                        Set sErr ='Не знайдено рах 2620/2625/SG' || sNot 
						                                        Call SalMessageBox(sErr ," У В А Г А ! ", MB_IconStop)
						                                        Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
					                                        Else 
						! A есть ли привязанный к КД счет 262* ?
						                                        If SqlPrepareAndExecute( hSql(), 
								"SELECT a2.nls , a2.acc, a2.kv, a2.nbs   into :NLS_2620, :ACC_2620 , :KV_2620, :NBS_2620  
								 FROM nd_acc n2, accounts a2, nd_acc n8, accounts a8
								 WHERE n2.nd = :nPar and n2.acc = a2.acc AND a2.dazs IS NULL 
								   AND ( a2.nbs in ( '2620', '2625') or a2.tip = 'SG ' ) 
								   AND n8.nd = :nPar and n8.acc = a8.acc AND a8.dazs IS NULL AND a8.TIP = 'LIM'  and a8.kv = a2.kv 
								 order by decode (a2.tip,'SG ' , 1, decode (a2.nbs,'2620', 2, 3)  )
								" ) 
								and NOT SqlFetchNext(hSql(),  nFetchRes) 
							                                        Set sTmp = "Пов`язати з КД реф="|| Str(nPar) || " 
									знайдений рах." || NLS_2620 || "/" || Str(KV_2620) || "
									" || NMK 
							                                        If SalMessageBox(sTmp, "УВАГА ! Не знайдено пов`язаного з КД рах.262* ",
									MB_IconQuestion | MB_YesNo) = IDYES 
									and SqlPLSQLCommand( hSql(),"CCK_dpk.REF_2620( nPar, ACC_2620 ) " )
									and SqlCommitEx( hSql(),sTmp )
								                                        Set sErr = ""
							                                        Else 
								                                        Set ACC_2620 = NUMBER_Null
								                                        Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
					! !!!!!!!
					                                        If ACC_2620 != NUMBER_Null 
						                                        If K0 = 1
							                                        Set K01=0
							                                        Call SalShowWindow( K0 )
							                                        Call SalHideWindow( K01 )
						                                        Else 
							                                        Set K01=1
							                                        Call SalHideWindow( K0 )
							                                        Call SalShowWindow( K01 )
						                                        If nMode =122 
							                                        Call SalShowWindow( pbUpdate )
							                                        Call SalHideWindow( sErr )
							                                        Call SalDisableWindow( K1 )
							                                        Call SalDisableWindow( REF )
						!
						                                        Set DAT_CURR = bDat 
						                                        Call Part2 ()
						                                        If SqlPrepareAndExecute( hSql(),"Select max(fdat) into :WDATE    from cc_lim where nd= :nPar " ) and SqlFetchNext(hSql(),  nFetchRes) 
						                                        If SqlPrepareAndExecute( hSql(),"Select max(fdat) into :DAT_PREV from cc_lim where nd= :nPar and fdat < :bDat " ) and SqlFetchNext(hSql(), nFetchRes) 
						                                        If SqlPrepareAndExecute( hSql(),"Select min(fdat) into :DAT_NEXT from cc_lim where nd= :nPar and fdat > :bDat " ) and SqlFetchNext(hSql(), nFetchRes) 
						                                        If DAT_PREV > DAT1 and DAT_PREV < DAT4
							                                        Set K2_OLD = SalDateDay( DAT_PREV)
						                                        Else If DAT_NEXT > DAT1 and DAT_NEXT < DAT4
							                                        Set K2_OLD = SalDateDay( DAT_NEXT )
						                                        If SqlPrepareAndExecute( hSql(), "Select CCK_DPK.prev_SUM1 ( :nPar )/100 into :SUM1 from dual " ) 
								and SqlFetchNext(hSql(),  nFetchRes) 
						                                        If nMode = 121
							                                        Set K2 = Day( bDat )
							                                        Set K3_1 = FALSE
							                                        Set K3_0 = TRUE
						                                        Else 
							                                        Set K1 = 0
							                                        Set K2 = K2_OLD
							                                        Set K3_0 = FALSE
							                                        Set K3_1 = TRUE
			                                        Function: Part2
				                                        Description: 
				                                        Returns 
					                                        Boolean: 
				                                        Parameters 
					! Number: nRez
				                                        Static Variables 
				                                        Local variables 
					                                        Number: nR2
				                                        Actions 
					                                        Set sSql1 = 
							"select branch,CC_ID, sdate,wdate, NMK, mes, Z1, Z2, Z3, Z4, Z5, R1, R2, K1, K0, DAT_MOD
							 INTO :BRANCH,:CC_ID, :DAT1,:DAT4,:NMK,:MES,:Z1,:Z2,:Z3,:Z4,:Z5,:R1,:R2,:K1,:K0,:DAT_MOD
							 From v_CCKDPK where nd = :nPar and nls = :NLS_2620  " 
					                                        If SqlPrepareAndExecute( hSql(), sSql1  )  and SqlFetchNext(hSql(),  nFetchRes)
						                                        Call SalWaitCursor(TRUE)
						                                        Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_DPK.strSqlPopulate, TBL_FillAll )
						                                        Call SalTblSetContext(hWndForm, 0)
						                                        Call SalWaitCursor(FALSE)
						! Есть в архиве за этот день
						                                        If DAT_MOD >= bDat
							                                        Set sErr = sNot ||'4'
							                                        Call SalMessageBox("В архіві за "||SalFmtFormatDateTime( DAT_MOD, "dd/MM/yyyy" )|| ". Повторне  " || sErr ," У В А Г А ! ", MB_IconStop)
						                                        Else If nMode =121 
							                                        If Z1 > 0 
								                                        Call SalEnableWindow( pb_SP )
							                                        Else 
								                                        Call SalDisableWindow(  pb_SP )
							                                        If K1 > 0 and Z1 = 0
								                                        Call SalShowWindow( pbUpdate )
								                                        Call SalHideWindow( sErr )
							                                        Else 
								                                        Set sErr = 'K1<=0 або Z1 НЕ=0 ' || sNot ||'3'
								                                        Call SalMessageBox( sErr ," У В А Г А ! ", MB_IconStop)
					                                        Else 
						                                        Set sErr = sNot || '1'
						                                        Call SalMessageBox( sErr || "КД Відсутній в можливих (v_CCKDPK) " ," У В А Г А ! ", MB_IconStop)
						!
			                                        Function: F_SP
				                                        Description: 
				                                        Returns 
					                                        Boolean: 
				                                        Parameters 
					                                        String: pTmp
				                                        Static Variables 
				                                        Local variables 
					                                        Number: nR2
				                                        Actions 
					! Попытка предварительно  разобрать счет гашения  в части просрочек
					                                        If SqlPLSQLCommand( hSql()," CCK_DPK.PREV ( nPar, ACC_2620  ) " ) 
						                                        If SqlCommitEx( hSql(), pTmp  )
			                                        Function: SetInfo
				                                        Description: 
				                                        Returns 
					                                        Boolean: 
				                                        Parameters 
					                                        Number: nNd
				                                        Static Variables 
				                                        Local variables 
					                                        Number: nR2
				                                        Actions 
					                                        Call SalWaitCursor(TRUE)
					                                        Set nK1 = K1 *100
					                                        Set nK2 = K2
					                                        Set nK3 = IifN(K3_1,1,0)
					                                        If SqlPLSQLCommand( hSql(),"CCK_dpk.dpk (nMode - 120, nNd, ACC_2620, nK0, nK1, nK2, nK3, nZ1, nZ2, nZ3, nZ4, nZ5,  nR1, nR2, nP1)")
						                                        Call SqlCommit(  hSql() )
						                                        Set REF = nP1 
						                                        Call SalSendMsg( pb_GPK_New, SAM_Click, 0, 0 )
					                                        Else 
						                                        Call SqlRollback( hSql() )
					                                        Call SalWaitCursor(FALSE)
			                                        Function: RetGpk
				                                        Description: 
				                                        Returns 
					                                        Boolean: 
				                                        Parameters 
					                                        Number: nNd
					                                        Number: nRef
				                                        Static Variables 
				                                        Local variables 
					                                        Number: nR2
				                                        Actions 
					                                        Call SalWaitCursor(TRUE)
					                                        If SqlPLSQLCommand( hSql(),"CCK_dpk.MODI_RET( nNd , nRef)")
						                                        Call SqlCommit(  hSql() )
					                                        Else 
						                                        Call SqlRollback( hSql() )
					                                        Set REF = nRef
					                                        Call SalWaitCursor(FALSE)
		                                        Window Parameters 
			                                        Number: nMode
			                                        Number: nPar
			                                        String: strPar01
			                                        String: strPar02
		                                        Window Variables 
			                                        Date/Time: bDat
			                                        Number: nUserId
			                                        Number: ACC_2620
			                                        String: NBS_2620
			                                        Number: n980
			                                        Number: nRow
			                                        Number: nRed
			                                        Number: nTmp
			                                        String: sTmp
			                                        Boolean: bTmp
			!
			                                        Number: nZ1
			                                        Number: nZ2
			                                        Number: nZ3
			                                        Number: nZ4
			                                        Number: nZ5
			                                        Number: nR1
			                                        Number: nR2
			                                        Number: nP1
			                                        Number: nK0
			                                        Number: nK1
			                                        Number: nK2
			                                        Number: nK3 
			! Number: n2620
			                                        Number: nTmpE
			                                        String: sTmpE
			                                        String: sNot
			                                        String: sSql1
			                                        String: sSql2
		                                        Message Actions 
			                                        On SAM_Create
				                                        Set sNot = IifS ( nMode = 121,  'Дострокове погашення', 'Перебудова ГПК' ) || ' НЕМОЖЛИВO-'
				                                        Set bDat = GetBankDate()
				                                        Set nUserId = GetUserId()
				                                        Set n980 = GetBaseVal()
				                                        Call SetWindowFullSize(hWndForm)
				                                        Set nRed = SalColorFromRGB( 255,210,210 )
				                                        Call PrepareWindowEx(hWndForm)
				                                        Call SalSetWindowText(hWndForm, strPar01 )
				                                        Set hWndForm.Tbl_DPK.strSqlPopulate = 
						"SELECT a.TIP, a.KV , a.NLS, a.NMS, a.ostB/100, a.ostc/100, acrn.fproc(a.acc,gl.bd), a.acc, a.nbs 
						 INTO :Tbl_DPK.TIP,:Tbl_DPK.KV,:Tbl_DPK.NLS,:Tbl_DPK.NMS,:Tbl_DPK.OSTB,:Tbl_DPK.OSTC,:Tbl_DPK.IR, :Tbl_DPK.ACC, :Tbl_DPK.NBS 
						 from accounts a, nd_acc n
						 where a.nbs not like '6%' and a.acc=n.acc and n.nd = "|| Str(nPar) || " Order by nls"
				                                        Call SalDisableWindow( K0 ) 
				                                        Call SalDisableWindow( K01 ) 
				                                        Call SetWindowFont(hWndForm)
				! A есть ли хоть какой-то счет 262* ?
				                                        Call SalHideWindow( pbUpdate )
				                                        Call SalShowWindow( sErr )
				                                        Set ACC_2620 = NUMBER_Null
				                                        Set ND = nPar
				                                        Set sSql2 = 
						 "SELECT a2.nls, a2.ACC, a2.kv, c.nmk, a2.nbs  into :NLS_2620, :ACC_2620, :KV_2620, :NMK, :NBS_2620 
						  FROM accounts a2, nd_acc n8, accounts a8, customer c
						  WHERE a2.rnk= a8.rnk and a2.kv = a8.kv  and a2.dazs IS NULL 
						    AND (a2.nbs in ('2620', '2625') or a2.tip = 'SG ') AND n8.nd = :nPar  and n8.acc= a8.acc AND a8.dazs IS NULL
						    AND a8.tip = 'LIM'  and c.rnk = a2.rnk 
						 order by decode (a2.tip,'SG ' , 1, decode (a2.nbs,'2620', 2, 3)  ) " 
				!
				                                        Call Part1 ()
				!
				                                        Call SalSendClassMessage(SAM_Create, 0, 0)
			                                        On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				                                        Call SalWaitCursor(FALSE)
			                                        On SAM_FetchRowDone
				                                        If TIP = 'SS ' or TIP = 'SP '
					                                        If SqlPrepareAndExecute( hSqlAux(),  
							"SELECT acr_dat, STP_DAT into :Tbl_DPK.ACR_DAT, :Tbl_DPK.STP_DAT
							 from int_accn where id =0  and acc =:Tbl_DPK.ACC " )
							and SqlFetchNext(hSqlAux(), nFetchRes) 
						                                        If DAZS > Dat_next 
							                                        Call XSalTblSetRowBackColor( hWndForm, lParam,COLOR_Salmon )
				                                        If NLS = NLS_2620 and KV = KV_2620
					                                        Set US1 = 1
					                                        Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
				                                        Else 
					                                        Set US1 = 0
	Table Window: Tbl_DPK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    1.031"
				Width:  21.414"
				Width Editable? Class Default
				Height: 7.262"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Доср.пог. Показать стоп-дату
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 3.094"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				! Инфо-блок <Задолженности>
				Group Box: Z:Заборгованість
					Resource Id: 43626
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.155"
						Width:  7.1"
						Width Editable? Yes
						Height: 1.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Data Field: Z1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Z1. Терміново !
									SLN+SLK+SL+SPN+SK9+SP+SN8' )
				!
				Background Text: Z2. Поточні %% + коміс.SN+SN`+SK0
					Resource Id: 43627
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.083"
						Top:    0.595"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Data Field: Z2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.571"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Z2. Поточні %% + коміс.
									SN+SN`+SK0' )
				!
				Background Text: Z3. Черговий платіж <тіло кредиту> SS`
					Resource Id: 43628
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.083"
						Top:    0.845"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Data Field: Z3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.821"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Z3. Черговий платіж <тіло кредиту>
									SS ' )
				!
				Background Text: Z4. Разом обов`язкового платежу = Z1 + Z2 + Z3
					Resource Id: 43629
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.083"
						Top:    1.095"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Data Field: Z4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Z4. Разом обов`язкового платежу
									 Z1 + Z2 + Z3' )
				!
				Background Text: Z5. План-залишок по тілу =  SS - Z3
					Resource Id: 43630
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.083"
						Top:    1.345"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
				Data Field: Z5
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Z5. План-залишок по тілу
									 SS - Z3 ' )
				! Инфо-Брок <Рессурс>
				Group Box: R:Ресурс
					Resource Id: 43631
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.483"
						Top:    0.155"
						Width:  4.6"
						Width Editable? Yes
						Height: 1.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
				Background Text: R1. Загальний ресурс SG / 262*
					Resource Id: 43632
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.583"
						Top:    0.345"
						Width:  4.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Chartreuse
					Background Color: Default
				Data Field: R1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.583"
							Top:    0.571"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Chartreuse
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'R1. Загальний ресурс
									SG / 262*' )
				Data Field: NLS_2620
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.186"
							Top:    0.573"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Chartreuse
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок
									SG / 262*' )
				Data Field: KV_2620
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.286"
							Top:    0.573"
							Width:  0.614"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Chartreuse
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вал рахунку
									SG / 262*' )
				!
				Background Text: R2. Вільний ресурс SG / 262* = R1 - Z4
					Resource Id: 43633
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.583"
						Top:    1.012"
						Width:  4.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
				Data Field: R2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.583"
							Top:    1.238"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Green
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'R2. Вільний ресурс
									SG / 262*' )
				! Блок сбора инф.
				Frame
					Resource Id: 43634
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    1.655"
						Width:  11.8"
						Width Editable? Yes
						Height: 1.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Check Box: K0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: K0.  Ануїтет
					Window Location and Size
						Left:   7.483"
						Top:    1.655"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Periwinkle
					Background Color: Default
					Message Actions
				Check Box: K01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: K0.  Класичний
					Window Location and Size
						Left:   7.483"
						Top:    1.655"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Periwinkle
					Background Color: Default
					Message Actions
				Background Text: K1. Сума для дострокового погашення
					Resource Id: 43635
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.983"
						Top:    1.762"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
				Data Field: K1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.738"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'K1. Сума для дострокового погашення' )
				!
				Data Field: K2_OLD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 2
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.988"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'K2. Платіжний день(попередній)' )
				Background Text: K2. Платіжний день
					Resource Id: 43636
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.983"
						Top:    2.012"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
				Data Field: K2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 2
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.186"
							Top:    1.988"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'K2. Платіжний день' )
				! Check Box: K3
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: K3. Зі збереженняс суми 1-го платежу
					Window Location and Size
						Left:   7.183"
						Top:    1.738"
						Width:  4.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
.end
					                                                                                                                                                                              Message Actions
				!
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    1.905"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = strPar02
						On SAM_Click
							If SalMessageBox('Ви дійсно бажаєте виконати
									'|| strTip || ' ? ',
									'У В А Г А !  Рах.' || Str(KV_2620) ||'/' || NLS_2620 ,
									MB_IconQuestion | MB_YesNo) = IDYES
								Call SetInfo(nPar)
								Call Part1 (1)
				Pushbutton: pb_GPK_New
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    1.905"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Діюча версія ГПК'
						On SAM_Click
							Call FunNSIEditFFiltered("CC_W_LIM",1,"CC_W_LIM.ND =" || Str(nPar))
				Pushbutton: pb_GPK_Old
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.583"
						Top:    1.905"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Попередня версія ГПК'
						On SAM_Click
							Call FunNSIEditFFiltered("CC_W_LIM_ARC",1,"CC_W_LIM_ARC.ND =" || Str(nPar))
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.083"
						Top:    1.905"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Повернути із архіву Попередню версія ГПК'
						On SAM_Click
							If SalMessageBox('Ви дійсно бажаєте
									'|| strTip || ' ? ',
									'У В А Г А ! ',
									MB_IconQuestion | MB_YesNo) = IDYES
								Call RetGpk ( nPar, REF)
								Call Part1 (1)
				Data Field: REF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 2
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.583"
							Top:    1.905"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Black
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On VTM_LeftDoubleClick
							If REF > 0
								Call DocViewContentsEx(hWndForm, REF )
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс сформованого документу ' )
						On SAM_SetFocus
							Set nTmpE = REF
						On SAM_AnyEdit
							Set REF = nTmpE
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    2.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Gray
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    2.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.983"
						Top:    1.821"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.45"
						Top:    1.571"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Поновити дані на екрані'
						On SAM_Click
							Call Part1 (1)
				Line
					Resource Id: 43637
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.15"
						Begin Y:  0.071"
						End X:  5.15"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    2.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43638
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.383"
						Begin Y:  0.071"
						End X:  4.383"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.483"
						Top:    1.905"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 43639
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.7"
						Begin Y:  Class Default
						End X:  2.7"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Radio Button: K3_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Кiнцевого термiну
					Window Location and Size
						Left:   1.983"
						Top:    2.405"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
				Radio Button: K3_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: суми 1-го платежу
					Window Location and Size
						Left:   6.983"
						Top:    2.405"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
				Group Box: К3. Зі збереженням
					Resource Id: 43640
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.286"
						Top:    2.238"
						Width:  9.3"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Periwinkle
					Background Color: Default
				Data Field: ND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.583"
							Top:    1.655"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс КД' )
						On SAM_SetFocus
							Set nTmpE = ND
						On SAM_AnyEdit
							Set ND = nTmpE
				Data Field: SUM1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.183"
							Top:    2.405"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума 1 платежу' )
				Data Field: WDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.386"
							Top:    2.406"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кiнцевий Термiн' )
				Background Text: Iд.КД
					Resource Id: 43641
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    0.51"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.183"
							Top:    0.49"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Бранч
					Resource Id: 43642
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    0.26"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.186"
							Top:    0.24"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Позичальник
					Resource Id: 43643
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    2.844"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.183"
							Top:    2.823"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: sErr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.086"
							Top:    1.905"
							Width:  4.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Місяців
					Resource Id: 43644
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    2.594"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: MES
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.186"
							Top:    2.573"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Поч.дата
					Resource Id: 43645
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    0.76"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.183"
							Top:    0.74"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Попередня пл. дата
					Resource Id: 43646
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    1.01"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: DAT_PREV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.186"
							Top:    0.99"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Поперед.дата модиф ГПК
					Resource Id: 43647
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    1.26"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: DAT_MOD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.186"
							Top:    1.24"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Поточна банк.дата
					Resource Id: 43648
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    1.844"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: DAT_CURR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.186"
							Top:    1.823"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Наступна пл. дата
					Resource Id: 43649
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    2.094"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: DAT_NEXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.186"
							Top:    2.073"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Кін.дата
					Resource Id: 43650
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.686"
						Top:    2.344"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.183"
							Top:    2.323"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_SP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Z1. Терміново! SLN+SLK+SL+SPN+SK9+SP+SN8
					Window Location and Size
						Left:   1.983"
						Top:    0.238"
						Width:  5.3"
						Width Editable? Yes
						Height: 0.298"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_Click
							If Z1 > 0
								Set sTmp = 'КД='|| Str( nPar) || ': Погашення простроч.боргу Z1=' || SalNumberToStrX( Z1, 2 )|| ' з рах.'|| NLS_2620
								If SalMessageBox( sTmp || ' ? ', 'У В А Г А ! ', MB_IconQuestion | MB_YesNo) = IDYES
									Call F_SP (sTmp )
									Call Part1 (1)
		Contents
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: БР
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 4
				Data Type: String
				Justify: Left
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва 
						Рахунку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт-
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Max-доп
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.583"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: US1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ресурс
						R1
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If US1 = 1 and ( NBS = '2600' OR NBS = '2620' OR NBS = '2625' OR TIP = 'SG ')
							Set NLS_2620 = NLS
							Set KV_2620 = KV
							Set ACC_2620 = ACC
							Set NBS_2620 = NBS 
							Call Part2 ( 1 )
						Else
							Set US1 = 0
			Column: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Проц.
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.883"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACR_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата, по яку
						нараховано %%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.817"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: STP_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стоп-дата
						по нарах.%%
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.317"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Part1
				Description:
				Returns
					Boolean:
				Parameters
					Number: nVxod
				Static Variables
				Local variables
					Number: nR2
					Date/Time: Dat1
					Date/Time: Dat4
				Actions
					If SqlPrepareAndExecute( hSql(), sSql2 )  and NOT SqlFetchNext(hSql(),  nFetchRes)
						Set sErr ='Не знайдено рах 2600/2620/2625/SG' || sNot
						Call SalMessageBox(sErr ," У В А Г А ! ", MB_IconStop)
						Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
						Return FALSE
					! A есть ли привязанный к КД счет 262* ?
					If SqlPrepareAndExecute( hSql(),
							"SELECT a2.nls , a2.acc, a2.kv, a2.nbs   
							 into :NLS_2620, :ACC_2620 , :KV_2620, :NBS_2620
							 FROM nd_acc n2, accounts a2, nd_acc n8, accounts a8
							 WHERE n2.nd = :nPar and n2.acc = a2.acc AND a2.dazs IS NULL
							   AND ( a2.nbs in ( '2600', '2620', '2625') or a2.tip = 'SG ' )
							   AND n8.nd = :nPar and n8.acc = a8.acc AND a8.dazs IS NULL 
							   AND a8.TIP = 'LIM'  and a8.kv = a2.kv " )
							and NOT SqlFetchNext(hSql(),  nFetchRes)
						Set sTmp = "Пов`язати з КД реф="|| Str(nPar) || "
								знайдений рах." || NLS_2620 || "/" || Str(KV_2620) || "
								" || NMK
						If SalMessageBox(sTmp, "УВАГА ! Не знайдено пов`язаного з КД рах.262* ",
								MB_IconQuestion | MB_YesNo) = IDYES
								and SqlPLSQLCommand( hSql(),"CCK_dpk.REF_2620( nPar, ACC_2620 ) " )
								and SqlCommitEx( hSql(),sTmp )
							Set sErr = ""
						Else
							Set ACC_2620 = NUMBER_Null
							Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
							Return FALSE
					!
					If ACC_2620 != NUMBER_Null
						If K0 = 1
							Set K01=0
							Call SalShowWindow( K0 )
							Call SalHideWindow( K01 )
						Else
							Set K01=1
							Call SalHideWindow( K0 )
							Call SalShowWindow( K01 )
						If nMode =122
							Call SalShowWindow( pbUpdate )
							Call SalHideWindow( sErr )
							Call SalDisableWindow( K1 )
							Call SalDisableWindow( REF )
						!
						Set DAT_CURR = bDat
						If SqlPrepareAndExecute( hSql(),
								"Select min(fdat), max(fdat) into :Dat1, :Dat4 
								 from cc_lim where nd= :nPar " ) and SqlFetchNext(hSql(),  nFetchRes)
						Set WDATE = Dat4 
						Set DAT1 = Dat1
						Set DAT4 = Dat4
						If SqlPrepareAndExecute( hSql(),"Select max(fdat) into :DAT_PREV from cc_lim where nd= :nPar and fdat < :bDat " ) and SqlFetchNext(hSql(), nFetchRes)
						If SqlPrepareAndExecute( hSql(),"Select min(fdat) into :DAT_NEXT from cc_lim where nd= :nPar and fdat > :bDat " ) and SqlFetchNext(hSql(), nFetchRes)
						!
						! If DAT_PREV > Dat1 and DAT_PREV < Dat4
							                   Set K2_OLD = SalDateDay( DAT_PREV)
						! Else If DAT_NEXT > Dat1 and DAT_NEXT < Dat4
							                   Set K2_OLD = SalDateDay( DAT_NEXT )
						If SqlPrepareAndExecute( hSql(),
								 "Select CCK_DPK.Day_PL( :nPar ), CCK_DPK.prev_SUM1( :nPar )/100 
								  into :K2_OLD, :SUM1 from dual " )
								and SqlFetchNext(hSql(),  nFetchRes)
						Call Part2 (nVxod)
						If nMode = 121
							! Set K2 = Day( bDat )
							Set K2 = K2_OLD
							Set K3_1 = FALSE
							Set K3_0 = TRUE
						Else
							Set K1 = 0
							Set K2 = K2_OLD
							Set K3_0 = FALSE
							Set K3_1 = TRUE
			Function: Part2
				Description:
				Returns
					Boolean:
				Parameters
					Number: nVxod
				Static Variables
				Local variables
					Number: nR2
					Number: nZ8
				Actions
					Set sSql1 =
							"select branch,CC_ID, sdate,wdate, NMK, mes, Z1, Z2, Z3, Z4, Z5, R1, R2, K1, K0, DAT_MOD,  Z8
							 INTO :BRANCH,:CC_ID, :DAT1,:DAT4,:NMK,:MES,:Z1,:Z2,:Z3,:Z4,:Z5,:R1,:R2,:K1,:K0,:DAT_MOD,:nZ8 
							 From v_CCKDPK where nd="||Str(nPar)||" and nls='"||NLS_2620||"' and kv="||Str(KV_2620) 
					If SqlPrepareAndExecute( hSql(), sSql1  )  and SqlFetchNext(hSql(),  nFetchRes)
						Call SalWaitCursor(TRUE)
						Call SalTblPopulate(hWndForm, hSql(), hWndForm.Tbl_DPK.strSqlPopulate, TBL_FillAll )
						Call SalTblSetContext(hWndForm, 0)
						Call SalWaitCursor(FALSE)
						If nZ8 = 0
							Set sErr = sNot ||'5'
							Call SalMessageBox("Невідповідність прострочки SP " || sErr ," У В А Г А ! ", MB_IconStop)
							Return FALSE
						! Есть в архиве за этот день
						If DAT_MOD >= bDat
							Set sErr = sNot ||'4'
							Call SalMessageBox("В архіві за "||SalFmtFormatDateTime( DAT_MOD, "dd/MM/yyyy" )||
									 ". Повторна  " || sErr ," У В А Г А ! ", MB_IconStop)
							Return FALSE
						! nMode = 121 Дострокове погашення
								  nMode = 122 Просто Перебудова ГПК 
						If nMode =121
							If Z1 > 0
								Call SalEnableWindow( pb_SP )
							Else
								Call SalDisableWindow(  pb_SP )
							! Хорошо, деньги есть или же 2625
							! Call Debug ('1.K1='||Str(K1) || ' Z1='||Str (Z1) ||' NBS_2620='||NBS_2620 )
							If K1 > 0 and Z1 = 0  OR NBS_2620 = '2625'
								Set sErr = '' 
								Call SalShowWindow( pbUpdate )
								Call SalHideWindow( sErr )
								Return TRUE
							! Плохо
							If nVxod > 0
								Set sErr = NBS_2620||':K1<=0 або Z1 НЕ=0 ' || sNot ||'3'
								Call SalHideWindow  ( pbUpdate )
								Call SalShowWindow( sErr )
								Call SalMessageBox( sErr ," У В А Г А ! ", MB_IconStop)
							Return FALSE 
					Else
						Set sErr = sNot || '1'
						Call SalMessageBox( sErr || "КД Відсутній в можливих (v_CCKDPK) " ," У В А Г А ! ", MB_IconStop)
						Return FALSE 
			Function: F_SP
				Description:
				Returns
					Boolean:
				Parameters
					String: pTmp
				Static Variables
				Local variables
					Number: nR2
				Actions
					! Попытка предварительно  разобрать счет гашения  в части просрочек
					If SqlPLSQLCommand( hSql()," CCK_DPK.PREV ( nPar, ACC_2620  ) " )
						If SqlCommitEx( hSql(), pTmp  )
			Function: SetInfo
				Description:
				Returns
					Boolean:
				Parameters
					Number: nNd
				Static Variables
				Local variables
					Number: nR2
				Actions
					Call SalWaitCursor(TRUE)
					Set nK1 = K1 *100
					Set nK2 = K2
					Set nK3 = IifN(K3_1,1,0)
					If SqlPLSQLCommand( hSql(),"CCK_dpk.dpk (nMode - 120, nNd, ACC_2620, nK0, nK1, nK2, nK3, nZ1, nZ2, nZ3, nZ4, nZ5,  nR1, nR2, nP1)")
						Call SqlCommit(  hSql() )
						Set REF = nP1
						Call SalSendMsg( pb_GPK_New, SAM_Click, 0, 0 )
					Else
						Call SqlRollback( hSql() )
					Call SalWaitCursor(FALSE)
			Function: RetGpk
				Description:
				Returns
					Boolean:
				Parameters
					Number: nNd
					Number: nRef
				Static Variables
				Local variables
					Number: nR2
				Actions
					Call SalWaitCursor(TRUE)
					If SqlPLSQLCommand( hSql(),"CCK_dpk.MODI_RET( nNd , nRef)")
						Call SqlCommit(  hSql() )
					Else
						Call SqlRollback( hSql() )
					Set REF = nRef
					Call SalWaitCursor(FALSE)
		Window Parameters
			! nMode = 121 Дострокове погашення
					  nMode = 122 Просто Перебудова ГПК 
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: bDat
			Number: nUserId
			Number: ACC_2620
			String: NBS_2620
			Number: n980
			Number: nRow
			Number: nRed
			Number: nTmp
			String: sTmp
			Boolean: bTmp
			!
			Number: nZ1
			Number: nZ2
			Number: nZ3
			Number: nZ4
			Number: nZ5
			Number: nR1
			Number: nR2
			Number: nP1
			Number: nK0
			Number: nK1
			Number: nK2
			Number: nK3
			! Number: n2620
			Number: nTmpE
			String: sTmpE
			String: sNot
			String: sSql1
			String: sSql2
		Message Actions
			On SAM_Create
				Set sNot = IifS( nMode = 121,'Дострокове погашення', 'Перебудова ГПК' ) || ' буде НЕМОЖЛИВO-'
				Set bDat = GetBankDate()
				Set nUserId = GetUserId()
				Set n980 = GetBaseVal()
				Call SetWindowFullSize(hWndForm)
				Set nRed = SalColorFromRGB( 255,210,210 )
				Call PrepareWindowEx(hWndForm)
				Call SalSetWindowText(hWndForm, strPar01 )
				Set hWndForm.Tbl_DPK.strSqlPopulate =
						"SELECT a.TIP,a.KV,a.NLS,a.NMS,a.ostB/100, a.ostc/100, a.ostx/100, acrn.fproc(a.acc,gl.bd), a.acc,a.nbs
						 INTO :Tbl_DPK.TIP , :Tbl_DPK.KV, :Tbl_DPK.NLS, :Tbl_DPK.NMS, :Tbl_DPK.OSTB, 
						      :Tbl_DPK.OSTC, :Tbl_DPK.OSTX,:Tbl_DPK.IR, :Tbl_DPK.ACC, :Tbl_DPK.NBS
						 from accounts a, nd_acc n
						 where a.dazs is null and NVL(a.nbs,'8')  not like '6%' 
						   and a.acc=n.acc and n.nd = "|| Str(nPar) || "
						 Order by nls"
				Call SalDisableWindow( K0 )
				Call SalDisableWindow( K01 )
				Call SetWindowFont(hWndForm)
				! A есть ли хоть какой-то счет 262* ?
				Call SalHideWindow( pbUpdate )
				Call SalShowWindow( sErr )
				Set ACC_2620 = NUMBER_Null
				Set ND = nPar
				Set sSql2 =
						 "SELECT a2.nls, a2.ACC, a2.kv, c.nmk, a2.nbs  into :NLS_2620, :ACC_2620, :KV_2620, :NMK, :NBS_2620
						  FROM accounts a2, nd_acc n8, accounts a8, customer c
						  WHERE a2.rnk= a8.rnk and a2.kv = a8.kv  and a2.dazs IS NULL
						    AND (a2.nbs in ('2600','2620', '2625') or a2.tip = 'SG ') AND n8.nd = :nPar  and n8.acc= a8.acc AND a8.dazs IS NULL
						    AND a8.tip = 'LIM'  and c.rnk = a2.rnk
						 order by decode (a2.acc, :ACC_2620 , 1, 2  ) "
				!
				Call Part1 (0)
				If Z1 > 0
					Call F_SP (sTmp )
				Call Part1 (1)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If TIP = 'SS ' or TIP = 'SP '
					If SqlPrepareAndExecute( hSqlAux(),
							"SELECT acr_dat, STP_DAT into :Tbl_DPK.ACR_DAT, :Tbl_DPK.STP_DAT
							 from int_accn where id =0  and acc =:Tbl_DPK.ACC " )
							and SqlFetchNext(hSqlAux(), nFetchRes)
						If DAZS > Dat_next
							Call XSalTblSetRowBackColor( hWndForm, lParam,COLOR_Salmon )
				If NLS = NLS_2620 and KV = KV_2620
					Set US1 = 1
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
				Else
					Set US1 = 0
	Table Window: INSU
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    1.031"
				Width:  15.983"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 22435
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.15"
						Begin Y:  0.071"
						End X:  5.15"
						End Y:  0.536"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Информация о СД по выбранной СК'
						On SAM_Click
							If not SalIsNull(hWndForm.INSU.RNK)
								Set nTmp = - hWndForm.INSU.RNK
								Call Sel017f(hWndMDI, NUMBER_Null, 27, nTmp, '', hWndForm.INSU.NMK,'','','' )
				Pushbutton: pb_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\HELP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 'Информация о ПРОБЛЕМНЫХ СД по ВСЕМ СК'
						On SAM_Click
							Call Sel017f(hWndMDI, NUMBER_Null, 27, 0,'' ,strTip,'','','' )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 22436
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.383"
						Begin Y:  0.071"
						End X:  4.383"
						End Y:  0.536"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.517"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 22437
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид.
						дог
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.№
						компании
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Return hWndForm.INSU.F_RNK(hWndForm.INSU.RNK)
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						компании
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set hWndForm.INSU.sTmp=Str(hWndForm.INSU.RNK)
						Call FunNSIGetFiltered
								('CUSTOMER','NMK',
								 " custtype=2 and DATE_OFF is null and ise like '125%' ",
								hWndForm.INSU.sTmp,
								 hWndForm.INSU.NMK )
						Set hWndForm.INSU.RNK=Val(hWndForm.INSU.sTmp)
						Call SalSendMsg( hWndForm.INSU.RNK, SAM_Validate, 0, 0 )
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ОКПО
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						заключения
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.25"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.INSU.DAT1 = CorrectDate(hWndForm.INSU.n980, hWndForm.INSU.DAT1, hWndForm.INSU.DAT1 +1)
						Return F_DAT()
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						завершения
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 11
				Data Type: Date/Time
				Justify: Center
				Width:  1.267"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set hWndForm.INSU.DAT4 = CorrectDate( hWndForm.INSU.n980, hWndForm.INSU.DAT4, hWndForm.INSU.DAT4 +1)
						Return F_DAT()
			Column: LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						лимита
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Использовано
						 лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.233"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не использ
						лимита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: ACCZ
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Дог
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             List Values 
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Message Actions 
		Functions
			Function: F_DAT
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.INSU.DAT1 != DATETIME_Null and hWndForm.INSU.DAT4 != DATETIME_Null and  
							hWndForm.INSU.DAT1 >  hWndForm.INSU.DAT4
						Call Debug('Ош.дат '||
								 SalFmtFormatDateTime( hWndForm.INSU.DAT1, 'dd/MM/yyyy' ) ||'  '||
								 SalFmtFormatDateTime( hWndForm.INSU.DAT4, 'dd/MM/yyyy' ) ) 
						Return FALSE
					Return TRUE
			Function: F_RNK
				Description:
				Returns
					Boolean:
				Parameters
					Number: nRNK
				Static Variables
				Local variables
				Actions
					If nRNK > 0
						Return 
								 SqlPrepareAndExecute( hSql(),
								  "SELECT c.okpo, c.nmk
								   INTO :hWndForm.INSU.OKPO, :hWndForm.INSU.NMK
								   FROM customer c
								   WHERE c.DATE_OFF is null and c.rnk=:nRNK ")     
								and SqlFetchNext(hSql(), nFetchRes)
					Return TRUE
		Window Parameters
			Number: nPar1
			Number: nPar2
			Number: nPar3  
		Window Variables
			Date/Time: bDat
			Number: nUserId
			Number: n980
			Number: nRow
			Number: nRed
			Number: nTmp
			String: sTmp
			Boolean: bTmp
		Message Actions
			On SAM_Create
				Set hWndForm.INSU.bDat = GetBankDate()
				Set hWndForm.INSU.nUserId = GetUserId()
				Set hWndForm.INSU.n980 = GetBaseVal()
				Set hWndForm.INSU.nTabInstance = 1
				Call SetWindowFullSize(hWndForm)
				Set nRed = SalColorFromRGB( 255,210,210 )
				Call PrepareWindowEx(hWndForm)
				Set hWndForm.INSU.strFilterTblName = 'INSU_CORPS'
				Set hWndForm.INSU.strPrintFileName = 'INSU'
				Set hWndForm.INSU.strSqlPopulate = 
						"SELECT nd, cc_id, rnk, nmk, dat1, dat4, nvl(lim,0), okpo
						 INTO :hWndForm.INSU.ND, :hWndForm.INSU.CC_ID,:hWndForm.INSU.RNK, 
						      :hWndForm.INSU.NMK,:hWndForm.INSU.DAT1, :hWndForm.INSU.DAT4, 
						      :hWndForm.INSU.LIM,:hWndForm.INSU.OKPO
						 from INSU_CORPS order by nd"
				Set hWndForm.INSU.strSqlDelete = 
						"DELETE FROM cc_deal WHERE nd=:hWndForm.INSU.ND and sos =0 "
				Set hWndForm.INSU.strSqlInsert = 
						"INSERT INTO cc_deal(SOS,CC_ID,SDATE, WDATE, RNK, VIDD, LIMIT,USER_ID ) VALUES
						     ( 0,:hWndForm.INSU.CC_ID,:hWndForm.INSU.DAT1,:hWndForm.INSU.DAT4,
						      :hWndForm.INSU.RNK ,17,:hWndForm.INSU.LIM  ,:hWndForm.INSU.nUserId)"
				Set hWndForm.INSU.strSqlUpdate = 
						"UPDATE cc_deal Set 
						   RNK  =:hWndForm.INSU.RNK, cc_id =:hWndForm.INSU.CC_ID, limit=:hWndForm.INSU.LIM,     
						   sDATe=:hWndForm.INSU.DAT1, wDATe=:hWndForm.INSU.DAT4         
						   where nd =:hWndForm.INSU.ND "
				! Call SalMapEnterToTab(TRUE)
				! Set hWndForm.INSU.fFilterAtStart = TRUE
				Call SalSetWindowText(hWndForm, 'Договора со страховыми компаниями КД ' || CC_ID )
				Call ShowApdVersion('16')
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If hWndForm.INSU.DAT4 < bDat
					Call XSalTblSetCellBackColor( hWndForm.INSU.DAT4, nRed )
				If hWndForm.INSU.LIM = 0
					Call XSalTblSetCellBackColor( hWndForm.INSU.LIM, nRed )
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select Nvl(sum(S),0) into :hWndForm.INSU.OST from 
						(select sum(S) S from insu_rnk where rnki=:hWndForm.INSU.RNK 
						 union all select sum(S) from insu_acc where rnki=:hWndForm.INSU.RNK) " ) 
						and SqlFetchNext(hSqlAux2(),  nFetchRes) 
				Set hWndForm.INSU.OSTN = hWndForm.INSU.LIM - hWndForm.INSU.OST 
				If hWndForm.INSU.OSTN < 0 
					Call XSalTblSetCellBackColor( hWndForm.INSU.OSTN, nRed )
	Form Window: DEAL1
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  13.117"
				Width Editable? Class Default
				Height: 8.738"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.69"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbZay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered
									("CC_ZAYV", "NMK"," SOS=6 AND DATW IS NULL and CUSTTYPE ="||Str(nTip_Kl), sTmp, sNMK )
							If sTmp !=STRING_Null
								Set ND =Val(sTmp)
								If SqlPrepareAndExecute( hSql(),
										"SELECT to_char(rnk), s, kv
										 INTO :sTmp, :nS, :nKV  from cc_zay where nz=:ND")
										and SqlFetchNext( hSql(), nFetchRes )
									Call cmbKV.SetSelectById( nKV )
									Call SalSendMsg( cmbKV, SAM_Click, 0, 0 )
									Call F_POISK()
						On SAM_Create
							Set strTip = 'Взяти із заявок'
							Call SalDisableWindow( pbZay )
				Pushbutton: pbDEL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_DEL()
							Call SalDisableWindow(pbDEL)
						On SAM_Create
							Set strTip = 'Видалити (Скасувати збереження)'
				Pushbutton: pbSAVE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If F_SAVE()
								Call SalEnableWindow(pbDEL)
								Call SalEnableWindow(pbPar)
								Call SalEnableWindow(pb_Lim)
								Call SalEnableWindow(pb_MOS)
						On SAM_Create
							Set strTip = 'Зберегти'
				Pushbutton: pbCLEA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If sKV1=STRING_Null
								Call F_START_NEW()
						On SAM_Create
							Set strTip = 'Очистить'
				Pushbutton: pbEXIT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
						On SAM_Create
							Set strTip = 'Вихід'
				Pushbutton: pbPar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If not IsWindow(hKD)
								Set hKD = SalCreateWindow(frm_KD, hWndMDI, nTip_Ur, ND, nTip_Kl, Val(sGr),sKV1,sKV2,sKV3, nS, 1)
							Else
								Call SalBringWindowToTop ( frm_KD )
						On SAM_Create
							Set strTip = 'Подробно'
				Pushbutton: pb_Lim
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Побудова Графіка Ліміта Кредитування (ГЛК) обраного КД'
						On SAM_Click
							Call Sel017f(hWndMDI,nTip_Ur,13, ND ,
									CC_ID || ' від '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ), sNMK ,'','','')
				Pushbutton: pb_MOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							If not b_MOS
								Call SalHideWindow( pb_MOS ) 
							Set strTip = 'Спец. реквізити по КД (внутрішньобанківські)'
						On SAM_Click
							Call DOP_MOS (ND, CC_ID, sNMK, 'All')
				Background Text: Кредитний договір
					Resource Id: 42475
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.783"
						Top:    0.095"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 18
					Font Enhancement: Italic-Underline
					Text Color: Midnight Blue
					Background Color: Default
				Data Field: ND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.167"
							Top:    0.06"
							Width:  1.467"
							Width Editable? Yes
							Height: 0.396"
							Height Editable? Yes
						Visible? Yes
						Border? No
						Justify: Left
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: 18
						Font Enhancement: Italic-Underline
						Text Color: Midnight Blue
						Background Color: Gray
						Input Mask: Unformatted
					Message Actions
				!
				Data Field: NLS_SS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.883"
							Top:    0.405"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'АВТО-№ ссудного сч.(SS)' )
				Data Field: NLS_SN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    0.405"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'АВТО-№ сч.нач.% (SN)' )
				Data Field: nSrok
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.083"
							Top:    0.405"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Срок в мес.' )
				Pushbutton: pb_Viza1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip =
									 ' Виза № 1 : 
									"Передать для открытия счетов" '
						On SAM_Click
							If SalMessageBox(
									'Вы действительно хотите выполнить 
									'||strTip || ' ?',
									'В Н И М А Н И Е ! ', 
									MB_IconQuestion | MB_YesNo) = IDYES
								If SqlPrepareAndExecute( hSql(),
										"Update cc_deal set sos=2 where nd=:ND" )
										and SqlCommitEx( hSql(),'КД.'|| Str(ND) || strTip  )
									Call SalDisableWindow( pbSAVE )
									Call SalDisableWindow( pb_Viza1 )
		Contents
			Picture: picTabs
.data CLASSPROPS
0000: 546162546F704D61 7267696E00020030 0000546162466F72 6D50616765730010
0020: 00090909446C675F 4E64547874546162 0000546162447261 775374796C65000B
0040: 0057696E39355374 796C650000546162 52696768744D6172 67696E0002003000
0060: 005461624E616D65 730018004E616D65 30094E616D653309 4E616D6532094E61
0080: 6D65310000546162 4C6162656C730046 00CFE0F0E0ECE5F2 F0E820CAC42009C4
00A0: E0EDB320EFF0EE20 EFEEE3E0F8E5EDED FF2009CAEEECB3F1 B3FF20E920CBB3EC
00C0: B3F22009C4EEE42E 20EFE0F0E0ECE5F2 F0E820CAC4200000 5461625061676543
00E0: 6F756E7400020031 0000546162426F74 746F6D4D61726769 6E00020030000054
0100: 616243757272656E 740006004E616D65 3000005461624C65 66744D617267696E
0120: 0002003000005461 624F7269656E7461 74696F6E00010000 0000000000000000
0140: 0000000000000000 00000000000000
.enddata
.data CLASSPROPSSIZE
0000: 4F01
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.1"
					Top:    0.095"
					Width:  12.7"
					Width Editable? Class Default
					Height: 4.917"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Yes
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
					! On TABSM_TabActivateStart
						                                                                                                                                                                                                                                                                                                                                                                                                                         Call setFields()
					On SAM_Create
						Call SalSendClassMessage(SAM_Create, wParam, lParam)
						! Инициализация закладок
						Call picTabs.InitializeFormPages(
								     '1;' ||
								     SalNumberToStrX(ND,0) || ';' ||
								     CC_ID || ';' ||
								     SalNumberToStrX(nTip_Ur,0) || ';' ||
								     Str(SalWindowHandleToNumber(hWndForm)) )
						! Показываем первую закладку
						Call picTabs.BringToTop(0,TRUE)
					On __TABSM_TabActivate
						Call SalSendClassMessage(__TABSM_TabActivate, 0, 0)
						Call setFields()
			Background Text: Докладно: Опис мети
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42868
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    4.786"
					Width:  5.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
			Background Text: Докладно: Опис забезпечення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42869
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.75"
					Top:    4.786"
					Width:  5.617"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Multiline Field: ml_Aim
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.217"
						Top:    5.012"
						Width:  5.933"
						Width Editable? Yes
						Height: 0.857"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
				Message Actions
			Multiline Field: ml_Pawn
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   6.217"
						Top:    5.012"
						Width:  5.933"
						Width Editable? Yes
						Height: 0.857"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
				Message Actions
			Background Text: № договору
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42502
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.783"
					Top:    0.429"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.177"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: CC_ID
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.655"
						Width:  1.383"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ договора' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Валюта
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42503
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.383"
					Top:    0.429"
					Width:  1.014"
					Width Editable? Yes
					Height: 0.177"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbKV
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   1.767"
					Top:    0.655"
					Width:  2.8"
					Width Editable? Class Default
					Height: 3.048"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Валюта договора' )
					On SAM_Create
						Call cmbKV.Init(hWndItem)
						If CCK_NBU
							! Населяю только по определенному значению и дизейблю
							Call cmbKV.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " WHERE kv=980 " )
							Set nKV=980
							Call cmbKV.SetSelectById( nKV )
							Call SalDisableWindow(cmbKV)
						Else
							Call cmbKV.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " ORDER BY skv " )
						! Можно было сделать так: тогда населилось бы всем, но подставилось с окошко опеределенное
							                                                                                                                                                                                                                                                                                                                                                                                                                                Call cmbKV.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " ORDER BY skv " )
							                                                                                                                                                                                                                                                                                                                                                                                                                                If CCK_NBU
								                                                                                                                                                                                                                                                                                                                                                                                                                                Call cmbKV.SetSelectById( 980 )
					On SAM_Click
						Set nKV = cmbKV.GetKey( SalListQuerySelection(hWndItem))
						Set V_KV = nKV
						If G_V_CR9=2   ! Устанавливаем вал ком долга= вал дог.
							Set V_CR9=nKV
							Call cmbV_CR9.SetSelectById( V_CR9 )
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT y.Basey, y.name  INTO :nBasey,:cmbBasey 
								   FROM  Basey y "|| IifS(CC_BASEY = NUMBER_Null, 
								  ",tabval t WHERE t.Basey=y.Basey and t.kv=:nKV",  "WHERE y.Basey=:CC_BASEY" ) ) 
								and SqlFetchNext(hSql(), nFetchRes) 
						Set nBR_ID = NUMBER_Null
						Set sBR_ID = STRING_Null
						If dfKV1=nKV 
							Set dfKV1=NUMBER_Null
						If dfKV2=nKV 
							Set dfKV2=NUMBER_Null
						If dfKV3=nKV 
							Set dfKV3=NUMBER_Null
						If dfKV4=nKV 
							Set dfKV4=NUMBER_Null
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Сума
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42504
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.867"
					Top:    0.952"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: nS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.767"
						Top:    0.929"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма договора' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_KillFocus
						Set V_LIM=nS
			Background Text: Дати:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42505
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    1.262"
					Width:  0.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Заключення
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42506
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.583"
					Top:    1.262"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DAT1
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    1.238"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						! Set DAT1 = CorrectDate(n980, DAT1, DAT1 +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Заключения' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Початку
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42507
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.883"
					Top:    1.512"
					Width:  2.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DAT2
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    1.488"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						! Set DAT2 = CorrectDate(n980, DAT2, DAT2 +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Видачі
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42508
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.883"
					Top:    1.762"
					Width:  2.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Blue
				Background Color: Default
			Data Field: DAT3
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    1.738"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DAT3 < DAT2 or DAT3 > DAT4
							Return VALIDATE_Cancel
						! Set DAT3 = CorrectDate(n980, DAT3, DAT3 +1)
						Set DAT3_Double=DAT3
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Выдачи' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On NM_Click
						Set DAT3_Double=DAT3
			Background Text: Завершення
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42509
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.883"
					Top:    2.012"
					Width:  2.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
			Data Field: DAT4
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    1.988"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DAT4 <= DAT2
							Return VALIDATE_Cancel
						! Корр.даты только для ЮЛ
						If nTip_Kl=2
							Set DAT4 = CorrectDate(n980, DAT4, DAT4 -1 )
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Завершения' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			!
			Background Text: Вид 
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42510
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.345"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbVID
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.083"
					Top:    2.571"
					Width:  3.1"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вид договора' )
					On SAM_Create
						Call cmbVID.Init(hWndItem)
						Call cmbVID.Populate(hSql(), "VIDD", "NAME",     "CC_VIDD",
								 " WHERE vidd in (1,2,3,11,12,13 ) and tipd=1 and
								     custtype =" || Str(nTip_Kl) || "
								     ORDER BY vidd")
					On SAM_Click
						Set nVID = cmbVID.GetKey(
								    SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Джерело залуч-ня коштів
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42511
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.383"
					Top:    2.345"
					Width:  3.1"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbSOUR
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.283"
					Top:    2.571"
					Width:  3.1"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Источник' )
					On SAM_Create
						Call cmbSOUR.Init(hWndItem)
						Call cmbSOUR.Populate(hSql(), "SOUR", "NAME", "CC_SOURCE", "ORDER BY name desc")
						If CCK_NBU
							! Населяю первым попавшимся из списка и дизейблю
							Call SalListSetSelect( cmbSOUR, 0 )
							Call SalDisableWindow(cmbSOUR)
							Call SalSendMsg(cmbSOUR,SAM_Click,0,0)
					On SAM_Click
						Set nISTO = cmbSOUR.GetKey(
								    SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Ціль
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42512
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.845"
					Width:  0.967"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbAIM
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.083"
					Top:    3.071"
					Width:  3.1"
					Width Editable? Class Default
					Height: 1.5"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Цель' )
					On SAM_Create
						Call cmbAIM.Init(hWndItem)
						Call cmbAIM.Populate(hSql(), "AIM", "NAME", "CC_AIM",  
								  "WHERE (d_close is null or d_close>to_date(:DEAL1.DAT1)) and "||
								IifS(nTip_Kl=3, "NBSF" ,"NBS") || " is not null ORDER BY aim")
						If CCK_NBU
							Call SalListSetSelect( cmbAIM, 0 )
							Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
					On SAM_Click
						Set nCEL = cmbAIM.GetKey( SalListQuerySelection(hWndItem))
						Call NBS_AIM_All(nVID, nCEL, DAT4, DAT1)
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			!
			Data Field: Product
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    3.071"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Код "Продукта"')
			Pushbutton: pb_Product
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.883"
					Top:    2.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CHART.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Вибрати "Продукт"'
					On SAM_Click
						Set sTmp=STRING_Null
						Set sTmp2=Product
						Call FunNSIGet ("CC_POTR","NAME", sTmp2, sTmp )
						If sTmp2 != STRING_Null
							Set sProduct = sTmp
							Set Product=sTmp2
			Data Field: sProduct
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    3.405"
						Width:  6.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Наименование "Продукта"')
			!
			Check Box: cb_A
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обслуговування по схемі "Ануїтет"
				Window Location and Size
					Left:   0.383"
					Top:    3.655"
					Width:  5.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			!
			Pushbutton: pb_Inic
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.933"
					Top:    0.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Шукати ініціатора'
					On SAM_Click
						Set sTmp=STRING_Null
						Call FunNSIGetFiltered 
								("TOBO","NAME"," DATE_CLOSED is null ", sTmp, sTmpM )
						If sTmp != STRING_Null
							Set cmb_INIC = sTmp || ' ' || sTmpM
			Background Text: Ініціатива
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42513
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.683"
					Top:    0.429"
					Width:  1.167"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! Combo Box: cmb_INIC
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   9.083"
					Top:    0.405"
					Width:  3.217"
					Width Editable? Yes
					Height: 4.286"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
.end
				                                                                                                                                                                                                                                                                                                                                                                                                                                List Initialization 
				                                                                                                                                                                                                                                                                                                                                                                                                                                Message Actions 
					                                                                                                                                                                                                                                                                                                                                                                                                                                On SAM_Create
						                                                                                                                                                                                                                                                                                                                                                                                                                                If CCK_NBU
							                                                                                                                                                                                                                                                                                                                                                                                                                                If SqlPrepareAndExecute(  hSqlAux(),
									"SELECT name FROM (  SELECT to_char(id) id, name from CC_INIC 
									 union all SELECT tobo id, tobo||' '||name name from V_TOBO_OPEN
									 ORDER BY 1) INTO :sTmpM  ORDER BY id " )
								                                                                                                                                                                                                                                                                                                                                                                                                                                While SqlFetchNext(  hSqlAux(), nFetchRes )
									                                                                                                                                                                                                                                                                                                                                                                                 Call SalListAdd( cmb_INIC, sTmpM )
								                                                                                                                                                                                                                                                                                                                                                                                                                                If CC_INIC = STRING_Null
									                                                                                                                                                                                                                                                                                                                                                                                                                                Set CC_INIC = sTmpM
								                                                                                                                                                                                                                                                                                                                                                                                 Set cmb_INIC = CC_INIC
						                                                                                                                                                                                                                                                                                                                                                                                                                                Else 
							                                                                                                                                                                                                                                                                                                                                                                                                                                If SqlPrepareAndExecute(  hSqlAux(),
									"SELECT name from CC_INIC 
									 union all SELECT tobo||' '||name from V_TOBO_OPEN
									 ORDER BY 1 INTO :sTmpM " )
								                                                                                                                                                                                                                                                                                                                                                                                                                                While SqlFetchNext(  hSqlAux(), nFetchRes )
									                                                                                                                                                                                                                                                                                                                                                                                 Call SalListAdd( cmb_INIC, sTmpM )
								                                                                                                                                                                                                                                                                                                                                                                                                                                If CC_INIC = STRING_Null
									                                                                                                                                                                                                                                                                                                                                                                                                                                Set CC_INIC = sTmpM
								                                                                                                                                                                                                                                                                                                                                                                                 Set cmb_INIC = CC_INIC
			Combo Box: cmb_INIC
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   6.433"
					Top:    0.405"
					Width:  5.867"
					Width Editable? Class Default
					Height: 3.048"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmb_INIC.Init(hWndItem)
						If CCK_NBU
							Call cmb_INIC.Populate(hSql(),  "id",  "NAME", 
									"(SELECT to_char(id) id, name from CC_INIC 
									 union all SELECT tobo id, tobo||' '||name name from V_TOBO_OPEN)",  
									  "ORDER BY name")
							Call cmb_INIC.SetSelectById('0')
							! If CC_INIC = STRING_Null
								                                                                                                                                                                                                                                                                                                                                                                                                                                Set CC_INIC = sTmpM
							! Set cmb_INIC = CC_INIC
							! If SqlPrepareAndExecute(  hSqlAux(),
									"SELECT name FROM (  SELECT to_char(id) id, name from CC_INIC 
									 union all SELECT tobo id, tobo||' '||name name from V_TOBO_OPEN
									 ORDER BY 1) INTO :sTmpM  ORDER BY id " )
								                                                                                                                                                                                                                                                                                                                                                                                                                                While SqlFetchNext(  hSqlAux(), nFetchRes )
									                                                                                                                                                                                                                                                                                                                                                                                 Call SalListAdd( cmb_INIC, sTmpM )
								                                                                                                                                                                                                                                                                                                                                                                                                                                If CC_INIC = STRING_Null
									                                                                                                                                                                                                                                                                                                                                                                                                                                Set CC_INIC = sTmpM
								                                                                                                                                                                                                                                                                                                                                                                                 Set cmb_INIC = CC_INIC
						Else
							Call cmb_INIC.Populate(hSql(),  "id",  "NAME", 
									"(SELECT to_char(id) id, name from CC_INIC 
									 union all SELECT tobo id, tobo||' '||name name from V_TOBO_OPEN)",  
									  "ORDER BY name")
							If CC_INIC = STRING_Null
								Set CC_INIC = sTmpM
							Set cmb_INIC = CC_INIC
							! If SqlPrepareAndExecute(  hSqlAux(),
									"SELECT name from CC_INIC 
									 union all SELECT tobo||' '||name from V_TOBO_OPEN
									 ORDER BY 1 INTO :sTmpM " )
								                                                                                                                                                                                                                                                                                                                                                                                                                                While SqlFetchNext(  hSqlAux(), nFetchRes )
									                                                                                                                                                                                                                                                                                                                                                                                 Call SalListAdd( cmb_INIC, sTmpM )
								                                                                                                                                                                                                                                                                                                                                                                                                                                If CC_INIC = STRING_Null
									                                                                                                                                                                                                                                                                                                                                                                                                                                Set CC_INIC = sTmpM
								                                                                                                                                                                                                                                                                                                                                                                                 Set cmb_INIC = CC_INIC
			!
			Group Box: Пошук клієнта - позичальника
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42514
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    0.738"
					Width:  7.7"
					Width Editable? Yes
					Height: 1.583"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Blue
				Background Color: Default
			Pushbutton: pbKlient
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.983"
					Top:    0.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Шукати клієнта'
						Call SalDisableWindow( pb2 )
						Call SalDisableWindow( pbPrcAcc )
					On SAM_Click
						! Call SalWaitCursor( FALSE )
						Set sTmp=STRING_Null
						If nTip_Kl=2
							Call FunNSIGetFiltered 
									("CUSTOMER","NMK",
									" CUSTOMER.DATE_OFF is null and (CUSTOMER.sed='91' or CUSTOMER.custtype=2)", 
									sTmp, sNMK)
						! Else If nTip_Kl=3
							                                                                                                                                                                                                                                                                                                                                                                                                                                         Call FunNSIGetFiltered 
									('CUSTOMER','NMK',' CUSTOMER.DATE_OFF is null and CUSTOMER.custtype=3' || CC_FL,
									 sTmp, sNMK)
						! Else If nTip_Kl=1
							                                                                                                                                                                                                                                                                                                                                                                                                                                         Call FunNSIGetFiltered 
									('CUSTOMER','NMK',' CUSTOMER.DATE_OFF is null and CUSTOMER.custtype=1' || CC_FL,
									 sTmp, sNMK)
						Else
							Call FunNSIGetFiltered 
									('CUSTOMER','NMK',' CUSTOMER.DATE_OFF is null and CUSTOMER.custtype='||
									Str(nTip_Kl) || CC_FL,
									 sTmp, sNMK)
						Call F_POISK()
			Pushbutton: pb_New_Kli
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.983"
					Top:    0.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\NEWREC.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set strTip = 'Зареєструвати нового клієнта'
					On SAM_Click
						If nTip_Kl = 2
							Call EditCustCorpsEx(0, ACCESS_FULL, hWndForm, 0, '', 0)
						Else If nTip_Kl = 3
							Call EditCustPersonEx(0, ACCESS_FULL, hWndForm, 0, '', 0)
			Pushbutton: pb_Add_Kli
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.483"
					Top:    0.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set strTip = 'Вибрати останнього Зареєстрованого клієнта'
					On SAM_Click
						If SqlPrepareAndExecute( hSql(),
								 "SELECT substr(pul.Get_Mas_Ini_Val('NEW_RNK'),1,10) into :sTmp FROM dual" )
								and SqlFetchNext( hSql(), nFetchRes )
							If SalStrLength( sTmp ) >0 
								Call F_POISK()
			Pushbutton: pb2 ! Паспорт клиента
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.483"
					Top:    0.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Паспорт клієнта - позичальника'
					On SAM_Click
						If nTip_Kl=2 and CC_FL_ACC = '1'
							Call EditCustCorps( nRNK , CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
						Else If nTip_Kl=3 and CC_FL_ACC = '1'
							Call EditCustPerson( nRNK , CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
						Else If nTip_Kl=2 
							Call EditCustCorps( nRNK , CVIEW_ReadOnly , hWndMDI)
						Else If nTip_Kl=3 
							Call EditCustPerson( nRNK , CVIEW_ReadOnly , hWndMDI)
						! Else If nTip_Kl=1
							                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Call EditCustBanks(dfRNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
			Pushbutton: pbPrcAcc ! Все СЧета
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSwitch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.983"
					Top:    0.905"
					Width:  0.43"
					Width Editable? No
					Height: 0.317"
					Height Editable? No
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Picture File Name: \BARS98\RESOURCE\BMP\Switch.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
				! Message Actions 
					                                                                                                                                                                                                                                                                                                                         On SAM_Create
						                                                                                                                                                                                                                                                                                                                         Set strTip = 'Відкриті рахунки клієнта'
						                                                                                                                                                                                                                                                                                                                         If CC_FL_ACC = '1'
							                                                                                                                                                                                                                                                                                                                         Call SalEnableWindow( pbPrcAcc )
						                                                                                                                                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                                                                                                                                         Call SalDisableWindow( pbPrcAcc )
					                                                                                                                                                                                                                                                                                                                         On SAM_Click
						                                                                                                                                                                                                                                                                                                                         Call ShowCustAccountsEx( nRNK )
			Background Text: Реє.№
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42515
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.983"
					Top:    1.012"
					Width:  0.75"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: nRNK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.783"
						Top:    0.988"
						Width:  1.471"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: ОКПО
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42516
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.483"
					Top:    1.012"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: sOKPO
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.383"
						Top:    0.988"
						Width:  1.571"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: sNMK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.383"
						Top:    1.238"
						Width:  4.883"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Кл.позичальника
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42517
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.983"
					Top:    1.762"
					Width:  2.267"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbFIN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.383"
					Top:    1.988"
					Width:  2.4"
					Width Editable? Class Default
					Height: 1.5"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Финанс.состояние заемщика' )
					On SAM_Create
						Call cmbFIN.Init(hWndItem)
						Call cmbFIN.Populate(hSql(), "FIN","NAME",
								     "STAN_FIN",
								     "ORDER BY FIN")
						If CCK_NBU
							Call SalListSetSelect( cmbFIN, 0 )
							Call SalDisableWindow(cmbFIN)
							Call SalSendMsg(cmbFIN,SAM_Click,0,0)
					On SAM_Click
						Set nFIN = cmbFIN.GetKey(SalListQuerySelection(hWndItem))
						Call F_s080(nFIN, nOBS, S080, sRISK )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Обслуг. боргу
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42518
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.883"
					Top:    1.762"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbOBS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   9.883"
					Top:    1.988"
					Width:  2.4"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Обслужив. долга' )
					On SAM_Create
						Call cmbOBS.Init(hWndItem)
						Call cmbOBS.Populate(hSql(), "OBS","NAME", "STAN_OBS"," ORDER BY OBS ")
						If CCK_NBU
							Call SalListSetSelect( cmbOBS, 0 )
							Call SalDisableWindow(cmbOBS)
							Call SalSendMsg(cmbOBS,SAM_Click,0,0)
					On SAM_Click
						Set nOBS = cmbOBS.GetKey(SalListQuerySelection(hWndItem))
						Call F_s080(nFIN, nOBS, S080, sRISK )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Ризик (S080)
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42519
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.983"
					Top:    1.762"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: sRISK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.283"
						Top:    1.988"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: S080
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 1
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    1.988"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Check Box: cb_Email
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Email
				Window Location and Size
					Left:   6.383"
					Top:    1.488"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сохранить Email для рассылки инф.сообщений' )
			Combo Box: cmb_Email
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.383"
					Top:    1.488"
					Width:  4.883"
					Width Editable? Yes
					Height: 1.964"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						If CCK_NBU
							Call SalDisableWindow(cmb_Email)
			!
			Data Field: dfPROC
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.483"
						Top:    2.821"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Годовая % Ставка по договору' )
			Pushbutton: pb_BR
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbFilter
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.883"
					Top:    2.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Вибрати базову ставку'
						Set nBR_ID = NUMBER_Null
					On SAM_Click
						Set sTmp=STRING_Null
						Set nBR_ID = NUMBER_Null
						Call FunNSIGetFiltered ("BRATES","NAME",
								"BR_ID in (select br_id from BR_NORMAL where kv=" || Str(nKV) || ") ORDER BY BR_ID desc" , sTmp, sBR_ID )
						If sTmp !=STRING_Null
							Set nBR_ID = Val(sTmp)
							If SqlPrepareAndExecute( hSql(), 
									"SELECT RATE INTO :dfPROC FROM BR_NORMAL b 
									 WHERE b.kv=:nKV and b.BR_ID=:nBR_ID and (b.BR_ID,b.KV,b.BDATE) = 
									 (select BR_ID,KV,max(BDATE) from BR_NORMAL 
									  where BR_ID=b.BR_ID and kv=b.KV and bdate<=:bDat GROUP BY BR_ID,KV) ") 
									and NOT SqlFetchNext( hSql(), nFetchRes )
								Set dfPROC = NUMBER_Null
			Data Field: nBR_ID
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.55"
						Top:    3.238"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Код Базовой ставки')
			Data Field: sBR_ID
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.783"
						Top:    2.821"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Наименование Базовой ставки')
			Background Text: Валюти і ставки
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42485
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.75"
					Top:    2.643"
					Width:  1.933"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbBasey
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   8.783"
					Top:    3.274"
					Width:  2.4"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Процентная база' )
					On SAM_Create
						Call cmbBasey.Init(hWndItem)
						Call cmbBasey.Populate(hSql(), "BASEY", "NAME", "BASEY", " ORDER BY BASEY ")
					On SAM_Click
						Set nBasey = cmbBasey.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Періодичність
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42489
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.0"
					Top:    1.35"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbFREQP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   5.0"
					Top:    1.6"
					Width:  2.8"
					Width Editable? Class Default
					Height: 2.119"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Периодичность Погашения %%' )
					On SAM_Create
						Call cmbFREQP.Init(hWndItem)
						Call cmbFREQP.Populate(hSql(), "FREQ", "NAME",  "FREQ", " ORDER BY FREQ desc ")
					On SAM_Click
						Set nFREQP = cmbFREQP.GetKey(SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: dfDen
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.4"
						Top:    2.65"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dfDen <1 or dfDen>31
							Return VALIDATE_Cancel
			Background Text: День
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42488
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    2.4"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Перша платіжна дата
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 4389
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.2"
					Top:    2.4"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DATNP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.2"
						Top:    2.65"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DATNP < DAT3
							Call Debug ('Дата погашення менше дати видачі')
							Return VALIDATE_Cancel
						! Set DATNP = CorrectDate(n980, DATNP, DATNP +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата першого погашення основного боргу (відсотків*) ' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			!
			Background Text: Періодичність
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42499
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.586"
					Top:    1.345"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbFREQ
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.4"
					Top:    1.6"
					Width:  2.8"
					Width Editable? Class Default
					Height: 1.964"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Погашение' )
					On SAM_Create
						Call cmbFREQ.Init(hWndItem)
						Call cmbFREQ.Populate(hSql(), "FREQ", "NAME",  "FREQ", " ORDER BY FREQ desc ")
					On SAM_Click
						Set nFREQ = cmbFREQ.GetKey(SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Group Box: "Канікули"
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 49442
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    3.1"
					Width:  4.5"
					Width Editable? Yes
					Height: 0.65"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rb_KY
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.Есть
				Window Location and Size
					Left:   0.4"
					Top:    3.35"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_KN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Нет
				Window Location and Size
					Left:   1.7"
					Top:    3.35"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			!
			Data Field: tNLS_NSMEP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    4.095"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Gray
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS_NSMEP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    4.071"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, tNLS_NSMEP )
					On SAM_SetFocus
						If NLS_NSMEP = STRING_Null and DEAL1.nRNK !=NUMBER_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT a.acc, a.nms, a.nls into :ACC_NSMEP, :NMS_NSMEP ,:NLS_NSMEP 
									 from accounts a, cust_acc c  WHERE kv=:nKV and a.acc=c.acc and c.rnk=:DEAL1.nRNK
									  and a.dazs is null and a.nls like '9%' and a.nbs = '8021' and a.tip='CRC' ") 
									and not SqlFetchNext( hSql(), nFetchRes )
								Set NMS_NSMEP = STRING_Null
					On SAM_Validate
						If NLS_NSMEP !=STRING_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT acc, nms into :ACC_NSMEP, :NMS_NSMEP 
									 from accounts WHERE kv=:nKV and nls=:NLS_NSMEP 
									  and dazs is null and nls like '9%' and nbs ='8021' and tip='CRC' ") 
									and not SqlFetchNext( hSql(), nFetchRes )
								Call MessageError( sNSMEP||NLS_NSMEP )
								Set NMS_NSMEP = sNSMEP
								Return VALIDATE_Cancel
			Data Field: NMS_NSMEP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.683"
						Top:    4.095"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Gray
					Input Mask: Unformatted
				Message Actions
			!
			! Background Text: Галузь (S260)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.483"
					Top:    3.679"
					Width:  1.817"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
.end
			! Combo Box: MS_NX
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.083"
					Top:    3.655"
					Width:  4.3"
					Width Editable? Yes
					Height: 2.119"
					Height Editable? Yes
				Visible? No
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? No
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
.end
				                                                                                                                                                                                                                                                                    List Initialization 
				                                                                                                                                                                                                                                                                    Message Actions 
					                                                                                                                                                                                                                                                                    On SAM_Create
						                                                                                                                                                                                                                                                                    If SqlPrepareAndExecute(  hSqlAux(), "SELECT name,s260 from MS_NX_K where ("||Str(nTip_Kl)||"=2  and s260='08') or ("||Str(nTip_Kl)||"=3 and s260 not in '08' )
								ORDER BY id INTO :sTmpM,:s260 " )
							                                                                                                                                                                                                                                                                    Set nTmp=0
							                                                                                                                                                                                                                                                                    Call SalArraySetUpperBound(m260, 1, -1)
							                                                                                                                                                                                                                                                                    Call SalListClear(hWndItem)
							                                                                                                                                                                                                                                                                    While SqlFetchNext(  hSqlAux(), nFetchRes )
								                                                                                                                                                                                                                                                                    Call SalListAdd( MS_NX, sTmpM )
								                                                                                                                                                                                                                                                                    Set m260[nTmp] = s260
								                                                                                                                                                                                                                                                                    Set nTmp = nTmp + 1
							                                                                                                                                                                                                                                                                    If MS_NX_K = STRING_Null
								                                                                                                                                                                                                                                                                    Set CC_INIC = sTmpM
							                                                                                                                                                                                                                                                                    Set MS_NX = MS_NX_K
						                                                                                                                                                                                                                                                                    If CCK_NBU
							                                                                                                                                                                                                                                                                    Call SalListSetSelect( MS_NX, 0 )
							                                                                                                                                                                                                                                                                    Call SalDisableWindow(MS_NX)
					                                                                                                                                                                                                                                                                    On SAM_AnyEdit
						                                                                                                                                                                                                                                                                    If SalListQuerySelection(hWndItem) >=0
							                                                                                                                                                                                                                                                                    Set s260=m260[SalListQuerySelection(hWndItem)]
					                                                                                                                                                                                                                                                                    On SAM_Click
						                                                                                                                                                                                                                                                                    If SalListQuerySelection(hWndItem) >=0
							                                                                                                                                                                                                                                                                    Set s260=m260[SalListQuerySelection(hWndItem)]
							! Call Debug(m260[SalListQuerySelection(hWndItem)])
			!
			Background Text: Пл. інструкції
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 11434
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    4.345"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: nBANK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    4.321"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set dNB = GetValueStr( "SELECT nb FROM banks WHERE mfo=" || Str(nBANK) )
						Set NLS = ''
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'МФО' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: dNB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.983"
						Top:    4.321"
						Width:  5.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.583"
						Top:    4.321"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If NLS != STRING_Null
							If Vkrz2(Str(nBANK),NLS) != NLS
								Return VALIDATE_Cancel
							If nBANK = Val(GetBankMfo())
								If SqlPrepareAndExecute( hSql(),
										  "SELECT nms INTO :NMS FROM accounts
										   WHERE kv=:nKV and nls=:NLS and dazs is null " )
										and not SqlFetchNext( hSql(), nFetchRes)
									Set NMS='Не открыт !'
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Счет для перечисления' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: NMS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    4.571"
						Width:  10.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: PL_INS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.583"
					Top:    4.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Додаткові пл.інструкції по перерахуванню безгот.коштів'
					On SAM_Click
						If ND = NUMBER_Null
							Call FunNSIEditF ("ADD_PL_INS",0 ) 
						Else
							If SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'ND', Str(ND) , 'Реф КД' )" )
								! Call FunNSIEditF("CCK_PL_INS1[NSIFUNCTION]",2)
								Call FunNSIEditFFiltered ("CCK_PL_INS",0, "nd = " || Str(ND) ) 
						! Вставляем во врем таблл, если еще нет ND
			! Child Table: tbl_DOP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.821"
						Width:  12.4"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
.end
				                                                     Contents 
					                                                     Column: TAG
						                                                     List Values 
						                                                     Message Actions 
					                                                     Column: NAME
						                                                     List Values 
						                                                     Message Actions 
					                                                     Column: TXT
						                                                     List Values 
						                                                     Message Actions 
							                                                     On SAM_AnyEdit
								                                                     If Table_Name!=STRING_Null and SK_Column!=STRING_Null and FK_Column!=STRING_Null and TXT!=STRING_Null
									                                                     If SqlPrepareAndExecute( hSqlAux2(), 
											 "SELECT min("|| tbl_DOP.FK_Column||"),count("|| tbl_DOP.FK_Column||")  into :new_comment,:count_comment from "||tbl_DOP.Table_Name||" where "||tbl_DOP.SK_Column||"=:tbl_DOP.TXT  and rownum<3" ) 
											and SqlFetchNext(hSqlAux2(), nFetchRes) 
										                                                     If count_comment=1
											                                                     Set tbl_DOP.TXT2=new_comment
										                                                     Else 
											                                                     Set tbl_DOP.TXT2=STRING_Null
								                                                     Else 
									                                                     Set tbl_DOP.TXT2=STRING_Null
					                                                     Column: TXT2
						                                                     List Values 
						                                                     Message Actions 
					                                                     Column: FK_Column
						                                                     List Values 
						                                                     Message Actions 
					                                                     Column: SK_Column
						                                                     List Values 
						                                                     Message Actions 
					                                                     Column: Table_Name
						                                                     List Values 
						                                                     Message Actions 
				                                                     Functions 
					                                                     Function: UPD_DOP
						                                                     Description: 
						                                                     Returns 
							                                                     Boolean: 
						                                                     Parameters 
						                                                     Static Variables 
						                                                     Local variables 
							                                                     Number: nRow
						                                                     Actions 
							                                                     Set nRow = TBL_MinRow
							                                                     While SalTblFindNextRow ( tbl_DOP, nRow, 0, 0)
								                                                     Call SalTblSetContext ( tbl_DOP, nRow )
								                                                     If SalTblQueryRowFlags( tbl_DOP, nRow , ROW_Edited )
									                                                     Call SqlSetLongBindDatatype(3,22)
									                                                     If NOT SqlPLSQLCommand(hSql(), "CCK_APP.SET_ND_TXT(ND,TAG, TXT) " )
										                                                     Return FALSE
									                                                     Call SalTblSetRowFlags( tbl_DOP, nRow, ROW_Edited, FALSE )
									! старый вариант
									! If NOT SqlPrepareAndExecute( hSql(),"DELETE from nd_txt where nd=:ND and tag=:TAG")
										                                                                                                                                                                                                                                                                    Return FALSE
									! If TXT != STRING_Null
										                                                                                                                                                                                                                                                                    Call SqlSetLongBindDatatype(3,22)
										                                                                                                                                                                                                                                                                    If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,:TAG, :TXT)")
											                                                                                                                                                                                                                                                                    Return FALSE
							                                                     Return TRUE
					                                                     Function: Call_Ref_Book_INS
						                                                     Description: 
						                                                     Returns 
						                                                     Parameters 
						                                                     Static Variables 
						                                                     Local variables 
						                                                     Actions 
							                                                     If tbl_DOP.Table_Name != STRING_Null and tbl_DOP.SK_Column != STRING_Null 
								                                                     Set Tmp_TXT=Subs(tbl_DOP.TXT,1,250)
								                                                     If FunNSIGetAltPK(tbl_DOP.Table_Name,tbl_DOP.SK_Column ,tbl_DOP.FK_Column,Tmp_TXT,tbl_DOP.TXT2)>0
									                                                     Set tbl_DOP.TXT=Tmp_TXT
									                                                     Call SalTblSetRowFlags ( tbl_DOP, SalTblQueryContext ( tbl_DOP ), ROW_Edited, TRUE )
							! If tbl_DOP.Table_Name != STRING_Null and tbl_DOP.SK_Column != STRING_Null 
								                                                                                                                                                                                                                                                                                                                                                                             Set Tmp_TXT=Subs(tbl_DOP.TXT,1,250)
								                                                                                                                                                                                                                                                                                                                                                                             If FunNSIGetAltPK(tbl_DOP.Table_Name,tbl_DOP.SK_Column ,tbl_DOP.FK_Column,Tmp_TXT,tbl_DOP.TXT2)>0
									                                                                                                                                                                                                                                                                                                                                                                             Set tbl_DOP.TXT=Tmp_TXT
									                                                                                                                                                                                                                                                                                                                                                                             Call SalTblSetRowFlags ( tbl_DOP, SalTblQueryContext ( tbl_DOP ), ROW_Edited, TRUE )
				                                                     Window Variables 
					                                                     String: new_comment
					                                                     Number: count_comment
					                                                     String: Tmp_TXT
				                                                     Message Actions 
					                                                     On SAM_Create
						                                                     Call SalTblPopulate(hWndForm, hSql(), 
								"SELECT t.tag, t.name, x.txt,table_name, 
								(select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and showretval=1 and  mt.tabname=t.table_name) sk,
								(select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and INSTNSSEMANTIC=1 and  mt.tabname=t.table_name) fk
								INTO :TAG,:NAME,:TXT,:Table_Name,:SK_Column,:FK_Column 
								FROM CC_TAG t, ND_TXT x 
								 WHERE t.TAGTYPE ='CCK'  
								   AND t.tag not in ('AIM','MS_NX','INIC','PAWN','S_SDI','R_CR9','V_CR9','I_CR9','EMAIL','FLAGS','SN8_R',
								                     'DAYSN','DATSN','S260','CCRNG', 'FREQ','FREQP','NOHOP','PAWNL','PROBL','Z_SP')
								   AND t.tag=x.tag (+) AND x.nd (+)=:ND
								 ORDER BY t.tag", 
								TBL_FillAll )
					                                                     On SAM_TblDoDetails
						                                                     If tbl_DOP.Table_Name!=STRING_Null and tbl_DOP.SK_Column!=STRING_Null
							                                                     Call SalEnableWindow( pb_SLV )
						                                                     Else 
							                                                     Call SalDisableWindow( pb_SLV )
					                                                     On SAM_FetchRowDone
						                                                     If tbl_DOP.Table_Name != STRING_Null 
							                                                     Set Tmp_TXT=Subs(tbl_DOP.TXT,1,250)
							                                                     If SqlPrepareAndExecute( hSqlAux2(), 
									 "SELECT min("|| tbl_DOP.FK_Column||") into :tbl_DOP.TXT2 from "||tbl_DOP.Table_Name||" where "||tbl_DOP.SK_Column||"=:Tmp_TXT" ) 
									and SqlFetchNext(hSqlAux2(), nFetchRes) 
							! Call XSalTblSetCellBackColor(colValue, COLOR_LightGray)
							                                                     Call XSalTblSetRowBackColor(tbl_DOP,SalTblQueryContext ( tbl_DOP ),COLOR_LightGray)
					                                                     On SAM_DoubleClick
						                                                     Call Call_Ref_Book_INS()
			Group Box: За попередній
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 49443
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.8"
					Top:    3.1"
					Width:  6.8"
					Width Editable? Yes
					Height: 0.65"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rb_D
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.День
				Window Location and Size
					Left:   5.0"
					Top:    3.35"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_M
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Місяць
				Window Location and Size
					Left:   6.4"
					Top:    3.35"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_I
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.Iнше
				Window Location and Size
					Left:   7.7"
					Top:    3.35"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			! ctb_pbGetValue: pb_SLV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.35"
					Top:    0.429"
					Width:  0.43"
					Width Editable? No
					Height: 0.317"
					Height Editable? No
				Visible? No
				Keyboard Accelerator: F4
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				                                                     Message Actions 
					                                                     On SAM_Create
						                                                     Set strTip = 'Виклик довідника F4'
					                                                     On SAM_Click
						                                                     Call Call_Ref_Book_INS()
			!
			Pushbutton: pb_Kom
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.883"
					Top:    0.571"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\OK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Зберегти умови комісії'
						Call SalDisableWindow( pb_Kom )
					On SAM_Click
						If F_Komm() 
							Call SqlCommitEx( hSql(), strTip || " КД="||Str(ND) )
						Else
							Call SqlRollback( hSql())
			Background Text: Вал
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28784
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.595"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: V_KV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.983"
						Top:    0.571"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Сума 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28783
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.65"
					Top:    0.619"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: V_LIM
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.683"
						Top:    0.595"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Group Box: Початкова, Одноразова
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28781
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    0.905"
					Width:  4.8"
					Width Editable? Yes
					Height: 1.083"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: + Дисконт (ПЛЮС), - Премія(МІНУС)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28798
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.85"
					Top:    1.202"
					Width:  4.333"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Cума
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28782
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.883"
					Top:    1.512"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: S_SDI
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.883"
						Top:    1.488"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Group Box: Щомісячна, Багаторазова
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28789
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    2.429"
					Width:  4.8"
					Width Editable? Yes
					Height: 1.31"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Метод
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28780
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.383"
					Top:    2.702"
					Width:  0.767"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Combo Box: cmbKom
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.883"
					Top:    2.679"
					Width:  3.4"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Метод начисления комиссии' )
					On SAM_Create
						Set nCC_KOM = 0
						Set cmbKom = STRING_Null
						Call SalDisableWindow( dfKOM )
						Call SalDisableWindow( cmbKom )
						If SqlPrepareAndExecute( hSql(),
								"SELECT m.metr, m.name  INTO :nCC_KOM, :cmbKom 
								 FROM params p, int_metr m  WHERE p.par='CC_KOM' and to_char(m.metr)=p.val" )
								and SqlFetchNext( hSql(), nFetchRes )
							Call cmbKom.Init(hWndItem)
							Call cmbKom.Populate(hSql(),
									 "METR", "NAME", "INT_METR", " WHERE METR >=90 ORDER BY METR ")
							Set nKOM = nCC_KOM
							Call cmbKom.SetSelectById( nKOM )
							Call SalEnableWindow( dfKOM )
							Call SalEnableWindow( cmbKom )
					On SAM_Click
						Set nKOM = cmbKom.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: % або сума в залеж-ті від метода
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28786
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.383"
					Top:    3.036"
					Width:  2.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfKOM
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.883"
						Top:    3.012"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Месячная % ст комиссии по договору' )
			!
			Group Box: Комісія за НЕВИКОРИСТАНИЙ ліміт
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28788
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    3.845"
					Width:  4.8"
					Width Editable? Yes
					Height: 1.167"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Вал. комісійного рахунку
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28802
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.133"
					Top:    2.155"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: % 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 28785
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.683"
					Top:    4.619"
					Width:  0.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: R_CR9
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.883"
						Top:    4.595"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Годовая % ст комиссии (для 9129)' )
			Radio Button: rb_V
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.Відновлюваний
				Window Location and Size
					Left:   2.983"
					Top:    4.345"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set rb_V = TRUE
						Set rb_N = FALSE
			Radio Button: rb_N
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Невідновлюваний
				Window Location and Size
					Left:   2.983"
					Top:    4.595"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Dark Gray
				Background Color: Default
				Message Actions
			Group Box: Пеня
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 16001
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.55"
					Top:    0.905"
					Width:  4.8"
					Width Editable? Yes
					Height: 1.083"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Check Box: cb_SN8_Enable
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Базовая ставка пени
				Window Location and Size
					Left:   5.7"
					Top:    1.155"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Використовувати базову ставку пені!' )
					On SAM_Click
						If cb_SN8_Enable 
							Call SalDisableWindow(SN8_Pr)
						Else
							Call SalEnableWindow(SN8_Pr)
			Data Field: SN8_Pr
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 1000
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.7"
						Top:    1.488"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: % (річна)
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 16002
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.05"
					Top:    1.512"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 21816
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.82"
					Width:  4.5"
					Width Editable? Yes
					Height: 3.833"
					Height Editable? Yes
				Visible? No
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 21820
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.8"
					Top:    0.821"
					Width:  6.8"
					Width Editable? Yes
					Height: 3.833"
					Height Editable? Yes
				Visible? No
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 21819
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.8"
					Top:    2.0"
					Width:  6.8"
					Width Editable? Yes
					Height: 1.74"
					Height Editable? Yes
				Visible? No
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: dfDenSN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.0"
						Top:    2.65"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dfDenSN <1 or dfDenSN>31
							Return VALIDATE_Cancel
			Data Field: DATNPSN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.8"
						Top:    2.65"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DATNPSN < DAT3
							Call Debug ('Помилкова дата')
						! Set DATNPSN = CorrectDate(n980, DATNPSN, DATNPSN +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала погашения %%' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Check Box: cb_SN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначити погашення % у відмінні дні від основного боргу
				Window Location and Size
					Left:   5.0"
					Top:    2.1"
					Width:  5.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If cb_SN
							Call SalEnableWindow( dfDenSN )
							Call SalEnableWindow( DATNPSN)
						Else
							Call SalDisableWindow( dfDenSN )
							Call SalDisableWindow( DATNPSN )
			Background Text: Погашення основного боргу
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 21818
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.0"
					Width:  4.3"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? No
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Погашення процентного боргу
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 21817
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.9"
					Top:    1.0"
					Width:  6.5"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? No
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: DAT3_Double
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cFieldLabel
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Date/Time
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    0.19"
						Width:  1.2"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Justify: Class Default
					Format: dd-MM-yyyy
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Дата видачі КД:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 9040
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.733"
					Top:    0.19"
					Width:  1.65"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: День
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 9043
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.0"
					Top:    2.4"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Перша платіжна дата
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 4388
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.8"
					Top:    2.4"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: nKV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.683"
						Top:    2.821"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfKV1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.683"
						Top:    3.071"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.483"
						Top:    3.071"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.683"
						Top:    3.321"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.483"
						Top:    3.321"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV3
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.683"
						Top:    3.571"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC3
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.483"
						Top:    3.571"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV4
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.683"
						Top:    3.821"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC4
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.483"
						Top:    3.821"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Background Text: База нарахування
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 51768
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.783"
					Top:    3.095"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Базова ставка
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 51769
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.383"
					Top:    2.679"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Відсотки
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42867
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.583"
					Top:    2.405"
					Width:  5.9"
					Width Editable? Yes
					Height: 1.667"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Продукт
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42870
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.45"
					Top:    2.869"
					Width:  0.967"
					Width Editable? Yes
					Height: 0.202"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbRANG
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.2"
					Top:    0.46"
					Width:  8.4"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Шаблони послідовноті разбора рахунку погашення (SG) КД' )
					On SAM_Create
						Call cmbRANG.Init(hWndItem)
						Call cmbRANG.Populate(hSql(), "RANG", "NAME",  "CC_RANG_NAME", "WHERE (d_close<gl.bd or d_close is null) and (custtype is null or  custtype="||Str(nTip_Kl)||") ")
					On SAM_Click
						Set nRANG = cmbRANG.GetKey(SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Шаблон погашення рахунку "SG"
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 837
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.52"
					Width:  2.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: За дострокове погашення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 47667
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.567"
					Top:    2.024"
					Width:  4.8"
					Width Editable? Yes
					Height: 0.571"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: SK4_Pr
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 1000
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.7"
						Top:    2.25"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: % 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 47668
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.05"
					Top:    2.274"
					Width:  0.483"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbV_CR9
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.583"
					Top:    2.095"
					Width:  2.45"
					Width Editable? Class Default
					Height: 2.274"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Валюта комісійного рахунку' )
					On SAM_Create
						Call cmbV_CR9.Init(hWndItem)
						If CCK_NBU
							! Населяю только по определенному значению и дизейблю
							Call cmbV_CR9.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " WHERE kv=980 " )
							Set V_CR9=n980
							Call cmbV_CR9.SetSelectById( V_CR9 )
							Call SalDisableWindow(cmbV_CR9)
						Else
							Call cmbV_CR9.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " ORDER BY skv " )
							Call cmbV_CR9.SetSelectById( V_CR9 )
						! Можно было сделать так: тогда населилось бы всем, но подставилось с окошко опеределенное
							                                                                                                                                                                                                                                                                                                                                                                                                                                Call cmbKV.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " ORDER BY skv " )
							                                                                                                                                                                                                                                                                                                                                                                                                                                If CCK_NBU
								                                                                                                                                                                                                                                                                                                                                                                                                                                Call cmbKV.SetSelectById( 980 )
					On SAM_Click
						Set V_CR9 = cmbV_CR9.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Тип врегулювання ДНЯ погашення:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 2820
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    4.0"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: CC_DAYNP_NAME
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.4"
						Top:    4.3"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Месячная % ст комиссии по договору' )
		Functions
			Function: F_POISK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nCust
					String: sEmail
					Number: nTmpFIN
				Actions
					If sTmp !=STRING_Null
						Set nRNK=NUMBER_Null
						Set sOKPO=STRING_Null
						Set nTmpFIN = nFIN
						If not CCK_NBU
							Set nFIN=NUMBER_Null
							Set cmbFIN=STRING_Null
						If SqlPrepareAndExecute( hSql(),
								 "SELECT a.nmk, a.rnk, a.okpo, a.CRISK, a.custtype 
								  INTO :sNMK, :nRNK, :sOKPO, :nFIN, :nCust
								  FROM customer a  WHERE a.rnk="||sTmp )
								and SqlFetchNext( hSql(), nFetchRes )
							If nFIN  !=NUMBER_Null
								If SqlPrepareAndExecute( hSql(),
										 "SELECT f.NAME INTO :cmbFIN FROM STAN_FIN f  WHERE f.fin =:nFIN " )
										and SqlFetchNext( hSql(), nFetchRes )
							! Для НБУ, если customer.crisk не заполнен, восстанавливаем умолчательное значение
							Else If CCK_NBU
								Set nFIN = nTmpFIN
							If nKV !=NUMBER_Null
								If SqlPrepareAndExecute( hSql(),
										 "SELECT a.nls,a.nms INTO :NLS, :NMS FROM cust_acc cu, accounts a
										  WHERE cu.rnk=:nRNK and a.acc=cu.acc AND a.kv=:nKV and
										         a.nbs like '2600%' and a.dazs IS NULL")
										and NOT SqlFetchNext( hSql(), nFetchRes )
									! If SqlPrepareAndExecute( hSql(),
											 "SELECT f.MFO, f.NLS, f.NAME, b.NB
											  INTO :nBANK, :NLS, :NMS, :dNB
											  FROM FOREX_ALIEN f, banks b
											  where f.OKPO =:sOKPO and f.kv=:nKV and f.mfo=b.mfo")
											and NOT SqlFetchNext( hSql(), nFetchRes )
									If SqlPrepareAndExecute( hSql(),
											 "SELECT f.MFO, ' ', f.NAME, b.NB
											  INTO :nBANK, :NLS, :NMS, :dNB
											  FROM FOREX_ALIEN f, banks b
											  where f.OKPO =:sOKPO and f.kv=:nKV and f.mfo=b.mfo")
											and NOT SqlFetchNext( hSql(), nFetchRes )
							Call SalEnableWindow( pb2 )
							Call SalListClear( cmb_Email )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT m.SAB INTO :sEmail FROM 
									 (select substr(c.E_MAIL,1,100) SAB from corps c where c.rnk=:nRNK 
									  union all select substr(w.VALUE,1,100) from customerw  w where w.rnk=:nRNK and w.tag='EMAIL' 
									  union all select substr(n.txt,1,100) from nd_txt n, cc_deal d where n.tag='EMAIL' and n.nd=d.nd and d.rnk=:nRNK 
									 ) m
									 WHERE m.SAB is not null ") 
								While SqlFetchNext( hSql(), nFetchRes )
									Call SalListAdd( cmb_Email, sEmail )
								Set cmb_Email = sEmail
			Function: F_DEL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Boolean: bOk
				Actions
					Set bOk = 
							    SqlPrepareAndExecute(hSql(), "DELETE FROM cc_add  WHERE nd=:ND") 
							and SqlPrepareAndExecute(hSql(), "DELETE FROM cc_deal WHERE nd=:ND")
					If bOk
						Call SqlCommit(hSql())
						Call MessageNoWait('Произведено удаление реквизитов '
								     || 'КД Реф=' || Str(ND),'Сообщение', 3, 0)
					Else
						Call SqlRollback(hSql())
						Call MessageNoWait('Неуспешная операция при ' ||
								     'удалении реквизитов КД Реф=' || Str(ND),
								     'Ошибка', 0, 1)
					Return bOk
			Function: F_SAVE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Boolean: bOk
					Number: nTmp
					String: FLAGS
					Number: nTmpNd
				Actions
					Call SalWaitCursor(TRUE)
					Call SqlPrepareAndExecute(hSql(), "select count(*) into :nTmpNd from cc_deal where cc_id = :CC_ID and sos > 2 and sos < 15 and sdate = :DAT2")
					Call SqlFetchNext(hSql(), nFetchRes)
					! Делаем проводку на наличие заполненности обяз-ных полей (что бы не таскаться с bOk устанавливаем его FALSE )
					!
					Set bOk=FALSE
					If nRNK  = NUMBER_Null
						Call Debug  ('Не обран позичальник!')
					Else If CC_ID = STRING_Null
						Call Debug  ('Не введений номер договору!')
					Else If nTmpNd > 0
						Call Debug('В портфелі існує/ють' || Str(nTmpNd) || ' договір/договорів з номером ' ||  CC_ID || '! Введіть унікальний номер договору.')
					Else If nS    = NUMBER_Null 
						Call Debug  ('Не введена сума договору!')
					Else If nKV   = NUMBER_Null
						Call Debug  ('Не обрана валюта договору!')
					Else If nFREQ = NUMBER_Null
						Call Debug  ('Не обрана періодичність основного боргу!')
					Else If nFREQP= NUMBER_Null
						Call Debug  ('Не обрана періодичність сплати відсотків!')
					Else If DATNP = DATETIME_Null
						Call Debug  ('Не задана перша дата погашення!')
					Else If nVID  = NUMBER_Null
						Call Debug  ('Не обраний вид договору!')
					Else If dfDen = NUMBER_Null
						Call Debug  ('Не вказаний день погашення!')
					Else If nISTO = NUMBER_Null
						Call Debug  ('Не обрано джерело залучення коштів!')
					Else If Product = STRING_Null
						Call Debug  ('Не обраний код продукту!')
					Else If nFIN  = NUMBER_Null or nFIN   = 0
						Call Debug  ('Не обраний фінансовий стан позичальника!')
					Else If dfPROC= NUMBER_Null or nBasey = NUMBER_Null 
						Call Debug  ('Не обрана процентна ставка або база нарахування по договору!')
					Else If nCEL  = NUMBER_Null
						Call Debug  ('Не обрана ціль кредитування!')
					Else If nRANG = NUMBER_Null
						Call Debug  ('Не обраний шаблон погашення!')
					Else If dfKOM>0  and (nKOM = NUMBER_Null or nKOM=0)
						Call Debug  ('Не обраний метод щомісячної коміссії !')
					Else If dfKOM>0  and (V_CR9= NUMBER_Null or V_CR9=0)
						Call Debug  ('Не обрана валюта коміссійних доходів !')
					Else If R_CR9>0  and (V_CR9= NUMBER_Null or V_CR9=0)
						Call Debug  ('Не обрана валюта коміссійних доходів !')
					Else If cmb_INIC = STRING_Null
						Call Debug  ('Не обрана Ініціатива!')
					Else
						Set nTmp=GetUserId()
						If rb_I = FALSE
							Set FLAGS = Str(rb_KN) || Str(rb_M)
						Else
							Set FLAGS = Str(rb_KN) || '2'
						! !!! создание КД
						If ND = NUMBER_Null
							Set CC_ID = SalStrTrimX(CC_ID)
							If SqlPLSQLCommand( hSql(), "CCK.CC_OPEN 
									     ( ND, nRNK, CC_ID, DAT1, DAT4, DAT2, DAT3, nKV, nS, 
									       nVID, nISTO, nCEL, sProduct, nFIN, nOBS, ml_Aim, nTmp, NLS,
									       nBANK, nFREQ, dfPROC, nBasey, dfDen, DATNP, nFREQP, dfKOM 
									      )"  )
									  and SqlPrepareAndExecute
									( hSql(),
									"select a.acc into :nACC8  from accounts a, nd_acc n
									 where a.acc=n.acc and a.tip ='LIM' and n.nd =" ||Str(ND) 
									 ) 
									and SqlFetchNext( hSql(), nFetchRes)
								Set bOk=TRUE
								Set Fl_=1
						! !!! коррекция КД
						Else
							If SqlPLSQLCommand( hSql(),  "CCK.CC_KOR
									 ( nACC8,ND, nRNK, SalStrTrimX(CC_ID), DAT1, DAT4, DAT2,DAT3,
									   nKV,nS, nVID,nISTO,nCEL,sProduct, nFIN, nOBS, ml_Aim, ml_Pawn, dfKOM,
									   NLS,nBANK,nFREQ,dfPROC,nBasey,dfDen,DATNP, nFREQP )" ) 
								Set bOk=TRUE
								Set Fl_=0
						! !!! Общее для Создания КД и для Коррекции КД 
						If bOk=TRUE and  
								   NOT SqlPLSQLCommand( hSql(),
								"CCK.MULTI_INT_EX
								( ND, nBR_ID, cb_A, dfKV1,dfPROC1,dfKV2,dfPROC2,dfKV3,dfPROC3,dfKV4,dfPROC4)")
							Set bOk=FALSE
							Call Debug ('Пом.CCK.MULTI_INT_EX')
						!
						! If bOk=TRUE and  NOT tbl_DOP.UPD_DOP() 
							                                                     Set bOk=FALSE
							                                                     Call Debug ('Пом.CCK_APP.SET_ND_TXT')
						If bOk=TRUE and 2 = SalSendMsg(hWndNdTxtTab, UM_Update, 0, 0)
							Set bOk=FALSE
							Call Debug ('Пом.CCK_APP.SET_ND_TXT')
						!
						If bOk=TRUE and     NOT F_Komm() 
							Set bOk=FALSE
							Call Debug ('Пом.F_Komm() ')
						!
						Set cmb_Email = SalStrTrimX( cmb_Email )
						If bOk=TRUE and ACC_NSMEP >0 and    NOT SqlPrepareAndExecute( hSql(), 
								"Begin
								   update nd_acc set  acc="||Str(ACC_NSMEP)||" where nd="||Str(ND)||"   and acc="||Str(ACC_NSMEP)||";
								   if SQL%rowcount = 0 then
								      INSERT INTO nd_acc(nd,acc) Values ( "||Str(ND)||", "||Str(ACC_NSMEP)||");
								   end if;
								 End; ")
							Set bOk=FALSE
							Call Debug ('Пом.update update nd_acc . . .')
						If bOk = TRUE and NOT SqlPrepareAndExecute( hSql(), 
								"Begin
								   update cc_deal set PROD='"||Product||"' ,fin=" || Str(nFIN)|| " where nd="||Str(ND)||";
								   CCK_APP.SET_ND_TXT("|| Str(ND) || ",'INIC','"  || cmb_INIC || "');
								   CCK_APP.SET_ND_TXT("|| Str(ND) || ",'FLAGS','" || FLAGS    || "');
								   CCK_APP.SET_ND_TXT("|| Str(ND) || ",'EMAIL','" || cmb_Email|| "');
								   CCK_APP.SET_ND_TXT("|| Str(ND) || ",'CCRNG','" ||Str(nRANG)|| "');
								 End; ") 
							Set bOk=FALSE
							Call Debug ('Пом.update cc_deal . . .')
						If bOk=TRUE and NOT SqlPrepareAndExecute( hSql(),
								"Begin
								   update nd_txt set txt=( select s260 from cc_potra where id='"||Product||"' )  where tag='S260' and nd="||Str(ND)||";
								   if SQL%rowcount = 0 then
								      INSERT INTO nd_txt (ND,TAG,TXT) values("||Str(ND)||", 'S260',( select s260 from cc_potra where id='"||Product||"' ) ) ;
								   end if;
								 End; ")
							! Set bOk=FALSE
							Call Debug ('Пом.update nd_txt . . .S260')
						!
						If bOk =TRUE and SqlCommitEx( hSql(),'Открыт КД.'|| DEAL1.CC_ID )
							If SqlPrepareAndExecute( hSql(), 
									    "SELECT substr(cck.NLS0(:DEAL1.ND,'SS '),1,15),
									            substr(cck.NLS0(:DEAL1.ND,'SN '),1,15), 
									            months_between(:DEAL1.DAT4,:DEAL1.DAT2)
									     INTO :DEAL1.NLS_SS, :DEAL1.NLS_SN, :DEAL1.nSrok FROM dual " ) 
									and SqlFetchNext( hSql(), nFetchRes)  
							Call MessageNoWait('Cохранение реквизитов КД '||DEAL1.CC_ID||' Реф='||Str(DEAL1.ND),'Сообщение',3,0)
							Call SalEnableWindow( pb_Viza1 )
							Call SalEnableWindow( pb_Kom )
						Else
							Call SqlRollback(hSql())
							If Fl_=1
								Set ND    =NUMBER_Null
							Call MessageNoWait('Неуспешное сохранение КД '||CC_ID, 'Ошибка', 0, 1)
						!
						Call SalWaitCursor(FALSE)
					If bOk
						! Так надо!!!
						If picTabs.GetTop() = 3
							Call picTabs.BringToTop(2,TRUE)
							Call picTabs.BringToTop(3,TRUE)
					Return bOk
			Function: F_ZAY
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Boolean: bOk
					Number: nTmp
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT to_char(rnk) INTO :sTmp from cc_zay where nz=:ND ")
							and SqlFetchNext( hSql(), nFetchRes )
						Call F_POISK()
			Function: F_START_NEW
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Set ND    =NUMBER_Null
					!
					If not CCK_NBU
						If CC_SOUR != NUMBER_Null
							Set nISTO =CC_SOUR
							Call cmbSOUR.SetSelectById( CC_SOUR )
						Else
							Set nISTO =NUMBER_Null
							Set cmbSOUR=STRING_Null
					!
					If not CCK_NBU
						If CC_AIM != NUMBER_Null
							Set nCEL =CC_AIM
							Call cmbAIM.SetSelectById( CC_AIM )
						Else
							Set nCEL =NUMBER_Null
							Set cmbAIM=STRING_Null
					!
					If CC_FREQ != NUMBER_Null
						Set nFREQ = CC_FREQ
						Call cmbFREQ.SetSelectById( CC_FREQ )
					Else
						Set nFREQ = NUMBER_Null
						Set cmbFREQ=STRING_Null
					!
					If CC_FREQP != NUMBER_Null
						Set nFREQP = CC_FREQP
						Call cmbFREQP.SetSelectById( CC_FREQP )
					Else
						Set nFREQP = NUMBER_Null
						Set cmbFREQP=STRING_Null
					!
					Set nRNK  =NUMBER_Null
					Set sNMK  =STRING_Null
					Set CC_ID =STRING_Null
					Set nS    =NUMBER_Null
					Set DAT1 = GetBankDate()
					Set DAT2 = DAT1
					Set DAT3 = DAT1
					Set DAT4 = AddMonths( DAT1, 12 ) 
					! Set DAT4 = AddMonths( DAT1, 12 ) - 1
					! Set DAT4 = CorrectDate(n980, DAT4, DAT4 -1 )
					Set DAT3_Double=DAT3
					!
					If not CCK_NBU
						If CC_KV != NUMBER_Null
							Set nKV = CC_KV
							Call cmbKV.SetSelectById( CC_KV )
							Call SalSendMsg( cmbKV, SAM_Click, 0, 0 )
						Else
							Set nKV   = NUMBER_Null
							Set cmbKV = STRING_Null
					! cmbOBS
					If not CCK_NBU
						If CC_OBS != NUMBER_Null
							Set nOBS =CC_OBS
							Call cmbOBS.SetSelectById( CC_OBS )
						Else
							Set nOBS =NUMBER_Null
							Set cmbOBS=STRING_Null
					! cmbVID
					If CC_VIDD != NUMBER_Null
						Set nVID =CC_VIDD
						Call cmbVID.SetSelectById( CC_VIDD )
					Else
						Set nVID =NUMBER_Null
						Set cmbVID=STRING_Null
					!
					If not CCK_NBU
						Set nBANK= SalStrToNumber( GetBankMfo())
					!
					! RANG_DEF  может иметь вид одного числа или 2-ч чисел раз запятой     1,2       (для ФЛ, ЮЛ)
					Call SET_RANG_DEF()
					! ----------------------- RANG
					!
					Set dNB=GetBankName()
					Set NLS   =STRING_Null
					Call SalEnableWindow(pbSAVE)
					Call SalDisableWindow(pbDEL)
					Call SalDisableWindow(pbPar)
					Call SalDisableWindow(pb_Lim)
					Call SalDisableWindow(pb_MOS)
					!
					If SqlPrepareAndExecute( hSql(), 
							  "SELECT p.txt  INTO :CC_DAYNP_NAME
							   FROM  V_CC_DAYNP p where p.kod=:CC_DAYNP"  ) 
							and SqlFetchNext(hSql(), nFetchRes) 
					Return TRUE
			Function: F_START_KOR
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: i
					Number: nSos
					Number: nTmp_Kv
					Number: nTmp_Int
					String: sTmp_Basey
					String: sTag
					String: sNBS
					String: sTxt
					String: nLen
					String: sKv
					String: sEmail
				Actions
					! все о договоре
					Set sTochkaY=SalStrMidX(SalNumberToStrX(1.1,1),1,1)
					!
					Call SalDisableWindow(pb_New_Kli)
					Call SalDisableWindow(pb_Add_Kli)
					Call SalDisableWindow(pbKlient)
					Set nRANG=NUMBER_Null
					!
					If SqlPrepareAndExecute( hSql(),
							  "SELECT c.rnk    , c.okpo    , nvl(d.FIN,c.crisk),f.name, d.obs      , o.name    ,
							         ad.kv     , t.name    , nvl(d.sdog,d.limit)      , d.sdate    , ad.bdate  , ad.wdate  , ad.wdate,
							         d.wdate   , ad.freq   , q.name      , a.acc      ,ad.mfokred+0, ad.acckred,
							         ad.sour   , ad.aim    , s.name      , i.name     , d.vidd     , v.name    ,
							         d.cc_id   , c.nmk     , b.nb        , d.prod     , d.sos
							   INTO :DEAL1.nRNK ,:DEAL1.sOKPO,:DEAL1.nFIN   ,:DEAL1.cmbFIN,:DEAL1.nOBS  ,:DEAL1.cmbOBS, 
							        :DEAL1.nKV  ,:DEAL1.cmbKV,:DEAL1.nS     ,:DEAL1.DAT1  ,:DEAL1.DAT2  ,:DEAL1.DAT3  , :DEAL1.DAT3_Double,
							        :DEAL1.DAT4 ,:DEAL1.nFREQ,:DEAL1.cmbFREQ,:DEAL1.nACC8 ,:DEAL1.nBANK ,:DEAL1.NLS   ,
							        :DEAL1.nISTO,:DEAL1.nCEL ,:DEAL1.cmbSOUR,:DEAL1.cmbAIM,:DEAL1.nVID  ,:DEAL1.cmbVID,
							        :DEAL1.CC_ID,:DEAL1.sNMK ,:DEAL1.dNB, :DEAL1.Product  ,:nSos
							   FROM customer C, stan_fin F, stan_obs O, cc_deal D, cc_add AD, tabval T, 
							       cc_source S, cc_aim   I, cc_vidd  V, accounts A, banks  B, freq   Q, nd_acc N  
							   WHERE d.nd = :DEAL1.ND  and N.nd = d.nd and a.tip = 'LIM'  and n.acc = a.acc  
							     and d.nd = ad.nd and ad.adds=0 and d.rnk=c.rnk and a.kv=t.kv and a.kv=ad.kv 
							     and ad.freq = q.freq (+) 
							     and c.crisk = f.fin  (+) 
							     and d.obs   =  o.obs (+) 
							     and ad.mfokred=b.mfo (+) 
							     and ad.sour = s.sour (+) 
							     and ad.aim  = i.aim  (+) 
							     and d.vidd  = v.vidd (+) 
							    " )
							and SqlFetchNext(hSql(), nFetchRes) 
						! А можно ли корр ?
						If nSos >1
							Call SalDisableWindow( pbSAVE )
							Call SalDisableWindow( pb_Viza1 )
						Else
							Call SalEnableWindow( pbSAVE )
							Call SalEnableWindow( pb_Viza1 )
						! на время миграции
						If CCK_MIGR > GetBankDate()
							Call SalEnableWindow( pbSAVE )
						! Прoдукт
						If SqlPrepareAndExecute( hSql(),
								  "SELECT name INTO :sProduct FROM CC_POTRA where id=:Product ")
								and SqlFetchNext(hSql(), nFetchRes) 
						! % карточка
						If SqlPrepareAndExecute( hSql(),
								  "SELECT n.FREQ, q.name, n.BASEY, y.name, n.S, n.APL_DAT, nvl(n.BASEM,0) 
								   INTO :DEAL1.nFREQP,:DEAL1.cmbFREQP,:DEAL1.nBasey,:DEAL1.cmbBasey,
								        :DEAL1.dfDen,:DEAL1.DATNP, :cb_A 
								   FROM int_accn N, freq Q, basey Y , int_ratn R
								   WHERE n.acc=:DEAL1.nACC8 and n.id=0 and n.freq=q.freq (+) and n.basey=y.basey (+) ")
								and SqlFetchNext(hSql(), nFetchRes) 
						! % ставки
						If SqlPrepareAndExecute( hSql(),
								  "SELECT ir INTO :dfPROC FROM int_ratn WHERE acc=:nACC8 and id=0 
								     and bdat=(select min(bdat) from int_ratn WHERE acc=:nACC8 and id=0) ")
								and SqlFetchNext(hSql(), nFetchRes) 
						If SqlPrepareAndExecute( hSql(),
								  "SELECT r.ir INTO :SK4_Pr FROM int_ratn r, int_accn i
								   WHERE r.acc=i.acc and r.id=i.id and r.acc=:nACC8 and r.id=4 
								     and r.bdat=(select max(bdat) from int_ratn WHERE acc=r.ACC and id=r.id and bdat<=gl.bd) ")
								and SqlFetchNext(hSql(), nFetchRes) 
							Call cmbKom.SetSelectById( nKOM )
							! Set nKOM_OLD = nKOM
						If nBANK = Val(GetBankMfo()) and NLS !=STRING_Null
							If SqlPrepareAndExecute( hSql(),
									  "SELECT nms INTO :NMS FROM accounts where kv=:nKV and nls=:NLS ")
									and SqlFetchNext(hSql(), nFetchRes) 
						Call F_s080(DEAL1.nFIN, DEAL1.nOBS, DEAL1.S080, DEAL1.sRISK )
						! ND_TXT
						Call SalListClear( cmb_Email )
						If SqlPrepareAndExecute( hSql(), "SELECT m.SAB INTO :sTxt FROM 
								 (select substr(c.E_MAIL,1,100) SAB from corps c where c.rnk=:nRNK 
								  union all select substr(w.VALUE,1,100) from customerw  w where w.rnk=:nRNK and w.tag='EMAIL' 
								  union all select substr(n.txt,1,100) from nd_txt n, cc_deal d where n.tag='EMAIL' and n.nd=d.nd and d.rnk=:nRNK and n.nd<>:ND 
								 ) m
								 WHERE m.SAB is not null ") 
							While SqlFetchNext( hSql(), nFetchRes )
								Call SalListAdd( cmb_Email, sTxt )
						Set i = 0
						If SqlPrepareAndExecute(hSql(),"SELECT tag,Substr(txt,1,250) INTO :sTag,:sTxt FROM ND_TXT WHERE nd=:ND ")
							While SqlFetchNext( hSql(), nFetchRes )
								If sTag='AIM' 
									Set ml_Aim = sTxt
								! Else If sTag='MS_NX'
									                                                                                                                                                                                                                                                                    Set MS_NX = sTxt
								Else If sTag='S260'
									Set s260 = sTxt
								Else If sTag='INIC'
									Set cmb_INIC = sTxt
								Else If sTag='PAWN'
									Set ml_Pawn = sTxt
								Else If sTag='S_SDI'
									Set sTxt = DEAL1.DecToch(sTxt) 
									Set DEAL1.S_SDI = Val( sTxt )
								Else If sTag='R_CR9'
									Set sTxt = DEAL1.DecToch(sTxt) 
									Set DEAL1.R_CR9 = Val( sTxt )
								Else If sTag='V_CR9'
									Set DEAL1.V_CR9 = Val(sTxt)
									Call cmbV_CR9.SetSelectById(  DEAL1.V_CR9 )
								Else If sTag='I_CR9'
									If sTxt='0'
										Set DEAL1.rb_V = TRUE
										Set DEAL1.rb_N =FALSE
									Else
										Set DEAL1.rb_N = TRUE
										Set DEAL1.rb_V =FALSE
								Else If sTag='EMAIL'
									Call SalListAdd( cmb_Email,sTxt )
									Set cb_Email = TRUE
									Set cmb_Email = sTxt
								Else If Subs(sTag,1,1)='P' 
									Set sKv = Subs(sTag,2,3)
									If SqlPrepareAndExecute( hSqlAux2(),"SELECT kv INTO :nTmp_Kv FROM tabval WHERE to_char(kv)=:sKv ") 
											and SqlFetchNext( hSqlAux2(), nFetchRes)
										Set i = i + 1
										If i = 1
											Set dfKV1   = nTmp_Kv
											Set dfPROC1 = Val(sTxt)
										Else If i = 2
											Set dfKV2   = nTmp_Kv
											Set dfPROC2 = Val(sTxt)
										Else If i = 3
											Set dfKV3   = nTmp_Kv
											Set dfPROC3 = Val(sTxt)
										Else If i = 4
											Set dfKV4   = nTmp_Kv
											Set dfPROC4 = Val(sTxt)
								Else If sTag='FLAGS'
									If Subs(sTxt,1,1)='1'
										Set rb_KN = TRUE
									Else
										Set rb_KY = TRUE
									If Subs(sTxt,2,1)='1'
										Set rb_M = TRUE
									Else If Subs(sTxt,2,1)='0'
										Set rb_D = TRUE
									Else If Subs(sTxt,2,1)='2'
										Set rb_I = TRUE
								Else If sTag='SN8_R'
									Set sTxt = DEAL1.DecToch(sTxt) 
									Set SN8_Pr=Val( sTxt )
									Set cb_SN8_Enable =FALSE
									Call SalEnableWindow(SN8_Pr)
								Else If sTag='CCRNG'
									Call cmbRANG.SetSelectById (Val(sTxt))
									Set nRANG = cmbRANG.GetKey(SalListQuerySelection(cmbRANG))
									If SalListQueryCount ( cmbRANG )>1 or cmbRANG = STRING_Null
										Call SalIsWindowEnabled (cmbRANG)
									Else
										Call SalDisableWindow(cmbRANG)
								Else If sTag='DAYSN'
									Set dfDenSN=Val( sTxt )
									Set cb_SN=TRUE
									Call SalEnableWindow(dfDenSN)
									Call SalEnableWindow( DATNPSN)
								Else If sTag='DATSN'
									Set cb_SN=TRUE
									Set DATNPSN=SalStrToDate( sTxt )
								Else If sTag='DAYNP' and sTxt !=STRING_Null
									Set CC_DAYNP= sTxt 
						If nRANG=NUMBER_Null
							Call SET_RANG_DEF()
						!
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT p.txt  INTO :CC_DAYNP_NAME
								   FROM  V_CC_DAYNP p where p.kod=:CC_DAYNP"  ) 
								and SqlFetchNext(hSql(), nFetchRes) 
					Call NBS_AIM_All(nVID, nCEL, DAT4, DAT1)
					Return TRUE
			Function: NBS_AIM_All
				Description: Получение Ьал сч от цели
				Returns
					String:
				Parameters
					Number: nVID
					Number: nAi
					Date/Time: DAT4
					Date/Time: DAT1
				Static Variables
				Local variables
					Number: nSrok
					String: sNBS
					String: sSqlAim
				Actions
					! определение БС для SS
					If SqlPrepareAndExecute(hSql(),
							  "SELECT months_between(:DAT4, :DAT1) INTO :nSrok FROM dual ")
							and SqlFetchNext(hSql(), nFetchRes)
					Set sSqlAim = 'SELECT '
					If nSrok     <= 12 and nVID < 10 ! короткий ЮЛ
						Set sSqlAim = sSqlAim || 'nbs'
					Else If nSrok > 12 and nVID < 10 ! длиный   ЮЛ
						Set sSqlAim = sSqlAim || 'nbs2'
					Else If nSrok<= 12 and nVID > 10 ! короткий ФЛ
						Set sSqlAim = sSqlAim || 'nbsf'
					Else If nSrok > 12 and nVID > 10 ! длиный   ФЛ
						Set sSqlAim = sSqlAim || 'nbsf2'
					Set sSqlAim = sSqlAim || ' INTO :sNBS FROM cc_aim WHERE aim='||Str(nAi)
					If SqlPrepareAndExecute( hSqlAux(), sSqlAim ) 
							and SqlFetchNext( hSqlAux(), nFetchRes) 
							and SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'NBS_AIM', sNBS, 'Бал.рах по цілі кредиту' )" ) 
					Return sNBS
			Function: F_Komm
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nS
					String: sTmp
				Actions
					If NOT SqlPrepareAndExecute( hSql(), 
							"DELETE from nd_txt where nd=:ND and tag in
							 ('S_SDI','R_CR9','V_CR9','I_CR9','SN8_R','DATSN','DAYSN')")
						Return FALSE
					!
					If S_SDI !=0 
						Set sTmp = SalNumberToStrX( S_SDI, 2 )
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'S_SDI', :sTmp )")
							Return FALSE
					If R_CR9 !=0 
						Set sTmp = SalNumberToStrX( R_CR9, 2 )
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'R_CR9', :sTmp )")
							Return FALSE
					If rb_N or rb_V
						! (0-вiднов.кред.1-невiдновл.кред.)
						Set sTmp = IifS(rb_V,'0','1') 
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'I_CR9', :sTmp )")
							Return FALSE
					If dfKOM >0 
						If NOT SqlPrepareAndExecute( hSql(),"update int_accn  set  METR="||Str(nKOM)||", BASEY=0, FREQ=1 where acc=:nACC8 and id=2  ")
							Return FALSE
					If dfKOM >0 or R_CR9 !=0 
						Set sTmp = Str( V_CR9 ) 
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'V_CR9', :sTmp )")
							Return FALSE
					If SK4_Pr >0 or R_CR9 !=0 
						If NOT SqlPrepareAndExecute( hSql(), "DELETE from int_ratn where acc=:nACC8 and id=4")
							! Return FALSE
						If NOT SqlPrepareAndExecute( hSql(), "DELETE from int_accn where acc=:nACC8 and id=4")
							! Return FALSE
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO int_accn(acc,id,metr,basey,freq,acrb) Values (:nACC8,4,0,0,1, cc_o_nls('8999',:nRNK,:nISTO,:ND,:nKV,'SD4')) ")
							! Return FALSE
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO int_ratn(acc,id,bdat,ir) Values (:nACC8,4,:DAT3,:SK4_Pr )")
							! Return FALSE
					If cb_SN8_Enable = FALSE and SN8_Pr != NUMBER_Null 
						! ! Set sTmp = SalNumberToStrX( SN8_Pr, 4 )
						! ! If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'SN8_R', abs(:sTmp) )")
							                                                                                                                                                                                                                                                      Return FALSE
						Set sTmp =  SalNumberToStrX( SalNumberAbs( SN8_Pr), 4 )
						If NOT SqlPrepareAndExecute( hSql(),
								 "INSERT INTO nd_txt ( nd, tag, txt )
								  Values
								( :ND, 'SN8_R', translate( :sTmp, ',' , '.' )
								 )")
							Return FALSE
					If cb_SN = TRUE and ((dfDenSN != NUMBER_Null and dfDenSN!=dfDen) or (DATNPSN!=DATETIME_Null and DATNP!=DATNPSN) )
						Set sTmp = SalNumberToStrX( dfDenSN, 0 )
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'DAYSN', abs(:sTmp) )")
							Return FALSE
						Set sTmp = SalFmtFormatDateTime(DATNPSN,'dd/MM/yyyy')
						If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:ND,'DATSN', :sTmp )")
							Return FALSE
					Return TRUE
			Function: setFields
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If CC_NSMEP != '1' OR CC_NSMEP = STRING_Null
						Call SalHideWindow( tNLS_NSMEP )
						Call SalHideWindow( NLS_NSMEP )
						Call SalHideWindow( NMS_NSMEP )
					Else
						Set tNLS_NSMEP ='№ карт.НСМЕП'
						Set sNSMEP = "Не знайдено картковий рахунок НСМЕП " 
			Function: SET_RANG_DEF
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: RANG_DEF
				Actions
					If nTip_Kl=3
						Set RANG_DEF=SalStrMidX (GetGlobalOption('CC_RANG') ,SalStrScan ( GetGlobalOption('CC_RANG') , ',' )+1,10 )
					Else
						Set RANG_DEF=SalStrLeftX(GetGlobalOption('CC_RANG'),SalStrScan ( GetGlobalOption('CC_RANG') , ',' ))
					If RANG_DEF= STRING_Null
						Set RANG_DEF=GetGlobalOption('CC_RANG')
					Call cmbRANG.SetSelectById (Val(RANG_DEF))
					Set nRANG = cmbRANG.GetKey(SalListQuerySelection(cmbRANG))
					If SalListQueryCount ( cmbRANG )>1 or cmbRANG = STRING_Null
						Call SalIsWindowEnabled (cmbRANG)
					Else
						Call SalDisableWindow(cmbRANG)
			Function: DecToch      ! Корректировка символа "десятичной точки"
				Description:
				Returns
					String:
				Parameters
					String: sTxt
				Static Variables
				Local variables
					String: sTmp
				Actions
					Set sTmp = sTxt
					Set sTmp = VisStrSubstitute( sTmp, ',', sTochkaY )
					Set sTmp = VisStrSubstitute( sTmp, '.', sTochkaY )
					Return sTmp
		Window Parameters
			Number: nTip_Ur
			Number: nTip_Kl
			String: sGr
			String: strPar02
			! Str(hWndForm.cc_dog.ND)
			String: sKV1
			! hWndForm.cc_dog.CC_ID || ' від '|| SalFmtFormatDateTime( hWndForm.cc_dog.DAT1, 'dd/MM/yyyy' )
			String: sKV2
			! hWndForm.cc_dog.NMK
			String: sKV3
		Window Variables
			Number: CC_SOUR
			Number: nACC8
			Number: nCC_KOM ! Метод комиссии по умолчанию 
			Number: nKOM  ! Новый Выбранный Метод комиссии
			Number: V_CR9 ! Валюта для 9129 и для ежемесячной ком. будет одинаковой (пока так) Novikov 
			! Number: nKOM_OLD  ! Старый Выбранный Метод комиссии
			Number: CC_AIM
			Number: CC_FREQ
			Number: CC_FREQP
			Number: CC_KV
			String: CC_NSMEP
			String: CC_OP_KL
			String: CC_DAYNP
			String: sNSMEP 
			! String: Product
			Number: ACC_NSMEP
			!
			String: CC_INIC 
			String: MS_NX_K 
			Number: CC_OBS
			Number: CC_BASEY
			Number: CC_VIDD 
			!
			! String: sTmp1
			String: sTochkaY
			String: sTmpM
			Boolean: bTmp
			Number: nFIN
			Number: nOBS
			Number: nVID
			Number: nFREQ
			Number: nFREQP
			Number: nRANG
			Number: nISTO
			Number: nCEL
			String: sTmp
			String: sTmp2
			String: CC_FL
			Number: nBasey
			Number: nFocusRow
			Number: n980
			Date/Time: bDat
			Boolean: CCK_NBU
			Number: nSK4
			String: m260[*]
			String: s260
			Number: nTmp
			Number: nTmpNd
			!
			Number: nSos_A
			Number: Fl_    !1- Открытие договора  0 - Корректировка
			Number: G_V_CR9   !  Глоб параметр 0 - разрешить выбор 1- нац валюта 2- вал. договора
			!
			Window Handle: hWndNdTxtTab
		Message Actions
			On SAM_Create
				Set DEAL1.ND=Val(sKV1)
				Set CCK_NBU = GetGlobalOption('CCK_NBU') = '1'
				Call SalMapEnterToTab( TRUE )
				Call SalSetWindowText(hWndForm, 'Ввод НОВОГО КД. ' || strPar02 )
				Call ShowApdVersion('02')
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				Call SalWaitCursor( TRUE )
				!
				If CCK_NBU
					Call SalDisableWindow (rb_KN)
					Call SalDisableWindow (rb_KY)
					Call SalDisableWindow(dfDen)
					Call SalDisableWindow(DATNP)
				If GetGlobalOption('CC_GPK')='1'
					Set rb_KN = TRUE
				Else
					Set rb_KY = TRUE
				!
				!
				If GetGlobalOption('ASG-SN') = '1'
					Set rb_M  = TRUE
				Else
					Set rb_D  = TRUE
				!
				If GetGlobalOption('CCPRD') = STRING_Null
					Call SalHideWindow (rb_I)
				If nTip_Kl != 2
					Call SalHideWindow (rb_I)
				If nTip_Kl = 2
					Set G_V_CR9=SalStrToNumber(Subs(GetGlobalOption('CC_VCR9'),1,1))
					! Call Debug(Str(G_V_CR9))
					If G_V_CR9>0 
						Call SalDisableWindow( cmbV_CR9 )
					If G_V_CR9=1 
						Set V_CR9=n980
						Call cmbV_CR9.SetSelectById( V_CR9 )
				If nTip_Kl = 3
					Set G_V_CR9=SalStrToNumber(Subs(GetGlobalOption('CC_VCR9'),2,1))
					! Call Debug(Str(G_V_CR9))
					If G_V_CR9>0 
						Call SalDisableWindow( cmbV_CR9 )
					If G_V_CR9=1 
						Set V_CR9=n980
						Call cmbV_CR9.SetSelectById( V_CR9 )
				!
				Set CC_DAYNP=GetGlobalOption('CC_DAYNP') 
				!
				Set CC_NSMEP = ""
				Set ACC_NSMEP = NUMBER_Null
				If SqlPrepareAndExecute( hSql(),
						  "SELECT 
						TO_NUMBER(pul.Get_Mas_Ini_Val('CC_SOUR')),TO_NUMBER(pul.Get_Mas_Ini_Val('CC_AIM')),
						TO_NUMBER(pul.Get_Mas_Ini_Val('CC_FREQ')),TO_NUMBER(pul.Get_Mas_Ini_Val('CC_KV')),
						TO_NUMBER(pul.Get_Mas_Ini_Val('CC_FREQP')),TO_NUMBER(pul.Get_Mas_Ini_Val('CC_OBS')),
						TO_NUMBER(pul.Get_Mas_Ini_Val('CC_BASEY')),TO_NUMBER(pul.Get_Mas_Ini_Val('CC_VIDD')),
						substr(pul.Get_Mas_Ini_Val('CC_INIC'),1,25),
						substr(pul.Get_Mas_Ini_Val('MS_NX_K'),1,25),
						substr(pul.Get_Mas_Ini_Val('CC_NSMEP'),1,1),
						substr(pul.Get_Mas_Ini_Val('CC_OP_KLI'),1,1) 
						   INTO :CC_SOUR,:CC_AIM,:CC_FREQ,:CC_KV,:CC_FREQP,
						:CC_OBS,:CC_BASEY,:CC_VIDD,:CC_INIC,:MS_NX_K, :CC_NSMEP, :CC_OP_KL
						   from dual " )
						and SqlFetchNext( hSql(), nFetchRes )
				Call setFields()
				! If CC_NSMEP != '1' OR CC_NSMEP = STRING_Null
					                                                                                                                                                                                                                                                                                                                                                                                                                         Call SalHideWindow( tNLS_NSMEP )
					                                                                                                                                                                                                                                                                                                                                                                                                                         Call SalHideWindow( NLS_NSMEP )
					                                                                                                                                                                                                                                                                                                                                                                                                                         Call SalHideWindow( NMS_NSMEP )
				! Else
					                                                                                                                                                                                                                                                                                                                                                                                                                         Set tNLS_NSMEP ='№ карт.НСМЕП'
					                                                                                                                                                                                                                                                                                                                                                                                                                         Set sNSMEP = "Не знайдено картковий рахунок НСМЕП " 
				If CC_OP_KL = '1' 
					Call SalShowWindow( pb_New_Kli )
					Call SalShowWindow( pb_Add_Kli )
				Else
					Call SalHideWindow( pb_New_Kli )
					Call SalHideWindow( pb_Add_Kli )
				If SqlPrepareAndExecute( hSql(),"SELECT val from params where par='CC_FL' and val='1' " )
						and SqlFetchNext( hSql(), nFetchRes )
					Set CC_FL = ' and CUSTOMER.rnk not in (select rnk from DPT_DEPOSIT) '
				Else
					Set CC_FL = ' '
				If SqlPrepareAndExecute( hSql(),"SELECT id from int_idn  where  id=4 " )
						and SqlFetchNext( hSql(), nFetchRes )
					Call SalEnableWindow(SK4_Pr)
				Else
					Call SalDisableWindow(SK4_Pr)
				Set cb_SN8_Enable =TRUE
				Call SalDisableWindow(SN8_Pr)
				Call SalDisableWindow( dfDenSN )
				Call SalDisableWindow( DATNPSN )
			On SAM_Validate
				Call SqlPrepareAndExecute(hSql(), "select count(*) into :nTmpNd from cc_deal where cc_id = :CC_ID")
				Call Debug(Str(nTmpNd))
				! Call SqlFetchNext(hSql(), nFetchRes)
				If nTmpNd > 0
					! Договор с таким номером уже существует!
					Call SalMessageBox(CurrentLangTable.GetAtomTitle('KRE_DEPO.cTMessCcIdAlreadyExists'), CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconExclamation | MB_Ok)
					Return VALIDATE_Cancel
				Return VALIDATE_Ok
			On SAM_CreateComplete
				Set cb_A = 0
				If sKV1 = STRING_Null
					Call F_START_NEW()
					Call SalDisableWindow( pb_Viza1 )
				Else
					Call F_START_KOR()
				If SqlPrepareAndExecute( hSql(),
						"SELECT max(sos) INTO :nSos_A FROM cc_sos where sos<10 ")
						and SqlFetchNext(hSql(), nFetchRes) 
					If nSos_A != 4
						Call SalHideWindow( pb_Viza1 )
				If SqlPrepareAndExecute( hSql(),
						  "SELECT r.ir, i.metr    INTO :dfKOM, :nKOM 
						   FROM int_ratn r, int_accn i
						   WHERE r.acc=i.acc and r.id=i.id and r.acc=:nACC8 and r.id=2 
						     and r.bdat=(select min(bdat) from int_ratn WHERE acc=r.ACC and id=r.id) ")
						and SqlFetchNext(hSql(), nFetchRes) 
					Call cmbKom.SetSelectById( nKOM )
					! Set nKOM_OLD = nKOM
				Call cmbV_CR9.SetSelectById( V_CR9 )
				Call SalWaitCursor( FALSE )
	Table Window: Tbl_GPK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.038"
				Top:    0.406"
				Width:  19.3"
				Width Editable? Class Default
				Height: 6.071"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.94"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: nND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    0.405"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.КД' )
						On SAM_SetFocus
							Set nTmpE = nND
						On SAM_AnyEdit
							Set nND = nTmpE
				Data Field: SUMR_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Новый лимит по КД'  )
						On SAM_Create
							Set SUMR_ = LIM1
						On SAM_Validate
							If SUMR_ < 1 or SUMR_ = NUMBER_Null
								Call Debug('Ош.сумма')
								Return VALIDATE_Cancel
				Data Field: LIM1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.583"
							Top:    0.405"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Текущий лимит по КД' )
				Data Field: DAT3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.583"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Первая Дата выдачи КД' )
				Data Field: BDAT_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата Установки новой суммы лимита ' )
							Set BDAT_1 = GetBankDate()
						On SAM_Validate
							If BDAT_1<GetBankDate()-Call_Last_Day
								Call Debug('Побудова графіка за цей день заборонена')
								Return VALIDATE_Cancel
							If BDAT_1>  FDAT_
								Call Debug('Дата встановлення нового ліміту більше дати погашення')
								Return VALIDATE_Cancel
				Data Field: FDAT_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.655"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата Первого гашения после установки нового лимита' )
						On SAM_Validate
							! Set FDAT_ =  CorrectDate( GetBaseVal(), FDAT_, DAT4)
							If FDAT_ <= BDAT_1 or  FDAT_ >= DAT4
								Call Debug('Ош.дата')
								Return VALIDATE_Cancel
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.583"
							Top:    0.655"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения КД' )
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.486"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.986"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.486"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выровнять общ.сумму,
									 пересчитать %,
									 Сохранить в ГПК и в ГЛК'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.986"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.986"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50315
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.35"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.8"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.25"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50316
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50317
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   13.783"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.262"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    0.655"
							Width:  2.9"
							Width Editable? Yes
							Height: 0.262"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование заемщика' )
				Data Field: RATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.083"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ном.% ставка' )
				!
				Pushbutton: pb_Lim
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.486"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Построение Графика Лимита Кредитования (ГЛК) выбранного КД'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Ur, 13, nND, strPar01, strPar02, '', '', '' )
				Pushbutton: pb_KAL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.986"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр Ожидаемого Графика Погашения Кредита (ГПК) выбранного КД'
						On SAM_Click
							Call Sel017f(hWndMDI,nTip_Ur,14, nND, strPar01, strPar02, '', '', '' )
				Data Field: dSUMO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.433"
							Top:    0.119"
							Width:  1.467"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,'
									Общая сумма гашения (Гр.4)
									или сумма гашения тела (Гр.2)
									для всех дат' )
				Frame
					Resource Id: 50318
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.083"
						Top:    0.071"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.31"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по Гр.2
					Window Location and Size
						Left:   6.183"
						Top:    0.119"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call RB24()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Погашення рівними частинами') 
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по Гр.4
					Window Location and Size
						Left:   7.383"
						Top:    0.119"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call RB24()
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ануітетними платежами') 
				Background Text: ГПК
					Resource Id: 50319
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   10.883"
						Top:    0.429"
						Width:  1.283"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? No
					Justify: Right
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold-Italic-Underline
					Text Color: Red
					Background Color: Default
				!
				Combo Box: cmbFREQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.083"
						Top:    0.655"
						Width:  1.5"
						Width Editable? Class Default
						Height: 2.274"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If nND <= 0
								Call cmbFREQ.Init(hWndItem)
								Call cmbFREQ.Populate(hSql(), "FREQ", "NAME", "FREQ", " ORDER BY FREQ ")
								Set nFreq = 5
							Else
								Call SalDisableWindow( cmbFREQ )
						On SAM_Click
							Set nFreq = cmbFREQ.GetKey(SalListQuerySelection(hWndItem))
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, ' Периодичность погашения ' )
						On SAM_SetFocus
							Call SalMapEnterToTab( TRUE )
				Combo Box: cmbBasey
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.083"
						Top:    0.405"
						Width:  1.5"
						Width Editable? Class Default
						Height: 1.5"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: 35
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If nND <= 0
								Call cmbBasey.Init(hWndItem)
								Call cmbBasey.Populate(hSql(), "BASEY", "NAME", "BASEY", " ORDER BY BASEY ")
								Set nBasey = 0
							Else
								Call SalDisableWindow( cmbBasey )
							! Call SalSendMsg( cmbBasey, SAM_Click, 0, 0 )
						On SAM_Click
							Set nBasey = cmbBasey.GetKey( SalListQuerySelection(hWndItem))
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Процентная база' )
						On SAM_SetFocus
							Call SalMapEnterToTab( TRUE )
				Pushbutton: pbRazbyt
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.486"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Recycle.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Разбить'
						On SAM_Click
							If FDAT_ != DATETIME_Null
								Set nSel = 0
								If cb_A = 1
									Set nSel = 3 
								Else If SalModalDialog(dlg_GPK, hWndForm, nSel, nDig ) = 1
								!
								! Call Debug('1) nSel='|| Str(nSel) || ' SUMR_= '||Str(SUMR_) )
								If nSel > 0 and SUMR_ != NUMBER_Null
									Call SalWaitCursor(TRUE)
									If nPar >0
										If SqlPLSQLCommand(hSql() ,"CCK.CC_GPK (nSel,nND,nAcc8,BDAT_1,FDAT_,DAT4,SUMR_,nFreq,RATE,nDig ) " ) 
												and SqlPLSQLCommand(hSql(),"CCK.cc_TMP_GPK( nND, nVid, nAcc8, DAT3, DAT4, FLAGS2, SUMR_ , BDAT_1 ) " )
											Call SqlCommit( hSql() )
											If nSel=3
												Set rb4= TRUE
												Set rb2= FALSE
												Set nVid = 4
												Call SalShowWindow( dSUMO )
											Else
												Set rb2= TRUE
												Set rb4= FALSE
												Set nVid = 2
												! Call SalHideWindow( dSUMO )
											Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
										Else
											Call SqlRollback(hSql())
											Call MessageNoWait('Неуспешное построение ГПК', 'Ошибка', 0, 1)
									Else
										If SqlPLSQLCommand(hSql(), "P_GPK
												(nSel,FLAGS2,SUMR_*100,BDAT_1,DAT4,RATE,nFreq,nBasey,nMetr96, RATE_K,nDig ) " )
											Call SqlCommit( hSql() )
											If nSel=3
												Set rb4= TRUE
												Set rb2= FALSE
												Set nVid = 4
												! Call SalShowWindow( dSUMO )
											Else
												Set rb2= TRUE
												Set rb4= FALSE
												Set nVid = 2
												! Call SalHideWindow( dSUMO )
											! If nSel != 3 OR FLAGS2 = '1'
												                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Call SqlPLSQLCommand(hSql(),
														"CCK.cc_TMP_GPK( nND, nVid, nAcc8, DAT3, DAT4, FLAGS2, SUMR_, gl_BDATE ) " )
											Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
										Else
											Call SqlRollback(hSql())
											Call MessageNoWait('Неуспешное построение ГПК', 'Ошибка', 0, 1)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbIRR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.486"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_INTS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Расчет Эф.% ставки'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Ur, 26, nND, dCC_ID, dNMK ,'','','' )
				Pushbutton: pb_Help
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.986"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\HELP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Прогноз модификации ГПК'
							If nPar = 0 or CC_FSC != '1'
								Call SalHideWindow( pb_Help )
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Ur, 112, nND, dCC_ID, dNMK ,'','','' )
				Data Field: RATE_K
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.583"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '% Ежемесячной комиссии' )
				Combo Box: cmbMetr96
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   4.583"
						Top:    0.405"
						Width:  1.5"
						Width Editable? Class Default
						Height: 1.036"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If nPar=0
								Call cmbMetr96.Init(hWndItem)
								! Call cmbMetr96.Populate(hSql(), "METR", "NAME", "INT_METR", " where metr in (95,96) ORDER BY metr ")
								Call cmbMetr96.Populate(hSql(), "METR", "NAME", "INT_METR", " where metr >=90 and metr <=99 ORDER BY metr ")
								! Set nMetr96 = 95
								Set nMetr96 = cmbMetr96.GetKey(0)
								Set RATE_K = 0
							Else
								Call SalDisableWindow( RATE_K )
								Call SalDisableWindow( cmbMetr96 )
						On SAM_Click
							Set nMetr96 = cmbMetr96.GetKey(SalListQuerySelection(hWndItem))
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Методика Ежемесячной комиссии' )
						On SAM_SetFocus
							Call SalMapEnterToTab( TRUE )
				!
				Radio Button: rb_D
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 0.% за пред.День
					Window Location and Size
						Left:   6.183"
						Top:    0.452"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						! On SAM_Click
							                                                         Set FLAGS2='0'
				Radio Button: rb_M
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 1.% за пред.Месяц
					Window Location and Size
						Left:   6.183"
						Top:    0.667"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						! On SAM_Click
							                                                         Set FLAGS2='1'
				Radio Button: rb_I
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 2.% Iнше
					Window Location and Size
						Left:   8.633"
						Top:    0.667"
						Width:  1.283"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set FLAGS2='2'
				Frame
					Resource Id: 50320
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.083"
						Top:    0.417"
						Width:  3.95"
						Width Editable? Yes
						Height: 0.488"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				!
				Background Text: Балансировать с даты
					Resource Id: 50321
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   10.083"
						Top:    0.429"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Pushbutton: pb_BAL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.583"
						Top:    0.571"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Балансировать разницу округлений с указанной даты (в коп.)'
						On SAM_Click
							Call BALANS(100)
				Pushbutton: pb_BAL1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.083"
						Top:    0.571"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Балансировать разницу округлений с указанной даты (в цел.)'
						On SAM_Click
							Call BALANS(1)
				Data Field: DAT_BAL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.083"
							Top:    0.655"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							Set DAT_BAL = DAT4
				! ctb_pbGetValue: pb_Modify
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   15.183"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: C:\bars98\RESOURCE\BMP\CURRCONV.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Light Periwinkle
.end
					                                                                                                                                                                                                                                                                                                                                                                                                                                        Message Actions 
						                                                                                                                                                                                                                                                                                                                                                                                                                                        On SAM_Create
							                                                                                                                                                                                                                                                                                                                                                                                                                                        If nPar > 0
								                                                                                                                                                                                                                                                                                                                                                                                                                                        Set strTip = 'Изменение условий КД ' 
							                                                                                                                                                                                                                                                                                                                                                                                                                                        Else 
								                                                                                                                                                                                                                                                                                                                                                                                                                                        Call SalHideWindow( pb_Modify )
						                                                                                                                                                                                                                                                                                                                                                                                                                                        On SAM_Click
							                                                                                                                                                                                                                                                                                                                                                                                                                                        Call SalModalDialog(dlg_Modify, hWndForm, nPar, strTip )
				Check Box: cb_A
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Обслуговування по схемі "Ануїтет"
					Window Location and Size
						Left:   6.183"
						Top:    0.155"
						Width:  3.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Data Field: nRow_Gpk
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   15.486"
							Top:    0.406"
							Width:  0.5"
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Unformatted
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
		Contents
			Column: GRF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По
						гр.
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If FDAT < bDat
							Call SalMessageBox("Дата платежа должна быть не раньше Текущей даты !",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Set FDAT = FDAT_old
						If SalIsNull(hWndItem)
							Call SalMessageBox(
									     "Это поле должно быть заполнено !",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						If FDAT < DAT3
							Call SalMessageBox("Дата платежа должна быть не раньше даты начала договора!",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Set FDAT = DAT3
							Return VALIDATE_Cancel
						If FDAT > DAT4
							Call SalMessageBox("Дата платежа должна быть не позже даты окончания договора!",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Set FDAT = DAT4
							Return VALIDATE_Cancel
						Set FDAT = CorrectDate(GetBaseVal(), FDAT, FDAT+1 )  !! не выходной и не праздник
						! Call SalEnableWindow(pbRovno)
						Return VALIDATE_Ok
			Column: VLIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						ВХОДЯЩАЯ
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						гашения
						2
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set SUM_old = SUMG
					On SAM_Validate
						If FDAT < bDat
							Set SUMG = SUM_old
							Return VALIDATE_Ok
						Else If SalIsNull(hWndItem)
							Call SalClearField(hWndItem)
							Return VALIDATE_Ok
						Else If SUMG < 0
							Call SalMessageBox(
									     "Сумма погашения кредита должна быть >= 0",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						Set SUMG_100 = SUMG *100
						Return VALIDATE_Ok
			Column: SUMP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.%
						по лим
						3п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NOT_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пог.
						без
						 %
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						мес.ком.
						3к
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set SUM_old = SUMK
					On SAM_Validate
						If FDAT < bDat
							Set SUMK = SUM_old
							Return VALIDATE_Ok
						Else If SUMK < 0
							Call SalMessageBox(
									     "Сумма комиссии должна быть >= 0",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						Set SUMK_100 = SUMK *100
						Return VALIDATE_Ok
			Column: SUMO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						гаш. общ.
						4 = 2+3п+3к
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set SUM_old = SUMO
					On SAM_Validate
						If FDAT < bDat
							Set SUMO = SUM_old
							Return VALIDATE_Ok
						Else If SUMO = 0 or SalIsNull(hWndItem)
							Call SalClearField(hWndItem)
							Return VALIDATE_Ok
						Else If SUMO < 0
							Call SalMessageBox(
									     "Сумма погашения кредита должна быть >= 0",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						Set SUMO_100 = SUMO *100
						Return VALIDATE_Ok
			Column: ILIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						ИСХОДЯЩАЯ
						5 = 1 - 2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм.
						о
						Пог
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: VOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный ост.
						ВХОДЯЩИЙ
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный
						ДЕБЕТ
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный
						КРЕДИТ
						8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный ост.
						ИСХОДЯЩИЙ
						9 = 6 + 7 - 8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DELO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Просрочено
						/Невыбрано
						10 = 9 - 5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: FDAT_old
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMG_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SUM2_100
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMO_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SUM4_100
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMK_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SUM4_100
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: DELO_SP
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: В т.ч.
						на SP
						11 (пр.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 List Values
				                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Message Actions
		Functions
			Function: COLORA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! истекший период
					If nND <=0
						Call COLORA1( SalColorFromRGB( 230,245,240 )  )
					Else
						! Будущие пл.даты
						If FDAT >= bDat and GRF= 1
							Call COLORA1( COLOR_LightGreen )
						! Прошлые и текущая пл.дата
						Else If FDAT <= bDat
							Call COLORA1( IifN (FDAT = bDat , COLOR_Sky, COLOR_LightGray) )
							! просрочка
							If DELO >0
								! превішен лимит - розовій
								Call XSalTblSetCellBackColor( DELO, SalColorFromRGB( 255,210,250 ) )
							Else If DELO < 0
								! невібран лимит - желтій
								Call XSalTblSetCellBackColor( DELO, SalColorFromRGB( 255,255,180) )
			Function: COLORA1
				Description:
				Returns
				Parameters
					Number: nCol
				Static Variables
				Local variables
				Actions
					Call XSalTblSetCellBackColor( FDAT, nCol )
					Call XSalTblSetCellBackColor( VLIM, nCol )
					Call XSalTblSetCellBackColor( ILIM, nCol )
					If SUMG < 0 and SUMG != NUMBER_Null
						Call XSalTblSetCellBackColor( SUMG, SalColorFromRGB( 255,255,180)  )
					Else
						Call XSalTblSetCellBackColor( SUMG, nCol )
					Call XSalTblSetCellBackColor( SUMP, nCol )
					Call XSalTblSetCellBackColor( SUMO, nCol )
					Call XSalTblSetCellBackColor( SUMK, nCol )
					Call XSalTblSetCellBackColor( VOST, nCol )
					Call XSalTblSetCellBackColor( RDOS, nCol )
					Call XSalTblSetCellBackColor( RKOS, nCol )
					Call XSalTblSetCellBackColor( IOST, nCol )
					Call XSalTblSetCellBackColor( DELO, nCol )
			Function: Po_Gr4
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nS
					Number: nSP
					Number: nS1
					Date/Time: dS1
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If nRow >0 and FDAT  >= BDAT_1 and FDAT > DAT3
							If GRF=1
								If Tbl_GPK.rb4
									Set SUMO = IifN( dSUMO >0, dSUMO, SUMO )
									Set SUMO_100 = SUMO *100
								Else
									If SalIsWindowVisible(NOT_SN)
										If SUMG>0
											Set SUMG = IifN( dSUMO >0, dSUMO, SUMG )
											Set SUMG_100 = SUMG *100
									Else
										Set SUMG = IifN( dSUMO >0, dSUMO, SUMG )
										Set SUMG_100 = SUMG *100
									! SalShowWindow
								Call SalTblSetRowFlags( hWndForm, nRow, ROW_Edited, TRUE )
					Return TRUE
			!
			Function: BALANS
				Description:
				Returns
					Boolean:
				Parameters
					Number: k100
				Static Variables
				Local variables
					Number: SUM_BAL
					Number: KOL_BAL
					Number: nRow
					Number: nS
				Actions
					Call SalWaitCursor(TRUE)
					Set dSUMO = 0
					Set SUM_BAL = 0
					Set KOL_BAL = 0
					If DAT_BAL != DATETIME_Null and DAT_BAL != DAT4 and DAT_BAL > GetBankDate()
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
							Call SalTblSetContext( hWndForm, nRow )
							If nRow > 0 and FDAT  >= DAT_BAL and GRF=1
								Set SUM_BAL = SUM_BAL + SUMG
								Set KOL_BAL = KOL_BAL + 1
						!
						If KOL_BAL > 1 and SUM_BAL > KOL_BAL
							Set nS = SalNumberRound ( SUM_BAL*k100 / KOL_BAL )/k100
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
								Call SalTblSetContext( hWndForm, nRow )
								If nRow > 0 and FDAT  >= DAT_BAL and GRF=1
									If FDAT < DAT4
										Set SUMG = nS
										Set SUM_BAL = SUM_BAL - SUMG
									Else
										Set SUMG = SUM_BAL
									Set SUMG_100 = SUMG *100
									Call SalTblSetRowFlags( hWndForm, nRow, ROW_Edited, TRUE )
							Call SalSendMsg( pbUpdate, SAM_Click, 0, 0 )
					Call SalWaitCursor(FALSE)
					Return TRUE
			Function: Par_Dog
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nMes
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT a.kv, -a.ostx/100, l.fdat, d.wdate, a.acc,
							        q.freq, q.name, decode( nvl(i.BASEM,0), 1, 4, nvl(a.vid,0) ), 
							        i.basey, b.name, to_number(trunc(i.s)), nvl(i.BASEM,0) 
							 INTO :nKv, :LIM1, :DAT3, :DAT4, :nAcc8, 
							      :nFreq, :cmbFREQ, :nVid, 
							      :nBasey,:cmbBasey,:Day_Pog, :cb_A 
							 FROM cc_lim L, accounts A, cc_deal D, 
							      cc_add C, freq Q, int_accn I, basey B
							 WHERE b.basey = i.basey AND i.id=0 AND i.acc=a.acc
							   AND c.nd=l.nd AND c.adds=0 AND q.freq = least(i.freq,c.freq)
							   AND l.nd = d.nd AND l.acc = a.acc AND l.nd=:Tbl_GPK.nND
							   and l.fdat = (select min(fdat) from cc_lim  where nd=:nND) " )
							and SqlFetchNext(hSql(), nFetchRes)
						If cb_A = 1
							Call SalHideWindow( rb2 )
							Call SalHideWindow( rb4 )
							Set rb4 = TRUE 
							Call SalHideWindow( DAT_BAL )
							Call SalHideWindow( pb_BAL )
							Call SalHideWindow( pb_BAL1 )
							Call SalHideWindow( dSUMO )
							Call SalHideWindow( rb_D )
							Call SalHideWindow( rb_M )
							Call SalHideWindow( rb_I )
							Call SalShowWindow( cb_A )
							Call SalDisableWindow( cb_A )
						Else
							Call SalHideWindow( cb_A )
							If SqlPrepareAndExecute( hSql(),
									  "SELECT to_number(max(txt)) INTO :Day_Pog_SN   FROM nd_txt
									   WHERE nd=:Tbl_GPK.nND and tag='DAYSN' " )
									and not SqlFetchNext(hSql(), nFetchRes)
								Set Day_Pog_SN = NUMBER_Null
							Set rb4 = ( nVid = 4 )
							Call RB24()
						! % ставка
						If SqlPrepareAndExecute( hSql(),
								  "SELECT acrn.FPROCN(a.acc,0,gl.BD)
								   INTO :Tbl_GPK.RATE
								   FROM int_ratn r, accounts a
								   WHERE a.acc=:Tbl_GPK.nAcc8 AND a.acc=r.acc and r.id=0 " )
								and SqlFetchNext(hSql(), nFetchRes)
						! If SqlPrepareAndExecute( hSql(),
								  "SELECT decode(a.ostc,0,r.IR,acrn.FPROCN(a.acc,0,gl.BD))
								   INTO :Tbl_GPK.RATE
								   FROM int_ratn r, accounts a
								   WHERE a.acc=:Tbl_GPK.nAcc8 AND a.acc=r.acc and r.id=0 " )
								and SqlFetchNext(hSql(), nFetchRes)
						! Ставка комиссии
						If SqlPrepareAndExecute( hSql(),
								  "SELECT acrn.FPROCN(:nAcc8,2,gl.BD), i.metr, m.name
								   INTO :RATE_K, :nMetr96, :cmbMetr96  FROM int_accn i , int_metr m
								   WHERE i.acc =:nAcc8 AND i.id=2 and i.metr=m.metr " )
								and SqlFetchNext(hSql(), nFetchRes)
						Set sWh = " WHERE nd="|| Str(Tbl_GPK.nND) || " and acc="|| Str(Tbl_GPK.nAcc8)
						!
						Set bDat  = IifD ( GetBankDate()- Call_Last_Day < DAT3 , DAT3, GetBankDate()-Call_Last_Day )
						Set BDAT_1 = IifD ( GetBankDate() < DAT3 , DAT3, GetBankDate())
						! Дата применения новой суммы лимита
						If nND > 0
							! ищем будущую дату первого гашения, оговоренную в КД
							Set FDAT_ = DATETIME_Null
							If SqlPrepareAndExecute( hSqlAux(),
									  "select max(APL_DAT) INTO :FDAT_  from int_accn
									   where APL_DAT>=:BDAT_1 and acc=:Tbl_GPK.nAcc8 and id=0 ")
									 and SqlFetchNext( hSqlAux(), nFetchRes)
							! если не нашли (или она уже в прошлом) то берем первую ближайшую из ГПК
							If FDAT_ = DATETIME_Null
								If SqlPrepareAndExecute( hSqlAux(),
										  "SELECT min(fdat) INTO :FDAT_ FROM cc_LIM "|| sWh || " and fdat > :BDAT_1" )
										 and SqlFetchNext( hSqlAux(), nFetchRes)
						If FDAT_ = DATETIME_Null
							If nFreq=7
								Set nMes = 3
							Else If nFreq=180
								Set nMes = 6
							Else If nFreq=360
								Set nMes = 12
							Else
								Set nMes = 1
							Set FDAT_ =  AddMonths( BDAT_1, nMes )
						! надо - число первой даті а месяц - вібранной
						Call SalSendClassMessage(SAM_Create, 0, 0)
			Function: An_New
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If cb_A = 1 and nRow_Gpk > 2
						Call SalHideWindow( pbIns )
						Call SalHideWindow( pbDel )
						Call SalHideWindow( pbUpdate ) 
						Call SalHideWindow( pb_Lim ) 
						Call SalHideWindow( pbRazbyt ) 
			Function: RB24
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If rb4
						Call SalEnableWindow( SUMO )
						Call SalDisableWindow( SUMG )
						! Call SalShowWindow( dSUMO )
						Set nVid=4
					Else
						! Call SalHideWindow( dSUMO)
						Call SalDisableWindow( SUMO )
						Call SalEnableWindow( SUMG )
						! Set dSUMO =0
						Set nVid=2
			Function: F_rb_DM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: pr_day
				Actions
					If SqlPrepareAndExecute( hSql(),  "Select substr(txt,2,1) into :FLAGS2 from nd_txt where tag='FLAGS' and nd=:nPar" )
							and NOT SqlFetchNext( hSql(), nFetchRes )
						Set FLAGS2= ASG_SN
					If FLAGS2='1'
						Set rb_M = TRUE
						Call SalTblSetColumnTitle ( SUMP, "%(Лим)
								по пред.
								Месяц 3")
					Else If FLAGS2='0'
						Set rb_D = TRUE
						Call SalTblSetColumnTitle ( SUMP, "%(Лим)
								по пред.
								День 3" )
					Else If FLAGS2='2'
						Set rb_I = TRUE
						If SqlPrepareAndExecute( hSql(), "select to_number(txt) into :pr_day from nd_txt where tag='CCPRD' and nd=:nPar " ) 
								     and SqlFetchNext(hSql(), nFetchRes)
							Call SalTblSetColumnTitle ( SUMP, "%(Лим)
									по " || NumberToStr(pr_day-1) ||" число
									3" )
					!
		Window Parameters
			Number: nTip_Ur
			Number: nPar !!! nPar = 0  - Моделирование ГПК
			String: strPar01
			String: strPar02
		Window Variables
			Number: nMetr96
			String: FLAGS2
			String: FLAGS2_OLD
			Date/Time: DAT_beg
			Date/Time: gl_BDATE
			Number: nKv
			Date/Time: bDat
			Number: SUM_old
			Number: nSel
			Number: nDig
			Number: nAcc8
			Number: nFreq
			Number: nFreqP
			Number: Day_Pog
			Number: Day_Pog_SN
			Number: nBasey
			!
			Number: nSumTek
			Number: nRow
			String: sWh
			Date/Time: Dat_Max
			Date/Time: dTmp
			Number: Su3
			Number: Su31
			Number: nVid
			Number: I_SUMG
			Number: I_SUMP
			Number: I_SUMO
			Number: I_SUMK
			Number: I_RDOS
			Number: I_RKOS
			Number: nLim
			Number: Call_Last_Day
			!
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				Set Call_Last_Day = SalStrToNumber(GetGlobalOption('CC_GPKLD') )
				If GetGlobalOption('ASG-SN') = '1'
					Set rb_M  = TRUE
					Set FLAGS2='1'
				Else
					Set rb_D  = TRUE
					Set FLAGS2='0'
				If GetGlobalOption('CCPRD') = STRING_Null
					Call SalHideWindow (rb_I)
				Else
					If nTip_Kl != 2
						Call SalHideWindow (rb_I)
				If nTip_Ur =90 AND nPar!=0 !! 'Полный просмотр (Без транзакций)'
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbRazbyt )
				If nPar = 0  !! Моделирование ГПК
					Call SalEnableWindow( BDAT_1 )
					Call SalEnableWindow( DAT4 )
					Call SalEnableWindow( RATE )
					Call SalHideWindow( dNMK )
					!
					Call SalHideWindow( VOST )
					Call SalHideWindow( RDOS )
					Call SalHideWindow( RKOS )
					Call SalHideWindow( IOST )
					Call SalHideWindow( DELO )
					Call SalHideWindow( OTM )
					Set nDig = 0
					Set BDAT_1 = GetBankDate()
					Set Call_Last_Day=100000
					Set DAT3 = GetBankDate()
					Set FDAT_= CorrectDate( GetBaseVal(), AddMonths( DAT3, 1), DAT4)
					Set DAT4 = CorrectDate( GetBaseVal(), AddMonths( DAT3,12), DAT4)
					Call SalHideWindow( nND )
					Set Tbl_GPK.strSqlDelete = "DELETE FROM tmp_gpk WHERE fdat=:Tbl_GPK.FDAT_old "
					!
					Set Tbl_GPK.strSqlInsert =
							"INSERT Into tmp_gpk (fdat, sumg,sumo,sumK,not_sn) values (:Tbl_GPK.FDAT, :Tbl_GPK.SUMG_100,:Tbl_GPK.SUMO_100,:Tbl_GPK.SUMK_100,decode(:NOT_SN,0,null,1) )"
					!
					Set Tbl_GPK.strSqlUpdate =
							"UPDATE tmp_gpk SET sumg=:Tbl_GPK.SUMG_100,   sumO=:Tbl_GPK.SUMO_100,  sumK=:Tbl_GPK.SUMK_100,  fdat=:Tbl_GPK.FDAT
							 WHERE  fdat=:Tbl_GPK.FDAT_old "
				Else !! ГПК по реальному КД
					Call SalDisableWindow( rb_M )
					Call SalDisableWindow( rb_I )
					Call SalDisableWindow( rb_D )
					!
					Call SalHideWindow(Tbl_GPK.NOT_SN)
					Call SalTblSetLockedColumns( hWndForm, 8 )
					If SqlPrepareAndExecute( hSql(),
							  "Select substr(txt,2,1) into :FLAGS2 from nd_txt where tag='FLAGS' and nd=:nPar" )
							and NOT SqlFetchNext( hSql(), nFetchRes )
						Set FLAGS2= ASG_SN
					If FLAGS2='1'
						Set rb_M = TRUE
					Else If FLAGS2='0'
						Set rb_D = TRUE
					Else If FLAGS2='2'
						Set rb_I = TRUE
					Set FLAGS2_OLD = FLAGS2
					Call F_rb_DM()
					Call SalDisableWindow( DAT4 )
					Call SalDisableWindow( RATE )
					Set Tbl_GPK.nND   = Tbl_GPK.nPar
					!
					Set Tbl_GPK.strSqlDelete =
							 "DELETE FROM cc_LIM WHERE nd="||Str(Tbl_GPK.nND)||" and (fdat >=:Tbl_GPK.gl_BDATE or fdat>=:BDAT_1) and fdat=:Tbl_GPK.FDAT_old "
					!
					Set Tbl_GPK.strSqlInsert =
							"INSERT Into cc_LIM (nd, fdat, sumg,sumo, acc,not_sn) values
							(:Tbl_GPK.nND, :Tbl_GPK.FDAT, :Tbl_GPK.SUMG_100,:Tbl_GPK.SUMO_100, :Tbl_GPK.nAcc8, decode(:NOT_SN,1,1,null) )"
					!
					Set Tbl_GPK.strSqlUpdate =
							"UPDATE cc_LIM 
							    SET sumg = :Tbl_GPK.SUMG_100, 
							        sumO = :Tbl_GPK.SUMO_100,
							        sumK = :Tbl_GPK.SUMK_100, 
							        fdat = :Tbl_GPK.FDAT, 
							        not_sn=decode(:NOT_SN,1,1,null)
							 WHERE nd="||Str(Tbl_GPK.nND)||" and (fdat >=:Tbl_GPK.gl_BDATE or fdat>=:BDAT_1 ) and fdat=:Tbl_GPK.FDAT_old "
				!
				Set Tbl_GPK.strPrintFileName = 'СС_KAL'
				Set nDig = 0
				Set Tbl_GPK.nTabInstance = 1
				Set Tbl_GPK.dCC_ID= Tbl_GPK.strPar01
				Set Tbl_GPK.dNMK  = Tbl_GPK.strPar02
				!
				Call SalTblSetLockedColumns( hWndForm, 9 )
				!
				Set gl_BDATE = GetBankDate()
				Call SalSetWindowText(hWndForm, 'Построение графика погашения (ГПК) КД ' || strPar01 )
				Call ShowApdVersion('05')
				! наполнение CC_LIM хотя бы одной записью
				! параметры договора
				If nPar > 0
					Call CC_LIM_NULL( nND)
					Call SqlCommit( hSql() )
					Call Par_Dog()
			On UM_Populate
				If SUMR_ != NUMBER_Null AND  RATE != NUMBER_Null
					!
					Call Par_Dog()
					!
					Call SalWaitCursor(TRUE)
					Set I_SUMG = 0
					Set I_SUMP = 0
					Set I_SUMO = 0
					Set I_SUMK = 0
					Set I_RDOS = 0
					Set I_RKOS = 0
					Set nRow_Gpk = 0
					If nPar > 0
						Call SalTblPopulate(hWndForm, hSqlAux2(),
								"SELECT decode(F.fdat,P.fdat,1,0) GRF, F.FDAT, p.OTM,  nvl(p.not_sn,0), 
								        P.lim2/100, nvl(P.sumg,0)/100, nvl(P.sumo,0)/100, Nvl(P.sumK,0)/100,
								       -fost(:nAcc8,f.fdat)/100, fdos(:nAcc8,f.fdat,f.fdat)/100, fkos(:nAcc8,f.fdat,f.fdat)/100         
								 INTO :GRF, :FDAT, :OTM, :NOT_SN, :ILIM, :SUMG, :SUMO, :SUMK, :IOST, :RDOS, :RKOS
								 FROM (select fdat from cc_LIM where nd=:nND  union select fdat from saldoa where acc=:nAcc8) F,
								      (select fdat,lim2,sumg,sumo,sumk, otm,not_sn from cc_lim where nd=:nND ) P 
								 WHERE F.fdat=P.fdat (+) ORDER BY F.fdat" ,
								TBL_FillAll)
						Call An_New()
					Else
						Call F_rb_DM()
						Call SalTblPopulate(hWndForm, hSqlAux2(),
								"SELECT 1 GRF, FDAT, lim2/100, sumg/100, sumo/100, Nvl(sumk,0)/100
								 INTO :GRF, :FDAT, :ILIM, :SUMG, :SUMO, :SUMK
								 FROM TMP_GPK  ORDER BY fdat" , TBL_FillAll)
					! Итог
					Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set SUMG = I_SUMG
					Set SUMP = I_SUMP
					Set SUMO = I_SUMO
					Set SUMK = I_SUMK
					Set RDOS = I_RDOS
					Set RKOS = I_RKOS
					!
					Call SalTblSetContext(hWndForm, Tbl_GPK.nRow )
					Call SalTblSetRowFlags( hWndForm, Tbl_GPK.nRow, ROW_New, FALSE )
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
					!
			On SAM_FetchRowDone
				Set VLIM = ILIM + SUMG
				Set FDAT_old = FDAT
				Set nLim = ILIM
				Set SUMP = SUMO-SUMG-SUMK
				Set SUMO_100 = SUMO * 100
				Set SUMG_100 = SUMG * 100
				Set SUMK_100 = SUMK * 100
				!
				If FDAT <= bDat
					Set VOST = IOST - RDOS + RKOS
					Set DELO = IifN(IOST = NUMBER_Null,0, IOST ) - ILIM 
				Else
					Set VOST = NUMBER_Null
					Set RDOS = NUMBER_Null
					Set RKOS = NUMBER_Null
					Set IOST = NUMBER_Null
				Call COLORA()
				Set nLim = ILIM
				Set I_SUMG = I_SUMG + SUMG
				Set I_SUMP = I_SUMP + SUMP
				Set I_SUMO = I_SUMO + SUMO
				Set I_SUMK = I_SUMK + SUMK
				Set I_RDOS = I_RDOS + RDOS
				Set I_RKOS = I_RKOS + RKOS
				If NOT_SN=1 or (Day_Pog != Day_Pog_SN and Day_Pog_SN !=NUMBER_Null)    
					Call SalShowWindow(Tbl_GPK.NOT_SN)
				!
				Set nRow_Gpk = nRow_Gpk + GRF
			On UM_Update
				If SalMessageBox(
						'Вы действительно хотите внести изменения в ГПК?','В Н И М А Н И Е ! ', MB_IconQuestion | MB_YesNo) = IDYES
					Call SalWaitCursor(TRUE)
					Call Po_Gr4()
					Call SalWaitCursor(TRUE)
					!
					Call SqlPrepare(hSql(), Tbl_GPK.strSqlDelete )
					Call SalTblDoDeletes( hWndForm, hSql(),  ROW_MarkDeleted)
					!
					Call SqlPrepare( hSql(), Tbl_GPK.strSqlInsert )
					Call SalTblDoInserts( hWndForm, hSql(), TRUE)
					!
					Call SqlPrepare( hSql(), Tbl_GPK.strSqlUpdate )
					Call SalTblDoUpdates( hWndForm, hSql(), TRUE)
					!
					If nPar>0
						If SqlPLSQLCommand(hSql(), "CCK.CC_GPK_LIM (nND, nAcc8, BDAT_1, FDAT_, SUMR_ ) " )
								and SqlPLSQLCommand(hSql(),"CCK.cc_TMP_GPK( nND, nVid, nAcc8, DAT3, DAT4, FLAGS2, SUMR_ , BDAT_1 ) " )
							Call SqlCommit( hSql() )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						Else
							Call SqlRollback(hSql())
							Call MessageNoWait('Неуспешное Сохранение ', 'Ошибка', 0, 1)
					Call SalWaitCursor(FALSE)
	Table Window: CKL
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Графiк погашення Траншів для Кредитних Лiнiй
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.35"
				Top:    1.135"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.583"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.798"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_Start
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Gray
					Message Actions
						On SAM_Create
							If NOT (GetGlobalOption('CC_TR') = '1')
								Call SalDisableWindow( pb_Start )
							Set strTip = 
									'Стартове переформування таблиці траншів по КД '||Str(dND) ||'
									 (від дати відкриття рахунку боргу)'
						On SAM_Click
							If SalMessageBox( 
									"Ви дійсно бажаєте виконати " ||  strTip || " 
									? ? ? ? ? ",
									'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
								If NOT SqlPLSQLCommand( hSql(),"CCT.Start0 ( Nd ) ")
									Call SqlRollback(hSql())
								Else
									Call SqlCommitEx( hSql(), "Стартове переформування таблиці траншів по КД реф=" || Str(Nd ) )
									Call SalMessageBox(   strTip , 'Виконано ! ', MB_OK) 
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pb_Lim !    ОдноОконная
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'График Лимита Кредитования (ГЛК)'
						On SAM_Click
							Call Sel017f( hWndMDI, nTip_Fun , 13, CKL.Nd, sTitl, '','','','' )
				!
				Option Button: op_nClos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показати Тільки відкриті/Всі транші' )
						On SAM_Click
							Call F_Hide () 
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Option Button: op_Hide
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Maize
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,
									 'Сховати/Показати колонки для відокремлення траншів ' )
						On SAM_Click
							Call F_Hide () 
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set SUM_SS = 0
							Set KOL_SS = 0
							Set SUM_SP = 0
							Set KOL_SP = 0
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти зміни в планах на погашення траншів'
						On SAM_Click
							Call F_Update() 
				Line
					Resource Id: 24089
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pb_SZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\CHEKIN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'ПереРозбити фактичні Суми погашень'
						On SAM_Click
							Set nCol = SalTblQueryColumnID ( SZ )
							Set nSum_SZ = SalTblColumnSum( hWndForm, nCol, 0, 0 )
							If nSum_SZ != SUM_SZ_SP + SUM_SZ_SS
								Call SalMessageBox( 
										"Загальна Сума зкоригованих погашень (" || SalNumberToStrX (nSum_SZ, 2) || ")
										 НЕ = початковій )" ||  SalNumberToStrX( SUM_SZ_SP + SUM_SZ_SS, 2 ) || ")" ,
										'Помилка ! ', MB_IconStop )
							Else
								If SalMessageBox( "Ви дійсно бажаєте  
										" ||  strTip || " ? ",'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
									Call F_SZ (strTip)
				Pushbutton: pb_Plus
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Relation.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Об`єднати однорідні ВИДІЛЕНІ транші'
						On SAM_Click
							If SalMessageBox( "Ви дійсно бажаєте  
									" ||  strTip || " ? ",'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
								Call F_Plus(strTip) 
				Line
					Resource Id: 24090
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24091
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   5.983"
							Top:    0.071"
							Width:  1.3"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: #0
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.КД'  )
				Data Field: KOL_SS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.071"
							Width:  1.0"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: #0
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість траншів станом "В роботі"'  )
				Data Field: SUM_SS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   8.283"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'HEпогашена сума траншів станом "В роботі"'  )
				Background Text: = 
					Resource Id: 8239
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   10.283"
						Top:    0.095"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: SUM_SV_SS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   10.783"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Видана сума траншів станом "В роботі"'  )
				Data Field: SUM_SZ_SS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   13.283"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Погашена сума траншів станом "В роботі"'  )
				!
				Data Field: KOL_SP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.405"
							Width:  1.0"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: #0
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість траншів станом "НЕпогашений"'  )
				Data Field: SUM_SP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   8.283"
							Top:    0.405"
							Width:  1.9"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'HEпогашена сума траншів станом "НЕпогашений"'  )
				Background Text: = 
					Resource Id: 8240
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   10.283"
						Top:    0.429"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Background Text: - 
					Resource Id: 8241
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   12.783"
						Top:    0.095"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Background Text: -
					Resource Id: 8242
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   12.783"
						Top:    0.429"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: SUM_SV_SP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   10.783"
							Top:    0.405"
							Width:  1.9"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Видана сума траншів станом "НЕпогашений"'  )
				Data Field: SUM_SZ_SP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cFieldLabel
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Number
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   13.283"
							Top:    0.405"
							Width:  1.9"
							Width Editable? Class Default
							Height: 0.321"
							Height Editable? Class Default
						Visible? Class Default
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Погашена сума траншівстаном "НЕпогашений"'  )
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Iд.
						траншу
						
						(Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF != NUMBER_Null
							Call DocViewContentsEx(hWndForm, REF )
					On SAM_SetFocus
						Set nTmp = NPP
					On SAM_AnyEdit
						Set NPP = nTmp 
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						Рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmp = NLS
					On SAM_AnyEdit
						Set NLS = sTmp 
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						видачi
						траншу
						(Реф.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.45"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set dTmp = FDAT
					On SAM_AnyEdit
						Set FDAT = dTmp 
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Референс
						видачі
						траншу
						(Реф.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF != NUMBER_Null
							Call DocViewContentsEx(hWndForm, REF )
					On SAM_SetFocus
						Set nTmp = REF
					On SAM_AnyEdit
						Set REF = nTmp 
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заг.сума 
						виданого 
						траншу
						(Реф)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmp = S
					On SAM_AnyEdit
						Set S = nTmp 
			Column: SV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
						видачі
						п/траншу
						(Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.517"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmp = SV
					On SAM_AnyEdit
						Set SV = nTmp 
			Column: SV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума видачі
						ВІДОКРЕМЛ.
						п/траншу
						(Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If D_FAKT != DATETIME_Null
							Set SV1 = NUMBER_Null
					On SAM_Validate
						If SV1 != NUMBER_Null and SV1 > 0 and SV1 >= SV 
							Set sErr = 'Cума видачi вiдокремленого траншу >= суми видачi основного траншу '
							Call SalMessageBox( sErr,"Увага, помилка !", MB_IconStop)
							Set SV1 = NUMBER_Null
			Column: D_PLAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.дата
						погашення
						п/траншу
						(Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.517"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If D_PLAN != DATETIME_Null and D_PLAN <= FDAT
							Set sErr = 'План-дата погаш не м.б.<= дати видачі'
							Call SalMessageBox( sErr,"Увага, помилка !", MB_IconStop)
							Set D_PLAN = eDat
			Column: D_PLAN1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.дата
						погашення
						ВІДОКРЕМЛ.
						п/траншу (Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.683"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If D_FAKT != DATETIME_Null
							Set D_PLAN1 = DATETIME_Null
					On SAM_Validate
						If D_PLAN1 != DATETIME_Null and D_PLAN1 <= FDAT
							Set sErr = 'План-дата погаш не м.б.<= дати видачі'
							Call SalMessageBox( sErr,"Увага, помилка !", MB_IconStop)
							Set D_PLAN1 = DATETIME_Null
			Column: SZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
						погашення
						по п/траншу
						(Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If D_FAKT != DATETIME_Null
							Set SZ = eSZ
					On SAM_Validate
						If NOT (SZ >= 0 and SZ <= SZ )
							Set sErr = 'Помилка в Cумі погашення '
							Call SalMessageBox( sErr,"Увага, помилка !", MB_IconStop)
							Set SZ = eSZ
						! If NOT (SZ != NUMBER_Null and SZ > 0 and SZ <= SZ )
							                                                                                                                                                                                                                                             Set sErr = 'Помилка в Cумі погашення '
							                                                                                                                                                                                                                                             Call SalMessageBox( sErr,"Увага, помилка !", MB_IconStop)
							                                                                                                                                                                                                                                             Set SZ = eSZ
			Column: SZ1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума погаш
						по ВІДОКРЕМЛ
						п/траншу
						(Ід.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If D_FAKT != DATETIME_Null
							Set SZ1 = NUMBER_Null
					On SAM_Validate
						If SZ1 != NUMBER_Null and SZ1 > 0 and SZ1 >= SZ 
							Set sErr = 'Cума погаш. вiдокремленого траншу >= суми погаш. основного траншу '
							Call SalMessageBox( sErr,"Увага, помилка !", MB_IconStop)
							Set SZ1 = NUMBER_Null
			Column: DEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: HEпогашена
						сума
						п/траншу
						(Ід.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фактична
						дата
						погашення
						(Ід.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.483"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Референс
						погашення
						п/траншу
						(Ід.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REFP != NUMBER_Null
							Call DocViewContentsEx(hWndForm, REFP )
			Column: DAPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остання
						Дата
						звірки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.217"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						видачі
						траншу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.917"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стан 
						п/траншу
						
						(Ід.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Коментар
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SZ_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашена
						Сума
						траншу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_Update
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nNPP
					Number: nSV1
					Number: nSZ1
					Date/Time: dD_PLAN
					Date/Time: dD_PLAN1
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow ( hWndForm, nRow, ROW_Edited, 0)
						Call SalTblSetContext( hWndForm, nRow)
						If D_FAKT = DATETIME_Null
							Set nNPP = CKL.NPP
							Set dD_PLAN  = D_PLAN
							Set nSV1 = SV1
							Set dD_PLAN1 = D_PLAN1
							Set nSZ1 = SZ1
							If NOT SqlPLSQLCommand( hSql(),"CCT.UPD_POG ( nNPP , D_PLAN , nSV1, dD_PLAN1, nSZ1, COMM  ) ")
								Call SqlRollback(hSql())
							Else
								Call SqlCommitEx( hSql(), "Внесено зміни в транш № " || Str(nNPP) )
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return TRUE
			Function: F_Hide
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If op_Hide 
						Call SalHideWindow( SV1 )
						Call SalHideWindow( D_PLAN1 )
						Call SalHideWindow( SZ1 )
					Else
						Call SalShowWindow( SV1 )
						Call SalShowWindow( D_PLAN1 )
						Call SalShowWindow( SZ1 )
					!
					If op_nClos and op_Hide
						Call SalShowWindow( pb_SZ )
						Call SalEnableWindow( SZ )
					Else
						Call SalHideWindow( pb_SZ )
						Call SalDisableWindow( SZ )
			Function: F_SZ
				Description:
				Returns
				Parameters
					String: sTxt
				Static Variables
				Local variables
					Number: nRow
					Number: nNPP
					Number: nSZ_OLD
					Number: nSZ_NEW
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow ( hWndForm, nRow, ROW_Edited, 0)
						Call SalTblSetContext( hWndForm, nRow)
						If SZ != SZ_OLD
							Set nNPP = CKL.NPP
							Set nSZ_OLD = SZ_OLD *100
							Set nSZ_NEW = SZ *100
							If NOT SqlPLSQLCommand( hSql(),"CCT.UPD_SZ( nNPP , nSZ_OLD , nSZ_NEW ) ")
								Call SqlRollback(hSql())
								Return FALSE
					Call SqlCommitEx( hSql(), sTxt )
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return TRUE
			Function: F_Plus
				Description:
				Returns
					Boolean:
				Parameters
					String: sTxt
				Static Variables
				Local variables
					Number: nRow
					! Number: nRef
					Number: nAcc
					Number: nId
					Number: nKol
					Number: nSv
					Number: nSz
					String: sCom
					Date/Time: dFdat
					Date/Time: dPlan
				Actions
					Set nRow = TBL_MinRow
					Set nKol = 0
					While SalTblFindNextRow ( hWndForm, nRow, ROW_Selected, 0)
						Call SalTblSetContext( hWndForm, nRow)
						If nKol = 0
							Set nAcc = ACC
							Set dFdat = FDAT
							Set dPlan = D_PLAN
							Set nId = NPP
							Set nSv = 0
							Set nSz = 0
						Else
							If nAcc != ACC Or dFdat != FDAT OR dPlan != D_PLAN
								Call SalMessageBox( 
										'НЕможливо ' || sTxt || ' !
										Реквізити "Рахунок","Дата видачі","Дата погашення" НЕ співпадають !',
										'Помилка ! ', MB_IconStop )
								Return FALSE
						Set nSv = nSv + SV*100
						Set nSz = nSz + SZ*100
						Set nKol = nKol + 1
						If nKol > 1 
							If NOT SqlPLSQLCommand( hSql(),"CCT.Del_TRANSH( NPP)" )
								Call SqlRollback(hSql())
								Return FALSE
					If nKol = 1
						Call SalMessageBox( 
								'НЕможливо Об`єднати ОДИН транш !', 'Помилка ! ', MB_IconStop )
						Return FALSE
					! !!
					Set sCom = 'Об`єднання в один транш ' || Str(nId)
					If NOT SqlPLSQLCommand( hSql(),"CCT.Upd_TRANSH( nId , nSv, nSz, sCom)" )
						Call SqlRollback(hSql())
						Return FALSE
					!
					Call SqlCommitEx( hSql(), sCom )
					!
					Call SalMessageBox( sCom ,'Виконано ! ', MB_Ok )
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return TRUE
		Window Parameters
			Number: nTip_Ur
			Number: Nd
			String: sTitl
			String: sVIDD
			! nTip_Ur, N_NDp,
					dCC_ID || ' від '|| SalFmtFormatDateTime( DAT1, 'dd.MM.yyyy' )||' ' || sNmk, '' )
		Window Variables
			Number: nCol3
			Number: nCol2
			Number: nCol1
			Number: nCol
			Number: nSum_SZ
			Date/Time: aDat
			Date/Time: eDat
			Number: eSZ
			String: sErr
			!
			Date/Time: dTmp
			Number: nTmp
			String: sTmp
		Message Actions
			On SAM_Create
				Set CKL.strPrintFileName = 'CKL_' ||Str (Nd)
				Set CKL.nTabInstance = 1
				Set CKL.strFilterTblName = 'CC_TRANS'
				Call SalSetWindowText(hWndForm,sTitl)
				Set nCol2 = SalColorFromRGB( 255,210,210 ) ! СЛАБО-КРАСНЫЙ
				Set nCol1 = SalColorFromRGB( 220,255,255 ) ! голубой
				Set nCol3 = SalColorFromRGB( 255,255,180) ! желтый
				Set aDat = GetBankDate()
				Set dND  = Nd
				! If nTip_Ur >= 80
					                                                                                                                                                                                                                                                                         Call SalDisableWindow( pbIns )
					! Call SalDisableWindow( pbDel )
					                                                                                                                                                                                                                                                                         Call SalDisableWindow( pbUpdate )
					                                                                                                                                                                                                                                                                         Call SalDisableWindow( pbZ )
				Set op_nClos = TRUE
				Set op_Hide = TRUE 
				Call F_Hide () 
				!
				If NOT (nTip_Ur = 0 or nTip_Ur = 10)
					Call SalDisableWindow( pbUpdate )
				If sVIDD != '2'
					Call SalHideWindow( SUM_SS )
					Call SalHideWindow( SUM_SP )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
			On SAM_CreateComplete
				Call SalWaitCursor(TRUE)
				Set op_nClos = TRUE
				Set op_Hide  = TRUE 
				Call F_Hide () 
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set KOL_SS = 0
				Set SUM_SS = 0
				Set SUM_SV_SS = 0
				Set SUM_SZ_SS = 0
				!
				Set KOL_SP = 0
				Set SUM_SP = 0
				Set SUM_SV_SP = 0
				Set SUM_SZ_SP = 0
				Set CKL.strSqlPopulate =
						"select CC_TRANS.npp, a.TIP, a.kv, a.nls, CC_TRANS.fdat, 
						        CC_TRANS.ref, CC_TRANS.sv/100, CC_TRANS.sz/100,
						        CC_TRANS.D_PLAN, CC_TRANS.D_FAKT, CC_TRANS.DAPP, 
						        CC_TRANS.REFP , a.acc, CC_TRANS.comm, 
						        o.s/100 
						 into :CKL.NPP, :CKL.TIP, :CKL.KV, :CKL.NLS,   :CKL.FDAT, 
						      :CKL.REF, :CKL.SV,  :CKL.SZ, :CKL.D_PLAN,:CKL.D_FAKT, 
						      :CKL.DAPP,:CKL.REFP,:CKL.ACC,:CKL.COMM,  :CKL.S 
						 from nd_acc n, accounts a, CC_TRANS,  oper O 
						 where CC_TRANS.ref = o.ref 
						   and CC_TRANS.acc = a.acc 
						   and a.acc = n.acc 
						   and n.nd = " || Str(Nd) || 
						IifS (op_nClos , " and  CC_TRANS.D_FAKT is null ", "" )  || "
						 order by CC_TRANS.fdat, CC_TRANS.ref, CC_TRANS.D_PLAN "
				Call SalTblPopulate(hWndForm, hSql(), strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set SZ_OLD = SZ
				Set DEL = SV - SZ
				If TIP = 'SS '
					If D_FAKT = DATETIME_Null
						! Белый
						Set TXT = 'В роботі'
						Set KOL_SS = KOL_SS + 1
						Set SUM_SS = SUM_SS + DEL
						Set SUM_SV_SS = SUM_SV_SS + SV
						Set SUM_SZ_SS = SUM_SZ_SS + SZ
						Call XSalTblSetCellBackColor( SV1 , nCol3 )
						Call XSalTblSetCellBackColor( D_PLAN1 , nCol3 )
						Call XSalTblSetCellBackColor( SZ1 , nCol3 )
					Else If D_FAKT > D_PLAN
						! Серый
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray )
						Set TXT = 'Винесено на просрочку'
					Else
						! Зеленый
						Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_LightGreen )
						Set TXT = 'Погашено своєчасно'
				Else
					If D_FAKT != DATETIME_Null
						! Слабо-серый
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
						Set TXT = 'Погашено з порушенням'
					Else
						! Красный
						Call XSalTblSetRowBackColor( hWndForm, lParam, nCol2 )
						Set TXT = 'НЕпогашений'
						Set KOL_SP = KOL_SP + 1
						Set SUM_SP = SUM_SP + DEL
						Set SUM_SV_SP = SUM_SV_SP + SV
						Set SUM_SZ_SP = SUM_SZ_SP + SZ
			On SAM_TblDoDetails
				Set eDat = D_PLAN
				Set eSZ = SZ
	Form Window: frm_KD
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  14.75"
				Width Editable? Class Default
				Height: 7.881"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.488"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbAcc 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Accounts.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Рахунки й % ставки за договором'
						On SAM_Click
							Call Sel017(hWndMDI,nTip_Ur, 0, dfND ,dfCC_ID, Str(nGr) ,0 )
				Pushbutton: pbZalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Нові Договори застави'
						On SAM_Click
							If ACCS >0
								Call Sel017(hWndMDI,nTip_Ur, 2, dfND ,Str(nGr),Str(dfRNK), ACCS )
							Else
								! Call Debug('Не открыт осн.счет')
								Call SalMessageBox('Не открыт основной счет!', 'Ошибка', MB_IconExclamation)
				Pushbutton: pbZalog_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Існуючі Договори застави'
						On SAM_Click
							Call Sel017(hWndMDI,nTip_Ur,11, dfND ,Str(nGr),Str(dfRNK),ACCS )
				Pushbutton: pb_Lim
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Chartl.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Побудова Графіка Ліміту Кредитування (ГЛК) обраного КД'
						On SAM_Click
							Call Sel017f(hWndMDI,nTip_Ur,13, dfND ,
									dfCC_ID || ' від '|| SalFmtFormatDateTime( dfDAT1, 'dd.MM.yyyy' ), dfNMK,'','','' )
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\WORD.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Документи договору'
						On SAM_Click
							! Call DebugN (nTip_Ur)
							If nTip_Ur  = 90 and GetBankMfo()!='300175'
								If nTip_Dop = 0
									Call cdoc_ShowAllDocsReadOnly(dfND, hWndForm)
								If nTip_Dop = 2
									Call cdoc_ShowAllDocsSign(dfND, hWndForm)
							Else
								Call cdoc_ShowAllDocs(dfND, hWndForm)
				Pushbutton: pbXls
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Додаток № 1. Графік Погашення Кредиту (ГПК)'
						On SAM_Click
							Call Prn_XL_GPR()
				Pushbutton: pb13
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перечитати'
						On SAM_Click
							Call NASELENIE()
				Pushbutton: pb2 ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт клієнта - позичальника'
						On SAM_Click
							If nSOS<15
								If nTip_Kl=2
									! Call EditCustCorps(dfRNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
									Call EditCustCorpsEx(dfRNK, AVIEW_ReadOnly|CVIEW_ReadOnly| AVIEW_Saldo | CVIEW_Accounts, hWndForm, 0, '', FALSE)
								Else If nTip_Kl=3
									! Call EditCustPerson(dfRNK,AVIEW_ReadOnly|CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
									Call EditCustPersonEx(dfRNK, AVIEW_ReadOnly|CVIEW_ReadOnly|AVIEW_Saldo | CVIEW_Accounts, hWndForm, 0,  '', FALSE)
				Pushbutton: pbPrcAcc ! Все СЧета
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відкриті рахунки клієнта'
							If CC_FL_ACC = '1'
								Call SalEnableWindow( pbPrcAcc )
							Else
								Call SalDisableWindow( pbPrcAcc )
						On SAM_Click
							Call ShowCustAccountsEx(dfRNK)
				Pushbutton: pbTEK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Довідка про стан кредиту'
						On SAM_Click
							Call SalCreateWindow(frm_Help, hWndMDI, 
									dfND, dfCC_ID || ' від '|| SalFmtFormatDateTime( dfDAT1, 'dd/MM/yyyy' ),
									dfNMK, dfS, nKv, dfDAT3, dfDAT4)
				Pushbutton: pbSob
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Графік подій '
						On SAM_Click
							Call Sel017f(hWndMDI,nTip_Ur,16, dfND ,
									dfCC_ID || ' от '|| SalFmtFormatDateTime( dfDAT1, 'dd/MM/yyyy' ), dfNMK,'','','' )
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Таблична форма рахунків договору"
						On SAM_Click
							Call Sel017(hWndMDI,NUMBER_Null, 17, dfND, dfCC_ID, dfNMK, NUMBER_Null )
				Pushbutton: pbZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Зв`язок застав і позичкових рахунків'
						On SAM_Click
							Call Bars017r1
									( NUMBER_Null,NUMBER_Null,NUMBER_Null,
									"and KU_109.ACCK in (select acc from nd_acc where nd="||Str(dfND)||" )" )
				Pushbutton: pb_MOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Marigold
					Message Actions
						On SAM_Create
							If not b_MOS
								Call SalHideWindow( pb_MOS ) 
							Set strTip = 'Спец. реквізити по КД (внутрішньобанківські)'
						On SAM_Click
							Call SalSendMsg( cc_dog.pb_MOS, SAM_Click, 0, 0 )
				Pushbutton: pb_Loans
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Dark Gray
					Message Actions
						On SAM_Create
							If GetBankMfo() != '380764'
								Call SalHideWindow( pb_Loans ) 
							Set strTip = 'Історія погашення КД в ЛОАНС'
						On SAM_Click
							Call FunNSIEditFFiltered ('V_LOANS_PR',1,'ND='||Str(colNd))
				Pushbutton: pbIRR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_INTS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахунки Еф. % ставки'
						On SAM_Click
							Call Sel017f(hWndMDI, nTip_Ur, 26, dfND ,
									dfCC_ID || ' от '|| SalFmtFormatDateTime( dfDAT1, 'dd/MM/yyyy' ), dfNMK,
									'','','' )
				Data Field: dfSOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.083"
							Top:    0.095"
							Width:  1.75"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: INIC
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.483"
							Top:    0.095"
							Width:  2.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Инициатива КД' )
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				!
				! ctb_pbGetValue: pb_SLV
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.655"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: F4
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\BF4.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                                                    Message Actions 
						                                                    On SAM_Create
							                                                    Set strTip = 'Виклик довідника (F4)'
						                                                    On SAM_Click
							                                                    If nTip_Ur != 90
								                                                    Call Call_Ref_Book(4)
				! ctb_pbGetValue: pbF6
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.45"
						Top:    0.679"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: F6
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\BF6_.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                                                    Message Actions 
						                                                    On SAM_Create
							                                                    Set strTip = 'Редагування (F6)'
						                                                    On SAM_Click
							                                                    If nTip_Ur != 90
								                                                    Call Call_Ref_Book(6)
				! ctb_pbGetValue: pb_Ist_1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.655"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: F1
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                                                    Message Actions 
						                                                    On SAM_Create
							                                                    Set strTip = 'Історія модифікації ОДНОГО вибраного додаткового реквізиту КД (F1)'
						                                                    On SAM_Click
							                                                    Call tbl_DOP.F_Ist(colNd, tbl_DOP.TAG)
				! ctb_pbGetValue: pb_Ist_All
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.655"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: F2
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                                                    Message Actions 
						                                                    On SAM_Create
							                                                    Set strTip = 'Історія модифікації ВСІХ  додаткових реквізитів КД (F2)'
						                                                    On SAM_Click
							                                                    Call tbl_DOP.F_Ist(colNd, '')
				Pushbutton: pbRestr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.883"
						Top:    0.071"
						Width:  0.5"
						Width Editable? Class Default
						Height: 0.333"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Введення інф-ції про реструктуризацію'
						On SAM_Click
							Call SalModalDialog ( dlg_Restr, hWndForm, colNd)
		Contents
			Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 6162426F74746F6D 4D617267696E0002 0030000054616250
0040: 616765436F756E74 0002003100005461 624C6162656C7300 6000CFE0F0E0ECE5
0060: F2F0FB20CAC42009 C7E0E1E5E7EFE5F7 E5EDEDFF20E920F0 E5E7E5F0E209C4EE
0080: E42EEFE0F0E0ECE5 F2F0FB20CAC42009 D1F3EAF3EFEDE020 E2E0F0F2B3F1F2FC
00A0: 20EAF0E5E4E8F2F3 2009CFF0E8BAE4ED E0EDB320F4E0E9EB E800005461624E61
00C0: 6D6573001E004E61 6D6530094E616D65 32094E616D653109 4E616D6533094E61
00E0: 6D65340000546162 52696768744D6172 67696E0002003000 0054616244726177
0100: 5374796C65000B00 57696E3935537479 6C65000054616246 6F726D5061676573
0120: 0011000909446C67 5F4E645478745461 6209090000546162 546F704D61726769
0140: 6E00020030000054 61624F7269656E74 6174696F6E000100 0000000000000000
0160: 0000000000000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7001
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Yes
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
					On SAM_Create
						Call SalSendClassMessage(SAM_Create, wParam, lParam)
						! Инициализация закладок
						Call picTabs.InitializeFormPages(
								     '2;' ||
								     SalNumberToStrX(colNd,0) || ';' ||
								     dfCC_ID || ';' ||
								     SalNumberToStrX(nTip_Ur,0) || ';' ||
								     Str(SalWindowHandleToNumber(hWndForm)) )
						! Показываем первую закладку
						Call picTabs.BringToTop(0,TRUE)
			! 1 закладка - Параметры КД
			! 1 строка
			Data Field: dfINSIDER
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.488"
						Width:  1.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Категория заемщика' )
			Data Field: dfNMK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.488"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Клиент' )
			Data Field: nCOUNTRY
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    0.488"
						Width:  0.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код страны заемщика' )
			Data Field: sCOUNTRY
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.567"
						Top:    0.5"
						Width:  2.267"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Наименовани страны заемщика' )
			Combo Box: cmbFIN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.85"
					Top:    0.512"
					Width:  2.25"
					Width Editable? Class Default
					Height: 1.036"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbFIN.Init(hWndItem)
						Call cmbFIN.Populate(hSql(), "FIN","NAME", "STAN_FIN",  " ORDER BY FIN")
					On SAM_Click
						Set nFIN = cmbFIN.GetKey(SalListQuerySelection(hWndItem))
						Call F_s080(nFIN, nOBS, S080, sRISK )
			Pushbutton: pb_S080
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.15"
					Top:    0.429"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Установити нові значення ФІН. і ОБС.'
					On SAM_Click
						If nFIN !=NUMBER_Null and nOBS !=NUMBER_Null 
							If SqlPrepareAndExecute( hSqlAux2(), 
									  "UPDATE customer set crisk = :nFIN WHERE rnk=:dfRNK " )
									and SqlPrepareAndExecute( hSqlAux2(),
									  "UPDATE cc_deal set obs = :nOBS, fin = :nFIN WHERE nd = :dfND " ) 
									and SqlCommitEx( hSqlAux2(),'' )
							! If SqlPrepareAndExecute( hSqlAux2(), "UPDATE customer set crisk=:nFIN WHERE rnk=:dfRNK " )
									and SqlPrepareAndExecute( hSqlAux2(), "UPDATE cc_deal set obs=:nOBS WHERE nd=:dfND " ) 
									and SqlPrepareAndExecute( hSqlAux2(), 	
									"UPDATE specparam set s080=:S080 WHERE acc=:nAccSS " ) 
									and SqlCommitEx( hSqlAux2(),'' )
							Call NASELENIE()
			Background Text: Розр. категорії ризику
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42569
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.65"
					Top:    0.536"
					Width:  2.267"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 2 строка
			Data Field: dfOKPO
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.821"
						Width:  1.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код ОКПО' )
			Data Field: dfRNK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.821"
						Width:  1.267"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рег №' )
			Data Field: dfND
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.583"
						Top:    0.821"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф КД' )
			Data Field: dfGRP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    0.821"
						Width:  0.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Группа риска сраны заемщика' )
			Data Field: dKPROL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    0.821"
						Width:  0.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Количество пролонгаций срока погашения' )
			Combo Box: cmbOBS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.85"
					Top:    0.845"
					Width:  2.233"
					Width Editable? Class Default
					Height: 0.726"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbOBS.Init(hWndItem)
						Call cmbOBS.Populate(hSql(), "OBS","NAME", "STAN_OBS"," ORDER BY OBS ")
					On SAM_Click
						Set nOBS = cmbOBS.GetKey(SalListQuerySelection(hWndItem))
						Call F_s080(nFIN, nOBS, S080, sRISK )
			Pushbutton: pbRas_Fak
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.15"
					Top:    0.762"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\save_m.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Розр. категорії ризику-->Фактична'
					On SAM_Click
						If SqlPrepareAndExecute( hSql(),
								  "UPDATE specparam SET s080=:S080 
								   WHERE acc in (select n.acc from nd_acc n,accounts a 
								                 where n.acc=a.acc  and 
								                       a.tip in ('SS ','SL ','SP ', 'CR9', 'SN ','SPN','SLN','SK0','SK9','SDI','SPI','LIM') and nd=:dfND)" )
							Call SqlCommit( hSql() )
						Else
							Call SqlRollback(hSql())
			Data Field: S080
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 1
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.65"
						Top:    0.845"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: sRISK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.15"
						Top:    0.845"
						Width:  1.983"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			! 3 строка
			Data Field: sPROD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    1.155"
						Width:  1.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Продукт' )
			Data Field: nPROD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    1.155"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код Продукта' )
			Check Box: cb_Email
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Email
				Window Location and Size
					Left:   3.583"
					Top:    1.155"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сохранить Email для рассылки инф.сообщений' )
					On SAM_Click
						Set cmb_Email = SalStrTrimX( cmb_Email )
						If cb_Email and cmb_Email != STRING_Null
							! дополнительно
							If SqlPrepareAndExecute( hSql(), 
									"Begin
									  update nd_txt set txt='"||cmb_Email||"' where tag='EMAIL' and nd="||Str(colNd)||";
									  if SQL%rowcount = 0 then
									     INSERT INTO nd_txt (ND,TAG,TXT) values("||Str(colNd)||", 'EMAIL','"||cmb_Email||"' ) ;
									  end if;
									 End; ")
							Call SqlCommitEx( hSql(),'Email '|| cmb_Email || ' КД.ref='||Str(colNd) )
			Combo Box: cmb_Email
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.883"
					Top:    1.155"
					Width:  5.167"
					Width Editable? Yes
					Height: 1.345"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
			Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42554
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    1.405"
					Width:  12.767"
					Width Editable? Yes
					Height: 3.667"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: DATNPSN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.783"
						Top:    2.345"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала погашения %%' )
			Data Field: dfDenSN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.017"
						Top:    2.357"
						Width:  0.733"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'День месяца для погашения %%' )
			!
			Background Text: Продукт
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 41168
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.517"
					Top:    1.56"
					Width:  1.667"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: sProduct
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    1.488"
						Width:  8.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Наименование "Продукта"')
			Data Field: Product
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    1.488"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Код "Продукта"')
			! 4 строка
			Background Text: Дати: 
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42553
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.767"
					Top:    1.929"
					Width:  1.25"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Коміс міс.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42551
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.733"
					Top:    1.869"
					Width:  0.95"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfKOM
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.85"
						Top:    1.845"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Месячная % ст комиссии по договору' )
			Data Field: cmbKom
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    1.821"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Метод начисления комиссии' )
			Data Field: dfKOM1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.783"
						Top:    1.821"
						Width:  0.733"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст разовой комиссии по договору' )
			Background Text: Разова
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 39008
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.067"
					Top:    1.857"
					Width:  0.717"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 5 строка
			Background Text: Заключ
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42558
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.55"
					Top:    2.119"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDAT1
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.75"
						Top:    2.095"
						Width:  1.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата заключения КД' )
			Background Text: % ст.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42552
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.033"
					Top:    2.762"
					Width:  0.55"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPROC
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    2.988"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: cmbFREQP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.75"
						Top:    2.095"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Периодичность Погашения %%' )
			Data Field: dfDen
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.05"
						Top:    2.095"
						Width:  0.733"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'День месяца для погашения %%' )
			Data Field: DATNP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.783"
						Top:    2.095"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала погашения %%' )
			Data Field: dfKV
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.45"
						Top:    2.095"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Валюта договора' )
			Data Field: nKv
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   12.35"
						Top:    2.095"
						Width:  0.55"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			! 6 строка
			Background Text: Початку
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42559
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.55"
					Top:    2.369"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDAT2
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.75"
						Top:    2.345"
						Width:  1.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата нанача действия КД' )
			Background Text: Строк
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42562
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.3"
					Top:    2.762"
					Width:  0.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Міс.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42563
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.9"
					Top:    2.762"
					Width:  0.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Днів
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42564
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.2"
					Top:    2.762"
					Width:  0.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: За договором
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42556
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.45"
					Top:    2.762"
					Width:  1.517"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: SumN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.05"
						Top:    2.738"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма(Лимит) Договора' )
			! 7 строка
			Background Text: Видачі
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42560
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.55"
					Top:    2.619"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Blue
				Background Color: Default
			Data Field: dfDAT3
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.75"
						Top:    2.595"
						Width:  1.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата выдачи' )
			Background Text: Усього
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42565
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.4"
					Top:    3.012"
					Width:  0.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDNI
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.1"
						Top:    2.988"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Срок размещения ВСЕГО (в днях)' )
			Data Field: dfSROK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    2.988"
						Width:  0.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Срок размещения ВСЕГО (в мес)' )
			Data Field: dfPERIOD
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.8"
						Top:    2.381"
						Width:  2.233"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Периодичность гашения КРЕДИТА' )
			Background Text: Поточний ліміт
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42555
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.45"
					Top:    3.012"
					Width:  1.517"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.05"
						Top:    2.988"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма(Лимит) Договора' )
			! 8 строка
			Background Text: Завершення
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42561
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.55"
					Top:    2.869"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
			Data Field: dfDAT4
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.75"
						Top:    2.845"
						Width:  1.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения КД' )
			Background Text: у т.ч.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42566
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.4"
					Top:    3.262"
					Width:  0.683"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Минув.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42567
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.1"
					Top:    3.262"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Залиш.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42568
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.1"
					Top:    3.262"
					Width:  0.883"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfISTO
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    3.238"
						Width:  2.95"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Источник финансирования' )
			Background Text: Використ.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42557
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.95"
					Top:    3.262"
					Width:  0.967"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfS_Us
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.05"
						Top:    3.238"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Использовано' )
			! 9 строка
			Data Field: MS_NX
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.55"
						Top:    3.095"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Отрасль нар.хоз.(из цели кредита)' )
			Pushbutton: pb_Otrasl
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.4"
					Top:    3.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Click
						Set bTmp=FALSE
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :sAIM FROM nd_txt WHERE ND=:dfND and tag='MS_NX' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT="UPDATE nd_txt SET txt=:sAIM WHERE nd=:dfND AND tag='MS_NX' "
						Else
							Set sTmpT="INSERT INTO nd_txt (nd,tag,txt) VALUES (:dfND,'MS_NX',:sAIM)"
							Set sAIM=STRING_Null
						Call Sel017t( frm_KD, 'Подробности об отраслевом использовании кредита', frm_KD.bTmp, frm_KD.sAIM, TRUE )
						Set MS_NX = sAIM
						If bTmp
							If SqlPrepareAndExecute(hSql(), sTmpT )
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Подробиці про галузеве використання'
			Data Field: dfSROK_ist
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.1"
						Top:    3.488"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Истекший срок ' )
			Data Field: dfSROK_ost
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    3.488"
						Width:  0.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Остаток срока ' )
			Data Field: dfCEL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    3.488"
						Width:  2.95"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Целевое назначение' )
			Pushbutton: pb_AIM
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.0"
					Top:    3.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set bTmp=FALSE
						If SqlPrepareAndExecute(hSql(),
								  "SELECT txt INTO :sAIM FROM nd_txt WHERE ND=:dfND and tag='AIM' ")
								and SqlFetchNext(hSql(), nFetchRes)
							Set sTmpT="UPDATE nd_txt SET txt=:sAIM WHERE nd=:dfND AND tag='AIM' "
						Else
							Set sTmpT="INSERT INTO nd_txt (nd,tag,txt) VALUES (:dfND,'AIM',:sAIM)"
							Set sAIM=STRING_Null
						Call Sel017t( frm_KD, 'Подробности о целевом использовании кредита', frm_KD.bTmp, frm_KD.sAIM, TRUE )
						If bTmp
							If SqlPrepareAndExecute(hSql(), sTmpT )
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback(hSql())
					On SAM_Create
						Set strTip = 'Подробиці про галузеве використання'
			Background Text: Вільно
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42574
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.85"
					Top:    3.512"
					Width:  1.083"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfS_Free
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.05"
						Top:    3.488"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Свободный остаток' )
			! 10 строка
			Data Field: dfVID
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.55"
						Top:    3.345"
						Width:  2.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вид КД' )
			Background Text: % 
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42575
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.8"
					Top:    3.845"
					Width:  0.267"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPR_SROKA_ist
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.1"
						Top:    3.738"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Black
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% Истекшего срока размещения' )
			Data Field: dfPR_SROKA
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    3.738"
						Width:  0.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Black
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% Остатока срока размещения' )
			Data Field: K_ANIK
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    3.738"
						Width:  2.95"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Коефф.срока' )
			!
			Data Field: dfCC_ID
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    0.821"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ид.КД' )
			Data Field: dfISP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.85"
						Top:    3.738"
						Width:  3.083"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Кредитный инспектор' )
			!
			Group Box: "Канікули"
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 64421
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    4.071"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.595"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rb_KY
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.Есть
				Window Location and Size
					Left:   0.483"
					Top:    4.25"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_KN
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Нет
				Window Location and Size
					Left:   1.583"
					Top:    4.238"
					Width:  0.933"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Group Box: %% За попередній
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Resource Id: 64420
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.65"
					Top:    4.06"
					Width:  3.333"
					Width Editable? Yes
					Height: 0.595"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rb_D
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.День
				Window Location and Size
					Left:   2.783"
					Top:    4.238"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_M
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Месяц
				Window Location and Size
					Left:   3.783"
					Top:    4.238"
					Width:  1.133"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_I
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.Iнше
				Window Location and Size
					Left:   4.883"
					Top:    4.238"
					Width:  0.967"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Check Box: cb_A
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обслуговування по схемі "Ануїтет"
				Window Location and Size
					Left:   0.483"
					Top:    4.238"
					Width:  5.433"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			! Для ЦФР
			Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 47279
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.083"
					Top:    4.06"
					Width:  7.0"
					Width Editable? Yes
					Height: 0.583"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Drop-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: p_OLD_ND
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    4.226"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.предыдущего КД' )
					On SAM_SetFocus
						Set nTmpE = p_OLD_ND
					On SAM_KillFocus
						Set p_OLD_ND = nTmpE
			Data Field: P_REF
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.483"
						Top:    4.226"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.МО по перезачислению ' )
					On SAM_SetFocus
						Set nTmpE = P_REF
					On SAM_KillFocus
						Set P_REF = nTmpE
			Data Field: p_NEW_ND
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    4.226"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.нового КД' )
					On SAM_SetFocus
						Set nTmpE = p_NEW_ND
					On SAM_KillFocus
						Set p_NEW_ND = nTmpE
			Pushbutton: pb_Modify
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.45"
					Top:    4.167"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CURRCONV.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Periwinkle
				Message Actions
					On SAM_Create
						Set strTip = 'Зміна умов КД'
						If CC_FSC != '1'
							Call SalHideWindow( p_OLD_ND )
							Call SalHideWindow( P_REF )
							Call SalHideWindow( p_NEW_ND )
							Call SalHideWindow( pb_Modify )
						Call SalHideWindow(dfDenSN)
						Call SalHideWindow(DATNPSN)
					On SAM_Click
						Call Sel027(hWndForm, 12, P_REF, "","")
			! 2 закладка - Обеспечение и резерв
			!
			Group Box: Поточний стан забезпечення (в еквіваленті)
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42591
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.333"
					Top:    0.405"
					Width:  11.25"
					Width Editable? Yes
					Height: 2.083"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
			! 1 строка
			Background Text: Сума забезпечення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42593
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    0.762"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Arial Greek
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Background Text: Сума заборгованості
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42594
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    0.762"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Background Text: % покриття
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42595
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    0.762"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			! 2 строка
			Background Text: без обліку відсотка від виду забезпечення.
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42585
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    0.929"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: - основний борг
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42601
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    0.929"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: - Відношення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42589
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    0.929"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 3 строка
			Background Text: У розрахунки приймається забезпечення на рахунки:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42582
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    1.095"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: без процентного
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    1.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: суми забезпечення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42588
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    1.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 4 строка
			Background Text: основний, прострочення, сумнівної
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42583
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    1.262"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: без комісійного
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42570
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    1.262"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: к
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42587
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    1.262"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 5 строка
			Background Text: і позабалансові зобов'язання
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42584
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    1.429"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: без  др.
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42590
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    1.429"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: сумі заборгованості
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42586
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    1.429"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 6 строка
			Data Field: dfZALOG
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    1.655"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Общая Сумма обеспечения' )
			Background Text: Разом, у т.ч.:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3070
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.983"
					Top:    1.679"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfS_UsE
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    1.655"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма задолженности' )
			Data Field: dfPZALOG
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.083"
						Top:    1.655"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% покрытия Общей Суммой обеспечения' )
			! 7 строка
			Data Field: dfZALOG_95
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    1.905"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма обеспечения в части Залога(95*)' )
			Background Text: Застава
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3072
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.983"
					Top:    1.929"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPZALOG_95
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.083"
						Top:    1.905"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% покрытия в части Залога(95*)' )
			! 8 строка
			Data Field: dfZALOG_90
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    2.155"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма обеспечения в части Поручительств и Гарантий (90*)' )
			Background Text: Поруки, Гарантії
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3071
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.983"
					Top:    2.179"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPZALOG_90
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.083"
						Top:    2.155"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% покрытия в части Поручительств и Гарантий (90*)' )
			!
			Group Box: Сформований резерв
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42592
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    2.571"
					Width:  11.2"
					Width Editable? Yes
					Height: 1.917"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: G81
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.083"
						Top:    3.821"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Расчетный резерв по КД' )
			! 9 строка
			Background Text: Приведена сума забезпечення
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42596
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    2.929"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Background Text: Незабезпечена сума
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42597
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    2.929"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Background Text: Сформований резерв
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42599
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    2.929"
					Width:  3.017"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			! 10 строка
			Background Text: із урахуванням відсотка від виду забезпечення.
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42581
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    3.095"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: заборгованості
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42598
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.783"
					Top:    3.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Background Text: у нац.вал.
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42603
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.05"
					Top:    3.119"
					Width:  1.033"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 11 строка
			Background Text: У розрахунки приймається забезпечення на рахунки:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42578
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    3.262"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: (чистий кредитний ризик)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42604
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.75"
					Top:    3.286"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Дата 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42573
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    3.345"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dD_REZ
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.683"
						Top:    3.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			! 12 строка
			Background Text: основний, простроченні, сумнівні
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42579
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    3.429"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			! 13 строка
			Background Text: і позабалансові зобов'язання
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42580
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    3.595"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Вик.
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42572
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    3.595"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dU_REZ
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.683"
						Top:    3.571"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			! 14 строка
			Data Field: G79
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    3.821"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Приведенная сумма обеспечения' )
			Data Field: G80
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    3.821"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Необеспеченная сумма КД' )
			! 15 строка
			Background Text: Розрахунковий резерв по простр. %
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.095"
					Width:  3.983"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Data Field: G81p
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.083"
						Top:    4.071"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Расчетный резерв по проср.%' )
			!
			! 3 закладка - Доп.рекв КД
			! ctb_pbOk: pbDOP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr class Pushbutton:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.783"
					Top:    0.655"
					Width:  0.43"
					Width Editable? No
					Height: 0.317"
					Height Editable? No
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
.end
				                                                    Message Actions 
					                                                    On SAM_Create
						                                                    Set strTip = 'Зберегти зміни в дод .реквізитах КД'
						! Call SalDisableWindow( pbDOP )
					                                                    On SAM_Click
						                                                    If nTip_Ur!=90
							                                                    If tbl_DOP.UPD_DOP()
								                                                    If SqlCommitEx( hSql(),'Обновлен КД.'|| dfCC_ID ) 
									                                                    Call SalTblSetFlagsAnyRows ( tbl_DOP, ROW_Edited|ROW_Selected, FALSE,0, 0 )
									                                                    Call MessageNoWait('Обновление КД '|| dfCC_ID ||' Реф='||Str(colNd),'Сообщение',3,0)
			! Child Table: tbl_DOP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.717"
						Top:    1.036"
						Width:  12.133"
						Width Editable? Yes
						Height: 4.452"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
.end
				                                                    Contents 
					                                                    Column: TAG
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: NAME
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: TXT
						                                                    List Values 
						                                                    Message Actions 
							                                                    On SAM_AnyEdit
								                                                    Call SalEnableWindow( pbDOP )
								                                                    If Table_Name!=STRING_Null and SK_Column!=STRING_Null and FK_Column!=STRING_Null and TXT!=STRING_Null
									                                                    Set Tmp_TXT=Subs(tbl_DOP.TXT,1,250)
									                                                    If SqlPrepareAndExecute( hSqlAux2(), 
											 "SELECT min("|| tbl_DOP.FK_Column||"),count("|| tbl_DOP.FK_Column||")  into :new_comment,:count_comment from "||tbl_DOP.Table_Name||" where "||tbl_DOP.SK_Column||"=:Tmp_TXT  and rownum<3" ) 
											and SqlFetchNext(hSqlAux2(), nFetchRes) 
										                                                    If count_comment=1
											                                                    Set tbl_DOP.TXT2=new_comment
										                                                    Else 
											                                                    Set tbl_DOP.TXT2=STRING_Null
								                                                    Else 
									                                                    Set tbl_DOP.TXT2=STRING_Null
					                                                    Column: TXT2
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: FK_Column
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: SK_Column
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: Table_Name
						                                                    List Values 
						                                                    Message Actions 
					                                                    Column: colNsiSqlWhere
						                                                    List Values 
						                                                    Message Actions 
				                                                    Functions 
					                                                    Function: UPD_DOP
						                                                    Description: 
						                                                    Returns 
							                                                    Boolean: 
						                                                    Parameters 
						                                                    Static Variables 
						                                                    Local variables 
							                                                    Number: nRow
							                                                    Number: nCount
						                                                    Actions 
							                                                    Set nRow = TBL_MinRow
							                                                    While SalTblFindNextRow( hWndForm, nRow, 0, 0)
								                                                    Call SalTblSetContext(hWndForm, nRow)
								                                                    If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited )
									                                                    Call SqlSetLongBindDatatype(3,22)
									                                                    If NOT SqlPLSQLCommand(hSql(), "CCK_APP.SET_ND_TXT(colNd,TAG, TXT) " )
										                                                    Return FALSE
									! If SqlPrepareAndExecute( hSql(),"SELECT count(*) into :nCount  from nd_txt where nd=:colNd and tag=:TAG") and SqlFetchNext(hSql(), nFetchRes)
										                                                                                                                                                                                                                                                                    If nCount>0
											                                                                                                                                                                                                                                                                    If TXT != STRING_Null
												                                                                                                                                                                                                                                                                    Call SqlSetLongBindDatatype(3,22)
												                                                                                                                                                                                                                                                                    If NOT SqlPrepareAndExecute( hSql(), "UPDATE nd_txt set txt=:TXT where nd=:colNd and tag=:TAG")
													                                                                                                                                                                                                                                                                    Return FALSE
											                                                                                                                                                                                                                                                                    Else 
												                                                                                                                                                                                                                                                                    If NOT SqlPrepareAndExecute( hSql(), "DELETE from nd_txt where nd=:colNd and tag=:TAG")
													                                                                                                                                                                                                                                                                    Return FALSE
										                                                                                                                                                                                                                                                                    Else 
											                                                                                                                                                                                                                                                                    Call SqlSetLongBindDatatype(3,22)
											                                                                                                                                                                                                                                                                    If NOT SqlPrepareAndExecute( hSql(), "INSERT INTO nd_txt(nd,tag,txt) Values (:colNd,:TAG, :TXT)")
												                                                                                                                                                                                                                                                                    Return FALSE
							                                                    Return TRUE
					                                                    Function: Call_Ref_Book
						                                                    Description: 
						                                                    Returns 
						                                                    Parameters 
							                                                    Number: nPar
						                                                    Static Variables 
						                                                    Local variables 
							                                                    String: Tmp_TXT
							                                                    Long String: Tmp_TXT_LONG
							                                                    Boolean: bTmp
						                                                    Actions 
							                                                    If nPar = 4 and tbl_DOP.Table_Name != STRING_Null and tbl_DOP.SK_Column != STRING_Null 
								                                                    Set Tmp_TXT = Subs(tbl_DOP.TXT,1,250)
								                                                    If FunNSIGetFilteredAltPK(tbl_DOP.Table_Name, tbl_DOP.SK_Column, tbl_DOP.FK_Column, 
										   IifS(tbl_DOP.colNsiSqlWhere!='', VisStrSubstitute(tbl_DOP.colNsiSqlWhere, ':ND', Str(colNd)), ''),
										   Tmp_TXT, tbl_DOP.TXT2) > 0
									                                                    Set tbl_DOP.TXT = Tmp_TXT
									                                                    Call SalTblSetRowFlags(tbl_DOP, SalTblQueryContext(tbl_DOP), ROW_Edited, TRUE)
									                                                    Call SalEnableWindow(pbDOP)
							                                                    Else If nPar = 6
								                                                    Set Tmp_TXT_LONG=tbl_DOP.TXT
								                                                    Call Sel017t( hWndForm, tbl_DOP.NAME, bTmp, Tmp_TXT_LONG, TRUE )
								                                                    If bTmp>0
									                                                    Set tbl_DOP.TXT=Tmp_TXT_LONG
									                                                    Call SalTblSetRowFlags ( tbl_DOP, SalTblQueryContext ( tbl_DOP ), ROW_Edited, TRUE )
									                                                    Call SalEnableWindow( pbDOP )
							                                                    Call SalWaitCursor(FALSE)
					                                                    Function: F_Ist
						                                                    Description: 
						                                                    Returns 
						                                                    Parameters 
							                                                    Number: pNd
							                                                    String: pTag
						                                                    Static Variables 
						                                                    Local variables 
							                                                    String: sWhere
							                                                    String: sTmp
							                                                    String: sTmp1
						                                                    Actions 
							                                                    Set sWhere = " ND_TXT_UPDATE.nd = " || Str(pNd) || 
									IifS(pTag = "","", " and ND_TXT_UPDATE.tag='"|| pTag || "'" )
									 || " ORDER BY ND_TXT_UPDATE.IDUPD desc"
							                                                    Call FunNSIGetFiltered ("ND_TXT_UPDATE","TXT",
									sWhere , sTmp, sTmp1 )
				                                                    Window Variables 
					                                                    String: new_comment
					                                                    Number: count_comment
					                                                    String: Tmp_TXT
				                                                    Message Actions 
					                                                    On SAM_Create
						! Call SqlSetLongBindDatatype(3,22)
						                                                    Call SalTblPopulate(hWndForm, hSql(), 
								"SELECT t.tag, t.name, x.txt, t.table_name, t.nsisqlwhere,
								        (select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and showretval=1 and  mt.tabname=t.table_name) sk,
								        (select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and INSTNSSEMANTIC=1 and  mt.tabname=t.table_name) fk
								   INTO :TAG, :NAME, :TXT, :Table_Name, :colNsiSqlWhere, :SK_Column, :FK_Column 
								   FROM CC_TAG t, ND_TXT x 
								  WHERE t.TAGTYPE ='CCK' AND t.tag=x.tag (+) AND x.nd (+)=:colNd
								  ORDER BY t.tag", 
								TBL_FillAll )
					                                                    On SAM_TblDoDetails
						                                                    Set dfF4 = 'F1 - історія ВИБРАНОГО реквізита  
								F2 - історія ВСІХ реквізитів '
						                                                    If nTip_Ur != 90
							                                                    Set dfF4 = dfF4 || '
									F6 - редагування'
						                                                    If tbl_DOP.Table_Name!=STRING_Null and tbl_DOP.SK_Column!=STRING_Null
							! Call SalEnableWindow( pb_SLV )
							                                                    If nTip_Ur != 90
								                                                    Set dfF4 = dfF4 || '
										F4 - вибрати з довідника'
						! Else
							                                                                                                                                                                                                                                                                                                            Call SalDisableWindow( pb_SLV )
					                                                    On SAM_FetchRowDone
						                                                    If tbl_DOP.Table_Name != STRING_Null 
							                                                    Set Tmp_TXT=Subs(tbl_DOP.TXT,1,250)
							                                                    If SqlPrepareAndExecute( hSqlAux2(), 
									 "SELECT min("|| tbl_DOP.FK_Column||") into :tbl_DOP.TXT2 from "||tbl_DOP.Table_Name||" where "||tbl_DOP.SK_Column||"=:Tmp_TXT " ) 
									and SqlFetchNext(hSqlAux2(), nFetchRes) 
							! Call XSalTblSetCellBackColor(colValue, COLOR_LightGray)
							                                                    Call XSalTblSetRowBackColor(tbl_DOP,SalTblQueryContext ( tbl_DOP ),COLOR_LightGray)
					                                                    On SAM_DoubleClick
						                                                    If nTip_Ur!=90
							                                                    Call Call_Ref_Book(4)
			! Data Field: dfF4
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.4"
						Top:    5.595"
						Width:  12.483"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
.end
				                                                                                                                                                                                                                                                                                                            Message Actions 
			! Multiline Field: dfF4
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? No
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.683"
						Top:    5.571"
						Width:  12.1"
						Width Editable? Yes
						Height: 0.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
.end
				                                                    Message Actions 
			!
			! 4- Закладка "Сукупна вартість кредиту"
			Data Field: dFile
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.483"
						Top:    0.655"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dName
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    0.655"
						Width:  9.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dMemo
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    0.988"
						Width:  9.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: System Window Color
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pb_XL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.583"
					Top:    1.321"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip =
								 'Зберегти індивідуальні дані про додаткові платежі
								та Створити звіт'
					On SAM_Click
						Call tbl_XL.SAV_tbl_XL( )
						Set dMemo = "Дані про додаткові платежі збережені, як індивідуальні"
						Call tbl_XL.F_XL( tbl_XL.sFile )
						Call SalWaitCursor(FALSE)
			Background Text: Доступні види шаблонів:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 38598
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.083"
					Top:    1.345"
					Width:  5.8"
					Width Editable? Yes
					Height: 0.31"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Arial Greek
				Font Size: 14
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Child Table: tbl_XL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    1.655"
						Width:  13.6"
						Width Editable? Yes
						Height: 3.0"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: Idh
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: №
								пп
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: sFile
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Файл
								Шаблон
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва-коментар
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: Kom1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Разо
								ва
								комi
								сiя
								%
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.733"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KomRK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Р
								К
								О
								
								%
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.717"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: Insu_paw
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страхування
								предмета
								застави 
								щорічно
								%
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Insu_cck
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страхування
								життя від
								нещас.випад. 
								щорічно
								%
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.367"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Insu_tit
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страхування
								титулу
								щорічно, 
								3 роки
								 %
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.35"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Insu_CV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Страхування
								цивільної
								відпов.
								
								ГРН
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.25"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: Sum_note
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Послуги
								нотаріуса
								
								
								ГРН
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.15"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Sum_rees
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Послуги
								реєстра-
								торів
								
								ГРН
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.283"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Prc_mito
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Державне
								мито
								від 
								застави
								%
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.15"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Prc_PF
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пенсійний
								фонд
								від 
								застави
								%
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.083"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Sum_BTI
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Послуги
								БТІ 
								або
								МРЕО
								ГРН
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.183"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: SAV_tbl_XL
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							! String: sVal
							! String: sP10
						Actions
							Call SalWaitCursor(TRUE)
							! індивідуальні рекв по сукупнiй вартостi КД
							If SqlPrepareAndExecute( hSql(),"delete from nd_txt where nd=:dfND and tag like 'SV___' ") 
									and SqlPrepareAndExecute(hSql(),"insert into nd_txt(nd,tag,txt) 
									select :dfND,tag, decode(tag,
									 'SV0K1',:Kom1,     'SV1RK',:KomRK,   'SV2PW',:Insu_paw, 'SV3CV',:Insu_cck,
									 'SV4TI',:Insu_tit, 'SV5GO',:Insu_CV, 'SV6NO',:Sum_note, 'SV7RE',:Sum_rees, 
									 'SV8MI',:Prc_mito, 'SV9PF',:Prc_PF,  'SVABT',:Sum_BTI) 
									from cc_tag where tag like 'SV___' " )
									and SqlCommit( hSql() )       
							Call SalWaitCursor(FALSE)
					Function: F_XLR 
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set dFile = sFile
							Set dName = Name
					Function: F_ROW 
						Description:
						Returns
							Number:
						Parameters
							Number: i
							Number: nS
							Window Handle: hS
						Static Variables
						Local variables
							Number: nS1
						Actions
							Set nS1 = nS
							If mVal[i] != NUMBER_Null 
								If nS1 = NUMBER_Null OR nS1 != mVal[i] 
									Call XSalTblSetCellBackColor( hS, nColR )
								Set nS1 = mVal[i]
							Return nS1
					Function: F_XL ! Олег
						Description:
						Returns
							Boolean:
						Parameters
							String: Shablon
						Static Variables
						Local variables
							String: pShablon
							String: strFa
							Number: n
							Number: i
							Number: j
							Number: m
							Number: nTmp 
							Number: nIrr
							Date/Time: Dtmp
							Date/Time: DtmpY
							Date/Time: FDAT_
							Number: KURS_
							Number: SUMS_
							Number: SUMO_
							Number: SUMG_
							Number: MM
							String: s9 
							String: Fofmula[20]
							String: mas[20]
							String: Pasp
							String: Adres
						Actions
							Call SalWaitCursor(TRUE)
							If nKv = GetBaseVal()
								Set KURS_ = 1
							Else
								If SqlPrepareAndExecute( hSql(), 
										"select gl.p_icurval(:nKv,10000,:dfDAT3)/10000 into :KURS_ from dual" )
										and  SqlFetchNext( hSql(), nFetchRes) 
							If SqlPrepareAndExecute( hSql(), 
									  "SELECT c.adr, 
									k.name||' '|| p.SER||' '||p.NUMDOC ||', виданий '|| p.ORGAN ||' '||to_char(p.pdate,'dd.mm.yyyy')
									  INTO :Adres, :Pasp from PASSP k, person p, customer c 
									where c.rnk=p.rnk and p.rnk=:dfRNK and NVL(p.PASSP,1)=k.PASSP (+) " )
									and  SqlFetchNext( hSql(), nFetchRes) 
							Set s9 =  SalNumberToChar( 9 )
							! Полное имя шаблона1
							Set pShablon = GetTemplateDir() || "\\" || Shablon
							Set strFa = GetPrnDir() || "\\K" || Str(dfND)||".XLS"
							Call VisFileSetAttribute( strFa, FA_ReadOnly, FALSE )
							Call VisFileDelete(strFa)
							If VisFileCopy( pShablon, strFa )<0
								Call MessageNoWait( 'Не удалось найти файл - '||pShablon||' или скопировать его в папку - '||strFa,'Ошибка',10,0) 
								Return FALSE
							! говорим что хотим работать с Excel
							Set excel.nTargetApp = atExcel
							! создаем excel 
							If excel.OpenApplication()
								! загружаем туда шаблон с диска
								Call excel.LoadDoc( strFa )
								! пример заполнения отдельной ячейки (X=1, Y=3)
								Call excel.SetTableCell(11,2,"до Кредитного договору № " || dfCC_ID ) 
								Call excel.SetTableCell(11,3," від " || SalFmtFormatDateTime( dfDAT1, 'dd.MM.yyyy' ) )
								Call excel.SetTableCell(4,9, SalFmtFormatDateTime( dfDAT3, 'dd.MM.yyyy' ) )
								Call excel.SetTableCell(4,10, SalNumberToStrX( SumN,2) )
								Call excel.SetTableCell(5,10, dfKV ) 
								Call excel.SetTableCell(4,11, Str(dfSROK) )
								Call excel.SetTableCell(4,12, dfPERIOD )
								Call excel.SetTableCell(4,13, cmbFREQP )
								Call excel.SetTableCell(4,14,Str(dfPROC))
								Call excel.SetTableCell(4,15,SalNumberToStrX(dfZALOG_95,2) )
								Call excel.SetTableCell(5,15, 'грн ')
								Call excel.SetTableCell(6,19,Str(Kom1 )||'%' )
								Call excel.SetTableCell(6,21,Str( Insu_paw ) ||'%' )
								Call excel.SetTableCell(6,22,Str(Insu_cck)  ||'%')
								Call excel.SetTableCell(6,23,Str(Insu_tit ) ||'%' )
								Call excel.SetTableCell(6,24,SalNumberToStrX(Sum_note,2 ))
								Call excel.SetTableCell(6,25,SalNumberToStrX(Sum_rees,2 ))
								Call excel.SetTableCell(6,26,Str(Prc_mito )||'%')
								Call excel.SetTableCell(6,27,SalNumberToStrX(Sum_BTI,2 ))
								If tbl_XL.Idh != 2 
									Call excel.SetTableCell(6,28,Str(KomRK )||'%' )
								!
								Set Dtmp = dfDAT3
								Set DtmpY =AddMonths( dfDAT3, -12)
								Set n = 50
								Set j = 0
								! Сигнал для разрисовки  таблицы ВКЛЮЧИТЬ
								Call excel.SetTableCell(26,1,'1' )
								Set SUMS_ = SumN*100
								If SqlPrepareAndExecute( hSql(),
										"select fdat,sumo, sumg Into :FDAT_,:SUMO_,:SUMG_ from cc_lim where nd=:dfND order by fdat" )
									While SqlFetchNext( hSql(), nFetchRes) 
										Set j = j + 1
										Set mas[1] = SalFmtFormatDateTime( FDAT_, 'dd.MM.yyyy' )
										Set mas[2] = Str(FDAT_-Dtmp ) 
										If j = 1
											Set mas[4] = SalNumberToStrX(-SUMS_/100,2)  
											Set mas[7] = SalNumberToStrX( SumN * Kom1/100,2 ) 
											Set mas[13] = SalNumberToStrX( dfZALOG_95/KURS_ * Prc_mito /100,2 ) 
											Set mas[14] = SalNumberToStrX( Sum_note/KURS_,2 ) 
											Set mas[15] = SalNumberToStrX( (Sum_rees + Sum_BTI ) /KURS_,2)
											Set mas[8] = '0.00'
										Else
											Set mas[4] = SalNumberToStrX(SUMG_/100,2 ) 
											Set mas[7] = '0.00' 
											Set mas[13] ='0.00'
											Set mas[14] ='0.00'
											Set mas[15] ='0.00'
											Set mas[8] = '0.00'
											If tbl_XL.Idh != 2 
												If nMetr90 = 92 or nMetr90 =93 
													Set mas[8] = SalNumberToStrX( SumN * dfKOM/100,2 ) 
												Else If nMetr90 = 91 or nMetr90 =94 
													Set mas[8] = SalNumberToStrX( SUMS_/100 * dfKOM/100,2 ) 
										Set mas[5] = SalNumberToStrX( (SUMS_-SUMG_)/100,2 ) 
										Set mas[6] = SalNumberToStrX( (SUMO_-SUMG_)/100,2 ) 
										If tbl_XL.Idh = 2 
											Set mas[9] = '0.00'
										Else
											Set mas[9] = SalNumberToStrX( (SUMO_/100 +  Val(mas[8]) ) * KomRK/100,2)
										Set mas[10] = '0.00' 
										Set mas[11] = '0.00' 
										Set mas[12] = '0.00' 
										If FDAT_ - DtmpY > 360
											Set mas[10] = SalNumberToStrX( (SUMS_-SUMG_)*1.1 * Insu_paw /10000,2 ) 
											Set mas[11] = SalNumberToStrX( (SUMS_-SUMG_) * Insu_cck /10000,2 ) 
											If FDAT_ - dfDAT3 < 1095
												Set mas[12] = SalNumberToStrX( SUMS_ * Insu_tit /10000,2 ) 
											Set DtmpY = FDAT_
										! 3(C) - Общ.сумма платежа = (Передаю расчет  Excel-ю)
										! Set mas[3] =  SalNumberToStrX
												( Val(mas[ 4]) + Val(mas[ 6]) + Val(mas[ 7]) + Val(mas[ 8]) + 
												  Val(mas[ 9]) + Val(mas[10]) + Val(mas[11]) + Val(mas[12]) + 
												  Val(mas[13]) + Val(mas[14]) + Val(mas[15]) ,2 ) 
										Set i = n + j
										Set mas[3]="=СУММ(D"||Str(i)||")+СУММ(F"||Str(i)||":O"||Str(i)||")" 
										!
										! !!! Передать строку
										! 1(A) - Дата
										! 2(B) - Дней
										! 3(C) - Общ.сумма платежа = 
										! 4*(D) - Тело кредита
										! 5(E) - Ост.осн.долга
										! 6*(F) - Сумма %
										! 7*(G) - Ком разовая
										! 8*(H) - Ежемес комиссия \ Idh !=2
										! 9*(I) - Расч-Касс       /
										! 10*(J) - Страх. залога
										! 11*(K) - Страх заемщ
										! 12*(L) - Страх титула
										! 13*(M) - Мито
										! 14*(N) - Нотариус 
										! 15*(O) - Реест + БТИ
										! пример заполнения строки (первый параметр - X, второй - Y, третий - кол-во колонок, четвертый - данные (колонки разделены 9-м символом )
										! В обоих методах данные будут расологатся в одинаковых клеточках но для  2-го метода в Exel-е скроим 8 и 9 столбик (а иначе тогда надо делать разветвления и для Сумм Set Fofmula[ 9] = "=SUM(I52:I"||Str(i)||")" )
										! If tbl_XL.Idh = 2  
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCellRange(1,i,13,
													mas[ 1]||s9|| mas[ 2]||s9|| mas[ 3]||s9|| mas[ 4]||s9|| mas[ 5]||s9|| mas[ 6]||s9||
													mas[ 7]||s9|| mas[10]||s9|| mas[11]||s9|| mas[12]||s9||
													mas[13]||s9|| mas[14]||s9|| mas[15] )
										! Else 
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCellRange(1,i,15,
													mas[ 1]||s9|| mas[ 2]||s9|| mas[ 3]||s9|| mas[ 4]||s9|| mas[ 5]||s9|| mas[ 6]||s9||
													mas[ 7]||s9|| mas[ 8]||s9|| mas[ 9]||s9|| mas[10]||s9|| mas[11]||s9|| mas[12]||s9||
													mas[13]||s9|| mas[14]||s9|| mas[15] )
										Set m=1
										While m<=15 !Переход на Русский язык и отказ от функции диапазона из за Олега
											Call excel.SetTableCell(m,i,mas[m])
											Set m=m+1
										Set SUMS_ = SUMS_ - SUMG_
										Set Dtmp = FDAT_
									! Итог (n=50 а данные вставляются начиная с 51 стр)
									Set Fofmula[ 2] = "=СУММ(B"||Str(n+2)||":B"||Str(i)||")" 
									Set Fofmula[ 3] = "=СУММ(C"||Str(n+2)||":C"||Str(i)||")" 
									Set Fofmula[ 4] = "=СУММ(D"||Str(n+2)||":D"||Str(i)||")" 
									Set Fofmula[ 6] = "=СУММ(F"||Str(n+2)||":F"||Str(i)||")" 
									Set Fofmula[ 7] = "=СУММ(G"||Str(n+1)||":G"||Str(i)||")" 
									Set Fofmula[ 8] = "=СУММ(H"||Str(n+2)||":H"||Str(i)||")" 
									Set Fofmula[ 9] = "=СУММ(I"||Str(n+2)||":I"||Str(i)||")" 
									Set Fofmula[10] = "=СУММ(J"||Str(n+1)||":J"||Str(i)||")" 
									Set Fofmula[11] = "=СУММ(K"||Str(n+1)||":K"||Str(i)||")" 
									Set Fofmula[12] = "=СУММ(L"||Str(n+1)||":L"||Str(i)||")" 
									Set Fofmula[13] = "=СУММ(M"||Str(n+1)||":M"||Str(i)||")" 
									Set Fofmula[14] = "=СУММ(N"||Str(n+1)||":N"||Str(i)||")" 
									Set Fofmula[15] = "=СУММ(O"||Str(n+1)||":O"||Str(i)||")" 
									! ! 16(P) - Еф.ставка
									Set Fofmula[16] = "=ВСД(C51:C"||Str(i)||";"||Str(5/100)||")*1200"
									Set i = i + 1
									! ! 17(Q) - Абс.подорож
									! If tbl_XL.Idh = 2  
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Set Fofmula[17] = "=СУММ(F"||Str(i)||":M"||Str(i)||")" 
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCellRange(1,i,13,"Разом:"||s9||
												Fofmula[ 2]||s9|| Fofmula[ 3]||s9|| Fofmula[ 4]||s9||      '0.00'||s9|| 
												Fofmula[ 6]||s9|| Fofmula[ 7]||s9||'0.00'||s9||'0.00'||s9||
												Fofmula[10]||s9|| Fofmula[11]||s9|| Fofmula[12]||s9|| Fofmula[13]||s9|| 
												Fofmula[14]||s9|| Fofmula[15] )
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCell(14,i,Fofmula[16] )
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCell(15,i,Fofmula[17] )
									! Else 
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Set Fofmula[17] = "=СУММ(F"||Str(i)||":O"||Str(i)||")" 
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCellRange(1,i,15,"Разом:"||s9||
												Fofmula[ 2]||s9|| Fofmula[ 3]||s9|| Fofmula[ 4]||s9||      '0.00'||s9|| 
												Fofmula[ 6]||s9|| Fofmula[ 7]||s9|| Fofmula[ 8]||s9|| Fofmula[ 9]||s9|| 
												Fofmula[10]||s9|| Fofmula[11]||s9|| Fofmula[12]||s9|| Fofmula[13]||s9|| 
												Fofmula[14]||s9|| Fofmula[15] )
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCell(16,i,Fofmula[16] )
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Call excel.SetTableCell(17,i,Fofmula[17] )
									Set Fofmula[17] = "=СУММ(F"||Str(i)||":O"||Str(i)||")" 
									! Call excel.SetTableCellRange(1,i,15,"Разом:"||s9||
											Fofmula[ 2]||s9|| Fofmula[ 3]||s9|| Fofmula[ 4]||s9||      '0.00'||s9|| 
											Fofmula[ 6]||s9|| Fofmula[ 7]||s9|| Fofmula[ 8]||s9|| Fofmula[ 9]||s9|| 
											Fofmula[10]||s9|| Fofmula[11]||s9|| Fofmula[12]||s9|| Fofmula[13]||s9|| 
											Fofmula[14]||s9|| Fofmula[15] )
									! Call excel.SetTableCell(16,i,Fofmula[16] )
									! Call excel.SetTableCell(17,i,Fofmula[17] )
									Set m=1
									While m<=17 !Переход на Русский язык и отказ от функции диапазона из за Олега
										Call excel.SetTableCell(m,i,Fofmula[m])
										Set m=m+1
								! Сигнал для разрисовки  таблицы ВЫКЛЮЧИТЬ
								Call excel.SetTableCell(26,1,'2' )
								!
								If nKv != GetBaseVal()
									Set i = i + 2
									Call excel.SetTableCell(2,i,
											"Розрахунки здійснені у валюті Кредиту за курсом НБУ на дату "||
											SalFmtFormatDateTime( dfDAT3, 'dd.MM.yyyy' ) || " = " ||Str(KURS_) ) 
								Set i = i + 2
								Call excel.SetTableCell(2,i,
										"При визначенні вартості супутніх послуг Банк користується такими нормативними актами:" ) 
								If tbl_XL.Idh = 2  OR tbl_XL.Idh = 1
									Set i = i + 1
									Call excel.SetTableCell(3,i,"При іпотеці:" ) 
									Set i = i + 1
									Call excel.SetTableCell(3,i,
											"1.Тимчасовий порядок державної реєстрації іпотек, затверджений постановою КМУ від 31.03.04 за №410;" ) 
									Set i = i + 1
									Call excel.SetTableCell(3,i,
											'2.Декрет КМУ "Про державне мито" від 21.01.93 №7-93;' ) 
									Set i = i + 1
									Call excel.SetTableCell(3,i,
											'3.Закон України "Про страхування" від 07.03.96 №85/96;' ) 
									Set i = i + 1
									Call excel.SetTableCell(3,i,
											'4.Інструкція "Про порядок вчинення нотаріальних дій нотаріусами України", затверджена наказом Міністерства юстиції України від 03.03.04' ) 
									Set i = i + 1
									Call excel.SetTableCell(3,i,
											'5."Порядок сплати збору на обов’язкове державне пенсійне страхування з окремих видів господарських операцій", затверджена постановою КМУ від 03.11.98 №1740;' ) 
									Set i = i + 1
									Call excel.SetTableCell(3,i,
											'6."Положення про Єдиний реєстр для реєстрації заборон відчуження об`єктів нерухомого майна", затверджене наказом Міністра юстиції України від 27.05.97 №41/5.' ) 
								Call excel.SetTableCell(2,i+4,"БАНК"  ) 
								Call excel.SetTableCell(2,i+5,GetBankName()||", МФО "||GetBankMfo()  ) 
								Call excel.SetTableCell(2,i+6,"Код ЄДРПОУ "||GetBankOkpoS()  ) 
								Call excel.SetTableCell(2,i+7,"Код МФО "||GetBankMfo()  ) 
								Call excel.SetTableCell(2,i+8, GetGlobalOption('ADDRESS') ) 
								!
								Call excel.SetTableCell(8,i+4,"ПОЗИЧАЛЬНИК"  ) 
								Call excel.SetTableCell(8,i+5,dfNMK ) 
								Call excel.SetTableCell(8,i+6,"ідентифікаційний номер "|| dfOKPO ) 
								Call excel.SetTableCell(8,i+7, Pasp ) 
								Call excel.SetTableCell(8,i+8, Adres ) 
								Call excel.SetTableCell(26,1,' ' )
								! показываем excel на экран
								Call excel.ShowApplication()
								Return TRUE
							Return FALSE
					Function: NAS_tbl_XL
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							! індивідуальні рекв по сукупнiй вартостi КД
							Set ki = 0
							If SqlPrepareAndExecute( hSql(),
									"select ascii(substr(tag,3,1))-48, substr(txt,1,10) 
									 into :ii, :sVal
									 from nd_txt where nd=:colNd and tag like 'SV___' ")
								While SqlFetchNext(hSql(), nFetchRes)  
									Set mVal[ii] = Val(sVal)
									Set ki = ki +1
							!
							Set dMemo = "Дані про додаткові платежі: " 
							If ki > 0
								Set dMemo = dMemo || "Збережені, індивідуальні"
								Call SalColorSet( dMemo, COLOR_IndexWindow, nColR )
							Else
								! загальні рекв по сукупнiй вартостi КД
								Set dMemo = dMemo || "Загально-діючі, з довідників" 
							Call SalTblPopulate(hWndForm, hSql(), 
									"SELECT Id, sFile, Name,
									        Kom1,KomRK,Insu_paw,Insu_cck,Insu_tit,Sum_note,
									        Sum_rees,Prc_mito,Sum_BTI,Prc_PF,Insu_CV
									  INTO :Idh,:sFile,:Name,
									       :Kom1,    :KomRK,   :Insu_paw,:Insu_cck,:Insu_tit,:Sum_note,
									       :Sum_rees,:Prc_mito,:Sum_BTI ,:Prc_PF,  :Insu_CV 
									  FROM CC_SVK ",  TBL_FillAll )
				Window Variables
					Number: ki
					Number: mVal[*]
					Number: ii
					String: sVal
					Number: nColR
				Message Actions
					On SAM_Create
						Set nColR = SalColorFromRGB( 255,210,250 )
						Call tbl_XL.NAS_tbl_XL()
						!
						Call SalTblSetContext(hWndForm, 0)
						Call F_XLR()
					! On SAM_DoubleClick
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Call F_XL( tbl_XL.sFile )
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails 
						Call tbl_XL.F_XLR()
					On SAM_FetchRowDone
						If ki > 0
							Set Kom1     = F_ROW (0,Kom1,Kom1)
							Set KomRK    = F_ROW (1,KomRK,KomRK)
							Set Insu_paw = F_ROW (2,Insu_paw,Insu_paw)
							Set Insu_cck = F_ROW (3,Insu_cck,Insu_cck)
							Set Insu_tit = F_ROW (4,Insu_tit,Insu_tit)
							Set Insu_CV  = F_ROW (5,Insu_CV,Insu_CV)
							Set Sum_note = F_ROW (6,Sum_note,Sum_note)
							Set Sum_rees = F_ROW (7,Sum_rees,Sum_rees)
							Set Prc_mito = F_ROW (8,Prc_mito,Prc_mito)
							Set Prc_PF   = F_ROW (9,Prc_PF,Prc_PF)
							Set Sum_BTI  = F_ROW (10,Sum_BTI,Sum_BTI)
					! On SAM_RowSetContext
						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Call F_XLR()
			! 5 закладка - Присоединн.файлы
			Pushbutton: pb_Ins
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRelation
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.883"
					Top:    0.488"
					Width:  0.45"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Завантажити файл у БД'
					On SAM_Click
						If DELO.Ins_File( colNd,'' )
							Call DELO.Nas( colNd )
			Pushbutton: pb_Upd
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbUpdate
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.883"
					Top:    0.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Зберегти коментарі до файлів з БД'
					On SAM_Click
						If DELO.Upd_File( colNd )
							Call DELO.Nas( colNd )
			Pushbutton: pb_Del
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSwitch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.883"
					Top:    1.321"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELREC.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Вилучити файл з БД'
					On SAM_Click
						If DELO.ID > 0
							If DELO.Del_File( colNd, DELO.ID, DELO.SPECIFIC )
								Call DELO.Nas( colNd )
			Pushbutton: pb_View
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSwitch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.883"
					Top:    1.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Переглянути/Виконати файл з БД'
					On SAM_Click
						If DELO.ID > 0
							Call DELO.View_File( colNd, DELO.ID, DELO.SPECIFIC, DELO.F_SIZE )
			Child Table: DELO
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   1.383"
						Top:    0.488"
						Width:  10.6"
						Width Editable? Yes
						Height: 2.833"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Систем
								 №
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: INFORM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Коротко:
								Зміст
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 50
						Data Type: String
						Justify: Left
						Width:  5.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							! On SAM_SetFocus
								                                                                                                                                                                                                                                                                                                                                                                                                   If INFORM = STRING_Null
									                                                                                                                                                                                                                                                                                                                                                                                                   Set INFORM = '?'
					Column: SPECIFIC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Специфікація
								 файлу
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 70
						Data Type: String
						Justify: Left
						Width:  2.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: F_SIZE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Розмір
								файлу
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: Nas 
						Description:
						Returns
						Parameters
							Number: nNd
						Static Variables
						Local variables
						Actions
							Call SalTblPopulate( DELO, hSql(), sSql, TBL_FillAll)
							Call SalTblSetContext(DELO, 0)
					Function: Ins_File
						Description: Принять 1 файл  по выбору
						Returns
							Boolean:
						Parameters
							Number: nNd
							String: sSPECIFIC
							! Receive Number: nF_SIZE
						Static Variables
						Local variables
							String: strFilters[*]
							String: strFileName
							String: strFilePath
							Number: nIndex
							Number: nSize
							!
							File Handle: inFile
							Long String: sTiket
							String: sFileM[*]
							Number: nNumFiles
							! Number: nRet
						Actions
							Set strFilters[0] = 'Електронний документ'
							! Set strFilters[1] = '*'
							Set strFilters[1] = '*'||SalStrRightX( SalStrTrimX( sSPECIFIC ) , 5 )
							! Call Debug(strFilters[1])
							Set nIndex = 1
							! Set nRet = -1
							If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
								Return FALSE
							!
							Call SalWaitCursor(FALSE)
							Set strFileName = SalStrUpperX( strFileName )
							!
							If SalFileOpen ( inFile, strFileName, OF_Read )
								Set nSize = VisFileGetSize( strFileName )
								If SalFileRead( inFile, sTiket, nSize ) > 0
										and SqlPrepare( hSql(), 
										"INSERT INTO DOC_BODY( ND, BODY, F_SIZE, SPECIFIC )
										values ( :nNd, :sTiket, :nSize, :strFileName )")
										and SqlSetLongBindDatatype(2, BLOB_BYTE)
										and SqlExecute(hSql())
										and SqlPrepareAndExecute( hSql(), 'COMMIT')
									! Set nF_SIZE = nSize
									Call SalMessageBox ('Файл ' || strFileName || ' прийнято', 'Повідомлення', MB_Ok | MB_IconExclamation)
									Return TRUE
								Else
									Call SqlPrepareAndExecute( hSql(), 'ROLL')
									Return FALSE
								!
								Call SalFileClose( inFile )
							Return FALSE
					Function: Del_File
						Description:
						Returns
						Parameters
							Number: nNd
							Number: nId
							String: sFile
						Static Variables
						Local variables
							String: sTxt
						Actions
							Set sTxt = "Вилучити файл № " ||Str( nId) || "/" || sFile || " з БД "
							If SalMessageBox("Вы дійсно бажаєте " || sTxt || " ? ",
									 ' У в а г а ! ',   MB_IconQuestion | MB_YesNo ) = IDYES
								If SqlPrepareAndExecute( hSql(), "delete from DOC_BODY where ID=:nId and nd=:nNd ")
										and SqlCommitEx( hSql(), sTxt )
									Return TRUE
							Return FALSE
					Function: View_File
						Description:
						Returns
						Parameters
							Number: nNd
							Number: nId 
							String: sFile
							Number: nSize
						Static Variables
						Local variables
							String: sTxt
							!
							String: strReport
							File Handle: hFile
							Long String: sTiket
						Actions
							Set sTxt = "Вигрузити та 
									Переглянути/Виконати 
									файл № " ||Str( nId) || " / " || sFile || " з БД "
							If SalMessageBox("Вы дійсно бажаєте " || sTxt || " ? ",
									 ' У в а г а ! ',   MB_IconQuestion | MB_YesNo ) = IDYES
								! прочитать из архива этот ID и его показать
								Set strReport= SalStrTrimX( sFile )
								!
								If SqlPrepareAndExecute( hSql(),
										  "SELECT BODY INTO :sTiket from DOC_BODY 
										   where id=:nId and nd = :nNd and BODY is not null " )
										and SqlFetchNext( hSql(), nFetchRes )
									Set strReport = GetPrnDir() ||'\\'|| strReport
									If SalFileOpen( hFile, strReport, 1 )
										Call SalFileWrite( hFile, sTiket, nSize )
										Call SalFileClose( hFile )
										! Call Debug(strReport)
										Call SalLoadApp ( 'START', strReport )
								Else
									Call MessageNoWait("Неможливо знайти файл в архіві ! " ,'',2,1)
									Return FALSE
					Function: Upd_File
						Description:
						Returns
							Boolean:
						Parameters
							Number: nNd
						Static Variables
						Local variables
							Number: nRow
						Actions
							If SqlPrepare(hSql(), 
									"UPDATE DOC_BODY set INFORM = :DELO.INFORM 
									 where nd="|| Str(nNd) || " and id=:DELO.ID ")
								If SalTblDoUpdates( DELO, hSql(), TRUE)
									If SqlCommit(hSql())
										Return TRUE
							Return FALSE
				Window Variables
					String: sSql
				Message Actions
					On SAM_Create
						Set sSql =
								"SELECT INFORM, SPECIFIC, ID, F_SIZE
								 INTO :DELO.INFORM, :DELO.SPECIFIC, :DELO.ID, :DELO.F_SIZE
								 FROM DOC_BODY  where nd=:nNd order by id "
						Call DELO.Nas( colNd )
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Date/Time: mDAT
					String: sTxt
					String: sTag 
					String: sNBS
				Actions
					Call SalWaitCursor(TRUE)
					Set dfND = colNd
					Set SumN = nSumN
					If SqlPrepareAndExecute( hSqlAux(),sTmp ) and SqlFetchNext(hSqlAux(), nFetchRes) 
						! Прoдукт
						If SqlPrepareAndExecute( hSql(),
								  "SELECT name INTO :sProduct FROM CC_POTRA where id=:Product ")
								and SqlFetchNext(hSql(), nFetchRes) 
						If cb_A = 1
							Call SalShowWindow( cb_A )
							Call SalHideWindow( rb_KY )
							Call SalHideWindow( rb_KN )
							Call SalHideWindow( rb_D )
							Call SalHideWindow( rb_M )
							Call SalHideWindow( rb_I )
						Else
							Call SalHideWindow( cb_A )
						If nSOS >= 15
							Call SalDisableWindow( pbAcc ) 
							Call SalDisableWindow( pbZalog )  
						If dfSROK !=0 and dfSROK !=NUMBER_Null
							Set dfPR_SROKA = dfSROK_ost * 100/dfSROK
							Set dfPR_SROKA_ist = 100 - dfPR_SROKA
							Set dfSROK_ist = dfSROK - dfSROK_ost
							Set K_ANIK = Str(SalNumberRound( dfSROK_ist )) || '/' ||Str(SalNumberRound(dfSROK))
						!
						If nFIN != NUMBER_Null 
							If SqlPrepareAndExecute( hSqlAux2(),
									   "SELECT name INTO :cmbFIN FROM STAN_FIN where fin=:nFIN " )
									and SqlFetchNext(hSqlAux2(), nI)
						If nOBS != NUMBER_Null 
							If SqlPrepareAndExecute( hSqlAux2(),
									   "SELECT name INTO :cmbOBS FROM STAN_OBS where obs=:nOBS " )
									and SqlFetchNext(hSqlAux2(), nI)
						If nFIN != NUMBER_Null and nOBS != NUMBER_Null 
							Call F_s080(nFIN, nOBS, S080, sRISK )
						! ND_TXT
						Call SalListClear( cmb_Email )
						If SqlPrepareAndExecute( hSql(), "SELECT m.SAB INTO :sTxt FROM 
								 (select substr(c.E_MAIL,1,100) SAB from corps c where c.rnk=:dfRNK
								  union all select substr(w.VALUE,1,100) from customerw  w where w.rnk=:dfRNK and w.tag='EMAIL' 
								  union all select substr(n.txt,1,100) from nd_txt n, cc_deal d where n.tag='EMAIL' and n.nd=d.nd and d.rnk=:dfRNK and n.nd<>:colNd 
								 ) m
								 WHERE m.SAB is not null ") 
							While SqlFetchNext( hSql(), nFetchRes )
								Call SalListAdd( cmb_Email, sTxt )
						If SqlPrepareAndExecute(hSql(), "SELECT tag,Substr(txt,1,250) INTO :sTag,:sTxt FROM ND_TXT  WHERE nd=:colNd")
							While SqlFetchNext( hSql(), nFetchRes )
								If sTag='MS_NX'
									Set MS_NX = sTxt
								Else If sTag='INIC'
									Set INIC = sTxt
								Else If sTag='EMAIL'
									Call SalListAdd( cmb_Email,sTxt )
									! Set cb_Email = TRUE
									Set cmb_Email = sTxt
								Else If sTag='FLAGS'
									If Subs(sTxt,1,1)='1'
										Set rb_KN = TRUE
									Else
										Set rb_KY = TRUE
									If Subs(sTxt,2,1)='1'
										Set rb_M = TRUE
									Else If Subs(sTxt,2,1)='0'
										Set rb_D = TRUE
									Else If Subs(sTxt,2,1)='2'
										Set rb_I = TRUE
								Else If sTag='REFMO' 
									Set P_REF = Val(sTxt)
									If P_REF >0 and SqlPrepareAndExecute( hSql(),
											  "select to_number(substr(nlsb,7,9)),
											          to_number(substr(nlsa,7,9)) 
											   into :p_OLD_ND, :p_NEW_ND
											   from oper where ref=:P_REF and sos>0 and tt='REK' " )
											and SqlFetchNext( hSql(), nFetchRes )
								! Else If sTag='PAWN'
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set ml_Pawn = sTxt
								If sTag='DAYSN'
									Set dfDenSN=Val( sTxt )
									Call SalShowWindow(dfDenSN)
									Call SalShowWindow(  DATNPSN)
								Else If sTag='DATSN'
									Set DATNPSN=SalStrToDate( sTxt )
								! Else If Subs(sTag,1,1)='P' 
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set sKv = Subs(sTag,2,3)
									                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             If SqlPrepareAndExecute( hSqlAux2(),"SELECT kv INTO :nTmp_Kv FROM tabval WHERE to_char(kv)=:sKv ") 
											and SqlFetchNext( hSqlAux2(), nFetchRes)
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set i = i + 1
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             If i = 1
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfKV1   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfPROC1 = Val(sTxt)
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Else If i = 2
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfKV2   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfPROC2 = Val(sTxt)
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Else If i = 3
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfKV3   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfPROC3 = Val(sTxt)
										                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Else If i = 4
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfKV4   = nTmp_Kv
											                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Set dfPROC4 = Val(sTxt)
						!
						If SqlPrepareAndExecute( hSql(),
								  "SELECT  m.name, m.metr INTO :cmbKom, :nMetr90 
								   FROM int_accn i, int_metr m
								   WHERE i.acc=:ACC8 and i.id=2 and m.metr=i.metr ")
								and SqlFetchNext(hSql(), nFetchRes) 
						If SqlPrepareAndExecute( hSql(),
								  "SELECT ir INTO :dfKOM FROM int_ratn WHERE acc=:ACC8 and id=2 ")
								and SqlFetchNext(hSql(), nFetchRes) 
						If CC_FSC = '1'
							If SqlPrepareAndExecute( hSql(),
									  "SELECT d.prod, Substr(p.name,1,35) INTO :nPROD, :sPROD 
									   FROM cc_deal d, cc_potr p 
									   WHERE d.nd=:dfND and p.id=d.prod  ")
									and SqlFetchNext(hSql(), nFetchRes) 
						!
						If SqlPrepareAndExecute( hSqlAux(),
								  "SELECT sum(rez.OSTC96(a.ACC,:bDAT)) /100, count(*), min(a.acc)  
								   INTO :OST_,:nKol, :nAccSS
								   FROM accounts a, nd_acc n 
								   WHERE a.acc=n.acc and a.tip in ('SS ','SL ','SP ') and n.nd=:colNd " ) 
								and SqlFetchNext(hSqlAux(), nFetchRes) 
							! If dfS_UsE != 0 
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Set dfPZALOG = dfZALOG *100 / dfS_UsE
							! If OST_= 0
								                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Set dfZALOG = dfZALOG / nKol
						If SqlPrepareAndExecute( hSqlAux(),
								   "SELECT Nvl(sum(decode(substr(a.tip,1,3),'N',0,t.SZQ )),0)/100,
								           Nvl(sum(decode(substr(a.tip,1,3),'N',t.SZQ,0 )),0)/100,
								           Nvl(sum(decode(substr(a.tip,1,3),'N',0,t.SKQ2)),0)/100,
								           Nvl(sum(decode(substr(a.tip,1,3),'N',0,t.SOQ )),0)/100
								    into :G81, :G81p, :G80, :G79
								    from TMP_REZ_RISK t, nd_acc n, accounts a 
								    where t.id=:N_REZ_ and t.dat=:D_REZ_ and t.acc=n.acc and n.nd=:colNd 
								      and a.acc=n.acc and a.tip IN ('SS ', 'SL ', 'SP ', 'CR9','SPN','SLN')")
								and SqlFetchNext(hSqlAux(), nFetchRes) 
						If SqlPrepareAndExecute( hSqlAux(), "SELECT rez.CA_FQ_ZALOG_ND( :colNd, :bDAT ) /100 
								   INTO :dfZALOG  FROM dual " ) 
								and SqlFetchNext(hSqlAux(), nFetchRes) 
							If dfS_UsE != 0 
								Set dfPZALOG = dfZALOG *100 / dfS_UsE
							If OST_= 0
								Set dfZALOG = dfZALOG / nKol
							If SqlPrepareAndExecute( hSqlAux(), 
									"SELECT Abs(sum(gl.p_icurval(a.kv,a.ostc,:bDAT)))/100
									  INTO :dfZALOG_90 FROM accounts a, cc_accp p 
									  WHERE a.acc=p.acc and a.nls not like '95%' and p.accS=:nAccSS " ) 
									and SqlFetchNext(hSqlAux(), nFetchRes) 
								Set dfZALOG_95 = dfZALOG - dfZALOG_90
								If dfS_UsE != 0 
									Set dfPZALOG_95 = dfZALOG_95 *100 / dfS_UsE
									Set dfPZALOG_90 = dfZALOG_90 *100 / dfS_UsE
						Call SalWaitCursor(FALSE)
			Function: Prn_XL_GPR ! Печать в XLS граф пог кред
				Description:
				Returns
					Boolean:
				Parameters
					! String: Shablon 
				Static Variables
				Local variables
					String: Shablon 
					String: pShablon
					String: strFa
					!
					Date/Time: FDAT_
					Date/Time: dTmp
					Number: nTmp 
					Number: iTmp 
					Number: SUMO_
					Number: SUMG_
					Number: SUMK_
					Number: SUMR_
					Number: IO_
					Number: IG_
					Number: IK_
					Number: IR_
					!
					Number: n
					Number: j
					Number: i
					! String: sISP 
					Number: nErr
					Number: First_SDI_FSC
				Actions
					Call SalWaitCursor(TRUE)
					! If
					Set Shablon='GPK.XLS'
					! Set s9 =  SalNumberToChar( 9 )
					! Полное имя шаблона1
					Set pShablon = GetTemplateDir() || "\\" || Shablon
					Set strFa = GetPrnDir() || "\\G" || Str(dfND)||".XLS"
					Call VisFileSetAttribute( strFa, FA_ReadOnly, FALSE )
					Call VisFileDelete(strFa)
					Set nErr = VisFileCopy( pShablon, strFa )
					! Для FSC 
					If CC_FSC = '1'
						If SqlPrepareAndExecute( hSql(),
								"select wcs_utl.get_sbp_mac(cd.prod, 'KOM1') * cd.sdog / 100 
								  INTO :First_SDI_FSC   from cc_deal cd where cd.nd = :dfND" )
					If nErr <0
						Call SalWaitCursor(FALSE)
						Call MessageNoWait( 'Не удалось найти файл - '||pShablon||' или скопировать его в папку - '||strFa,'Ошибка '||Str(nErr),10,0) 
						Return FALSE
					! говорим что хотим работать с Excel
					Set excel.nTargetApp = atExcel
					! создаем excel 
					If excel.OpenApplication()
						! загружаем туда шаблон с диска
						Call excel.LoadDoc( strFa )
						! пример заполнения отдельной ячейки (X=1, Y=3)
						! Номер договору
						Call excel.SetTableCell(4,2,dfCC_ID ) 
						! Дата угоди
						Call excel.SetTableCell(6,2,SalFmtFormatDateTime( dfDAT1, 'dd.MM.yyyy' ) )
						! Дата надання
						Call excel.SetTableCell(4,8,SalFmtFormatDateTime( dfDAT3, 'dd.MM.yyyy' ) )
						! Сума кредиту
						Call excel.SetTableCell(4,9, SalNumberToStrX( SumN,2) )
						! Термін кредиту в міс
						Call excel.SetTableCell(4,10, Str(dfSROK) )
						! % ставка
						Call excel.SetTableCell(4,13,Str(dfPROC)||'%') 
						! Плата за надання
						Call excel.SetTableCell(4,16,Str(dfKOM1 )||'%' )
						! Плата за управління
						Call excel.SetTableCell(4,17,Str(dfKOM)||'%') 
						! Дата надання
						Call excel.SetTableCell(1,27,SalFmtFormatDateTime( dfDAT3, 'dd.MM.yyyy' ) )
						Set dTmp = dfDAT3
						!
						! Set DtmpY =AddMonths( dfDAT3, -12)
						Set n = 27
						Set j = 0
						! Сигнал для разрисовки  таблицы ВКЛЮЧИТЬ
						Call excel.SetTableCell(26,1,'1' )
						! Set SUMS_ = SumN*100
						Set IO_ = 0
						Set IG_ = 0
						Set IK_ = 0
						Set IR_ = 0
						Set iTmp= 0 
						If SqlPrepareAndExecute( hSql(),
								"select fdat,sumo/100, sumg/100, nvl(sumk,0)/100, (nvl(sumo,0)-nvl(sumg,0)-nvl(sumk,0))/100
								 Into :FDAT_, :SUMO_,:SUMG_, :SUMK_, :SUMR_
								 from cc_lim 
								 where nd=:dfND and fdat> :dfDAT3 
								 order by fdat" )
							While SqlFetchNext( hSql(), nFetchRes) 
								Set j = j + 1
								Set nTmp = FDAT_ - dTmp
								Set dTmp = FDAT_
								Set i = n + j
								! Передать строку
								! 1(A) - Дата
								Call excel.SetTableCell(1,i,SalFmtFormatDateTime( FDAT_, 'dd.MM.yyyy' ) )
								! 2(B) - Дней
								Call excel.SetTableCell(2,i, Str(nTmp) )
								! 3(C) - Общ.сумма платежа = 
								Call excel.SetTableCell(3,i, SalNumberToStrX( SUMO_,2) )
								! 4*(D) - Тело кредита
								Call excel.SetTableCell(4,i, SalNumberToStrX( SUMG_,2) )
								! 5*(E) - Сумма %
								Call excel.SetTableCell(5,i, SalNumberToStrX( SUMR_,2) )
								! 6*(F) - Ежемес комиссия 
								Call excel.SetTableCell(6,i, SalNumberToStrX( SUMK_,2) )
								!
								Set IO_ = IO_ + SUMO_
								Set IG_ = IG_ + SUMG_
								Set IK_ = IK_ + SUMK_
								Set IR_ = IR_ + SUMR_
								Set iTmp= iTmp+ nTmp
							Set i = i + 1
						! Итоги :Передать строку
						! 1(A) - 
						Call excel.SetTableCell(1,i, 'Усього'  )
						! 2(B) - Дней
						Call excel.SetTableCell(2,i, Str(iTmp) )
						! 3(C) - Общ.сумма платежа = 
						Call excel.SetTableCell(3,i, SalNumberToStrX( IO_,2) )
						! 4*(D) - Тело кредита
						Call excel.SetTableCell(4,i, SalNumberToStrX( IG_,2) )
						! 5*(E) - Сумма %
						Call excel.SetTableCell(5,i, SalNumberToStrX( IR_,2) )
						! 6*(F) - Ежемес комиссия 
						Call excel.SetTableCell(6,i, SalNumberToStrX( IK_,2) )
						! Сигнал для разрисовки  таблицы ВЫКЛЮЧИТЬ
						Call excel.SetTableCell(26,1,'2' )
						Call excel.SetTableCell(26,1,' ' )
						! Підпис Позичальника 
						Call excel.SetTableCell(1,i+2, 
								'Підпис Позичальника на цьому Договорі свідчить про отримання ним всієї інформації про умови кредитування' )
						Call excel.SetTableCell(1,i+4, 'Кредитодавець' )
						Call excel.SetTableCell(6,i+4, 'Позичальник' )
						!
						Call excel.SetTableCell(1,i+5, GetBankName() )
						! Call excel.SetTableCell(1,i+6, dfISP )
						Call excel.SetTableCell(1,i+6, GetUserRealName() )
						Call excel.SetTableCell(6,i+6, dfNMK )
						Call excel.SetTableCell(1,i+7, '_____________' )
						Call excel.SetTableCell(6,i+7, '_____________' )
						Call excel.SetTableCell(1,i+9, 'МП' )
						! показываем excel на экран
						Call excel.ShowApplication()
						Call SalWaitCursor(FALSE)
						Return TRUE
					Call SalWaitCursor(FALSE)
					Return FALSE
		Window Parameters
			Number: nTip_Ur
			Number: colNd
			Number: nTip_Kl
			Number: nGr
			String: sKV1
			String: sKV2
			String: sKV3
			Number: nSumN
			Number: nTip_Dop	! пока используется только в функции просмотра 
		Window Variables
			String: sTmpM
			Boolean: bTmp
			Long String: sAIM
			Number: nSOS
			Number: nTmpE
			Number: ACCS
			Number: ACC8
			Number: nFIN
			Number: nOBS
			Number: nI
			Number: nND
			Number: nFreq
			Number: nRefv
			Number: nRefp
			Number: nIsto
			Number: nVidd
			Number: nAcc
			Number: nAccSS
			Number: nMetr90
			Number: nAccSN
			Number: nAccSL
			Number: nAccSP
			Number: nAccSG
			Number: nAccSPN
			Number: nKol
			Number: OST
			Number: OSTE
			Number: OST_
			Number: nTmp
			String: TIP
			String: NLS
			String: sTmp
			String: sTmpT
			Date/Time: DAT1
			Date/Time: bDAT
			String: sNazn
			: excel
				Class: cReportConstructor
			String: sTabGetName
		Message Actions
			On SAM_Create
				If D_REZ_ = DATETIME_Null and U_REZ_ = STRING_Null
					If SqlPrepareAndExecute( hSql(),
							"select min(p.USERID), max(p.DAT) into :N_REZ_, :D_REZ_ 
							 from REZ_PROTOCOL p WHERE exists 
							(select 1 from TMP_REZ_RISK where DAT= p.DAT and id=p.USERID) " )
						If NOT SqlFetchNext( hSql(), nFetchRes) 
							Set U_REZ_ = "***"
						Else
							If SqlPrepareAndExecute( hSql(),"select fio into :U_REZ_ from staff where id=:N_REZ_")
									and SqlFetchNext( hSql(), nFetchRes) 
				Set dU_REZ = U_REZ_
				Set dD_REZ = D_REZ_
				!
				Call SalSetWindowText(hWndForm, 'ПАРАМЕТРЫ КД Реф = '|| Str(colNd ) )
				Call ShowApdVersion('04')
				! Call SetWindowFullSize(hWndForm)
				Call PrepareWindowEx(hWndForm)
				Set bDAT = GetBankDate()
				! Call SalDisableWindow( pbGPK )
				If nTip_Ur  = 20 ! Бухгалтер
					! Call SalDisableWindow( pbGPK )
					! Call SalDisableWindow( pbDoc )
					!
					Call SalDisableWindow( pbZalog ) 
					Call SalDisableWindow( pbZalog_All ) 
				Else If nTip_Ur  = 10 ! Кредитчик
					Call SalDisableWindow( pbAcc )
					!
					Call SalDisableWindow( pbZalog ) 
					Call SalDisableWindow( pbZalog_All ) 
				Else If nTip_Ur  = 90 ! 
					Call SalDisableWindow( pb_S080 ) 
					Call SalDisableWindow( pb_AIM ) 
					Call SalDisableWindow( pb_Otrasl )
					Call SalDisableWindow( cmbFIN ) 
					Call SalDisableWindow( cmbOBS ) 
					Call SalDisableWindow( pbRas_Fak )
					! Call SalDisableWindow( pbDoc ) 
					Call SalDisableWindow( pbPrcAcc )  
					Call SalDisableWindow( pbAcc )  
					Call SalDisableWindow( pbZalog )
					Call SalDisableWindow( pbZalog_All )
					Call SalDisableWindow( pbZ ) 
					! Call SalDisableWindow( pbDOP ) 
					! Call SalDisableWindow( tbl_DOP.TXT ) 
					!
				Else If nTip_Ur  = 30 ! Залоговик
					! Call SalDisableWindow( pbGPK )
					! Call SalDisableWindow( pbDoc )
					Call SalDisableWindow( pbAcc )
					Call SalDisableWindow( pb_Lim )
					Call SalDisableWindow( pbTEK )
			On SAM_CreateComplete
				Call SalDisableWindow( rb_KY )
				Call SalDisableWindow( rb_KN )
				Call SalDisableWindow( rb_D )
				Call SalDisableWindow( rb_M )
				Call SalDisableWindow( rb_I )
				!
				If GetGlobalOption('CCPRD') = STRING_Null
					Call SalHideWindow (rb_I)
				If nTip_Kl != 2
					Call SalHideWindow (rb_I)
				! Novikov изменил acrN.FPROCN(a.ACCS,0) на decode(nvl(acrn.fproc(ac.acc),0),0,r.ir,acrn.fproc(ac.acc))
				Set sTmp = "
						    SELECT  AC.acc, c.prinsider||' '||p.name, d.user_id||' '||u.FIO,
						           d.cc_id, v.name , c.nmk,  c.rnk,  m.name,
						           s.name   , s.sour , t.name , t.kv,   -ac.ostx/100,  f.name, f.freq, 
						           d.sdate  , a.bdate, d.wdate, a.wdate,o.name, decode(nvl(acrn.fprocn(ac.acc,0),0),0,r.ir,acrn.fprocn(ac.acc,0)),
						           a.refv   , a.refp , nvl(d.FIN,c.crisk), d.OBS,  c.okpo, k.grp, c.country, k.name,
						           months_between (d.wdate,a.bdate),months_between (d.wdate,:bDAT),
						           a.ACCS, d.vidd, -ac.ostc/100, (ac.ostc-ac.ostx)/100, 
						           gl.p_icurval(ac.kv,-ac.ostc,:bDAT)/100, d.sos,
						           i.S, i.APL_DAT, fi.NAME, d.wdate-a.bdate, nvl(d.KPROLOG,0),
						           d.PROD, nvl(i.BASEM,0) 
						    INTO :ACC8,  :dfINSIDER,:dfISP, :dfCC_ID,:dfVID, :dfNMK,   :dfRNK, :dfCEL,
						         :dfISTO, :nIsto,   :dfKV,   :nKv,    :dfS,   :dfPERIOD,:nFreq, 
						         :dfDAT1, :dfDAT2,  :dfDAT4, :dfDAT3, :dfSOS, :dfPROC,
						         :nRefv,  :nRefp,   :nFIN,   :nOBS,   :dfOKPO,:dfGRP, :nCOUNTRY,:sCOUNTRY,
						         :dfSROK, :dfSROK_ost, 
						         :ACCS ,  :nVidd,   :dfS_Us, :dfS_Free,:dfS_UsE,:nSOS,
						         :dfDen,  :DATNP,   :cmbFREQP, :dfDNI, :dKPROL, :Product, :cb_A  
						    FROM cc_deal  D, cc_vidd   V,  customer C, cc_aim    M, 
						         staff    U, cc_source S,  tabval   T, freq      F, 
						         cc_add   A, cc_sos    O, prinsider P, accounts AC, 
						         nd_acc   N, int_accn  I,  freq    FI,
						         country  K, int_ratn r
						WHERE u.id (+)   =d.user_id   AND d.nd  =:colNd AND d.nd  =n.nd   AND
						      p.prinsider(+)=c.prinsider AND n.acc =ac.acc AND ac.tip='LIM'  AND 
						      d.vidd     =v.vidd      AND v.tipd=1      AND c.rnk =d.rnk  AND
						      m.aim(+)   =a.aim       AND a.kv  =t.kv   AND s.sour=a.sour AND
						      a.freq     =f.freq(+)   AND a.nd  =d.nd   AND d.sos =o.sos  AND
						      i.acc      =n.acc       AND i.id  =0      AND i.freq=fi.freq (+) AND
						      k.country=c.country AND r.id=0 AND r.acc(+)=ac.acc"
				Call NASELENIE()
			On UM_CreateDoc
				Call SalModalDialog( dlg_CreateDoc, hWndForm, dfND )
	Form Window: Frm_IBOX
		Class:
		Property Template:
		Class DLL Name:
		Title: IBOX-довідка по КД
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.375"
				Top:    1.719"
				Width:  9.75"
				Width Editable? Yes
				Height: 3.679"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 1552
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  8.9"
					Width Editable? Yes
					Height: 1.333"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: № КД
				Resource Id: 1600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.345"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.571"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "№ КД" )
			Background Text: Дата народження
				Resource Id: 1599
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.383"
					Top:    0.345"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: BDAY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.571"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Дата народження позичальника" )
			Background Text: Позичальник
				Resource Id: 1597
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.583"
					Top:    0.345"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: FIO1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.383"
						Top:    0.571"
						Width:  4.3"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Імя Позичальника" )
			Data Field: FIO2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.383"
						Top:    0.905"
						Width:  4.3"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "По-батькові Позичальника" )
			!
			Pushbutton: pb_IBOX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.083"
					Top:    2.238"
					Width:  0.43"
					Width Editable? No
					Height: 0.317"
					Height Editable? No
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Picture File Name: \bars98\RESOURCE\BMP\CUSTCLSD.BMP
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'IBOX-довідка по КД '
					On SAM_Click
						Call SalWaitCursor(TRUE)
						If BDAY != DATETIME_Null and CC_ID != STRING_Null
							Set BDAY_ = BDAY
							Set CC_ID_= CC_ID
							If SqlPLSQLCommand(hSql(), "wcs_exchange.ibox_getcreditinfo
									( CC_ID_,BDAY_, nKod_, sKod_,FIO1_, FIO2_, B1_, E1_, P1_, T1_) " ) 
								Set nKod= nKod_
								Set sKod= sKod_
								Set FIO1= FIO1_
								Set FIO2= FIO2_
								Set B1 = B1_
								Set E1 = E1_
								Set P1 = P1_
								Set T1 = T1_
								!
						Call SalWaitCursor(FALSE)
			Background Text: Сума пені 
				Resource Id: 1602
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    1.595"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: P1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.821"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Сума пені" )
			Background Text: Сума поперед.несплат
				Resource Id: 1604
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.083"
					Top:    1.595"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: E1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    1.821"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Сума попередніх несплат" )
			Background Text: Поточний пл
				Resource Id: 1603
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.683"
					Top:    1.595"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: B1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.383"
						Top:    1.821"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Поточний платіж" )
			Background Text: Сумарний пл
				Resource Id: 1614
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.783"
					Top:    1.595"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: T1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    1.821"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Сумарний платіж" )
			!
			Data Field: nKod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.583"
						Top:    2.238"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Код завершення" )
			Data Field: sKod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    2.238"
						Width:  6.3"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Текст завершення" )
		Functions
		Window Parameters
			String: CC_ID_
		Window Variables
			Date/Time: BDAY_
			String: FIO1_
			String: FIO2_
			String: sKod_
			Number: nKod_
			Number: P1_ !- тек пеня
			Number: B1_ !- тек платеж
			Number: E1_ !- просрочки 
			Number: T1_ !- total
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Set CC_ID = CC_ID_
				! Set CC_ID_ = STRING_Null
				Set BDAY = DATETIME_Null
				Call SalWaitCursor(FALSE)
	Form Window: Frm_EXPRS
		Class:
		Property Template:
		Class DLL Name:
		Title: Експрес-довідка по КД
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.375"
				Top:    1.719"
				Width:  11.533"
				Width Editable? Yes
				Height: 3.19"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 1605
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  10.8"
					Width Editable? Yes
					Height: 1.083"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: Реф.КД
				Resource Id: 1606
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.345"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.571"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Реф.КД" )
			Background Text: Дата КД
				Resource Id: 1607
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.383"
					Top:    0.345"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: SDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    0.571"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Дата КД" )
			Background Text: № КД
				Resource Id: 1608
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.383"
					Top:    0.345"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.383"
						Top:    0.571"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "№ КД" )
			Background Text: ПІБ Позичальника
				Resource Id: 1609
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.783"
					Top:    0.345"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    0.571"
						Width:  4.2"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "ПІБ Позичальника" )
			!
			Pushbutton: pb_EXPRS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.783"
					Top:    1.488"
					Width:  0.43"
					Width Editable? No
					Height: 0.317"
					Height Editable? No
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Picture File Name: \bars98\RESOURCE\BMP\help2.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Експрес-довідка по КД '
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Set DAT1_ = DAT1
						If SqlPLSQLCommand(hSql(), "CC_EXPRS(ND_,CC_ID_,SDATE_,FIO_,DAT1_,B1_,E1_,P1_) " ) 
							Set CC_ID = CC_ID_
							Set SDATE = SDATE_
							Set FIO = FIO_
							Set DAT1=DAT1_
							Set B1 = B1_/100
							Set E1 = E1_/100
							Set P1 = P1_/100
						Call SalWaitCursor(FALSE)
			Background Text: Дата платежу
				Resource Id: 1610
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.183"
					Top:    1.262"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.183"
						Top:    1.488"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Дата платежу" )
			Background Text: Сума пені на Дату
				Resource Id: 1611
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    1.262"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: P1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.283"
						Top:    1.488"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Поточна сума пені на Дату" )
			Background Text: Сума платежу на Дату
				Resource Id: 1612
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.383"
					Top:    1.262"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: B1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.383"
						Top:    1.488"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Поточна сума платежу на Дату" )
			Background Text: Остаточна сума 
				Resource Id: 1613
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.683"
					Top:    1.262"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: E1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.483"
						Top:    1.488"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Остаточна сума платежу на Дату" )
			!
		Functions
		Window Parameters
			Number: ND_
		Window Variables
			String: CC_ID_
			Date/Time: SDATE_
			String: FIO_
			! Запрошенная дата
			Date/Time: DAT1_
			Number: P1_ !- тек пеня
			Number: B1_ !- тек платеж
			Number: E1_ !- окончат.платеж
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Set DAT1 = GetBankDate()
				Set ND = ND_
				Set CC_ID_ = STRING_Null
				Set SDATE_ = DATETIME_Null
				Call SalWaitCursor(FALSE)
	Dialog Box: Dlg_NdTxt
		Class:
		Property Template:
		Class DLL Name:
		Title: Специальные параметры
		Accesories Enabled? No
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.5"
				Top:    0.5"
				Width:  13.833"
				Width Editable? Yes
				Height: 6.536"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? No
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Picture: pbDOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.1"
					Width:  0.45"
					Width Editable? Yes
					Height: 0.32"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: \bars98\RESOURCE\BMP\APPLY.BMP
				Storage: Internal
				Picture Transparent Color: Gray
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText(lParam, 'Зберегти зміни в дод .реквізитах КД')
					On SAM_Click
						If nMode = 2 and nTip_Ur != 90
							If tbl_DOP.UPD_DOP()
								If not SqlPLSQLCommand(hSql(), "cck_app.Set_ND_TXT_CHECK(ND)")
									Call SqlRollbackEx(hSql(), "КД " || Str(ND) || ": ошибка выполнения cck_app.Set_ND_TXT_CHECK")
								Else
									! Call SqlCommit(hSql())
									If SqlCommitEx(hSql(),'Обновлен КД.'|| CC_ID) 
										! Call SalTblSetFlagsAnyRows ( tbl_DOP, ROW_Edited|ROW_Selected, FALSE,0, 0 )
										Call MessageNoWait('Обновление КД ' || CC_ID || ' Реф=' || Str(ND), 'Сообщение', 3, 0)
										Call tbl_DOP.setNotEditedFlag()
			Child Table: tbl_DOP
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.5"
						Width:  12.4"
						Width Editable? Yes
						Height: 3.4"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? Yes
				Contents
					Column: TAG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								Дод.рекв
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Найменування
								Дод.рекв
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TXT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значення
								Дод.рекв
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 4000
						Data Type: Long String
						Justify: Left
						Width:  3.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If Table_Name!=STRING_Null and SK_Column!=STRING_Null and FK_Column!=STRING_Null and TXT!=STRING_Null
									If SqlPrepareAndExecute( hSqlAux2(),
											 "SELECT min("|| tbl_DOP.FK_Column||"),count("|| tbl_DOP.FK_Column||")  into :new_comment,:count_comment from "||tbl_DOP.Table_Name||" where "||tbl_DOP.SK_Column||"=:tbl_DOP.TXT  and rownum<3" )
											and SqlFetchNext(hSqlAux2(), nFetchRes)
										If count_comment=1
											Set tbl_DOP.TXT2=new_comment
										Else
											Set tbl_DOP.TXT2=STRING_Null
								Else
									Set tbl_DOP.TXT2=STRING_Null
							On SAM_SetFocus
								If nMode = 1
									Set dfF4 = ''
								Else
									Set dfF4 = 'F1 - історія ВИБРАНОГО реквізита' || PutCrLf() ||
											'F2 - історія ВСІХ реквізитів' || PutCrLf()
								If nTip_Ur != 90
									Set dfF4 = dfF4 || 'F6 - редагування' || PutCrLf()
									If tbl_DOP.Table_Name != STRING_Null and tbl_DOP.SK_Column != STRING_Null
										Set dfF4 = dfF4 || 'F4 - вибрати з довідника'
							On SAM_DoubleClick
								Call Call_Ref_Book(4)
							On VTM_KeyDown
								If wParam = VK_F1 and nMode = 2
									Call F_Ist(ND, TAG)
								If wParam = VK_F2 and nMode = 2
									Call F_Ist(ND, '')
								If wParam = VK_F4
									Call Call_Ref_Book(4)
								If wParam = VK_F6
									Call Call_Ref_Book(6)
							On SAM_KillFocus
								Set dfF4 = ''
								If nMode = 2
									Set dfF4 = 'F1 - історія ВИБРАНОГО реквізита' || PutCrLf() ||
											'F2 - історія ВСІХ реквізитів'
					Column: TXT2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значення
								довідника
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.05"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FK_Column
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Роз`яснення
								довідника
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SK_Column
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Первичный ключ справочника
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Table_Name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование справочника
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNsiSqlWhere
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: 254
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: UPD_DOP
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl_DOP, nRow, ROW_Edited, 0)
								Call SalTblSetContext(tbl_DOP, nRow)
								Call SqlSetLongBindDatatype(3,22)
								If NOT SqlPLSQLCommand(hSql(), "CCK_APP.SET_ND_TXT(ND, TAG, TXT)")
									Return FALSE
								! Call SalTblSetRowFlags(tbl_DOP, nRow, ROW_Edited, FALSE)
							Return TRUE
					Function: F_Ist
						Description:
						Returns
						Parameters
							Number: pNd
							String: pTag
						Static Variables
						Local variables
							String: sWhere
							String: sTmp
							String: sTmp1
						Actions
							Set sWhere = " ND_TXT_UPDATE.nd = " || Str(pNd) || 
									    IifS(pTag = "","", " and ND_TXT_UPDATE.tag='"|| pTag || "'" ) ||
									    " ORDER BY ND_TXT_UPDATE.IDUPD desc"
							Call FunNSIGetFiltered ("ND_TXT_UPDATE","TXT", sWhere, sTmp, sTmp1)
					Function: Call_Ref_Book
						Description:
						Returns
						Parameters
							Number: nPar
						Static Variables
						Local variables
							Number: nRow
							String: Tmp_TXT
							Long String: Tmp_TXT_LONG
							Boolean: bTmp
						Actions
							If nTip_Ur != 90
								Set nRow = SalTblQueryContext(hWndForm)
								If nPar = 4 and tbl_DOP.Table_Name != STRING_Null and tbl_DOP.SK_Column != STRING_Null 
									Set Tmp_TXT = Subs(tbl_DOP.TXT,1,250)
									If FunNSIGetFilteredAltPK(tbl_DOP.Table_Name, tbl_DOP.SK_Column, tbl_DOP.FK_Column, 
											   IifS(tbl_DOP.colNsiSqlWhere!='', VisStrSubstitute(tbl_DOP.colNsiSqlWhere, ':ND', Str(ND)), ''),
											   Tmp_TXT, tbl_DOP.TXT2)
										Set tbl_DOP.TXT = Tmp_TXT
										Call SalTblSetRowFlags(tbl_DOP, SalTblQueryContext(tbl_DOP), ROW_Edited, TRUE)
										If nMode = 2
											Call SalEnableWindow(pbDOP)
								Else If nPar = 6
									Set Tmp_TXT_LONG = tbl_DOP.TXT
									Call Sel017t(hWndForm, tbl_DOP.NAME, bTmp, Tmp_TXT_LONG, TRUE)
									If bTmp > 0
										Set tbl_DOP.TXT = Tmp_TXT_LONG
										Call SalTblSetRowFlags(tbl_DOP, SalTblQueryContext(tbl_DOP), ROW_Edited, TRUE)
										If nMode = 2
											Call SalEnableWindow(pbDOP)
								Call SalSetFocus(hWndForm)
								Call SalTblSetFocusRow(hWndForm, nRow)
								Call SalTblSetFocusCell(hWndForm, nRow, TXT, 0, 0)
							Call SalWaitCursor(FALSE)
					Function: setNotEditedFlag
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nRow
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl_DOP, nRow, ROW_Edited, 0)
								Call SalTblSetRowFlags(tbl_DOP, nRow, ROW_Edited, FALSE)
				Window Variables
					String: new_comment
					Number: count_comment
					String: Tmp_TXT
				Message Actions
					On UM_Populate
						Call SalTblPopulate(hWndForm, hSql(),
								"SELECT t.tag, t.name, x.txt, t.table_name, t.nsisqlwhere,
								        (select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and showretval=1 and  mt.tabname=t.table_name) sk,
								        (select min(colname) from meta_tables mt,meta_columns mc where mt.tabid=mc.tabid and INSTNSSEMANTIC=1 and  mt.tabname=t.table_name) fk
								   INTO :TAG, :NAME, :TXT, :Table_Name, :colNsiSqlWhere, :SK_Column, :FK_Column
								   FROM CC_TAG t, ND_TXT x
								  WHERE t.TAGTYPE ='CCK' " ||
								        IifS(nMode=1, "
								    AND t.tag not in ('AIM', 'ARJK', 'AUTOR', 'DASPN', 'DATSP', 'DINDU', 'DO_DU', 'KAT5',
								                      'MS_NX','INIC','PAWN','S_SDI','R_CR9','V_CR9','I_CR9','EMAIL','FLAGS','SN8_R',
								                      'DAYSN','DATSN','S260','CCRNG', 'FREQ','FREQP','NOHOP','PAWNL','PROBL','Z_SP')", "") || "
								    AND t.tag=x.tag (+) AND x.nd (+)=:ND
								    and t.code = :sCode
								  ORDER BY t.tag", TBL_FillAll)
					On SAM_FetchRowDone
						If tbl_DOP.Table_Name != STRING_Null
							Set Tmp_TXT=Subs(tbl_DOP.TXT,1,250)
							If SqlPrepareAndExecute( hSqlAux2(),
									 "SELECT min("|| tbl_DOP.FK_Column||") into :tbl_DOP.TXT2 from "||tbl_DOP.Table_Name||" where "||tbl_DOP.SK_Column||"=:Tmp_TXT" )
									and SqlFetchNext(hSqlAux2(), nFetchRes)
							! Call XSalTblSetCellBackColor(colValue, COLOR_LightGray)
							Call XSalTblSetRowBackColor(tbl_DOP,SalTblQueryContext ( tbl_DOP ),COLOR_LightGray)
					On SAM_TblDoDetails
						If nMode = 2
							Set dfF4 = 'F1 - історія ВИБРАНОГО реквізита' || PutCrLf() ||
									'F2 - історія ВСІХ реквізитів'
					On VTM_KeyDown
						If nMode = 2
							If wParam = VK_F1
								Call F_Ist(ND, TAG)
							If wParam = VK_F2
								Call F_Ist(ND, '')
			Multiline Field: dfF4
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? No
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.2"
						Top:    5.0"
						Width:  12.1"
						Width Editable? Yes
						Height: 0.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: strPassPar
			String: InParam[5]
			Number: nMode
			Number: ND
			String: CC_ID
			Number: nTip_Ur
			Window Handle: hWndParent
			!
			String: sCode
			!
			Number: nWW
			Number: nWH
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeigh
			Number: nTblX0
			Number: nTblY0
			Number: nTblWidth
			Number: nTblHeigh
		Message Actions
			On PAGEM_Initialize
				! Call Debug('AccSP')
				! Меняем шрифты на окнах
				Call SetWindowFont(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				! Инициализация
				Set strPassPar = SalNumberToHString( lParam )
				If SalStrTokenize(strPassPar, '', ';', InParam) < 5
					Return FALSE
				Set nMode      = SalStrToNumber(InParam[0])
				Set ND         = SalStrToNumber(InParam[1])
				Set CC_ID      = InParam[2]
				Set nTip_Ur    = SalStrToNumber(InParam[3])
				Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[4]))
				If nMode = 1
					Call SalHideWindow(pbDOP)
					Call SalSetWindowLoc(hWndForm.Dlg_NdTxt.tbl_DOP, 0, 0)
					Call SalSetWindowSize(hWndForm.Dlg_NdTxt.tbl_DOP,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinWidth, FALSE)-0.01,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinHeigh, TRUE)-1)
				Else
					Call SalSetWindowLoc(hWndForm.Dlg_NdTxt.tbl_DOP, 0, 0.5)
					Call SalSetWindowSize(hWndForm.Dlg_NdTxt.tbl_DOP,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinWidth, FALSE)-0.01,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinHeigh, TRUE)-1.5)
			On UM_Insert
				Set sCode = hWndParent.Dlg_NdTxtTab.sCode
				Call SalSendMsg(hWndForm.Dlg_NdTxt.tbl_DOP, UM_Populate, 0, 0)
			On UM_Update
				If not tbl_DOP.UPD_DOP() 
					Return 2
				Return 1
			On WM_Size
				Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
				If nMode = 1
					Call SalSetWindowSize(hWndForm.Dlg_NdTxt.tbl_DOP,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinWidth, FALSE)-0.01,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinHeigh, TRUE)-1)
				Else
					Call SalSetWindowSize(hWndForm.Dlg_NdTxt.tbl_DOP,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinWidth, FALSE)-0.01,
							     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.tbl_DOP, nWinHeigh, TRUE)-1.5)
				Call SalGetWindowLoc(hWndForm.Dlg_NdTxt.dfF4, nWW, nWH)
				Call SalSetWindowLoc(hWndForm.Dlg_NdTxt.dfF4, nWW,
						     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.dfF4, nWinHeigh, TRUE)-0.83)
				Call SalGetWindowSize(hWndForm.Dlg_NdTxt.dfF4, nWW, nWH)
				Call SalSetWindowSize(hWndForm.Dlg_NdTxt.dfF4,
						     SalPixelsToFormUnits(hWndForm.Dlg_NdTxt.dfF4, nWinWidth, FALSE), nWH)
				Call SalInvalidateWindow(hWndForm)
	Form Window: Dlg_NdTxtTab
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
		Contents
			Picture: picDopTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 6162426F74746F6D 4D617267696E0002 0030000054616250
0040: 616765436F756E74 0002003100005461 624C6162656C7300 07004C6162656C30
0060: 00005461624E616D 65730006004E616D 6530000054616252 696768744D617267
0080: 696E000200300000 5461624472617753 74796C65000B0057 696E39355374796C
00A0: 650000546162466F 726D506167657300 0100000054616254 6F704D617267696E
00C0: 0002003000000000 0000000000000000 0000000000000000 0000
.enddata
.data CLASSPROPSSIZE
0000: DA00
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_ObjActivate
						Call SalSendClassMessage(SAM_Create, wParam, lParam)
						! Создаем закладки
						Set nTabNum = 0
						Set i = 0
						Call SqlPrepareAndExecute(hSql(),
								"select unique code, code_name, ord
								   into :sCode, :sCodeName, :sCodeOrd
								   from v_cctag_codes
								  order by ord")
						While SqlFetchNext(hSql(), nFetchRes)
							Set cTabSP[i].Label = sCodeName
							Set cTabSP[i].Name = sCode
							Set cTabSP[i].DlgName = 'Dlg_NdTxt'
							Call createTab(cTabSP[i])
							Set i = i + 1
						! Удаляем последнюю пустую закладку
						Call picDopTabs.Delete(nTabNum, TRUE)
						! Инициализация закладок
						Call picDopTabs.InitializeFormPages(
								     SalNumberToStrX(nMode,0) || ';' ||
								     SalNumberToStrX(ND,0) || ';' ||
								     CC_ID || ';' ||
								     SalNumberToStrX(nTip_Ur,0) || ';' ||
								     Str(SalWindowHandleToNumber(hWndForm)) )
						! Показываем первую закладку
						Call picDopTabs.BringToTop(0, TRUE)
					On TABSM_TabActivateStart
						Call GetName(wParam, sTabName)
						Set nTab = GetTop()
						Set sCode = cTabSP[nTab].Name
						Call SalSendMsg(picDopTabs.Items[nTab].m_hWndPage, UM_Insert, 0, 0)
		Functions
			Function: createTab
				Description:
				Returns
					Boolean:
				Parameters
					: Tab
						Class: cNdTxtTab
				Static Variables
				Local variables
				Actions
					Call picDopTabs.Insert(nTabNum,TRUE)
					Call picDopTabs.SetLabel(nTabNum, Tab.Label, TRUE)
					Call picDopTabs.SetName(nTabNum, Tab.Name)
					Call picDopTabs.AddPage(Tab.Name, Tab.DlgName, hWndNULL)
					Call picDopTabs.Enable(nTabNum, TRUE)
					Call picDopTabs.CreatePage(Tab.Name)
					Set Tab.TabNum = nTabNum
					Set nTabNum = nTabNum + 1
					Return TRUE
		Window Parameters
		Window Variables
			String: strPassPar
			String: InParam[5]
			Number: nMode
			Number: ND
			String: CC_ID
			Number: nTip_Ur
			Window Handle: hWndParent
			!
			: cTabSP[*]
				Class: cNdTxtTab
			Number: nTabNum
			Number: nTab
			String: sTabName
			String: sCode
			String: sCodeName
			String: sCodeOrd
			Number: i
			!
			Number: nRet
			! Number: nErrTab
		Message Actions
			On PAGEM_Initialize
				! Call Debug('Dlg_NdTxtTab')
				! Меняем шрифты на окнах
				Call SetWindowFont(hWndForm)
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				! Инициализация
				Set strPassPar = SalNumberToHString( lParam )
				If SalStrTokenize(strPassPar, '', ';', InParam) < 5
					Return FALSE
				Set nMode      = SalStrToNumber(InParam[0])
				Set ND         = SalStrToNumber(InParam[1])
				Set CC_ID      = InParam[2]
				Set nTip_Ur    = SalStrToNumber(InParam[3])
				Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[4]))
				!
				Call SalSendMsg(picDopTabs, UM_ObjActivate, 0, 0)
				If nMode = 1
					Set hWndParent.DEAL1.hWndNdTxtTab = hWndForm
				! Else
					                                                    Set hWndParent.frm_KD.hWndNdTxtTab = hWndForm
			On UM_Update
				! Проверка на обязательное заполнение
				Set i = 0
				While i < nTabNum
					Call picDopTabs.BringToTop(i, TRUE)
					Set nRet = SalSendMsg(picDopTabs.Items[i].m_hWndPage, UM_Update, 0, 0)
					If nRet = 2
						! Set nErrTab = picDopTabs.GetTop()
						Break
					Set i = i + 1
				! Показываем первую закладку
				Call picDopTabs.BringToTop(0, TRUE)
				Return nRet
	Dialog Box: dlg_Restr
		Class:
		Property Template:
		Class DLL Name:
		Title: Введення інформації про реструктуризацію
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.017"
				Width Editable? Yes
				Height: 5.286"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Реф.Кд:
				Resource Id: 32360
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.177"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    0.156"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Номер КД:
				Resource Id: 32361
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.427"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    0.406"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата початку КД:
				Resource Id: 32362
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.677"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: SDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    0.656"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата закінчення КД:
				Resource Id: 32363
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.927"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: WDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    0.906"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: РНК позичальника:
				Resource Id: 32364
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    1.177"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    1.156"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Назва позичальника:
				Resource Id: 32365
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    1.427"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Суть реструктуризації:
				Resource Id: 32366
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    1.677"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Вид реструктуризації:
				Resource Id: 32367
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    1.927"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    1.406"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: S_RESTR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    1.656"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: VID_RESTR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    1.906"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On WM_KeyUp
						If wParam=0x73      ! VK_F4
							! Call DebugN(2)
							Call FunNSIGetFiltered ("CCK_RESTR_VID","NAME_RESTR", STRING_Null, VID_RESTR, N_RESTR)
			Background Text: Назва виду реструктуризації:
				Resource Id: 32368
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    2.177"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: N_RESTR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    2.156"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата реструктуризації:
				Resource Id: 32369
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    2.427"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    2.406"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: dd.MM.yyyy
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата закінч. реструктуризації:
				Resource Id: 32370
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    2.677"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: FDAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    2.656"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Номер додаткової угоди:
				Resource Id: 32371
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    2.927"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: N_DODATOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    2.906"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Ознака вкл.в#F8 файл(0-не вкл.1-вкл):
				Resource Id: 32372
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    3.177"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: PR_NO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    3.156"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Коментар:
				Resource Id: 32373
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    3.427"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.286"
						Top:    3.406"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTBarButton
				Property Template:
				Class DLL Name:
				Title: Зберегти
				Window Location and Size
					Left:   1.271"
					Top:    3.948"
					Width:  2.4"
					Width Editable? Class Default
					Height: 0.583"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\SAVE.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If VID_RESTR != STRING_Null
							If SqlPrepareAndExecute( hSql(),
									  "insert into cck_restr (ND,FDAT,VID_RESTR,TXT,FDAT_END,PR_NO,CC_ID,SDATE,WDATE,RNK,NMK,S_RESTR,N_DODATOK,CUSTTYPE) 
									values(:ND,:FDAT,:VID_RESTR,:TXT,:FDAT_END,:PR_NO,:CC_ID,:SDATE,:WDATE,:RNK,:NMK,:S_RESTR,:N_DODATOK,:nCt)" )  
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback( hSql() )
						Call SalEndDialog( hWndForm, 0)
						! Call SalBringWindowToTop ( frm_KD )
						! Call SalDestroyWindow(hWndForm)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTBarButton
				Property Template:
				Class DLL Name:
				Title: Відхилити
				Window Location and Size
					Left:   4.686"
					Top:    3.906"
					Width:  2.4"
					Width Editable? Class Default
					Height: 0.583"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 0)
						! Call SalDestroyWindow(hWndForm)
						! Call SalBringWindowToTop (frm_KD) 
			Background Text: F4 - Довідник
				Resource Id: 32374
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.583"
					Top:    1.929"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
		Window Parameters
			Number: nNd
		Window Variables
			Number: nCountL
			Number: nCountM
			Number: nCt
		Message Actions
			On SAM_Create
				If SqlPrepareAndExecute( hSql(),
						  "select  trunc(sysdate) ,d.nd,d.cc_id,d.sdate,d.wdate,d.rnk,c. nmk,c.custtype into :FDAT,:ND,:CC_ID,:SDATE,:WDATE,:RNK,:NMK,:nCt 
						    from cc_deal d, customer c  where d.nd=:nNd and d.rnk=c.rnk" ) and NOT SqlFetchNext( hSql(), nFetchRes )
				Call SalCenterWindow(hWndForm)
