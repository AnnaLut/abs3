.head 0 +  Application Description:
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000C30000 002C000000020000 0003000000000000 00AB010000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 020000000016713A 5C6261727339385C 62696E5C50425F31 2E61706418713A5C
0020: 6261727339385C62 696E5C6E65776170 702E646C6C18713A 5C6261727339385C
0040: 62696E5C6E657761 70702E6170630000 01010115433A5C43 454E545552415C6E
0060: 65776170702E7275 6E15433A5C43454E 545552415C6E6577 6170702E646C6C15
0080: 433A5C43454E5455 52415C6E65776170 702E617063000001 0101135C42415253
00A0: 39385C42494E5C5A 41592E415044165C 4241525339385C42 494E5C6E65776170
00C0: 702E646C6C165C42 41525339385C4249 4E5C6E6577617070 2E61706300000101
00E0: 0115433A5C43454E 545552415C6E6577 6170702E61706C15 433A5C43454E5455
0100: 52415C6E65776170 702E646C6C15433A 5C43454E54555241 5C6E65776170702E
0120: 6170630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0038B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: GENTBLS.APL
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: Gentimer.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: qckdvc.apl
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: GENTBLD.APL
.head 2 -  File Include: GENTBLF.APL
.head 2 -  File Include: Genlist.apl
.head 2 -  !
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: otcn.apd
.head 2 -  Dynalib: MsOffice.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: zayf.apd
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Number: #00000
.head 3 -  Number: 0000
.head 3 -  Number: #0000
.head 3 -  Number: #0000000
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Date/Time: ddMMM-yyyy
.head 3 -  Date/Time: dd.MM.yyyy
.head 3 -  Number: #000000000
.head 3 -  Number: 00000
.head 3 -  Number: #000
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 3323127185
0000: 1E00000010000000 0000000000000000 0200800100000008 0100E0010D000000
0020: FF3F
.enddata
.head 3 -  Sql Handle: hSqlTmp1
.head 3 -  Sql Handle: hSqlTmp2
.head 3 -  Sql Handle: hSqlTmp3
.head 3 -  Number: nFetchRes
.head 3 -  Window Handle: hWnd0
.head 3 -  Window Handle: hWnd1
.head 3 -  Window Handle: hWnd2
.head 3 -  Window Handle: hWnd3
.head 3 -  Window Handle: hWnd4
.head 3 -  Window Handle: hWnd5
.head 3 -  Window Handle: hWnd8
.head 3 -  Window Handle: hWndA
.head 3 -  Window Handle: hWndC
.head 3 -  Window Handle: hWndK
.head 3 -  Window Handle: hWndN
.head 3 -  Window Handle: hWndNAL
.head 3 -  Window Handle: hWndP
.head 3 -  Window Handle: hWndCONV
.head 3 -  Window Handle: hWndViza
.head 3 -  String: strTitle
.head 3 -  Number: gZAYMODE
.head 3 -  Number: gZAYDAY
.head 2 +  Internal Functions
.head 3 +  Function: Zay_Init
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select nvl(max(val),0) into :gZAYMODE from birja where par = 'ZAY_MODE'")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call BIRZA('ZAY_DAY', gZAYDAY)
.head 5 -  Return TRUE
.head 3 +  Function: ZAYAVKA    !__exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 5 -  Number: z
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Инициализация
.head 5 -  Call Zay_Init()
.head 5 -  !
.head 5 +  If z = 31  ! Заявки на покупку/продажу валюты (ввод)
.head 6 +  If not IsWindow(hWnd3)
.head 7 -  Set hWnd3 = SalCreateWindow(ZAY3, hWndMDI, z, 0, STRING_Null, STRING_Null)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop (ZAY3)
.head 5 +  If z = 311 ! Заявки на покупку/продажу валюты (архив)
.head 6 +  If not IsWindow(hWnd3)
.head 7 -  Set hWnd3 = SalCreateWindow(ZAY3, hWndMDI, z, 0, STRING_Null, STRING_Null)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop (ZAY3)
.head 5 +  If z = 32  ! Подтверждения НБУ импортных контрактов
.head 6 +  If not IsWindow(hWndC)
.head 7 -  Set hWndC = SalCreateWindow(ZAYC, hWndMDI, 0, 0 )
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop ( ZAYC )
.head 5 +  If z = 35  ! Нетто заявок дилера (свод)
.head 6 +  If not IsWindow(hWnd3)
.head 7 -  Set hWnd3 = SalCreateWindow(ZAY3, hWndMDI, z, 0, STRING_Null, STRING_Null)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop ( ZAY3 )
.head 5 +  If z = 51  ! Нетто заявок дилер  (детальное)
.head 6 +  If not IsWindow(hWnd0)
.head 7 -  Set hWnd0 = SalCreateWindow(ZAY_DILER, hWndMDI, 1)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop ( ZAY_DILER )
.head 5 +  If z = 52  ! Визирование курсов дилера (детальное)
.head 6 +  If not IsWindow(hWnd8)
.head 7 -  Set hWnd8 = SalCreateWindow(ZAY_DILER, hWndMDI, 2)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop ( ZAY_DILER )
.head 5 +  If z = 8  ! Просмотр заявок на коверсию (CORP2)
.head 6 +  If not IsWindow(hWndCONV)
.head 7 -  Set hWndCONV = SalCreateWindow(ZAY_CONV, hWndMDI)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop ( hWndCONV  )
.head 3 +  Function: ZayavkaEx  !__exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar1
.head 5 -  Number: nPar2
.head 5 -  String: sPar3
.head 5 -  String: sPar4
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Инициализация
.head 5 -  Call Zay_Init()
.head 5 +  If nPar1 = 31  ! Заявки на покупку/продажу валюты текущего исполнителя
.head 6 +  If IsWindow(hWnd3)
.head 7 -  Call SalBringWindowToTop(ZAY3)
.head 6 +  Else
.head 7 -  Set hWnd3 = SalCreateWindow(ZAY3, hWndMDI, nPar1, nPar2, sPar3, sPar4)
.head 5 +  If nPar1 = 77  ! Просмотр виз заявки
.head 6 +  If IsWindow(hWndViza)
.head 7 -  Call SalDestroyWindow( hWndViza )
.head 6 -  Set hWndViza = SalCreateWindow(ZAY_VIZA, hWndMDI, nPar2)
.head 3 +  Function: F_NLS0   !! Открытие торгового счета
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: ret
.head 4 +  Parameters
.head 5 -  Receive Number: nNls
.head 5 -  Number: nKv
.head 5 -  Number: nRnk
.head 5 -  String: sNmk
.head 5 -  Receive Number: nAcc
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNbs
.head 5 -  Number: nFetchRes
.head 5 -  Number: nAutoOpen
.head 5 -  Number: nTmp
.head 5 -  String: sNls
.head 5 -  String: sNms
.head 5 -  Number: nIsp2900
.head 5 -  Number: nGrp2900
.head 5 -  String: sTobo
.head 4 +  Actions
.head 5 -  Set sNbs = Subs(Str(nNls),1,4)
.head 5 -  ! Разрешено ли автооткрытие счета
.head 5 +  If SqlPrepareAndExecute(hSql(),
  "SELECT NVL(max(fl_autopen),0) INTO :nAutoOpen 
     FROM zay_bal
    WHERE nbs = :sNbs") 
AND NOT SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Set nAutoOpen = 0
.head 5 +  If nAutoOpen = 0
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT acc INTO :nAcc 
     FROM accounts 
    WHERE kv = :nKv AND nls = :nNls") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Счет '||Str(nNls)||'/'||Str(nKv)||' не открыт!', 
                   'Внимание!', 
                   MB_IconStop)
.head 7 -  Return FALSE
.head 6 +  Else If SqlPrepareAndExecute(hSql(),
  "SELECT a.acc INTO :nAcc 
     FROM accounts a    
    WHERE a.rnk = :nRnk AND a.acc = :nAcc") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Счет '||Str(nNls)||'/'||Str(nKv)||' зарегистирован за др.клиентом!', 
                   'Внимание!', 
                   MB_IconStop)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT acc INTO :nAcc 
     FROM accounts 
    WHERE kv = :nKv AND nls = :nNls") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set sNls = Vkrz2(GetBankMfo(), Str(nNls))
.head 7 -  Set sNms = Subs(IifS (sNbs = '2900', "Торг.рах ", "Рах. ")||sNmk, 1, 38)
.head 7 +  If SalMessageBox('Счет '||sNls||'/'||Str(nKv)||' не открыт.'||
                 PutCrLf()||' Открыть ?', 
                 'Внимание!', 
                 MB_YesNo|MB_IconHand) = IDYES
.head 8 -  Set nIsp2900 = Val(GetValueStr("SELECT val FROM birja WHERE UPPER(par)='ISP2900'"))
.head 8 -  Set nGrp2900 = Val(GetValueStr("SELECT val FROM birja WHERE UPPER(par)='GRP2900'"))
.head 8 -  Set sTobo = GetValueStr("SELECT tobo FROM customer WHERE rnk=" || Str(nRnk) )
.head 8 +  ! If Op_Reg(99, 0, 0, IifN(nGrp2900!=0,nGrp2900,NUMBER_Null), nTmp, 
          nRnk, sNls, nKv, sNms ,'ODB', IifN(nIsp2900!=0,nIsp2900,GetUserId()), nAcc) 
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SaveFInfoToLog("АвтоОткрытие сч."||sNls||"/"||Str(nKv))
.head 9 -  Set nNls = Val(sNls)
.head 8 +  If SqlPLSQLCommand(hSql(),
"Op_Reg_Ex(  99, 0, 0, " || IifS(nGrp2900!=0,Str(nGrp2900),'NUMBER_Null') || ", nTmp, 
           nRnk, sNls, nKv, sNms ,'ODB', " || IifS(nIsp2900!=0,Str(nIsp2900),Str(GetUserId())) || " , nAcc, '1',
           NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null, NUMBER_Null, STRING_Null, STRING_Null,
          sTobo, NUMBER_Null)")
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SaveFInfoToLog("АвтоОткрытие сч."||sNls||"/"||Str(nKv))
.head 9 -  Set nNls = Val(sNls)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalMessageBox('Невозможно открыть счет!','Внимание!',MB_IconInformation)
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return TRUE
.head 3 +  Function: F_NLS1   !! Поиск расчетного счета  2600
.head 4 -  Description: !! Поиск расчетного счета
.head 4 +  Returns
.head 5 -  Boolean: ret
.head 4 +  Parameters
.head 5 -  String: sMfo
.head 5 -  Receive Number: nNls
.head 5 -  Number: nKv
.head 5 -  Number: nRnk
.head 5 -  String: sNmk
.head 5 -  Receive Number: nAcc
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 +  If sMfo = GetBankMfo()
.head 6 -  Call SqlPrepareAndExecute(hSql(),
  "SELECT acc, rnk 
     INTO :nAcc, :nTmp 
     FROM accounts 
    WHERE kv = :nKv AND nls = :nNls")
.head 6 +  If NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Счет '||Str(nNls)||'/'||Str(nKv)||' не открыт.',
                   'Внимание!', 
                    MB_IconAsterisk)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 +  If nRnk != nTmp AND 
SalMessageBox('Счет '||Str(nNls)||'/'||Str(nKv)
            ||' зарегистрирован за др.клиентом (РНК = '
            ||Str(nTmp)||').'||PutCrLf(  )||'Продолжить?',
              'Внимание!', 
              MB_IconAsterisk|MB_YesNo) = IDNO
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nb INTO :sTmp FROM banks WHERE mfo = :sMfo") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('МФО '||sMfo||' не открыто.',
                   'Внимание!', 
                   MB_IconAsterisk)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 +  If Str(nNls) != Vkrz2(sMfo, Str(nNls))
.head 8 -  Call SalMessageBox('Ош.контр.разряда',
                   'Внимание!', 
                   MB_IconAsterisk)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: BIRZA    !! Чтение конфигур.параметров для биржевых заявок
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: ret
.head 4 +  Parameters
.head 5 -  String: sPar
.head 5 -  Receive Number: nVal
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT to_number(val) INTO :nVal FROM birja WHERE par=:sPar " ) 
 and not SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If sPar != 'PRNT_BUY' AND 
   sPar != 'PRNT_SAL' AND 
   sPar != 'PRNT_OBZ' AND
   sPar != 'RESERV'   AND
   sPar != 'PF_CUST'  AND
   sPar != 'EIK_ND'
.head 7 -  Call SalMessageBox('Параметр '|| sPar ||' не установлен! ',
  'Внимание!', MB_IconAsterisk )
.head 6 +  Else
.head 7 -  Set nVal=-1
.head 5 -  Return TRUE
.head 3 +  Function: GET_COMMISS !! Расчет комиссии (% и/или фикс.сумма) за покупку/продажу валюты
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: pDK
.head 5 -  Number: pRNK
.head 5 -  Number: pKV
.head 5 -  Number: pSUM
.head 5 -  Date/Time: pDAT
.head 5 -  Receive Number: pCMSPRC
.head 5 -  Receive Number: pCMSSUM
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), 
  "bars_zay.get_commission (pDK, pRNK, pKV, pSUM, pDAT, pCMSPRC, pCMSSUM)")
.head 6 -  Set pCMSPRC = NUMBER_Null
.head 6 -  Set pCMSSUM = NUMBER_Null
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
.head 3 +  Functional Class: cDocZay
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: oDoc
.head 6 -  Description: вставить и подписать документ (БЕЗ ОПЛАТЫ и БЕЗ ВСТАВКИ) - копия с docfun6 от 16/12/2009
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNlsm                ! основной счет
.head 7 -  String: sNlsk                ! контра счет
.head 7 -  Number: nDk          ! признак д/к
.head 7 -  String: sNam         ! наименование транзакции
.head 7 -  String: sNazns       ! способ заполнения  "назначения платежа"
.head 7 -  String: sNaznk       ! код "назначения платежа"
.head 7 -  Number: nBis         ! номер БИС
.head 7 -  Number: nRet
.head 7 -  Number: nRec
.head 7 -  Number: nFetchRes
.head 7 -  String: sErrTxt
.head 7 -  Boolean: bNewDoc     ! флаг "вновь вставляемый документ"
.head 7 -  ! ! Number: nOtv         ! Флаг "ответственная виза"
.head 7 -  Number: fsig        ! Вид ЭЦП на визе: 0-Отсут, 1-Внутр, 2-СЭП, 3-Внутр+СЭП
.head 6 +  Actions
.head 7 -  Set bNewDoc = FALSE
.head 7 -  Set nRet = 0
.head 7 +  While TRUE
.head 8 -  ! Читать описание транзакции
.head 8 +  If not SqlPrepareAndExecute(hSql(), T("
   SELECT dk,nlsm,nlsk,fli,flags[35,35],flags[38,38],flags[2,2],name
   FROM tts WHERE tt=:m_sTT
     INTO :nDk,:sNlsm,:sNlsk,:m_nFli,:m_nFbi,:m_nFlg,:fsig,:sNam"))
.head 9 -  Break
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sErrTxt = 'Не описана транзакция ' || m_sTT
.head 9 -  Break
.head 8 -  ! Call Debug( '* fsig = '||SalNumberToStrX( fsig, 0 ) )
.head 8 +  If m_nDk = NUMBER_Null ! Если д/к не задали - берем из TTS
.head 9 -  Set m_nDk = nDk
.head 9 -  Set b_WasDkNull = TRUE
.head 8 +  Else
.head 9 -  Set b_WasDkNull = FALSE
.head 8 -  ! Получить референцию для документа
.head 8 +  If not m_nRef
.head 9 +  If not Ref(m_nRef)
.head 10 -  Set sErrTxt = 'Невозможно получить референцию для ДОК'
.head 10 -  Break
.head 9 -  Set bNewDoc = TRUE
.head 8 +  If not SalStrTrimX(m_sNd)
.head 9 -  Set m_sNd = SalNumberToStrX(m_nRef, 0)
.head 8 +  If not SalStrTrimX(m_sNazn)
.head 9 -  Set m_sNazn = SalStrTrimX(sNam)
.head 8 +  If not SalStrTrimX(m_sRef_A)
.head 9 -  Set m_sRef_A = SalNumberToStrX(m_nRef, 0)
.head 8 +  If SalStrLength(A.Nam) > 38
.head 9 -  Set A.Nam = SalStrLeftX(A.Nam,38)
.head 8 +  If SalStrLength(B.Nam) > 38
.head 9 -  Set B.Nam = SalStrLeftX(B.Nam,38)
.head 8 -  ! Подписать документ (если межбанк или включена внутренняя подпись)
.head 8 -  ! По старой методике наложения ЭЦП
.head 8 +  If GetGlobalOption('INTSIGN') != '2'
.head 9 +  If m_nFli = 1 or GetGlobalOption('INTSIGN')='1'
.head 10 +  If not m_lsSign
.head 11 +  If not ..sDoc()
.head 12 -  Set sErrTxt = 'Не удалось подписать документ.'
.head 12 -  Break
.head 8 -  ! Вставить в OPER
.head 8 +  If bNewDoc and not ..iDoc()
.head 9 -  Set sErrTxt = 'Неуспех при вставке документа '|| m_sNd
.head 9 -  Break
.head 8 -  ! По новой методике наложения ЭЦП
.head 8 +  If GetGlobalOption('INTSIGN')='2'  !-- новая внутрення подпись    !!!!!!!!
.head 9 +  If fsig & DEF_INT_SIGN
.head 10 +  If not ..sDocInt(0,NUMBER_Null)
.head 11 -  Set sErrTxt = 'Не удалось подписать документ внутренней ЭЦП.'
.head 11 -  Break
.head 9 +  If fsig & DEF_EXT_SIGN
.head 10 +  If not m_lsSign
.head 11 +  If not ..sDoc()
.head 12 -  Set sErrTxt = 'Не удалось подписать документ ЭЦП СЭП.'
.head 12 -  Break
.head 10 +  ! Else
.head 11 -  Call Debug( 'буфер m_lsSign уже инициализирован' )
.head 8 -  ! Вставка внутренней подписи
.head 8 +  If bNewDoc and GetGlobalOption('INTSIGN')='2' and not ..PutVis(NUMBER_Null,0)
.head 9 -  Set sErrTxt = 'Неуспех при вставке внутренней подписи документа '|| m_sNd
.head 9 -  Break
.head 8 -  ! Вставить в OPERW
.head 8 +  If not ..iDop()
.head 9 -  Set sErrTxt = 'Неуспех при вставке допреквизитов'
.head 9 -  Break
.head 8 -  ! Вставить в OPLDOK
.head 8 +  If not sNlsm
.head 9 -  Set sNlsm = A.Nls
.head 8 +  If not sNlsk
.head 9 -  Set sNlsk = B.Nls
.head 8 +  If GetGlobalOption('DYNTT2')='Y'
.head 9 +  If not ..DynTT2()
.head 10 -  Set sErrTxt = 'Невозможно выполнить связанную операцию DYNTT2.'
.head 10 -  Break
.head 8 +  ! Else ! Убрать, когда все успокоится
.head 9 +  If (m_nFlg = 0 or m_nFlg = 1) and (m_nDk = 0 or m_nDk = 1)
.head 10 +  If m_nFlg = 0
.head 11 +  If not ChkBIG(m_nFlg,m_nRef,m_sTT,A.Kv,A.S,B.Kv,B.S)
.head 12 -  Set sErrTxt = 'Неуспешная проверка на БОЛЬШИЕ суммы транзакции '|| m_sTT
.head 12 -  Break 
.head 10 -  !
.head 10 -  ! ЕДИНСТВЕННОЕ МЕСТО, КОТОРОЕ ОТЛИЧАЕТСЯ ОТ СТАНДАРТНОЙ oDoc
.head 10 -  !
.head 10 -  ! Внимание, здесь может измениться флаг оплаты m_nFlg
.head 10 +  ! If not ..PayTT(0,m_nRef,m_dDatV1,m_sTT,m_nDk,A.Kv,A.Nls,A.S,B.Kv,B.Nls,B.S)
.head 11 -  Set sErrTxt = 'Неуспешная оплата транзакции '|| m_sTT
.head 11 -  Break 
.head 9 +  If not ..pLnk(0)
.head 10 -  Set sErrTxt = 'Невозможно выполнить связанную операцию.'
.head 10 -  Break 
.head 8 -  ! Вставить в ARC_RRP
.head 8 +  If m_nFli = 1
.head 9 +  If not SqlPrepareAndExecute(hSql(),"SELECT sos INTO :m_nSos FROM oper WHERE ref=:m_nRef")
.head 10 -  Set sErrTxt = 'Ошибка компиляции SQL выражения!'
.head 10 -  Break
.head 9 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set sErrTxt = 'Нет документа Ref:'||SalNumberToStrX(m_nRef, 0)
.head 10 -  Break
.head 9 +  If m_nFlg=1 and m_nSos = 5
.head 10 +  If not ..iSep()
.head 11 -  Set sErrTxt = SalNumberToStrX(m_nErr, 0) ||'. Не удалось передать документ для отправки в СЭП.'
.head 11 -  Break
.head 8 -  Return TRUE
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return MessageErrorEx('Ошибка : ' || sErrTxt || '.')
.head 5 +  Function: iDop
.head 6 -  Description: Вставка допреквизитов в OPERW
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! ! Вставка внутренней подписи
.head 7 +  If GetGlobalOption('INTSIGN')='2' and not ..PutVis(NUMBER_Null,0)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return MessageErrorEx('Ошибка : неуспех при вставке внутренней подписи документа '||m_sNd)
.head 7 -  Return TRUE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbOk
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box: cGenListBox_StrId
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 3 +  ! On SAM_SqlError
.head 4 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -                                                                                                                                 Call ShowSqlError( wParam, lParam )
.head 4 -  !
.head 4 -                                                                                                                                 Return FALSE
.head 4 -  !
.head 4 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 1 +  Table Window: ZAY1   !! Ввод заявок на покупку валюты
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Заявки КЛИЕНТА на покупку валюты 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.6"
.head 4 -  Top:    0.542"
.head 4 -  Width:  19.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.845"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Arial Cyr
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Sky
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Top
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.44"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.367"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51204
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.2"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  6.2"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.4"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.886"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51205
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.367"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  3.367"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.65"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51206
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.883"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.883"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbTU
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.217"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продажа'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWnd2)
.head 8 -  Set hWnd2 = SalCreateWindow(ZAY2, hWndMDI, nPar, sPar1, sPar2)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAY2)
.head 4 +  Pushbutton: pbPF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.933"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить новые параметры клиента'
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblFetchRow(hWndForm, nRow)
.head 8 +  If SqlPLSQLCommand(hSqlAux(), "bars_zay.set_custzay(RNK, " || IifS(cb_CONV=TRUE, "3", "1") || ", 
   STRING_Null, sMFO, OKPO0, NLS0, FL_PF, RNK_PF, NLSP, NLSV, MFOV, KOM)")
.head 9 -  Call SqlCommit(hSqlAux())
.head 8 +  Else
.head 9 -  Call SqlRollback(hSqlAux())
.head 8 -  ! Call SqlPrepareAndExecute(hSqlAux(), "SELECT rnk FROM cust_zay WHERE rnk = :RNK") 
.head 8 +  ! If SqlFetchNext(hSqlAux(), nFetchRes)
.head 9 +  If not cb_CONV
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(),
    "UPDATE cust_zay 
        SET fl_pf =  :ZAY1.FL_PF,  
            rnk_pf = :ZAY1.RNK_PF, 
            nlsp   = :ZAY1.NLSP,      
            mfo26  = :ZAY1.sMFO,   
            okpo26 = :ZAY1.OKPO0,  
            nls29  = :ZAY1.NLS0,   
            nlsv   = :ZAY1.NLSV,   
            mfov   = :ZAY1.MFOV,   
            kom    = :ZAY1.KOM                                
      WHERE rnk    = :ZAY1.RNK")     
.head 9 +  Else 
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(),
    "UPDATE cust_zay 
        SET fl_pf =  :ZAY1.FL_PF,  
            rnk_pf = :ZAY1.RNK_PF, 
            nlsp   = :ZAY1.NLSP,      
            mfo26  = :ZAY1.sMFO,   
            okpo26 = :ZAY1.OKPO0,  
            nls29  = :ZAY1.NLS0,   
            nlsv   = :ZAY1.NLSV,   
            mfov   = :ZAY1.MFOV,   
            kom3   = :ZAY1.KOM                                
      WHERE rnk    = :ZAY1.RNK")     
.head 9 -  Call SalMessageBox('Новые параметры клиента сохранены!', 'Внимание', MB_IconInformation)
.head 8 +  ! Else
.head 9 +  If not cb_CONV
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(),
    "INSERT into cust_zay
       (rnk, mfo26, okpo26, nls29, kom, fl_pf, rnk_pf, nlsp, nlsv, mfov) 
     VALUES 
       (:ZAY1.RNK,   :ZAY1.sMFO,   :ZAY1.OKPO0, :ZAY1.NLS0, :ZAY1.KOM,
        :ZAY1.FL_PF, :ZAY1.RNK_PF, :ZAY1.NLSP,  :ZAY1.NLSV, :ZAY1.MFOV)")
.head 9 +  Else 
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(),
    "INSERT into cust_zay
       (rnk, mfo26, okpo26, nls29, kom3, fl_pf, rnk_pf, nlsp, nlsv, mfov) 
     VALUES 
       (:ZAY1.RNK,   :ZAY1.sMFO,   :ZAY1.OKPO0, :ZAY1.NLS0, :ZAY1.KOM,
        :ZAY1.FL_PF, :ZAY1.RNK_PF, :ZAY1.NLSP,  :ZAY1.NLSV, :ZAY1.MFOV)")
.head 9 -  Call SalMessageBox('Параметры клиента в базу внесены!', 'Внимание', MB_IconInformation)
.head 4 +  Pushbutton: pbOPL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Проект проводок'
.head 6 +  On SAM_Click
.head 7 -  Call PAY_ALL()
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbSPS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.35"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOU.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Списание средств'
.head 6 +  On SAM_Click
.head 7 -  Call PAY_ALL_SPS()
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Combo Box: cmbKV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.4"
.head 6 -  Top:    0.107"
.head 6 -  Width:  3.283"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.036"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: 35
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbKV.Init(hWndItem)
.head 7 -  Call cmbKV.Populate(hSql(), 
     "t.kv", 
     "t.lcv||' '||t.name", 
     "tabval t, tabval_sort s",
     " WHERE t.kv <> :ZAY1.n980 
         AND t.kv = s.kv(+) 
         AND s.user_id(+) = :ZAY1.nUser 
       ORDER BY s.sort_ord, t.kv")
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nKV = cmbKV.GetKey(SalListQuerySelection(hWndItem))
.head 7 -  Set sKV = cmbKV
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select dig into :nDig from tabval where kv = :nKV")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalFmtSetPicture(S2s, '# ##0' || SalStrMidX(SalNumberToStrX(1.1,1),1,1) || SalStrRepeatX('0', nDig))
.head 7 -  !
.head 7 -  !
.head 7 -  !
.head 7 -  ! Set ZAY1.strSqlPopulate =
"SELECT id, sos, viza, cust_branch, rnk, nmk, nd_rnk, okpo0, acc0, acc1, nls, kv2, s2, s3, 
        fdat, kurs_z, vdate, nvl(datz,vdate), kurs_f, kom, skom, 
        fl_pf, rnk_pf, nlsp, mfo0, nls0,   
        pid, contract, dat_vmd, num_vmd, dat2_vmd, dat5_vmd, meta, country, 
        substr(basis,1,254), benefcountry, nd, bank_code, bank_name, product_group, comm, contact_fio, contact_tel,
        bars_zay.get_request_cover(id), identkb
   INTO :ZAY1.ID,:ZAY1.SOS,:ZAY1.VIZA, :ZAY1.BRANCH,
        :ZAY1.RNK,:ZAY1.NMK,:ZAY1.ND_RNK,:ZAY1.OKPO0,:ZAY1.ACC0,:ZAY1.ACC1,:ZAY1.NLS1,:ZAY1.KV1,:ZAY1.S2,:ZAY1.S3,
        :ZAY1.DAT,:ZAY1.KURS_Z,:ZAY1.VDATE,:ZAY1.DATZ,:ZAY1.KURS_F,:ZAY1.KOM,:ZAY1.SKOM,
        :ZAY1.FL_PF,:ZAY1.RNK_PF,:ZAY1.NLSP,:ZAY1.MFOV,:ZAY1.NLSV,
        :ZAY1.PID,:ZAY1.CONTRACT,:ZAY1.VMD1,:ZAY1.NUM_VMD,:ZAY1.DATC,:ZAY1.VMD5,
        :ZAY1.META,:ZAY1.COUNTRY,:ZAY1.BASIS,:ZAY1.BENEFCOUNTRY,:ZAY1.ND,
        :ZAY1.BANK_CODE,:ZAY1.BANK_NAME,:ZAY1.PRODUCT_GROUP, :ZAY1.COMM, :ZAY1.CONTACT_FIO, :ZAY1.CONTACT_TEL,
        :ZAY1.COVERED,:ZAY1.KB
   FROM v_zay_queue  
  WHERE dk  = 1
    AND sos < 2  
    AND kv2 = "||Str(nKV)
||IifS(sPar2 = STRING_Null, " ", " AND "||sPar2) 
||" ORDER BY fdat desc, id desc, rnk"       
.head 7 -  ! Call ZAY1.ReInitQueryString( )
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrcAcc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр счетов клиента'
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(RNK)
.head 8 -  Call ShowAccList(RNK, AVIEW_CUST, AVIEW_Financial|
                                  AVIEW_ReadOnly |
                                  AVIEW_ReadOnly |
                                  AVIEW_ExistOnly,
                     " a.nbs in (SELECT nbs FROM zay_bal)")
.head 4 +  Pushbutton: pbKURS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.5"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlgKURS, hWndMDI)
.head 4 +  Pushbutton: pbHELP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.23"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подтверждения контрактов'
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull(RNK)
.head 8 -  Call SalCreateWindow(ZAYC, hWndMDI, 0, RNK)
.head 4 +  Pushbutton: pbNAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CHKMAIL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Справки из НИ'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndNAL)
.head 8 -  Set hWndNAL = SalCreateWindow(ZAYNAL, hWndMDI, RNK, 1, Val(KV1), S2, DAT,PID, CONTRACT)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYNAL)
.head 4 +  Pushbutton: pbKill
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F8
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute(hSql(),
   "SELECT nvl(blk,0) INTO :nBLK 
      FROM diler_kurs
     WHERE kv  = :nKV 
       AND dat = (SELECT max(dat) 
                    FROM diler_kurs
                   WHERE trunc(dat) = trunc(sysdate) 
                     AND kv = :nKV)")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If nBLK = 1
.head 8 -  Call SalMessageBox('Валюта заблокирована. Изъятие заявки невозможно!', 'Ошибка!', MB_IconStop)
.head 7 +  Else
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(ZAY1, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblSetContext(ZAY1, nRow)
.head 9 +  If SOS > 0
.head 10 -  Call MessageError('Заявка клиента '||ZAY1.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY1.S2s,2))||' '||SalStrMidX(ZAY1.sKV, 0, 3)||' уже удовлетворена дилером!')
.head 9 +  Else If ZAY1.VIZA <= 0
.head 10 -  Call MessageError('Заявка клиента '||ZAY1.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY1.S2s,2))||' '||SalStrMidX(ZAY1.sKV, 0, 3)||' не завизирована!')
.head 9 +  Else
.head 10 +  If MessageQuestion('ИЗЪЯТЬ завизированную заявку клиента '||ZAY1.NMK|| ' на покупку ' ||SalStrTrimX(SalNumberToStrX(ZAY1.S2s,2))||' '||SalStrMidX(ZAY1.sKV, 0, 3)||' ?') = IDYES
.head 11 +  ! If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE zayavka 
      SET sos    = -1, 
          viza   = -1, 
          idback = -1
    WHERE id     = :ZAY1.ID 
      AND sos    = 0
      AND viza  >= 1")
.head 12 -  Call MessageError('Невозможно удалить заявку клиента '||ZAY1.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY1.S2s,2))||' '||SalStrMidX(ZAY1.sKV, 0, 3)||' !')
.head 12 -  Call SqlRollback(hSql())
.head 11 +  If not SqlPLSQLCommand(hSql(), "bars_zay.del_request(ZAY1.ID, 1)")
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call MessageError('Невозможно удалить заявку клиента '||ZAY1.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY1.S2s,2))||' '||SalStrMidX(ZAY1.sKV, 0, 3)||' !')
.head 11 +  Else
.head 12 -  Call SqlCommit(hSql())
.head 12 -  Call SaveInfoToLog('Успешно ИЗЪЯЛИ заявку клиента '||ZAY1.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY1.S2s,2))||SalStrMidX(ZAY1.sKV, 0, 3))
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrintZay
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Печать заявки"
.head 6 +  On SAM_Click
.head 7 +  If nKODZ = NUMBER_Null
.head 8 -  Call SalMessageBox('Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop)
.head 7 +  Else
.head 8 -  Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAY1.ID)),6)||'.DOC'
.head 8 -  Call ExportCatQuery(nKODZ, 
                    sFileName, 
                    6, 
                    ":ZAY_ID='"||SalStrTrimX(Str(ZAY1.ID))||"'", 
                    FALSE)
.head 8 +  If sFileName != STRING_Null
.head 9 -  ! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                           'Печать сформированной заявки', 
                           MB_IconQuestion|MB_YesNoCancel )
.head 9 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                          'Печать сформированной заявки', 
                          MB_IconQuestion|MB_YesNo )
.head 9 +  If nPrint = IDYES
.head 10 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 10 -  ! Call DirectView(sFileName)
.head 9 +  ! If nPrint = IDNO
.head 10 -  Call DosDirectPrint(sFileName)
.head 4 +  Pushbutton: pbPrintZayCorp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Просмотр и печать заявки CORP2"
.head 6 +  On SAM_Click
.head 7 -  Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAY1.ID)),6)||'.DOC'
.head 7 +  If NOT PutBlobToFile(
          hSql(),          sFileName,          'zay_corpdocs',          'id',          'doc_desc',          ZAY1.ID,          '',          '')
.head 8 -  Call SalFileOpen(hFile, sFileName, OF_Delete)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 7 +  If sFileName != STRING_Null
.head 8 -  ! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                           'Печать сформированной заявки', 
                           MB_IconQuestion|MB_YesNoCancel )
.head 8 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
                          'Просмотр и печать заявки CORP2', 
                          MB_IconQuestion|MB_YesNo )
.head 8 +  If nPrint = IDYES
.head 9 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 9 -  ! Call DirectView(sFileName)
.head 4 +  Pushbutton: pbZAY_EC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CLOCK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Валютный контроль'
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull(RNK) AND NOT SalIsNull(PID)
.head 8 -  Call SalCreateWindow(ZAY_EC, hWndMDI, RNK, PID, ID)
.head 4 +  Pushbutton: pbVIZA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOGFILE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр СТАТУСОВ заявки'
.head 6 +  On SAM_Click
.head 7 -  Call ZayavkaEx(hWndForm, 77, ZAY1.ID, '', '')
.head 4 +  Check Box: cb_CONV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: За ВАЛЮТУ
.head 5 -  Window Location and Size
.head 6 -  Left:   9.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call InitSqlStr()
.head 7 -  Call SalSendMsg (hWndForm, UM_Populate, 0, 0)
.head 2 +  Contents
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: О
т
м
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.
номер
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set KV1 = Str(nKV)
.head 6 -  ! Наименование клиента
.head 6 +  If (ZAY1.NMK = STRING_Null OR ZAY1.ND_RNK = STRING_Null)
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nd, nmk, branch 
     INTO :ZAY1.ND_RNK, :ZAY1.NMK, :ZAY1.BRANCH 
     FROM customer 
    WHERE date_off IS NULL  
      AND rnk = "||Str(ZAY1.RNK)) 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Return VALIDATE_Cancel
.head 6 +  If cb_CONV
.head 7 -  ! ИЗ ЗАГОТОВОК торговый счет для списания вал конв
.head 7 -  If SqlPrepareAndExecute(hSql(),
   "SELECT a.acc, a.nls, a.ostc/100, 
           c.rnk_pf, c.nlsp, c.nlsv, c.mfov  
      INTO :ACC0,:NLS0,:S0,:RNK_PF,:NLSP,:NLSV,:MFOV  
      FROM accounts a, cust_zay c 
     WHERE a.kv(+) = :KV_CONV 
       AND a.nls(+) = c.nls29 
       AND c.rnk = :RNK")
and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  ! ИЗ ЗАГОТОВОК торговый счет для списания гривны + реквизиты ПФ
.head 7 -  If SqlPrepareAndExecute(hSql(),
   "SELECT a.acc, a.nls, a.ostc/100, 
           c.fl_pf, c.rnk_pf, c.nlsp, c.nlsv, c.mfov  
      INTO :ACC0,:NLS0,:S0,:FL_PF,:RNK_PF,:NLSP,:NLSV,:MFOV  
      FROM accounts a, cust_zay c 
     WHERE a.kv(+) = :n980 
       AND a.nls(+) = c.nls29 
       AND c.rnk = :RNK")
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! ИЗ ЗАГОТОВОК расчетный счет для зачисления валюты
.head 6 -  If SqlPrepareAndExecute(hSql(),
   "SELECT a.acc,a.nls 
      INTO :ACC1,:NLS1 
      FROM accounts a, cust_zay c 
     WHERE a.kv = :KV1 
       AND a.nls = c.nls26 
       AND c.rnk = :RNK ") 
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! курс заявки
.head 6 +  If not cb_CONV
.head 7 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT kurs_b INTO :KURS_Z  
     FROM diler_kurs  
    WHERE kv = :KV1 
      AND dat = (SELECT max(dat) 
                   FROM diler_kurs 
                  WHERE trunc(dat) = trunc(sysdate) 
                    AND kv = :KV1) " ) 
.head 8 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If SalIsNull(DAT)
.head 7 -  Set DAT = dDATA
.head 6 +  If SalIsNull(S2)
.head 7 -  Set S2 = 0
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: ND_RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
клиента
(симв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( ZAY1.ND_RNK)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT rnk, nmk, branch 
     INTO :ZAY1.RNK, :ZAY1.NMK, :ZAY1.BRANCH
     FROM customer 
    WHERE date_off IS NULL 
      AND nd = '"||SalStrTrimX(ZAY1.ND_RNK)||"'") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSendMsg(ZAY1.RNK, SAM_Validate, 0, 0)
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента-
покупателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If ZAY1.RNK = NUMBER_Null
.head 7 -  Set sTmp1=STRING_Null
.head 7 +  If FunNSIGetFiltered
("CUSTOMER","NMK","date_off is null", sTmp1, sTmp2)
.head 8 -  Set RNK=Val(sTmp1)
.head 8 -  Call SalSendMsg(RNK, SAM_Validate, 0,0)
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отделение
клиента-
покупателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FL_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Флаг
опл.
ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV_CONV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
валюты
списания
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If KV_CONV=NUMBER_Null
.head 7 -  Set cbKV_CONV=STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbKV_CONV.SetSelectById( KV_CONV )
.head 6 +  If KV_CONV = nKV 
.head 7 -  Call SalMessageBox( 'Введенный код валюты совпадает с кодом покупаемой валюты!', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If cbKV_CONV.nCurrentId
.head 7 -  Call SalSendMsg( cbKV_CONV, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Неверно указан код валюты', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbKV_CONV	
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
валюты
списания
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.967"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbKV_CONV.Init(hWndItem)
.head 6 -  Call cbKV_CONV.Populate(hSql(), "kv",  "name", " v_tabval_short "," ORDER BY kv ")
.head 6 -  Call cbKV_CONV.SetSelectById( KV_CONV )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set KV_CONV = cbKV_CONV.GetKey( SalListQuerySelection( cbKV_CONV))
.head 3 +  Column: ACC0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC для 
списания
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
для списания
ср-в на покупку
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nTmp = Val(NLS0)
.head 6 +  If not cb_CONV
.head 7 +  If not F_NLS0 (nTmp, n980, RNK, NMK, ACC0)
.head 8 -  Set NLS0=STRING_Null
.head 8 -  Set ACC0=NUMBER_Null
.head 8 -  Return VALIDATE_OkClearFlag
.head 6 +  Else
.head 7 +  If not F_NLS0 (nTmp, KV_CONV, RNK, NMK, ACC0)
.head 8 -  Set NLS0=STRING_Null
.head 8 -  Set ACC0=NUMBER_Null
.head 8 -  Return VALIDATE_OkClearFlag
.head 6 -  Set NLS0 = Str(nTmp)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: S0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сальдо 
счета
списания
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC для
зачисления
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
для зачисления
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nTmp = Val(NLS1)
.head 6 +  If not F_NLS1 (GetBankMfo(), nTmp, Val(KV1), RNK, NMK, ACC1)
.head 7 -  Set NLS1=STRING_Null
.head 7 -  Set ACC1=NUMBER_Null
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Set NLS1 = Str(nTmp)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
заявл.
 ВАЛ(коп)
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
заявленной
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.58"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set S2 = S2s * SalNumberPower(10, nDig)
.head 6 +  If not cb_CONV
.head 7 -  Call GET_COMMISS(1, ZAY1.RNK, ZAY1.nKV, ZAY1.S2, ZAY1.DAT, ZAY1.KOM, ZAY1.SKOM)
.head 6 +  Else
.head 7 -  Call GET_COMMISS(3, ZAY1.RNK, ZAY1.nKV, ZAY1.S2, ZAY1.DAT, ZAY1.KOM, ZAY1.SKOM)
.head 3 +  Column: S3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
комиссионн.
вознагражд.
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S3s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
комиссионн.
вознагражд.
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set S3 = S3s * SalNumberPower(10, nDig)
.head 3 +  Column: MFOV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
возврата
излишка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( MFOV )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute( hSqlAux(),T("SELECT nb INTO :sNB FROM banks WHERE mfo=:MFOV") )
.head 7 +  If not SqlFetchNext( hSqlAux(), nFetchRes )
.head 8 -  Call SalMessageBox( 'Неверное МФО перечисления излишка ГРН!', 'Ошибка', MB_IconStop )
.head 8 -  Set MFOV = ''
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 +  If SalIsNull( MFOV )
.head 7 -  Set MFOV = GetBankMfo(  )
.head 3 +  Column: NLSV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
возврата
излишка 
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( NLSV )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If Vkrz2(MFOV,NLSV) != NLSV AND NOT SalIsNull( MFOV )
.head 8 -  Call SalMessageBox( 'Неверный счет перечисления излишка ГРН!', 'Ошибка', MB_IconStop )
.head 8 -  Set NLSV = ''
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 +  If NOT SalIsNull( NLSV ) AND SalIsNull( MFOV )
.head 7 -  Set MFOV = GetBankMfo(  )
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If DAT < dDATA - gZAYDAY
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер 
заявки
(клиента)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
комис
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
или 
сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_Z
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
клиента
=>
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
дилера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валюти-
рования
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VDATE_PLAN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Плановая
дата
валютир.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остання
дата дії
заяви
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: META
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель 
покупки
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cbMETA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель 
покупки
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbMETA.Init(hWndItem)
.head 6 -  Call cbMETA.Populate(hSql(),"AIM","to_char(AIM,'09')||' '||NAME"," ZAY_AIMS "," WHERE nvl(type,1) = 1 ORDER BY AIM")
.head 6 -  Call cbMETA.SetSelectById( META )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set META = cbMETA.GetKey(SalListQuerySelection( cbMETA))
.head 3 +  Column: PID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
конт-
ракта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Контракт/
кред.договор
№
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If nEIK=1
.head 7 +  If not IsWindow(hWndC)
.head 8 -  Set hWndC = SalCreateWindow( ZAYC, hWndMDI, 1, hWndForm.ZAY1.RNK )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( ZAYC )
.head 3 +  Column: DATC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
контракта/
кред.догов.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NUM_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
посл.
 ВМД
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VMD1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
посл.
 ВМД
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VMD5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Даты
остальных
 ВМД
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 240
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
страны
перечисл.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If COUNTRY=NUMBER_Null
.head 7 -  Set cbCOUNTRY=STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbCOUNTRY.SetSelectById( COUNTRY )
.head 6 +  If cbCOUNTRY.nCurrentId
.head 7 -  Call SalSendMsg( cbCOUNTRY, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Неверно указан код страны', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbCOUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Страна
перечисл.
валюты
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbCOUNTRY.Init(hWndItem)
.head 6 -  Call cbCOUNTRY.Populate(hSql(),"COUNTRY","NAME"," COUNTRY "," ORDER BY NAME ")
.head 6 -  Call cbCOUNTRY.SetSelectById( COUNTRY )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set COUNTRY = cbCOUNTRY.GetKey( SalListQuerySelection( cbCOUNTRY))
.head 3 +  Column: BASIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код основания
для покупки
валюты
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If BASIS=STRING_Null
.head 7 -  Set cbBASIS=STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbBASIS.SetSelectById( BASIS )
.head 6 +  If cbBASIS.strCurrentId
.head 7 -  Call SalSendMsg( cbBASIS, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Неверно указан код основания покупки валюты', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbBASIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Основание
для покупки
валюты
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbBASIS.Init(hWndItem)
.head 6 -  Call cbBASIS.Populate(hSql(), "p63",  "substr(txt,1,100)", " v_kod_70_2 "," ORDER BY p63 ")
.head 6 -  Call cbBASIS.SetSelectById( BASIS )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set BASIS = cbBASIS.GetKey( SalListQuerySelection( cbBASIS))
.head 3 +  Column: BENEFCOUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
страны
бенеф.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If BENEFCOUNTRY = NUMBER_Null
.head 7 -  Set cbBENEFCOUNTRY = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbBENEFCOUNTRY.SetSelectById( BENEFCOUNTRY )
.head 6 +  If cbBENEFCOUNTRY.nCurrentId
.head 7 -  Call SalSendMsg( cbBENEFCOUNTRY, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Неверно указан код страны', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbBENEFCOUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Страна
клиента
бенефециара
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbBENEFCOUNTRY.Init(hWndItem)
.head 6 -  Call cbBENEFCOUNTRY.Populate(hSql(),"COUNTRY","NAME"," COUNTRY"," ORDER BY NAME ")
.head 6 -  Call cbBENEFCOUNTRY.SetSelectById( BENEFCOUNTRY )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set BENEFCOUNTRY = cbBENEFCOUNTRY.GetKey( SalListQuerySelection( cbBENEFCOUNTRY))
.head 3 +  Column: BANK_CODE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
банка
(B010)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If BANK_CODE = STRING_Null OR BANK_CODE = '0'
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT name INTO :ZAY1.BANK_NAME FROM v_rc_bnk WHERE b010=:ZAY1.BANK_CODE") 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalMessageBox( 'Неверно указан код банка', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: BANK_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
иностранного
банка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PRODUCT_GROUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
тов. 
гр.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If PRODUCT_GROUP = STRING_Null
.head 7 -  Set cbPRODUCT_GROUP = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbPRODUCT_GROUP.SetSelectById(PRODUCT_GROUP)
.head 6 +  If cbPRODUCT_GROUP.strCurrentId
.head 7 -  Call SalSendMsg(cbPRODUCT_GROUP, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox('Неверно указан код товарной группы', 
                   'Ошибка!', 
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbPRODUCT_GROUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Товарная 
группа
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.65"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbPRODUCT_GROUP.Init(hWndItem)
.head 6 -  Call cbPRODUCT_GROUP.Populate(hSql(),
     "p70", "to_char(p70,'09')||' '||txt", " v_kod_70_4 ",
    " ORDER BY p70")
.head 6 -  Call cbPRODUCT_GROUP.SetSelectById(PRODUCT_GROUP)
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set PRODUCT_GROUP = cbPRODUCT_GROUP.GetKey(SalListQuerySelection(cbPRODUCT_GROUP))
.head 3 +  Column: VIZA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Виза
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPO0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
 Клиента
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№ 
в ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет клиента
для отправки 
в ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( NLSP )
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT a.nls INTO :ZAY1.NLSP 
      FROM accounts a, cust_acc ca 
     WHERE a.acc = ca.acc 
       AND a.dazs IS NULL 
       AND a.kv = 980 
       AND ca.rnk = :ZAY1.RNK 
       AND a.nls = :ZAY1.NLSP " ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalMessageBox( 'Неверно указан счет!', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: DATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
зачисления
валюты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COVERED
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTACT_FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО
контактного лица
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTACT_TEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ТЕЛ
контактного лица
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COMM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Комментарий
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 250
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CLOSE_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
закрытия
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REQ_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If REQ_TYPE = NUMBER_Null
.head 7 -  Set cbREQ_TYPE = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
.head 6 +  If cbREQ_TYPE.nCurrentId
.head 7 -  Call SalSendMsg(cbREQ_TYPE, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox('Неверно указан код типа заявки', 'Ошибка!', MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbREQ_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
типа заявки
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbREQ_TYPE.Init(hWndItem)
.head 6 -  Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
.head 6 -  Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REQ_TYPE = cbREQ_TYPE.GetKey(SalListQuerySelection(cbREQ_TYPE))
.head 2 +  Functions
.head 3 +  Function: PAY_ALL
.head 4 -  Description: Формирование документов
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nVob
.head 5 -  Number: nREF
.head 5 -  Number: nREFPF
.head 5 -  Number: nRow
.head 5 -  String: pD39
.head 5 -  Boolean: bPay
.head 4 +  Actions
.head 5 -  Set nVob = GetGlobalOptionEx('MBK_VZAL')
.head 5 -  Set nVob = IifN(nVob = 0, 6, nVob)
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set bPay = FALSE
.head 6 +  If ZAY1.KV_CONV = NUMBER_Null
.head 7 +  If nPF = 0 
.head 8 -  Set bPay = TRUE
.head 7 +  Else
.head 8 +  If ZAY1.FL_PF = 1
.head 9 -  Set bPay = TRUE
.head 8 +  Else
.head 9 +  If SalMessageBox('Не формировать отчисление '
                                                  ||Str(nPF)
                                                  ||'% в Пенсионный Фонд '
                                                  ||'по заявке № '
                                                  ||SalNumberToStrX(ZAY1.ID, 0)
                                                  ||'?', 
                                                'Внимание', 
                                                 MB_YesNo) = IDYES
.head 10 -  Set bPay = TRUE
.head 6 +  Else
.head 7 -  Set bPay = TRUE
.head 6 +  If bPay
.head 7 +  If GetGlobalOptionEx('MFOP')=300465
.head 8 +  If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bPay from zayavka z, oper o where z.sos = 1 and nvl(z.ref_sps,0)=o.ref and z.id = :ZAY1.ID and o.sos = 5") AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox('По заявке № '||SalNumberToStrX(ZAY1.ID, 0)||' не оплачен документ списания!', 
                                                'Внимание', 
                                                 MB_Ok)
.head 9 -  ! Set bPay = FALSE
.head 9 -  Return FALSE
.head 7 -  ! оплата документа
.head 7 +  If PAY_ONE (ZAY1.ID, nPF, nPFCUST, pD39, nVob, 6, nREF, nREFPF)
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SetTblRowColor(ZAY1, COLOR_DarkGreen)
.head 8 -  Call SalMessageBox('Заявка № '||SalNumberToStrX(ZAY1.ID, 0)||' успешно обработана. '||PutCrLf()
                 ||'Референс зачисления валюты  '||SalNumberToStrX(nREF,   0)||'.'||PutCrLf()
                 ||IifS (nREFPF = NUMBER_Null, '', 
                   'Референс отчисл.в Пенс.Фонд '||SalNumberToStrX(nREFPF, 0)||'.'), 
                   'Информация', 
                    MB_IconInformation)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 5 +  ! Else
.head 6 -  Break 
.head 6 +  ! If nRow >= 0 
.head 7 +  If nPF = 0 
OR nPF > 0 AND ZAY1.FL_PF = 1
OR nPF > 0 AND ZAY1.FL_PF = 0 AND SalMessageBox('Не формировать отчисление '
                                                  ||SalNumberToStrX(nPF, 0)
                                                  ||'% в Пенсионный Фонд '
                                                  ||'по заявке № '
                                                  ||SalNumberToStrX(ZAY1.ID, 0)
                                                  ||'?', 
                                                'Внимание', 
                                                 MB_YesNo) = IDYES
.head 8 -  ! ввод пользователем значения показателя D#39 и оплата документа
.head 8 +  If SalModalDialog(dlgD39, ZAY1, 1, ZAY1.ID, ZAY1.S2s, ZAY1.cmbKV, ZAY1.NMK, pD39) 
AND 
   PAY_ONE (ZAY1.ID, nPF, nPFCUST, pD39, nVob, 6, nREF, nREFPF)
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SetTblRowColor(ZAY1, COLOR_DarkGreen)
.head 9 -  Call SalMessageBox('Заявка № '||SalNumberToStrX(ZAY1.ID, 0)||' успешно обработана. '||PutCrLf()
                 ||'Референс зачисления валюты  '||SalNumberToStrX(nREF,   0)||'.'||PutCrLf()
                 ||IifS (nREFPF = NUMBER_Null, '', 
                   'Референс отчисл.в Пенс.Фонд '||SalNumberToStrX(nREFPF, 0)||'.'), 
                   'Информация', 
                    MB_IconInformation)
.head 8 +  Else 
.head 9 -  Call SqlRollback(hSql())
.head 3 +  Function: PAY_ONE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: pZAYID
.head 5 -  Number: pTAXRATE
.head 5 -  Number: pTAXCUST
.head 5 -  String: pD39
.head 5 -  Number: pVOBFС
.head 5 -  Number: pVOBNС
.head 5 -  Receive Number: pBUYREF
.head 5 -  Receive Number: pTAXREF
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), "bars_zay.pay_buying (pZAYID, 
                                                     pTAXRATE, 
                                                     pTAXCUST,
                                                     pD39, 
                                                     pVOBFС, 
                                                     pVOBNС, 
                                                     pBUYREF, 
                                                     pTAXREF)")
.head 6 -  Return FALSE
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE oper SET id_o = :sOperId WHERE ref = :pBUYREF")
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.SetDocR (pBUYREF, FALSE)
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.oDoc()
.head 6 -  Return FALSE
.head 5 +  If pTAXREF != NUMBER_Null
.head 6 +  If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE oper SET id_o = :sOperId WHERE ref = :pTAXREF")
.head 7 -  Return FALSE
.head 6 +  If NOT cDocZay2.SetDocR (pTAXREF, FALSE)
.head 7 -  Return FALSE
.head 6 +  If NOT cDocZay2.oDoc()
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: PAY_ALL_SPS
.head 4 -  Description: Формирование списания средств
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nVob
.head 5 -  Number: nREF
.head 5 -  Number: nRow
.head 5 -  Boolean: bPay
.head 5 -  Boolean: bFrm
.head 4 +  Actions
.head 5 -  Set nVob = GetGlobalOptionEx('MBK_VZAL')
.head 5 -  Set nVob = IifN(nVob = 0, 6, nVob)
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set bPay = FALSE
.head 6 -  Set bFrm = FALSE
.head 6 +  If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bPay from zayavka where sos = 1 and nvl(ref_sps,0)=0 and id = :ZAY1.ID") AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bFrm from zayavka where sos < 1 and id = :ZAY1.ID") AND SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('По заявке № '||SalNumberToStrX(ZAY1.ID, 0)||' запрещено формирование списания по неудовлетворенной заявке!', 
                                                'Внимание', 
                                                 MB_Ok)
.head 7 +  Else If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bFrm from zayavka where sos = 1 and nvl(ref_sps,0)<>0 and id = :ZAY1.ID") AND SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('По заявке № '||SalNumberToStrX(ZAY1.ID, 0)||' запрещено повторное формирование списания!', 
                                                'Внимание', 
                                                 MB_Ok)
.head 6 +  Else
.head 7 -  Set bPay = TRUE
.head 6 +  If bPay
.head 7 -  ! оплата документа
.head 7 +  If PAY_ONE_SPS (ZAY1.ID, nVob, nREF)
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SetTblRowColor(ZAY1, COLOR_DarkGreen)
.head 8 -  Call SalMessageBox('Заявка № '||SalNumberToStrX(ZAY1.ID, 0)||' успешно обработана. '||PutCrLf()
                 ||'Референс списания '||SalNumberToStrX(nREF,   0)||'.', 
                   'Информация', 
                    MB_IconInformation)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 3 +  Function: PAY_ONE_SPS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: pZAYID
.head 5 -  Number: pVOB
.head 5 -  Receive Number: pBUYREF
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), "bars_zay.pay_buying_sps (pZAYID, 
                                                         pVOB, 
                                                         pBUYREF)")
.head 6 -  Return FALSE
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE oper SET id_o = :sOperId WHERE ref = :pBUYREF")
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.SetDocR (pBUYREF, FALSE)
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.oDoc()
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: InitSqlStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nReqId
.head 4 +  Actions
.head 5 -  ! Показать-спрятать покупку за валюту
.head 5 +  If cb_CONV
.head 6 -  Call SalShowWindow(KV_CONV)
.head 6 -  Call SalShowWindow(cbKV_CONV)
.head 6 -  Call SalDisableWindow(KURS_Z)
.head 5 +  Else
.head 6 -  Call SalHideWindow(KV_CONV)
.head 6 -  Call SalHideWindow(cbKV_CONV)
.head 5 -  !
.head 5 -  Set ZAY1.strSqlPopulate =
"SELECT id, sos, viza, cust_branch, rnk, nmk, nd_rnk, okpo0, acc0, acc1, nls, kv_conv, kv2, s2, s3, 
        fdat, kurs_z, vdate, nvl(datz,vdate), kurs_f, kom, skom, 
        fl_pf, rnk_pf, nlsp, mfo0, nls0,   
        pid, contract, dat_vmd, num_vmd, dat2_vmd, dat5_vmd, meta, country, 
        substr(basis,1,254), benefcountry, nd, bank_code, bank_name, product_group, comm, contact_fio, contact_tel,
        bars_zay.get_request_cover(id), nvl(identkb,decode(operid_nokk, null, null, 1)), substr(close_type_name,1,100),
        req_type, vdate_plan, datt
   INTO :ZAY1.ID,:ZAY1.SOS,:ZAY1.VIZA, :ZAY1.BRANCH,
        :ZAY1.RNK,:ZAY1.NMK,:ZAY1.ND_RNK,:ZAY1.OKPO0,:ZAY1.ACC0,:ZAY1.ACC1,:ZAY1.NLS1,:ZAY1.KV_CONV,:ZAY1.KV1,:ZAY1.S2,:ZAY1.S3,
        :ZAY1.DAT,:ZAY1.KURS_Z,:ZAY1.VDATE,:ZAY1.DATZ,:ZAY1.KURS_F,:ZAY1.KOM,:ZAY1.SKOM,
        :ZAY1.FL_PF,:ZAY1.RNK_PF,:ZAY1.NLSP,:ZAY1.MFOV,:ZAY1.NLSV,
        :ZAY1.PID,:ZAY1.CONTRACT,:ZAY1.VMD1,:ZAY1.NUM_VMD,:ZAY1.DATC,:ZAY1.VMD5,
        :ZAY1.META,:ZAY1.COUNTRY,:ZAY1.BASIS,:ZAY1.BENEFCOUNTRY,:ZAY1.ND,
        :ZAY1.BANK_CODE,:ZAY1.BANK_NAME,:ZAY1.PRODUCT_GROUP, :ZAY1.COMM, :ZAY1.CONTACT_FIO, :ZAY1.CONTACT_TEL,
        :ZAY1.COVERED,:ZAY1.KB, :ZAY1.CLOSE_TYPE, :ZAY1.REQ_TYPE, :ZAY1.VDATE_PLAN, :ZAY1.DATT
   FROM v_zay_queue  
  WHERE dk  = " || IifS(cb_CONV=TRUE, "3", "1") || "
    AND sos < 2 and sos >= 0
    AND kv2 = :ZAY1.nKV
    and fdat > bankdate - :gZAYDAY
    and mfo = f_ourmfo" ||
        IifS(sPar2=STRING_Null, "", " AND " || sPar2) ||
" ORDER BY fdat desc, id desc, rnk"       
.head 5 -  !
.head 5 -  Set ZAY1.strSqlInsert = "bars_zay.create_request_ex (" || IifS(cb_CONV=TRUE, "3", "1") || ",
    ZAY1.RNK, ZAY1.nKV, " || IifS(cb_CONV=TRUE, "ZAY1.KV_CONV", "NUMBER_Null") || ",
    ZAY1.nS, ZAY1.ND, ZAY1.DAT, ZAY1.KURS_Z, ZAY1.NLS1, ZAY1.NLS0, ZAY1.NLSV, ZAY1.MFOV,
    ZAY1.KOM, ZAY1.SKOM, ZAY1.FL_PF, ZAY1.NLSP, ZAY1.META,
    ZAY1.PID, ZAY1.CONTRACT, ZAY1.DATC, ZAY1.NUM_VMD, ZAY1.VMD1, ZAY1.VMD5,
    ZAY1.BASIS, ZAY1.COUNTRY, ZAY1.BENEFCOUNTRY, ZAY1.BANK_CODE, ZAY1.BANK_NAME,
    ZAY1.PRODUCT_GROUP, STRING_Null, 0, ZAY1.CONTACT_FIO, ZAY1.CONTACT_TEL, STRING_Null, STRING_Null, ZAY1.REQ_TYPE, ZAY1.VDATE_PLAN, NUMBER_Null, STRING_Null, nReqId)"
.head 5 -  !
.head 5 -  Set ZAY1.strSqlUpdate = "bars_zay.upd_request (ZAY1.ID, ZAY1.nS, ZAY1.ND, ZAY1.DAT, ZAY1.KURS_Z, " ||
    IifS(cb_CONV=TRUE, "ZAY1.KV_CONV", "NUMBER_Null") || ",
    ZAY1.NLS1, ZAY1.NLS0, ZAY1.NLSV, ZAY1.MFOV, ZAY1.KOM, ZAY1.SKOM,
    ZAY1.META, ZAY1.CONTRACT, ZAY1.DATC, ZAY1.NUM_VMD, ZAY1.VMD1, ZAY1.VMD5,
    ZAY1.BASIS, ZAY1.COUNTRY, ZAY1.BENEFCOUNTRY, ZAY1.BANK_CODE, ZAY1.BANK_NAME,
    ZAY1.PRODUCT_GROUP, ZAY1.COMM, ZAY1.CONTACT_FIO, ZAY1.CONTACT_TEL, ZAY1.FL_PF, ZAY1.REQ_TYPE, ZAY1.VDATE_PLAN, NUMBER_Null, STRING_Null)"
.head 5 -  !
.head 5 -  Set ZAY1.strSqlDelete = "bars_zay.del_request(ZAY1.ID, 0)"
.head 5 -  !
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar1
.head 3 -  String: sPar2
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  Number: nUser
.head 3 -  Date/Time: dDATA
.head 3 -  String: sMFO
.head 3 -  String: sOperId
.head 3 -  !
.head 3 -  Number: nal_srok
.head 3 -  Number: nbu_srok
.head 3 -  Number: nPF
.head 3 -  Number: nKODZ
.head 3 -  Number: nEIK     
.head 3 -  Number: nMARGIN
.head 3 -  Number: nRESERV
.head 3 -  Number: nPFCUST
.head 3 -  Number: nEIK_ND
.head 3 -  Number: nPR_CORP2
.head 3 -  !
.head 3 -  Number: nKV
.head 3 -  String: sKV
.head 3 -  Number: KURS
.head 3 -  Number: nBLK
.head 3 -  !
.head 3 -  String: sNB
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRow
.head 3 -  Number: nDELTA
.head 3 -  !
.head 3 -  String: sFileName
.head 3 -  Number: nPrint
.head 3 -  !
.head 3 -  : cDocZay2
.head 4 -  Class: cDocZay
.head 3 -  ! Для Итогов
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  Number: i4s
.head 3 -  Number: nDig
.head 3 -  Number: nRet
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  File Handle: hFile
.head 3 -  Number: nTmp
.head 3 -  !
.head 3 -  Number: nReqId
.head 3 -  Boolean: bResult
.head 3 -  Number: nS
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  ! Подставляем базовые параметры
.head 4 -  Set cb_CONV = FALSE
.head 4 -  Set n980    = GetBaseVal()
.head 4 -  Set nUser   = GetUserId()
.head 4 -  Set dDATA   = GetBankDate()
.head 4 -  Set sMFO    = GetBankMfo()
.head 4 -  Set sOperId = GetIdOper()
.head 4 -  Set ZAY1.strPrintFileName = 'ZAY1'
.head 4 -  Set ZAY1.strFilterTblName = 'V_ZAY_QUEUE'
.head 4 -  ! Вычитываем из настроек
.head 4 -  Call BIRZA( 'NAL_SROK', nal_srok )
.head 4 -  Call BIRZA( 'NBU_SROK', nbu_srok )
.head 4 -  Call BIRZA( 'PEN_FOND', nPF      )
.head 4 -  Call BIRZA( 'PRNT_BUY', nKODZ    )
.head 4 -  Call BIRZA( 'ZAY+EIK',  nEIK     )
.head 4 -  Call BIRZA( 'MARGIN',   nMARGIN  )
.head 4 -  Call BIRZA( 'RESERV',   nRESERV  )
.head 4 -  Call BIRZA( 'PF_CUST',  nPFCUST  )
.head 4 -  Call BIRZA( 'EIK_ND',   nEIK_ND  )
.head 4 -  Call BIRZA( 'PR_CORP2', nPR_CORP2)
.head 4 -  ! Открываем/прячем кнопку печати word-документа из corp2
.head 4 +  If nPR_CORP2 = 1 
.head 5 -  Call SalShowWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbPrintZayCorp)
.head 4 -  ! Открываем/прячем кнопку отдельного списания для Сбера/неСбера
.head 4 +  If GetGlobalOptionEx('MFOP')=300465 
.head 5 -  Call SalShowWindow(pbSPS)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbSPS)
.head 4 -  !
.head 4 +  If nEIK_ND = 1 
.head 5 -  Call SalShowWindow(ZAY1.ND_RNK)
.head 4 +  Else
.head 5 -  Call SalHideWindow(ZAY1.ND_RNK)
.head 4 -  ! Прячем реквизиты оплаты пенсионного фонда
.head 4 -  Set ZAY1.nTabInstance = nPF + 1
.head 4 +  If nPF = 0 
.head 5 -  Call SalHideWindow(FL_PF)
.head 5 -  Call SalHideWindow(NLSP)
.head 5 -  Call SalHideWindow(RNK_PF)
.head 4 +  Else If nPFCUST = 1
.head 5 -  Call SalShowWindow(NLSP)
.head 5 -  Call SalShowWindow(RNK_PF)
.head 5 -  Call SalShowWindow(FL_PF)
.head 4 +  Else
.head 5 -  Call SalHideWindow(NLSP)
.head 5 -  Call SalShowWindow(RNK_PF)
.head 5 -  Call SalShowWindow(FL_PF)
.head 4 -  !
.head 4 +  If nEIK = 0 
.head 5 -  Call SalHideWindow(PID)
.head 4 +  If nKODZ = -1
.head 5 -  Call SalDisableWindow(pbPrintZay)
.head 4 -  !
.head 4 -  Call InitSqlStr()
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT kurs_s
     INTO :KURS
     FROM diler_kurs 
    WHERE kv  = :nKV 
      AND dat = (SELECT max(dat) 
                   FROM diler_kurs 
                  WHERE kv = :nKV
                    AND trunc(dat) = trunc(sysdate))")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Set i2  = 0
.head 4 -  Set i3  = 0
.head 4 -  Set i4  = 0
.head 4 -  Set i4s = 0
.head 4 -  Call ZAY1.ReInitQueryString( )
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 4 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 4 -  Set RNK = i2
.head 4 -  Set S0  = i3
.head 4 -  Set S2  = i4
.head 4 -  Set S2s = i4s
.head 4 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set S2s = S2/SalNumberPower(10, nDig)
.head 4 -  Set S3s = S3/SalNumberPower(10, nDig)
.head 4 -  ! Цель покупки
.head 4 +  If ZAY1.META = NUMBER_Null
.head 5 -  Set cbMETA = STRING_Null
.head 4 +  Else
.head 5 -  Call cbMETA.SetSelectById(ZAY1.META)
.head 4 -  ! Товарная группа
.head 4 +  If ZAY1.PRODUCT_GROUP = STRING_Null
.head 5 -  Set cbPRODUCT_GROUP = STRING_Null
.head 4 +  Else
.head 5 -  Call cbPRODUCT_GROUP.SetSelectById(ZAY1.PRODUCT_GROUP)
.head 4 -  ! Основание для покупки
.head 4 +  If ZAY1.BASIS = STRING_Null
.head 5 -  Set cbBASIS = STRING_Null
.head 4 +  Else
.head 5 -  Call cbBASIS.SetSelectById(ZAY1.BASIS)
.head 4 -  ! Страна перечисления валюты
.head 4 +  If ZAY1.COUNTRY = NUMBER_Null
.head 5 -  Set cbCOUNTRY = STRING_Null
.head 4 +  Else
.head 5 -  Call cbCOUNTRY.SetSelectById(ZAY1.COUNTRY)
.head 4 -  ! Страна клиента-бенефециара
.head 4 +  If ZAY1.BENEFCOUNTRY = NUMBER_Null
.head 5 -  Set cbBENEFCOUNTRY = STRING_Null
.head 4 +  Else
.head 5 -  Call cbBENEFCOUNTRY.SetSelectById(ZAY1.BENEFCOUNTRY)
.head 4 -  ! Счет для списания ГРН
.head 4 +  If not SalIsNull(ACC0)
.head 5 +  If SqlPrepareAndExecute( hSqlAux2(),
   "SELECT nls, ostc/100 
      INTO :NLS0,:S0 
      FROM accounts 
     WHERE acc = :ACC0")
.head 6 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 4 -  ! Состояние заявки
.head 4 +  If SalIsNull(SOS)
.head 5 -  Set SOS = 0
.head 4 -  ! Контракты + Подтверждения
.head 4 +  If nEIK = 1
.head 5 +  If not SalIsNull(PID)
.head 6 +  If SqlPrepareAndExecute(hSqlAux2(),
  "SELECT name, dateopen 
     INTO :ZAY1.CONTRACT,:ZAY1.DATC  
     FROM top_contracts 
    WHERE pid = :ZAY1.PID")
.head 7 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 4 +  Else
.head 5 +  If not SalIsNull(CONTRACT)
.head 6 -  If SqlPrepareAndExecute(hSqlAux2(),
  "SELECT max(date_c) INTO :DAT_NBU 
     FROM nbu_contr 
    WHERE rnk = :RNK 
      AND name = :CONTRACT")
and SqlFetchNext(hSqlAux2(), nFetchRes) 
.head 4 -  ! Подсказка о нехватке ГРН на счете
.head 4 +  If COVERED = 0
.head 5 -  Call SalTblSetCellTextColor(ZAY1.S0, COLOR_Red, FALSE)
.head 4 -  ! Признак заявки, полученной по Клиент-банку
.head 4 +  If ZAY1.KB != STRING_Null
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightPeriwinkle)
.head 4 -  ! Тип заявки
.head 4 +  If ZAY1.REQ_TYPE = NUMBER_Null
.head 5 -  Set cbREQ_TYPE = STRING_Null
.head 4 +  Else
.head 5 -  Call cbREQ_TYPE.SetSelectById(ZAY1.REQ_TYPE)
.head 4 -  !
.head 4 +  If KV_CONV
.head 5 -  Call cbKV_CONV.SetSelectById( KV_CONV )
.head 4 -  ! Для Итогов
.head 4 -  Set i2  = i2  + 1
.head 4 -  Set i3  = i3  + S0
.head 4 -  Set i4  = i4  + S2
.head 4 -  Set i4s = i4s + S2s
.head 3 +  On SAM_ContextMenu
.head 4 -  Call SalTblQueryFocus(hWndForm, nRow, hWndCol)
.head 4 +  If SalTblQueryRowFlags (hWndForm, nRow, ROW_Selected)
.head 5 +  If VIZA = -1
.head 6 -  Set strTitle = SalStrTrimX('Отказано в визе')
.head 5 +  If VIZA = 0
.head 6 -  Set strTitle = SalStrTrimX('Ждет визу')
.head 5 +  If VIZA >= 1
.head 6 -  Set strTitle = SalStrTrimX('Завизирована')
.head 5 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Yellow)
.head 5 -  Call XSalTooltipShow(hWndForm, strTitle)
.head 5 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On UM_Insert
.head 4 +  If SalTblAnyRows(hWndForm, ROW_Edited, ROW_New)
.head 5 -  Call SalMessageBox('Збережіть або обновіть дані !', 'Увага!', MB_IconExclamation | MB_Ok)
.head 4 +  Else
.head 5 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 5 -  Set FL_PF = 0
.head 3 +  ! On UM_Update
.head 4 -  Set bResult = TRUE
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 +  If SalIsNull(META)
.head 6 -  Call SalMessageBox('Не заполнена цель покупки!', 'Внимание!', MB_IconAsterisk | MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If cb_CONV and KV_CONV = nKV 
.head 6 -  Call SalMessageBox( 'Введенный код валюты совпадает с кодом покупаемой валюты!', 'Ошибка!', MB_IconStop )
.head 6 -  Return FALSE
.head 5 +  If not SqlPLSQLCommand(hSql(), ZAY1.strSqlInsert)
.head 6 -  Set bResult = FALSE
.head 6 -  Break 
.head 4 +  If bResult
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set ZAY1.BASIS = Subs(ZAY1.BASIS,1,35)
.head 6 +  If not SqlPLSQLCommand(hSql(), ZAY1.strSqlUpdate)
.head 7 -  Set bResult = FALSE
.head 7 -  Break 
.head 4 +  If bResult
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_MarkDeleted, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If SOS
.head 7 -  Call SalMessageBox('Невозможно удалить заявку ' || Str(ID) || '.' || PutCrLf() || 'Заявка уже удовлетворена дилером.',
     'Сообщение', MB_IconAsterisk | MB_Ok)
.head 6 +  Else 
.head 7 +  If not SqlPLSQLCommand(hSql(), ZAY1.strSqlDelete)
.head 8 -  Set bResult = FALSE
.head 8 -  Break 
.head 4 +  If bResult
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Else 
.head 5 -  Call SqlRollback(hSql())
.head 3 +  On UM_Update
.head 4 -  Set bResult = TRUE
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_MarkDeleted | ROW_Edited, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 -  Set nS = S2 / SalNumberPower(10, nDig)
.head 5 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 6 +  If SalIsNull(META)
.head 7 -  Call SalMessageBox('Не заполнена цель покупки!', 'Внимание!', MB_IconAsterisk | MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If cb_CONV and KV_CONV = nKV 
.head 7 -  Call SalMessageBox( 'Введенный код валюты совпадает с кодом покупаемой валюты!', 'Ошибка!', MB_IconStop )
.head 7 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), ZAY1.strSqlInsert)
.head 7 -  Set bResult = FALSE
.head 7 -  Break
.head 5 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
.head 6 +  If SOS
.head 7 -  Call SalMessageBox('Невозможно удалить заявку ' || Str(ID) || '.' || PutCrLf() || 'Заявка уже удовлетворена дилером.',
     'Сообщение', MB_IconAsterisk | MB_Ok)
.head 6 +  Else
.head 7 +  If not SqlPLSQLCommand(hSql(), ZAY1.strSqlDelete)
.head 8 -  Set bResult = FALSE
.head 8 -  Break
.head 5 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
.head 6 -  Set ZAY1.BASIS = Subs(ZAY1.BASIS,1,35)
.head 6 +  If not SqlPLSQLCommand(hSql(), ZAY1.strSqlUpdate)
.head 7 -  Set bResult = FALSE
.head 7 -  Break
.head 4 +  If bResult
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Else
.head 5 -  Call SqlRollback(hSql())
.head 3 +  On SAM_TblDoDetails
.head 4 +  If ZAY1.KB != STRING_Null
.head 5 -  Call SalEnableWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbPrintZayCorp)
.head 1 +  Table Window: ZAY2   !! ГОУ: заявки на продажу валюты
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Заявки КЛИЕНТОВ на продажу валюты 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.025"
.head 4 -  Top:    0.031"
.head 4 -  Width:  15.75"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.679"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Light Green
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Top
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.448"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.071"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.367"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34840
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.217"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  6.217"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.886"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.85"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrintZayCorp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Просмотр и печать заявки CORP2"
.head 6 +  On SAM_Click
.head 7 -  Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAY2.ID)),6)||'.DOC'
.head 7 +  If NOT PutBlobToFile(
          hSql(),          sFileName,          'zay_corpdocs',          'id',          'doc_desc',          ZAY2.ID,          '',          '')
.head 8 -  Call SalFileOpen(hFile, sFileName, OF_Delete)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 7 +  If sFileName != STRING_Null
.head 8 -  ! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                           'Печать сформированной заявки', 
                           MB_IconQuestion|MB_YesNoCancel )
.head 8 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
                          'Просмотр и печать заявки CORP2', 
                          MB_IconQuestion|MB_YesNo )
.head 8 +  If nPrint = IDYES
.head 9 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 9 -  ! Call DirectView(sFileName)
.head 4 -  Line
.head 5 -  Resource Id: 34841
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.4"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  3.4"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbPF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.967"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить новые параметры клиента'
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblFetchRow(hWndForm, nRow)
.head 8 +  If SqlPLSQLCommand(hSqlAux(), "bars_zay.set_custzay(RNK, " || IifS(cb_CONV=TRUE, "4", "2") || ", 
   NLS0, sMFO, OKPO0, NLS1, NUMBER_Null, STRING_Null, STRING_Null, STRING_Null, STRING_Null, KOM)")
.head 9 -  Call SqlCommit(hSqlAux())
.head 8 +  Else
.head 9 -  Call SqlRollback(hSqlAux())
.head 8 -  ! Call SqlPrepareAndExecute(hSqlAux(), "SELECT rnk FROM cust_zay WHERE rnk=:RNK")
.head 8 +  ! If SqlFetchNext(hSqlAux(), nFetchRes)
.head 9 -  Call SqlPrepareAndExecute(hSqlAux(),
    "UPDATE cust_zay 
        SET kom2   = :KOM, 
            mfo26  = :MFO0, 
            okpo26 = :OKPO0, 
            nls29  = :NLS1, 
            nls26  = :NLS0 
      WHERE rnk    = :RNK ")
.head 9 -  Call SalMessageBox('Новые параметры клиента сохранены!',
                   'Внимание',
                   MB_IconInformation)
.head 8 +  ! Else
.head 9 -  Call SqlPrepareAndExecute(hSqlAux(),
    "INSERT INTO cust_zay (rnk, nls29, nls26, mfo26, okpo26, kom2) 
     VALUES (:RNK, :NLS1, :NLS0, :MFO0, :OKPO0, :KOM)")
.head 9 -  Call SalMessageBox('Параметры клиента в базу внесены!',
                   'Внимание',
                   MB_IconInformation)
.head 8 -  Call SqlCommit(hSqlAux())
.head 4 +  Pushbutton: pbOPL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.8"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Проект проводок'
.head 6 +  On SAM_Click
.head 7 -  Call PAY_ALL()
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbTU
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.233"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Покупка'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWnd1)
.head 8 -  Set hWnd1 = SalCreateWindow(ZAY1, hWndMDI, nPar, sPar1, sPar2)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAY1)
.head 4 +  Combo Box: cmb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.4"
.head 6 -  Top:    0.125"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.19"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: 35
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb1.Init(hWndItem)
.head 7 -  Call cmb1.Populate(hSql(), 
     "t.kv",
     "t.lcv||' '||t.name", 
     "tabval t, tabval_sort s",
     " WHERE t.kv <> :ZAY2.n980 
         AND t.kv = s.kv(+) 
         AND s.user_id(+)=:ZAY2.nUser 
       ORDER BY s.sort_ord, t.kv ")
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nKV = cmb1.GetKey(SalListQuerySelection(hWndItem))
.head 7 -  Set sKV = cmb1
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select dig into :nDig from tabval where kv=:nKV")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalFmtSetPicture(S2s, '# ##0'||SalStrMidX(SalNumberToStrX(1.1,1),1,1)||SalStrRepeatX('0', nDig))
.head 7 -  Call SalFmtSetPicture(S0s, '# ##0'||SalStrMidX(SalNumberToStrX(1.1,1),1,1)||SalStrRepeatX('0', nDig))
.head 7 -  !
.head 7 -  ! Set ZAY2.strSqlInsert =
   "INSERT INTO zayavka
     (id, dk, rnk, acc0, acc1, s2,
      fdat, kurs_z, kurs_f, sos, kv2, kom, skom, 
      mfo0, nls0, okpo0, rnk_pf, nd,
      meta, pid, contract, dat2_vmd, num_vmd, dat_vmd, comm, contact_fio, contact_tel, obz) 
    VALUES 
    (0,          2, :ZAY2.RNK,      :ZAY2.ACC0, :ZAY2.ACC1,    :ZAY2.S2,
    :ZAY2.DAT,  :ZAY2.KURS_Z, :ZAY2.KURS_F,        0,    "||Str(nKV)||", :ZAY2.KOM,  :ZAY2.SKOM, 
    :ZAY2.MFO0, :ZAY2.NLS0,   :ZAY2.OKPO0,    :ZAY2.D27,  :ZAY2.ND,
    :ZAY2.META, :ZAY2.PID,    :ZAY2.CONTRACT, :ZAY2.DATC, :ZAY2.NUM_VMD, :ZAY2.DAT_VMD, :ZAY2.COMM,  :ZAY2.CONTACT_FIO, :ZAY2.CONTACT_TEL, :ZAY2.OBZ)"       
.head 7 -  !
.head 7 -  ! Set ZAY2.strSqlPopulate =
"SELECT id, dk, cust_branch, rnk, nmk, nd_rnk, 
        acc0, acc1, nls, kv2, ostc, s2, 
        fdat, kurs_z, kurs_f, sos, kom, skom, 
        vdate, nvl(datz,vdate), mfo0, nls0, okpo0, 
        viza, rnk_pf, nd, obz, meta, pid, 
        contract, dat2_vmd, num_vmd, dat_vmd, comm, contact_fio, contact_tel,
        bars_zay.get_request_cover(id), nvl(identkb,decode(operid_nokk, null, null, 1)),
        close_type_name, req_type
   INTO :ZAY2.ID,  :ZAY2.DK, :ZAY2.BRANCH, :ZAY2.RNK,:ZAY2.NMK,:ZAY2.ND_RNK,
        :ZAY2.ACC0,:ZAY2.ACC1,:ZAY2.NLS1,:ZAY2.KV1,:ZAY2.S0,:ZAY2.S2,
        :ZAY2.DAT,:ZAY2.KURS_Z,:ZAY2.KURS_F,:ZAY2.SOS,:ZAY2.KOM,:ZAY2.SKOM,
        :ZAY2.VDATE,:ZAY2.DATZ,:ZAY2.MFO0,:ZAY2.NLS0,:ZAY2.OKPO0,
        :ZAY2.VIZA,:ZAY2.D27,:ZAY2.ND,:ZAY2.OBZ,:ZAY2.META,:ZAY2.PID, 
        :ZAY2.CONTRACT, :ZAY2.DATC, :ZAY2.NUM_VMD, :ZAY2.DAT_VMD, :ZAY2.COMM,  :ZAY2.CONTACT_FIO, :ZAY2.CONTACT_TEL,
        :ZAY2.COVERED,:ZAY2.KB, :ZAY2.CLOSE_TYPE, :ZAY2.REQ_TYPE
   FROM v_zay_queue 
  WHERE dk  = 2 
    AND sos < 2 and sos >= 0
    AND kv2 = " || Str(nKV) || "
    and fdat > bankdate - :gZAYDAY
    and mfo = f_ourmfo_g" ||
        IifS(sPar2 = STRING_Null, " ", " AND "||sPar2) ||
" ORDER BY fdat desc, id desc, rnk"
.head 7 -  ! Call ZAY2.ReInitQueryString()
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrcAcc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.533"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Открытые счета клиента'
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(RNK)
.head 8 -  Call ShowAccList(RNK, AVIEW_CUST,
                      AVIEW_Financial|
                      AVIEW_ReadOnly |
                      AVIEW_ReadOnly |
                      AVIEW_ExistOnly,
                      " a.nbs IN (SELECT nbs FROM zay_bal)")
.head 4 -  Line
.head 5 -  Resource Id: 34842
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.883"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.883"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.667"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbKURS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.5"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlgKURS, hWndMDI)
.head 4 +  Pushbutton: pbKill
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F8
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nvl(blk,0) 
     INTO :nBLK 
     FROM diler_kurs
    WHERE kv  = :nKV 
      AND dat = (SELECT max(dat) 
                   FROM diler_kurs
                  WHERE trunc(dat) = trunc(sysdate) 
                    AND kv = :nKV)")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If nBLK = 1
.head 8 -  Call SalMessageBox('Валюта заблокирована. Изъятие заявки невозможно!', 
                   'Ошибка!', 
                   MB_IconStop)
.head 7 +  Else
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(ZAY2, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblSetContext(ZAY2, nRow)
.head 9 +  If SOS > 0
.head 10 -  Call MessageError('Заявка клиента '||ZAY2.NMK||' на продажу '||SalStrTrimX(SalNumberToStrX(ZAY2.S2s,2))||' '||SalStrMidX(ZAY2.sKV, 0, 3)||' уже удовлетворена диллером!')
.head 9 +  Else If ZAY2.VIZA <= 0
.head 10 -  Call MessageError('Заявка клиента '||ZAY2.NMK||' на продажу '||SalStrTrimX(SalNumberToStrX(ZAY2.S2s,2))||' '||SalStrMidX(ZAY2.sKV, 0, 3)||' не завизирована!')
.head 9 +  Else
.head 10 +  If MessageQuestion('ИЗЪЯТЬ завизированную заявку клиента '||ZAY2.NMK||' на продажу ' ||SalStrTrimX(SalNumberToStrX(ZAY2.S2s,2))||' '||SalStrMidX(ZAY2.sKV, 0, 3)||' ?') = IDYES
.head 11 +  ! If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE zayavka 
      SET sos    = -1, 
          viza   = -1, 
          idback = -1
    WHERE id     = :ZAY2.ID 
      AND sos    = 0
      AND viza  >= 1")
.head 12 -  Call MessageError('Невозможно удалить заявку клиента '||ZAY2.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY2.S2s,2))||' '||SalStrMidX(ZAY2.sKV, 0, 3)||' !')
.head 12 -  Call SqlRollback(hSql())
.head 11 +  If not SqlPLSQLCommand(hSql(), "bars_zay.del_request(ZAY2.ID, 1)")
.head 12 -  Call MessageError('Невозможно удалить заявку клиента '||ZAY2.NMK||' на покупку '||SalStrTrimX(SalNumberToStrX(ZAY2.S2s,2))||' '||SalStrMidX(ZAY2.sKV, 0, 3)||' !')
.head 12 -  Call SqlRollback(hSql())
.head 11 +  Else
.head 12 -  Call SqlCommit(hSql())
.head 12 -  Call SaveInfoToLog('Успешно ИЗЪЯЛИ заявку клиента '||ZAY2.NMK||' на продажу '||SalStrTrimX(SalNumberToStrX(ZAY2.S2s,2))||SalStrMidX(ZAY2.sKV, 0, 3))
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrintZay
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Печать заявки"
.head 6 +  On SAM_Click
.head 7 +  If nKODZ = NUMBER_Null OR nKODZ_OBZ = NUMBER_Null
.head 8 -  Call SalMessageBox('Не указан код запроса для формирования заявки', 
                   'Ошибка', 
                   MB_IconStop)
.head 7 +  Else
.head 8 -  Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAY2.ID)),6)|| '.DOC'
.head 8 -  Call ExportCatQuery(IifN(ZAY2.OBZ = 1, nKODZ_OBZ, nKODZ),
                    sFileName, 
                    6, 
                    ":ZAY_ID='"||SalStrTrimX(Str(ZAY2.ID))||"'", 
                    FALSE)
.head 8 +  If sFileName != STRING_Null
.head 9 -  ! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                           'Печать сформированной заявки', 
                           MB_IconQuestion|MB_YesNoCancel)
.head 9 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                          'Печать сформированной заявки', 
                          MB_IconQuestion|MB_YesNo )
.head 9 +  If nPrint = IDYES
.head 10 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 10 -  ! Call DirectView(sFileName)
.head 9 +  ! If nPrint = IDNO
.head 10 -  Call DosDirectPrint(sFileName)
.head 4 +  Pushbutton: pbVIZA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOGFILE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр СТАТУСОВ заявки'
.head 6 +  On SAM_Click
.head 7 -  Call ZayavkaEx(hWndForm, 77, ZAY2.ID, '', '')
.head 4 +  Pushbutton: pbSPS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.401"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOU.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Списание средств'
.head 6 +  On SAM_Click
.head 7 -  Call PAY_ALL_SPS()
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Check Box: cb_CONV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: За ВАЛЮТУ
.head 5 -  Window Location and Size
.head 6 -  Left:   10.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call InitSqlStr()
.head 7 -  Call SalSendMsg (hWndForm, UM_Populate, 0, 0)
.head 2 +  Contents
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пок
Прод
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
оп
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: О
т
м
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OBZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: О
Б
З
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.
номер
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set KV1 = Str(nKV)
.head 6 -  ! наименование клиента
.head 6 +  If (ZAY2.NMK = STRING_Null OR ZAY2.ND_RNK = STRING_Null OR ZAY2.OKPO0 = STRING_Null)
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nmk, nd, okpo, branch 
     INTO :ZAY2.NMK, :ZAY2.ND_RNK, :ZAY2.OKPO0, :ZAY2.BRANCH 
     FROM customer 
    WHERE date_off IS NULL 
      AND rnk = "||Str(ZAY2.RNK)) 
and not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  ! ИЗ ЗАГОТОВОК 2600\грн 
.head 6 -  If SqlPrepareAndExecute(hSql(),
  "SELECT a.acc, c.nls26, c.mfo26, c.okpo26 
     INTO :ZAY2.ACC0,:ZAY2.NLS0,:ZAY2.MFO0,:ZAY2.OKPO0
     FROM accounts a, cust_zay c 
    WHERE a.kv(+) = " || IifS(cb_CONV=TRUE, ":KV_CONV", ":n980") || " 
      AND a.nls(+) = c.nls26
      AND c.rnk = :ZAY2.RNK" )
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! 2900 вал счет для списания
.head 6 -  If SqlPrepareAndExecute(hSql(),
  "SELECT a.acc,a.nls, a.ostc/power(10,t.dig)
     INTO :ZAY2.ACC1,:ZAY2.NLS1,:ZAY2.S0 
     FROM accounts a, cust_zay c, tabval t 
    WHERE a.kv = :KV1 
      AND a.nls = c.nls29
      AND c.rnk = :ZAY2.RNK
      AND a.kv=t.kv")
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! курс заявки
.head 6 +  If not cb_CONV
.head 7 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT kurs_s INTO :KURS_Z
     FROM diler_kurs  
    WHERE kv = :KV1 
      AND dat = (SELECT max(dat) 
                   FROM diler_kurs 
                  WHERE trunc(dat) = trunc(sysdate) 
                    AND kv = :KV1)") 
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If SalIsNull(DAT) 
.head 7 -  Set DAT = dDATA
.head 6 +  If SalIsNull(S2)
.head 7 -  Set S2 = 0
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: ND_RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
клиента
(симв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(ZAY2.ND_RNK)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT rnk, nmk, okpo, branch  
     INTO :ZAY2.RNK, :ZAY2.NMK, :ZAY2.OKPO0, :ZAY2.BRANCH 
     FROM customer 
    WHERE date_off IS NULL 
      AND nd = '"||SalStrTrimX(ZAY2.ND_RNK)||"'") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSendMsg(ZAY2.RNK, SAM_Validate, 0, 0)
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента-
продавца
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If ZAY2.RNK = NUMBER_Null
.head 7 -  Set sTmp1=STRING_Null
.head 7 +  If FunNSIGetFiltered
("CUSTOMER","NMK","date_off is null", sTmp1, sTmp2)
.head 8 -  Set RNK=Val(sTmp1)
.head 8 -  Call SalSendMsg(RNK, SAM_Validate, 0,0)
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отделение
клиента-
продавца
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV_CONV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
валюты
списания
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If KV_CONV=NUMBER_Null
.head 7 -  Set cbKV_CONV=STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbKV_CONV.SetSelectById( KV_CONV )
.head 6 +  If KV_CONV = nKV 
.head 7 -  Call SalMessageBox( 'Введенный код валюты совпадает с кодом покупаемой валюты!', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If cbKV_CONV.nCurrentId
.head 7 -  Call SalSendMsg( cbKV_CONV, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Неверно указан код валюты', 'Ошибка!', MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbKV_CONV	
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
валюты
списания
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.967"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbKV_CONV.Init(hWndItem)
.head 6 -  Call cbKV_CONV.Populate(hSql(), "kv",  "name", " v_tabval_short "," ORDER BY kv ")
.head 6 -  Call cbKV_CONV.SetSelectById( KV_CONV )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set KV_CONV = cbKV_CONV.GetKey( SalListQuerySelection( cbKV_CONV))
.head 3 +  Column: ACC0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC для 
списания
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFO0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
для зач
средств
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute( hSqlAux(),T("SELECT nb INTO :NB FROM banks WHERE mfo=:MFO0") )
.head 6 +  If not SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 -  Set NB='ОШ. МФО!'
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: NLS0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
для зач.
средств
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate !!  2600/980  без открытия 
.head 6 +  If MFO0 = STRING_Null
.head 7 -  Set MFO0=GetBankMfo()
.head 6 -  Set nTmp = Val(NLS0)
.head 6 +  If not F_NLS1 (MFO0, nTmp, IifN(cb_CONV=TRUE, KV_CONV, n980), RNK, NMK, ACC0)
.head 7 -  Set NLS0=STRING_Null
.head 7 -  Set ACC0=NUMBER_Null
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Set NLS0 = Str(nTmp)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: OKPO0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
для зач.
средств
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( OKPO0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If V_Okpo(OKPO0) !=OKPO0 OR (Len(OKPO0)<8 AND Len(OKPO0)!=3)
.head 8 -  Call Debug('Неверный код ОКПО !')
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: NLS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
для спис.
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate !! 2900/вал  с открытием и 2600/вал без открытия
.head 6 -  Set nTmp = Val(NLS1)
.head 6 +  If not F_NLS0 (nTmp, Val(KV1), RNK, NMK, ACC1)
.head 7 -  Set NLS1=STRING_Null
.head 7 -  Set ACC1=NUMBER_Null
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Set NLS1 = Str(nTmp)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: ACC1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC для
зачисления
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сальдо 
счета
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S0s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сальдо 
счета
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
заявл.
 ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
заявл.
 ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set S2 = S2s * SalNumberPower(10, nDig)
.head 6 -  Call GET_COMMISS(IifN(cb_CONV=TRUE, 4, 2), ZAY2.RNK, nKV, ZAY2.S2, ZAY2.DAT, ZAY2.KOM, ZAY2.SKOM)
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If DAT < dDATA - gZAYDAY - 1
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
заявки
(клиента)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % 
ком
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
или 
сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_Z
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
кл.
<=
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
дил
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Australia
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валюти-
рования
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остання
дата дії
заяви
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VIZA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Виза
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: D27
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показ.
для 
27 файла
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: META
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cbMETA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель
продажи
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbMETA.Init(hWndItem)
.head 6 -  Call cbMETA.Populate(hSql(),"AIM","to_char(AIM,'09')||' '||NAME NAME"," ZAY_AIMS "," WHERE nvl(type,2) = 2 ORDER BY AIM")
.head 6 -  Call cbMETA.SetSelectById( META )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set META = cbMETA.GetKey(SalListQuerySelection( cbMETA))
.head 3 +  Column: PID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
конт-
ракта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
контракта/
кред.договора
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If nEIK = 1
.head 7 +  If not IsWindow(hWndC)
.head 8 -  Set hWndC = SalCreateWindow(ZAYC, hWndMDI, -1, hWndForm.ZAY2.RNK)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYC)
.head 3 +  Column: DATC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
контракта/
кред.догов.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NUM_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
тамож.декл./
акта вып.работ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
ТД/
АКТа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: KB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
зачисления 
гривны
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COVERED
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTACT_FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО
контактного лица
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTACT_TEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ТЕЛ
контактного лица
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COMM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Комментарий
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CLOSE_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
закрытия
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REQ_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If REQ_TYPE = NUMBER_Null
.head 7 -  Set cbREQ_TYPE = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
.head 6 +  If cbREQ_TYPE.nCurrentId
.head 7 -  Call SalSendMsg(cbREQ_TYPE, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox('Неверно указан код типа заявки', 'Ошибка!', MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cbREQ_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
типа заявки
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cbREQ_TYPE.Init(hWndItem)
.head 6 -  Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
.head 6 -  Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REQ_TYPE = cbREQ_TYPE.GetKey(SalListQuerySelection(cbREQ_TYPE))
.head 2 +  Functions
.head 3 +  Function: PAY_ALL
.head 4 -  Description: Формирование документов
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nVob
.head 5 -  Number: nREF
.head 5 -  Number: nRow
.head 5 -  String: pD39
.head 5 -  Boolean: bPay
.head 4 +  Actions
.head 5 -  Set nVob = GetGlobalOptionEx('MBK_VZAL')
.head 5 -  Set nVob = IifN (nVob = 0, 6, nVob)
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set bPay = TRUE
.head 6 +  If bPay
.head 7 +  If GetGlobalOptionEx('MFOP')=300465
.head 8 +  If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bPay from zayavka z, oper o where z.sos = 1 and nvl(z.ref_sps,0)=o.ref and z.id = :ZAY2.ID and o.sos = 5") AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox('По заявке № '||SalNumberToStrX(ZAY2.ID, 0)||' не оплачен документ списания!', 
                                                'Внимание', 
                                                 MB_Ok)
.head 9 -  ! Set bPay = FALSE
.head 9 -  Return FALSE
.head 7 -  ! оплата документа
.head 7 +  If PAY_ONE (ZAY2.ID, pD39, nVob, 6, nREF)
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SetTblRowColor(ZAY2, COLOR_DarkGreen)
.head 8 -  Call SalMessageBox('Заявка № '||SalNumberToStrX(ZAY2.ID, 0)||' успешно обработана. '||PutCrLf()
                 ||'Референс зачисления гривны '||SalNumberToStrX(nREF, 0)||'.', 
                   'Информация', 
                    MB_IconInformation)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 5 +  ! Loop
.head 6 +  If SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If nRow >= 0
.head 8 +  If SalModalDialog(dlgD39, ZAY2, 2, ZAY2.ID, ZAY2.S2s, ZAY2.cmb1, ZAY2.NMK, pD39) 
AND   
PAY_ONE (ZAY2.ID, pD39, nVob, 6, nREF)
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SetTblRowColor(ZAY2, COLOR_DarkGreen)
.head 9 -  Call SalMessageBox('Заявка № '||SalNumberToStrX(ZAY2.ID, 0)||' успешно обработана. '||PutCrLf()
                 ||'Референс зачисления гривны '||SalNumberToStrX(nREF, 0)||'.', 
                   'Информация', 
                    MB_IconInformation)
.head 8 +  Else 
.head 9 -  Call SqlRollback(hSql())
.head 6 +  Else 
.head 7 -  Break 
.head 3 +  Function: PAY_ONE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: pZAYID
.head 5 -  String: pD39
.head 5 -  Number: pVOBFС
.head 5 -  Number: pVOBNС
.head 5 -  Receive Number: pSELREF
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), "bars_zay.pay_selling (pZAYID, 
                                                      pD39,
                                                      pVOBFС, 
                                                      pVOBNС,
                                                      pSELREF)")
.head 6 -  Return FALSE
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE oper SET id_o = :sOperId WHERE ref = :pSELREF")
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.SetDocR (pSELREF, FALSE)
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.oDoc()
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: PAY_ALL_SPS
.head 4 -  Description: Формирование списания средств
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nVob
.head 5 -  Number: nREF
.head 5 -  Number: nRow
.head 5 -  Boolean: bPay
.head 5 -  Boolean: bFrm
.head 4 +  Actions
.head 5 -  Set nVob = GetGlobalOptionEx('MBK_VZAL')
.head 5 -  Set nVob = IifN(nVob = 0, 6, nVob)
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set bPay = FALSE
.head 6 +  If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bPay from zayavka where sos = 1 and nvl(ref_sps,0)=0 and id = :ZAY2.ID") AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bFrm from zayavka where sos < 1 and id = :ZAY2.ID") AND SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('По заявке № '||SalNumberToStrX(ZAY2.ID, 0)||' запрещено формирование списания по неудовлетворенной заявке!', 
                                                'Внимание', 
                                                 MB_Ok)
.head 7 +  Else If SqlPrepareAndExecute (hSql(), 
  "select 1 into :bFrm from zayavka where sos = 1 and nvl(ref_sps,0)<>0 and id = :ZAY2.ID") AND SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('По заявке № '||SalNumberToStrX(ZAY2.ID, 0)||' запрещено повторное формирование списания!', 
                                                'Внимание', 
                                                 MB_Ok)
.head 6 +  Else
.head 7 -  Set bPay = TRUE
.head 6 +  If bPay
.head 7 -  ! оплата документа
.head 7 +  If PAY_ONE_SPS (ZAY2.ID, nVob, nREF)
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SetTblRowColor(ZAY2, COLOR_DarkGreen)
.head 8 -  Call SalMessageBox('Заявка № '||SalNumberToStrX(ZAY2.ID, 0)||' успешно обработана. '||PutCrLf()
                 ||'Референс списания '||SalNumberToStrX(nREF,   0)||'.', 
                   'Информация', 
                    MB_IconInformation)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 3 +  Function: PAY_ONE_SPS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: pZAYID
.head 5 -  Number: pVOB
.head 5 -  Receive Number: pSELREF
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), "bars_zay.pay_selling_sps (pZAYID, 
                                                         pVOB, 
                                                         pSELREF)")
.head 6 -  Return FALSE
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), 
  "UPDATE oper SET id_o = :sOperId WHERE ref = :pSELREF")
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.SetDocR (pSELREF, FALSE)
.head 6 -  Return FALSE
.head 5 +  If NOT cDocZay2.oDoc()
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: InitSqlStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nReqId
.head 4 +  Actions
.head 5 -  ! Показать-спрятать покупку за валюту
.head 5 +  If cb_CONV
.head 6 -  Call SalShowWindow(KV_CONV)
.head 6 -  Call SalShowWindow(cbKV_CONV)
.head 6 -  Call SalDisableWindow(KURS_Z)
.head 5 +  Else
.head 6 -  Call SalHideWindow(KV_CONV)
.head 6 -  Call SalHideWindow(cbKV_CONV)
.head 5 -  !
.head 5 -  Set ZAY2.strSqlPopulate =
"SELECT id, dk, cust_branch, rnk, nmk, nd_rnk, 
        acc0, acc1, nls, kv_conv, kv2, ostc, s2, 
        fdat, kurs_z, kurs_f, sos, kom, skom, 
        vdate, nvl(datz,vdate), mfo0, nls0, okpo0, 
        viza, rnk_pf, nd, obz, meta, pid, 
        contract, dat2_vmd, num_vmd, dat_vmd, comm, contact_fio, contact_tel,
        bars_zay.get_request_cover(id), nvl(identkb,decode(operid_nokk, null, null, 1)),
        close_type_name, req_type, datt
   INTO :ZAY2.ID,  :ZAY2.DK, :ZAY2.BRANCH, :ZAY2.RNK,:ZAY2.NMK,:ZAY2.ND_RNK,
        :ZAY2.ACC0,:ZAY2.ACC1,:ZAY2.NLS1,:ZAY2.KV_CONV,:ZAY2.KV1,:ZAY2.S0,:ZAY2.S2,
        :ZAY2.DAT,:ZAY2.KURS_Z,:ZAY2.KURS_F,:ZAY2.SOS,:ZAY2.KOM,:ZAY2.SKOM,
        :ZAY2.VDATE,:ZAY2.DATZ,:ZAY2.MFO0,:ZAY2.NLS0,:ZAY2.OKPO0,
        :ZAY2.VIZA,:ZAY2.D27,:ZAY2.ND,:ZAY2.OBZ,:ZAY2.META,:ZAY2.PID, 
        :ZAY2.CONTRACT, :ZAY2.DATC, :ZAY2.NUM_VMD, :ZAY2.DAT_VMD, :ZAY2.COMM,  :ZAY2.CONTACT_FIO, :ZAY2.CONTACT_TEL,
        :ZAY2.COVERED,:ZAY2.KB, :ZAY2.CLOSE_TYPE, :ZAY2.REQ_TYPE, :ZAY2.DATT
   FROM v_zay_queue 
  WHERE dk  = " || IifS(cb_CONV=TRUE, "4", "2") || " 
    AND sos < 2 and sos >= 0
    AND kv2 = :ZAY2.nKV
    and fdat > bankdate - :gZAYDAY - 1
    and mfo = f_ourmfo" ||
        IifS(sPar2 = STRING_Null, " ", " AND "||sPar2) ||
" ORDER BY fdat desc, id desc, rnk"
.head 5 -  !
.head 5 -  Set ZAY2.strSqlInsert = "bars_zay.create_request_ex (" || IifS(cb_CONV=TRUE, "4", "2") || ", ZAY2.RNK,
    ZAY2.nKV, " || IifS(cb_CONV=TRUE, "ZAY2.KV_CONV", "NUMBER_Null") || ",
    ZAY2.nS, ZAY2.ND, ZAY2.DAT, ZAY2.KURS_Z,
    ZAY2.NLS1, ZAY2.NLS0, ZAY2.NLS0, ZAY2.MFO0,
    ZAY2.KOM, ZAY2.SKOM, 1, STRING_Null,
    ZAY2.META, ZAY2.PID, ZAY2.CONTRACT, ZAY2.DATC,
    ZAY2.NUM_VMD, ZAY2.DAT_VMD, STRING_Null, STRING_Null,
    NUMBER_Null, NUMBER_Null, STRING_Null, STRING_Null, STRING_Null,
    ZAY2.COMM, 0, ZAY2.CONTACT_FIO, ZAY2.CONTACT_TEL, STRING_Null, STRING_Null, ZAY2.REQ_TYPE, DATETIME_Null, ZAY2.OBZ, ZAY2.D27, nReqId)"       
.head 5 -  !
.head 5 -  Set ZAY2.strSqlUpdate = "bars_zay.upd_request (ZAY2.ID,
    ZAY2.nS, ZAY2.ND, ZAY2.DAT, ZAY2.KURS_Z, " ||
    IifS(cb_CONV=TRUE, "ZAY2.KV_CONV", "NUMBER_Null") || ",
    ZAY2.NLS1, ZAY2.NLS0, ZAY2.NLS0, ZAY2.MFO0, ZAY2.KOM, ZAY2.SKOM,
    ZAY2.META, ZAY2.CONTRACT, ZAY2.DATC, ZAY2.NUM_VMD, ZAY2.DAT_VMD, STRING_Null, 
    STRING_Null, NUMBER_Null, NUMBER_Null, STRING_Null, STRING_Null, STRING_Null,
    ZAY2.COMM, ZAY2.CONTACT_FIO, ZAY2.CONTACT_TEL, 0, ZAY2.REQ_TYPE, DATETIME_Null, ZAY2.OBZ, ZAY2.D27)"
.head 5 -  !
.head 5 -  Set ZAY2.strSqlDelete = "bars_zay.del_request(ZAY2.ID, 0)"
.head 5 -  !
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar1
.head 3 -  String: sPar2
.head 2 +  Window Variables
.head 3 -  Number: nKODZ
.head 3 -  Number: nKODZ_OBZ
.head 3 -  Number: nMARGIN
.head 3 -  Number: nEIK_ND
.head 3 -  String: sFileName
.head 3 -  String: sOperId
.head 3 -  Date/Time: dDATA
.head 3 -  String: sKV
.head 3 -  Number: nFetchRes
.head 3 -  Number: KURS
.head 3 -  Number: nKV
.head 3 -  Number: n980
.head 3 -  Number: nUser
.head 3 -  String: NB 
.head 3 -  : cDocZay2
.head 4 -  Class: cDocZay
.head 3 -  Number: nBLK
.head 3 -  Number: nRow
.head 3 -  Number: nPrint
.head 3 -  Number: nEIK
.head 3 -  Number: nPR_CORP2
.head 3 -  ! Для Итогов
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  Number: i4s
.head 3 -  Number: nDig
.head 3 -  Number: nRet
.head 3 -  Number: nTmp
.head 3 -  String: sTmp1
.head 3 -  String: sTmp2
.head 3 -  File Handle: hFile
.head 3 -  !
.head 3 -  Boolean: bResult
.head 3 -  Number: nReqId
.head 3 -  Number: nS
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  !
.head 4 -  Set cb_CONV = FALSE
.head 4 -  Set nUser   = GetUserId()
.head 4 -  Set n980    = GetBaseVal()
.head 4 -  Set sOperId = GetIdOper()
.head 4 -  Set dDATA   = GetBankDate()
.head 4 -  Set ZAY2.nTabInstance     = 1
.head 4 -  Set ZAY2.strPrintFileName = 'ZAY2'
.head 4 -  Set ZAY2.strFilterTblName = 'V_ZAY_QUEUE'
.head 4 -  !
.head 4 -  Call BIRZA( 'PRNT_SAL', nKODZ     )
.head 4 -  Call BIRZA( 'PRNT_OBZ', nKODZ_OBZ )
.head 4 -  Call BIRZA( 'MARGIN',   nMARGIN   )
.head 4 -  Call BIRZA( 'EIK_ND',   nEIK_ND   )
.head 4 -  Call BIRZA( 'ZAY+EIK',  nEIK      )
.head 4 -  Call BIRZA( 'PR_CORP2',   nPR_CORP2  )
.head 4 -  ! Открываем/прячем кнопку отдельного списания для Сбера/неСбера
.head 4 +  If GetGlobalOptionEx('MFOP')=300465 
.head 5 -  Call SalShowWindow(pbSPS)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbSPS)
.head 4 -  !
.head 4 +  If nPR_CORP2 = 1 
.head 5 -  Call SalShowWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbPrintZayCorp)
.head 4 -  !
.head 4 +  If nEIK_ND = 1 
.head 5 -  Call SalShowWindow (ZAY2.ND_RNK)
.head 4 +  Else
.head 5 -  Call SalHideWindow (ZAY2.ND_RNK)
.head 4 -  !
.head 4 +  If nEIK = 0 
.head 5 -  Call SalHideWindow(PID)
.head 4 -  !
.head 4 +  If nKODZ = -1
.head 5 -  Call SalDisableWindow(pbPrintZay)
.head 4 -  !
.head 4 -  Call InitSqlStr()
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT kurs_b 
     INTO :KURS     
     FROM diler_kurs 
    WHERE kv  = :nKV 
      AND dat = (SELECT max(dat) 
                   FROM diler_kurs 
                  WHERE kv = :nKV 
                    AND trunc(dat) = trunc(sysdate))")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Set i2  = 0
.head 4 -  Set i3  = 0
.head 4 -  Set i4  = 0
.head 4 -  Set i4s = 0
.head 4 -  Call ZAY2.ReInitQueryString( )
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 4 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 4 -  Set RNK = i2
.head 4 -  Set S0  = i3
.head 4 -  Set S2  = i4
.head 4 -  Set S2s = i4s
.head 4 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set S2s = S2/SalNumberPower(10, nDig)
.head 4 -  Set S0s = S0/SalNumberPower(10, nDig)
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute( hSql(), 
   "SELECT rnk_pf INTO :ZAY2.D27 FROM zayavka WHERE dk = 2 AND id = :ZAY2.ID")
and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If SalIsNull(SOS)
.head 5 -  Set SOS = 0
.head 4 -  ! Цель продажи
.head 4 +  If ZAY2.META = NUMBER_Null
.head 5 -  Set cbMETA = STRING_Null
.head 4 +  Else
.head 5 -  Call cbMETA.SetSelectById(ZAY2.META)
.head 4 -  ! Подсказка о нехватке ВАЛ на счете
.head 4 +  If COVERED = 0
.head 5 -  Call SalTblSetCellTextColor(ZAY2.S0s, COLOR_Red, FALSE)
.head 4 -  !
.head 4 +  If MFO0 = STRING_Null
.head 5 -  Set MFO0 = GetBankMfo()
.head 4 +  If MFO0 = GetBankMfo() 
AND not SalIsNull(ACC0) 
AND SqlPrepareAndExecute(hSqlAux2(), "SELECT nls INTO :NLS0 FROM accounts WHERE acc=:ACC0")
.head 5 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 4 -  ! Признак заявки, полученной по Клиент-банку
.head 4 +  If ZAY2.KB != STRING_Null
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightPeriwinkle)
.head 4 -  ! Тип заявки
.head 4 +  If ZAY2.REQ_TYPE = NUMBER_Null
.head 5 -  Set cbREQ_TYPE = STRING_Null
.head 4 +  Else
.head 5 -  Call cbREQ_TYPE.SetSelectById(ZAY2.REQ_TYPE)
.head 4 -  !
.head 4 +  If KV_CONV
.head 5 -  Call cbKV_CONV.SetSelectById(KV_CONV)
.head 4 -  ! Для Итогов
.head 4 -  Set i2  = i2  + 1
.head 4 -  Set i3  = i3  + S0
.head 4 -  Set i4  = i4  + S2
.head 4 -  Set i4s = i4s + S2s
.head 3 +  On SAM_ContextMenu
.head 4 -  Call SalTblQueryFocus(hWndForm, nRow, hWndCol)
.head 4 +  If SalTblQueryRowFlags (hWndForm, nRow, ROW_Selected)
.head 5 +  If VIZA = -1
.head 6 -  Set strTitle = SalStrTrimX('Отказано в визе')
.head 5 +  If VIZA = 0
.head 6 -  Set strTitle = SalStrTrimX('Ждет визу')
.head 5 +  If VIZA >= 1
.head 6 -  Set strTitle = SalStrTrimX('Завизирована')
.head 5 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Yellow)
.head 5 -  Call XSalTooltipShow(hWndForm, strTitle)
.head 5 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On UM_Insert
.head 4 +  If SalTblAnyRows(hWndForm, ROW_Edited, ROW_New)
.head 5 -  Call SalMessageBox('Збережіть або обновіть дані !', 'Увага!', MB_IconExclamation | MB_Ok)
.head 4 +  Else
.head 5 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 3 +  ! On UM_Update
.head 4 -  Set bResult = TRUE
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 +  If SalIsNull(META)
.head 6 -  Call SalMessageBox('Не заполнена цель продажи!', 'Внимание!', MB_IconAsterisk | MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If not SqlPLSQLCommand(hSql(), ZAY2.strSqlInsert)
.head 6 -  Set bResult = FALSE
.head 6 -  Break 
.head 4 +  If bResult
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If not SqlPLSQLCommand(hSql(), ZAY2.strSqlUpdate)
.head 7 -  Set bResult = FALSE
.head 7 -  Break 
.head 4 +  If bResult
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_MarkDeleted, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If SOS
.head 7 -  Call SalMessageBox('Невозможно удалить заявку ' || Str(ID) || '.' || PutCrLf() || 'Заявка уже удовлетворена дилером.',
     'Сообщение', MB_IconAsterisk | MB_Ok)
.head 6 +  Else 
.head 7 +  If not SqlPLSQLCommand(hSql(), ZAY2.strSqlDelete)
.head 8 -  Set bResult = FALSE
.head 8 -  Break 
.head 4 +  If bResult
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Else 
.head 5 -  Call SqlRollback(hSql())
.head 3 +  On UM_Update
.head 4 -  Set bResult = TRUE
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_MarkDeleted | ROW_Edited, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 -  Set nS = S2 / SalNumberPower(10, nDig)
.head 5 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 6 +  If SalIsNull(META)
.head 7 -  Call SalMessageBox('Не заполнена цель продажи!', 'Внимание!', MB_IconAsterisk | MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If cb_CONV and KV_CONV = nKV 
.head 7 -  Call SalMessageBox( 'Введенный код валюты совпадает с кодом покупаемой валюты!', 'Ошибка!', MB_IconStop )
.head 7 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), ZAY2.strSqlInsert)
.head 7 -  Set bResult = FALSE
.head 7 -  Break
.head 5 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
.head 6 +  If SOS
.head 7 -  Call SalMessageBox('Невозможно удалить заявку ' || Str(ID) || '.' || PutCrLf() || 'Заявка уже удовлетворена дилером.',
     'Сообщение', MB_IconAsterisk | MB_Ok)
.head 6 +  Else
.head 7 +  If not SqlPLSQLCommand(hSql(), ZAY2.strSqlDelete)
.head 8 -  Set bResult = FALSE
.head 8 -  Break
.head 5 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
.head 6 +  If not SqlPLSQLCommand(hSql(), ZAY2.strSqlUpdate)
.head 7 -  Set bResult = FALSE
.head 7 -  Break
.head 4 +  If bResult
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Else
.head 5 -  Call SqlRollback(hSql())
.head 3 +  On SAM_TblDoDetails
.head 4 +  If ZAY2.KB != STRING_Null
.head 5 -  Call SalEnableWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbPrintZayCorp)
.head 1 +  Table Window: ZAY3
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: НЕТТО - заявки на покупку-продажу валюты
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.87"
.head 4 -  Top:    0.842"
.head 4 -  Width:  13.517"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.905"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Black
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Нетто заявок
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Top
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.488"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.683"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.933"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.1"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Books1.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удовлетворение заявок'
.head 6 +  On SAM_Click
.head 7 -  Call ZAYf (hWnd3, nPar1)
.head 4 -  Line
.head 5 -  Resource Id: 34846
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.383"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  1.383"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.967"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.517"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryDFilterEx(cF_Zay)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34847
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.533"
.head 6 -  Begin Y:  0.048"
.head 6 -  End X:  7.533"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Покупка
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.024"
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.452"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Покупка'
.head 6 +  On SAM_Click
.head 7 +  If nPar1 = 35
.head 8 -  Call ZAYf (hWndMDI, nPar1) 
.head 7 +  If nPar1 = 31 
.head 8 +  If not IsWindow(hWnd1)
.head 9 -  Set hWnd1 = SalCreateWindow(ZAY1, hWndMDI, nPar2, sPar3, sPar4)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop (ZAY1)
.head 4 +  Pushbutton: pb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Продажа
.head 5 -  Window Location and Size
.head 6 -  Left:   7.733"
.head 6 -  Top:    0.024"
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.452"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продажа'
.head 6 +  On SAM_Click
.head 7 +  If nPar1 = 35 
.head 8 -  Call ZAYf (hWndMDI, nPar1) 
.head 7 +  If nPar1 = 31 
.head 8 +  If not IsWindow(hWnd2)
.head 9 -  Set hWnd2 = SalCreateWindow(ZAY2, hWndMDI, nPar2, sPar3, sPar4)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop (ZAY2)
.head 4 -  Line
.head 5 -  Resource Id: 34848
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.7"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  2.7"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.983"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb12
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Текущие/Все заявки'
.head 6 +  On SAM_Click
.head 7 -  Set bAll = not bAll
.head 7 +  If bAll
.head 8 -  Call cF_Zay.Init('v_zay', 'v_zay')
.head 8 -  Call SalSendMsg(pbFilter, SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  Call cF_Zay.Init('v_zay_queue', 'v_zay_queue')
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Архив операций'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndA)
.head 8 -  Set hWndA = SalCreateWindow(ZAYA, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYA)
.head 4 +  Pushbutton: pbK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.433"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custpers.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Параметры клиентов'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndK)
.head 8 -  Set hWndK = SalCreateWindow(ZAYK, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYK)
.head 4 +  Pushbutton: pbN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.3"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_lims.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'НЕиспользование купленной валюты'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndN)
.head 8 -  Set hWndN = SalCreateWindow(ZAYN, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYN)
.head 4 +  Pushbutton: pbP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.867"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Currconv.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перекрытие торговых счетов'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndP)
.head 8 -  Set hWndP = SalCreateWindow(ZAYP, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYP)
.head 4 +  Pushbutton: pbKurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Create.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Курс дилера'
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow(ZAYD, hWndMDI, nID, nPar1)
.head 4 +  Pushbutton: pbKURS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.5"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlgKURS, hWndMDI)
.head 2 +  Contents
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ISO
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: LCV_CONV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЗА
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П О К У П К А
- Сумма 
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П О К У П К А
- Сумма 
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П О К У
курс
ЗАЯВКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_1B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П К А
курс
ДИЛЕРА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П Р О Д А Ж А 
+ Сумма
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П Р О Д А Ж А 
+ Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П Р О Д 
курс
ЗАЯВКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_2B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: А Ж А 
курс
ДИЛЕРА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Н Е Т Т О
Продажа (+)
Покупка  (-)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S3s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Н Е Т Т О
Продажа (+)
Покупка  (-)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.Поз.
Длинная (+)
Короткая (-)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S4s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.Поз.
Длинная (+)
Короткая (-)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SPOT
Курс

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отм
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar1
.head 3 -  Number: nPar2
.head 3 -  String: sPar3
.head 3 -  String: sPar4
.head 2 +  Window Variables
.head 3 -  String: sdat
.head 3 -  String: sS1
.head 3 -  String: sS2
.head 3 -  String: sS3
.head 3 -  Number: nFetchRes
.head 3 -  Number: nID
.head 3 -  Boolean: bAll
.head 3 -  String: sFilter
.head 3 -  : cF_Zay
.head 4 -  Class: cGenDFilterEx
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 3)
.head 4 -  Call SalSetWindowText(hWndForm, 'СВОД заявок на ПОКУПКУ-ПРОДАЖУ валюты')
.head 4 -  Set ZAY3.strFilterTblName = 'V_ZAY'
.head 4 -  Set ZAY3.strPrintFileName = 'ZAY3'
.head 4 -  Set bAll = FALSE
.head 4 -  Set nID = GetUserId(  )
.head 4 -  !
.head 4 -  Call SalHideWindow(KURS_4)
.head 4 +  If nPar1 = 35
.head 5 -  Call SalDisableWindow( pbA )
.head 5 -  Call SalDisableWindow( pbK )
.head 5 -  Call SalDisableWindow( pbN )
.head 5 -  Call SalDisableWindow( pbP )
.head 5 -  Call SalDisableWindow( pb4 )
.head 5 -  Call SalDisableWindow( pb5 )
.head 5 -  Call SalDisableWindow( pb12 )
.head 5 -  Call SalHideWindow( S1 )
.head 5 -  Call SalHideWindow( S2 )
.head 5 -  Call SalHideWindow( S4 )
.head 5 -  Call SalHideWindow( S1s )
.head 5 -  Call SalHideWindow( S2s )
.head 5 -  Call SalHideWindow( S4s )
.head 5 -  Call SalHideWindow( KURS_1 )
.head 5 -  Call SalHideWindow( KURS_2 )
.head 5 -  Call SalHideWindow( KURS_1B )
.head 5 -  Call SalHideWindow( KURS_2B )
.head 5 -  Call SalHideWindow( DAT )
.head 4 +  Else If nPar1 = 311
.head 5 -  Call SalDisableWindow(pb4)
.head 5 -  Call SalDisableWindow(pb5)
.head 5 -  Call SalDisableWindow(pbKurs)
.head 5 -  Call SalDisableWindow(pbN)
.head 5 -  Call SalDisableWindow(pbP)
.head 5 -  Call SalDisableWindow(pbK)
.head 5 -  Call SalDisableWindow( pbDetails )
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbDetails)
.head 5 -  Call SalHideWindow(PR)
.head 4 -  !
.head 4 +  If nPar1 = 35
.head 5 -  Set ZAY3.strSqlPopulate = 
"SELECT sos, kv, pr, sb, sbq, ss, ssq
   INTO :ZAY3.SOS,:ZAY3.KV1,:ZAY3.PR,
        :ZAY3.S1,:ZAY3.KURS_1,:ZAY3.S2,:ZAY3.KURS_2 
   FROM v_zay_dealer
  ORDER BY 3 desc, 2, 1"
.head 4 -  !
.head 4 -  Call cF_Zay.Init('v_zay_queue', 'v_zay_queue')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If nPar1 = 35
.head 5 -  Set S3 = S2-S1
.head 5 +  If PR = 0
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 4 +  If DK = 5
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute( hSqlAux2(),"SELECT t.lcv, t.dig INTO :NAME, :DIG FROM tabval t WHERE t.kv=:KV1 " )
.head 5 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  !
.head 4 +  If SOS=0
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT sum(a.ostc)
   INTO :S4
   FROM accounts a
   WHERE a.kv=:KV1 and a.nbs='3800'")
.head 6 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  Set S1s=Dig4(S1/100,DIG,4)
.head 4 -  Set S2s=Dig4(S2/100,DIG,4)
.head 4 -  Set S3s=Dig4(S3/100,DIG,4)
.head 4 -  Set S4s=Dig4(S4/100,DIG,4)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set sFilter = cF_Zay.GetFilterWhereClause(FALSE)
.head 4 +  If nPar1 != 35
.head 5 -  Set ZAY3.strSqlPopulate =
"SELECT sos, fdat, kv2, nvl(lcv_conv,'UAH'), dk, to_number(null), 
        kurs_1, kurs_1b, sum(s1), 
        kurs_2, kurs_2b, sum(s2)
   INTO :ZAY3.SOS, :ZAY3.DAT, :ZAY3.KV1, :ZAY3.LCV_CONV, :ZAY3.DK, :ZAY3.S3,  
        :ZAY3.KURS_1, :ZAY3.KURS_1B, :ZAY3.S1,
        :ZAY3.KURS_2, :ZAY3.KURS_2B, :ZAY3.S2        
   FROM ( SELECT fdat, kv2, dk, lcv_conv,
                 decode(sos, 2, 1, 1, 1, 0) sos,
                 decode(dk, 1, kurs_z, null) kurs_1,
                 decode(dk, 2, kurs_z, null) kurs_2,
                 decode(dk, 1, s2,     null) s1,
                 decode(dk, 2, s2,     null) s2,
                 (case when dk = 1 and sos >= 1 then kurs_f else null end) kurs_1b,
                 (case when dk = 2 and sos >= 1 then kurs_f else null end) kurs_2b
            FROM " || IifS(bAll, "v_zay", "v_zay_queue") || "
           WHERE ( dk in (1, 3) and fdat > bankdate - :gZAYDAY
                or dk in (2, 4) and fdat > bankdate - :gZAYDAY - 1 )
             and s2 > 0 AND ((viza >= 1 AND priorverify = 0) OR (viza = 2 AND priorverify = 1))" ||
                 IifS(sFilter!=STRING_Null, " AND " || sFilter, "") ||
                 IifS(sPar4  !=STRING_Null, " AND " || sPar4,   "") || " ) 
  group by sos, fdat, kv2, lcv_conv, dk, kurs_1, kurs_1b, kurs_2, kurs_2b 
  UNION ALL  
 select decode(sos, 2, 1, 1, 1, 0), fdat, kv2, nvl(lcv_conv,'UAH'), 5, sum(decode(dk, 1, -s2, s2)),  
        null, null, null, null, null, null   
   FROM " || IifS(bAll, "v_zay", "v_zay_queue") || "
  WHERE ( dk in (1, 3) and fdat > bankdate - :gZAYDAY
      or  dk in (1, 3) and fdat > bankdate - :gZAYDAY - 1 )
    and s2 > 0 AND ((viza >= 1 AND priorverify = 0) OR (viza = 2 AND priorverify = 1))" || 
        IifS(sFilter!=STRING_Null, " AND " || sFilter, "") ||
        IifS(sPar4  !=STRING_Null, " AND " || sPar4,   "") || "
  GROUP BY decode(sos, 2, 1, 1, 1, 0), fdat, kv2, lcv_conv
  ORDER BY 2 desc, 3, 4, 1, 5"
.head 5 -  ! || IifS(bAll AND sFilter != STRING_Null, " AND "||sFilter, " ")
.head 5 -  Call SalSetWindowText(hWndForm, "НЕТТО - заявки на покупку-продажу валюты"||IifS(bAll, " (архив)", " (текущие)" ))
.head 4 -  !
.head 4 -  ! Call Debug(ZAY3.strSqlPopulate)
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), ZAY3.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  ! cGenericTable: ZAY3
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: НЕТТО - заявки на покутку-продажу валюты
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.87"
.head 4 -  Top:    0.842"
.head 4 -  Width:  13.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.905"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Black
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? No
.end
.head 2 -  Description: Нетто заявок
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.488"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbIns
.winattr
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDel
.winattr
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbUpdate
.winattr
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.683"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  !
.head 4 +  Pushbutton: pbRefresh
.winattr
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.933"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDetails
.winattr
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.5"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Books1.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удовлетворение заявок'
.head 6 +  On SAM_Click
.head 7 -  Call ZAYf (hWnd3, z)
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.383"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  1.383"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbSearch
.winattr
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.367"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbFilter
.winattr
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.717"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.933"
.head 6 -  Begin Y:  0.048"
.head 6 -  End X:  6.933"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pb5
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Покупка
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.024"
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.452"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Покупка'
.head 6 +  On SAM_Click
.head 7 +  If z=35
.head 8 -  Call ZAYf (hWndMDI, z) 
.head 7 +  If z=31 
.head 8 +  If not IsWindow(hWnd1)
.head 9 -  Set hWnd1 = SalCreateWindow(ZAY1, hWndMDI, 0, STRING_Null, STRING_Null)
.head 8 +  Else 
.head 9 -  Call SalBringWindowToTop ( ZAY1 )
.head 4 +  Pushbutton: pb4
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Продажа
.head 5 -  Window Location and Size
.head 6 -  Left:   7.133"
.head 6 -  Top:    0.024"
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.452"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продажа'
.head 6 +  On SAM_Click
.head 7 +  If z=35 
.head 8 -  Call ZAYf (hWndMDI, z) 
.head 7 +  If z=31 
.head 8 +  If not IsWindow(hWnd2)
.head 9 -  Set hWnd2 = SalCreateWindow(ZAY2, hWndMDI, 0, STRING_Null, STRING_Null)
.head 8 +  Else 
.head 9 -  Call SalBringWindowToTop ( ZAY2 )
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.7"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  2.7"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pb12
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Текущие/Все заявки'
.head 6 +  On SAM_Click
.head 7 -  Set bAll= not bAll
.head 7 -  Call SalSendMsg( pbFilter, SAM_Click, 0, 0)
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbA
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Архив операций'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndA)
.head 8 -  Set hWndA = SalCreateWindow(ZAYA, hWndMDI)
.head 7 +  Else 
.head 8 -  Call SalBringWindowToTop ( ZAYA )
.head 4 +  Pushbutton: pbK
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.833"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custpers.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Параметры клиентов '
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndK)
.head 8 -  Set hWndK = SalCreateWindow(ZAYK, hWndMDI)
.head 7 +  Else 
.head 8 -  Call SalBringWindowToTop ( ZAYK )
.head 4 +  Pushbutton: pbN
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_lims.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'НЕиспользование купленной валюты'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndN)
.head 8 -  Set hWndN = SalCreateWindow(ZAYN, hWndMDI)
.head 7 +  Else 
.head 8 -  Call SalBringWindowToTop ( ZAYN )
.head 4 +  Pushbutton: pbP
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.267"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Currconv.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перекрытие торговых счетов'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndP)
.head 8 -  Set hWndP = SalCreateWindow(ZAYP, hWndMDI)
.head 7 +  Else 
.head 8 -  Call SalBringWindowToTop ( ZAYP )
.head 4 +  Pushbutton: pbKurs
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.933"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Create.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Курс дилера'
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow(ZAYD, hWndMDI,nID,z)
.head 4 +  Pushbutton: pbKURS
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.5"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlgKURS, hWndMDI)
.head 2 +  Contents 
.head 3 +  Column: DAT
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: KV1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: DIG
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: NAME
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ISO
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П О К У П К А
- Сумма 
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S1s
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П О К У П К А
- Сумма 
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: KURS_1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П О К У
курс
ЗАЯВКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: KURS_1B
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П К А
курс
ДИЛЕРА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П Р О Д А Ж А 
+ Сумма
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S2s
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П Р О Д А Ж А 
+ Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: KURS_2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П Р О Д 
курс
ЗАЯВКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: KURS_2B
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: А Ж А 
курс
ДИЛЕРА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Н Е Т Т О
Продажа (+)
Покупка  (-)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S3s
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Н Е Т Т О
Продажа (+)
Покупка  (-)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S4
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.Поз.
Длинная (+)
Короткая (-)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: S4s
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.Поз.
Длинная (+)
Короткая (-)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: KURS_4
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SPOT
Курс

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: SOS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отм
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: DK
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: PR
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 2 -  Functions 
.head 2 +  Window Parameters 
.head 3 -  Number: z
.head 2 +  Window Variables 
.head 3 -  String: sdat
.head 3 -  String: sS1
.head 3 -  String: sS2
.head 3 -  String: sS3
.head 3 -  Number: nFetchRes
.head 3 -  Number: nID
.head 3 -  Boolean: bAll
.head 3 -  String: sFilter
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set nID=GetUserId(  )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 3)
.head 4 -  Set bAll=FALSE
.head 4 -  Set ZAY3.strFilterTblName = 'ZAYAVKA'
.head 4 -  Call SalHideWindow( KURS_4 )
.head 4 -  !
.head 4 +  If z=35
.head 5 -  Call SalDisableWindow( pbA )
.head 5 -  Call SalDisableWindow( pbK )
.head 5 -  Call SalDisableWindow( pbN )
.head 5 -  Call SalDisableWindow( pbP )
.head 5 -  Call SalDisableWindow( pb4 )
.head 5 -  Call SalDisableWindow( pb5 )
.head 5 -  Call SalDisableWindow( pb12 )
.head 5 -  Call SalHideWindow( S1 )
.head 5 -  Call SalHideWindow( S2 )
.head 5 -  Call SalHideWindow( S4 )
.head 5 -  Call SalHideWindow( S1s )
.head 5 -  Call SalHideWindow( S2s )
.head 5 -  Call SalHideWindow( S4s )
.head 5 -  Call SalHideWindow( KURS_1 )
.head 5 -  Call SalHideWindow( KURS_2 )
.head 5 -  Call SalHideWindow( KURS_1B )
.head 5 -  Call SalHideWindow( KURS_2B )
.head 5 -  Call SalHideWindow( DAT )
.head 4 +  Else If z=311  ! добавила Оля. Проверить!!!!!
.head 5 -  Call SalDisableWindow(pb4)
.head 5 -  Call SalDisableWindow(pb5)
.head 5 -  Call SalDisableWindow(pbKurs)
.head 5 -  Call SalDisableWindow(pbN)
.head 5 -  Call SalDisableWindow(pbP)
.head 5 -  Call SalDisableWindow(pbK)
.head 5 -  Call SalDisableWindow( pbDetails )
.head 4 +  Else 
.head 5 -  Call SalDisableWindow( pbDetails )
.head 5 -  Call SalHideWindow( PR )
.head 4 -  Call SalSetWindowText( hWndForm, 'СВОД заявок на ПОКУПКУ-ПРОДАЖУ валюты')
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Set ZAY3.strPrintFileName='ZAY3'
.head 4 -  !
.head 4 +  If z=35
.head 5 -  Set ZAY3.strSqlPopulate = 
"SELECT sos, kv, pr, sb, sbq, ss, ssq
   INTO :ZAY3.SOS,:ZAY3.KV1,:ZAY3.PR,
        :ZAY3.S1,:ZAY3.KURS_1,:ZAY3.S2,:ZAY3.KURS_2 
   FROM v_zay_dealer
  ORDER BY 3 desc, 2, 1"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_SetFocus
.head 4 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If z=35
.head 5 -  Set S3=S2-S1
.head 5 +  If PR=0
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 4 +  If DK=3
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute( hSqlAux2(),"SELECT t.lcv, t.dig INTO :NAME, :DIG FROM tabval t WHERE t.kv=:KV1 " )
.head 5 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  !
.head 4 +  If SOS=0
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT sum(a.ostc)
   INTO :S4
   FROM accounts a
   WHERE a.kv=:KV1 and a.nbs='3800'")
.head 6 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  Set S1s=Dig4(S1/100,DIG,4)
.head 4 -  Set S2s=Dig4(S2/100,DIG,4)
.head 4 -  Set S3s=Dig4(S3/100,DIG,4)
.head 4 -  Set S4s=Dig4(S4/100,DIG,4)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set sFilter=cF.GetFilterWhereClause(TRUE)
.head 4 +  If z != 35
.head 5 -  Set ZAY3.strSqlPopulate =
"SELECT decode(zayavka.sos,2,1,1,1,0), zayavka.fdat, 
        zayavka.kv2, zayavka.dk, to_number(NULL), 
        decode(zayavka.dk,1,zayavka.kurs_z,to_number(NULL)),
        decode(zayavka.dk,1,decode(zayavka.sos,2,1,1,1,to_number(NULL))*zayavka.kurs_f,to_number(NULL)), 
        sum(decode(zayavka.dk,1,zayavka.s2,to_number(NULL))),  
        decode(zayavka.dk,1,to_number(NULL),zayavka.kurs_z),
        decode(zayavka.dk,1,to_number(NULL),decode(zayavka.sos,2,1,1,1,to_number(NULL))*zayavka.kurs_f), 
        sum(decode(zayavka.dk,1,to_number(NULL),zayavka.s2))   
   INTO :ZAY3.SOS,:ZAY3.DAT,:ZAY3.KV1,:ZAY3.DK,:ZAY3.S3,  
        :ZAY3.KURS_1,:ZAY3.KURS_1B,:ZAY3.S1,
        :ZAY3.KURS_2,:ZAY3.KURS_2B,:ZAY3.S2        
   FROM zayavka "||IifS(bAll, " ", " ,zay_queue q ")||   
" WHERE zayavka.s2 > 0 AND 
       (
       (zayavka.viza >= 1 AND zayavka.priority = 0) 
        OR
       (zayavka.viza  = 2 AND zayavka.priority > 0)
       ) "||
 IifS(bAll, 
           IifS(sFilter = STRING_Null, " ", " AND "||sFilter), 
           " AND zayavka.id = q.id "||IifS(sFilter = STRING_Null, " ", " AND "||sFilter)
      )||  
" GROUP BY zayavka.sos, zayavka.fdat, zayavka.kv2, zayavka.dk, zayavka.kurs_z, zayavka.kurs_f   
  UNION ALL  
 SELECT decode(zayavka.sos,2,1,1,1,0), zayavka.fdat, 
        zayavka.kv2, 3, sum(decode(zayavka.dk,1,-zayavka.s2,zayavka.s2)),  
        to_number(NULL),to_number(NULL),to_number(NULL),
        to_number(NULL),to_number(NULL),to_number(NULL)   
   FROM zayavka "||IifS(bAll, " ", " ,zay_queue q ")||      
" WHERE zayavka.s2 > 0 AND 
       (
       (zayavka.viza >= 1 AND zayavka.priority = 0) 
        OR
       (zayavka.viza  = 2 AND zayavka.priority > 0 )
       ) "||
 IifS(bAll, 
          IifS(sFilter = STRING_Null, " ", " AND "||sFilter), 
          " AND zayavka.id = q.id "||IifS(sFilter = STRING_Null, " ", " AND "||sFilter) 
     )||  
" GROUP BY zayavka.sos, zayavka.fdat, zayavka.kv2 
  ORDER BY 2 desc, 3, 1, 4 "
.head 5 -  Call SalSetWindowText(hWndForm, "НЕТТО - заявки на покупку-продажу валюты"||IifS(bAll, " (архив)", " " ))
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), ZAY3.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: ZAYP 
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Перекрытие Сальдо торговых счетов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.838"
.head 4 -  Top:    0.25"
.head 4 -  Width:  16.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.512"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Перекрытие торговых счетов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.44"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  Background Text: Торговые счета клиентов
.head 5 -  Resource Id: 30624
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.767"
.head 6 -  Top:    0.19"
.head 6 -  Width:  3.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 4 -  Background Text: Перекрыть
.head 5 -  Resource Id: 30625
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.4"
.head 6 -  Top:    0.19"
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbOPL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.25"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сформировать ПРОВОДКИ'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( "Сформировать проводки ?",
" Перекрытие выбранных счетов ", MB_IconQuestion | MB_YesNo ) = IDYES
.head 8 +  If CIKL_tbl()=1
.head 9 -  Call SalMessageBox('Выполнен успешно','Проект проводок',MB_IconInformation)
.head 9 -  Call FU1()
.head 8 +  Else
.head 9 -  Call SalMessageBox('НЕУСПЕШНАЯ попытка !','Проект проводок',MB_IconStop)
.head 4 +  Pushbutton: pb12
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перекрыть'
.head 6 +  On SAM_Click
.head 7 +  If nTB1 > 0
.head 8 -  Call SalModalDialog(dlgPerekr, ZAYP,tb1.S, SP, NAZN)
.head 8 -  Call SalTblInsertRow(tb2, 1)
.head 8 -  Set tb2.NMK  = tb1.NMK
.head 8 -  Set tb2.OKPO = tb1.OKPO
.head 8 -  Set tb2.NLS1 = tb1.NLS1
.head 8 -  Set tb2.MFO  = tb1.MFO
.head 8 -  Set tb2.NLS  = tb1.NLS
.head 8 -  Set tb2.KV   = tb1.KV
.head 8 -  Set tb2.DAT  = tb1.DAT
.head 8 -  Set tb2.S    = SP
.head 8 -  Set tb2.NAZN = NAZN
.head 8 -  Call SalTblSetFlagsAnyRows(tb2, ROW_New, FALSE, 0, 0)
.head 8 +  If tb1.S = SP
.head 9 -  Call SalTblDeleteRow(tb1, SalTblQueryContext(tb1), TBL_NoAdjust)
.head 8 +  Else
.head 9 -  Set tb1.S = tb1.S - SP
.head 8 -  Call SalTblSetContext (tb1, 0)
.head 8 -  Call SalTblSetContext (tb2, 0)
.head 8 -  Set nTB1 = nTB1-1
.head 8 -  Set nTB2 = nTB2+1
.head 8 -  Call FU2()
.head 4 +  Pushbutton: pb21
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вернуть'
.head 6 +  On SAM_Click
.head 7 -  Call SalTblInsertRow( tb1, 1)
.head 7 +  If nTB2>0
.head 8 -  Set tb1.NMK =tb2.NMK
.head 8 -  Set tb1.OKPO =tb2.OKPO
.head 8 -  Set tb1.MFO =tb2.MFO
.head 8 -  Set tb1.NLS1=tb2.NLS1
.head 8 -  Set tb1.NLS =tb2.NLS
.head 8 -  Set tb1.KV  =tb2.KV
.head 8 -  Set tb1.DAT =tb2.DAT
.head 8 -  Set tb1.S = tb2.S
.head 8 -  Call SalTblSetFlagsAnyRows( tb1, ROW_New, FALSE,0,0 )
.head 8 -  Call SalTblDeleteRow( tb2, SalTblQueryContext ( tb2 ), TBL_NoAdjust )
.head 8 -  Call SalTblSetContext (tb2, 0)
.head 8 -  Call SalTblSetContext (tb1, 0)
.head 8 -  Set nTB1=nTB1+1
.head 8 -  Set nTB2=nTB2-1
.head 8 -  Call FU2()
.head 4 +  Pushbutton: pbEXIT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.733"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 2 +  Contents
.head 3 +  Child Table: tb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  8.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.274"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Клиент
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: код ОКПО
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
банка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расчетный 
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Торговый 
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ВАЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата посл.
движения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set nTB1=nTB1+1
.head 6 +  If ZAYP.tb1.KV = 840
.head 7 -  Call SetTblRowColor( ZAYP.tb1, COLOR_DarkGreen )
.head 6 +  Else If ZAYP.tb1.KV = 978
.head 7 -  Call SetTblRowColor( ZAYP.tb1, COLOR_MidnightBlue )
.head 6 +  Else If ZAYP.tb1.KV = 643
.head 7 -  Call SetTblRowColor( ZAYP.tb1, COLOR_Red )
.head 6 +  Else
.head 7 -  Call SetTblRowColor( ZAYP.tb1,  COLOR_Default )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pb12, SAM_Click, 0, 0 )
.head 3 +  Child Table: tb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.0"
.head 6 -  Width:  7.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.274"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Burgundy
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Клиент
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код ОКПО
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
банка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расчетный 
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Торговый
 счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.65"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ВАЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
перекрытия 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
последнего
 движения
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pb21, SAM_Click, 0, 0 )
.head 2 +  Functions
.head 3 +  Function: FU1
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblReset( tb2 )
.head 5 -  Set nTB2=0
.head 5 -  Set nTB1=0
.head 5 -  ! Call SalTblPopulate (tb1, hSql(),
     "SELECT c.nmk, c.okpo, a.kv, a.nls, 
             a.dapp, a.ostc/100, z.nlsv, z.mfov
        INTO :tb1.NMK,:tb1.OKPO,:tb1.KV,:tb1.NLS,
             :tb1.DAT,:tb1.S,:tb1.NLS1,:tb1.MFO
        FROM accounts a, cust_zay z, customer c
       WHERE z.rnk = c.rnk   
         AND a.nls = z.nls29 
         AND a.kv = 980 
         AND z.nlsv IS NOT NULL 
         AND z.mfov IS NOT NULL
         AND (
             z.mfov <> substr(f_ourmfo,1,6) 
             OR
             z.mfov = substr(f_ourmfo,1,6) 
             AND 
	     z.nlsv IN (SELECT nls FROM accounts 
                         WHERE nls = z.nlsv AND kv = 980)
             ) 
         AND a.ostc = a.ostb 
         AND a.ostc <> 0
         AND a.nls <> z.nlsv
       ORDER BY 2, 1", TBL_FillAll)
.head 5 -  Call SalTblPopulate (tb1, hSql(),
     "SELECT c.nmk, c.okpo, a.kv, a.nls, 
             a.dapp, a.ostc/100, z.nlsv, z.mfov
        INTO :tb1.NMK,:tb1.OKPO,:tb1.KV,:tb1.NLS,
             :tb1.DAT,:tb1.S,:tb1.NLS1,:tb1.MFO
        FROM accounts a, cust_zay z, customer c
       WHERE z.rnk = c.rnk   
         AND a.nls = z.nls29 
         AND z.nlsv IS NOT NULL 
         AND z.mfov IS NOT NULL
         AND (
             z.mfov <> substr(f_ourmfo,1,6) 
             OR
             z.mfov = substr(f_ourmfo,1,6) 
             AND 
	     z.nlsv IN (SELECT nls FROM accounts 
                         WHERE nls = z.nlsv AND kv = a.kv)
             ) 
         AND a.ostc = a.ostb 
         AND a.ostc <> 0
         AND a.nls <> z.nlsv
       ORDER BY 3, 2, 1", TBL_FillAll)
.head 5 -  !
.head 5 -  Call FU2()
.head 3 +  Function: FU2
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nTB1>0
.head 6 -  Call SalEnableWindow( pb12 )
.head 5 +  Else
.head 6 -  Call SalDisableWindow( pb12 )
.head 5 +  If nTB2>0
.head 6 -  Call SalEnableWindow( pbOPL )
.head 6 -  Call SalEnableWindow( pb21 )
.head 5 +  Else
.head 6 -  Call SalDisableWindow( pbOPL )
.head 6 -  Call SalDisableWindow( pb21 )
.head 3 +  Function: CIKL_tbl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRETU
.head 5 -  Number: nd
.head 5 -  Number: nVob
.head 5 -  String: lstrSign 
.head 5 -  Number: nRetCode
.head 5 -  Number: nRecOut 
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set nRETU=0
.head 5 -  Set i = TBL_MinRow
.head 5 -  Set nd=0
.head 5 +  While SalTblFindNextRow( tb2, i, 0, 0 )
.head 6 -  Call SalTblFetchRow( tb2, i )
.head 6 -  Set nd=nd+1
.head 6 -  ! вставка в OPER 
.head 6 +  If tb2.MFO = GetBankMfo(  )
.head 7 -  ! Вид документа из карточки операции
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nvl(min(vob),6) INTO :nVob 
     FROM tts_vob 
    WHERE tt = :sTT1")
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nVob = 6
.head 7 -  Call cDoc2.SetDoc(0,sTT1,1,nVob,Str(nd),dDATA, dDATA, dDATA,dDATA,
     Str(tb2.NLS), tb2.NMK, aMFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     Str(tb2.NLS1),tb2.NMK, aMFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     tb2.NAZN, '', GetIdOper(), '', NUMBER_Null,0 )
.head 7 -  ! Call cDoc2.SetDoc(0,sTT1,1,nVob,Str(nd),dDATA, dDATA, dDATA,dDATA,
     Str(tb2.NLS), tb2.NMK, aMFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     Str(tb2.NLS1),tb2.NMK, aMFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     'Повернення коштів, надлишково перерахованих для купівлі іноземної валюти', 
     '', GetIdOper(), '', NUMBER_Null,0 )
.head 6 +  Else
.head 7 -  ! Вид документа из карточки операции
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nvl(min(vob),1) INTO :nVob 
     FROM tts_vob 
    WHERE tt = :sTT2")
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nVob = 1
.head 7 -  Call cDoc2.SetDoc(0,sTT2,1,nVob,Str(nd),dDATA, dDATA, dDATA,dDATA,
     Str(tb2.NLS), tb2.NMK,    aMFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     Str(tb2.NLS1),tb2.NMK, tb2.MFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     tb2.NAZN, '', GetIdOper(), '', NUMBER_Null,0 )
.head 7 -  ! Call cDoc2.SetDoc(0,sTT2,1,nVob,Str(nd),dDATA, dDATA, dDATA,dDATA,
     Str(tb2.NLS), tb2.NMK,    aMFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     Str(tb2.NLS1),tb2.NMK, tb2.MFO, '', tb2.KV, tb2.S*100, tb2.OKPO, 
     'Повернення коштів, надлишково перерахованих для купівлі іноземної валюти', '', GetIdOper(), '', NUMBER_Null,0 )
.head 6 +  If cDoc2.oDoc()
.head 7 -  Set nRETU=1
.head 6 +  If nRETU=1
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return nRETU
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  Number: nTB2
.head 3 -  Number: SP
.head 3 -  String: NAZN
.head 3 -  Number: nTB1
.head 3 -  Number: i
.head 3 -  String: sNA
.head 3 -  String: aMFO
.head 3 -  String: sDATA
.head 3 -  Date/Time: dDATA
.head 3 -  : cDoc2
.head 4 -  Class: cDoc
.head 3 -  String: sTT1
.head 3 -  String: sTT2
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set aMFO = GetBankMfo()
.head 4 -  Set dDATA = GetBankDate()
.head 4 -  Set sDATA = SalFmtFormatDateTime(dDATA, "MM/dd/yyyy")
.head 4 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT t.tt INTO :sTT1 
     FROM birja b, tts t 
    WHERE substr(b.val,1,3) = t.tt 
      AND b.par = 'TT_PS1' " ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set sTT1 = 'PS1' 
.head 4 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT t.tt INTO :sTT2
     FROM birja b, tts t 
    WHERE substr(b.val,1,3) = t.tt 
      AND b.par = 'TT_PS2' " ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set sTT2 = 'PS2' 
.head 4 -  Call FU1()
.head 1 +  Table Window: ZAYN
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: НЕиспользование купленной валюты 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.088"
.head 4 -  Top:    0.271"
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Не использование купленной валюты
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.393"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27637
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.35"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.35"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотр истории счета клиента'
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(ZAYN.RNK)
.head 8 -  Call ShowAccList(ZAYN.RNK,AVIEW_CUST,AVIEW_Financial|AVIEW_ReadOnly|AVIEW_ReadOnly|AVIEW_ExistOnly," a.acc = "||Str(ZAYN.ACC) )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.82"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27638
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.083"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  3.083"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27639
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.933"
.head 6 -  Begin Y:  -0.071"
.head 6 -  End X:  0.933"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\FILTER.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Код
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Код
ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.
 №
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Наименование
покупателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Лиц. счет
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Сальдо 
счета
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SALs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Сальдо 
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Последняя
дата
покупки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Сумма
покупки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SZs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Сумма
покупки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Референс
документа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Последняя
дата
Дебета сч
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DNI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: День
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Раз-
ница
дней
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Date/Time: dDATA
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 -  Set dDATA=GetBankDate()
.head 4 -  Set ZAYN.nTabInstance = 1
.head 4 -  Set ZAYN.strPrintFileName = 'ZAYN'
.head 4 -  Set ZAYN.strFilterTblName = 'V_ZAY'
.head 4 -  Set ZAYN.fFilterAtStart = TRUE
.head 4 -  Set ZAYN.strSqlPopulate =
"SELECT v_zay.ref, v_zay.s2, v_zay.rnk, o.acc, max(o.fdat),
        v_zay.nmk, a.kv, t.dig, a.nls, a.ostc  
   INTO :ZAYN.REF,:ZAYN.SZ,:ZAYN.RNK,:ZAYN.ACC,:ZAYN.DAT1,
        :ZAYN.NMK,:ZAYN.KV,:ZAYN.DIG,:ZAYN.NLS,:ZAYN.SAL 
   FROM opldok o, v_zay, accounts a, tabval t   
  WHERE v_zay.sos=2       AND v_zay.dk=1     AND 
        v_zay.ref=o.ref   AND o.sos=5        AND
        v_zay.acc1=o.acc  AND o.dk=1         AND 
        o.fdat<=BANKDATE  AND t.kv=a.kv      AND 
        a.acc=o.acc       
  GROUP BY v_zay.ref,v_zay.s2,v_zay.rnk,o.acc,v_zay.nmk,a.kv,t.dig,a.nls,a.ostc 
  ORDER BY 1"  
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT min(fdat) INTO :ZAYN.DAT2 
     FROM saldoa
    WHERE acc=:ZAYN.ACC AND 
          dos>0         AND 
          fdat>=:ZAYN.DAT1")
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If ZAYN.DAT2 = DATETIME_Null
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
   " SELECT count(*) INTO :ZAYN.DNI FROM fdat
     WHERE fdat>=:ZAYN.DAT1 AND fdat<=:dDATA " )
AND SqlFetchNext( hSqlAux2(), nFetchRes )
.head 5 +  Else
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
   " SELECT count(*) INTO :ZAYN.DNI FROM fdat
     WHERE fdat>=:ZAYN.DAT1 AND fdat<=:ZAYN.DAT2 " )
AND SqlFetchNext( hSqlAux2(), nFetchRes )
.head 5 +  If ZAYN.DNI >= 10 
.head 6 +  If ZAYN.DNI = 10
.head 7 -  Call VisTblSetRowColor( hWndForm, SalTblQueryContext( hWndForm ), COLOR_Blue )
.head 6 +  Else
.head 7 -  Call VisTblSetRowColor( hWndForm, SalTblQueryContext( hWndForm ), COLOR_Red )
.head 5 -  Set SALs=Dig4(SAL/100,DIG,4)
.head 5 -  Set SZs=Dig4(SZ/100,DIG,4)
.head 1 +  Table Window: ZAYK
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры клиентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.163"
.head 4 -  Top:    0.208"
.head 4 -  Width:  13.117"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Параметры клиентов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 15925
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.883"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  1.883"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.867"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Паспорт клиента'
.head 6 +  On SAM_Click
.head 7 +  If TIP =2
.head 8 -  Call EditCustCorps( RNK,   CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 7 +  Else If TIP =3
.head 8 -  Call EditCustPerson( RNK,  CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 7 +  Else If TIP =1
.head 8 -  Call EditCustBanks( RNK,  CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.167"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 15926
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.783"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  4.783"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.9"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 15927
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.883"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  1.883"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbPrcAcc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Открытые счета клиента'
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(RNK)
.head 8 -  Call ShowAccList(RNK,AVIEW_CUST,AVIEW_Financial|AVIEW_ReadOnly|AVIEW_ReadOnly|AVIEW_ExistOnly," a.nbs in (SELECT nbs FROM zay_bal)")
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.733"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chkmail.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Справка из НИ'
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndNAL)
.head 8 -  Set hWndNAL = SalCreateWindow(ZAYNAL,hWndMDI,RNK,0,NUMBER_Null,NUMBER_Null,DATETIME_Null,NUMBER_Null,STRING_Null)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( ZAYNAL )
.head 4 -  Line
.head 5 -  Resource Id: 33554
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.683"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  4.683"
.head 6 -  End Y:  0.071"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 2 +  Contents
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.
номер
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  ! наименование клиента
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT nmk,custtype,okpo,nd
   INTO   :ZAYK.NMK,:ZAYK.TIP,:ZAYK.OKPO26,:ZAYK.ND
   FROM   customer
   WHERE  date_off IS NULL AND rnk=" || Str(ZAYK.RNK))
.head 6 -  ! Return IifN(SqlFetchNext(hSql(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рег.номер клієнта!',
     'Неверно указан рег.номер клиента!'), IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
клиента
(симв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  ! наименование клиента
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT rnk,nmk,custtype,okpo
   INTO   :ZAYK.RNK,:ZAYK.NMK,:ZAYK.TIP,:ZAYK.OKPO26
   FROM   customer
   WHERE  date_off IS NULL AND nd='" || SalStrTrimX(ZAYK.ND) || "'")
.head 6 -  ! Return IifN(SqlFetchNext(hSql(),nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний номер!', 'Неверно указан номер!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPO26
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If V_Okpo(OKPO26) != OKPO26 OR (Len(OKPO26)<8 AND Len(OKPO26)!=3)
.head 7 -  Call Debug('Введите правильный код ОКПО!')
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: MFO26
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
расч.
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call SqlPrepareAndExecute(hSqlAux(), "
     SELECT nb
     INTO   :NB26
     FROM   banks
     WHERE  mfo=:MFO26")
.head 6 -  ! Return IifN(SqlFetchNext(hSqlAux(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний код МФО!', 'Неверно указан код МФО!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: NB26
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
банка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS26
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расчетный счет 
для 
зачисления
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If MFO26 != STRING_Null and MFO26 != GetBankMfo()
.head 7 -  ! Return IifN(Vkrz2(MFO26, Str(NLS26))=Str(NLS26), VALIDATE_Ok, VALIDATE_Cancel)
.head 7 +  If Vkrz2(MFO26, Str(NLS26)) = Str(NLS26)
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  ! Return IifN(SqlFetchNext(hSql(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 7 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT acc
     INTO   :ACC
     FROM   accounts
     WHERE  nls=:NLS26 AND kv=:nBaseVal AND dazs IS NULL")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 3 +  Column: NLS29
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Торговый счет 
для
списания
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  ! Return IifN(SqlFetchNext(hSql(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT acc
     INTO   :ACC
     FROM   accounts
     WHERE  nls=:NLS29 AND kv=:nBaseVal AND dazs IS NULL")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: KOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
комисс.
покупка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOM2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
комисс.
продажа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOM3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
комисс.
конверсия
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FL_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Флаг
опл
ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If FL_PF = 0
.head 7 -  Call SalDisableWindow(RNK_PF)
.head 7 -  Call SalDisableWindow(NLSP)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(RNK_PF)
.head 7 -  Call SalEnableWindow(NLSP)
.head 3 +  Column: RNK_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№
клиента
в ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет клиента 
для списания
в ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT a.nls
   INTO   :ZAYK.NLS_PF
   FROM   accounts a
   WHERE  a.dazs IS NULL AND a.kv=:nBaseVal AND a.rnk=:ZAYK.RNK AND a.nls=:ZAYK.NLS_PF") AND
   NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: NLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет клиента 
для отчислений 
в ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If SqlPrepareAndExecute( hSql(), "
   SELECT a.nls
   INTO   :ZAYK.NLSP
   FROM   accounts a
   WHERE  a.dazs IS NULL AND a.kv=:nBaseVal AND a.rnk=:ZAYK.RNK AND a.nls=:ZAYK.NLSP") AND
   NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: NLSV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
для возврата
излишка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  ! Return IifN(SalIsNull(MFOV) OR Vkrz2(MFOV, NLSV)=NLSV, VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SalIsNull(MFOV) OR Vkrz2(MFOV, NLSV)=NLSV
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: MFOV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
счета
возврата
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call SqlPrepareAndExecute(hSqlAux(), "
     SELECT nb
     INTO   :sNBV
     FROM   banks
     WHERE  mfo=:MFOV")
.head 6 -  ! Return IifN(SqlFetchNext(hSqlAux(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний код МФО!', 'Неверно указан код МФО!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: TIP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FIO 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО 
контактного
лица
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Контактный
телефон

.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 20
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS_KOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет комиссии
банка
(покупка)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT acc
     INTO   :nTmp 
     FROM   accounts
     WHERE  nls=:NLS_KOM AND kv=:nBaseVal AND dazs IS NULL")
.head 6 -  ! Return IifN(SqlFetchNext(hSql(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: NLS_KOM2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет комиссии
банка
(продажа)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT acc
     INTO   :nTmp
     FROM   accounts
     WHERE  nls=:NLS_KOM2 AND kv=:nBaseVal AND dazs IS NULL")
.head 6 -  ! Return IifN(SqlFetchNext(hSql(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: CMSACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет клиента
для списания
комиссии
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CMSNUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Альтернативный
счет клиента
для списания
комиссии
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Set CMSACC = NUMBER_Null
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT acc
     INTO   :CMSACC
     FROM   accounts
     WHERE  nls=:CMSNUM AND kv=:nBaseVal AND dazs IS NULL")
.head 6 -  ! Return IifN(SqlFetchNext(hSql(), nFetchRes), VALIDATE_Ok, VALIDATE_Cancel)
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox(IifS(GetLang()='UKR', 'Невірно вказаний рахунок!', 'Неверно указан счет!'),
     IifS(GetLang()='UKR', 'Помилка!', 'Ошибка!'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Number: nBaseVal
.head 3 -  Number: nTmp
.head 3 -  Number: ACC
.head 3 -  Number: nPF
.head 3 -  Number: nPFCUST
.head 3 -  Number: nEIK_ND
.head 3 -  String: sNBV
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set ZAYK.nTabInstance = 1
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Set ZAYK.strPrintFileName='ZAYK'
.head 4 -  Set ZAYK.strFilterTblName='CUST_ZAY'
.head 4 -  Set nBaseVal = GetBaseVal(  )
.head 4 -  !
.head 4 -  Call BIRZA('PEN_FOND',nPF )
.head 4 -  Call BIRZA('PF_CUST', nPFCUST )
.head 4 +  If nPF=0 
.head 5 -  Call SalHideWindow( FL_PF )
.head 5 -  Call SalHideWindow( RNK_PF )
.head 5 -  Call SalHideWindow( NLSP )
.head 4 +  Else If nPFCUST = 1
.head 5 -  Call SalShowWindow( FL_PF )
.head 5 -  Call SalShowWindow( RNK_PF )
.head 5 -  Call SalShowWindow( NLSP )
.head 4 +  Else
.head 5 -  Call SalShowWindow( FL_PF )
.head 5 -  Call SalShowWindow( RNK_PF )
.head 5 -  Call SalHideWindow( NLSP )
.head 4 -  !
.head 4 -  Call BIRZA('EIK_ND', nEIK_ND)
.head 4 +  If nEIK_ND = 1 
.head 5 -  Call SalShowWindow(ZAYK.ND)
.head 4 +  Else
.head 5 -  Call SalHideWindow(ZAYK.ND)
.head 4 -  !
.head 4 -  Set ZAYK.strSqlUpdate = 
   "UPDATE cust_zay SET     
      rnk     = :ZAYK.RNK,     nls29    = :ZAYK.NLS29, 
      fl_pf   = :ZAYK.FL_PF,   rnk_pf   = :ZAYK.RNK_PF,      
      mfo26   = :ZAYK.MFO26,   nls26    = :ZAYK.NLS26,  
      okpo26  = :ZAYK.OKPO26,  nlsp     = :ZAYK.NLSP, 
      nls_pf  = :ZAYK.NLS_PF,      
      kom     = :ZAYK.KOM,     kom2     = :ZAYK.KOM2,
      kom3    = :ZAYK.KOM3,
      fio     = :ZAYK.FIO,     tel      = :ZAYK.TEL,       
      mfov    = :ZAYK.MFOV,    nlsv     = :ZAYK.NLSV,
      nls_kom = :ZAYK.NLS_KOM, nls_kom2 = :ZAYK.NLS_KOM2,
      custacc4cms = :ZAYK.CMSNUM     
    WHERE rnk=:ZAYK.RNK"       
.head 4 -  !
.head 4 -  Set ZAYK.strSqlDelete = 
   "DELETE from cust_zay WHERE rnk=:ZAYK.RNK"       
.head 4 -  !
.head 4 -  Set ZAYK.strSqlInsert =
   "INSERT into cust_zay
     (rnk, mfo26, nls26, okpo26, nls29, 
      kom, kom2, kom3, nls_kom, nls_kom2,
      fl_pf, rnk_pf, nlsp, nls_pf, fio, tel, mfov, nlsv, custacc4cms) 
    VALUES 
     (:ZAYK.RNK,:ZAYK.MFO26,:ZAYK.NLS26,:ZAYK.OKPO26,:ZAYK.NLS29,
      :ZAYK.KOM,:ZAYK.KOM2,:ZAYK.KOM3,:ZAYK.NLS_KOM,:ZAYK.NLS_KOM2,     
      :ZAYK.FL_PF,:ZAYK.RNK_PF,:ZAYK.NLSP, :ZAYK.NLS_PF,
      :ZAYK.FIO,:ZAYK.TEL,:ZAYK.MFOV,:ZAYK.NLSV,:ZAYK.CMSNUM)"       
.head 4 -  !
.head 4 -  Set ZAYK.strSqlPopulate =
   "SELECT cust_zay.rnk, c.nmk, c.custtype, c.nd,
           cust_zay.nls26, cust_zay.mfo26, b26.nb, cust_zay.okpo26, cust_zay.nls29, 
           cust_zay.kom, cust_zay.kom2, cust_zay.kom3, cust_zay.nls_kom, cust_zay.nls_kom2, 
           cust_zay.fl_pf, cust_zay.rnk_pf, cust_zay.nlsp, cust_zay.nls_pf, 
           cust_zay.fio, cust_zay.tel, cust_zay.mfov, cust_zay.nlsv,
           cust_zay.custacc4cms
       INTO :ZAYK.RNK, :ZAYK.NMK, :ZAYK.TIP, :ZAYK.ND,
           :ZAYK.NLS26, :ZAYK.MFO26, :ZAYK.NB26, :ZAYK.OKPO26, :ZAYK.NLS29,
           :ZAYK.KOM, :ZAYK.KOM2, :ZAYK.KOM3, :ZAYK.NLS_KOM, :ZAYK.NLS_KOM2,     
           :ZAYK.FL_PF, :ZAYK.RNK_PF, :ZAYK.NLSP, :ZAYK.NLS_PF,
           :ZAYK.FIO, :ZAYK.TEL, :ZAYK.MFOV, :ZAYK.NLSV,
           :ZAYK.CMSNUM              
      FROM cust_zay, banks b26, customer c
     WHERE cust_zay.rnk         = c.rnk(+)
       AND cust_zay.mfo26       = b26.mfo(+)        
  ORDER BY cust_zay.rnk"       
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Call SalSendClassMessage( UM_Insert, 0, 0 )
.head 4 -  Set FL_PF = 1
.head 1 +  Table Window: ZAYA
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: АРХИВ  БИРЖЕВЫХ ЗАЯВОК 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  19.65"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.063"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Архив биржевых операций
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 28552
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.967"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REF)
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотр документа'
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 28553
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.4"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  3.4"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.467"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 28554
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.317"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  5.317"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbPrintZay
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.27"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Печать заявки"
.head 6 +  On SAM_Click
.head 7 -  Set nKODZ=IifN( ZAYA.DK=1, nKODZ_B, IifN(ZAYA.OBZ=1, nKODZ_OBZ, nKODZ_S))
.head 7 -  !
.head 7 +  If nKODZ=NUMBER_Null
.head 8 -  Call SalMessageBox( 'Не указан код запроса для формирования заявки', 'Ошибка', MB_IconStop )
.head 7 +  Else
.head 8 -  Set sFileName = GetPrnDir() || '\\' || 'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYA.ID)),6)|| '.DOC'
.head 8 -  Call ExportCatQuery( nKODZ, sFileName, 6, ":ZAY_ID='"||SalStrTrimX(Str(ZAYA.ID))||"'", FALSE )
.head 8 +  If sFileName!=STRING_Null
.head 9 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                          'Печать сформированной заявки', 
                          MB_IconQuestion|MB_YesNo )
.head 9 -  ! Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                          'Печать сформированной заявки', 
                          MB_IconQuestion|MB_YesNoCancel )
.head 9 +  If nPrint=IDYES
.head 10 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 10 -  ! Call DirectView( sFileName )
.head 9 +  ! If nPrint=IDNO
.head 10 -  Call DosDirectPrint( sFileName )
.head 4 +  Pushbutton: pbPrintZayCorp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.707"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Просмотр и печать заявки CORP2"
.head 6 +  On SAM_Click
.head 7 -  Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAYA.ID)),6)||'.DOC'
.head 7 +  If NOT PutBlobToFile(
          hSql(),          sFileName,          'zay_corpdocs',          'id',          'doc_desc',          ZAYA.ID,          '',          '')
.head 8 -  Call SalFileOpen(hFile, sFileName, OF_Delete)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 7 +  If sFileName != STRING_Null
.head 8 -  ! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                           'Печать сформированной заявки', 
                           MB_IconQuestion|MB_YesNoCancel )
.head 8 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
                          'Просмотр и печать заявки CORP2', 
                          MB_IconQuestion|MB_YesNo )
.head 8 +  If nPrint = IDYES
.head 9 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 9 -  ! Call DirectView(sFileName)
.head 4 +  Pushbutton: pbVIZA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.767"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOGFILE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр СТАТУСОВ заявки'
.head 6 +  On SAM_Click
.head 7 -  Call ZayavkaEx(hWndForm, 77, ZAYA.ID, '', '')
.head 4 +  Pushbutton: pbDetailsPF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.267"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REF_PF)
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотр документа ПФ'
.head 4 +  Pushbutton: pbDetailsSPS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.833"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_OUT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI,REF_SPS)
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотр документа списания'
.head 2 +  Contents
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пок - 1
Прод - 2
Конв - 3
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
операции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV_CONV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЗА
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.
номер
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
клиента
(симв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CUST_BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отделение
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
заявл. ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
заявл. ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_Z
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
кл
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.386"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
дил
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.329"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: GRN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Эквивалент
по курсу дилера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.786"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PRIOR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Приоритет
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.071"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
ком
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.686"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S_KOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: или
сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.686"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валютир.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пок
Прод
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пок
Прод
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OBZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОБЗ

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.643"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AIM_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель операции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № контракта / 
кред.договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT2_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата контракта / 
кред.договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NUM_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № посл.ВМД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата посл.ВМД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT5_VMD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Даты ост.ВМД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код страны
перечисления
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BASIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код основания
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BENEFCOUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код страны
бенефициара
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BANK_CODE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код банка
перечисления
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PRODUCT_GROUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код товарной
группы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
 в 
ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF_PF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
списания в 
ПФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF_SPS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
списания
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cbCLOSE_TYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
закрытия
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 +  If cbCLOSE_TYPE.Init(hWndItem)
.head 7 -  Call cbCLOSE_TYPE.Populate(hSql(), "id", "name", " zay_close_types "," ")
.head 5 +  ! On SAM_AnyEdit
.head 6 -  Set CLOSE_TYPE = cbCLOSE_TYPE.GetKey(SalListQuerySelection(cbCLOSE_TYPE))
.head 3 +  Column: KB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nKODZ
.head 3 -  Number: nKODZ_B
.head 3 -  Number: nKODZ_S
.head 3 -  Number: nKODZ_OBZ
.head 3 -  Number: nEIK_ND
.head 3 -  String: sFileName
.head 3 -  Number: nPrint
.head 3 -  Number: nRet
.head 3 -  File Handle: hFile
.head 3 -  Number: nPR_CORP2
.head 3 -  Number: nKV_BASE
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set ZAYA.nTabInstance = 1
.head 4 -  Set ZAYA.fFilterAtStart = TRUE
.head 4 -  Set ZAYA.strPrintFileName = 'ZAYA'
.head 4 -  Set ZAYA.strFilterTblName = 'V_ZAY'
.head 4 -  !
.head 4 -  Call BIRZA('PRNT_BUY', nKODZ_B)
.head 4 -  Call BIRZA('PRNT_SAL', nKODZ_S)
.head 4 -  Call BIRZA('PRNT_OBZ', nKODZ_OBZ)
.head 4 -  Call BIRZA('PR_CORP2', nPR_CORP2)
.head 4 -  Call BIRZA('EIK_ND', nEIK_ND)
.head 4 +  If nEIK_ND = 1 
.head 5 -  Call SalShowWindow(ZAYA.ND)
.head 4 +  Else
.head 5 -  Call SalHideWindow(ZAYA.ND)
.head 4 -  ! Открываем/прячем кнопку отдельного списания для Сбера/неСбера
.head 4 +  If GetGlobalOptionEx('MFOP')=300465 
.head 5 -  Call SalShowWindow(REF_SPS)
.head 5 -  Call SalShowWindow(pbDetailsSPS)
.head 4 +  Else
.head 5 -  Call SalHideWindow(REF_SPS)
.head 5 -  Call SalHideWindow(pbDetailsSPS)
.head 4 -  !
.head 4 +  If nPR_CORP2 = 1 
.head 5 -  Call SalShowWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbPrintZayCorp)
.head 4 -  !
.head 4 +  If gZAYMODE != 1
.head 5 -  Call SalHideWindow(MFO)
.head 4 -  !
.head 4 -  Set ZAYA.strSqlPopulate =
"SELECT v_zay.mfo, v_zay.dk, v_zay.id, v_zay.ref, v_zay.kv2, v_zay.s2, 
        v_zay.rnk, v_zay.nd_rnk, v_zay.cust_branch, v_zay.nmk, 
        v_zay.fdat, v_zay.kurs_z, v_zay.kurs_f, v_zay.priorname, v_zay.kom, v_zay.skom, v_zay.vdate, 
        v_zay.sos, v_zay.dig, nvl(v_zay.obz,0), identkb, kv_conv,
        v_zay.aim_name, v_zay.contract, v_zay.dat2_vmd, v_zay.num_vmd, v_zay.dat_vmd, v_zay.dat5_vmd,
        v_zay.country, v_zay.basis,  v_zay.benefcountry, v_zay.bank_code, v_zay.product_group,
        v_zay.s_pf, v_zay.ref_pf, v_zay.ref_sps, close_type_name
   INTO :ZAYA.MFO, :ZAYA.DK, :ZAYA.ID, :ZAYA.REF, :ZAYA.KV2, :ZAYA.S2,
        :ZAYA.RNK, :ZAYA.ND, :ZAYA.CUST_BRANCH, :ZAYA.NMK,
        :ZAYA.FDAT, :ZAYA.KURS_Z, :ZAYA.KURS_F, :ZAYA.PRIOR, :ZAYA.KOM, :ZAYA.S_KOM :ZAYA.VDATE,
        :ZAYA.SOS, :ZAYA.DIG, :ZAYA.OBZ, :ZAYA.KB, :ZAYA.KV_CONV,
        :ZAYA.AIM_NAME, :ZAYA.CONTRACT, :ZAYA.DAT2_VMD, :ZAYA.NUM_VMD, :ZAYA.DAT_VMD, :ZAYA.DAT5_VMD,
        :ZAYA.COUNTRY, :ZAYA.BASIS, :ZAYA.BENEFCOUNTRY, :ZAYA.BANK_CODE, :ZAYA.PRODUCT_GROUP,
        :ZAYA.S_PF, :ZAYA.REF_PF, :ZAYA.REF_SPS, :ZAYA.cbCLOSE_TYPE
   FROM v_zay_arc v_zay
  ORDER BY v_zay.ref desc"       
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalFmtSetPicture(ZAYA.KURS_Z, '#0.00000000')
.head 4 -  Call SalFmtSetPicture(ZAYA.KURS_F, '#0.00000000')
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set S2s = Dig4(S2/100,DIG,2)
.head 4 +  If DK = 3 or DK = 4
.head 5 +  If SqlPrepareAndExecute(hSql(), "select kv_base into :nKV_BASE from zay_conv_kv where (kv1 = :KV2 and kv2 = :KV_CONV) or (kv2 = :KV2 and kv1 = :KV_CONV)")
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If Str(nKV_BASE) = KV_CONV
.head 7 -  Set GRN_SUM = Dig4(S2/KURS_F/100,DIG,2)
.head 6 +  Else
.head 7 -  Set GRN_SUM = Dig4(S2*KURS_F/100,DIG,2)
.head 4 +  Else
.head 5 -  Set GRN_SUM = Dig4(S2*KURS_F/100,DIG,2)
.head 4 -  If SOS = NUMBER_Null
.head 4 +  Else If SOS = 1
.head 5 -  Call SetTblRowColor( ZAYA, COLOR_DarkGreen )
.head 4 +  Else If SOS = 3
.head 5 -  Call SetTblRowColor( ZAYA, COLOR_Blue )
.head 4 +  Else If SOS < 0
.head 5 -  Call SetTblRowColor( ZAYA, COLOR_Red )
.head 4 -  ! Признак заявки, полученной по Клиент-банку
.head 4 +  If ZAYA.KB != STRING_Null
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightPeriwinkle)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 3 +  On SAM_RowSetContext
.head 4 +  If nKODZ_B=-1 AND DK=1
.head 5 -  Call SalDisableWindow( pbPrintZay )
.head 4 +  If nKODZ_S=-1 AND DK=2
.head 5 -  Call SalDisableWindow( pbPrintZay )
.head 4 +  If ZAYA.KB != STRING_Null
.head 5 -  Call SalEnableWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbPrintZayCorp)
.head 1 +  Table Window: ZAY_VIZA
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ПРОСМОТР СТАТУСОВ ПО ЗАЯВКЕ 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.1"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.063"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Просмотр СТАТУСОВ по заявке
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62854
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.967"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62855
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.4"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  3.4"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.167"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62856
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.017"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  4.017"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: TRACK_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
п/п
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид.
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CHANGE_TIME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
изменения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исполнитель
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VIZA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
п/п
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: STATUS_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Статус
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 150
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nID
.head 2 +  Window Variables
.head 3 -  String: sFilter
.head 3 -  String: sSql
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call SalCenterWindow( hWndForm )
.head 4 -  Set ZAY_VIZA.strPrintFileName='ZAY_VIZA'
.head 4 -  Set ZAY_VIZA.fFilterAtStart=FALSE
.head 4 -  ! Set ZAY_VIZA.strFilterTblName='v_zay_track_full'
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Set ZAY_VIZA.strSqlPopulate =
"select   id, track_id, change_time, fio, viza, status_name  
INTO :ZAY_VIZA.ID, :ZAY_VIZA.TRACK_ID, :ZAY_VIZA.CHANGE_TIME, :ZAY_VIZA.FIO, :ZAY_VIZA.VIZA, :ZAY_VIZA.STATUS_NAME
from v_zay_track_full where id = :nID
union all
select  id, track_id, change_time, fio, viza, status_name   
from v_zay_track_full  where id in (select unique id_prev from (select * from v_zay_track_full where id = :nID) where id_prev is not null)
order by track_id
"       
.head 4 -  ! Call SalTblPopulate(hWndForm, hSql(), strSqlPopulate, TBL_FillAll)
.head 4 -  ! Call SalTblSetContext(hWndForm, 0)
.head 4 -  ! Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  ! Call SalWaitCursor(FALSE)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set sSql = strSqlPopulate
.head 4 -  ! Set sFilter = cF.GetFilterWhereClause(FALSE)
.head 4 +  ! If not sFilter
.head 5 +  If nID
.head 6 -  Set sSql = sSql || " where id = :nID" 
.head 4 +  ! Else
.head 5 -  Set sSql = sSql || " where " || sFilter
.head 4 -  ! Set sSql = sSql || " order by track_id "
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(), sSql, nTabPopulateMethod)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: ZAYC
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Подтверждения НБУ импортных контрактов клиентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  16.85"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.286"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Подтверждения НБУ импортных контрактов клиентов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.405"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.49"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.92"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 39149
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.083"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  3.083"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.52"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 39150
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.283"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  4.283"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать'
.head 6 +  On SAM_Click
.head 7 +  If nTIP = 1
.head 8 -  Set nTmp= SalTblQueryContext( ZAY1 )
.head 8 +  If not SalTblQueryRowFlags( ZAY1, nTmp, ROW_New )
.head 9 -  Call SalTblSetRowFlags( ZAY1, nTmp, ROW_Edited, TRUE )
.head 8 -  Set ZAY1.PID          = ZAYC.PID
.head 8 -  Set ZAY1.CONTRACT     = ZAYC.NAME
.head 8 -  Set ZAY1.DATC         = ZAYC.DATEOPEN
.head 8 -  Set ZAY1.META         = ZAYC.META
.head 8 -  Set ZAY1.BANK_CODE    = ZAYC.BANK_CODE
.head 8 -  Set ZAY1.BANK_NAME    = ZAYC.BANK_NAME
.head 8 -  Set ZAY1.BENEFCOUNTRY = ZAYC.COUNTRY
.head 8 -  Set ZAY1.COUNTRY      = ZAYC.BANKCOUNTRY
.head 8 -  Call ZAY1.cbBENEFCOUNTRY.SetSelectById( ZAY1.BENEFCOUNTRY )
.head 8 -  Call ZAY1.cbMETA.SetSelectById        ( ZAY1.META )
.head 8 -  Call ZAY1.cbCOUNTRY.SetSelectById     ( ZAY1.COUNTRY )
.head 8 -  Call ZAY1.cbBASIS.SetSelectById     ( ZAY1.BASIS )
.head 7 +  Else If nTIP = 2
.head 8 -  Set nTmp= SalTblQueryContext( ZAYNAL )
.head 8 +  If not SalTblQueryRowFlags( ZAYNAL, nTmp, ROW_New )
.head 9 -  Call SalTblSetRowFlags( ZAYNAL, nTmp, ROW_Edited, TRUE )
.head 8 -  Set ZAYNAL.nCONTRACT=ZAYC.PID
.head 8 -  Set ZAYNAL.sCONTRACT=ZAYC.NAME
.head 8 -  Set ZAYNAL.dCONTRACT=ZAYC.DATEOPEN
.head 7 +  Else If nTIP = -1
.head 8 -  Set nTmp = SalTblQueryContext(ZAY2)
.head 8 +  If not SalTblQueryRowFlags(ZAY2, nTmp, ROW_New)
.head 9 -  Call SalTblSetRowFlags(ZAY2, nTmp, ROW_Edited, TRUE)
.head 8 -  Set ZAY2.PID          = ZAYC.PID
.head 8 -  Set ZAY2.CONTRACT     = ZAYC.NAME
.head 8 -  Set ZAY2.DATC         = ZAYC.DATEOPEN
.head 7 +  Else
.head 8 -  !
.head 7 -  Call SalDestroyWindow(ZAYC)
.head 4 +  Pushbutton: pbArhiv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.69"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Архив подтверждений'
.head 6 +  On SAM_Click
.head 7 -  Set bAll= not bAll
.head 7 +  If bAll=TRUE
.head 8 -  Call SalDisableWindow( cbBlank )
.head 8 -  Call SalDisableWindow( cbOver  )
.head 8 -  Call SalDisableWindow( cbAct   )
.head 8 +  If nRNK = 0
.head 9 -  Call SalSetWindowText( hWndForm, 'Подтверждения НБУ импортных контрактов клиентов (архив)' )
.head 8 +  Else
.head 9 -  Call SalSetWindowText( hWndForm, 'Контракты клиента:  ' || sNMK||' (архив)'  )
.head 7 +  Else
.head 8 -  Call SalEnableWindow( cbBlank )
.head 8 -  Call SalEnableWindow( cbOver  )
.head 8 -  Call SalEnableWindow( cbAct   )
.head 8 +  If nRNK = 0
.head 9 -  Call SalSetWindowText( hWndForm, 'Подтверждения НБУ импортных контрактов клиентов' )
.head 8 +  Else
.head 9 -  Call SalSetWindowText( hWndForm, 'Контракты клиента:  ' || sNMK  )
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу'
.head 6 +  On SAM_Click
.head 7 +  If nTIP = 1
.head 8 -  Set nTmp= SalTblQueryContext( ZAY1 )
.head 8 +  If not SalTblQueryRowFlags( ZAY1, nTmp, ROW_New )
.head 9 -  Call SalTblSetRowFlags( ZAY1, nTmp, ROW_Edited, TRUE )
.head 8 -  Set ZAY1.PID=NUMBER_Null
.head 8 -  Set ZAY1.CONTRACT=STRING_Null
.head 8 -  Set ZAY1.DATC=DATETIME_Null
.head 8 -  Set ZAY1.COUNTRY=NUMBER_Null
.head 8 -  Set ZAY1.BENEFCOUNTRY=NUMBER_Null
.head 8 -  Set ZAY1.META=NUMBER_Null
.head 8 -  Set ZAY1.BANK_CODE=STRING_Null
.head 8 -  Set ZAY1.BANK_NAME=STRING_Null
.head 7 +  Else If nTIP = 2 
.head 8 -  Set nTmp= SalTblQueryContext( ZAYNAL )
.head 8 +  If not SalTblQueryRowFlags( ZAYNAL, nTmp, ROW_New )
.head 9 -  Call SalTblSetRowFlags( ZAYNAL, nTmp, ROW_Edited, TRUE )
.head 8 -  Set ZAYNAL.nCONTRACT=NUMBER_Null
.head 8 -  Set ZAYNAL.sCONTRACT=STRING_Null
.head 8 -  Set ZAYNAL.dCONTRACT=DATETIME_Null
.head 7 +  Else If nTIP = -1
.head 8 -  Set nTmp = SalTblQueryContext(ZAY2)
.head 8 +  If not SalTblQueryRowFlags(ZAY2, nTmp, ROW_New)
.head 9 -  Call SalTblSetRowFlags(ZAY2, nTmp, ROW_Edited, TRUE)
.head 8 -  Set ZAY2.PID      = NUMBER_Null
.head 8 -  Set ZAY2.CONTRACT = STRING_Null
.head 8 -  Set ZAY2.DATC     = DATETIME_Null
.head 7 +  Else
.head 8 -  !
.head 7 -  Call SalDestroyWindow(ZAYC)
.head 4 -  Line
.head 5 -  Resource Id: 39151
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.517"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  1.517"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Check Box: cbBlank
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: "пустые"
.head 5 -  Window Location and Size
.head 6 -  Left:   5.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Teal
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Check Box: cbOver
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: просроченные
.head 5 -  Window Location and Size
.head 6 -  Left:   7.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Check Box: cbAct
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: актуальные
.head 5 -  Window Location and Size
.head 6 -  Left:   9.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 2 +  Contents
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Клиент
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
контракта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
контракта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATEOPEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
контракта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATECLOSE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
завершен.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CONFIRM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
подтверждения
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATE_C
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
подтвержд.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( DATE_C )
.head 7 -  Set DATE_C90 = DATE_C + 90
.head 3 +  Column: DATE_C90
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действит.
    до
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кодстраны
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COUNTRYNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Страна
контрагента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BENEFNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
контрагента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: META
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BANK_CODE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BANK_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BANKCOUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BANKCOUNTRYNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Страна
иностр.банка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nTIP
.head 3 -  ! 0 - просмотр контрактов и подтверждений
.head 3 -  ! 1 - контракт выбирается в заявку на покупку валюты
.head 3 -  ! 2 - контракт выбирается в справки из НИ в ZAY_NAL
.head 3 -  ! 22 - контракт выбирается в справки из НИ в ZAY_EC
.head 3 -  ! -1 - контракт выбирается в заявку на продажу валюты
.head 3 -  Number: nRNK
.head 2 +  Window Variables
.head 3 -  String: sNMK
.head 3 -  Number: nTmp
.head 3 -  Number: nRow
.head 3 -  Number: nContractType
.head 3 -  String: sPopulate
.head 3 -  String: sWhere_Rnk
.head 3 -  String: sWhere_Dat
.head 3 -  String: sOrder
.head 3 -  String: sBlank
.head 3 -  String: sOver
.head 3 -  String: sAct
.head 3 -  Boolean: bAll
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set ZAYC.strFilterTblName="TOP_CONTRACTS"
.head 4 -  Set ZAYC.strPrintFileName='CONTR_NBU'
.head 4 -  Set ZAYC.nTabInstance = 1
.head 4 -  Set bAll = FALSE
.head 4 -  Set nContractType = IifN(nTIP >= 0, 1, 0)
.head 4 -  ! экспорт
.head 4 +  If nContractType = 0
.head 5 -  Set cbBlank = TRUE
.head 5 -  Set cbOver  = FALSE
.head 5 -  Set cbAct   = FALSE
.head 5 -  Call SalDisableWindow(cbBlank)
.head 5 -  Call SalDisableWindow(cbOver)
.head 5 -  Call SalDisableWindow(cbAct)
.head 5 -  Call SalDisableWindow(pbIns)
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  Call SalDisableWindow(pbUpdate)
.head 5 -  Call SalDisableWindow(pbArhiv)
.head 5 -  Call SalHideWindow(CONFIRM)
.head 5 -  Call SalHideWindow(DATE_C)
.head 5 -  Call SalHideWindow(DATE_C90)
.head 4 -  !
.head 4 +  If nRNK = 0
.head 5 -  Call SalSetWindowText( hWndForm, 'Подтверждения НБУ импортных контрактов клиентов' )
.head 5 -  Call SalShowWindow( RNK )
.head 5 -  Call SalShowWindow( NMK )
.head 5 -  Call SalDisableWindow( pbOK )
.head 5 -  Set ZAYC.cbBlank = TRUE
.head 5 -  Set ZAYC.fFilterAtStart = TRUE
.head 4 +  Else
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT nmk INTO :sNMK FROM customer WHERE rnk=:nRNK "  )
.head 6 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Call SalSetWindowText( hWndForm, 'Контракты клиента:  ' || sNMK  )
.head 5 -  Call SalHideWindow( RNK )
.head 5 -  Call SalHideWindow( NMK )
.head 4 -  !
.head 4 -  Set ZAYC.strSqlDelete = 
   "DELETE FROM nbu_contr 
     WHERE pid = :ZAYC.PID AND rnk = :ZAYC.RNK AND date_c = :ZAYC.DATE_C"       
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Populate
.head 4 -  Set ZAYC.sPopulate =
   "SELECT top_contracts.rnk, k.nmk, top_contracts.pid, top_contracts.name, 
           top_contracts.dateopen, top_contracts.dateclose, 
           nbu_contr.confirm, nbu_contr.date_c, top_contracts.id_oper,
           top_contracts.benefcountry, c.name, top_contracts.benefname,
           top_contracts.bank_code, top_contracts.benefbank,
           top_contracts.bankcountry, bc.name    
    INTO   :ZAYC.RNK,:ZAYC.NMK,:ZAYC.PID,:ZAYC.NAME,
           :ZAYC.DATEOPEN,:ZAYC.DATECLOSE,
           :ZAYC.CONFIRM,:ZAYC.DATE_C,:ZAYC.META,
           :ZAYC.COUNTRY,:ZAYC.COUNTRYNAME,:ZAYC.BENEFNAME,
           :ZAYC.BANK_CODE,:ZAYC.BANK_NAME,
           :ZAYC.BANKCOUNTRY,:ZAYC.BANKCOUNTRYNAME       
    FROM   top_contracts, nbu_contr, customer k, country c, country bc       
    WHERE  top_contracts.pid          = nbu_contr.pid(+) AND  
           top_contracts.rnk          = k.rnk            AND       
           top_contracts.benefcountry = c.country(+)     AND
           top_contracts.bankcountry  = bc.country(+)    AND
           top_contracts.closed      <> 1                AND 
           top_contracts.impexp       = "||Str(nContractType)
.head 4 -  !
.head 4 +  If ZAYC.nRNK != 0
.head 5 -  Set ZAYC.sWhere_Rnk = " AND top_contracts.rnk=:ZAYC.nRNK "
.head 4 +  Else
.head 5 -  Set ZAYC.sWhere_Rnk = " "
.head 4 -  !
.head 4 +  If NOT bAll
.head 5 -  Set ZAYC.sBlank = IifS(ZAYC.cbBlank, " nbu_contr.date_c IS NULL ", " 1=0 ")
.head 5 -  Set ZAYC.sOver  = IifS(ZAYC.cbOver,  " nbu_contr.date_c = 
                                      (SELECT max(n.date_c) FROM nbu_contr n 
                                       WHERE n.pid=nbu_contr.pid AND 
                                             n.rnk=top_contracts.rnk) 
                                         AND nbu_contr.date_c + 90 <= bankdate ", " 1=0 ")
.head 5 -  Set ZAYC.sAct   = IifS(ZAYC.cbAct,   " nbu_contr.date_c = 
                                      (SELECT max(n.date_c) FROM nbu_contr n 
                                       WHERE n.pid=nbu_contr.pid AND 
                                             n.rnk=top_contracts.rnk) 
                                         AND nbu_contr.date_c + 90 > bankdate", " 1=0 ")
.head 5 -  Set ZAYC.sWhere_Dat = 
 IifS(ZAYC.sBlank != " 1=0 " OR 
      ZAYC.sOver  != " 1=0 " OR 
      ZAYC.sAct   != " 1=0 ",
      " AND ( "||ZAYC.sBlank||" OR "||ZAYC.sOver||" OR "||ZAYC.sAct||" ) ",
      " AND nvl(nbu_contr.date_c,bankdate) = 
           (SELECT nvl(max(n.date_c),bankdate) FROM nbu_contr n 
            WHERE n.pid=nbu_contr.pid AND n.rnk=top_contracts.rnk) ")
.head 4 +  Else
.head 5 -  Set ZAYC.sWhere_Dat = " AND nbu_contr.date_c IS NOT NULL "
.head 4 -  !
.head 4 -  Set ZAYC.sOrder = 
   " ORDER BY top_contracts.rnk, 
              top_contracts.name, 
              top_contracts.dateopen, 
              nbu_contr.date_c "
.head 4 -  Set ZAYC.strSqlPopulate = 
    ZAYC.sPopulate     ||
    sWhere_Rnk         ||
    ZAYC.sWhere_Dat    ||
    ZAYC.sOrder
.head 4 -  Call cQ.Init(strSqlPopulate)
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbOK, SAM_Click, 0, 0 )
.head 3 +  On SAM_FetchRowDone
.head 4 +  If NOT SalIsNull( DATE_C )
.head 5 -  Set DATE_C90 = DATE_C + 90
.head 5 +  If DATE_C90 <= GetBankDate(  )
.head 6 -  Call SetTblRowColor( ZAYC, COLOR_Marigold )
.head 4 +  If NOT SalIsNull( DATECLOSE )
.head 5 +  If DATECLOSE < GetBankDate(  )
.head 6 -  Call XSalTblSetRowBackColor( ZAYC, lParam, COLOR_LightGray )
.head 3 +  On UM_Update
.head 4 -  Set nRow=TBL_MinRow
.head 4 +  While SalTblFindNextRow( ZAYC, nRow, ROW_Edited, 0 )
.head 5 -  Call SalTblSetContext( ZAYC, nRow )
.head 5 +  If ZAYC.CONFIRM != STRING_Null AND ZAYC.DATE_C != DATETIME_Null
.head 6 -  If SqlPrepareAndExecute( hSql(), 
   "SELECT pid INTO :nTmp  
    FROM nbu_contr
    WHERE pid=:ZAYC.PID AND date_c=:ZAYC.DATE_C" )
.head 6 +  If SqlFetchNext( hSql(), nFetchRes )
.head 7 +  If SqlPrepareAndExecute( hSql(), 
   "UPDATE nbu_contr SET confirm = :ZAYC.CONFIRM 
    WHERE pid=:ZAYC.PID AND rnk=:ZAYC.RNK AND date_c=:ZAYC.DATE_C" )
.head 8 -  Call SqlCommit( hSql() )
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSql(), 
   "INSERT INTO nbu_contr (pid, rnk, confirm, date_c) 
    VALUES (:ZAYC.PID, :ZAYC.RNK, :ZAYC.CONFIRM, :ZAYC.DATE_C )" )
.head 8 -  Call SqlCommit( hSql() )
.head 4 -  Call SalSendClassMessage( UM_Update, 0, 0 )
.head 1 +  Dialog Box: dlgPerekr !! На какую сумму перекрывать-то будем???
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выбор суммы и назначения платежа для перекрытия
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.452"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Сумма перекрытия
.head 4 -  Resource Id: 25982
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    0.333"
.head 5 -  Width:  2.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.26"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.333"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfS > S
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Frame
.head 4 -  Resource Id: 25983
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.167"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.571"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Group Box: Назначение платежа
.head 4 -  Resource Id: 25984
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.833"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    1.179"
.head 6 -  Width:  4.717"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.762"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Утвердить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    2.286"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If mlNAZN = STRING_Null
.head 7 -  Call SalMessageBox("Введите назначение платежа!",
                   "Внимание!", 
                    MB_IconExclamation)
.head 6 +  Else
.head 7 -  Set SP = dfS
.head 7 -  Set NAZN = mlNAZN
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.767"
.head 5 -  Top:    2.286"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set SP = S
.head 6 -  Set NAZN = sDefaultNazn
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: S
.head 3 -  Receive Number: SP
.head 3 -  Receive String: NAZN
.head 2 +  Window Variables
.head 3 -  String: sDefaultNazn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(dlgPerekr)
.head 4 -  Set dfS = S
.head 4 -  Set sDefaultNazn = 'Повернення коштів, надлишково перерахованих для купівлі іноземної валюти' 
.head 4 -  Set mlNAZN = sDefaultNazn
.head 1 +  Form Window: ZAYD
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Установка курсов валют 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.6"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Установка дилерских курсов 
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! Line
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.05"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  0.05"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.end
.head 3 +  Radio Button: rbKursBS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курсы покупки-продажи
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.15"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SetRb()
.head 3 +  Radio Button: rbKursConv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курсы конверсии
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.05"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SetRb()
.head 3 -  ! Line - нужна здесь, чтоб разделять RadioButton
.head 3 -  Line
.head 4 -  Resource Id: 18073
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.05"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  0.05"
.head 4 -  Visible? No
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 +  Radio Button: rbIndKurs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Индикативные курсы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    0.45"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalShowWindow(dfVIP_B)
.head 6 -  Call SalShowWindow(dfVIP_S)
.head 6 -  Call SalShowWindow(cbBLK)
.head 6 -  Call SalSetWindowLabelText(bgVip, 'VIP')
.head 6 -  Call SalSendMsg(cmb_Kv, SAM_Click, 0, 0)
.head 3 +  Radio Button: rbInfKurs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фактические курсы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    0.75"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalHideWindow(dfVIP_B)
.head 6 -  Call SalHideWindow(dfVIP_S)
.head 6 -  Call SalHideWindow(cbBLK)
.head 6 -  Call SalSetWindowLabelText(bgVip, '')
.head 6 -  Call SalSendMsg(cmb_Kv, SAM_Click, 0, 0)
.head 3 -  ! Line - нужна здесь, чтоб разделять RadioButton
.head 3 -  Line
.head 4 -  Resource Id: 18074
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.05"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  0.05"
.head 4 -  Visible? No
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 +  Radio Button: rbIndKursConv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Индикативные курсы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    1.35"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(pbConvKv, SAM_User, 0, 0)
.head 3 +  Radio Button: rbInfKursConv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фактические курсы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    1.65"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(pbConvKv, SAM_User, 0, 0)
.head 3 -  Line
.head 4 -  Resource Id: 10134
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.1"
.head 5 -  Begin Y:  2.8"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  2.8"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Валюта
.head 4 -  Resource Id: 28021
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.1"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    2.4"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmb_Kv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.1"
.head 5 -  Top:    2.4"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmb_Kv.Init(hWndItem)
.head 6 -  Set sTmp=Str(GetBaseVal())
.head 6 -  Call cmb_Kv.Populate(hSqlAux2(),"T.KV","T.LCV||' '||T.NAME"," TABVAL T, TABVAL_SORT S ",
                            "WHERE T.KV<>"||sTmp||" AND T.KV=S.KV(+) AND S.USER_ID(+)=:ZAYD.nID 
                             ORDER BY S.SORT_ORD, T.KV ")
.head 6 -  Call cmb_Kv.SetSelectById( dfKV )
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, wParam, lParam)
.head 6 -  Set dfKV = cmb_Kv.GetKey(SalListQuerySelection(cmb_Kv))
.head 6 +  If rbIndKurs
.head 7 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT kurs_b, kurs_s, vip_b, vip_s, blk  
    INTO :nKURS_B, :nKURS_S, :dfVIP_B, :dfVIP_S, :nBLK
    FROM diler_kurs
    WHERE kv=:dfKV AND dat = 
              (SELECT max(dat) FROM diler_kurs 
               WHERE kv=:dfKV AND trunc(dat)=trunc(sysdate))" )
.head 8 +  If NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set dfKURS_B=NUMBER_Null
.head 9 -  Set dfKURS_S=NUMBER_Null
.head 9 -  Set dfVIP_B=NUMBER_Null
.head 9 -  Set dfVIP_S=NUMBER_Null
.head 9 -  Set nKURS_B=NUMBER_Null
.head 9 -  Set nKURS_S=NUMBER_Null
.head 9 -  Set cbBLK=0
.head 9 -  Set nBLK=0
.head 9 -  Call SalSetWindowText( cbBLK, IifS( z=35,'Заблокировать','Не блокирована' ))
.head 8 +  Else
.head 9 +  If nBLK=1
.head 10 -  Set cbBLK=1
.head 10 -  Call SalSetWindowText( cbBLK, IifS( z=35,'Разблокировать','Заблокирована' ))
.head 9 +  Else
.head 10 -  Set cbBLK=0
.head 10 -  Call SalSetWindowText( cbBLK, IifS( z=35,'Заблокировать','Не блокирована' ))
.head 9 -  Set dfKURS_B=nKURS_B
.head 9 -  Set dfKURS_S=nKURS_S
.head 6 +  Else
.head 7 -  Set nKURS_B=NUMBER_Null
.head 7 -  Set nKURS_S=NUMBER_Null
.head 7 -  Set dfVIP_B=NUMBER_Null
.head 7 -  Set dfVIP_S=NUMBER_Null
.head 7 -  Set cbBLK=0
.head 7 -  Set nBLK=0
.head 7 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT kurs_b, kurs_s
    INTO :nKURS_B, :nKURS_S
    FROM diler_kurs_fact
    WHERE kv=:dfKV AND dat = 
              (SELECT max(dat) FROM diler_kurs_fact
               WHERE kv=:dfKV AND trunc(dat)=trunc(sysdate))" )
.head 8 +  If NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set nKURS_B=NUMBER_Null
.head 9 -  Set nKURS_S=NUMBER_Null
.head 7 -  Set dfKURS_B=nKURS_B
.head 7 -  Set dfKURS_S=nKURS_S
.head 3 +  Pushbutton: pbConvKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.7"
.head 5 -  Top:    2.35"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выбрать пару валют'
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGetAltPK("ZAY_CONV_KV", "KV1", "KV2", sPk, sSem)
.head 7 -  Set nKv1 = Val(sPk)
.head 7 -  Set nKv2 = Val(sSem)
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select kv_base into :nTmp from zay_conv_kv where kv1 = :nKv1 and kv2 = :nKv2")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set dfConvKv = Str(nKv1) || '/' || Str(nKv2) || ' (базовая валюта ' || Str(nTmp) || ')'
.head 7 -  Call SalSendMsg(pbConvKv, SAM_User, 0, 0)
.head 6 +  Else
.head 7 -  Set nKv1 = NUMBER_Null
.head 7 -  Set nKv2 = NUMBER_Null
.head 7 -  Set dfConvKv = STRING_Null
.head 5 +  On SAM_User
.head 6 +  If nKv1 != NUMBER_Null and nKv2 != NUMBER_Null
.head 7 +  If rbIndKursConv
.head 8 +  If SqlPrepareAndExecute(hSql(), 
"select kurs_i into :nKURS_Conv
   from diler_kurs_conv
  where kv1 = :nKv1 and kv2 = :nKv2 and dat = bankdate")
.head 9 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set dfKURS_Conv = NUMBER_Null
.head 10 -  Set nKURS_Conv  = NUMBER_Null
.head 9 +  Else
.head 10 -  Set dfKURS_Conv = nKURS_Conv
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute(hSql(), 
"select kurs_f into :nKURS_Conv
   from diler_kurs_conv
  where kv1 = :nKv1 and kv2 = :nKv2 and dat = bankdate")
.head 9 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set dfKURS_Conv = NUMBER_Null
.head 10 -  Set nKURS_Conv  = NUMBER_Null
.head 9 +  Else
.head 10 -  Set dfKURS_Conv = nKURS_Conv
.head 3 +  Data Field: dfConvKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    2.4"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 54197
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.1"
.head 5 -  Begin Y:  2.0"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  2.0"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: покупка
.head 4 -  Resource Id: 53448
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.9"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKursB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKURS_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    3.2"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: nKURS_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.567"
.head 6 -  Top:    1.417"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: продажа
.head 4 -  Resource Id: 53449
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.7"
.head 5 -  Top:    2.9"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKursS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKURS_S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    3.2"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: nKURS_S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    1.417"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: курс
.head 4 -  Resource Id: 18075
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.8"
.head 5 -  Top:    2.9"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKursConv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKURS_Conv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    3.2"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 10135
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.1"
.head 5 -  Begin Y:  3.9"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  3.9"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: VIP
.head 4 -  Resource Id: 63841
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.0"
.head 5 -  Top:    3.6"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIP_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    3.5"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Sky
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIP_S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    3.5"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Sky
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbBLK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    4.0"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Data Field: nBLK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 10136
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.1"
.head 5 -  Begin Y:  4.4"
.head 5 -  End X:  4.4"
.head 5 -  End Y:  4.4"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    4.5"
.head 5 -  Width:  1.217"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If rbKursBS
.head 7 +  If rbIndKurs
.head 8 +  If dfKV != NUMBER_Null AND 
    ((dfKURS_B!=NUMBER_Null AND nKURS_B!=dfKURS_B) OR
     (dfKURS_S!=NUMBER_Null AND nKURS_S!=dfKURS_S))
.head 9 +  If SalMessageBox('Зафиксировать изменение курса ?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
.head 10 +  If (cbBLK!=nBLK AND SalMessageBox('Вы действительно хотите изменить блокировку данной валюты?','Внимание',MB_YesNo | MB_IconHand)=IDYES) OR cbBLK=nBLK
.head 11 +  If SqlPrepareAndExecute( hSql(),
"INSERT INTO diler_kurs (dat,kv,id,kurs_b,kurs_s,vip_b,vip_s,blk) VALUES
                        (sysdate,:dfKV,:nID,:dfKURS_B,:dfKURS_S,:dfVIP_B,:dfVIP_S,:cbBLK ) " )
.head 12 -  Call SqlCommit( hSql() )
.head 12 -  Call SalSendMsg( cmb_Kv, SAM_Click, 0, 0 )
.head 8 +  Else If cbBLK!=nBLK
.head 9 +  If SalMessageBox('Вы действительно хотите изменить блокировку данной валюты?','Внимание',MB_YesNo | MB_IconHand)=IDYES
.head 10 +  If SqlPrepareAndExecute( hSql(),
"INSERT INTO diler_kurs (dat,kv,id,kurs_b,kurs_s,vip_b,vip_s,blk) VALUES
                        (sysdate,:dfKV,:nID,:dfKURS_B,:dfKURS_S,:dfVIP_B,:dfVIP_S,:cbBLK) " )
.head 11 -  Call SqlCommit( hSql() )
.head 11 -  Call SalSendMsg( cmb_Kv, SAM_Click, 0, 0 )
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Введите данные!', 'Внимание', MB_IconInformation )
.head 7 +  Else
.head 8 +  If dfKV != NUMBER_Null AND 
    ((dfKURS_B != NUMBER_Null AND nKURS_B != dfKURS_B) OR
     (dfKURS_S != NUMBER_Null AND nKURS_S != dfKURS_S))
.head 9 +  If SalMessageBox('Зафиксировать изменение курса ?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
.head 10 +  If not SqlPrepareAndExecute(hSql(),
"insert into diler_kurs_fact (dat, kv, id, kurs_b, kurs_s) 
 values (sysdate, :dfKV, :nID, :dfKURS_B, :dfKURS_S)")
.head 11 -  Call SqlRollback(hSql())
.head 10 +  Else
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SalSendMsg(cmb_Kv, SAM_Click, 0, 0)
.head 8 +  Else
.head 9 -  Call SalMessageBox('Введите данные!', 'Внимание', MB_IconInformation)
.head 6 +  Else
.head 7 -  Set dDat = SalFmtFormatStrDateTime(SalFmtFormatDateTime(SalDateCurrent(), 'dd.MM.yyyy'), 'dd.MM.yyyy')
.head 7 +  If rbIndKursConv
.head 8 +  If dfKURS_Conv != NUMBER_Null AND 
   dfKURS_Conv != nKURS_Conv
.head 9 +  If SalMessageBox('Зафиксировать изменение курса ?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_zay.set_conv_kurs(nKv1, nKv2, dDat, dfKURS_Conv, 1)")
.head 11 -  Call SqlRollback(hSql())
.head 10 +  Else
.head 11 -  Call SqlCommit(hSql())
.head 8 +  Else
.head 9 -  Call SalMessageBox('Введите данные!', 'Внимание', MB_IconInformation)
.head 7 +  Else
.head 8 +  If dfKURS_Conv != NUMBER_Null AND 
   dfKURS_Conv != nKURS_Conv
.head 9 +  If SalMessageBox('Зафиксировать изменение курса ?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_zay.set_conv_kurs(nKv1, nKv2, dDat, dfKURS_Conv, 2)")
.head 11 -  Call SqlRollback(hSql())
.head 10 +  Else
.head 11 -  Call SqlCommit(hSql())
.head 8 +  Else
.head 9 -  Call SalMessageBox('Введите данные!', 'Внимание', MB_IconInformation)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalSetFocus(pbExit)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    4.5"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 2 +  Functions
.head 3 +  Function: SetRb
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If rbKursBS
.head 6 -  Set rbIndKurs = TRUE
.head 6 -  Call SalEnableWindow(rbIndKurs)
.head 6 -  Call SalEnableWindow(rbInfKurs)
.head 6 -  Call SalDisableWindow(rbIndKursConv)
.head 6 -  Call SalDisableWindow(rbInfKursConv)
.head 6 -  Call SalSetWindowLabelText(bgVal, 'Валюта')
.head 6 -  Call SalShowWindow(dfKV)
.head 6 -  Call SalShowWindow(cmb_Kv)
.head 6 -  Call SalHideWindow(pbConvKv)
.head 6 -  Call SalHideWindow(dfConvKv)
.head 6 -  Call SalSetWindowLabelText(bgKursB, 'покупка')
.head 6 -  Call SalShowWindow(dfKURS_B)
.head 6 -  Call SalSetWindowLabelText(bgKursS, 'продажа')
.head 6 -  Call SalShowWindow(dfKURS_S)
.head 6 -  Call SalSetWindowLabelText(bgVip, 'VIP')
.head 6 -  Call SalShowWindow(dfVIP_B)
.head 6 -  Call SalShowWindow(dfVIP_S)
.head 6 -  Call SalSetWindowLabelText(bgKursConv, '')
.head 6 -  Call SalHideWindow(dfKURS_Conv)
.head 6 -  Call SalShowWindow(cbBLK)
.head 5 +  Else
.head 6 -  Set rbIndKursConv = TRUE
.head 6 -  Call SalEnableWindow(rbIndKursConv)
.head 6 -  Call SalEnableWindow(rbInfKursConv)
.head 6 -  Call SalDisableWindow(rbIndKurs)
.head 6 -  Call SalDisableWindow(rbInfKurs)
.head 6 -  Call SalSetWindowLabelText(bgVal, 'Пара валют')
.head 6 -  Call SalHideWindow(dfKV)
.head 6 -  Call SalHideWindow(cmb_Kv)
.head 6 -  Call SalShowWindow(pbConvKv)
.head 6 -  Call SalShowWindow(dfConvKv)
.head 6 -  Call SalSetWindowLabelText(bgKursB, '')
.head 6 -  Call SalHideWindow(dfKURS_B)
.head 6 -  Call SalSetWindowLabelText(bgKursS, '')
.head 6 -  Call SalHideWindow(dfKURS_S)
.head 6 -  Call SalSetWindowLabelText(bgVip, '')
.head 6 -  Call SalHideWindow(dfVIP_B)
.head 6 -  Call SalHideWindow(dfVIP_S)
.head 6 -  Call SalSetWindowLabelText(bgKursConv, 'курс')
.head 6 -  Call SalShowWindow(dfKURS_Conv)
.head 6 -  Call SalHideWindow(cbBLK)
.head 6 -  Set dfConvKv = STRING_Null
.head 6 -  Set dfKURS_Conv = NUMBER_Null
.head 6 -  Set nKURS_Conv  = NUMBER_Null
.head 6 -  Set nKv1 = NUMBER_Null
.head 6 -  Set nKv2 = NUMBER_Null
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nID
.head 3 -  Number: z
.head 2 +  Window Variables
.head 3 -  Boolean: bCONVKURS
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 3 -  Number: nKv1
.head 3 -  Number: nKv2
.head 3 -  Number: nKURS_Conv
.head 3 -  String: sPk
.head 3 -  String: sSem
.head 3 -  Date/Time: dDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set bCONVKURS = Val(GetValueStr("select val from birja where par = 'CONVKURS'")) = 1
.head 4 -  Set rbKursBS  = TRUE
.head 4 +  If not bCONVKURS
.head 5 -  Call SalHideWindow(rbKursConv)
.head 5 -  Call SalHideWindow(rbIndKursConv)
.head 5 -  Call SalHideWindow(rbInfKursConv)
.head 4 -  Call SetRb()
.head 4 +  If z != 35
.head 5 -  Call SalDisableWindow(pbOk)
.head 1 +  Table Window: ZAYNAL 
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справки от НИ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.55"
.head 4 -  Top:    0.458"
.head 4 -  Width:  12.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 3.798"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Cправки клиентов от НИ на покупку валюты
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 5565
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.0"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  3.0"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.48"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 5566
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.683"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  3.683"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.117"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 5567
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.917"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.917"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfOST
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Резерв по данной валюте' )
.head 4 +  Data Field: dfS_KV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Резерв (др.валюты)' )
.head 4 +  Data Field: dfSROK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.983"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, '"Срок годности" справки' )
.head 2 +  Contents
.head 3 +  Column: nNOTE_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
справки
из НИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 20
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nCONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
контракта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sCONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № контракта
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If nEIK = 1
.head 7 +  If not IsWindow(hWndC)
.head 8 -  Set hWndC = SalCreateWindow( ZAYC, hWndMDI, 2, hWndForm.ZAYNAL.RNK )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( ZAYC )
.head 3 +  Column: dCONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
контракта
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.08"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sNOTE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № справки
из НИ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 20
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
из НИ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.08"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dDAT90
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата + 90
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.08"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nS100=nS*100
.head 3 +  Column: nS100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSqlAux(), "SELECT name INTO :sNAMV FROM tabval WHERE to_char(kv)="||Str(nKV) ) 
and not SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: sNAMV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
валюты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: RNK
.head 3 -  ! PR=0 - ВСЕ справки данного клиета
.head 3 -  ! PR=1 - справки, относящиеся к заявке
.head 3 -  Number: PR  
.head 3 -  Number: KV
.head 3 -  Number: S2
.head 3 -  Date/Time: DATZ
.head 3 -  Number: PID
.head 3 -  String: CONTRACT
.head 2 +  Window Variables
.head 3 -  String: sNMK
.head 3 -  Number: nFetchRes
.head 3 -  Number: nNAL_SROK
.head 3 -  Date/Time: dEND
.head 3 -  Date/Time: dDATN
.head 3 -  Number: nSUMN
.head 3 -  Number: nOST
.head 3 -  Number: nEIK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set ZAYNAL.nTabInstance = 1
.head 4 -  Set ZAYNAL.strPrintFileName = 'ZAY_NAL'
.head 4 -  Call BIRZA( 'NAL_SROK', nNAL_SROK )
.head 4 -  Call BIRZA( 'ZAY+EIK',  nEIK )
.head 4 -  !
.head 4 +  If ZAYNAL.RNK != NUMBER_Null AND ZAYNAL.RNK != 0 
.head 5 +  If SqlPrepareAndExecute(hSql(),"SELECT nmk INTO :sNMK FROM customer WHERE rnk=:RNK")
and SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Call SalSetWindowText( hWndForm, 'Справка от НИ для клиента:  ' || sNMK  )
.head 4 +  Else
.head 5 -  Call SalSetWindowText( hWndForm, 'Справка от НИ для клиентов' )
.head 4 -  !
.head 4 -  Set ZAYNAL.strSqlPopulate= 
   "SELECT n.nal_id, n.nal_note, n.nal_date, 
           n.pid, n.contract, n.dat_contr, 
           n.nal_date+to_number(b.val)-1,n.s/100, 
           n.s, n.kv, t.name  
     INTO :ZAYNAL.nNOTE_ID,:ZAYNAL.sNOTE,:ZAYNAL.dDAT,
          :ZAYNAL.nCONTRACT,:ZAYNAL.sCONTRACT,:ZAYNAL.dCONTRACT,
          :ZAYNAL.dDAT90,:ZAYNAL.nS,
          :ZAYNAL.nS100,:ZAYNAL.nKV,:ZAYNAL.sNAMV
     FROM cust_zay z, cust_nal n, tabval t, birja b  
     WHERE z.rnk=n.rnk      AND n.kv=t.kv AND 
           b.par='NAL_SROK' AND n.rnk=:ZAYNAL.RNK "||
     IifS(ZAYNAL.PR=0, " ",
                       IifS(nEIK=1," AND n.pid=:ZAYNAL.PID ",
                                   IifS(ZAYNAL.CONTRACT=STRING_Null,
                                  " AND n.contract IS NULL ",
                                  " AND n.contract=:ZAYNAL.CONTRACT " ) ) )||          
     IifS(ZAYNAL.DATZ=DATETIME_Null," "," AND n.nal_date<=:ZAYNAL.DATZ ")||
     " ORDER BY n.pid, n.contract, n.nal_date, n.kv"
.head 4 -  !
.head 4 -  Set ZAYNAL.strSqlInsert =
   "INSERT INTO cust_nal 
     (nal_id, rnk, pid, contract, dat_contr, nal_note, nal_date, s, kv) 
    VALUES 
     (0,:ZAYNAL.RNK,:ZAYNAL.nCONTRACT,:ZAYNAL.sCONTRACT,:ZAYNAL.dCONTRACT,
      :ZAYNAL.sNOTE,:ZAYNAL.dDAT,:ZAYNAL.nS100,:ZAYNAL.nKV)"       
.head 4 -  !
.head 4 -  Set ZAYNAL.strSqlUpdate =
   "UPDATE cust_nal SET 
         nal_note=:ZAYNAL.sNOTE, nal_date=:ZAYNAL.dDAT,      s=:ZAYNAL.nS100,
         pid=:ZAYNAL.nCONTRACT,  contract=:ZAYNAL.sCONTRACT, dat_contr=:ZAYNAL.dCONTRACT
     WHERE nal_id =:ZAYNAL.nNOTE_ID"       
.head 4 -  !
.head 4 -  Set ZAYNAL.strSqlDelete =
    "DELETE FROM cust_nal WHERE nal_id =:ZAYNAL.nNOTE_ID"       
.head 4 -  !
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_TblDoDetails
.head 4 +  If PR != 0 AND KV != NUMBER_Null AND DATZ != DATETIME_Null
.head 5 -  ! Срок действия справки
.head 5 -  If SqlPrepareAndExecute(hSqlAux(), 
  "SELECT max(nal_date) INTO :dDATN  
   FROM cust_nal 
   WHERE rnk=:ZAYNAL.RNK AND kv=:ZAYNAL.KV AND nal_date<=:ZAYNAL.DATZ " || 
   IifS(PID != NUMBER_Null," AND pid=:ZAYNAL.PID", 
        IifS(CONTRACT=STRING_Null,
           " AND contract IS NULL "," AND contract=:ZAYNAL.CONTRACT") ) )
and SqlFetchNext( hSqlAux(), nFetchRes )
.head 5 +  If sNOTE = STRING_Null OR dDATN = DATETIME_Null
.head 6 -  Set dfSROK='Нет справки!'
.head 6 -  Call SalColorSet( dfSROK, COLOR_IndexWindowText, COLOR_Red )
.head 5 +  Else
.head 6 -  Set dEND = dDATN + nNAL_SROK - 1
.head 6 +  If dDATN>DATZ
.head 7 -  Set dfSROK='Рановато!'
.head 7 -  Call SalColorSet( dfSROK, COLOR_IndexWindowText, COLOR_DarkGreen )
.head 6 +  Else
.head 7 +  If dEND-DATZ < 0
.head 8 -  Set dfSROK='Просрочена!'
.head 8 -  Call SalColorSet( dfSROK, COLOR_IndexWindowText, COLOR_Red )
.head 7 +  Else If dEND-DATZ =0
.head 8 -  Set dfSROK='Последний день!'
.head 8 -  Call SalColorSet( dfSROK, COLOR_IndexWindowText, COLOR_Blue )
.head 7 +  Else If dEND-DATZ >0
.head 8 -  Set dfSROK ='Осталось дней: '||NumberToStr(dEND-DATZ+1)
.head 8 -  Call SalColorSet( dfSROK, COLOR_IndexWindowText, COLOR_SysWindowText )
.head 5 -  ! Контроль сумм в данной валюте
.head 5 +  If SqlPrepareAndExecute(hSqlAux(), 
  "SELECT bars.f_zaynal(:RNK,:KV,:DATZ,:PID,:CONTRACT) INTO :nOST FROM dual")
and SqlFetchNext( hSqlAux(), nFetchRes )
.head 6 -  Set dfOST=Dig4((nOST-S2)/100,2,4) 
.head 6 +  If nOST >= S2
.head 7 -  Call SalColorSet( dfOST, COLOR_IndexWindowText, COLOR_DarkBlue )
.head 6 +  Else
.head 7 -  Call SalColorSet( dfOST, COLOR_IndexWindowText, COLOR_Red )
.head 5 -  ! Зазор сумм в других валютах
.head 5 +  If SqlPrepareAndExecute( hSqlAux(),
   "SELECT sum(gl.p_ncurval(:KV,
                           gl.p_icurval(kv,
                               f_zaynal(:RNK,kv,:DATZ,:PID,:CONTRACT),:DATZ),:DATZ))/100  
    INTO :dfS_KV
    FROM cust_nal 
    WHERE rnk=:RNK AND kv<>:KV AND contract=:CONTRACT AND 
          nal_date=(SELECT max(nal_date) FROM cust_nal 
                    WHERE rnk=:RNK AND kv<>:KV AND 
                          nal_date<=:DATZ AND contract=:CONTRACT)")
.head 6 -  Call SqlFetchNext( hSqlAux(), nFetchRes )
.head 6 +  If dfS_KV>=0
.head 7 -  Call SalColorSet( dfS_KV, COLOR_IndexWindowText, COLOR_DarkBlue )
.head 6 +  Else
.head 7 -  Call SalColorSet( dfS_KV, COLOR_IndexWindowText, COLOR_Red )
.head 1 +  Dialog Box: dlgKURS
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр курсов валют, установленных ДИЛЕРОМ
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.702"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Просмотр курсов валют 
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbAll
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Текущие/За все дни'
.head 6 +  On SAM_Click
.head 7 -  Set bAll = not bAll
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.52"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63842
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.39"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.82"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63843
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  2.35"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.35"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63844
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  3.067"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  3.067"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Radio Button: rbDilerKurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Курсы покупки-продажи
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.08"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call ShowKurs(TRUE)
.head 4 +  Radio Button: rbDilerKursConv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Курсы конверсии
.head 5 -  Window Location and Size
.head 6 -  Left:   6.6"
.head 6 -  Top:    0.08"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call ShowKurs(TRUE)
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  12.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.774"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
курса
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код 
вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код 
вал-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
установки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
валюты
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BLK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаг
блок.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_B
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс 
покупки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс 
продажи
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_VB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс 
покупки
( VIP )
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_VS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс 
продажи
( VIP )
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
польз.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.65"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пользователь
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set strDSql = cF.GetFilterWhereClause(FALSE)
.head 6 -  Set dlgKURS.strSqlPopulate = dlgKURS.s1 || IifS(bAll, " ", dlgKURS.s2) || IifS(strDSql='', "", " and " || strDSql) || dlgKURS.s3
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), dlgKURS.strSqlPopulate, TBL_FillAll)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 +  Functions
.head 3 +  Function: ShowKurs
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: bRefresh
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If rbDilerKurs
.head 6 -  Set dlgKURS.strFilterTblName = 'DILER_KURS'
.head 6 -  Set dlgKURS.s1 =
"SELECT diler_kurs.type, diler_kurs.dat, diler_kurs.kv, diler_kurs.id,
        diler_kurs.kurs_b, diler_kurs.kurs_s,
        diler_kurs.vip_b, diler_kurs.vip_s,
        s.fio, t.name, diler_kurs.blk
   INTO :dlgKURS.tbl.TYPE,:dlgKURS.tbl.DAT,:dlgKURS.tbl.KV,:dlgKURS.tbl.ID,
        :dlgKURS.tbl.KURS_B,:dlgKURS.tbl.KURS_S,
        :dlgKURS.tbl.KURS_VB,:dlgKURS.tbl.KURS_VS,
        :dlgKURS.tbl.FIO,:dlgKURS.tbl.NAMV,:dlgKURS.tbl.BLK
   FROM ( select 'Индикативный' type, dat, kv, id, kurs_b, kurs_s, vip_b, vip_s, blk, code from diler_kurs
           union all
          select 'Фактический', dat, kv, id, kurs_b, kurs_s, null, null, null, code from diler_kurs_fact ) diler_kurs, staff$base s, tabval t
  WHERE diler_kurs.kv = t.kv 
    AND diler_kurs.id = s.id"       
.head 6 -  Set dlgKURS.s2 = " AND trunc(diler_kurs.dat) = trunc(sysdate) "
.head 6 -  Set dlgKURS.s3 = " ORDER BY 2 desc, 3 asc"
.head 6 -  Call SalShowWindow(tbl.TYPE)
.head 6 -  Call SalShowWindow(tbl.NAMV)
.head 6 -  Call SalShowWindow(tbl.BLK)
.head 6 -  Call SalShowWindow(tbl.KURS_VB)
.head 6 -  Call SalShowWindow(tbl.KURS_VS)
.head 6 -  Call SalShowWindow(tbl.FIO)
.head 6 -  Call SalHideWindow(tbl.KV2)
.head 6 -  Call SalTblSetColumnTitle(tbl.KURS_B, 'Курс' || PutCrLf() || 'покупки')
.head 6 -  Call SalTblSetColumnTitle(tbl.KURS_S, 'Курс' || PutCrLf() || 'продажи')
.head 5 +  Else
.head 6 -  Set dlgKURS.strFilterTblName = 'DILER_KURS_CONV'
.head 6 -  Set dlgKURS.s1 =
"SELECT diler_kurs_conv.dat, diler_kurs_conv.kv1, diler_kurs_conv.kv2,
        diler_kurs_conv.kurs_i, diler_kurs_conv.kurs_f
   INTO :dlgKURS.tbl.DAT,:dlgKURS.tbl.KV,:dlgKURS.tbl.KV2,
        :dlgKURS.tbl.KURS_B,:dlgKURS.tbl.KURS_S
   FROM diler_kurs_conv 
  WHERE 1=1"
.head 6 -  Set dlgKURS.s2 = " AND trunc(diler_kurs_conv.dat) = trunc(sysdate) "
.head 6 -  Set dlgKURS.s3 = " ORDER BY 1 desc, 2 asc"
.head 6 -  Call SalShowWindow(tbl.KV2)
.head 6 -  Call SalHideWindow(tbl.TYPE)
.head 6 -  Call SalHideWindow(tbl.NAMV)
.head 6 -  Call SalHideWindow(tbl.BLK)
.head 6 -  Call SalHideWindow(tbl.KURS_VB)
.head 6 -  Call SalHideWindow(tbl.KURS_VS)
.head 6 -  Call SalHideWindow(tbl.FIO)
.head 6 -  Call SalTblSetColumnTitle(tbl.KURS_B, 'Индикативный' || PutCrLf() || 'курс')
.head 6 -  Call SalTblSetColumnTitle(tbl.KURS_S, 'Фактический'  || PutCrLf() || 'курс')
.head 5 -  Call tbl.cF.Init(strFilterTblName, strFilterTblName)
.head 5 +  If bRefresh
.head 6 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Date/Time: dDATA
.head 3 -  Boolean: bAll
.head 3 -  Boolean: bCONVKURS
.head 3 -  Number: nI
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set dlgKURS.strPrintFileName = 'KURS'
.head 4 -  Set dlgKURS.strFilterTblName = 'DILER_KURS'
.head 4 -  Set bAll = FALSE
.head 4 -  Set dDATA = GetBankDate()
.head 4 -  Set rbDilerKurs = TRUE
.head 4 -  Set bCONVKURS = Val(GetValueStr("select val from birja where par = 'CONVKURS'")) = 1
.head 4 +  If not bCONVKURS
.head 5 -  Call SalHideWindow(rbDilerKurs)
.head 5 -  Call SalHideWindow(rbDilerKursConv)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call ShowKurs(FALSE)
.head 1 +  Dialog Box: RefPF
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выбор: Районные управления ПФ
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32714
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32715
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32716
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblPF
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colKod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Kod
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOkpo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ReturnValue
.head 4 -  Description: Переопределяем функцию для возврата значений
.head 4 +  Returns
.head 5 -  Number: nRes
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sMfo = tblPF.colMfo
.head 5 -  Set sNls = tblPF.colNls
.head 5 -  Set sNms = tblPF.colNms
.head 5 -  Set sOkpo = tblPF.colOkpo
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Receive String: sMfo
.head 3 -  Receive String: sNls
.head 3 -  Receive String: sNms
.head 3 -  Receive String: sOkpo
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set RefPF.nFlags = GT_ReadOnly
.head 4 -  Set RefPF.strSqlPopulate = 
   "SELECT kod, mfo, nls, nms, okpo 
      INTO :tblPF.colKod,:tblPF.colMfo,:tblPF.colNls, 
           :tblPF.colNms,:tblPF.colOkpo 
      FROM zay_pf 
     ORDER BY mfo"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Form Window: ZAY_DILER
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ДИЛЕР. Удовлетворение заявок клиентов на покупку-продажу валюты
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.844"
.head 4 -  Width:  14.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.595"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Рабочее место Дилера
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbEqv
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.886"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\ACCOUNTS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "(не)Показывать эквиваленты"
.head 6 +  On SAM_Click
.head 7 +  If SalShowWindow(ZAY_DILER.tbl.S980s)
.head 8 -  Call SalHideWindow(ZAY_DILER.tbl.S980s)
.head 7 +  Else
.head 8 -  Call SalShowWindow(ZAY_DILER.tbl.S980s)
.head 7 -  !
.head 7 +  If SalShowWindow(ZAY_DILER.tbl2.S980s)
.head 8 -  Call SalHideWindow(ZAY_DILER.tbl2.S980s)
.head 7 +  Else
.head 8 -  Call SalShowWindow(ZAY_DILER.tbl2.S980s)
.head 4 +  Pushbutton: pbList
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.314"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\DOC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Печать свода заявок"
.head 6 +  On SAM_Click
.head 7 -  Call F_Prn_List( )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вернуть'
.head 6 +  On SAM_Click
.head 7 +  If MessageQuestion('Вы уверены, что хотите возвратить отмеченные заявки ?') = IDYES
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call SalSendMsg(ZAY_DILER.tbl,  UM_Delete,   0, 0)
.head 8 -  Call SalSendMsg(ZAY_DILER.tbl2, UM_Delete,   0, 0)
.head 8 -  Call SalPostMsg(ZAY_DILER.tbl,  UM_Populate, 0, 0)
.head 8 -  Call SalPostMsg(ZAY_DILER.tbl2, UM_Populate, 0, 0)
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.386"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If TIP = 1 AND 
   SalMessageBox('Зафиксировать изменения в базе данных?', 
                 'Внимание', MB_IconQuestion|MB_YesNo) = IDYES
OR
   TIP = 2 AND 
   SalMessageBox('Завизировать курсы дилера на отмеченных заявках?',
                 'Внимание', MB_IconQuestion|MB_YesNo) = IDYES   
.head 8 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 5114
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  1.886"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.886"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbKurs
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.986"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\CREATE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Курс дилера"
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWnd5)
.head 8 -  Set hWnd5 = SalCreateWindow(ZAYD, hWndMDI, nUSER, nZ)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAYD)
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.955"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryDFilterEx(cF_Zay)
.head 8 -  Call SalPostMsg(tbl, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbKursArc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.429"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Просмотр курсов дилера (архив)"
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlgKURS, hWndMDI)
.head 4 +  Pushbutton: pbNetto
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWnd4)
.head 8 -  Set hWnd4 = SalCreateWindow(ZAY_NETTO, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (ZAY_NETTO)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Нетто заявок"
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.757"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Call TableToText(tbl, 'Покупка валюты',' ', GetPrnDir()||'\\'||ZAY_DILER.strPrintFileName,'')
.head 7 -  ! Call TableToText(tbl2,'Продажа валюты',' ', '>'||GetPrnDir()||'\\'||ZAY_DILER.strPrintFileName,'')
.head 7 -  Call SalSendMsg(hWndCurTable, UM_Print, 0, 0)
.head 4 +  Pushbutton: pbPartSum
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CHILDS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Разбиение заявки"
.head 4 +  Pushbutton: pbSetKurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Пакетное удовлетворение заявок'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, 2, 0)
.head 4 +  Pushbutton: pbVIZA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.7"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOGFILE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр СТАТУСОВ заявки'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, 1, 0)
.head 4 +  Check Box: cb_CONV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: За ВАЛЮТУ
.head 5 -  Window Location and Size
.head 6 -  Left:   6.45"
.head 6 -  Top:    0.081"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.286"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Call InitSqlStr()
.head 7 -  Call SalSendMsg (tbl, UM_Populate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 5115
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  8.067"
.head 6 -  Begin Y:  0.452"
.head 6 -  End X:  8.067"
.head 6 -  End Y:  0.036"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 5116
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  8.733"
.head 6 -  Begin Y:  0.452"
.head 6 -  End X:  8.733"
.head 6 -  End Y:  0.036"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    3.917"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  12.967"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.667"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.785"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REQ_ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
заявки
РУ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.785"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пок
Прод
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ВАЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ВАЛ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV_CONV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ЗА
ВАЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DIG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ВАЛ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VIZA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_Z
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_F
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс
дилера
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: О
т
м
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl.SOS = 0
.head 9 -  Set nSOS = 0
.head 8 +  Else
.head 9 +  If nDIL_VIZA = 1
.head 10 -  Set nSOS = 0.5
.head 9 +  Else
.head 10 -  Set nSOS = 1
.head 9 +  If ZAY_DILER.tbl.VDATE = DATETIME_Null
.head 10 +  If ZAY_DILER.tbl.DAT < dDATA
.head 11 -  Set ZAY_DILER.tbl.VDATE = dDATA
.head 10 +  Else
.head 11 -  Set ZAY_DILER.tbl.VDATE = ZAY_DILER.tbl.DAT
.head 9 +  If ZAY_DILER.tbl.KURS_F = NUMBER_Null
.head 10 -  Set ZAY_DILER.tbl.KURS_F = ZAY_DILER.tbl.KURS_Z
.head 5 +  Column: VDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
валюти-
рования
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl.VDATE < dDATA OR 
   ZAY_DILER.tbl.VDATE < ZAY_DILER.tbl.DAT
.head 9 -  Return VALIDATE_Cancel
.head 5 +  Column: VDATE_PLAN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Плановая
дата
валютир.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl.VDATE < dDATA OR 
   ZAY_DILER.tbl.VDATE < ZAY_DILER.tbl.DAT
.head 9 -  Return VALIDATE_Cancel
.head 5 +  Column: S2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма ВАЛ
ПОКУПКИ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S2s
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма ВАЛ
ПОКУПКИ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S980s
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Эквивалент
суммы ПОКУПКИ
(по курсу дилера)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
зачисления
ВАЛЮТЫ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl.DATZ < dDATA OR 
   ZAY_DILER.tbl.DATZ < ZAY_DILER.tbl.VDATE
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else If (SqlPrepareAndExecute(hSql(), 
     "SELECT holiday INTO :ZAY_DILER.tbl.DATZ 
        FROM holiday 
       WHERE holiday = :ZAY_DILER.tbl.DATZ")
AND SqlFetchNext(hSql(), nFetchRes))
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: PRIOR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Прио-
ритет
заявки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIORITY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Прио-
ритет
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIORSTATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: PRIORSTATE
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RNK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рег.№
клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Клиент - ПОКУПАТЕЛЬ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BRANCH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отделение
Клиента - ПОКУПАТЕЛЯ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AIM_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Цель 
покупки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: COMM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Коментарий
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_KL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Курс клиента (первонач.)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак оплаты с ГОУ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: STATUS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак оплаты с ГОУ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: CLOSE_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приоритет
заявки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cbCLOSE_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
закрытия
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If cbCLOSE_TYPE.Init(hWndItem)
.head 9 -  Call cbCLOSE_TYPE.Populate(hSql(), "id", "name", " zay_close_types "," ")
.head 7 +  On SAM_AnyEdit
.head 8 -  Set CLOSE_TYPE = cbCLOSE_TYPE.GetKey(SalListQuerySelection(cbCLOSE_TYPE))
.head 5 +  Column: STATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Состояние заявки

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: START_TIME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Время поступления
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REQ_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
заявки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cbREQ_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
типа заявки
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call cbREQ_TYPE.Init(hWndItem)
.head 8 -  Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
.head 4 +  Functions
.head 5 +  Function: SetKurs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nKv1
.head 7 -  Number: nKv2
.head 7 -  Number: nKurs
.head 6 +  Actions
.head 7 +  If not SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call SalMessageBox('Не выбрана ни одна строка!', 'Внимание!', MB_Ok | MB_IconStop)
.head 8 -  Return FALSE
.head 7 -  Set nKv1 = NUMBER_Null
.head 7 -  Set nKv2 = NUMBER_Null
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If nKv1 = NUMBER_Null
.head 9 -  Set nKv1 = KV1
.head 9 +  If cb_CONV
.head 10 -  Set nKv2 = KV_CONV
.head 8 +  If nKv1 != NUMBER_Null
.head 9 +  If cb_CONV
.head 10 +  If nKv1 != KV1 or nKv2 != KV_CONV
.head 11 -  Call SalMessageBox('Не совпадают пары валют выбранных заявок!', 'Внимание!', MB_Ok | MB_IconStop)
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 +  If nKv1 != KV1
.head 11 -  Call SalMessageBox('Не совпадают валюты выбранных заявок!', 'Внимание!', MB_Ok | MB_IconStop)
.head 11 -  Return FALSE
.head 7 +  If SalModalDialog(dlg_Kurs, hWndForm, nKv1, nKv2, nKurs)
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblSetContext(hWndForm, nRow)
.head 9 -  Set KURS_F = nKurs
.head 9 -  Set SOS = TRUE
.head 9 -  Call SalSendMsg(tbl.SOS, SAM_Validate, 0, 0)
.head 9 -  Set VDATE = GetBankDate()
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, FALSE)
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nKV_BASE
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  ! Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  ! ! ! Показать-спрятать покупку за валюту
.head 6 +  If cb_CONV
.head 7 -  Call SalShowWindow(ZAY_DILER.tbl.KV_CONV)
.head 7 -  Set ZAY_DILER.strSqlPopulate =
"SELECT id, mfo, mfo_name, req_id, dk, sos, decode(sos, 0, 0, 1), kv2, lcv, dig,
        fdat, kurs_z, vdate, kurs_f, s2, viza, datz,
        rnk, nmk, cust_branch, priority, priorname, aim_name, comm, kurs_kl,
        (case when priorverify = 0 and viza >= 1 then 1
              when priorverify = 1 and viza >= 2 then 1
              else 0 
         end),
        close_type, close_type_name, kv_conv, state, start_time, req_type, vdate_plan
   INTO :ZAY_DILER.tbl.ID,   :ZAY_DILER.tbl.MFO,   :ZAY_DILER.tbl.MFO_NAME,
        :ZAY_DILER.tbl.REQ_ID, :ZAY_DILER.tbl.DK,  :ZAY_DILER.tbl.STATUS,
        :ZAY_DILER.tbl.SOS,  :ZAY_DILER.tbl.KV1,   :ZAY_DILER.tbl.ISO,
        :ZAY_DILER.tbl.DIG,  :ZAY_DILER.tbl.DAT,   :ZAY_DILER.tbl.KURS_Z,
        :ZAY_DILER.tbl.VDATE,:ZAY_DILER.tbl.KURS_F,:ZAY_DILER.tbl.S2,
        :ZAY_DILER.tbl.VIZA, :ZAY_DILER.tbl.DATZ,  
        :ZAY_DILER.tbl.RNK,  :ZAY_DILER.tbl.NMK,  :ZAY_DILER.tbl.BRANCH,
        :ZAY_DILER.tbl.PRIOR,:ZAY_DILER.tbl.PRIORITY, :ZAY_DILER.tbl.AIM_NAME, :ZAY_DILER.tbl.COMM, 
        :ZAY_DILER.tbl.KURS_KL, :ZAY_DILER.tbl.PRIORSTATE,
        :ZAY_DILER.tbl.CLOSE_TYPE, :ZAY_DILER.tbl.cbCLOSE_TYPE, :ZAY_DILER.tbl.KV_CONV,
        :ZAY_DILER.tbl.STATE, :ZAY_DILER.tbl.START_TIME, :ZAY_DILER.tbl.REQ_TYPE, :ZAY_DILER.tbl.VDATE_PLAN
   FROM v_zay
  WHERE dk = 3 
    AND s2 > 0 
    AND nvl(fdat,bankdate) <= bankdate 
    AND (   sos < 1 AND sos >= 0 AND viza >= 0
         OR sos >=1  AND vdate = bankdate )"
.head 6 +  Else
.head 7 -  Call SalHideWindow(ZAY_DILER.tbl.KV_CONV)
.head 7 -  Set ZAY_DILER.strSqlPopulate =
"SELECT id, mfo, mfo_name, req_id, dk, sos, decode(sos, 0, 0, 1), kv2, lcv, dig,
        fdat, kurs_z, vdate, kurs_f, s2, viza, datz,
        rnk, nmk, cust_branch, priority, priorname, aim_name, comm, kurs_kl,
        (case when priorverify = 0 and viza >= 1 then 1
              when priorverify = 1 and viza >= 2 then 1
              else 0 
         end),
        close_type, close_type_name, state, start_time, req_type, vdate_plan
   INTO :ZAY_DILER.tbl.ID,   :ZAY_DILER.tbl.MFO,   :ZAY_DILER.tbl.MFO_NAME,
        :ZAY_DILER.tbl.REQ_ID, :ZAY_DILER.tbl.DK,  :ZAY_DILER.tbl.STATUS,
        :ZAY_DILER.tbl.SOS,  :ZAY_DILER.tbl.KV1,   :ZAY_DILER.tbl.ISO,
        :ZAY_DILER.tbl.DIG,  :ZAY_DILER.tbl.DAT,   :ZAY_DILER.tbl.KURS_Z,
        :ZAY_DILER.tbl.VDATE,:ZAY_DILER.tbl.KURS_F,:ZAY_DILER.tbl.S2,
        :ZAY_DILER.tbl.VIZA, :ZAY_DILER.tbl.DATZ,  
        :ZAY_DILER.tbl.RNK,  :ZAY_DILER.tbl.NMK,  :ZAY_DILER.tbl.BRANCH,
        :ZAY_DILER.tbl.PRIOR,:ZAY_DILER.tbl.PRIORITY, :ZAY_DILER.tbl.AIM_NAME, :ZAY_DILER.tbl.COMM, 
        :ZAY_DILER.tbl.KURS_KL, :ZAY_DILER.tbl.PRIORSTATE,
        :ZAY_DILER.tbl.CLOSE_TYPE, :ZAY_DILER.tbl.cbCLOSE_TYPE,
        :ZAY_DILER.tbl.STATE, :ZAY_DILER.tbl.START_TIME, :ZAY_DILER.tbl.REQ_TYPE, :ZAY_DILER.tbl.VDATE_PLAN
   FROM v_zay
  WHERE dk = 1 
    AND s2 > 0 
    AND nvl(fdat,bankdate) <= bankdate 
    AND (   sos < 1 AND sos >= 0 AND viza >= 0
         OR sos >=1  AND vdate = bankdate )"
.head 6 -  Call ZAY_DILER.ReInitQueryString()
.head 6 -  Set sFilter = cF_Zay.GetFilterWhereClause(FALSE)
.head 6 -  Set strDSql = ZAY_DILER.strSqlPopulate ||
    IifS(sFilter != STRING_Null, " AND "||sFilter, " ") || 
    " order by id desc"
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), strDSql, TBL_FillAll)
.head 6 -  Call SalSendMsg(tbl2, UM_Populate, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SalIsNull(ZAY_DILER.tbl.SOS)
.head 7 -  Set ZAY_DILER.tbl.SOS = 0
.head 6 -  Set ZAY_DILER.tbl.PR = ZAY_DILER.tbl.SOS
.head 6 -  Set ZAY_DILER.tbl.S2s = Dig4(ZAY_DILER.tbl.S2/100,ZAY_DILER.tbl.DIG,4)
.head 6 +  If NOT SalIsNull(ZAY_DILER.tbl.KURS_F)
.head 7 -  ! Set ZAY_DILER.tbl.S980s = Dig4(ZAY_DILER.tbl.S2*ZAY_DILER.tbl.KURS_F/100,ZAY_DILER.tbl.DIG,4)
.head 7 +  If ZAY_DILER.tbl.DK = 3
.head 8 +  If SqlPrepareAndExecute(hSqlAux(), "select kv_base into :nKV_BASE from zay_conv_kv where (kv1 = :KV1 and kv2 = :KV_CONV) or (kv2 = :KV1 and kv1 = :KV_CONV)")
AND SqlFetchNext(hSqlAux(), nFetchRes)
.head 9 +  If nKV_BASE = ZAY_DILER.tbl.KV_CONV
.head 10 -  Set ZAY_DILER.tbl.S980s = Dig4(ZAY_DILER.tbl.S2/ZAY_DILER.tbl.KURS_F/100,ZAY_DILER.tbl.DIG,4)
.head 9 +  Else
.head 10 -  Set ZAY_DILER.tbl.S980s = Dig4(ZAY_DILER.tbl.S2*ZAY_DILER.tbl.KURS_F/100,ZAY_DILER.tbl.DIG,4)
.head 7 +  Else
.head 8 -  Set ZAY_DILER.tbl.S980s = Dig4(ZAY_DILER.tbl.S2*ZAY_DILER.tbl.KURS_F/100,ZAY_DILER.tbl.DIG,4)
.head 6 -  !
.head 6 +  If SalIsNull(ZAY_DILER.tbl.DATZ) 
.head 7 -  Set ZAY_DILER.tbl.DATZ=ZAY_DILER.tbl.VDATE
.head 6 -  !
.head 6 +  If ZAY_DILER.tbl.SOS = 0 AND ZAY_DILER.tbl.PRIORSTATE = 0 
.head 7 -  Call XSalTblSetRowBackColor(ZAY_DILER.tbl, lParam, COLOR_LightGray)
.head 6 -  !
.head 6 +  If ZAY_DILER.tbl.STATUS >= 1
.head 7 -  Call XSalTblSetRowBackColor( ZAY_DILER.tbl, lParam, COLOR_Sky )
.head 6 -  !
.head 6 +  If ZAY_DILER.tbl.KV1=840
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl, COLOR_DarkGreen )
.head 6 +  Else If ZAY_DILER.tbl.KV1=978
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl, COLOR_MidnightBlue )
.head 6 +  Else If ZAY_DILER.tbl.KV1=643
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl, COLOR_DarkRed )
.head 6 +  Else
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl,  COLOR_Default )
.head 6 -  !
.head 6 +  If REQ_TYPE = NUMBER_Null
.head 7 -  Set cbREQ_TYPE = STRING_Null
.head 6 +  Else
.head 7 -  Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
.head 5 +  On UM_Delete
.head 6 -  Set nNextRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nNextRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nNextRow)
.head 7 -  Call BackRequest(TIP, 1, ID, NMK, SalStrTrimX(S2s), ISO)
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! --------------------- Д И Л Е Р --------------------------
.head 6 +  If TIP = 1
.head 7 -  ! Покупка
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(ZAY_DILER.tbl, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(ZAY_DILER.tbl, nRow)
.head 8 +  If ZAY_DILER.tbl.KURS_F    != NUMBER_Null   AND 
   ZAY_DILER.tbl.VDATE     != DATETIME_Null AND
   ZAY_DILER.tbl.PRIORSTATE = 1 
.head 9 +  If SqlPLSQLCommand(cMain.hSql(),
"bars_zay.set_sos(ZAY_DILER.tbl.ID,
  ZAY_DILER.tbl.KURS_F, nSOS, ZAY_DILER.tbl.VDATE,
  ZAY_DILER.tbl.CLOSE_TYPE, ZAY_DILER.dDATA)")
.head 10 -  Call SqlCommit(cMain.hSql())
.head 10 +  If ZAY_DILER.tbl.PR != ZAY_DILER.tbl.SOS AND  ZAY_DILER.tbl.PR = 0 
.head 11 -  Call SaveInfoToLog("Дилер. Удовлетворена заявка № "||Str(ZAY_DILER.tbl.ID)||" на покупку "||SalStrTrimX(ZAY_DILER.tbl.S2s)||" "||ZAY_DILER.tbl.ISO||" по курсу "||Str(ZAY_DILER.tbl.KURS_F))
.head 9 +  Else
.head 10 -  Call SqlRollback(cMain.hSql())
.head 7 -  ! Продажа
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(ZAY_DILER.tbl2, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(ZAY_DILER.tbl2, nRow)
.head 8 +  If ZAY_DILER.tbl2.KURS_F    != NUMBER_Null   AND 
   ZAY_DILER.tbl2.VDATE     != DATETIME_Null AND
   ZAY_DILER.tbl2.PRIORSTATE = 1 
.head 9 +  If SqlPLSQLCommand(cMain.hSql(),
"bars_zay.set_sos(ZAY_DILER.tbl2.ID,
  ZAY_DILER.tbl2.KURS_F, nSOS, ZAY_DILER.tbl2.VDATE,
  ZAY_DILER.tbl2.CLOSE_TYPE, ZAY_DILER.dDATA)")
.head 10 -  Call SqlCommit(cMain.hSql())
.head 10 +  If ZAY_DILER.tbl2.PR != ZAY_DILER.tbl2.SOS AND  ZAY_DILER.tbl2.PR=0 
.head 11 -  Call SaveInfoToLog("Дилер. Удовлетворена заявка № "||Str(ZAY_DILER.tbl2.ID)||" на продажу "||SalStrTrimX(ZAY_DILER.tbl2.S2s)||" "||ZAY_DILER.tbl2.ISO||" по курсу "||Str(ZAY_DILER.tbl2.KURS_F))
.head 9 +  Else
.head 10 -  Call SqlRollback(cMain.hSql())
.head 6 -  ! --------------------- Б И Р Ж А --------------------------
.head 6 +  Else
.head 7 -  ! Покупка
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(ZAY_DILER.tbl, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(ZAY_DILER.tbl, nRow)
.head 8 -  !
.head 8 +  If ZAY_DILER.tbl.KURS_F != NUMBER_Null   AND 
   ZAY_DILER.tbl.VDATE  != DATETIME_Null AND
   ZAY_DILER.tbl.STATUS  = 0.5
.head 9 +  If SqlPLSQLCommand(cMain.hSql(), "bars_zay.visa_kurs(ZAY_DILER.tbl.ID, ZAY_DILER.tbl.DATZ)")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SaveInfoToLog("ГОУ. Завизирован курс дилера на заявке № "||Str(ZAY_DILER.tbl.ID)||" на покупку "||SalStrTrimX(ZAY_DILER.tbl.S2s)||" "||ZAY_DILER.tbl.ISO||" по курсу "||Str(ZAY_DILER.tbl.KURS_F))
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 7 -  ! Продажа
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(ZAY_DILER.tbl2, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(ZAY_DILER.tbl2, nRow)
.head 8 +  If ZAY_DILER.tbl2.KURS_F != NUMBER_Null   AND 
   ZAY_DILER.tbl2.VDATE  != DATETIME_Null AND
   ZAY_DILER.tbl2.STATUS  = 0.5
.head 9 +  If SqlPLSQLCommand(cMain.hSql(), "bars_zay.visa_kurs(ZAY_DILER.tbl2.ID, ZAY_DILER.tbl2.DATZ)")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SaveInfoToLog("ГОУ. Завизирован курс дилера на заявке № "||Str(ZAY_DILER.tbl2.ID)||" на продажу "||SalStrTrimX(ZAY_DILER.tbl2.S2s)||" "||ZAY_DILER.tbl2.ISO||" по курсу "||Str(ZAY_DILER.tbl2.KURS_F))
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 6 -  !
.head 6 -  !
.head 6 -  Call SalTblDefineSplitWindow(ZAY_DILER.tbl, 0, FALSE)
.head 6 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 6 -  Call SalTblDefineSplitWindow(ZAY_DILER.tbl2, 0, FALSE)
.head 6 -  Call SalPostMsg(ZAY_DILER.tbl2, UM_Populate, 0, 0)
.head 6 -  !
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_SetFocus
.head 6 -  Set hWndCurTable = tbl
.head 5 +  On SAM_User
.head 6 +  If wParam = 0
.head 7 +  If tbl.ID
.head 8 +  If SalModalDialog(dlgPartSum, hWndForm, tbl.ID, tbl.REQ_ID, tbl.S2, tbl.ISO, tbl.DIG)
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  Call SalMessageBox("Не выбрана заявка!", "Внимание!", MB_IconStop | MB_Ok)
.head 6 +  Else If wParam = 1
.head 7 -  Call ZayavkaEx(hWndForm, 77, ID, '', '')
.head 6 +  Else If wParam = 2
.head 7 -  Call SetKurs()
.head 5 +  On UM_Print
.head 6 -  Call TablePrint(tbl, 'Покупка валюты', GetPrnDir()||'\\'||ZAY_DILER.strPrintFileName,'')
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  ! сортировка строковых столбцов по числовым
.head 6 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(S2s), COL_GetID)
.head 7 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 7 -  Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(S2), COL_GetID))
.head 6 -  Call SalSendClassMessage(SAM_ColumnSelectClick, wParam, lParam)
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    2.738"
.head 6 -  Width:  11.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.631"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.785"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REQ_ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
заявки
РУ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.785"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пок
Прод
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ВАЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ВАЛ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV_CONV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ЗА
ВАЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DIG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ВАЛ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OBZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: О
Б
З
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VIZA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_Z
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_F
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Курс
дилера
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: О
т
м
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl2.SOS = 0
.head 9 -  Set nSOS=0
.head 9 -  Set ZAY_DILER.tbl2.VDATE=DATETIME_Null
.head 9 -  Set ZAY_DILER.tbl2.KURS_F=NUMBER_Null
.head 8 +  Else
.head 9 +  If nDIL_VIZA=1
.head 10 -  Set nSOS=0.5
.head 9 +  Else
.head 10 -  Set nSOS=1
.head 9 +  If ZAY_DILER.tbl2.VDATE=DATETIME_Null
.head 10 +  If ZAY_DILER.tbl2.DAT<dDATA
.head 11 -  Set ZAY_DILER.tbl2.VDATE=dDATA
.head 10 +  Else
.head 11 -  Set ZAY_DILER.tbl2.VDATE=ZAY_DILER.tbl2.DAT
.head 9 +  If ZAY_DILER.tbl2.KURS_F=NUMBER_Null
.head 10 -  Set ZAY_DILER.tbl2.KURS_F=ZAY_DILER.tbl2.KURS_Z
.head 5 +  Column: VDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
валюти-
рования
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl2.VDATE < dDATA or ZAY_DILER.tbl2.VDATE < ZAY_DILER.tbl2.DAT
.head 9 -  Return VALIDATE_Cancel
.head 5 +  Column: S2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма ВАЛ
ПРОДАЖИ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S2s
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма ВАЛ
на
ПРОДАЖУ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S980s
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ГРН Эквивалент
суммы ПРОДАЖИ
(по курсу дилера)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
зачисления
ГРИВНЫ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If ZAY_DILER.tbl2.DATZ < dDATA OR ZAY_DILER.tbl2.DATZ < ZAY_DILER.tbl2.VDATE
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else If (SqlPrepareAndExecute( hSql(), 
     "SELECT holiday INTO :ZAY_DILER.tbl2.DATZ FROM holiday WHERE holiday=:ZAY_DILER.tbl2.DATZ" )
AND SqlFetchNext( hSql(), nFetchRes ))
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: PRIOR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Прио-
ритет
заявки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIORITY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Прио-
ритет
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIORSTATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RNK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рег.№
клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Клиент - ПРОДАВЕЦ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BRANCH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отделение
Клиента - ПРОДАВЦА
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: AIM_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Цель
продажи
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: COMM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Коментарий
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KURS_KL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Курс клиента (первонач.)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак оплаты с ГОУ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: STATUS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак оплаты с ГОУ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: CLOSE_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приоритет
заявки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cbCLOSE_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
закрытия
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If cbCLOSE_TYPE.Init(hWndItem)
.head 9 -  Call cbCLOSE_TYPE.Populate(hSql(), "id", "name", " zay_close_types "," ")
.head 7 +  On SAM_AnyEdit
.head 8 -  Set CLOSE_TYPE = cbCLOSE_TYPE.GetKey(SalListQuerySelection(cbCLOSE_TYPE))
.head 5 +  Column: STATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Состояние заявки

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: START_TIME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Время поступления
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REQ_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
заявки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cbREQ_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
типа заявки
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call cbREQ_TYPE.Init(hWndItem)
.head 8 -  Call cbREQ_TYPE.Populate(hSql(), "ID", "NAME", "ZAY_TYPE", " ORDER BY NAME")
.head 4 +  Functions
.head 5 +  Function: SetKurs
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nKv1
.head 7 -  Number: nKv2
.head 7 -  Number: nKurs
.head 6 +  Actions
.head 7 +  If not SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call SalMessageBox('Не выбрана ни одна строка!', 'Внимание!', MB_Ok | MB_IconStop)
.head 8 -  Return FALSE
.head 7 -  Set nKv1 = NUMBER_Null
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If nKv1 = NUMBER_Null
.head 9 -  Set nKv1 = KV1
.head 9 +  If cb_CONV
.head 10 -  Set nKv2 = KV_CONV
.head 8 +  If nKv1 != NUMBER_Null
.head 9 +  If cb_CONV
.head 10 +  If nKv1 != KV1 or nKv2 != KV_CONV
.head 11 -  Call SalMessageBox('Не совпадают пары валют выбранных заявок!', 'Внимание!', MB_Ok | MB_IconStop)
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 +  If nKv1 != KV1
.head 11 -  Call SalMessageBox('Не совпадают валюты выбранных заявок!', 'Внимание!', MB_Ok | MB_IconStop)
.head 11 -  Return FALSE
.head 7 +  If SalModalDialog(dlg_Kurs, hWndForm, nKv1, NUMBER_Null, nKurs)
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblSetContext(hWndForm, nRow)
.head 9 -  Set KURS_F = nKurs
.head 9 -  Set SOS = TRUE
.head 9 -  Call SalSendMsg(tbl2.SOS, SAM_Validate, 0, 0)
.head 9 -  Set VDATE = GetBankDate()
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, FALSE)
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nKV_BASE
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If cb_CONV
.head 7 -  Call SalShowWindow(ZAY_DILER.tbl2.KV_CONV)
.head 6 +  Else
.head 7 -  Call SalHideWindow(ZAY_DILER.tbl2.KV_CONV)
.head 6 -  Set strDSql =
"SELECT id, mfo, mfo_name, req_id, dk, sos, decode(sos,0,0,1), kv2, lcv, dig, kv_conv, 
        fdat, kurs_z, vdate, kurs_f, s2, viza, datz, 
        rnk, nmk, cust_branch, priority, priorname, aim_name, comm, kurs_kl,
        (case when priorverify = 0 and viza >= 1 then 1
              when priorverify = 1 and viza >= 2 then 1
              else 0 
         end),
        close_type, close_type_name, obz, state, start_time, req_type
   INTO :ZAY_DILER.tbl2.ID,   :ZAY_DILER.tbl2.MFO,   :ZAY_DILER.tbl2.MFO_NAME,
        :ZAY_DILER.tbl2.REQ_ID, :ZAY_DILER.tbl2.DK,  :ZAY_DILER.tbl2.STATUS,
        :ZAY_DILER.tbl2.SOS,  :ZAY_DILER.tbl2.KV1,   :ZAY_DILER.tbl2.ISO,
        :ZAY_DILER.tbl2.DIG,  :ZAY_DILER.tbl2.KV_CONV,:ZAY_DILER.tbl2.DAT, :ZAY_DILER.tbl2.KURS_Z,
        :ZAY_DILER.tbl2.VDATE,:ZAY_DILER.tbl2.KURS_F,:ZAY_DILER.tbl2.S2,
        :ZAY_DILER.tbl2.VIZA, :ZAY_DILER.tbl2.DATZ,  
        :ZAY_DILER.tbl2.RNK,  :ZAY_DILER.tbl2.NMK,   :ZAY_DILER.tbl2.BRANCH,
        :ZAY_DILER.tbl2.PRIOR,:ZAY_DILER.tbl2.PRIORITY, :ZAY_DILER.tbl2.AIM_NAME, :ZAY_DILER.tbl2.COMM, 
        :ZAY_DILER.tbl2.KURS_KL, :ZAY_DILER.tbl2.PRIORSTATE, 
        :ZAY_DILER.tbl2.CLOSE_TYPE, :ZAY_DILER.tbl2.cbCLOSE_TYPE, :ZAY_DILER.tbl2.OBZ,
        :ZAY_DILER.tbl2.STATE, :ZAY_DILER.tbl2.START_TIME, :ZAY_DILER.tbl2.REQ_TYPE
   FROM v_zay
  WHERE dk = " || IifS(cb_CONV=TRUE, "4", "2") || " 
    AND s2 > 0 
    AND nvl(fdat,bankdate) <= bankdate 
    AND (   sos < 1 AND sos >= 0 AND viza >= 0
         OR sos >= 1 AND vdate = bankdate ) " ||
        IifS(sFilter != STRING_Null, " AND "||sFilter, " ") || "
  order by id desc"
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), strDSql, TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SalIsNull(ZAY_DILER.tbl2.SOS)
.head 7 -  Set ZAY_DILER.tbl2.SOS = 0
.head 6 -  Set ZAY_DILER.tbl2.PR = ZAY_DILER.tbl2.SOS
.head 6 -  Set ZAY_DILER.tbl2.S2s = Dig4(ZAY_DILER.tbl2.S2/100,ZAY_DILER.tbl2.DIG,4)
.head 6 +  If NOT SalIsNull(ZAY_DILER.tbl2.KURS_F)
.head 7 +  If ZAY_DILER.tbl2.DK = 4
.head 8 +  If SqlPrepareAndExecute(hSqlAux(), "select kv_base into :nKV_BASE from zay_conv_kv where (kv1 = :KV1 and kv2 = :KV_CONV) or (kv2 = :KV1 and kv1 = :KV_CONV)")
AND SqlFetchNext(hSqlAux(), nFetchRes)
.head 9 +  If nKV_BASE = ZAY_DILER.tbl2.KV_CONV
.head 10 -  Set ZAY_DILER.tbl2.S980s = Dig4(ZAY_DILER.tbl2.S2/ZAY_DILER.tbl2.KURS_F/100,ZAY_DILER.tbl2.DIG,4)
.head 9 +  Else
.head 10 -  Set ZAY_DILER.tbl2.S980s = Dig4(ZAY_DILER.tbl2.S2*ZAY_DILER.tbl2.KURS_F/100,ZAY_DILER.tbl2.DIG,4)
.head 7 +  Else
.head 8 -  Set ZAY_DILER.tbl2.S980s = Dig4(ZAY_DILER.tbl2.S2*ZAY_DILER.tbl2.KURS_F/100,ZAY_DILER.tbl2.DIG,4)
.head 6 -  !
.head 6 +  If SalIsNull(ZAY_DILER.tbl2.DATZ) 
.head 7 -  Set ZAY_DILER.tbl2.DATZ = ZAY_DILER.tbl2.VDATE
.head 6 -  !
.head 6 +  If ZAY_DILER.tbl2.SOS = 0 AND ZAY_DILER.tbl2.PRIORSTATE = 0
.head 7 -  Call XSalTblSetRowBackColor(ZAY_DILER.tbl2, lParam, COLOR_LightGray)
.head 6 -  !
.head 6 +  If ZAY_DILER.tbl2.STATUS >= 1
.head 7 -  Call XSalTblSetRowBackColor( ZAY_DILER.tbl2, lParam, COLOR_Sky )
.head 6 -  !
.head 6 +  If ZAY_DILER.tbl2.KV1=840
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl2, COLOR_DarkGreen )
.head 6 +  Else If ZAY_DILER.tbl2.KV1=978
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl2, COLOR_MidnightBlue )
.head 6 +  Else If ZAY_DILER.tbl2.KV1=643
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl2, COLOR_DarkRed )
.head 6 +  Else
.head 7 -  Call SetTblRowColor( ZAY_DILER.tbl2,  COLOR_Default )
.head 6 -  !
.head 6 +  If REQ_TYPE = NUMBER_Null
.head 7 -  Set cbREQ_TYPE = STRING_Null
.head 6 +  Else
.head 7 -  Call cbREQ_TYPE.SetSelectById(REQ_TYPE)
.head 5 +  On UM_Delete
.head 6 -  Set nNextRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nNextRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nNextRow)
.head 7 -  Call BackRequest(TIP, 2, ID, NMK, SalStrTrimX(S2s), ISO)
.head 5 +  On SAM_SetFocus
.head 6 -  Set hWndCurTable = tbl2
.head 5 +  On SAM_User
.head 6 +  If wParam = 0
.head 7 +  If tbl2.ID
.head 8 +  If SalModalDialog(dlgPartSum, hWndForm, tbl2.ID, tbl2.REQ_ID, tbl2.S2, tbl2.ISO, tbl2.DIG)
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  Call SalMessageBox("Не выбрана заявка!", "Внимание!", MB_IconStop | MB_Ok)
.head 6 +  Else If wParam = 1
.head 7 -  Call ZayavkaEx(hWndForm, 77, ID, '', '')
.head 6 +  Else If wParam = 2
.head 7 -  Call SetKurs()
.head 5 +  On UM_Print
.head 6 -  Call TablePrint(tbl2,'Продажа валюты', GetPrnDir() || '\\' || ZAY_DILER.strPrintFileName,'')
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  ! сортировка строковых столбцов по числовым
.head 6 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(S2s), COL_GetID)
.head 7 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 7 -  Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(S2), COL_GetID))
.head 6 -  Call SalSendClassMessage(SAM_ColumnSelectClick, wParam, lParam)
.head 2 +  Functions
.head 3 +  Function: F_Prn_List
.head 4 -  Description: Печать листа узгодження
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKODZ
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(),
   "SELECT to_number(nvl(val,0)) INTO :nKODZ
    FROM birja WHERE par='PRN_LIST' " )
AND not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set nKODZ=0
.head 5 +  If nKODZ>0
.head 6 +  If SalMessageBox('Вы действительно хотите сформировать ведомость?','Внимание',MB_YesNo )=IDYES
.head 7 -  Call ExportCatQuery( nKODZ, '', 3, ":Param0='" ||SalFmtFormatDateTime(GetBankDate(),'dd/MM/yyyy')|| "'", FALSE )
.head 5 +  Else
.head 6 -  Call SalMessageBox('Не указан код каталог.запроса для формирования ведомости!','Внимание',MB_IconStop )
.head 3 +  Function: BackRequest
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nTip
.head 5 -  Number: nFlag
.head 5 -  Number: nID
.head 5 -  String: sNmk
.head 5 -  String: sS
.head 5 -  String: sKv
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStornoReasonId
.head 5 -  String: sStornoReason
.head 5 -  Number: nStornoReasonId
.head 4 +  Actions
.head 5 -  Set sStornoReasonId = ''
.head 5 -  Set sStornoReason = ''
.head 5 -  ! --------------------- Д И Л Е Р --------------------------
.head 5 +  If nTip = 1
.head 6 +  If SalMessageBox('Вы уверены, что хотите отказать в удовлетворении заявки клиента ' || sNmk ||
   IifS(nFlag=1, ' на покупку ', ' на продажу ') || sS || '/' || sKv || '?',
   'Сторно заявок', MB_IconQuestion | MB_YesNo) = IDYES
.head 7 +  If FunNSIGet('ZAY_BACK', '', sStornoReasonId,  sStornoReason)
.head 8 +  If sStornoReasonId AND sStornoReason
.head 9 -  Set nStornoReasonId = Val(sStornoReasonId)
.head 9 +  If nStornoReasonId = 99
.head 10 +  If not SalModalDialog(dlg_Comments, hWndForm, sStornoReason)
.head 11 -  Call SalMessageBox('Не указан комментарий! Повторите операцию', 'Сторно заявок. Ошибка', MB_IconStop)
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 -  Set sStornoReason = ''
.head 9 +  If SqlPLSQLCommand(hSql(), "bars_zay.back_request(4, nID, nStornoReasonId, sStornoReason)")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SaveInfoToLog("ZAY. Дилером отказано в удовлетворении заявке № " || Str(nID) ||
     " на покупку " || sS || "/" || sKv || ". Код причины - " || sStornoReasonId)
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call SalMessageBox('Невозможно вернуть заявку! Повторите операцию', 'Сторно заявок. Ошибка', MB_IconStop)
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SalMessageBox('Причина отказа не была выбрана! Повторите операцию', 'Сторно заявок. Ошибка', MB_IconStop)
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SalMessageBox ('Причина отказа не была выбрана! Повторите операцию', 'Сторно документов. Ошибка', MB_IconStop)
.head 8 -  Return FALSE
.head 5 -  ! --------------------- Б И Р Ж А --------------------------
.head 5 +  Else
.head 6 +  If SalMessageBox('Вы уверены, что хотите вернуть заявку № ' || Str(nID) ||
   IifS(nFlag=1, ' на покупку ', ' на продажу ') || sS || '/' || sKv ||' дилеру?',
   'Возврат заявок', MB_IconQuestion | MB_YesNo) = IDYES
.head 7 +  If SqlPLSQLCommand(hSql(), "bars_zay.back_request(5, nID, 0, STRING_Null)")
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SaveInfoToLog("ZAY. Курсы дилера незавизированы! Заявка № " || Str(nID) ||
     IifS(nFlag=1, " на покупку ", " на продажу ") || sS || "/" || sKv || " возвращена дилеру. ")
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: TIP
.head 3 -  ! 1 - Дилер
.head 3 -  ! 2 - Биржа
.head 2 +  Window Variables
.head 3 -  String: strDSql
.head 3 -  Date/Time: dDATA
.head 3 -  String: sdat
.head 3 -  String: sdatDDMM
.head 3 -  Number: nRow
.head 3 -  Number: nSOS
.head 3 -  Number: nDIL_VIZA
.head 3 -  Number: nUSER
.head 3 -  Number: nZ
.head 3 -  Number: nNextRow
.head 3 -  Window Handle: hWndCurTable
.head 3 -  : cF_Zay
.head 4 -  Class: cGenDFilterEx
.head 3 -  String: sFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If TIP = 1
.head 5 -  Call SalSetWindowText(hWndForm, 'ДИЛЕР. Удовлетворение заявок клиентов на покупку-продажу валюты')
.head 5 -  Call SalEnableWindow(ZAY_DILER.tbl.KURS_F)
.head 5 -  Call SalEnableWindow(ZAY_DILER.tbl.SOS)
.head 5 -  Call SalEnableWindow(ZAY_DILER.tbl.VDATE)
.head 5 -  Call SalEnableWindow(ZAY_DILER.tbl2.KURS_F)
.head 5 -  Call SalEnableWindow(ZAY_DILER.tbl2.SOS)
.head 5 -  Call SalEnableWindow(ZAY_DILER.tbl2.VDATE)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl.DATZ)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl2.DATZ)
.head 5 -  Call SalEnableWindow(pbKurs)
.head 4 +  Else
.head 5 -  Call SalSetWindowText(hWndForm, 'БИРЖА. Визирование курсов дилера на заявках клиентов на покупку-продажу валюты')
.head 5 -  Call SalDisableWindow(ZAY_DILER.tbl.KURS_F)
.head 5 -  Call SalDisableWindow(ZAY_DILER.tbl.SOS)
.head 5 -  Call SalDisableWindow(ZAY_DILER.tbl.VDATE)
.head 5 -  Call SalDisableWindow(ZAY_DILER.tbl2.KURS_F)
.head 5 -  Call SalDisableWindow(ZAY_DILER.tbl2.SOS)
.head 5 -  Call SalDisableWindow(ZAY_DILER.tbl2.VDATE)
.head 5 -  Call SalShowWindow(ZAY_DILER.tbl.DATZ)
.head 5 -  Call SalShowWindow(ZAY_DILER.tbl2.DATZ)
.head 5 -  Call SalDisableWindow(pbKurs)
.head 5 -  Call SalDisableWindow(pbSetKurs)
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  !
.head 4 +  If gZAYMODE != 1
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl.MFO)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl.MFO_NAME)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl.REQ_ID)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl2.MFO)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl2.MFO_NAME)
.head 5 -  Call SalHideWindow(ZAY_DILER.tbl2.REQ_ID)
.head 4 -  !
.head 4 -  Set dDATA = GetBankDate()
.head 4 -  Set nUSER = GetUserId()
.head 4 -  Set cb_CONV = FALSE
.head 4 -  Set nZ = 35
.head 4 -  Set sdat = SalFmtFormatDateTime( dDATA,'MM-dd-yyyy' )
.head 4 -  Set sdatDDMM = SalStrMidX( sdat, 3, 2 )||SalStrMidX( sdat, 0, 2 )
.head 4 -  !
.head 4 -  Set ZAY_DILER.strPrintFileName = 'LIST'||sdatDDMM||'.TXT'
.head 4 -  Set ZAY_DILER.strFilterTblName = 'V_ZAY'
.head 4 -  Set ZAY_DILER.nTabInstance1 = TRUE
.head 4 -  Set ZAY_DILER.nTabInstance2 = TRUE
.head 4 -  Call SalHideWindow(ZAY_DILER.tbl.S980s)
.head 4 -  Call SalHideWindow(ZAY_DILER.tbl2.S980s)
.head 4 +  If SqlPrepareAndExecute( hSql(),
   "SELECT to_number(nvl(val,0)) INTO :nDIL_VIZA
    FROM birja WHERE par='DIL_VIZA' " )
AND not SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set nDIL_VIZA = 0
.head 4 -  Set hWndCurTable = tbl
.head 4 -  Call cF_Zay.Init('v_zay', 'v_zay')
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Table Window: ZAY_NETTO
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: НЕТТО позиция по покупке-продаже валюты клиентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  19.217"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.119"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57018
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  9.25"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  9.25"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57019
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.483"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  3.483"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.617"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Показать детально'
.head 6 +  On SAM_Click
.head 7 -  Set bDetails = not bDetails
.head 7 -  Call Init()
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Check Box: cbSos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Удовлетворенные заявки
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    0.13"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call Init()
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 47786
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  8.617"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  8.617"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.717"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57020
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KURS_F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
дилера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отделение
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BRANCHNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование отделения
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CLOSETYPENAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Признак 
операции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
покупки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
продажи
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(-) покупка
(+) продажа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(удовлетворено
дилером)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(зачислено
клиентам)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SBs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
покупки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SBeqv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
покупки
(эквивалент)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SSs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
продажи
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SSeqv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
продажи
(эквивалент)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SNs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(-) покупка
(+) продажа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SNeqv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(-) покупка
(+) продажа
(эквивалент)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(удовлетворено
дилером)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО
(зачислено
клиентам)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: dig
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Init
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sUnion
.head 4 +  Actions
.head 5 -  Set ZAY_NETTO.strSqlPopulate = 
"select t.lcv, " || IifS(bDetails=TRUE, "v.kurs_f, ", "") || "v." || sBranch|| ", b." || sName || ", t.dig, v.fdat, v.close_type_name,
        sum(decode(v.dk,1,v.s2,0)),
        sum(decode(v.dk,2,v.s2,0)),
        sum(decode(v.dk,2,v.s2,0)) - 
        sum(decode(v.dk,1,v.s2,0)), 0, 0, " || IifS(cbSos=TRUE, "
        sum(decode(v.dk,1,v.s2*v.kurs_f,0))/100,
        sum(decode(v.dk,2,v.s2*v.kurs_f,0))/100,
        (sum(decode(v.dk,2,v.s2*v.kurs_f,0)) - 
        sum(decode(v.dk,1,v.s2*v.kurs_f,0)))/100", "null, null, null") || "
   into :ZAY_NETTO.KV, " || IifS(bDetails=TRUE, ":ZAY_NETTO.KURS_F, ", "") || ":ZAY_NETTO.BRANCH, :ZAY_NETTO.BRANCHNAME,
        :ZAY_NETTO.DIG, :ZAY_NETTO.DAT, :ZAY_NETTO.CLOSETYPENAME,
        :ZAY_NETTO.SB, :ZAY_NETTO.SS, :ZAY_NETTO.SN, :ZAY_NETTO.S1, :ZAY_NETTO.S2,
        :ZAY_NETTO.SBeqv, :ZAY_NETTO.SSeqv, :ZAY_NETTO.SNeqv
   from v_zay v, tabval t, zay_priority p, " || sTable || " b
  where v.kv2      = t.kv
    and v.priority = p.id 
    and v." || sBranch || " = b." || sBranch || "
    and v.s2       > 0 
    and v.sos     >= 0 
    and v.vdate    <= bankdate
    and ((v.viza = 1 and p.verify = 0) or (v.viza = 2 and p.verify = 1))
    and ((v.sos < 2) or (v.sos = 2 and v.vdate = bankdate)) " || IifS(cbSos=TRUE, "and v.sos >= 0.5", "") || "
  group by t.lcv, " || IifS(bDetails=TRUE, "v.kurs_f, ", "") || "v." || sBranch || ", b." || sName || ", t.dig, v.fdat, v.close_type_name" 
.head 5 -  Set ZAY_NETTO.strSqlPopulate = ZAY_NETTO.strSqlPopulate ||
" union all
 select t.lcv, " || IifS(bDetails=TRUE, "null, ", "") || " null, null, t.dig, null, null,
        sum(decode(v.dk,1,v.s2,0)),
        sum(decode(v.dk,2,v.s2,0)),
        sum(decode(v.dk,2,v.s2,0)) - 
        sum(decode(v.dk,1,v.s2,0)),
        sum(decode(v.dk, 2, decode(v.sos, 0, 0, v.s2),0)) -
        sum(decode(v.dk, 1, decode(v.sos, 0, 0, v.s2),0)),
        sum(decode(v.dk, 2, decode(v.sos,2,v.s2,0),0)) -
        sum(decode(v.dk, 1, decode(v.sos,2,v.s2,0),0)), " || IifS(cbSos=TRUE, "
        sum(decode(v.dk,1,v.s2*v.kurs_f,0))/100,
        sum(decode(v.dk,2,v.s2*v.kurs_f,0))/100,
        (sum(decode(v.dk,2,v.s2*v.kurs_f,0)) - 
        sum(decode(v.dk,1,v.s2*v.kurs_f,0)))/100", "null, null, null") || "
   from v_zay v, tabval t, zay_priority p
  where v.kv2      = t.kv 
    and v.priority = p.id
    and v.s2       > 0  
    and v.sos     >= 0 
    and v.vdate    <= bankdate
    and ((v.viza = 1 and p.verify = 0) or (v.viza = 2 and p.verify = 1))
    and ((v.sos < 2) or (v.sos = 2 and v.vdate = bankdate)) " || IifS(cbSos=TRUE, "and v.sos >= 0.5", "") || "
  group by t.lcv, t.dig
  order by 1, " || IifS(bDetails=TRUE, "3, 6, 8", "2, 5, 7")
.head 5 +  If cbSos
.head 6 -  Call SalEnableWindow(pbDetails)
.head 6 -  Call SalShowWindow(SBeqv)
.head 6 -  Call SalShowWindow(SSeqv)
.head 6 -  Call SalShowWindow(SNeqv)
.head 6 +  If bDetails
.head 7 -  Call SalShowWindow(ZAY_NETTO.KURS_F)
.head 6 +  Else
.head 7 -  Call SalHideWindow(ZAY_NETTO.KURS_F)
.head 5 +  Else
.head 6 -  Set bDetails = FALSE
.head 6 -  Call SalDisableWindow(pbDetails)
.head 6 -  Call SalHideWindow(SBeqv)
.head 6 -  Call SalHideWindow(SSeqv)
.head 6 -  Call SalHideWindow(SNeqv)
.head 6 -  Call SalHideWindow(ZAY_NETTO.KURS_F)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nMaxDig
.head 3 -  Boolean: bDetails
.head 3 -  String: sTable
.head 3 -  String: sBranch
.head 3 -  String: sName
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set nMaxDig = DigInit()
.head 4 -  Set nMaxDig = IifN(nMaxDig=-1, 4, nMaxDig)
.head 4 -  Set ZAY_NETTO.nFlags = GT_NoDel|GT_NoIns|GT_NoUpd
.head 4 -  Set ZAY_NETTO.strPrintFileName = 'ZAYNETTO'
.head 4 -  Set cbSos = TRUE
.head 4 -  Set bDetails = FALSE
.head 4 +  If gZAYMODE = 0
.head 5 -  Set sTable  = 'branch'
.head 5 -  Set sBranch = 'branch'
.head 5 -  Set sName   = 'name'
.head 4 +  Else
.head 5 -  Set sTable  = 'banks$base'
.head 5 -  Set sBranch = 'mfo'
.head 5 -  Set sName   = 'nb'
.head 5 -  Call SalTblSetColumnWidth(ZAY_NETTO.BRANCH, 1.2)
.head 5 -  Call SalTblSetColumnTitle(ZAY_NETTO.BRANCH, 'МФО' || PutCrLf() || 'заявки')
.head 5 -  Call SalTblSetColumnTitle(ZAY_NETTO.BRANCHNAME, 'Наименование МФО' || PutCrLf() || 'заявки')
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 4 -  Call Init()
.head 3 +  On UM_Populate
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), ZAY_NETTO.strSqlPopulate, TBL_FillAll)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SalIsNull(ZAY_NETTO.DAT) 
.head 5 -  Call XSalTblSetRowBackColor(ZAY_NETTO, lParam, COLOR_LightPeriwinkle)
.head 4 -  !
.head 4 -  Set SBs = Dig4(SB/100, DIG, nMaxDig)
.head 4 -  Set SSs = Dig4(SS/100, DIG, nMaxDig)
.head 4 -  Set SNs = Dig4(SN/100, DIG, nMaxDig)
.head 4 -  Set S1s = Dig4(S1/100, DIG, nMaxDig)
.head 4 -  Set S2s = Dig4(S2/100, DIG, nMaxDig)
.head 1 +  Form Window: ZAY_EC
.head 2 -  Class: cGenericTableFrm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.107"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Excange Control
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( ZAY_EC.tblC, SAM_Create, 0, 0 )
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Update, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 23884
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр авансовых ТД по контракту'
.head 6 +  On SAM_Click
.head 7 +  If nPID != NUMBER_Null
.head 8 -  Call FunNSIEditFFiltered( 
    ' tamozhdoc ', 
     2, 
    '     tamozhdoc.impexp = 1 
      AND tamozhdoc.id IS NULL 
      AND tamozhdoc.pid = '||Str(nPID) )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23885
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 24
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23886
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 -  Group Box: Контракт
.head 4 -  Resource Id: 53435
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: №:
.head 4 -  Resource Id: 29702
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.345"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.321"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата:
.head 4 -  Resource Id: 29703
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.595"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDATC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.571"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма:
.head 4 -  Resource Id: 59533
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.845"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSUMC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.821"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Страна:
.head 4 -  Resource Id: 59534
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.095"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBENEFC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    1.071"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Бенеф.:
.head 4 -  Resource Id: 59531
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.345"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBENEFN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    1.321"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 29701
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.183"
.head 5 -  Begin Y:  1.655"
.head 5 -  End X:  4.283"
.head 5 -  End Y:  1.655"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 3
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Долг по ПЛ:
.head 4 -  Resource Id: 29705
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.762"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOST_PL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    1.738"
.head 6 -  Width:  1.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfOST_PLs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    1.738"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Аванс.ТД:
.head 4 -  Resource Id: 13875
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.012"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAVAND_TD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    1.988"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Group Box: Подтверждения НБУ
.head 4 -  Resource Id: 32962
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.583"
.head 5 -  Top:    0.071"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfConfirmNote
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.321"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Child Table: tblC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.571"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NAMEC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
подтверждения
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
подтвержд.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If NOT SalIsNull( ZAY_EC.tblC.DATC )
.head 9 -  Set ZAY_EC.tblC.DAT90C = ZAY_EC.tblC.DATC + nNBU_SROK - 2
.head 5 +  Column: DAT90C
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Действит.
    до
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: sPopulate
.head 5 -  Number: nRowCount
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set nRowCount = 0
.head 6 -  Set sPopulate = 
   "SELECT confirm, date_c
      INTO :ZAY_EC.tblC.NAMEC,
           :ZAY_EC.tblC.DATC
      FROM nbu_contr       
     WHERE pid = :ZAY_EC.nPID
     ORDER BY 2 DESC"
.head 6 -  Call SalTblPopulate(ZAY_EC.tblC, hSql(), sPopulate, TBL_FillAll)
.head 6 +  If nRowCount = 0
.head 7 -  Call SalTblInsertRow( ZAY_EC.tblC, 0 )
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(),
   "SELECT max(date_c) 
      INTO :dDatActual 
      FROM nbu_contr 
     WHERE pid=:ZAY_EC.nPID AND date_c <= :ZAY_EC.dBD")
and SqlFetchNext( hSqlAux2(), nFetchRes ) 
.head 7 +  If dDatActual = DATETIME_Null
.head 8 -  Set dfConfirmNote = 'Отсутствует или просрочено!'
.head 8 -  Call SalColorSet( dfConfirmNote, COLOR_IndexWindowText, COLOR_Red )
.head 7 +  Else
.head 8 +  If dDatActual > dBD
.head 9 -  Set dfConfirmNote ='Срок действия не наступил!'
.head 9 -  Call SalColorSet( dfConfirmNote, COLOR_IndexWindowText, COLOR_Red )
.head 8 +  Else
.head 9 +  If dDatActual + nNBU_SROK - 1 - dBD < 0
.head 10 -  Set dfConfirmNote = 'Просрочено!'
.head 10 -  Call SalColorSet( dfConfirmNote, COLOR_IndexWindowText, COLOR_Red )
.head 9 +  Else If dDatActual + nNBU_SROK - 1 - dBD = 0
.head 10 -  Set dfConfirmNote = 'Последний день!'
.head 10 -  Call SalColorSet( dfConfirmNote, COLOR_IndexWindowText, COLOR_Blue )
.head 9 +  Else If dDatActual + nNBU_SROK - 1 - dBD > 0
.head 10 -  Set dfConfirmNote = 'Осталось '||SalNumberToStrX( dDatActual + nNBU_SROK - 1 - dBD, 0 )||'дн.'
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set nRowCount = nRowCount + 1
.head 6 -  Set ZAY_EC.tblC.DAT90C = ZAY_EC.tblC.DATC + ZAY_EC.nNBU_SROK - 2
.head 6 -  ! Актуальные подтверждения - желтый фон
.head 6 +  If ZAY_EC.tblC.DATC   <= ZAY_EC.dBD AND 
   ZAY_EC.tblC.DAT90C >= ZAY_EC.dBD
.head 7 -  Call XSalTblSetRowBackColor( ZAY_EC.tblC, lParam, COLOR_Yellow )
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( ZAY_EC.tblC, nRow, ROW_Edited, 0 )
.head 7 -  Call SalTblSetContext( ZAY_EC.tblC, nRow )
.head 7 +  If ZAY_EC.tblC.NAMEC != STRING_Null AND ZAY_EC.tblC.DATC != DATETIME_Null
.head 8 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT count(*) 
     INTO :ZAY_EC.nTmp  
     FROM nbu_contr
    WHERE pid=:ZAY_EC.nPID AND date_c=:ZAY_EC.tblC.DATC" )
AND SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If nTmp > 0
.head 10 +  If SqlPrepareAndExecute( hSql(), 
  "UPDATE nbu_contr SET 
         confirm = :ZAY_EC.tblC.NAMEC
    WHERE    pid = :ZAY_EC.nPID AND 
             rnk = :ZAY_EC.nRNK AND 
          date_c = :ZAY_EC.tblC.DATC" )
.head 11 -  Call SqlCommit( hSql() )
.head 9 +  Else
.head 10 +  If SqlPrepareAndExecute( hSql(), 
  "INSERT INTO nbu_contr 
       (pid, rnk, confirm, date_c) 
   VALUES 
       (:ZAY_EC.nPID,      :ZAY_EC.nRNK,
        :ZAY_EC.tblC.NAMEC,:ZAY_EC.tblC.DATC)")
.head 11 -  Call SqlCommit( hSql() )
.head 6 -  Call SalSendMsg( ZAY_EC.tblC, SAM_Create, 0, 0 )
.head 3 -  !
.head 3 -  Group Box: Справки из НИ
.head 4 -  Resource Id: 32961
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    2.405"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNalNote
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    2.655"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '"Срок годности" справки' )
.head 3 -  Background Text: Резерв в вал.З:
.head 4 -  Resource Id: 3427
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    2.679"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOSTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    2.655"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Резерв по данной валюте' )
.head 3 -  Background Text: в др.вал.:
.head 4 -  Resource Id: 3426
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.083"
.head 5 -  Top:    2.702"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOSTQN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.083"
.head 6 -  Top:    2.655"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Резерв (др.валюты)' )
.head 3 +  Child Table: tblN
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableFrm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    2.905"
.head 6 -  Width:  9.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: IDN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
справки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 20
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMEN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № 
справки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 20
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DATN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
справки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT90N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата + 90
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set S100N = SN*SalNumberPower(10, DIG)
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: S100N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SNs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsValidNumber(SNs)
.head 9 -  Set SN    = Val(SNs)
.head 9 -  Set S100N = Val(SNs)*SalNumberPower(10, DIG)
.head 8 +  Else
.head 9 -  Set SNs = Dig4(SN*SalNumberPower(10,DIG)/100,DIG,4)
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: KVN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вал
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SqlPrepareAndExecute( hSqlAux(), 
  "SELECT name 
     INTO :ZAY_EC.tblN.NAMVN 
     FROM tabval 
    WHERE to_char(kv)="||Str(KVN) ) 
and not SqlFetchNext( hSqlAux(), nFetchRes )
.head 9 -  Return VALIDATE_Cancel
.head 5 +  Column: NAMVN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
валюты
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DIG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: dig
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_TblDoDetails
.head 6 -  ! Срок действия справки
.head 6 +  If SqlPrepareAndExecute(hSqlAux(), 
  "SELECT max(nal_date) 
     INTO :dDatActualNal
     FROM cust_nal 
    WHERE nal_date <= :ZAY_EC.dBD AND
                rnk = :ZAY_EC.nRNK  AND 
                 kv = :ZAY_EC.nKVZ  AND 
                pid = :ZAY_EC.nPID ")
and SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 +  If dDatActualNal = DATETIME_Null
.head 8 -  Set dfNalNote = 'Справка отсутствует или просрочена!'
.head 8 -  Call SalColorSet( dfNalNote, COLOR_IndexWindowText, COLOR_Red )
.head 7 +  Else
.head 8 +  If dDatActualNal > dBD
.head 9 -  Set dfNalNote ='Срок действия не наступил!'
.head 9 -  Call SalColorSet( dfNalNote, COLOR_IndexWindowText, COLOR_Red )
.head 8 +  Else
.head 9 +  If dDatActualNal + nNAL_SROK - 1 - dBD < 0
.head 10 -  Set dfNalNote = 'Просрочена!'
.head 10 -  Call SalColorSet( dfNalNote, COLOR_IndexWindowText, COLOR_Red )
.head 9 +  Else If dDatActualNal + nNAL_SROK - 1 - dBD = 0
.head 10 -  Set dfNalNote = 'Последний день!'
.head 10 -  Call SalColorSet( dfNalNote, COLOR_IndexWindowText, COLOR_Blue )
.head 9 +  Else If dDatActualNal + nNAL_SROK - 1 - dBD > 0
.head 10 -  Set dfNalNote = 'Осталось дней: '||SalNumberToStrX( dDatActualNal + nNAL_SROK - 1 - dBD, 0 )
.head 6 -  !
.head 6 -  ! Контроль сумм в данной валюте
.head 6 +  If SqlPrepareAndExecute(hSqlAux(), 
  "SELECT bars.f_zaynal(:ZAY_EC.nRNK,:ZAY_EC.nKVZ,:ZAY_EC.dBD,:ZAY_EC.nPID,'') 
     INTO :ZAY_EC.dfOSTN 
     FROM dual")
and SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 -  Set ZAY_EC.dfOSTN = (ZAY_EC.dfOSTN - ZAY_EC.nSUMZ)/SalNumberPower(10, nDigZ) 
.head 7 +  If ZAY_EC.dfOSTN >= ZAY_EC.nSUMZ/SalNumberPower(10, nDigZ) 
.head 8 -  Call SalColorSet( ZAY_EC.dfOSTN, COLOR_IndexWindowText, COLOR_DarkBlue )
.head 7 +  Else
.head 8 -  Call SalColorSet( ZAY_EC.dfOSTN, COLOR_IndexWindowText, COLOR_Red )
.head 6 -  ! Зазор сумм в других валютах
.head 6 +  If SqlPrepareAndExecute( hSqlAux(),
   "SELECT sum(gl.p_ncurval
                (:ZAY_EC.nKVZ,
                  gl.p_icurval
                    (kv,
                     f_zaynal(:ZAY_EC.nRNK,kv,:ZAY_EC.dBD,:ZAY_EC.nPID,''),
                     :ZAY_EC.dBD),
                :ZAY_EC.dBD))/100  
    INTO :ZAY_EC.dfOSTQN
    FROM cust_nal 
    WHERE rnk = :ZAY_EC.nRNK AND 
          pid = :ZAY_EC.nPID AND
          kv <> :ZAY_EC.nKVZ AND 
          nal_date = 
            (SELECT max(nal_date) FROM cust_nal 
              WHERE rnk       = :ZAY_EC.nRNK AND 
                    pid       = :ZAY_EC.nPID AND         
                    kv       <> :ZAY_EC.nKVZ AND 
                    nal_date <= :ZAY_EC.dBD)")
.head 7 -  Call SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 +  If dfOSTQN >= 0
.head 8 -  Call SalColorSet( dfOSTQN, COLOR_IndexWindowText, COLOR_DarkBlue )
.head 7 +  Else
.head 8 -  Call SalColorSet( dfOSTQN, COLOR_IndexWindowText, COLOR_Red )
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set SNs = Dig4(SN*SalNumberPower(10,DIG)/100,DIG,4)
.head 6 -  Set ZAY_EC.tblN.DAT90N = ZAY_EC.tblN.DATN + nNAL_SROK - 2
.head 6 -  ! Актуальные подтверждения - желтый фон
.head 6 +  If ZAY_EC.tblN.DATN   <= ZAY_EC.dBD AND 
   ZAY_EC.tblN.DAT90N >= ZAY_EC.dBD
.head 7 -  Call XSalTblSetRowBackColor( ZAY_EC.tblN, lParam, COLOR_Yellow )
.head 2 +  Functions
.head 3 +  Function: F_CrossRate
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nKvA
.head 5 -  Number: nKvB
.head 5 -  Date/Time: dDat
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRateO
.head 5 -  Number: nRateB
.head 5 -  Number: nRateS
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand( hSql(),"gl.x_rat(nRateO,nRateB,nRateS,nKvA,nKvB,dDat)" )
.head 6 -  Return 0
.head 5 +  Else
.head 6 -  Return nRateO
.head 2 +  Window Parameters
.head 3 -  Number: nRNK
.head 3 -  Number: nPID
.head 3 -  Number: nIDZ
.head 2 +  Window Variables
.head 3 -  ! банк.дата
.head 3 -  Date/Time: dBD
.head 3 -  ! срок годности справки из НИ
.head 3 -  Number: nNAL_SROK
.head 3 -  ! срок годности подтверждения НБУ
.head 3 -  Number: nNBU_SROK
.head 3 -  ! дата актуального подтверждения НБУ
.head 3 -  Date/Time: dDatActual
.head 3 -  ! дата актуальной справки НИ
.head 3 -  Date/Time: dDatActualNal
.head 3 -  ! валюта заявки
.head 3 -  Number: nKVZ
.head 3 -  ! сумма заявки в коп.
.head 3 -  Number: nSUMZ
.head 3 -  ! валюта контракта
.head 3 -  Number: nKVC
.head 3 -  String: sKVC
.head 3 -  ! сумма контракта в коп.
.head 3 -  Number: nSUMC
.head 3 -  ! Наименование клиента
.head 3 -  String: sNMK
.head 3 -  ! общая сумма платежей по контракту в коп.
.head 3 -  Number: nSUMPL
.head 3 -  ! общая сумма аванс.ТД по контракту в коп.
.head 3 -  Number: nSUMTD
.head 3 -  Number: nDigZ
.head 3 -  Number: nDigC
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  Date/Time: dMAXDATN
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set dBD = GetBankDate(  )
.head 4 -  Call BIRZA( 'NAL_SROK', nNAL_SROK )
.head 4 -  Call BIRZA( 'NBU_SROK', nNBU_SROK )
.head 4 -  ! Реквизиты введенной заявки
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT nmk, kv2, s2, dig
     INTO :ZAY_EC.sNMK,:ZAY_EC.nKVZ,:ZAY_EC.nSUMZ,:ZAY_EC.nDigZ
     FROM v_zay
    WHERE id = :ZAY_EC.nIDZ" )
AND SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Call SalSetWindowText( hWndForm, 'Валютный контроль. Клиент '||ZAY_EC.sNMK)
.head 4 -  ! Параметры контракта
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT t.name, t.dateopen, t.kv, v.lcv, t.s, v.dig,
          c.name, t.benefname
     INTO :ZAY_EC.dfNAME,  :ZAY_EC.dfDATC,  :ZAY_EC.nKVC,
          :ZAY_EC.sKVC,    :ZAY_EC.nSUMC,   :ZAY_EC.nDigC,
          :ZAY_EC.dfBENEFC,:ZAY_EC.dfBENEFN 
   FROM top_contracts t, country c, tabval v
   WHERE t.benefcountry=c.country(+) AND 
         t.kv=v.kv                   AND
         t.pid=:ZAY_EC.nPID" )
AND SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set dfSUMC = Dig4( nSUMC/100, nDigC, nDigC )||' '||sKVC
.head 4 -  ! Остаток проплат по контракту в вал.контракта
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT sum(round(s*kurs))
     INTO :ZAY_EC.nSUMPL
     FROM contract_p
    WHERE pid=:ZAY_EC.nPID" )
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set ZAY_EC.nSUMPL = 0
.head 4 -  Set dfOST_PL  = (nSUMC - nSUMPL) / SalNumberPower(10, nDigC)
.head 4 -  Set dfOST_PLs = Dig4( dfOST_PL/100, nDigC, nDigC )||' '||sKVC
.head 4 +  If nSUMZ/SalNumberPower(10, nDigZ) > dfOST_PL
.head 5 -  Call SalColorSet( dfOST_PLs, COLOR_IndexWindowText, COLOR_Red )
.head 4 -  ! Сумма авансовых ТД по контракту в вал.контракта
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT sum(round(s/kurs)) 
     INTO :ZAY_EC.nSUMTD
     FROM tamozhdoc  
    WHERE id IS NULL AND pid=:ZAY_EC.nPID" )
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set ZAY_EC.nSUMTD = 0
.head 4 -  Set dfAVAND_TD = Dig4( nSUMTD/100, nDigC, nDigC )||' '||sKVC
.head 4 -  !
.head 4 -  Set hWndForm.ZAY_EC.strSqlPopulate =  
   "SELECT n.nal_id, n.nal_note, n.nal_date, 
           n.s/power(10,dig), n.s, n.kv, t.name, t.dig  
      INTO :hWndForm.tblN.IDN,:hWndForm.tblN.NAMEN,
           :hWndForm.tblN.DATN,:hWndForm.tblN.SN, 
           :hWndForm.tblN.S100N,:hWndForm.tblN.KVN,
           :hWndForm.tblN.NAMVN,:hWndForm.tblN.DIG
      FROM cust_zay z, cust_nal n, tabval t
     WHERE z.rnk=n.rnk                 AND 
           n.kv=t.kv                   AND 
           n.rnk=:hWndForm.ZAY_EC.nRNK AND
           n.pid=:hWndForm.ZAY_EC.nPID 
     ORDER BY n.nal_date, n.kv"
.head 4 -  !
.head 4 -  Set hWndForm.ZAY_EC.strSqlInsert =
   "INSERT INTO cust_nal 
     (nal_id, rnk, pid, contract, dat_contr, 
      nal_note, nal_date, s, kv) 
    VALUES 
     (0,                          :hWndForm.ZAY_EC.nRNK,       
      :hWndForm.ZAY_EC.nPID,      :hWndForm.ZAY_EC.dfNAME,    
      :hWndForm.ZAY_EC.dfDATC,    :hWndForm.tblN.NAMEN,
      :hWndForm.tblN.DATN,        :hWndForm.tblN.S100N, 
      :hWndForm.tblN.KVN)"       
.head 4 -  !
.head 4 -  Set hWndForm.ZAY_EC.strSqlUpdate =
   "UPDATE cust_nal SET               
            nal_note = :hWndForm.tblN.NAMEN, 
            nal_date = :hWndForm.tblN.DATN,      
                   s = :hWndForm.tblN.S100N, 
                  kv = :hWndForm.tblN.KVN,
            contract = :hWndForm.ZAY_EC.dfNAME,
           dat_contr = :hWndForm.ZAY_EC.dfDATC
    WHERE     nal_id = :hWndForm.tblN.IDN"       
.head 4 -  !
.head 4 -  Set hWndForm.ZAY_EC.strSqlDelete =
   "DELETE FROM cust_nal WHERE nal_id =:hWndForm.tblN.IDN"       
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg( ZAY_EC.tblN, UM_Update, 0, 0 )
.head 4 -  Call SalSendMsg( ZAY_EC.tblC, UM_Update, 0, 0 )
.head 1 +  Dialog Box: dlgD39
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.567"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.595"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Group Box: Выберите значение показателя D#39:
.head 4 -  Resource Id: 28053
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    1.857"
.head 5 -  Width:  5.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfINDEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.567"
.head 6 -  Top:    2.143"
.head 6 -  Width:  0.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfINDEX)
.head 7 -  Set dfINDEX = STRING_Null
.head 7 -  Set cmbINDEX = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cmbINDEX.SetSelectById(dfINDEX)
.head 6 +  If cmbINDEX.strCurrentId
.head 7 -  Call SalSendMsg(cmbINDEX, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox('Указано некорректное значение показателя!', 'Ошибка', MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbINDEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.3"
.head 5 -  Top:    2.143"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbINDEX.Init(hWndItem)
.head 6 -  Call cmbINDEX.Populate(hSql(), "KOD", "NAIM", "KF39", " WHERE DK IN (0, "||Str(pDK)||") ORDER BY KOD")
.head 6 -  Call cmbINDEX.SetSelectById(dfINDEX)
.head 5 +  On SAM_Click
.head 6 -  Set dfINDEX = cmbINDEX.GetKey(SalListQuerySelection(hWndItem))
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    2.667"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull(dfINDEX)  
.head 7 +  If SalMessageBox('Не заполнено значение показателя D#39. Продолжить?', 
                 'Внимание', 
                 MB_IconQuestion | MB_YesNo) = IDYES 
.head 8 -  Set pD39 = STRING_Null
.head 8 -  Call SalEndDialog(hWndForm, TRUE)
.head 7 +  Else
.head 8 -  Call SalSetFocus(cmbINDEX)
.head 6 +  Else
.head 7 -  Set pD39 = dfINDEX
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.95"
.head 5 -  Top:    2.667"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  !
.head 3 +  Data Field: dfTITLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.667"
.head 6 -  Top:    0.143"
.head 6 -  Width:  3.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Тип:  
.head 4 -  Resource Id: 40108
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.655"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    0.655"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Клиент:  
.head 4 -  Resource Id: 40109
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.905"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCUSTOMER
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    0.905"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Валюта:  
.head 4 -  Resource Id: 40110
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.155"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCURRENCY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    1.155"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма:  
.head 4 -  Resource Id: 40106
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.405"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAMOUNT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    1.405"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 40111
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    0.524"
.head 5 -  Width:  5.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.274"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: pDK           !! 1-покупка 2-продажа 
.head 3 -  Number: pID
.head 3 -  Number: pAMOUNT
.head 3 -  String: pCURRENCY
.head 3 -  String: pCUSTOMER
.head 3 -  Receive String: pD39
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(dlgD39)
.head 4 -  Set dfTITLE    = 'Заявка № '||Str(pID)
.head 4 -  Set dfTYPE     = IifS(pDK = 1, 'Покупка', 'Продажа')
.head 4 -  Set dfCUSTOMER = pCUSTOMER
.head 4 -  Set dfCURRENCY = pCURRENCY
.head 4 -  Set dfAMOUNT   = pAMOUNT
.head 4 -  Call SalSetFocus(cmbINDEX)
.head 1 +  Dialog Box: dlgPartSum
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Разбиение заявки
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.7"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Ид.заявки
.head 4 -  Resource Id: 34171
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.15"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.1"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма заявки
.head 4 -  Resource Id: 34172
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.45"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.4"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 34175
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.75"
.head 5 -  End X:  5.7"
.head 5 -  End Y:  0.75"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Background Text: Сумма заявки 1
.head 4 -  Resource Id: 34173
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.9"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.85"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма заявки 2
.head 4 -  Resource Id: 34174
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.2"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    1.15"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 34176
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  1.5"
.head 5 -  End X:  5.7"
.head 5 -  End Y:  1.5"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разбить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.7"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If CheckSum()
.head 7 +  If SqlPLSQLCommand(hSql(), "bars_zay.p_zay_multiple(dfID, dfS1, dfS2)")
.head 8 -  Call SqlCommitEx(hSql(), "Разбита заявка " || Str(dfID))
.head 8 +  If REQ_ID
.head 9 -  Call SalMessageBox('В РУ отправлен запрос на разбиение заявки', 'Сообщение', MB_IconAsterisk | MB_Ok)
.head 8 -  Call SalEndDialog(hWndForm, TRUE)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.9"
.head 5 -  Top:    1.7"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 +  Functions
.head 3 +  Function: CheckSum
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalIsNull(dfS1)
.head 6 -  Call SalMessageBox("Не заполнено поле суммы!", "Ошибка!", MB_IconStop | MB_Ok)
.head 6 -  Call SalSetFocus(dfS1)
.head 6 -  Return FALSE
.head 5 +  If dfS1 = 0 or dfS1 < 0
.head 6 -  Call SalMessageBox("Сумма должна быть больше 0!", "Ошибка!", MB_IconStop | MB_Ok)
.head 6 -  Call SalSetFocus(dfS1)
.head 6 -  Return FALSE
.head 5 +  If SalIsNull(dfS2)
.head 6 -  Call SalMessageBox("Не заполнено поле суммы!", "Ошибка!", MB_IconStop | MB_Ok)
.head 6 -  Call SalSetFocus(dfS2)
.head 6 -  Return FALSE
.head 5 +  If dfS2 = 0 or dfS2 < 0
.head 6 -  Call SalMessageBox("Сумма должна быть больше 0!", "Ошибка!", MB_IconStop | MB_Ok)
.head 6 -  Call SalSetFocus(dfS2)
.head 6 -  Return FALSE
.head 5 +  If dfS1 + dfS2 != dfS
.head 6 -  Call SalMessageBox("Введенная сумма заявок не равна сумме основной заявки!", "Ошибка!", MB_IconStop | MB_Ok)
.head 6 -  Call SalSetFocus(dfS1)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: ID
.head 3 -  Number: REQ_ID
.head 3 -  Number: S
.head 3 -  String: ISO
.head 3 -  Number: DIG
.head 2 +  Window Variables
.head 3 -  String: sFormat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, "Разбиение заявки " || Str(ID))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set sFormat = '# ##0' || SalStrMidX(SalNumberToStrX(1.1,1),1,1) || SalStrRepeatX('0', DIG)
.head 4 -  Set dfID = ID
.head 4 -  Set dfS  = S/SalNumberPower(10,DIG)
.head 4 -  Call SalFmtSetPicture(dfS, sFormat)
.head 4 -  Call SalFmtSetPicture(dfS1, sFormat)
.head 4 -  Call SalFmtSetPicture(dfS2, sFormat)
.head 1 +  Table Window: ZAY_CONV
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ПРОСМОТР ЗАЯВОК НА КОНВЕРСИЮ 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  15.95"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Просмотр заявок на конверсию (из CORP2)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 64907
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.967"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilterEx(cF_CONV)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 64908
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.4"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  3.4"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.967"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 64909
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.817"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  2.817"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbPrintZay
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.27"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrintZayCorp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Просмотр и печать заявки CORP2"
.head 6 +  On SAM_Click
.head 7 -  Set sFileName = GetPrnDir()||'\\'||'Z_'||SalStrRightX('000000'||SalStrTrimX(Str(ZAY_CONV.ZAY_ID)),6)||'.DOC'
.head 7 +  If NOT PutBlobToFile(
          hSql(),          sFileName,          'v_zay_conversion',          'doc_id',          'doc_desc',          ZAY_CONV.ZAY_ID,          '',          '')
.head 8 -  Call SalFileOpen(hFile, sFileName, OF_Delete)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return FALSE
.head 7 +  If sFileName != STRING_Null
.head 8 -  ! Set nPrint = SalMessageBox('Для ПРОСМОТРА нажмите кнопку Да(Yes), '||PutCrLf(  )||
                           'для ПЕЧАТИ    нажмите кнопку Нет (No) '||PutCrLf(  )||
                           'для ОТМЕНЫ    нажмите кнопку Отменить (Cancel)',
                           'Печать сформированной заявки', 
                           MB_IconQuestion|MB_YesNoCancel )
.head 8 -  Set nPrint=SalMessageBox( 'Для ПРОСМОТРА и ПЕЧАТИ нажмите кнопку Да(Yes), '||PutCrLf(  )||
                          'для ОТМЕНЫ    нажмите кнопку Нет(No)',
                          'Просмотр и печать заявки CORP2', 
                          MB_IconQuestion|MB_YesNo )
.head 8 +  If nPrint = IDYES
.head 9 -  Call SalLoadAppAndWait(GetEditorPath() || " " || sFileName, Window_NotVisible,  nRet)
.head 9 -  ! Call DirectView(sFileName)
.head 2 +  Contents
.head 3 +  Column: ZAY_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид.заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ZAY_NUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ZAY_DATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РНК
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1_MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
счета
      П    О
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1_NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
валюты
 К     У     П
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Валюта
К     И
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV1_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
в вал ПОКУПКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  3.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV2_MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
счета
      П     Р 
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV2_NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
валюты
О      Д      А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Валюта
Ж      И
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CROSS_KURS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кросс-курс
вал ПОКУПКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COMISS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
комиссии
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: META_TEXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цель
конверсии
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cF_CONV
.head 4 -  Class: cGenFilterEx
.head 3 -  String: strDynSql
.head 3 -  Number: nPR_CORP2
.head 3 -  String: sFileName
.head 3 -  Number: nPrint
.head 3 -  Number: nRet
.head 3 -  File Handle: hFile
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set ZAY_CONV.strPrintFileName='ZAY_CONV'
.head 4 -  Set ZAY_CONV.fFilterAtStart=TRUE
.head 4 -  Set ZAY_CONV.strFilterTblName='V_ZAY_CONVERSION'
.head 4 -  !
.head 4 -  Call BIRZA( 'PR_CORP2',   nPR_CORP2  )
.head 4 -  !
.head 4 +  If nPR_CORP2 = 1 
.head 5 -  Call SalShowWindow(pbPrintZayCorp)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbPrintZayCorp)
.head 4 -  !
.head 4 -  !
.head 4 -  ! Set ZAY_CONV.strSqlPopulate =
"SELECT DOC_ID,  CUST_ID, c.nmk, PAYER_ACCOUNT, t2.lcv, PAYER_BANK_CODE, PAYEE_ACCOUNT, t1.lcv,  PAYEE_BANK_CODE,
   PURCHASING_CUR_RATE, PURCHASING_COMISS,  PURCHASING_REASON, DOC_SUM, DOC_NUMBER, DOC_DATE
   INTO :ZAY_CONV.ZAY_ID, :ZAY_CONV.RNK, :ZAY_CONV.NMK, :ZAY_CONV.KV2_NLS, :ZAY_CONV.KV2, :ZAY_CONV.KV2_MFO,
        :ZAY_CONV.KV1_NLS, :ZAY_CONV.KV1, :ZAY_CONV.KV1_MFO, 
        :ZAY_CONV.CROSS_KURS, :ZAY_CONV.COMISS, :ZAY_CONV.META_TEXT, :ZAY_CONV.KV1_SUM, :ZAY_CONV.ZAY_NUM,
        :ZAY_CONV.ZAY_DATE
   FROM V_ZAY_CONVERSION, customer c, tabval t1, tabval t2
  WHERE c.rnk = cust_id
    AND PAYEE_CURRENCY = t1.kv
    AND PAYER_CURRENCY = t2.kv
  ORDER BY doc_id desc"       
.head 4 -  Set ZAY_CONV.strSqlPopulate =
"SELECT /*+ index(v.e I_DOCEXPORT_TYPEID) */ v.DOC_ID,
         v.CUST_ID,
         c.nmk,
         v.PAYER_ACCOUNT,
         t2.lcv,
         v.PAYER_BANK_CODE,
         v.PAYEE_ACCOUNT,
         t1.lcv,
         v.PAYEE_BANK_CODE,
         v.PURCHASING_CUR_RATE,
         v.PURCHASING_COMISS,
         v.PURCHASING_REASON,
         v.DOC_SUM,
         v.DOC_NUMBER,
         v.DOC_DATE
   INTO :ZAY_CONV.ZAY_ID, :ZAY_CONV.RNK, :ZAY_CONV.NMK, :ZAY_CONV.KV2_NLS, :ZAY_CONV.KV2, :ZAY_CONV.KV2_MFO,
        :ZAY_CONV.KV1_NLS, :ZAY_CONV.KV1, :ZAY_CONV.KV1_MFO, 
        :ZAY_CONV.CROSS_KURS, :ZAY_CONV.COMISS, :ZAY_CONV.META_TEXT, :ZAY_CONV.KV1_SUM, :ZAY_CONV.ZAY_NUM,
        :ZAY_CONV.ZAY_DATE
   FROM bars.V_ZAY_CONVERSION v,
         bars.customer c,
         bars.tabval t1,
         bars.tabval t2
   WHERE     c.rnk = v.cust_id
         AND v.PAYEE_CURRENCY = t1.kv
         AND v.PAYER_CURRENCY = t2.kv
   ORDER BY v.doc_id DESC"       
.head 4 -  Call cF_CONV.Init('V_ZAY_CONVERSION', '')
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  ! On SAM_TblDoDetails
.head 4 -  Call SalEnableWindow(pbPrintZayCorp)
.head 4 +  ! If ZAY2.KB != STRING_Null
.head 5 -  Call SalEnableWindow(pbPrintZayCorp)
.head 4 +  ! Else
.head 5 -  Call SalDisableWindow(pbPrintZayCorp)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call ZAY_CONV.cF_CONV.cSimpleFilter.NewString('DOC_DATE',SalFmtFormatDateTime(GetBankDate(), 'dd.MM.yyyy'))
.head 4 +  If SetQueryFilterEx(cF_CONV)
.head 5 +  If cF_CONV.GetFilterWhereClause(TRUE) != ''
.head 6 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Else
.head 5 -  Call SalPostMsg(pbExit, SAM_Click, 0, 0)
.head 3 +  ! On UM_Populate
.head 4 +  If strSqlPopulate != ''
.head 5 +  If fFilterAtStart
.head 6 +  If SetQueryFilterEx(cF_CONV)
.head 7 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT fFilterAtStart
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Set strDynSql = cQ.GetFullSQLStringEx(cF_CONV)
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), strDynSql, nTabPopulateMethod)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  Else 
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  !
.head 4 -  Call cQ.Init(ZAY_CONV.strSqlPopulate)
.head 4 -  Set strDynSql = cQ.GetFullSQLStringEx(cF_CONV)
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), strDynSql, TBL_FillAll)
.head 4 -  !
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Dialog Box: dlg_Kurs
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Курс
.head 4 -  Resource Id: 59273
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.1"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfKurs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    0.4"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 59274
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.1"
.head 5 -  Begin Y:  0.8"
.head 5 -  End X:  3.7"
.head 5 -  End Y:  0.8"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfKurs
.head 7 -  Set nKurs = dfKurs
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 6 +  Else
.head 7 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.1"
.head 5 -  Top:    1.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nKv1
.head 3 -  Number: nKv2
.head 3 -  Receive Number: nKurs
.head 2 +  Window Variables
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 +  If nKv2 = NUMBER_Null
.head 5 -  Call SalSetWindowText(hWndForm, 'Валюта ' || Str(nKv1))
.head 4 +  Else
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select kv_base into :nTmp from zay_conv_kv where kv1 = :nKv1 and kv2 = :nKv2")
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select kv_base into :nTmp from zay_conv_kv where kv1 = :nKv2 and kv2 = :nKv1")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalSetWindowText(hWndForm, 'Пара валют ' || Str(nKv1) || '/' || Str(nKv2) || ' (' || Str(nTmp) || ')')
.head 1 +  Dialog Box: dlg_Comments
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Коментар
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlComm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.05"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 7943
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.4"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Записати
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    1.55"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If mlComm
.head 7 -  Set sComment = mlComm
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Не заповнено коментар!', 'Увага!', MB_IconExclamation)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмінити
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    1.55"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sComment
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
