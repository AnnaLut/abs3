.head 0 +  Application Description: METABASE.APD -  MetaBase Developing Function Library
! //////////////////////////////////////////////////
! ООО Унити-Барс  (C)  1996-1998
! Разработчик: Сыропоршнев Д.Л.
! //////////////////////////////////////////////////
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B20000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFF2C0000 002E000000960200 00E0010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730C7769
0080: 6E5F4D6574614564 6974
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001E51 3A5C424152533938 5C4C494252415259 5C4D455441424153
0020: 452E646C6C1E513A 5C4241525339385C 4C4942524152595C 4D45544142415345
0040: 2E61706300000101 011E513A5C424152 5339385C4C494252 4152595C4D455441
0060: 424153452E72756E 1E513A5C42415253 39385C4C49425241 52595C4D45544142
0080: 4153452E646C6C1E 513A5C4241525339 385C4C4942524152 595C4D4554414241
00A0: 53452E6170630000 010101185C424152 5339385C42494E5C 6D65746162617365
00C0: 2E617064185C4241 525339385C42494E 5C6D657461626173 652E646C6C185C42
00E0: 41525339385C4249 4E5C6D6574616261 73652E6170630001 010101001E513A5C
0100: 4241525339385C4C 4942524152595C4D 455441424153452E 646C6C1E513A5C42
0120: 41525339385C4C49 42524152595C4D45 5441424153452E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0000000000000000 0000E91EB20C0500 1D00FFFF4D61696E
0020: 0029000100000000 0000000000E91E80 0A00008600FFFF49 6E7465726E616C20
0040: 46756E6374696F6E 7300200001000000 000000000000E91E 800A0000DF00FFFF
0060: 5661726961626C65 73001E0001000000 000000000000F51E 100D0000F400FFFF
0080: 436C617373657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? Yes
.head 3 -  Left:   6.4"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Dfltrapi.apd
.head 2 -  !
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: Genemnu.apl
.head 2 -  File Include: Vttblwin.apl
.head 2 -  File Include: Vtstr.apl
.head 2 -  File Include: Vtsplit.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: GENLABEL.APL
.head 2 -  File Include: GENTBLS.APL
.head 2 -  File Include: GENTBLD.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Window Color
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: System Window Color
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  !
.head 4 -  Number: AM_MtrMove = SAM_User + 150
.head 3 +  User
.head 4 -  Number: UTbl_Populate = 0
.head 4 -  Number: UTbl_Insert = 1
.head 4 -  Number: UTbl_Delete = 2
.head 4 -  Number: UTbl_Update = 3
.head 4 -  Number: UTbl_UnDelete = 4
.head 4 -  Number: UTbl_Print = 5
.head 4 -  Number: UTbl_Sort = 6
.head 4 -  !
.head 4 -  Number: GET_TABLE	= 0
.head 4 -  Number: GET_COLUMN	= 1
.head 4 -  Number: NULL_ID		= -1
.head 4 -  !
.head 4 -  Number: MSync_Equal	= 0	! Совпадают
.head 4 -  Number: MSync_Absent	= 1	! Отсутсвует в противоположном списке
.head 4 -  Number: MSync_Different	= 2	! Имеет другие аргументы
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Number: nFetchRes
.head 3 -  Sql Handle: hSqlLocal
.head 3 -  Boolean: fInitLib
.head 2 +  Internal Functions
.head 3 +  Function: MetaBase_Init
.head 4 -  Description: Инициализация лингвистической таблицы и прочего
для библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fInitLib
.head 6 -  ! To set constraction mode uncomment below
.head 6 -  ! Set CurrentLangTable.fConstructMode = TRUE
.head 6 -  !
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\metabase.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTAt', 'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTInfo','Информация')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('cTErr1','Описание таблицы отсутствует в Мета-Базе')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr2','Таблица метаописаний не заполнена')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('cTDoubleClick','Double Click - для изменения значения')
.head 7 -  ! ====================================================
.head 7 -  ! win_MetaEdit
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTWndTitle','МетаОписание таблиц АБС "БАРС Millennium"')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipInsert', 'Вставить новую запись')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipDelete', 'Отметить запись как удаленную')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipSwitch', 'Переключится между окнами-таблицами')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipUpdate', 'Внести изменения в БД')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipSearch', 'Искать строку по значению ключевого поля')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipPrint',  'Печатать атрибуты и поля текущей таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipGetCols','Показать поля таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipComplexCol',  'Показать связь "сложного поля"')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipShowBrwField','Показать "чужие" поля доступные для динамического запроса')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipSortOrder',   'Установить порядок сортировки при населении данных из таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipSync','Синхронизировать таблицу с системными записями')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipShowFltTbl','Показать связь с вложенными таблицами')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipShowFltFilter','Показать фильтры на вложенные таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipShowActTbl','Показать процедуры для таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipNsiFunction','Показать функции для справочника')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipRef','Добавить таблицу в справочник')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipSave','Сохранить МетаОписание в скрипт')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cBTipExit','Выйти')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblTables.colID',       'Код~таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblTables.colName',     'Наименование~таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblTables.colSemantic', 'Семантическое описание~таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblTables.colLinesDef', 'Количество строк~по умолчанию')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblTables.colRelTab',   'Описывает~отношение')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colID',               'Код~поля')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colName',             'Наименование~поля')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colSemantic',         'Семантическое описание~поля')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colType',             'TypeID')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colTypeName',         'Тип данных')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colMaxChar',          'Макс.~кол-во~символов')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colWidth',            'Визуальная~ширина~поля ( " )')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colFormat',           'Формат')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colPos',              'Позиция~поля')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colPKey',             'Первичный~ключ')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colExtra',            '"Чужой"~ключ')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colSKey',             'Семантика~экземпляра')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colRO',               'Использовать~в режиме~"Выбор"')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colFilter',           'Использовать~в "Фильтре"~или "Поиске"')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colRef',              'Показывать~справочник')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colResult',           'Формула~для итоговой строки')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colNotToEdit',        'Запретить~редакти-~ровать')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colNotToShow',        'Не~показывать~в справочнике')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colSimpleFilter',     'Использовать~в "Простом~фильтре"')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colFormName',         'Вызывать~форму')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.tblColumns.colInputInNewRecord', 'Заполнять в форме~добавления~новой записи')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTPrint','Печать')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTPrintAllTables','Печатать список таблиц?')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTAllTables',     'Список таблиц комплекса АБС БАРС98')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTPrintColumns',  'Печатать список полей текущей таблицы?')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTColumns', 'Список полей таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTColumns1','комплекса АБС БАРС98')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTTableAlreadyAdded','Таблица уже добавлена в справочники')
.head 7 -  Call CurrentLangTable.AddAtom('win_MetaEdit.cTTableAdded','Таблица успешно добавлена в справочники')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_SetMetaData
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleExtrnval',         'Описание связей таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleBrowsetbl',        'Поля таблиц для условий фильтров')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleSortorder',        'Описание сортировки таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleFiltertbl',        'Описание вложенности таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleActiontbl',        'Описание выполняемых процедур таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleNsiFunction',      'Описание функций справочника')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.cTWndTitleNsiFunctionColor', 'Описание раскраски таблицы')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.pbSave',  'Записать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.pbCancel','Отменить')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colAddTabAlias','Синоним~таблицы')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColName_Extrnval',       '"Своё" поле')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colAddTabName_Extrnval',    'Связаная~таблица')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colAddColName_Extrnval',    '"Чужое" поле')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColDynTabName_Extrnval', 'Динамически вычисляемое имя~базовой таблицы значений')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColName_Browsetbl','"Свое"~поле связи')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colAddTabName_Browsetbl','"Чужая"~таблица')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colAddColName_Browsetbl','"Чужое"~поле связи')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colTagName','Поле таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colTagSemantic','Наименование~тэга фильтра')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColName_Sortorder','Наименование~поля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colSortOrder','Порядок~сортировки')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colSortWay','Тип~сортировки')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColName_Filtertbl','Наименование~поля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colAddTabName_Filtertbl','Наименование~вложенной таблицы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colFilterCode','Код~фильтра')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colFilterCondition','Фильтр')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colFilterIns','Разрешить~добавлять')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colFilterDel','Разрешить~удалять')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colFilterUpd','Разрешить~редактировать')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colActionCode','Код~действия')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colActionName','Наименование~действия')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colActionProc','Процедура')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colNsiFuncId',      'Ид.')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colNsiFuncDescr',   'Описание')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colNsiFuncProc',    'Sql-процедура')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colNsiFuncForm',    'Вызывать форму')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colNsiFuncCheck',   'Функция проверки')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colNsiFuncFormWeb', 'Вызывать форму ВЕБ')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColorCondition','Условие')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColorIndex','Тип')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetMetaData.tblMetaData.colColorName','Цвет')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_GetObjectId
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.cTWndTitleTable', 'Таблицы...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.cTWndTitleColumn','Поля таблицы...')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.pbSearch','Поиск')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.pbSelect','Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.pbCancel','Отменить')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.tblObjList.colObjName',    'Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetObjectId.tblObjList.colObjSemantic','Семантика')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_GetCode
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.cTWndTitleFilters', 'Фильтры...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.cTWndTitleActions', 'Действия...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.cTWndTitleReferences', 'Справочники...')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.pbSearch','Поиск')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.pbSelect','Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.pbCancel','Отменить')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.tblCodeList.colCode','Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.tblCodeList.colName','Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_GetCode.tblCodeList.colCondition','Условие фильтра')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_MetaFltTblFilter
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaFltTblFilter.cTWndTitle','Фильтры на вложенные справочники')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaFltTblFilter.tblFilters.colCode','Код~фильтра')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaFltTblFilter.tblFilters.colName','Наименование~фильтра')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaFltTblFilter.tblFilters.colCondition','Условие фильтра')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_MetaNsiFunction
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.cTWndTitle','Описание функций на справочник')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgDescr','Описание')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgProc','Sql-процедура')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgPar','Параметры Sql-процедуры')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgExec','Режим вызова')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgQst','Вопрос перед выполнением')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgMsg','Сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.bgForm','Вызывать форму')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.pbSave',  'Записать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaNsiFunction.pbCancel','Отменить')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_MetaSync
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.cTWndTitle','Синхронизация с записями системных таблиц')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.bgMeta','Метаописание комплекса')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.bgSys', 'Описание в системных таблицах')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.pbGetTableName','Таблица БД')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.pbSync',  'Выполнить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.pbCancel','Отменить')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblMeta.colAction', 'Действие')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblMeta.colColName','Поле')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblMeta.colColType','Тип')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblMeta.colColLen', 'Длина')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblMeta.colColSemantic','Семантическое описание поля')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblSys.colAction', 'Действие')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblSys.colColName','Поле')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblSys.colColType','Тип')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblSys.colColLen', 'Длина')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.tblSys.colColSemantic','Семантическое описание поля')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.cTSync','Синхронизация схемы приведет к изменению (или добавлению) ' ||
'атрибутов колонок: Тип, Длина, Семантика. Остальные атрибуты необходимо будет внести ' ||
'вручную. Вы хотите продолжить?')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.cTPopulate','Население таблиц...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaSync.cTWait',    'Подождите, анализируется схема...')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_MetaExp
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaExp.cTWndTitle','Экспорт МетаДанных')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaExp.bgPath','Экспорт МетаДанных в файл:')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaExp.pbSelect', 'Выбрать...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaExp.pbExecute','Выполнить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaExp.pbCancel', 'Отменить')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MetaExp.cTExport','Экспорт МетаОписания')
.head 7 -  ! ====================================================
.head 7 -  !
.head 6 -  !
.head 6 -  Set fInitLib = TRUE
.head 5 -  Return fInitLib
.head 3 -  !
.head 3 +  Function: FunMetaBaseEdit	!__exported
.head 4 -  Description: Вызов функций редактирования метабазы данных
.head 4 +  Returns
.head 5 -  Window Handle: hWndNew
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return SalCreateWindow(win_MetaEdit, hWndMDI, TRUE)
.head 3 +  Function: FunMetaBaseReadOnly	!__exported
.head 4 -  Description: Вызов функций просмотра метабазы данных
.head 4 +  Returns
.head 5 -  Window Handle: hWndNew
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return SalCreateWindow(win_MetaEdit, hWndMDI, FALSE)
.head 3 -  !
.head 3 +  Function: FunMetaXTernTbl	!__exported
.head 4 -  Description: Редактирование связей таблиц
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strTName
.head 5 -  Boolean: bEdit
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return FunShowMetaData(1, strTName, bEdit)
.head 3 +  Function: FunMetaBrowseTbl	!__exported
.head 4 -  Description: Редактирование Тэгов для динамического фильтра
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strTName
.head 5 -  Boolean: bEdit
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return FunShowMetaData(2, strTName, bEdit)
.head 3 +  Function: FunMetaSortTbl	!__exported
.head 4 -  Description: Редактирование сортировки таблицы
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strTName
.head 5 -  Boolean: bEdit
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return FunShowMetaData(3, strTName, bEdit)
.head 3 +  Function: FunMetaFltTbl		!__exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strTName
.head 5 -  Boolean: bEdit
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return FunShowMetaData(4, strTName, bEdit)
.head 3 +  Function: FunShowMetaData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 5 -  String: sTable
.head 5 -  Boolean: bEdit
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return SalModalDialog(dlg_SetMetaData, hWndForm, nMode, SalStrUpperX(SalStrTrimX(sTable)), bEdit)
.head 3 -  !
.head 3 +  Function: FunMetaAccessType	!__exported
.head 4 -  Description: Вызов редактирования справочника
типов доступа к ресурсам
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return SalModalDialog( dlg_MetaTAccess, hWndForm )
.head 3 +  Function: FunMetaSyncTbl	!__exported
.head 4 -  Description: Синхронизировать метаописание с системными
таблицами СУБД.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strTable
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return SalModalDialog( dlg_MetaSync, hWndForm, SalStrUpperX( SalStrTrimX( strTable )) )
.head 3 +  Function: FunMetaFltTblFilter	!__exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTable
.head 5 -  Boolean: bEdit
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call MetaBase_Init()
.head 5 -  Return SalModalDialog(dlg_MetaFltTblFilter, hWndForm, SalStrUpperX(SalStrTrimX(sTable)), bEdit)
.head 3 -  !
.head 3 +  Function: MetaExport
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: FileName
.head 5 -  String: TabName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! формируем данные для файла
.head 6 +  If not SqlPLSQLCommand(hSql(), "bars_metabase.import_bmd(TabName, FileName)")
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Break
.head 6 -  Call SqlCommit(hSql())
.head 6 +  If not PutClobToFile(hSql(), FileName, 'IMP_FILE', 'FILE_NAME', 'FILE_CLOB', NUMBER_Null, FileName, STRING_Null)
.head 7 -  Call SalMessageBox('Помилка формування файлу', 'Помилка', MB_IconStop | MB_Ok)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "delete from imp_file where file_name = :FileName")
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Break
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3494135466
0000: 4002000012010000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F24003C00 000C63004E736946
0040: 756E637400696F6E EE00000009780000 0002F004000000FF 9F0400DC000200FF
0060: 7F08700000000200 FFFFC10C00000002 FD00FF0710000000 02F700FF1F140000
0080: DC000200FF7F1870 0000000200FFFFC1 1C00000002FD00FF 072000000002F700
00A0: FF1F018022000000 00010000000A0063 47656E46696C7480 65727400000004BD
00C0: 0002B30001007F80 F0010000006F0400 E0010D000000FF3F 1100B800000200FF
00E0: FFE01500000001FE 00FF630180220080 020000000B6347F1 44466967000400CF
0100: 0204E8000100009F 8001FC00001B0400 010DFB00FF6F1100 EE0200FFBF15B900
0120: 0100FFFF
.enddata
.head 3 +  Functional Class: cNsiFunction
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  String: sDescr
.head 5 -  String: sProc
.head 5 -  String: sPar
.head 5 -  String: sExec
.head 5 -  String: sQst
.head 5 -  String: sMsg
.head 5 -  String: sCheck
.head 5 -  String: sForm
.head 5 -  String: sFormWeb
.head 4 -  Instance Variables
.head 4 -  Functions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field: cLabelControl
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbBrowse
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 -  Application Actions
.head 1 -  !
.head 1 -  ! ////////////////////////////////////////////////////////////
.head 1 -  !
.head 1 +  Form Window: win_MetaEdit
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: МетаОписание таблиц АБС "БАРС Millennium"
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.4"
.head 4 -  Top:    1.031"
.head 4 -  Width:  21.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.75"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Named Menus
.head 3 +  Menu: popupMetaEditT
.head 4 -  Resource Id: 36744
.head 4 -  Title: NoMoreTitle2!
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Добавить
.head 5 -  Resource Id: 36745
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Insert, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Удалить
.head 5 -  Resource Id: 36746
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Delete, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Восстановить
.head 5 -  Resource Id: 36747
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_UnDelete, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Обновить
.head 5 -  Resource Id: 36748
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Populate, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Сохранить
.head 5 -  Resource Id: 36749
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Update, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Поиск
.head 5 -  Resource Id: 36750
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NameSearch(hWndForm)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Пе&чать
.head 5 -  Resource Id: 36751
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Print, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Свя&зи таблицы...
.head 5 -  Resource Id: 36752
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Update, 0)
.head 6 -  Call FunMetaXTernTbl( tblTables.colName, bEdit)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Присоединенные поля &фильтра...
.head 5 -  Resource Id: 36753
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call FunMetaBrowseTbl(tblTables.colName, bEdit)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Со&ртировка...
.head 5 -  Resource Id: 36754
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call FunMetaSortTbl(tblTables.colName, bEdit)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Вложенные таблицы...
.head 5 -  Resource Id: 51915
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call FunMetaFltTbl(tblTables.colName, bEdit)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 36755
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(SalParentWindow(hWndForm))
.head 5 -  Menu Item Name:
.head 3 +  Menu: popupMetaEditC
.head 4 -  Resource Id: 36756
.head 4 -  Title: NoMoreTitle3!
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Добавить
.head 5 -  Resource Id: 36757
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Insert, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Удалить
.head 5 -  Resource Id: 36758
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Delete, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Восстановить
.head 5 -  Resource Id: 36759
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_UnDelete, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Обновить
.head 5 -  Resource Id: 36760
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Populate, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Сохранить
.head 5 -  Resource Id: 36761
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Update, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Поиск
.head 5 -  Resource Id: 36762
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NameSearch(hWndForm)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Пе&чать
.head 5 -  Resource Id: 36763
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Print, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 36764
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(SalParentWindow(hWndForm))
.head 5 -  Menu Item Name:
.head 3 +  Menu: menuMetaBase
.head 4 -  Resource Id: 36765
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Popup Menu: &Таблицы АБС
.head 5 -  Resource Id: 36766
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: &Показать поля таблицы
.head 6 -  Resource Id: 36767
.head 6 -  Keyboard Accelerator: F3
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblTables, SAM_DoubleClick, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Ис&кать...
.head 6 -  Resource Id: 36768
.head 6 -  Keyboard Accelerator: Ctrl+F
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call NameSearch(tblTables)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Искать с&нова...
.head 6 -  Resource Id: 36769
.head 6 -  Keyboard Accelerator: Ctrl+G
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call NameSearchAgain()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Печа&ть
.head 6 -  Resource Id: 36770
.head 6 -  Keyboard Accelerator: Ctrl+P
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblTables, SAM_User, UTbl_Print, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Син&хронизировать с БД
.head 6 -  Resource Id: 36771
.head 6 -  Keyboard Accelerator: Ctrl+I
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call FunMetaSyncTbl(tblTables.colName)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: &Добавить запись о таблице 
.head 6 -  Resource Id: 36772
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblTables, SAM_User, UTbl_Insert, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Удалить записи о таблицах
.head 6 -  Resource Id: 36773
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblTables, SAM_User, UTbl_Delete, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Снять от&метки об удалении
.head 6 -  Resource Id: 36774
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblTables, SAM_User, UTbl_UnDelete, 0)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: &Сохранить изменения
.head 6 -  Resource Id: 36775
.head 6 -  Keyboard Accelerator: Ctrl+T
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblTables, SAM_User, UTbl_Update, 0)
.head 6 -  Menu Item Name:
.head 4 +  Popup Menu: &Поля таблиц
.head 5 -  Resource Id: 36776
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: &Добавить запись о поле
.head 6 -  Resource Id: 36777
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Insert, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Удалить записи о полях
.head 6 -  Resource Id: 36778
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Delete, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Снять от&метки об удалении
.head 6 -  Resource Id: 36779
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_UnDelete, 0)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: Печа&ть
.head 6 -  Resource Id: 36780
.head 6 -  Keyboard Accelerator: Ctrl+O
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Print, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Сохранить изменения
.head 6 -  Resource Id: 36781
.head 6 -  Keyboard Accelerator: Ctrl+A
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: bEdit=TRUE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Update, 0)
.head 6 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Popup Menu: Ин&струментарий
.head 5 -  Resource Id: 36782
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Связи с &другими таблицами
.head 6 -  Resource Id: 36783
.head 6 -  Keyboard Accelerator: Ctrl+L
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call FunMetaXTernTbl(tblTables.colName, bEdit)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Присоединенные поля динамического &фильтра
.head 6 -  Resource Id: 36784
.head 6 -  Keyboard Accelerator: Ctrl+M
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call FunMetaBrowseTbl(tblTables.colName,bEdit)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Порядок &сортировки
.head 6 -  Resource Id: 36785
.head 6 -  Keyboard Accelerator: Ctrl+S
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call FunMetaSortTbl(tblTables.colName, bEdit)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: &Типы доступа к ресурсам
.head 6 -  Resource Id: 36786
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call FunMetaAccessType()
.head 6 -  Menu Item Name:
.head 5 -  ! Menu Separator
.head 5 +  ! Menu Item: &Импорт МетаДанных
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text: 
.head 6 +  Menu Settings 
.head 7 -  Enabled when: 
.head 7 -  Checked when: 
.head 6 +  Menu Actions 
.head 7 -  Call FunMetaBaseImport()
.head 6 -  Menu Item Name: 
.head 5 +  ! Menu Item: &Экспорт МетаДанных
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text: 
.head 6 +  Menu Settings 
.head 7 -  Enabled when: 
.head 7 -  Checked when: 
.head 6 +  Menu Actions 
.head 7 -  Call FunMetaBaseExport()
.head 6 -  Menu Item Name: 
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 36789
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, UTbl_Insert, 0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, UTbl_Delete, 0)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, UTbl_Update, 0)
.head 4 -  Line
.head 5 -  Resource Id: 36790
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NameSearch(hWndCurTable)
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilterEx(cF_BMD)
.head 8 -  Call SalPostMsg(tblTables, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печатать атрибуты и поля текущей таблицы
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndCurTable, SAM_User, UTbl_Print, 0)
.head 4 -  Line
.head 5 -  Resource Id: 36791
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  3.95"
.head 6 -  Begin Y:  0.405"
.head 6 -  End X:  3.95"
.head 6 -  End Y:  -0.012"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.4"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 36792
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  10.3"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  10.3"
.head 6 -  End Y:  0.012"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSwitch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Переключится между окнами-таблицами
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipSwitch')
.head 6 +  On SAM_Click
.head 7 +  If nSwitch
.head 8 -  Set hWndCurTable = tblTables
.head 7 +  Else
.head 8 -  Set hWndCurTable = tblColumns
.head 7 -  Call SalSetFocus(hWndCurTable)
.head 7 -  Call SalTblSetFocusRow(hWndCurTable, SalTblQueryContext(hWndCurTable))
.head 7 -  Set nSwitch = NOT nSwitch
.head 4 +  Pushbutton: pbGetCols
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать поля таблицы
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipGetCols')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tblTables, SAM_DoubleClick, 0, 0)
.head 4 -  !
.head 4 +  Pushbutton: pbSync
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.15"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Синхронизировать таблицу с системными записями
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipSync')
.head 6 +  On SAM_Click
.head 7 -  Call FunMetaSyncTbl(tblTables.colName)
.head 7 -  Call SalSendMsg(tblTables, SAM_User, UTbl_Populate, 0)
.head 4 +  Pushbutton: pbComplexCol
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать связь "сложного поля"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipComplexCol')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Update, 0)
.head 7 -  Call FunShowMetaData(1, tblTables.colName, bEdit)
.head 4 +  Pushbutton: pbSortOder
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Установить порядок сортировки при населении данных из таблицы
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipSortOrder')
.head 6 +  On SAM_Click
.head 7 -  Call FunShowMetaData(3, tblTables.colName, bEdit)
.head 4 +  Pushbutton: pbShowColor
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\SMTHING.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Установить раскрасску колонок/строк
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipShowColor')
.head 6 +  On SAM_Click
.head 7 -  Call FunShowMetaData(7, tblTables.colName, bEdit)
.head 4 +  Pushbutton: pbShowBrwFields
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать "чужие" поля доступные для динамического запроса
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipShowBrwField')
.head 6 +  On SAM_Click
.head 7 -  Call FunShowMetaData(2, tblTables.colName, bEdit)
.head 4 -  Line
.head 5 -  Resource Id: 6869
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  9.25"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  9.25"
.head 6 -  End Y:  0.012"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbShowFltTbl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.4"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ATTACH.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать связь с вложенными таблицами
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipShowFltTbl')
.head 6 +  On SAM_Click
.head 7 -  Call FunShowMetaData(4, tblTables.colName, bEdit)
.head 4 +  Pushbutton: pbShowFltFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.85"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\EDIT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать фильтры на вложенные таблицы
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipShowFltFilter')
.head 6 +  On SAM_Click
.head 7 -  Call FunMetaFltTblFilter(tblTables.colName, bEdit)
.head 4 +  Pushbutton: pbShowActTbl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.3"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать процедуры для таблицы
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipShowActTbl')
.head 6 +  On SAM_Click
.head 7 -  Call FunShowMetaData(5, tblTables.colName, bEdit)
.head 4 +  Pushbutton: pbNsiFunction
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.75"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_LINK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать функции для справочника
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipNsiFunction')
.head 6 +  On SAM_Click
.head 7 +  If tblTables.colID
.head 8 -  Call FunShowMetaData(6, tblTables.colName, bEdit)
.head 4 -  Line
.head 5 -  Resource Id: 57219
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.05"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  5.05"
.head 6 -  End Y:  0.012"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbRef
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.35"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Добавить таблицу в справочник
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipRef')
.head 6 +  On SAM_Click
.head 7 +  If tblTables.colID
.head 8 -  Call tblTables.AddToRef(tblTables.colID, tblTables.colName)
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.8"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVED.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить МетаОписание в скрипт
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('win_MetaEdit.cBTipSave')
.head 6 +  On SAM_Click
.head 7 -  ! Call SalModalDialog(dlg_MetaExp, hWndForm, tblTables.colName)
.head 7 -  Set nRow = TBL_MinRow
.head 7 -  Set nI = 1
.head 7 +  While SalTblFindNextRow(tblTables, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(tblTables, nRow)
.head 8 -  Set smTables[nI] = tblTables.colName
.head 8 -  Set nI = nI + 1
.head 7 -  Call SalModalDialog(dlg_MetaExp, hWndForm, smTables, nI-1)
.head 4 +  Data Field: dfCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cFieldLabel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   18.367"
.head 7 -  Top:    0.131"
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Garamond
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Light Periwinkle
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Call XSalTooltipShow(dfCount, IifS(GetLang()='RUS', 'Количество таблиц', 'Кількість таблиць'))
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    3.548"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblTables
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  13.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.548"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
таблицы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
таблицы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colSemantic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Семантическое описание
таблицы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colLinesDef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество населяемых
строк по умолчанию
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  2.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colRelTab
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Описывает
отношение
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: AddToRef
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nTabId
.head 7 -  String: sTanName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sName
.head 6 +  Actions
.head 7 -  ! Проверка
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select t.name into :sName
   from references r, typeref t
  where r.type = t.type
    and r.tabid = :nTabId")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! Таблица уже добавлена в справочники sName
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('win_MetaEdit.cTTableAlreadyAdded') || " '" || sName || "'", 
     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
.head 8 -  Return TRUE
.head 7 +  If SalModalDialog(dlg_GetCode, hWndForm, 3, sTmpCode, sTmpName, lsTmp)
.head 8 +  If not SqlPLSQLCommand(hSql(), "bars_metabase.addTableToRef(nTabId, " || sTmpCode || ")")
.head 9 -  Call SqlRollbackEx(hSql(), "BMD. Ошибка добавления таблицы " || sTanName || " в справочник")
.head 9 -  Return FALSE
.head 8 -  Call SqlCommitEx(hSql(), "BMD. Добавлена таблица " || sTanName || " в справочник")
.head 8 -  ! Таблица успешно добавлена в справочники
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('win_MetaEdit.cTTableAdded'), 
     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  String: strDynSql
.head 5 -  String: strTabInsert
.head 5 -  String: strTabUpdate
.head 5 -  String: strTabDelete
.head 5 -  !
.head 5 -  Number: nMaxTID
.head 5 -  Number: nNewRow
.head 5 -  !
.head 5 -  Number: nLastSortRow
.head 5 -  Number: nSortOrder
.head 5 -  !
.head 5 -  Number: nRow
.head 5 -  Number: nFocusRow
.head 5 -  String: sTblNameF
.head 5 -  Window Handle: hColF
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Set nLastSortRow = -1
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 +  If bLinesDef
.head 7 +  If nMTAdd = 4
.head 8 -  Set strTabInsert = "bars_metabase.add_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic, hWndForm.tblTables.colLinesDef)"
.head 7 +  Else
.head 8 -  Set strTabInsert = "bars_metabase.add_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic)"
.head 7 +  If nMTUpd = 4
.head 8 -  Set strTabUpdate = "bars_metabase.update_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic, hWndForm.tblTables.colLinesDef)"
.head 7 +  Else
.head 8 -  Set strTabUpdate = "bars_metabase.update_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic)"
.head 6 +  Else
.head 7 +  If nMTAdd = 4
.head 8 -  Set strTabInsert = "bars_metabase.add_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic, NUMBER_Null)"
.head 7 +  Else
.head 8 -  Set strTabInsert = "bars_metabase.add_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic)"
.head 7 +  If nMTUpd = 4
.head 8 -  Set strTabUpdate = "bars_metabase.update_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic, NUMBER_Null)"
.head 7 +  Else
.head 8 -  Set strTabUpdate = "bars_metabase.update_table(hWndForm.tblTables.colID, hWndForm.tblTables.colName,
    hWndForm.tblTables.colSemantic)"
.head 6 -  Set strTabDelete = "bars_metabase.delete_table(hWndForm.tblTables.colID)"
.head 5 +  On SAM_SetFocus
.head 6 -  Set hWndCurTable = tblTables
.head 6 -  Set nSwitch = 0
.head 5 +  On SAM_RowSetContext
.head 6 -  Set sTblNameF = colName
.head 6 +  If nCurTabID != colID
.head 7 -  Set nCurTabID = colID
.head 7 -  Call SalPostMsg(tblColumns, SAM_User, UTbl_Populate, colID)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(tblColumns, SAM_User, UTbl_Populate, colID)
.head 5 +  On SAM_ContextMenu
.head 6 -  Call SalTrackPopupMenu (hWndForm, 'popupMetaEditT', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  Select Case wParam
.head 7 +  Case UTbl_Populate
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If win_MetaEdit.fFilterAtStart
.head 9 +  If SetQueryFilterEx(cF_BMD)
.head 10 -  Set win_MetaEdit.fFilterAtStart = NOT win_MetaEdit.fFilterAtStart
.head 8 -  !
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call cQ.Init(win_MetaEdit.strSqlPopulate)
.head 8 -  Set strDynSql = cQ.GetFullSQLStringEx(cF_BMD)
.head 8 -  Call SalTblPopulate(hWndForm, hSql(), T(strDynSql), TBL_FillAll)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  !
.head 8 -  Call SalTblSortRows(hWndItem, nLastSortRow, nSortOrder)
.head 8 -  !
.head 8 -  Set nFocusRow = 0
.head 8 +  If sTblNameF
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, 0, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If colName = sTblNameF
.head 11 -  Set nFocusRow = nRow
.head 11 -  Break
.head 8 -  Call SalTblSetContext(hWndItem, nFocusRow)
.head 8 -  Call SalTblSetFocusRow(hWndItem, nFocusRow)
.head 8 -  !
.head 8 -  Set nCurTabID = colID
.head 8 -  Call SalPostMsg(tblColumns, SAM_User, UTbl_Populate, colID)
.head 8 -  !
.head 8 -  Break
.head 7 +  Case UTbl_Insert
.head 8 -  Set nNewRow =  SalTblInsertRow(hWndItem, TBL_MaxRow)
.head 8 +  If nNewRow != TBL_Error
.head 9 -  Call SalTblSetFocusRow(hWndItem, nNewRow)
.head 9 -  Set tblTables.colID = NUMBER_Null
.head 9 -  Call SalTblSetFocusCell(hWndItem, nNewRow, colName, 0, 1)
.head 8 -  Break
.head 7 +  Case UTbl_Delete
.head 8 -  Call SalTblSetFlagsAnyRows(hWndItem, ROW_MarkDeleted, TRUE, ROW_Selected, 0)
.head 8 -  Break
.head 7 +  Case UTbl_UnDelete
.head 8 -  Call SalTblSetFlagsAnyRows(hWndItem, ROW_MarkDeleted, FALSE, ROW_Selected, 0)
.head 8 -  Break
.head 7 +  Case UTbl_Update
.head 8 -  Set sTblNameF = colName
.head 8 -  !
.head 8 +  If SalTblAnyRows(hWndItem, ROW_New, 0)
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, ROW_New, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If not SqlPLSQLCommand(conOther.hSql(), strTabInsert)
.head 11 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. не удалось добавить описание таблицы " || tblTables.colName)
.head 10 +  Else
.head 11 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Добавлено описание таблицы " || tblTables.colName)
.head 10 -  Call SalTblSetRowFlags(hWndItem, nRow, ROW_New, FALSE)
.head 10 -  Call SalTblSetRowFlags(hWndItem, nRow, ROW_Edited, FALSE)
.head 8 +  If SalTblAnyRows(hWndItem, ROW_Edited, 0)
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, ROW_Edited, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If not SqlPLSQLCommand(conOther.hSql(), strTabUpdate)
.head 11 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Не удалось изменить описание таблицы " || tblTables.colName)
.head 10 +  Else
.head 11 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Изменено описание таблицы " || tblTables.colName)
.head 8 +  If SalTblAnyRows(hWndItem, ROW_MarkDeleted, 0)
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, ROW_MarkDeleted, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If not SqlPLSQLCommand(conOther.hSql(), strTabDelete)
.head 11 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Не удалось удалить описание таблицы " || tblTables.colName)
.head 10 +  Else
.head 11 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Удалено описание таблицы " || tblTables.colName)
.head 8 -  !
.head 8 -  Call SalPostMsg(hWndItem, SAM_User, UTbl_Populate, 0)
.head 8 -  !
.head 8 -  Break
.head 7 +  Case UTbl_Print
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! If SalMessageBox('Печатать список таблиц?','Печать', MB_IconQuestion | MB_YesNo) = IDYES
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('win_MetaEdit.cTPrintAllTables'),
   CurrentLangTable.GetAtomTitle('win_MetaEdit.cTPrint'), MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  ! Call TablePrint(hWndItem, 'Список таблиц комплекса АБС БАРС98', GetPrnDir() || '\\meta_tbl.txt', '')
.head 9 -  Call TablePrint(hWndItem, CurrentLangTable.GetAtomTitle('win_MetaEdit.cTAllTables'), GetPrnDir() || '\\meta_tbl.txt', '')
.head 8 -  Break
.head 7 +  Case UTbl_Sort
.head 8 +  If lParam != nLastSortRow
.head 9 -  Set nLastSortRow = lParam
.head 9 -  Set nSortOrder = TBL_SortIncreasing
.head 8 +  Else
.head 9 -  Set nSortOrder = 1 - nSortOrder
.head 8 -  Call SalTblSetColumnFlags(SalTblGetColumnWindow(hWndItem, lParam, COL_GetID), COL_Selected, FALSE)
.head 8 -  Call SalTblSortRows(hWndItem, lParam, nSortOrder)
.head 8 -  Call SalSendMsg(hWndItem, SAM_RowSetContext, 0, 0)
.head 8 -  Break
.head 7 +  Default
.head 8 -  Break
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On UM_Populate
.head 6 -  Set dfCount = 0
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, UTbl_Populate, 0)
.head 6 +  If dfCount = 0
.head 7 -  Set dfCount = NUMBER_Null
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set dfCount = dfCount + 1
.head 3 +  Child Table: tblColumns
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -1.55"
.head 6 -  Top:    1.548"
.head 6 -  Width:  11.533"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.214"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
поля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
поля
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colSemantic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Семантическое описание
поля
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 50
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TypeID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colTypeName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип данных
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate(hWndItem, conOther.hSql(), 'SELECT typename FROM meta_coltypes')
.head 7 +  On SAM_Validate
.head 8 -  Set colType = SalStrLeftX(SalStrUpperX(SalListQueryTextX(hWndItem, SalListQuerySelection(hWndItem))), 1) 
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colMaxChar
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Макс.
кол-во
символов
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colWidth
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Визуальная
ширина
поля (")
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colFormat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Формат
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colPos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Позиция
поля
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colRTypeCode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPKey
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Первичный
ключ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colExtra
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: "Чужой"
ключ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colSKey
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Семантика
экземпляра
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colRO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Использовать
в режиме 
"Выбор"
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_Char
.head 8 -  Call SalPostMsg(SalParentWindow(hWndItem), WM_Char, wParam, lParam)
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colFilter
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Использовать
в "Фильтре"
или "Поиске"
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colSimpleFilter
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Использовать
в "Простом
фильтре"
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Показывать
справочник
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colFormName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вызывать
форму
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colWebFormName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вызывать
ВЕБ
форму
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colResult
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Формула
для итоговой строки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colNotToEdit
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Запретить
редакти-
ровать
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colNotToShow
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Не
показывать
в справочнике
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 5 +  Column: colInputInNewRecord
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Заполнять в форме
добавления
новой записи
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.933"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_ColumnSelectClick
.head 8 -  Call SalSendMsg(hWndForm, SAM_User, UTbl_Sort, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)))
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strColPopulate
.head 5 -  String: strColInsert
.head 5 -  String: strColDelete
.head 5 -  String: strColUpdate
.head 5 -  !
.head 5 -  Number: nRow
.head 5 -  Number: nNewRow
.head 5 -  String: strTypeName
.head 5 -  !
.head 5 -  Number: nLastSortRow
.head 5 -  Number: nSortOrder
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Set nLastSortRow = -1
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Call SalTblSetLockedColumns(tblColumns, 2)
.head 6 -  Set strColPopulate = "
    SELECT colid, colname, semantic, c.coltype, TRIM(t.typename), showwidth, showmaxchar, showpos, showin_ro,
           showretval, instnssemantic, extrnval, showrel_ctype, showformat, showin_fltr, showref, showresult,
           not_to_edit, not_to_show, simple_filter, form_name, web_form_name, input_in_new_record
    INTO   :colID, :colName, :colSemantic, :colType, :strTypeName, :colWidth, :colMaxChar, :colPos, :colRO,
           :colPKey, :colSKey, :colExtra, :colRTypeCode, :colFormat, :colFilter, :colRef, :colResult,
           :colNotToEdit, :colNotToShow, :colSimpleFilter, :colFormName, :colWebFormName, :colInputInNewRecord
    FROM   meta_columns c, OUTER meta_coltypes t
    WHERE  tabid=:nCurTabID AND t.coltype=c.coltype "
.head 6 -  Set strColInsert = "bars_metabase.add_column(nCurTabID, colID, colName, colType, colSemantic, colWidth, colMaxChar,
    colPos, colRO, colPKey, colSKey, colExtra, colRTypeCode, colFormat, colFilter, colRef, colResult, colNotToEdit,
    colNotToShow, colSimpleFilter, colWebFormName, colFormName, colInputInNewRecord)"
.head 6 -  Set strColUpdate = "bars_metabase.update_column(nCurTabID, colID, colName, colType, colSemantic, colWidth, colMaxChar,
    colPos, colRO, colPKey, colSKey, colExtra, colRTypeCode, colFormat, colFilter, colRef, colResult, colNotToEdit,
    colNotToShow, colSimpleFilter, colFormName, colWebFormName, colInputInNewRecord)"
.head 6 -  Set strColDelete = "bars_metabase.delete_column(nCurTabID, colID)"
.head 5 +  On SAM_SetFocus
.head 6 -  Set hWndCurTable = tblColumns
.head 6 -  Set nSwitch = 1
.head 6 -  Call SalTblSetRowFlags(tblTables, SalTblQueryContext(tblTables), ROW_Selected, TRUE)
.head 5 +  On SAM_User
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  Select Case wParam
.head 7 +  Case UTbl_Populate
.head 8 -  ! Set dfCount = 0
.head 8 -  Call SalTblPopulate(hWndItem, conCol.hSql(), T(strColPopulate), TBL_FillAll)
.head 8 +  ! If dfCount = 0
.head 9 -  Set dfCount = NUMBER_Null
.head 8 -  !
.head 8 -  Break
.head 7 +  Case UTbl_Insert
.head 8 -  Set nNewRow = SalTblInsertRow(tblColumns, TBL_MaxRow)
.head 8 +  If nNewRow != TBL_Error
.head 9 -  Call SalTblSetContext(tblColumns, nNewRow)
.head 9 -  Set tblColumns.colID = NUMBER_Null
.head 9 -  Set tblColumns.colType = 'C'
.head 9 -  Call SalListSelectString(tblColumns.colTypeName, 0, 'Character')
.head 9 -  Call SalTblSetFocusCell(tblColumns, nNewRow, colName, 0, 1)
.head 8 -  Break
.head 7 +  Case UTbl_Delete
.head 8 -  Call SalTblSetFlagsAnyRows(hWndItem, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_New)
.head 8 -  Set nNewRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndItem, nNewRow, ROW_Selected | ROW_New, ROW_MarkDeleted)
.head 9 -  Call SalTblFetchRow(hWndItem, nNewRow)
.head 9 -  Call SalTblDeleteRow(hWndItem, nNewRow, TBL_NoAdjust)
.head 8 -  Break
.head 7 +  Case UTbl_UnDelete
.head 8 -  Call SalTblSetFlagsAnyRows(hWndItem, ROW_MarkDeleted, FALSE, ROW_Selected, 0)
.head 8 -  Break
.head 7 +  Case UTbl_Update
.head 8 -  Set bErr = FALSE
.head 8 +  If SalTblAnyRows(hWndItem, ROW_New, 0)
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, ROW_New, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If not SqlPLSQLCommand(conOther.hSql(), strColInsert)
.head 11 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Не удалось добавить описание колонки " || 
     tblTables.colName || "." || tblColumns.colName)
.head 11 -  Set bErr = TRUE
.head 10 +  Else
.head 11 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Добавлено описание колонки " || 
     tblTables.colName || "." || tblColumns.colName)
.head 11 -  Call SalTblSetRowFlags(hWndItem, nRow, ROW_New, FALSE)
.head 11 -  Call SalTblSetRowFlags(hWndItem, nRow, ROW_Edited, FALSE)
.head 8 +  If SalTblAnyRows(hWndItem, ROW_Edited, 0)
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, ROW_Edited, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If not SqlPLSQLCommand(conOther.hSql(), strColUpdate)
.head 11 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Не удалось изменить описание колонки " || 
     tblTables.colName || "." || tblColumns.colName)
.head 11 -  Set bErr = TRUE
.head 10 +  Else
.head 11 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Изменено описание колонки " || 
     tblTables.colName || "." || tblColumns.colName)
.head 8 +  If SalTblAnyRows(hWndItem, ROW_MarkDeleted, 0)
.head 9 -  Set nRow = TBL_MinRow
.head 9 +  While SalTblFindNextRow(hWndItem, nRow, ROW_MarkDeleted, 0)
.head 10 -  Call SalTblSetContext(hWndItem, nRow)
.head 10 +  If not SqlPLSQLCommand(conOther.hSql(), strColDelete)
.head 11 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Не удалось удалить описание колонки " || 
     tblTables.colName || "." || tblColumns.colName)
.head 11 -  Set bErr = TRUE
.head 10 +  Else
.head 11 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Удалено описание колонки " || 
     tblTables.colName || "." || tblColumns.colName)
.head 8 +  If not bErr
.head 9 -  Call SalPostMsg(hWndItem, SAM_User, UTbl_Populate, 0)
.head 8 -  Break
.head 7 +  Case UTbl_Print
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! If SalMessageBox('Печатать список полей текущей таблицы?','Печать', MB_IconQuestion | MB_YesNo) = IDYES
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('win_MetaEdit.cTPrintColumns'),
   CurrentLangTable.GetAtomTitle('win_MetaEdit.cTPrint'), MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  ! Call TablePrint(hWndItem, 'Список полей таблицы ' || tblTables.colName || ' комплекса АБС БАРС98', GetPrnDir() || '\\meta_col.txt', '')
.head 9 -  Call TablePrint(hWndItem, CurrentLangTable.GetAtomTitle('win_MetaEdit.cTColumns') || ' ' || tblTables.colName || ' ' || 
  CurrentLangTable.GetAtomTitle('win_MetaEdit.cTColumns1'), GetPrnDir() || '\\meta_col.txt', '')
.head 8 -  Break
.head 7 +  Case UTbl_Sort
.head 8 +  If lParam != nLastSortRow
.head 9 -  Set nLastSortRow = lParam
.head 9 -  Set nSortOrder = TBL_SortIncreasing
.head 8 +  Else
.head 9 -  Set nSortOrder = 1 - nSortOrder
.head 8 -  Call SalTblSetColumnFlags(SalTblGetColumnWindow(hWndItem, lParam, COL_GetID), COL_Selected, FALSE)
.head 8 -  Call SalTblSortRows(hWndItem, lParam, nSortOrder)
.head 8 -  Break
.head 7 +  Default
.head 8 -  Break
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_ContextMenu
.head 6 -  Call SalTrackPopupMenu (hWndForm, 'popupMetaEditC', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SalListSelectString(hWndForm.tblColumns.colTypeName, -1, strTypeName)
.head 6 -  ! Set dfCount = dfCount + 1
.head 2 +  Functions
.head 3 +  Function: NameSearch
.head 4 -  Description: Поиск строки по наименованию
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strTrans
.head 5 -  Window Handle: hWndCol
.head 5 -  Number: nFocusRow
.head 4 +  Actions
.head 5 +  If GetTblSearchVal(hWndTbl, nSearchCol, strSearch4)
.head 6 -  Set strTrans = StrMatches2Like(strSearch4)
.head 6 -  Call SalTblQueryFocus(hWndTbl, nFocusRow, hWndCol)
.head 6 -  Set hWndCol = SalTblGetColumnWindow(hWndTbl, nSearchCol, COL_GetID)
.head 6 -  Call SalTblSetFocusRow(hWndTbl, VisTblFindString(hWndTbl, nFocusRow+1, hWndCol, strTrans))
.head 3 +  Function: NameSearchAgain
.head 4 -  Description: Поиск строки по наименованию - Еще раз
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strTrans
.head 5 -  Window Handle: hWndCol
.head 5 -  Number: nFocusRow
.head 4 +  Actions
.head 5 -  Set strTrans = StrMatches2Like(strSearch4)
.head 5 -  Call SalTblQueryFocus(hWndCurTable, nFocusRow, hWndCol)
.head 5 -  Set hWndCol = SalTblGetColumnWindow(hWndCurTable, nSearchCol, COL_GetID)
.head 5 -  Call SalTblSetFocusRow(hWndCurTable, VisTblFindString(hWndCurTable, nFocusRow+1, hWndCol, strTrans))
.head 2 +  Window Parameters
.head 3 -  Boolean: bEdit
.head 2 +  Window Variables
.head 3 -  : conTbl
.head 4 -  Class: cABSConnect
.head 3 -  : conCol
.head 4 -  Class: cABSConnect
.head 3 -  : conOther
.head 4 -  Class: cABSConnect
.head 3 -  : CMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  !
.head 3 -  : cF_BMD
.head 4 -  Class: cGenFilterEx
.head 3 -  !
.head 3 -  Window Handle: hWndCurTable
.head 3 -  Window Handle: hWndObject
.head 3 -  Number: nSwitch
.head 3 -  !
.head 3 -  Number: nCurTabID
.head 3 -  !
.head 3 -  Number: nSearchCol
.head 3 -  String: strSearch4
.head 3 -  String: sTmpCode
.head 3 -  String: sTmpName
.head 3 -  String: smTables[1:*]
.head 3 -  Long String: lsTmp
.head 3 -  Number: nRow
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  Boolean: bLinesDef
.head 3 -  Number: nMTAdd
.head 3 -  Number: nMTUpd
.head 3 -  !
.head 3 -  Boolean: bErr
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XConnectGetParams(conOther)
.head 4 +  If NOT conOther.Connect()
.head 5 -  Return FALSE
.head 4 -  Call conTbl.Clone(conOther, TRUE)
.head 4 -  Call conCol.Clone(conOther, TRUE)
.head 4 -  Call CMenu.Init(hWndForm, 'menuMetaBase', '&МетаДанные')
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! МетаОписание таблиц АБС "БАРС Millennium"
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('win_MetaEdit.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Set hWndCurTable = tblTables
.head 4 -  Set nSwitch = 0
.head 4 -  Set strSearch4 = '*'
.head 4 -  !
.head 4 -  Set bLinesDef = GetValueStr("
    SELECT to_char(count(1))
    FROM   user_tab_columns
    WHERE  TABLE_NAME='META_TABLES' AND COLUMN_NAME='LINESDEF'") != '0'
.head 4 -  Set nMTAdd = Val(GetValueStr("
    SELECT to_char(count(1))
    FROM   user_arguments
    WHERE  OBJECT_NAME='ADD_TABLE' AND package_name='BARS_METABASE'"))
.head 4 -  Set nMTUpd = Val(GetValueStr("
    SELECT to_char(count(1))
    FROM   user_arguments
    WHERE  OBJECT_NAME='UPDATE_TABLE' AND package_name='BARS_METABASE'"))
.head 4 -  !
.head 4 +  ! If bLinesDef
.head 5 -  Call Debug('LinesDef+')
.head 4 -  ! Call Debug('nMTAdd = ' || Str(nMTAdd))
.head 4 -  ! Call Debug('nMTUpd = ' || Str(nMTUpd))
.head 4 -  !
.head 4 -  Set hWndForm.win_MetaEdit.fFilterAtStart = TRUE
.head 4 -  Set hWndForm.win_MetaEdit.strFilterTblName = 'META_TABLES'
.head 4 +  If bLinesDef
.head 5 -  Set hWndForm.win_MetaEdit.strSqlPopulate = "
    SELECT tabid, tabname, semantic, tabrelation, linesdef
    INTO   :hWndForm.tblTables.colID, :hWndForm.tblTables.colName, :hWndForm.tblTables.colSemantic,
           :hWndForm.tblTables.colRelTab, :hWndForm.tblTables.colLinesDef
    FROM   meta_tables
    ORDER BY 2,1"
.head 4 +  Else
.head 5 -  Set hWndForm.win_MetaEdit.strSqlPopulate = "
    SELECT tabid, tabname, semantic, tabrelation
    INTO   :hWndForm.tblTables.colID, :hWndForm.tblTables.colName, :hWndForm.tblTables.colSemantic,
           :hWndForm.tblTables.colRelTab
    FROM   meta_tables
    ORDER BY 2,1"
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 +  If not bEdit
.head 5 -  Set nFlags = GT_ReadOnly
.head 5 -  !
.head 5 -  Call SalDisableWindow(pbSync)
.head 5 -  !
.head 5 -  Set hWndObject = SalGetFirstChild(tblTables, TYPE_TableColumn)
.head 5 +  While hWndObject != hWndNULL
.head 6 -  Call SalDisableWindow(hWndObject)
.head 6 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_TableColumn)
.head 5 -  !
.head 5 -  Set hWndObject = SalGetFirstChild(tblColumns, TYPE_TableColumn)
.head 5 +  While hWndObject != hWndNULL
.head 6 -  Call SalDisableWindow(hWndObject)
.head 6 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_TableColumn)
.head 4 -  Call cF_BMD.Init('meta_tables', 'meta_tables')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_Activate
.head 4 -  Call CMenu.Enable(wParam)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call CMenu.ShowMenu(wParam, lParam)
.head 3 +  On SAM_Close
.head 4 -  Call SalDestroyWindow(hWndForm)
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation of  function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(conOther.hSql(), ' FunMetaBaseEdit() ')
.head 4 -  Call conTbl.Disconnect()
.head 4 -  Call conCol.Disconnect()
.head 4 -  Call conOther.Disconnect()
.head 4 -  Call CMenu.Kill()
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 -  !
.head 1 +  Dialog Box: dlg_SetMetaData
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.95"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.929"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17011
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17012
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  2.6"
.head 6 -  Begin Y:  0.405"
.head 6 -  End X:  2.6"
.head 6 -  End Y:  -0.012"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.05"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17013
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  4.15"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.15"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblMetaData
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  10.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.1"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 -  ! for ExtrnVal
.head 5 +  Column: colColId		! N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColName		! S Имя поля
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя поля
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 +  If sTableName
.head 10 +  If SalModalDialog(dlg_GetObjectId, hWndForm, GET_COLUMN, nTableId, 
   IifS(nMode=1, 'extrnval=1', IifS(nMode=4, 'showref=1', '')), nTmpId, sTmpName)
.head 11 -  Set colColId   = nTmpId
.head 11 -  Set colColName = sTmpName
.head 11 -  Set sTmp       = colColName
.head 11 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 12 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  On SAM_AnyEdit
.head 8 +  If nMode != 7
.head 9 -  Set colColName = sTmp
.head 7 +  On SAM_Validate
.head 8 +  If nMode = 7 and colColName = ''
.head 9 -  Set colColId = NUMBER_Null
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colColName
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colAddTabId		! N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAddTabName		! S Имя доп. таблицы
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя доп. таблицы
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 +  If SalModalDialog(dlg_GetObjectId, hWndForm, GET_TABLE, NULL_ID, '',  nTmpId, sTmpName)
.head 10 -  Set colAddTabId   = nTmpId
.head 10 -  Set colAddTabName = sTmpName
.head 10 -  Set sTmp          = colAddTabName
.head 10 -  Set colAddColId   = NUMBER_Null
.head 10 -  Set colAddColName = ''
.head 10 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 11 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colAddTabName = sTmp
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colAddTabName
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colAddTabAlias		! S Синоним таблицы
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Синоним
таблицы
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! for BrowseTbl
.head 5 +  Column: colTagId		! N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTagName		! S Наименование тэга фильтра
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
тэга фильтра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 +  If colAddTabName
.head 10 +  If SalModalDialog(dlg_GetObjectId, hWndForm, GET_COLUMN, colAddTabId, '', nTmpId, sTmpName)
.head 11 -  Set colTagId   = nTmpId
.head 11 -  Set colTagName = colAddTabName || '.' || sTmpName
.head 11 -  Set sTmp       = colTagName
.head 11 -  Call SqlPrepareAndExecute(hSql(), 
"select semantic into :colTagSemantic 
   from meta_columns 
  where tabid = :colAddTabId and colid = :colTagId")
.head 11 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 11 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 12 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 9 +  Else
.head 10 -  Call SalSetFocus(colAddTabName)
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colTagName = sTmp
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colTagName
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colTagSemantic		! S Наименование тэга фильтра
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
тэга фильтра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 60
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! for ExtrnVal and BrowseTbl
.head 5 +  Column: colAddColId		! N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAddColName		! S Имя поля доп.табл.
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя поля доп.табл.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 +  If colAddTabName
.head 10 +  If SalModalDialog(dlg_GetObjectId, hWndForm, GET_COLUMN, colAddTabId, '', nTmpId, sTmpName)
.head 11 -  Set colAddColId   = nTmpId
.head 11 -  Set colAddColName = colAddTabName || '.' || sTmpName
.head 11 -  Set sTmp          = colAddColName
.head 11 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 12 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colAddColName = sTmp
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colAddColName
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 -  ! for ExtrnVal
.head 5 +  Column: colColDynTabName	! S Динамически вычисляемое имя базовой таблицы значений
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Динамически вычисляемое имя
базовой таблицы значений
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! for SortTbl
.head 5 +  Column: colSortOrder		! N Порядок сортировки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Порядок
сортировки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SalTblSortRows(hWndForm, 4, TBL_SortIncreasing)
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colSortWay		! S Тип сортировки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
сортировки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 +  List Values
.head 7 -  Text: ASC
.head 7 -  Text: DESC
.head 6 -  Message Actions
.head 5 -  ! for FilterTbl
.head 5 +  Column: colFilterCode		! S Код фильтра
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
фильтра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 +  If colAddTabName
.head 10 +  If SalModalDialog(dlg_GetCode, hWndForm, 1, sTmpCode, sTmpName, sTmpCond)
.head 11 -  Set colFilterCode      = sTmpCode
.head 11 -  Set colFilterCondition = ReplCond(sTmpCond, colAddTabName)
.head 11 -  Set sTmp               = colFilterCode
.head 11 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 12 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colFilterCode = sTmp
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colFilterCode
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colFilterCondition	! LS Фильтр
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фильтр
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Class Default
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFilterIns		! N Разрешить добавлять
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Разрешить
добавлять
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFilterDel		! N Разрешить удалять
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Разрешить
удалять
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFilterUpd		! N Разрешить редактировать
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Разрешить
редактировать
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! For ActionTbl
.head 5 +  Column: colActionCode		! S Код действия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
действия
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 +  If SalModalDialog(dlg_GetCode, hWndForm, 2, sTmpCode, sTmpName, sTmpCond)
.head 10 -  Set colActionCode = sTmpCode
.head 10 -  Set colActionName = sTmpName
.head 10 -  Set sTmp          = colActionCode
.head 10 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 11 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colActionCode = sTmp
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colActionCode
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colActionName		! S Наименование действия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
действия
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colActionProc		! S Выполняемая процедура
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выполняемая
процедура
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! For NsiFunction
.head 5 +  Column: colNsiFuncId		! N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncDescr		! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Описание
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and SalTblAnyRows(hWndForm, 0, 0)
.head 9 -  Set cNsiFunc.sDescr   = colNsiFuncDescr
.head 9 -  Set cNsiFunc.sProc    = colNsiFuncProc
.head 9 -  Set cNsiFunc.sPar     = colNsiFuncPar
.head 9 -  Set cNsiFunc.sExec    = colNsiFuncExec
.head 9 -  Set cNsiFunc.sQst     = colNsiFuncQst
.head 9 -  Set cNsiFunc.sMsg     = colNsiFuncMsg
.head 9 -  Set cNsiFunc.sCheck   = colNsiFuncCheck
.head 9 -  Set cNsiFunc.sForm    = colNsiFuncForm
.head 9 -  Set cNsiFunc.sFormWeb = colNsiFuncFormWeb
.head 9 +  If SalModalDialog(dlg_MetaNsiFunction, hWndForm, nTableId, cNsiFunc)
.head 10 -  Set colNsiFuncDescr   = cNsiFunc.sDescr
.head 10 -  Set colNsiFuncProc    = cNsiFunc.sProc
.head 10 -  Set colNsiFuncPar     = cNsiFunc.sPar
.head 10 -  Set colNsiFuncExec    = cNsiFunc.sExec
.head 10 -  Set colNsiFuncQst     = cNsiFunc.sQst
.head 10 -  Set colNsiFuncMsg     = cNsiFunc.sMsg
.head 10 -  Set colNsiFuncCheck   = cNsiFunc.sCheck
.head 10 -  Set colNsiFuncForm    = cNsiFunc.sForm
.head 10 -  Set colNsiFuncFormWeb = cNsiFunc.sFormWeb
.head 10 +  If NOT SalTblQueryRowFlags(hWndForm, lParam, ROW_Edited)
.head 11 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  On SAM_SetFocus
.head 8 -  ! Double Click - для изменения значения
.head 8 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('cTDoubleClick'))
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colNsiFuncProc		! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sql-процедура
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncPar
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sql-процедура
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncExec
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sql-процедура
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncQst
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sql-процедура
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncMsg
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sql-процедура
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncCheck		! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Функция проверки
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncForm		! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вызывать форму
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiFuncFormWeb	! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вызывать форму ВЕБ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiIconId		! N
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Icon_Id
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 8
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.867"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! For TblColor
.head 5 +  Column: colColorCondition	! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условие
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColorIndex		! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 +  List Values
.head 7 -  Text: TEXT
.head 7 -  Text: BACKGROUND
.head 6 +  Message Actions
.head 7 +  ! On SAM_Create
.head 8 -  Call SalListAdd(colColorIndexName, 'TEXT')
.head 8 -  Call SalListAdd(colColorIndexName, 'BACKGROUND')
.head 7 +  ! On SAM_Click
.head 8 +  ! If colColorIndexName = 'TEXT'
.head 9 -  Set colColorIndexId = 1
.head 8 +  ! Else
.head 9 -  Set colColorIndexId = 2
.head 8 -  Set colColorIndexId = SalListQuerySelection(colColorIndexName) + 1
.head 5 +  Column: colColorName		! S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Цвет
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 +  List Values
.head 7 -  Text: COLOR_Black
.head 7 -  Text: COLOR_Blue
.head 7 -  Text: COLOR_Burgundy
.head 7 -  Text: COLOR_Charcoal
.head 7 -  Text: COLOR_Chartreuse
.head 7 -  Text: COLOR_Cyan
.head 7 -  Text: COLOR_DarkAqua
.head 7 -  Text: COLOR_DarkBlue
.head 7 -  Text: COLOR_DarkGray
.head 7 -  Text: COLOR_DarkGreen
.head 7 -  Text: COLOR_DarkRed
.head 7 -  Text: COLOR_Gray
.head 7 -  Text: COLOR_Green
.head 7 -  Text: COLOR_Jade
.head 7 -  Text: COLOR_LightAqua
.head 7 -  Text: COLOR_LightGray
.head 7 -  Text: COLOR_LightGreen
.head 7 -  Text: COLOR_LightPeriwinkle
.head 7 -  Text: COLOR_Magenta
.head 7 -  Text: COLOR_Maize
.head 7 -  Text: COLOR_Marigold
.head 7 -  Text: COLOR_MidnightBlue
.head 7 -  Text: COLOR_Orchid
.head 7 -  Text: COLOR_Periwinkle
.head 7 -  Text: COLOR_Purple
.head 7 -  Text: COLOR_Red
.head 7 -  Text: COLOR_RoyalBlue
.head 7 -  Text: COLOR_Salmon
.head 7 -  Text: COLOR_Sky
.head 7 -  Text: COLOR_Teal
.head 7 -  Text: COLOR_White
.head 7 -  Text: COLOR_Yellow
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: ReplCond
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sCond
.head 7 -  String: sReplTabName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return VisStrSubstitute(sCond, '$~~ALIAS~~$', sReplTabName)
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  : cNsiFunc
.head 6 -  Class: cNsiFunction
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), dlg_SetMetaData.strSqlPopulate, TBL_FillAll)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If nMode = 4
.head 7 -  Set colFilterCondition = ReplCond(colFilterCondition, colAddTabName)
.head 5 +  On UM_Insert
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If nMode = 4
.head 7 -  Set tblMetaData.colFilterIns = 0
.head 7 -  Set tblMetaData.colFilterDel = 0
.head 7 -  Set tblMetaData.colFilterUpd = 0
.head 6 -  Set hCol = GetFirstEditableColumn(hWndForm)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
.head 5 +  On UM_Update
.head 6 -  ! Для функций справочника
.head 6 +  If nMode = 6 or nMode = 7
.head 7 -  ! Удаление
.head 7 +  If not SqlPLSQLCommand(hSql(), dlg_SetMetaData.strSqlDelete)
.head 8 -  Call SqlRollbackEx(hSql(), "METABASE. " ||
     IifS(nMode=6, "Не удалось удалить описание функций справочника: " || sTableName,
     IifS(nMode=7, "Не удалось удалить описание раскрасски таблицы: " || sTableName, "")))
.head 8 -  Return FALSE
.head 7 -  Set nRow = TBL_MinRow
.head 7 -  ! Добавление
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, ROW_MarkDeleted)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If nMode = 7
.head 9 -  Set dlg_SetMetaData.strSqlInsert = "bars_metabase.add_tblcolor(nTableId, colNsiFuncId, colColId, 
    colColorCondition, " || IifS(colColorIndex='TEXT', "1", "2") || ", colColorName)"
.head 8 +  If not SqlPLSQLCommand(hSql(), dlg_SetMetaData.strSqlInsert)
.head 9 -  Call SqlRollbackEx(hSql(), "METABASE. " ||
     IifS(nMode=6, "Не удалось добавить описание функций справочника: " || sTableName,
     IifS(nMode=7, "Не удалось добавить описание раскрасски таблицы: " || sTableName, "")))
.head 9 -  Return FALSE
.head 7 -  Call SqlCommitEx(hSql(), "METABASE. " ||
     IifS(nMode=6, "Обновлено описание функций справочника: " || sTableName,
     IifS(nMode=7, "Обновлено описание раскрасски таблицы: " || sTableName, "")))
.head 6 -  ! Для остального
.head 6 +  Else
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_Edited | ROW_MarkDeleted, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 9 +  If not SqlPLSQLCommand(hSql(), dlg_SetMetaData.strSqlInsert)
.head 10 -  Call SqlRollbackEx(hSql(), "METABASE. " || 
     IifS(nMode=1, "Не удалось добавить описание 'чужого' ключа: " || sTableName || "." || colColName || "<->" || colAddColName, 
     IifS(nMode=2, "Не удалось добавить описание полей для условий фильтра: " || colColName || "=" || colAddColName || " ->" || colTagName, 
     IifS(nMode=3, "Не удалось добавить описание сортировки: " || sTableName || "." || colColName || "=" || Str(colSortOrder) || " " || colSortWay, 
     IifS(nMode=4, "Не удалось добавить описание вложенной таблицы: " || sTableName || "." || colColName || "-" || colAddTabName || " FilterCode=>" || colFilterCode, "")))))
.head 10 -  Return FALSE
.head 8 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
.head 9 +  If not SqlPLSQLCommand(hSql(), dlg_SetMetaData.strSqlUpdate)
.head 10 -  Call SqlRollbackEx(hSql(), "METABASE. " ||
     IifS(nMode=1, "Не удалось изменить описание 'чужого' ключа: " || sTableName || "." || colColName || "<->" || colAddColName, 
     IifS(nMode=2, "Не удальсь изменить описание полей для условий фильтра: " || colColName || "=" || colAddColName || " ->" || colTagName, 
     IifS(nMode=3, "Не удалось изменить описание сортировки: " || sTableName || "." || colColName || "=" || Str(colSortOrder) || " " || colSortWay, 
     IifS(nMode=4, "Не удалось изменить описание вложенной таблицы: " || sTableName || "." || colColName || "-" || colAddTabName || " FilterCode=>" || colFilterCode, "")))))
.head 10 -  Return FALSE
.head 8 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
.head 9 +  If not SqlPLSQLCommand(hSql(), dlg_SetMetaData.strSqlDelete)
.head 10 -  Call SqlRollbackEx(hSql(), "METABASE. " || 
     IifS(nMode=1, "Не удалось удалить описание 'чужого' ключа: " || sTableName || "." || colColName || "<->" || colAddColName, 
     IifS(nMode=2, "Не удалось удалить описание полей для условий фильтра: " || colColName || "=" || colAddColName || " ->" || colTagName, 
     IifS(nMode=3, "Не удалось удалить описание сортировки: " || sTableName || "." || colColName || "=" || Str(colSortOrder) || " " || colSortWay, 
     IifS(nMode=4, "Не удалось удалить описание вложенной таблицы: " || sTableName || "." || colColName || "-" || colAddTabName || " FilterCode=>" || colFilterCode, "")))))
.head 10 -  Return FALSE
.head 7 -  Call SqlCommitEx(hSql(), "METABASE. " || 
     IifS(nMode=1, "Обновлено описание 'чужого' ключа: " || sTableName, 
     IifS(nMode=2, "Обновлено описание полей для условий фильтра: " || sTableName, 
     IifS(nMode=3, "Обновлено описание сортировки: " || sTableName, 
     IifS(nMode=4, "Обновлено описание вложенной таблицы: " || sTableName, "")))))
.head 6 -  Return TRUE
.head 3 -  Frame
.head 4 -  Resource Id: 61690
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.15"
.head 5 -  Width:  10.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Записать
.head 4 -  Window Location and Size
.head 5 -  Left:   8.2"
.head 5 -  Top:    3.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalSendMsg(tblMetaData, UM_Update, 0, 0)
.head 7 -  Call SalEndDialog(hWndForm, 1) 
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   9.5"
.head 5 -  Top:    3.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0) 
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  ! 1 - Extrnval
.head 3 -  ! 2 - Browsetbl
.head 3 -  ! 3 - Sortorder
.head 3 -  ! 4 - Filtertbl
.head 3 -  ! 5 - Actiontbl
.head 3 -  ! 6 - NsiFunction
.head 3 -  ! 7 - TblColor
.head 3 -  String: sParTabName
.head 3 -  Boolean: bEdit	! TRUE-Edit, FALSE-ReadOnly
.head 2 +  Window Variables
.head 3 -  Number: nTableId
.head 3 -  String: sTableName
.head 3 -  String: sTableSemantic
.head 3 -  !
.head 3 -  Number: nTmpId
.head 3 -  String: sTmpCode
.head 3 -  String: sTmpName
.head 3 -  Long String: sTmpCond
.head 3 -  String: sTmp
.head 3 -  !
.head 3 -  ! Boolean: bWebFormName
.head 3 -  ! Number: nMTAddFun
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Описание вложенности таблицы: sParTabName
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitle') || ': ' || sParTabName)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 -  ! Set bWebFormName = GetValueStr("
    SELECT to_char(count(1))
    FROM   user_tab_columns
    WHERE  TABLE_NAME='META_NSIFUNCTION' AND COLUMN_NAME='WEB_FORM_NAME'") != '0'
.head 4 -  ! Set nMTAddFun = Val(GetValueStr("
    SELECT to_char(count(1))
    FROM   user_arguments
    WHERE  OBJECT_NAME='ADD_NSIFUNCTION' AND package_name='BARS_METABASE'")) ! 10 old, 11 new
.head 4 -  !
.head 4 +  If sParTabName != ''
.head 5 -  Set sTableName = SalStrTrimX(SalStrUpperX(sParTabName))
.head 5 -  Call SqlPrepareAndExecute(hSql(), T(
"SELECT tabid, semantic
   INTO :nTableId, :sTableSemantic
   FROM meta_tables 
  WHERE tabname = :sTableName"))
.head 5 +  If SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Описание вложенности таблицы: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_ExternField.cTWndTitle') || ': ' || sParTabName ||
     ' ' || sTableSemantic)
.head 5 +  Else
.head 6 -  Call SalMessageBeep(MB_IconStop)
.head 6 -  ! sParTabName: Описание таблицы отсутствует в Мета-Базе
.head 6 -  Call SalMessageBox(sParTabName || ': ' || CurrentLangTable.GetAtomTitle('cTErr1'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 4 -  !
.head 4 +  If not bEdit
.head 5 -  Set hWndForm.dlg_SetMetaData.nFlags = GT_ReadOnly
.head 5 -  Call SalDisableWindow(pbSave)
.head 5 -  Call SalDisableWindow(tblMetaData.colColName)
.head 5 -  Call SalDisableWindow(tblMetaData.colAddTabName)
.head 5 -  Call SalDisableWindow(tblMetaData.colAddTabAlias)
.head 5 -  Call SalDisableWindow(tblMetaData.colTagName)
.head 5 -  Call SalDisableWindow(tblMetaData.colTagSemantic)
.head 5 -  Call SalDisableWindow(tblMetaData.colAddColName)
.head 5 -  Call SalDisableWindow(tblMetaData.colSortOrder)
.head 5 -  Call SalDisableWindow(tblMetaData.colSortWay)
.head 5 -  Call SalDisableWindow(tblMetaData.colFilterCode)
.head 5 -  Call SalDisableWindow(tblMetaData.colFilterCondition)
.head 5 -  Call SalDisableWindow(tblMetaData.colActionCode)
.head 5 -  Call SalDisableWindow(tblMetaData.colActionProc)
.head 5 -  !
.head 5 -  Call SalDisableWindow(tblMetaData.colNsiFuncId)
.head 5 -  Call SalDisableWindow(tblMetaData.colNsiFuncDescr)
.head 5 -  ! Call SalDisableWindow(tblMetaData.colNsiFuncId)
.head 5 -  ! Call SalDisableWindow(tblMetaData.colNsiFuncDescr)
.head 5 -  !
.head 5 -  Call SalDisableWindow(tblMetaData.colColorCondition)
.head 5 -  Call SalDisableWindow(tblMetaData.colColorIndex)
.head 5 -  Call SalDisableWindow(tblMetaData.colColorName)
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  !
.head 4 -  Call SalHideWindow(tblMetaData.colColName)
.head 4 -  Call SalHideWindow(tblMetaData.colAddTabName)
.head 4 -  Call SalHideWindow(tblMetaData.colAddTabAlias)
.head 4 -  Call SalHideWindow(tblMetaData.colColDynTabName)
.head 4 -  Call SalHideWindow(tblMetaData.colAddColName)
.head 4 -  Call SalHideWindow(tblMetaData.colTagName)
.head 4 -  Call SalHideWindow(tblMetaData.colTagSemantic)
.head 4 -  Call SalHideWindow(tblMetaData.colSortOrder)
.head 4 -  Call SalHideWindow(tblMetaData.colSortWay)
.head 4 -  Call SalHideWindow(tblMetaData.colFilterCode)
.head 4 -  Call SalHideWindow(tblMetaData.colFilterCondition)
.head 4 -  Call SalHideWindow(tblMetaData.colFilterIns)
.head 4 -  Call SalHideWindow(tblMetaData.colFilterDel)
.head 4 -  Call SalHideWindow(tblMetaData.colFilterUpd)
.head 4 -  Call SalHideWindow(tblMetaData.colActionCode)
.head 4 -  Call SalHideWindow(tblMetaData.colActionName)
.head 4 -  Call SalHideWindow(tblMetaData.colActionProc)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiFuncId)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiFuncDescr)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiFuncProc)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiFuncForm)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiFuncCheck)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiFuncFormWeb)
.head 4 -  Call SalHideWindow(tblMetaData.colNsiIconId)
.head 4 -  Call SalHideWindow(tblMetaData.colColorCondition)
.head 4 -  Call SalHideWindow(tblMetaData.colColorIndex)
.head 4 -  Call SalHideWindow(tblMetaData.colColorName)
.head 4 +  Select Case nMode
.head 5 -  ! Extrnval
.head 5 +  Case 1
.head 6 -  ! Описание связей таблицы: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleExtrnval') || ': ' || sParTabName || ' ' || sTableSemantic)
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colColName_Extrnval'))
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colAddTabName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colAddTabName_Extrnval'))
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colAddColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colAddColName_Extrnval'))
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colColDynTabName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colColDynTabName_Extrnval'))
.head 6 -  Call SalSetMaxDataLength(colAddTabAlias, 5)
.head 6 -  !
.head 6 +  If FieldInTable('COL_DYN_TABNAME', 'META_EXTRNVAL')
.head 7 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select e.colid, a.colname,  t.tabid, t.tabname, e.tab_alias,
        b.colid, t.tabname||'.'||b.colname, e.COL_DYN_TABNAME
   into :colColId, :colColName, :colAddTabId, :colAddTabName, :colAddTabAlias,
        :colAddColId, :colAddColName, :colColDynTabName
   from meta_extrnval e, meta_columns a, meta_columns b, meta_tables t
  where e.tabid    = :nTableId 
    and e.tabid    = a.tabid
    and e.colid    = a.colid
    and e.srctabid = t.tabid 
    and e.srctabid = b.tabid
    and e.srccolid = b.colid 
  order by a.colname"
.head 6 +  Else
.head 7 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select e.colid, a.colname,  t.tabid, t.tabname, e.tab_alias,
        b.colid, t.tabname||'.'||b.colname
   into :colColId, :colColName, :colAddTabId, :colAddTabName, :colAddTabAlias,
        :colAddColId, :colAddColName
   from meta_extrnval e, meta_columns a, meta_columns b, meta_tables t
  where e.tabid    = :nTableId 
    and e.tabid    = a.tabid
    and e.colid    = a.colid
    and e.srctabid = t.tabid 
    and e.srctabid = b.tabid
    and e.srccolid = b.colid 
  order by a.colname"
.head 6 +  If FieldInTable('COL_DYN_TABNAME', 'META_EXTRNVAL') and GetValueStr("
   SELECT to_char(cpar('BARS_METABASE', 'ADD_EXTRNVAL'))
   FROM   dual") = '8'
.head 7 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_extrnval(nTableId, colColId, colAddTabId, colAddColId, colAddTabAlias, STRING_Null, STRING_Null, colColDynTabName)"
.head 6 +  Else
.head 7 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_extrnval(nTableId, colColId, colAddTabId, colAddColId, colAddTabAlias, STRING_Null, STRING_Null)"
.head 6 +  If FieldInTable('COL_DYN_TABNAME', 'META_EXTRNVAL') and GetValueStr("
   SELECT to_char(cpar('BARS_METABASE', 'UPDATE_EXTRNVAL'))
   FROM   dual") = '7'
.head 7 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = "bars_metabase.update_extrnval(nTableId, colColId, colAddTabId, colAddColId, colAddTabAlias, STRING_Null, colColDynTabName)"
.head 6 +  Else
.head 7 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = "bars_metabase.update_extrnval(nTableId, colColId, colAddTabId, colAddColId, colAddTabAlias, STRING_Null)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_extrnval(nTableId, colColId)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colColName)
.head 6 -  Call SalShowWindow(tblMetaData.colAddTabName)
.head 6 -  Call SalShowWindow(tblMetaData.colAddTabAlias)
.head 6 -  Call SalShowWindow(tblMetaData.colAddColName)
.head 6 -  Call SalShowWindow(tblMetaData.colColDynTabName)
.head 6 -  Break
.head 5 -  ! Browsetbl
.head 5 +  Case 2
.head 6 -  ! Поля таблиц для условий фильтров: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleBrowsetbl') || ': ' || sParTabName || ' ' || sTableSemantic)
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colColName_Browsetbl'))
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colAddTabName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colAddTabName_Browsetbl'))
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colAddColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colAddColName_Browsetbl'))
.head 6 -  !
.head 6 -  Call SalSetMaxDataLength(colAddTabAlias, 2)
.head 6 -  !
.head 6 -  Call SalTblSetLockedColumns(tblMetaData, 6)
.head 6 -  Call SalTblSetColumnPos(tblMetaData.colColName, 10)
.head 6 -  !
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select ch.colid, '" || sTableName ||".'||ch.colname, ta.tabid, ta.tabname, b.addtabalias,
        ca.colid, ta.tabname||'.'||ca.colname, cv.colid, ta.tabname||'.'||cv.colname, b.cond_tag
   into :colColId, :colColName, :colAddTabId, :colAddTabName, :colAddTabAlias, 
        :colAddColId, :colAddColName, :colTagId, :colTagName, :colTagSemantic        
   from meta_browsetbl b, meta_columns ca, meta_tables ta, meta_columns ch, meta_columns cv
  where b.hosttabid = :nTableId
    and b.hosttabid = ch.tabid and b.hostcolkeyid = ch.colid
    and b.addtabid  = ta.tabid
    and b.addtabid  = ca.tabid and b.addcolkeyid  = ca.colid
    and b.addtabid  = cv.tabid and b.var_colid    = cv.colid
  order by b.addtabid, b.var_colid"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_browsetbl(nTableId, colAddTabId, 
    colAddTabAlias, colColId, colAddColId, colTagId, colTagSemantic)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = "bars_metabase.update_browsetbl(nTableId, colAddTabId, 
    colAddTabAlias, colColId, colAddColId, colTagId, colTagSemantic)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_browsetbl(nTableId, colAddTabId, 
    colColId, colAddColId, colTagId)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colColName)
.head 6 -  Call SalShowWindow(tblMetaData.colAddTabName)
.head 6 -  Call SalShowWindow(tblMetaData.colAddTabAlias)
.head 6 -  Call SalShowWindow(tblMetaData.colAddColName)
.head 6 -  Call SalShowWindow(tblMetaData.colTagName)
.head 6 -  Call SalShowWindow(tblMetaData.colTagSemantic)
.head 6 -  Break
.head 5 -  ! Sortorder
.head 5 +  Case 3
.head 6 -  ! Описание сортировки таблицы: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleSortorder') || ': ' || sParTabName || ' ' || sTableSemantic)
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colColName_Sortorder'))
.head 6 -  !
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select c.colid, c.colname, s.sortorder, s.sortway
   into :colColId, :colColName, :colSortOrder, :colSortWay
   from meta_sortorder s, meta_columns c
  where s.tabid = :nTableId 
    and s.tabid = c.tabid
    and s.colid = c.colid 
  order by s.sortorder"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_sortorder(nTableId, colColId, colSortOrder, colSortWay)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = "bars_metabase.update_sortorder(nTableId, colColId, colSortOrder, colSortWay)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_sortorder(nTableId, colColId)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colColName)
.head 6 -  Call SalShowWindow(tblMetaData.colSortOrder)
.head 6 -  Call SalShowWindow(tblMetaData.colSortWay)
.head 6 -  Break
.head 5 -  ! Filtertbl
.head 5 +  Case 4
.head 6 -  ! Описание вложенности таблицы: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleFiltertbl') || ': ' || sParTabName || ' ' || sTableSemantic)
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colColName_Filtertbl'))
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colAddTabName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colAddTabName_Filtertbl'))
.head 6 -  !
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select c.colid, c.colname, t.tabid, t.tabname, d.code, d.condition,
        f.flag_ins, f.flag_del, f.flag_upd
   into :colColId, :colColName, :colAddTabId, :colAddTabName, :colFilterCode, :colFilterCondition,
        :colFilterIns, :colFilterDel, :colFilterUpd
   from meta_filtertbl f, meta_filtercodes d, meta_columns c, meta_tables t
  where f.tabid        = :nTableId
    and f.filter_code  = d.code
    and f.tabid        = c.tabid
    and f.colid        = c.colid
    and f.filter_tabid = t.tabid
  order by c.colname"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_filtertbl(nTableId, colColId, colAddTabId, colFilterCode, colFilterIns, colFilterDel, colFilterUpd)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = "bars_metabase.update_filtertbl(nTableId, colColId, colAddTabId, colFilterCode, colFilterIns, colFilterDel, colFilterUpd)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_filtertbl(nTableId, colColId)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colColName)
.head 6 -  Call SalShowWindow(tblMetaData.colAddTabName)
.head 6 -  Call SalShowWindow(tblMetaData.colFilterCode)
.head 6 -  Call SalShowWindow(tblMetaData.colFilterCondition)
.head 6 -  Call SalShowWindow(tblMetaData.colFilterIns)
.head 6 -  Call SalShowWindow(tblMetaData.colFilterDel)
.head 6 -  Call SalShowWindow(tblMetaData.colFilterUpd)
.head 6 -  Break
.head 5 -  ! Actiontbl
.head 5 +  Case 5
.head 6 -  ! Описание выполняемых процедур таблицы: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleActiontbl') || ': ' || sParTabName || ' ' || sTableSemantic)
.head 6 -  !
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select a.code, a.name, t.action_proc
   into :colActionCode, :colActionName, :colActionProc
   from meta_actiontbl t, meta_actioncodes a
  where t.tabid       = :nTableId
    and t.action_code = a.code
  order by a.code"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_actiontbl(nTableId, colActionCode, colActionProc)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = "bars_metabase.update_actiontbl(nTableId, colActionCode, colActionProc)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_actiontbl(nTableId, colActionCode)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colActionCode)
.head 6 -  Call SalShowWindow(tblMetaData.colActionName)
.head 6 -  Call SalShowWindow(tblMetaData.colActionProc)
.head 6 -  Break
.head 5 -  ! NsiFunction
.head 5 +  Case 6
.head 6 -  ! Описание функций справочника: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleNsiFunction') || ': ' ||
     sParTabName || ' ' || sTableSemantic)
.head 6 -  !
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = "
    select funcid, descr, proc_name, proc_par, proc_exec, qst, msg, form_name, check_func, web_form_name, icon_id
    into   :colNsiFuncId, :colNsiFuncDescr, :colNsiFuncProc, :colNsiFuncPar, :colNsiFuncExec, :colNsiFuncQst,
           :colNsiFuncMsg, :colNsiFuncForm, :colNsiFuncCheck, :colNsiFuncFormWeb, :colNsiIconId
     from  meta_Nsifunction
     where tabid = :nTableId
     order by funcid"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_Nsifunction(nTableId, colNsiFuncId, colNsiFuncDescr,
    colNsiFuncProc, colNsiFuncPar, colNsiFuncExec, colNsiFuncQst, colNsiFuncMsg, colNsiFuncForm, colNsiFuncCheck,
    colNsiFuncFormWeb, colNsiIconId)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = ""
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_Nsifunction(nTableId)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncId)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncDescr)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncProc)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncForm)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncCheck)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncFormWeb)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiIconId)
.head 6 -  Break
.head 5 -  ! TblColor
.head 5 +  Case 7
.head 6 -  ! Описание раскраски таблицы: sParTabName sTableSemantic
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetMetaData.cTWndTitleNsiFunctionColor') || ': ' ||
     sParTabName || ' ' || sTableSemantic)
.head 6 -  Call SalTblSetColumnTitle(hWndForm.dlg_SetMetaData.tblMetaData.colColName,
     CurrentLangTable.GetAtomTitle('dlg_SetMetaData.tblMetaData.colColName_Sortorder'))
.head 6 -  Call SalTblSetColumnPos(tblMetaData.colColName, 22)
.head 6 -  !
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlPopulate = 
"select t.ord, t.colid, c.colname, t.condition, 
        case when t.color_index = 1 then 'TEXT'
             when t.color_index = 2 then 'BACKGROUND'
             else ''
        end,
        t.color_name
   into :colNsiFuncId, :colColId, :colColName, :colColorCondition, :colColorIndex, :colColorName
   from meta_tblcolor t, meta_columns c
  where t.tabid = :nTableId
    and t.tabid = c.tabid(+)
    and t.colid = c.colid(+)
  order by t.ord"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlInsert = "bars_metabase.add_tblcolor(nTableId, colNsiFuncId, colColId, 
    colColorCondition, colColorIndex, colColorName)"
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlUpdate = ""
.head 6 -  Set hWndForm.dlg_SetMetaData.strSqlDelete = "bars_metabase.delete_tblcolor(nTableId)"
.head 6 -  !
.head 6 -  Call SalShowWindow(tblMetaData.colColName)
.head 6 -  Call SalShowWindow(tblMetaData.colNsiFuncId)
.head 6 -  Call SalShowWindow(tblMetaData.colColorCondition)
.head 6 -  Call SalShowWindow(tblMetaData.colColorIndex)
.head 6 -  Call SalShowWindow(tblMetaData.colColorName)
.head 6 -  Break
.head 5 +  Default
.head 6 -  Break
.head 3 -  On SAM_DoubleClick	! Не убирать !
.head 3 +  On WM_MouseMove
.head 4 -  Call SalStatusSetText(hWndForm, '')
.head 1 -  !
.head 1 +  Dialog Box: dlg_MetaSync
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Синхронизация с записями системных таблиц
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Диалог синхронизации метабазы с системными таблицами INFORMIX release.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! Group Box: Метаописание комплекса
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.043"
.head 5 -  Top:    0.552"
.head 5 -  Width:  4.957"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.end
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.15"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.15"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Метаописание комплекса
.head 4 -  Resource Id: 8410
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.05"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.15"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMeta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblMeta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.25"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colAction
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text: [o]
.head 7 -  Text: [X]
.head 6 -  Message Actions
.head 5 +  Column: colColName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Поле
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColLen
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Длина
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colStatus
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColSemantic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Семантическое описание поля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ColId
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SalListSetSelect(colAction, 0)
.head 3 -  ! Group Box: Описание в системных таблицах
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.014"
.head 5 -  Top:    0.552"
.head 5 -  Width:  4.957"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.end
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.4"
.head 5 -  Top:    0.15"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.15"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Описание в системных таблицах
.head 4 -  Resource Id: 8411
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.5"
.head 5 -  Top:    0.05"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSys
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblSys
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.5"
.head 6 -  Top:    0.274"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colAction
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Действие
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text: [o]
.head 7 -  Text: [+]
.head 7 -  Text: [=]
.head 6 -  Message Actions
.head 5 +  Column: colColName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Поле
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColLen
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Длина
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colStatus
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colColSemantic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Семантическое описание поля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SalListSetSelect(colAction, 0)
.head 6 +  If SalStrUpperX(SalStrTrimX(GetDBMS())) = 'ORACLE'
.head 7 -  Set colColType = SalNumberToChar(nTmpType)
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 51916
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    4.35"
.head 5 -  Width:  10.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSync
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   7.9"
.head 5 -  Top:    4.45"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call FunMetaSyncDoIt()
.head 6 -  Call SalSendMsg(hWndForm, SAM_User, 0, 0)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   9.2"
.head 5 -  Top:    4.45"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 2 +  Functions
.head 3 +  Function: FunMetaGetSyncStatus
.head 4 -  Description: Анализирует таблицы данных и присваивает статус синхронизации записям.
Значения статуса - см. константы MSync_* 
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nContrRow
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tblMeta, nRow, 0, 0)
.head 6 -  Call SalTblFetchRow(tblMeta, nRow)
.head 6 -  !
.head 6 -  Set tblMeta.colStatus = MSync_Equal
.head 6 -  !
.head 6 -  Set nContrRow = VisTblFindString(tblSys, 0, tblSys.colColName, tblMeta.colColName)
.head 6 +  If nContrRow != -1
.head 7 -  Call SalTblFetchRow (tblSys, nContrRow)
.head 7 +  If tblMeta.colColType != tblSys.colColType OR
   (tblMeta.colColType != 'D' AND tblMeta.colColLen != tblSys.colColLen) OR
   tblMeta.colColSemantic != tblSys.colColSemantic
.head 8 -  Set tblMeta.colStatus = MSync_Different
.head 8 -  Call VisTblSetRowColor(tblMeta, nRow, COLOR_Blue)
.head 6 +  Else
.head 7 -  Set tblMeta.colStatus = MSync_Absent
.head 7 -  Call VisTblSetRowColor(tblMeta, nRow, COLOR_Red)
.head 7 -  Call SalListSetSelect(tblMeta.colAction, 1)
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tblSys, nRow, 0, 0)
.head 6 -  Call SalTblFetchRow(tblSys, nRow)
.head 6 -  !
.head 6 -  Set tblSys.colStatus = MSync_Equal
.head 6 -  !
.head 6 -  Set nContrRow = VisTblFindString(tblMeta, 0, tblMeta.colColName, tblSys.colColName)
.head 6 +  If nContrRow != -1
.head 7 -  Call SalTblFetchRow (tblMeta, nContrRow)
.head 7 +  If tblMeta.colColType != tblSys.colColType OR
   (tblMeta.colColType != 'D' AND tblMeta.colColLen != tblSys.colColLen) OR
   tblMeta.colColSemantic != tblSys.colColSemantic
.head 8 -  Set tblSys.colStatus = MSync_Different
.head 8 -  Call VisTblSetRowColor(tblSys, nRow, COLOR_Blue)
.head 8 -  Call SalListSetSelect(tblSys.colAction, 2)
.head 6 +  Else
.head 7 -  Set tblMeta.colStatus = MSync_Absent
.head 7 -  Call VisTblSetRowColor(tblSys, nRow, COLOR_DarkGreen)
.head 7 -  Call SalListSetSelect(tblSys.colAction, 1)
.head 3 +  Function: FunMetaSyncDoIt
.head 4 -  Description: Исполняет синхронизацию по указанным в таблицам действиям.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowCnt
.head 5 -  Number: nNewCol
.head 4 +  Actions
.head 5 -  ! Синхронизация схемы приведет к изменению (или добавлению) атрибутов колонок:
  Тип, Длина, Семантика. Остальные атрибуты необходимо будет внести вручную. Вы хотите продолжить
.head 5 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_MetaSync.cTSync'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo | MB_DefButton1) = IDYES
.head 6 -  !
.head 6 -  Set nRowCnt = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblMeta, nRowCnt, 0, 0)
.head 7 -  Call SalTblFetchRow (tblMeta, nRowCnt)
.head 7 +  If SalStrTrimX(tblMeta.colAction) = '[X]'
.head 8 +  If SqlPLSQLCommand(conOther.hSql(), "bars_metabase.delete_metacolumns(nTabId, tblMeta.colColId)")
.head 9 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Синхронизация: удалено описание колонки " || sTabName || "." ||
     tblMeta.colColName)
.head 8 +  Else
.head 9 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Синхронизация: не удалось удалить описание колонки " || sTabName
     || "." || tblMeta.colColName)
.head 6 -  !
.head 6 -  Set nRowCnt = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblSys, nRowCnt, 0, 0)
.head 7 -  Call SalTblFetchRow (tblSys, nRowCnt)
.head 7 +  If SalStrTrimX(tblSys.colAction) = '[+]'
.head 8 +  If SqlPLSQLCommand(conOther.hSql(), "bars_metabase.add_column(nTabId, NUMBER_Null, tblSys.colColName,
   tblSys.colColType, tblSys.colColSemantic, NUMBER_Null, tblSys.colColLen, NUMBER_Null, NUMBER_Null, NUMBER_Null,
   NUMBER_Null, NUMBER_Null, STRING_Null, STRING_Null, NUMBER_Null, 0, STRING_Null, 0, 0, 0, STRING_Null,
   STRING_Null, 0)")
.head 9 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Синхронизация: добавлено описание колонки " || sTabName || "." ||
     tblSys.colColName)
.head 8 +  Else
.head 9 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Синхронизация: не удалось добавить описание колонки " || sTabName
     || "." || tblSys.colColName)
.head 7 +  Else If SalStrTrimX(tblSys.colAction) = '[=]'
.head 8 +  If SqlPLSQLCommand(conOther.hSql(), "bars_metabase.sync_column(nTabId, tblSys.colColName, tblSys.colColType,
   tblSys.colColSemantic, tblSys.colColLen)")
.head 9 -  Call SqlCommitEx(conOther.hSql(), "METABASE. Синхронизация: синхронизировано описание колонки " || sTabName ||
     "." || tblSys.colColName)
.head 8 +  Else
.head 9 -  Call SqlRollbackEx(conOther.hSql(), "METABASE. Синхронизация: не удалось синхронизировать описание колонки " ||
     sTabName || "." || tblSys.colColName)
.head 2 +  Window Parameters
.head 3 -  String: sTabName
.head 2 +  Window Variables
.head 3 -  Number: nTabId
.head 3 -  String: sTabSemantic
.head 3 -  String: strTmpBind
.head 3 -  Number: nTmpType
.head 3 -  !
.head 3 -  : conMeta
.head 4 -  Class: cABSConnect
.head 3 -  : conSys
.head 4 -  Class: cABSConnect
.head 3 -  : conOther
.head 4 -  Class: cABSConnect
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XConnectGetParams(conOther)
.head 4 +  If NOT conOther.Connect()
.head 5 -  Return FALSE
.head 4 -  Call conMeta.Clone(conOther, TRUE)
.head 4 -  Call conSys.Clone(conOther, TRUE)
.head 4 -  !
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 +  If sTabName != ''
.head 5 -  Call SqlPrepareAndExecute(conOther.hSql(), T('
     SELECT tabid, semantic
     FROM   meta_tables
     INTO   :nTabId, :sTabSemantic
     WHERE trim(tabname)=:sTabName'))
.head 5 -  Call SqlFetchNext(conOther.hSql(), nFetchRes)
.head 5 -  Call SalSendMsg(hWndForm, SAM_User, 0, 0)
.head 4 -  ! Синхронизация с записями системных таблиц:
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaSync.cTWndTitle') || ': ' || sTabName || ' ' ||
     sTabSemantic)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 3 +  On SAM_User
.head 4 -  ! Население таблиц...
.head 4 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaSync.cTPopulate'))
.head 4 -  !
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(tblMeta, conMeta.hSql(),T("
     select c.colid, trim(c.colname), trim(c.coltype), c.showmaxchar, trim(c.semantic)
     into   :tblMeta.colColId, :tblMeta.colColName, :tblMeta.colColType, :tblMeta.colColLen, :tblMeta.colColSemantic
     from   meta_columns c, meta_tables t
     where t.tabid=:nTabId and t.tabid=c.tabid
     order by 1"), TBL_FillAll)
.head 4 -  !
.head 4 -  Set strTmpBind = SalStrUpperX(SalStrTrimX(sTabName))
.head 4 -  Call SalTblPopulate(tblSys, conSys.hSql(), "
     select rtrim(t.column_name), p_coltype(t.data_type), decode(t.DATA_TYPE,'DATE',t.data_length+3,t.data_length),
            substr(c.comments,1,80)
     into   :tblSys.colColName, :nTmpType, :tblSys.colColLen, :tblSys.colColSemantic
     from   all_tab_columns t, all_col_comments c
     where  rtrim(t.table_name)=:strTmpBind and rtrim(t.table_name)=rtrim(c.table_name) and
            rtrim(t.column_name)=rtrim(c.column_name) and t.owner='BARS' and t.owner=c.owner
            order by 1", TBL_FillAll)
.head 4 -  ! Подождите, анализируется схема...
.head 4 -  Call SalStatusSetText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaSync.cTWait'))
.head 4 -  Call FunMetaGetSyncStatus()
.head 4 -  !
.head 4 -  Call SalStatusSetText(hWndForm, '')
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call conMeta.Disconnect()
.head 4 -  Call conSys.Disconnect()
.head 4 -  Call conOther.Disconnect()
.head 1 -  !
.head 1 +  Dialog Box: dlg_MetaTAccess
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Типы доступа к ресурсам
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Ведение справочника типов доступа к ресурсам комплекса
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.4"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNewRecord
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Добавить новую запись
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cBTipNewRecord')
.head 6 +  On SAM_Click
.head 7 -  Set nNewRow = SalTblInsertRow(tblTypes, TBL_MaxRow)
.head 7 +  If nNewRow != TBL_Error
.head 8 -  Call SalTblSetFocusRow(tblTypes, nNewRow)
.head 8 -  Call SalTblSetContext(tblTypes, nNewRow)
.head 8 -  Call SalSendMsg(tblTypes, SAM_RowSetContext, 0, 0)
.head 4 +  Pushbutton: pbMarkDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Пометить выделенные записи на удаление
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cBTipMarkDel')
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSetFlagsAnyRows(tblTypes, ROW_MarkDeleted, TRUE, ROW_Selected, 0)
.head 4 +  Pushbutton: pbUnMarkDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Снять пометку на удаление у выделенных записей
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cBTipUnMarkDel')
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSetFlagsAnyRows(tblTypes, ROW_MarkDeleted, FALSE, ROW_Selected | ROW_MarkDeleted, 0)
.head 4 -  Line
.head 5 -  Resource Id: 6876
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.5"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.5"
.head 6 -  End Y:  0.583"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.633"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перечитать записи
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tblTypes, SAM_User, 0, 0)
.head 2 +  Contents
.head 3 +  Child Table: tblTypes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  9.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.8"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colACode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
доступа
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 8
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPopulate
.head 5 -  String: strUpdate
.head 5 -  String: strInsert
.head 5 -  String: strDelete
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblReset(hWndItem)
.head 6 -  Call SalTblPopulate(hWndItem, conT.hSql(), T(strPopulate), TBL_FillAll)
.head 6 -  Call SalTblSetContext(hWndItem, 0)
.head 6 -  Call SalTblSetFocusRow(hWndItem, 0)
.head 6 -  Call WaitCursorOff()
.head 3 -  Frame
.head 4 -  Resource Id: 6875
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.85"
.head 5 -  Width:  8.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.2"
.head 5 -  Top:    2.95"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalTblAnyRows( tblTypes, ROW_MarkDeleted | ROW_New | ROW_Edited, 0 )
.head 7 +  If SalTblAnyRows( tblTypes, ROW_New, 0 )
.head 8 +  If SqlPrepare( conT.hSql(),  T( tblTypes.strInsert ))
.head 9 +  If SalTblDoInserts( tblTypes, conT.hSql(), TRUE ) 
.head 10 -  Call SqlCommit( conT.hSql() )
.head 7 +  If SalTblAnyRows( tblTypes, ROW_Edited, 0 )
.head 8 +  If SqlPrepare( conT.hSql(),  T( tblTypes.strUpdate ))
.head 9 +  If SalTblDoUpdates( tblTypes, conT.hSql(), TRUE )
.head 10 -  Call SqlCommit( conT.hSql() )
.head 7 +  If SalTblAnyRows( tblTypes, ROW_MarkDeleted, 0 )
.head 8 +  If SqlPrepare( conT.hSql(),  T( tblTypes.strDelete ))
.head 9 +  If SalTblDoDeletes( tblTypes, conT.hSql(), ROW_MarkDeleted )
.head 10 -  Call SqlCommit( conT.hSql() )
.head 6 -  Call SalEndDialog( hWndForm, 1)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.6"
.head 5 -  Top:    2.95"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nNewRow
.head 3 -  : conT
.head 4 -  Class: cABSConnect
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XConnectGetParams(conT)
.head 4 +  If NOT conT.Connect()
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Описание сортировки таблицы
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaTAccess.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 -  Set tblTypes.strPopulate = 
"SELECT acode, name
   FROM meta_taccess
   INTO :tblTypes.colACode, :tblTypes.colAName
  ORDER BY acode, name"
.head 4 -  !
.head 4 -  Set tblTypes.strInsert = 
"INSERT INTO meta_taccess (acode, name) 
 VALUES (:tblTypes.colACode, :tblTypes.colAName)"
.head 4 -  !
.head 4 -  Set tblTypes.strDelete = 
"DELETE FROM meta_taccess 
  WHERE acode = :tblTypes.colACode"
.head 4 -  !
.head 4 -  Set tblTypes.strUpdate = 
"UPDATE meta_taccess 
    SET name = :tblTypes.colAName
  WHERE acode = :tblTypes.colACode"
.head 4 -  !
.head 4 -  Call SalSendMsg(tblTypes, SAM_User, 0, 0)
.head 3 +  On WM_MouseMove
.head 4 -  Call SalStatusSetText( hWndForm, '' )
.head 3 +  On SAM_Destroy
.head 4 -  Call conT.Disconnect()
.head 1 +  Dialog Box: dlg_GetObjectId
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.45"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.2"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Получает идентификатор таблицы или колонки
после выбора его в таблице
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  Background Text: Поиск:
.head 5 -  Resource Id: 8520
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.2"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.25"
.head 7 -  Top:    0.15"
.head 7 -  Width:  4.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_AnyEdit
.head 7 -  Call SalSendMsg(tblObjList, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Выбрать
.head 5 -  Window Location and Size
.head 6 -  Left:   5.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.45"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(tblObjList, SAM_DoubleClick, 0, 0)
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Отменить
.head 5 -  Window Location and Size
.head 6 -  Left:   6.733"
.head 6 -  Top:    0.063"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.45"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog(dlg_GetObjectId, 0)
.head 2 +  Contents
.head 3 +  Child Table: tblObjList
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.014"
.head 6 -  Top:    0.042"
.head 6 -  Width:  8.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.4"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: #
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colObjName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colObjSemantic
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Семантика
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nId
.head 7 -  String: sName
.head 7 -  String: sSem
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Set sStrPopulate = 'SELECT '
.head 7 +  If nMode = GET_TABLE
.head 8 -  Set sStrPopulate = sStrPopulate || ' tabid, tabname, semantic FROM meta_tables '
.head 7 +  Else
.head 8 -  Set sStrPopulate = sStrPopulate || ' colid, colname, semantic FROM meta_columns '
.head 7 -  Set sStrPopulate = sStrPopulate || ' INTO :nId, :sName, :sSem'
.head 7 +  If sFilter != ''
.head 8 -  Set sStrPopulate = sStrPopulate || ' WHERE ' || sFilter
.head 7 +  If nMode = GET_COLUMN
.head 8 +  If sFilter != ''
.head 9 -  Set sStrPopulate = sStrPopulate || ' AND tabid = :nMasterObjID '
.head 8 +  Else
.head 9 -  Set sStrPopulate = sStrPopulate || ' WHERE tabid = :nMasterObjID '
.head 7 -  Set sStrPopulate = sStrPopulate || ' ORDER BY 2 '
.head 7 -  Set i = 0
.head 7 -  Call SqlPrepareAndExecute(hSql(), sStrPopulate)
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set nmId[i]   = nId
.head 8 -  Set smName[i] = sName
.head 8 -  Set smSem[i]  = sSem
.head 8 -  Set i = i + 1
.head 7 -  Set nRecNum = i
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Call SalTblReset(hWndForm)
.head 7 +  While i < nRecNum
.head 8 +  If sName = ''
.head 9 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 9 -  Call SalTblSetContext(hWndForm, nRow)
.head 9 -  Set colID          = nmId[i]
.head 9 -  Set colObjName     = smName[i]
.head 9 -  Set colObjSemantic = smSem[i]
.head 8 +  Else
.head 9 +  If SalStrScan(SalStrUpperX(smName[i]), SalStrUpperX(sName)) = 0
.head 10 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 10 -  Call SalTblSetContext(hWndForm, nRow)
.head 10 -  Set colID          = nmId[i]
.head 10 -  Set colObjName     = smName[i]
.head 10 -  Set colObjSemantic = smSem[i]
.head 8 -  Set i = i + 1
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  String: sStrPopulate
.head 5 -  Number: nmId[*]
.head 5 -  String: smName[*]
.head 5 -  String: smSem[*]
.head 5 -  Number: nRecNum
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call Init()
.head 6 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call Populate(dfName)
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nObjID = colID
.head 6 -  Set strObjName = colObjName
.head 6 -  Call SalEndDialog(dlg_GetObjectId, 1)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nMasterObjID
.head 3 -  String: sFilter
.head 3 -  Receive Number: nObjID
.head 3 -  Receive String: strObjName
.head 2 +  Window Variables
.head 3 -  : conT
.head 4 -  Class: cABSConnect
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XConnectGetParams(conT)
.head 4 +  If NOT conT.Connect()
.head 5 -  Return FALSE
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 +  If nMode = GET_TABLE
.head 5 -  ! Таблицы...
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_GetObjectId.cTWndTitleTable'))
.head 4 +  Else
.head 5 -  ! Поля таблицы...
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_GetObjectId.cTWndTitleColumn'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalStrTrim(SalStrUpperX(sFilter), sFilter)
.head 4 -  Call SalSetFocus(dfName)
.head 3 +  On SAM_Destroy
.head 4 -  Call conT.Disconnect()
.head 1 +  Dialog Box: dlg_GetCode
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.25"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.2"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Получает код фильтра/действия
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.55"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Поиск
.head 5 -  Window Location and Size
.head 6 -  Left:   0.114"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.45"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SEARCH_X.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call tblCodeList.FindCode()
.head 4 +  Pushbutton: pbSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Выбрать
.head 5 -  Window Location and Size
.head 6 -  Left:   8.3"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.45"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(tblCodeList, SAM_DoubleClick, 0, 0)
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Отменить
.head 5 -  Window Location and Size
.head 6 -  Left:   9.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.45"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog(hWndForm, 0)
.head 2 +  Contents
.head 3 +  Child Table: tblCodeList
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  11.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.4"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colCode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCondition
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условие фильтра
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colCondition
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colCondition = sTmp
.head 7 +  On SAM_Click
.head 8 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 8 -  Call XSalTooltipShow(hWndForm, colCondition)
.head 8 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 4 +  Functions
.head 5 +  Function: FindCode
.head 6 -  Description: Поиск объекта
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSearchCol
.head 7 -  String: sSearchValue
.head 7 -  !
.head 7 -  String: strTrans
.head 7 -  Number: nRowFocus
.head 7 -  Window Handle: hWndCol
.head 6 +  Actions
.head 7 -  Set sSearchValue = '*'
.head 7 +  If GetTblSearchVal(hWndForm, nSearchCol, sSearchValue)
.head 8 -  Set strTrans = StrMatches2Like(sSearchValue)
.head 8 -  Call SalTblQueryFocus(hWndForm, nRowFocus, hWndCol)
.head 8 +  If nRowFocus > 0
.head 9 -  Set nRowFocus = nRowFocus + 1
.head 8 -  Set hWndCol = SalTblGetColumnWindow(hWndForm, nSearchCol, COL_GetPos)
.head 8 -  Call SalTblSetFocusRow(hWndForm, VisTblFindString(hWndForm, nRowFocus, hWndCol, strTrans))
.head 4 +  Window Variables
.head 5 -  Long String: sTmp
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SqlSetLongBindDatatype(3, 22)
.head 6 -  Call SalTblPopulate(hWndItem, conT.hSql(), strSqlPopulate, TBL_FillAll)
.head 6 -  Call SalTblSetFocusRow(hWndItem, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sCode = colCode
.head 6 -  Set sName = colName
.head 6 -  Set sCond = colCondition
.head 6 -  Call SalEndDialog(dlg_GetCode, 1)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Receive String: sCode
.head 3 -  Receive String: sName
.head 3 -  Receive Long String: sCond
.head 2 +  Window Variables
.head 3 -  : conT
.head 4 -  Class: cABSConnect
.head 3 -  String: strSqlPopulate
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XConnectGetParams(conT)
.head 4 +  If NOT conT.Connect()
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 +  Select Case nMode
.head 5 +  Case 1
.head 6 -  ! Фильтры...
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_GetCode.cTWndTitleFilters'))
.head 6 -  !
.head 6 -  Set strSqlPopulate = 
"select code, name, condition
   into :colCode, :colName, :colCondition
   from meta_filtercodes 
  order by code"
.head 6 -  Break
.head 5 +  Case 2
.head 6 -  ! Действия...
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_GetCode.cTWndTitleActions'))
.head 6 -  Call SalHideWindow(tblCodeList.colCondition)
.head 6 -  Call SalTblSetColumnWidth(tblCodeList.colName, 4)
.head 6 -  Set strSqlPopulate = 
"select code, name
   into :colCode, :colName
   from meta_actioncodes 
  order by code"
.head 6 -  Break
.head 5 +  Case 3
.head 6 -  ! Справочнки...
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_GetCode.cTWndTitleReferences'))
.head 6 -  Call SalHideWindow(tblCodeList.colCondition)
.head 6 -  Call SalTblSetColumnWidth(tblCodeList.colName, 4)
.head 6 -  Set strSqlPopulate = 
"select type, name
   into :colCode, :colName
   from typeref 
  order by type"
.head 6 -  Break
.head 5 +  Default
.head 6 -  Break
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 3 +  On SAM_Destroy
.head 4 -  Call conT.Disconnect()
.head 1 +  Dialog Box: dlg_MetaFltTblFilter
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Фильтры на вложенные справочники
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.25"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17008
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17009
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17010
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  4.133"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.133"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblFilters
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  11.15"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
фильтра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
фильтра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCondition
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условие фильтра
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 2000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Class Default
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sParTabName
.head 3 -  Boolean: bEdit
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Фильтры на вложенные справочники
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaFltTblFilter.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 +  If not bEdit
.head 5 -  Set hWndForm.dlg_MetaFltTblFilter.nFlags = GT_ReadOnly
.head 5 -  Call SalDisableWindow(tblFilters.colCode)
.head 5 -  Call SalDisableWindow(tblFilters.colName)
.head 5 -  Call SalDisableWindow(tblFilters.colCondition)
.head 4 -  !
.head 4 -  Set hWndForm.dlg_MetaFltTblFilter.strPrintFileName = 'meta_flt'
.head 4 -  Set hWndForm.dlg_MetaFltTblFilter.strSqlPopulate = 
"select code, name, condition
   into :hWndForm.tblFilters.colCode, :hWndForm.tblFilters.colName, :hWndForm.tblFilters.colCondition
   from meta_filtercodes
  order by code"
.head 4 -  Set hWndForm.dlg_MetaFltTblFilter.strSqlInsert = 
"insert into meta_filtercodes (code, name, condition)
 values (:hWndForm.tblFilters.colCode, :hWndForm.tblFilters.colName, :hWndForm.tblFilters.colCondition)"
.head 4 -  Set hWndForm.dlg_MetaFltTblFilter.strSqlUpdate = 
"update meta_filtercodes
    set name = :hWndForm.tblFilters.colName, 
        condition = :hWndForm.tblFilters.colCondition
  where code = :hWndForm.tblFilters.colCode"
.head 4 -  Set hWndForm.dlg_MetaFltTblFilter.strSqlDelete = 
"delete from meta_filtercodes
  where code = :hWndForm.tblFilters.colCode"
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 -  On SAM_DoubleClick	! Не убирать !
.head 1 -  !
.head 1 -  ! /////////////////////////////////////////////////////////////
.head 1 +  Dialog Box: dlg_MetaExp
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Экспорт МетаДанных
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.467"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.2"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Экспорт МетаДанных в файл:
.head 4 -  Resource Id: 3804
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.25"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    0.5"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbSelect
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать...
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    0.452"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strFile = dfPath
.head 6 -  ! Call SalDlgSaveFile ( MetaExp, "Экспорт МетаОписания", strFilters, 2, ind, strFile, strPath )
.head 6 -  Call SalDlgSaveFile(dlg_MetaExp, CurrentLangTable.GetAtomTitle('dlg_MetaExp.cTExport'), strFilters, 2, ind, strFile, strPath)
.head 6 -  Set dfPath = IifS(strPath != '', strPath, dfPath)
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.202"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call MetaExport(dfPath, Name_Tab)
.head 6 +  If nCount = 1
.head 7 -  Call MetaExport(dfPath, smName_Tab[1])
.head 6 +  Else
.head 7 -  Set nI = 1
.head 7 +  While nI <= nCount
.head 8 -  Set sFileName = VisFileCreateTemp('Meta')
.head 8 -  Call MetaExport(sFileName, smName_Tab[nI])
.head 8 -  Call VisFileAppend(sFileName, dfPath) 
.head 8 -  Call VisFileDelete(sFileName)
.head 8 -  Set nI = nI + 1
.head 6 -  Call SalDestroyWindow (dlg_MetaExp)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    1.2"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(dlg_MetaExp)
.head 3 -  Frame
.head 4 -  Resource Id: 10743
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  6.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.94"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 10742
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.024"
.head 5 -  Width:  6.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.821"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! String: Name_Tab
.head 3 -  String: smName_Tab[1:*]
.head 3 -  Number: nCount
.head 2 +  Window Variables
.head 3 -  String: strFilters[0:1]
.head 3 -  String: strFile
.head 3 -  String: strPath
.head 3 -  Number: ind
.head 3 -  !
.head 3 -  Number: nI
.head 3 -  String: sFileName
.head 3 -  String: s1
.head 3 -  String: s8
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Экспорт МетаДанных
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaExp.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 -  Set strFilters[0] = '*.sql'		
.head 4 -  Set strFilters[1] = '*.sql'
.head 4 -  ! SalNumberRandom ( )
.head 4 -  ! Set dfPath = GetPrnDir() || '\\' || Subs(Name_Tab, 1, 8) || '.sql'
.head 4 +  If nCount = 1
.head 5 -  Set dfPath = GetPrnDir() || '\\' || Left(smName_Tab[1], 8) || '.sql'
.head 4 +  Else
.head 5 -  ! Set s8 = Str(SalNumberRandom())
.head 5 -  ! Set s1 = Left(s8, 2)
.head 5 -  ! Set dfPath = GetPrnDir() || '\\' || IifS(Val(s1)<27, Chr(Val(s1)+64) || Right(s8, Len(s8)-2),
    Chr(Val(Left(s8, 1))+64) || Right(s8, Len(s8)-1)) || '.sql'
.head 5 -  Set dfPath = GetPrnDir() || '\\' || GetValueStr("
    SELECT 'M'||substr(to_char(trunc(dr)),-7)
    FROM   (SELECT extract(day from t)*24*60*60+extract(hour from t)*60*60+extract(minute from t)*60+
                   extract(second from t) dr
            FROM   (SELECT sys_extract_utc(systimestamp)-to_date('01011970','DDMMYYYY') t
                    FROM   dual))") || '.sql'
.head 1 +  Dialog Box: dlg_MetaNsiFunction
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.55"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.988"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 63105
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.05"
.head 5 -  Width:  10.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.595"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Описание
.head 4 -  Resource Id: 63107
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.2"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDescr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDescr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.15"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Sql-процедура
.head 4 -  Resource Id: 63108
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.5"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.45"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Параметры Sql-процедуры
.head 4 -  Resource Id: 63109
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.1"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfPar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.05"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Режим вызова
.head 4 -  Resource Id: 63110
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.7"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgExec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbExec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    1.65"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 +  List Initialization
.head 5 -  Text: ONCE
.head 5 -  Text: EACH
.head 5 -  Text: SELECTED
.head 5 -  Text: EDITED
.head 5 -  Text: ALL
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call setExecDescr()
.head 5 +  On SAM_KillFocus
.head 6 +  If cmbExec = ''
.head 7 -  Set dfExecDescr = ''
.head 3 +  Multiline Field: dfExecDescr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.0"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Вопрос перед выполнением
.head 4 -  Resource Id: 63111
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.65"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgQst
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfQst
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.6"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Сообщение
.head 4 -  Resource Id: 63112
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.25"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMsg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfMsg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.2"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Функция проверки
.head 4 -  Resource Id: 20531
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.85"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCheck
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfCheck
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.8"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Вызывать форму
.head 4 -  Resource Id: 63106
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.45"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgForm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfForm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    4.4"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Вызывать форму ВЕБ
.head 4 -  Resource Id: 18485
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    5.048"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFormWeb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfFormWeb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   3.283"
.head 6 -  Top:    5.0"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 63113
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    5.774"
.head 5 -  Width:  10.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Записать
.head 4 -  Window Location and Size
.head 5 -  Left:   7.6"
.head 5 -  Top:    5.917"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set cNsiFunc.sDescr   = dfDescr
.head 6 -  Set cNsiFunc.sProc    = dfProc
.head 6 -  Set cNsiFunc.sPar     = dfPar
.head 6 -  Set cNsiFunc.sExec    = cmbExec
.head 6 -  Set cNsiFunc.sQst     = dfQst
.head 6 -  Set cNsiFunc.sMsg     = dfMsg
.head 6 -  Set cNsiFunc.sCheck   = dfCheck
.head 6 -  Set cNsiFunc.sForm    = dfForm
.head 6 -  Set cNsiFunc.sFormWeb = dfFormWeb
.head 6 -  Call SalEndDialog(hWndForm, 1) 
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   8.85"
.head 5 -  Top:    5.917"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0) 
.head 2 +  Functions
.head 3 +  Function: setExecDescr
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If cmbExec = 'ONCE'
.head 6 -  Set dfExecDescr = 'Обычное выполнение процедуры'
.head 5 +  Else If cmbExec = 'EACH'
.head 6 -  Set dfExecDescr = 'Параметры процедуры запрашиваются и процедура выполняется для КАЖДОЙ ВЫДЕЛЕННОЙ строки'
.head 5 +  Else If cmbExec = 'SELECTED'
.head 6 -  Set dfExecDescr = 'Параметры процедуры запрашиваются ОДИН РАЗ и процедура выполняется для ВЫДЕЛЕННЫХ строк'
.head 5 +  Else If cmbExec = 'EDITED'
.head 6 -  Set dfExecDescr = 'Параметры процедуры запрашиваются ОДИН РАЗ и процедура выполняется для РЕДАКТИРОВАННЫХ строк'
.head 5 +  Else If cmbExec = 'ALL'
.head 6 -  Set dfExecDescr = 'Параметры процедуры запрашиваются ОДИН РАЗ и процедура выполняется для ВСЕХ строк'
.head 5 +  Else
.head 6 -  Set dfExecDescr = ''
.head 2 +  Window Parameters
.head 3 -  Number: nTabId
.head 3 -  ! Number: nFuncId
.head 3 -  ! Receive String: sDescr
.head 3 -  ! Receive String: sProc
.head 3 -  ! Receive String: sPar
.head 3 -  ! Receive String: sExec
.head 3 -  ! Receive String: sQst
.head 3 -  ! Receive String: sMsg
.head 3 -  ! Receive String: sForm
.head 3 -  ! Receive String: sFormWeb
.head 3 -  : cNsiFunc
.head 4 -  Class: cNsiFunction
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_MetaNsiFunction.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dfDescr   = cNsiFunc.sDescr
.head 4 -  Set dfProc    = cNsiFunc.sProc
.head 4 -  Set dfPar     = cNsiFunc.sPar
.head 4 -  Set cmbExec   = cNsiFunc.sExec
.head 4 -  Set dfQst     = cNsiFunc.sQst
.head 4 -  Set dfMsg     = cNsiFunc.sMsg
.head 4 -  Set dfCheck   = cNsiFunc.sCheck
.head 4 -  Set dfForm    = cNsiFunc.sForm
.head 4 -  Set dfFormWeb = cNsiFunc.sFormWeb
.head 4 -  Call setExecDescr()
.head 4 -  Call SalSetFocus(pbCancel)
