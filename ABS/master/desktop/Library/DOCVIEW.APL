.head 0 +  Application Description: ! DOCVIEW.APD - Библиотека функций просмотра документа
! ООО Унити-Барс (C) 1996-2004
! Разработчик: Сыропоршнев Д.Л.
! /////////////////////////////////////////////
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B30000 002C000000020000 0003000000000000 0068020000F8FFFF
0040: FFE2FFFFFF190000 0019000000C90200 006A010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730C7462
0080: 6C5F4C697374446F 6373
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C646F6376696577
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C64 6F63766965772E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C646F63766965
0060: 772E72756E1D513A 5C4241525339385C 4C4942524152595C 646F63766965772E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C646F 63766965772E6170
00A0: 630000010101175C 4261727339385C42 696E5C646F637669 65772E617064175C
00C0: 4261727339385C42 696E5C646F637669 65772E646C6C175C 4261727339385C42
00E0: 696E5C646F637669 65772E6170630000 010101001D513A5C 4241525339385C4C
0100: 4942524152595C64 6F63766965772E64 6C6C1D513A5C4241 525339385C4C4942
0120: 524152595C646F63 766965772E617063 0000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0000000000000000 0000E91EB20C0500 1D00FFFF4D61696E
0020: 0029000100000000 0000000000E91E80 0A00008600FFFF49 6E7465726E616C20
0040: 46756E6374696F6E 7300200001000000 000000000000E91E 800A0000DF00FFFF
0060: 5661726961626C65 73001E0001000000 000000000000F51E 100D0000F400FFFF
0080: 436C617373657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? Yes
.head 3 -  Left:   6.4"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: dsig.apd
.head 2 -  Dynalib: bars033.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Dfltrapi.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: ChckInnr.apd
.head 2 -  Dynalib: custacnt.apd
.head 2 -  !
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: GENTBLF.APL
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: Genfiltr.apl
.head 2 -  File Include: Genemnu.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: qcktabs.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: xsalcpt.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: VTCOMM.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Window Color
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: System Window Color
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Date/Time: d
.head 3 -  Date/Time: dd/MM/yyyy hh:mm:ss AMPM
.head 3 -  Date/Time: dd/MM/yyyy hhhh:mm:ss
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: MSG_InternalError = 'Внутренняя ошибка'
.head 4 -  String: MSG_UnknownDType  = 'Неподдерживаемый тип документа'
.head 4 -  String: MSG_UnknownSType  = 'Неподдерживаемый тип источника данных'
.head 4 -  String: MSG_UnknownSName  = 'Не указано имя Базы Данных'
.head 4 -  String: MSG_DOC_PrintVerb = 'Печатается документ '
.head 4 -  String: MSG_NoMarkedLines = 'Не выбрано ни одной записи!'
.head 4 -  !
.head 4 -  String: HEADER_Docs    = 'Документ'
.head 4 -  String: HEADER_DocList = 'Документы'
.head 4 -  String: HEADER_Int  = 'ОДБ'
.head 4 -  String: HEADER_Ext  = 'СЭП'
.head 4 -  String: HEADER_Arc  = '(Архив)'
.head 4 -  !
.head 4 -  Number: DB_USE_SEPCURRENT 	= 0
.head 4 -  Number: DB_USE_SEPARCHIVE	= 1
.head 4 -  Number: DB_USE_INTERNAL 	= 2
.head 4 -  !
.head 4 -  ! типы документов
.head 4 -  Number: DOC_ARCHIVE	 = 0
.head 4 -  Number: DOC_EXTERNAL	 = 1	! Межбанковский (СЭП) документ
.head 4 -  Number: DOC_INTERNAL	 = 2	! Внутренний документ
.head 4 -  Number: DOC_MVD_EXTERNAL = 3	! MVD_*
.head 4 -  Number: DOC_MVD_INTERNAL = 4	! MVD_*
.head 4 -  Number: DOC_SEP		 = 5	! Для ф-ции "СЭП. Состояние платежей"
.head 4 -  !
.head 4 -  ! типы источников
.head 4 -  Number: DB_SRC_ACTIVE	= 0	! Активная (текущая) бд
.head 4 -  Number: DB_SRC_ARCHIVE  = 1	! Архивная (OLTP)
.head 4 -  !
.head 4 -  String: INI_History		= 'History'
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Boolean: fLibInit		! Флаг инициализации библиотеки
.head 3 -  Number: nBackKvit		! Флаг формирования квитанции D при сторнировании документа
.head 3 -  String: strPathD
.head 3 -  Boolean: bKAZNA			! Флаг - признак Казначейства
.head 3 -  Number: nHaveTobo		! Параметр HAVETOBO
.head 3 -  Number: nBRANCHAB		! Параметр BRANCHAB ! 0/1 - флаг наличия в таблице OPER полей BRANCH_A, BRANCH_B
.head 3 -  String: sBANKTYPE		! Праметр BANKTYPE
.head 3 -  Number: PAR_DOCFLTR		! Параметр DOCFLTR - Обязательный фильтр на функцию просмотра Документов
.head 3 -  String: gl_OB22		! Праметр =1 - Признак РУ ОБ, =0 др.ком банки
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  Boolean: bIpsOk			! TRUE - запросы в ИПС выполняются для Сквитованных/Исходящих файлов СЭП
.head 3 -  Boolean: bLetBlk                ! TRUE - в просмотре документов откроется кнопка "Блокировать" (MIK)
.head 3 -  ! Boolean: bKnopki                ! TRUE - в просмотре документов откроются кнопки фильтров и архива (MIK)
.head 3 -  : m_Doc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  ! переменные OPER для запросов
.head 3 -  Date/Time: BANKDATE
.head 3 -  String: BANKMFO
.head 3 -  Date/Time: PDAT
.head 3 -  Date/Time: PDAT1
.head 3 -  Date/Time: PDAT2
.head 3 -  Number: USERID
.head 3 -  Number: REF
.head 3 -  String: TT
.head 3 -  Number: DK
.head 3 -  Number: VOB
.head 3 -  Date/Time: VDAT
.head 3 -  Date/Time: DATD
.head 3 -  Date/Time: DATP
.head 3 -  Number: KV
.head 3 -  Number: KV2
.head 3 -  Number: S
.head 3 -  Number: S2
.head 3 -  String: NAM_A
.head 3 -  String: NLSA
.head 3 -  String: MFOA
.head 3 -  String: ID_A
.head 3 -  String: NAM_B
.head 3 -  String: NLSB
.head 3 -  String: MFOB
.head 3 -  String: ID_B
.head 3 -  Number: SOS
.head 3 -  String: TOBO
.head 3 -  String: BRANCH
.head 3 -  !
.head 3 -  ! Boolean: bModel
.head 3 -  ! Boolean: bDop
.head 3 -  ! Boolean: bCheck
.head 3 -  ! Boolean: bAlign
.head 2 +  Internal Functions
.head 3 +  Function: DocView_Init
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  ! !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fLibInit
.head 6 -  ! Формировать квитанцию D?
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  Set nBackKvit = SalGetProfileInt(INI_ElektroKlients, 'NOKK_BackKvit', 0, GetIniFileName())
.head 6 -  Call SalGetProfileString(INI_ElektroKlients, 'NOKK_DPath', GetPrnDir(), strPathD, GetIniFileName())
.head 6 -  !
.head 6 -  Set bKAZNA = SqlPrepareAndExecute(hSql(), "SELECT val FROM params WHERE par='ORGTYPE' and val='KAZNA'")
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Set nHaveTobo = GetGlobalOptionEx('HAVETOBO')
.head 6 -  !
.head 6 -  Set nBRANCHAB = GetGlobalOptionEx('BRANCHAB')
.head 6 -  !
.head 6 -  Set sBANKTYPE = GetGlobalOption('BANKTYPE')
.head 6 -  !
.head 6 -  Set PAR_DOCFLTR  = GetGlobalOptionEx('DOCFLTR')
.head 6 -  !
.head 6 -  ! Инициализация LNG-файла
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\docview.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  Call CurrentLangTable.AddAtom('cTHEADER_Docs','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('cTHEADER_DocList','Документы')
.head 7 -  Call CurrentLangTable.AddAtom('cTHEADER_Int','ОДБ')
.head 7 -  Call CurrentLangTable.AddAtom('cTHEADER_Ext','СЭП')
.head 7 -  Call CurrentLangTable.AddAtom('cTHEADER_Arc','(Архив)')
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgFilterNotSet','Не задан фильтр!')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_ListDocs
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.menuTDoc.cTMenuDocs','Документы')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipCurrent1','За текущую дату')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipCurrent2','За все даты')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipSingle1','Свои')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipSingle2','Всех пользователей')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipArchive1','Оперативная')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipArchive2','Архив')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipSEP1','Свои')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipSEP2','СЭП')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipInward', 'Входящие')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipOutward','Исходящие')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipAll','Все')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipFilter','Задать фильтр просмотра')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipSearch','Контекстный поиск')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipRefresh','Перечитать данные')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipViewDoc','Просмотр документа')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipPrint','Печать таблицы или документов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipDbName','Выбрать источник данных')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipChecks','Показать историю виз документа')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipRequest','Запрос в ИПС')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipExit','Завершить работу')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipKill','ИЗЪЯТЬ документ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cBTipBlk','Блокировать документ')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipFakt','Фактический')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipBack','Снят с обработки')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipStorno','Возвращен контроллером')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipInfo','Информационный')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipBooked','Плановый')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipFeature','Форвардный')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipDefault','Неизвестное состояние')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipArchive','Архивний')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipSos','Состояние')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTTipVob99','Исправительный')
.head 7 -  ! Constant
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTFilter',  'Фильтр')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDocDay1', 'за')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDocDay2', 'за все дни')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDocUser1','пользователя')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDocUser2','всех пользователей')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDocBack', 'ИЗЪЯТЬ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDoc',     'док.')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTDocSum',  'на сумму')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTMsgIPS1','Сформировать запрос в ИПС на выбранные документы?')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTMsgIPS2','Запрос в ИПС на выбранные документы СЭП успешно сформирован!')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTMsgDocBack','Успешно ИЗЪЯЛИ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTMsgBlk','Заблокировать выбранные документы?')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrIPS1','Ошибка при формировании файла Q в каталоге:')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrIPS2','Ошибка формирования запроса в ИПС!')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrInsert','Невозможно вставить в')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrSign','Не удалось подписать операцию сторнирования')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrProc','Невозможно выполнить операцию изъятия')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrBack','Ошибка ИЗЪЯТИЯ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrAdm','Для совершения этой операции у вас недостаточно прав. Обратитесь к Администратору АБС.')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ListDocs.cTErrBlk','Ошибка при блокировании')
.head 7 -  ! ====================================================
.head 7 -  ! frm_ViewDoc
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.menuDocs.cTMenuDoc','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs0','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs1','Тех. реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs2','Бух. модель')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs3','Доп. реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs4','Визы')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs5','S.W.I.F.T. Сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs6','Кошторис')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cTabs7','БИСы')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.bgGeneral','Основные')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.bgSEP','Система электронных платежей')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tValueDateTitle','Дата валютирования:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tDebetTitle','ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tSenderTitle','Отправитель:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tSenderOKPOTitle','Код ОКПО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tAccATitle','Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tCcyATitle','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tBankATitle','Банк отправителя:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tMfoATitle','МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tSummATitle','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tKreditTitle','КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tReceiverTitle','Получатель:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tReceiverOKPOTitle','Код ОКПО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tAccBTitle','Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tCcyBTitle','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tBankBTitle','Банк получателя:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tMfoBTitle','МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tSummBTitle','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tDetailsTitle','Назначение платежа:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tArrivedTitle','Поступил в банк А:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tPostedTitle','Дата ввода:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tVisedTitle','Дата последней визы:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tReceivedTitle','Получен в файле:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tInFileReceivedTitle','Поступил в наш РЦ:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tInFilePayTitle','Сквитован:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tSendedTitle','Отправлен:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.tChekedTitle','Сквитован:')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tBaseCcy','грн')
.head 7 -  Call CurrentLangTable.AddAtom('tBaseCcyUnit','коп.')
.head 7 -  Call CurrentLangTable.AddAtom('tSummByChar','Сумма прописью: ')
.head 7 -  Call CurrentLangTable.AddAtom('tTimeFrom','от')
.head 7 -  Call CurrentLangTable.AddAtom('tYear','г.')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewCheck.tDocNumber','Документ №')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewCheck.tDocDate','От')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tDocNumber','Документ №')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tDocDate','От')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tSVobDk2','ІНФОРМАЦІЙНИЙ ЗАПИТ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ViewDop.tSVobDk3','ІНФОРМАЦІЙНЕ ПОВІДОМЛЕННЯ')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cBTipPrint','Распечатать документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViewDoc.cBTipExit', 'Закрыть документ')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_hist_vis
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.cTWndTitle','Журнал виз')
.head 7 -  ! Column
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.colRef','Референс')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.colDat','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.colSt', 'Состояние')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.colFIO','Пользователь')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.colGr', 'Группа')
.head 7 -  ! Constant
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.cTStat1','Визирование')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.cTStat2','Оплата')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_hist_vis.cTStat3','Сторнирование')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_CheckingDocs
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.cTWndTitle','Состояние документов по ПРОЦЕССИНГУ платежей в/из  СЭП  НБУ')
.head 7 -  ! Column
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblSos.nn','№')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblSos.tt','Тип~счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblSos.name','Состояние~документов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblSos.kol','Количество~документов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblSos.su','Сумма~документов(коп)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblKv.colKv','Вал.')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblKv.colCount','Количество~документов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CheckingDocs.tblKv.colSum','Сумма~документов(коп)')
.head 7 -  ! ====================================================
.head 6 -  !
.head 6 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\docs.lng','RUS')
.head 6 -  Call DocWisInit( 'frm_Doc.' )
.head 6 -  !
.head 6 -  Set bStaticsAsWindows = TRUE
.head 6 -  Set fLibInit = TRUE
.head 5 -  Return fLibInit
.head 3 +  Function: DocList		!__exported
.head 4 -  Description: Просмотр списка документов 
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  Number: nDocType
.head 5 -  Number: nSrcType
.head 5 -  String: strSrcName
.head 5 -  String: strUnionCond1
.head 5 -  String: strUnionCond2
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 +  If nDocType = DOC_SEP
.head 6 -  Call SalCreateWindow(tbl_CheckingDocs, hWndMDI, nSrcType, strAuxCondition)
.head 5 +  Else
.head 6 -  Set cFilter.nFieldNum = 0
.head 6 -  Call SalCreateWindow(tbl_ListDocs, hWin, nDocType, 0, nSrcType, strSrcName, strAuxCondition, strAuxTitle, strUnionCond1, strUnionCond2, 1, cFilter)
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: DocViewList		!__exported
.head 4 -  Description: Просмотр списка документов СЭП
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  Set cFilter.nFieldNum = 0
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_EXTERNAL, 0, DB_SRC_ACTIVE, '', strAuxCondition, strAuxTitle, '', '', 1, cFilter)
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: DocViewListInt	!__exported
.head 4 -  Description: Просмотр списка Внутрибанковских документов
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  Set cFilter.nFieldNum = 0
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_INTERNAL, 0, DB_SRC_ACTIVE, '', strAuxCondition, strAuxTitle, '', '', 1, cFilter)
.head 5 -  Return TRUE
.head 3 +  Function: DocViewListIntCurr	!__exported
.head 4 -  Description: Просмотр списка Внутрибанковских документов
Текущего дня
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strCurrDate		!текущая банковская дата в подготовленом виде
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  ! Документы текущего банковского дня определяются по атрибуту PDAT. И только!
.head 5 -  ! В разных банковских днях показываем только документы дня 
.head 5 -  Set cFilter.nFieldNum = 0
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_INTERNAL, 0, DB_SRC_ACTIVE, '', strAuxCondition, strAuxTitle, 
     'a.ref in (SELECT ref FROM ref_que) and a.sos>=0',
     'a.pdat between '||strCurrDate||' and '||strCurrDate||'+0.9999', 0, cFilter)
.head 5 -  Return TRUE
.head 3 +  Function: DocViewListArc	!__exported
.head 4 -  Description: Просмотр списка документов СЭП в архиве
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strName
.head 5 -  String: strSem
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 +  If FunNSIGetFiltered('dblist', '', 'dblist.type=1', strName,  strSem)		! вызвать диалог выбора Базы данных
.head 6 -  Set cFilter.nFieldNum = 0
.head 6 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_EXTERNAL, 0, DB_SRC_ARCHIVE, strName, strAuxCondition, strAuxTitle, '', '', 1, cFilter)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: DocViewListArcInt	!__exported
.head 4 -  Description: Просмотр списка внутрибанковских документов в архиве
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strName
.head 5 -  String: strSem
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  ! If FunNSIGetFiltered( 'dblist', '', 'dblist.type=1', strName,  strSem )		! вызвать диалог выбора Базы данных
.head 5 +  ! Else
.head 6 -   Return FALSE
.head 5 -  ! Set bKnopki=TRUE
.head 5 -  Set cFilter.nFieldNum = 0
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_ARCHIVE, 0, DB_SRC_ARCHIVE, strName, strAuxCondition, strAuxTitle, '', '', 1, cFilter)
.head 5 -  Return TRUE
.head 3 +  Function: DocViewListPayLog	!__exported
.head 4 -  Description: Просмотр протокола оплаты на старте дня
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  Set cFilter.nFieldNum = 0
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_INTERNAL, 1, DB_SRC_ACTIVE, '', strAuxCondition, ', с наступившей датой валютирования', '', '', 1, cFilter)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: DocView 		!__exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  Number: nDocId
.head 5 -  Number: nDocType
.head 5 -  Number: nDocSrc
.head 5 -  String: strDbSrc
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init(  )
.head 5 -  Call SalCreateWindow( frm_ViewDoc, hWin, nDocId, nDocType, nDocSrc, strDbSrc )
.head 3 +  Function: DocViewContents	!__exported
.head 4 -  Description: Просмотр реквизитов документа СЭП
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  Number: nDocRecID
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init(  )
.head 5 +  If SalCreateWindow( frm_ViewDoc, hWin, nDocRecID, DOC_EXTERNAL, DB_SRC_ACTIVE, '' )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: DocViewContentsEx	!__exported
.head 4 -  Description: Просмотр реквизитов внутреннего документа
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  Number: nDocRecID
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init(  )
.head 5 +  If SalCreateWindow( frm_ViewDoc, hWin, nDocRecID, DOC_INTERNAL, DB_SRC_ACTIVE, '' )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: DocViewChecks		!__exported
.head 4 -  Description: Показать отметки на документе
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nID
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalMessageBox('Depricated!', 'Warning', MB_Ok | MB_IconAsterisk )
.head 5 -  Return 1
.head 3 +  Function: DocViewDop		!__exported
.head 4 -  Description: Показать доп.реквизиты документа
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nID
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalMessageBox('Depricated!', 'Warning', MB_Ok | MB_IconAsterisk )
.head 5 -  Return 1
.head 3 -  !
.head 3 +  Function: DOC_PROC		!__exported
.head 4 -  Description: Просмотр документов зависших на контроле
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: DETLS_FLAG
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  Call SalCreateWindow(tbl_CheckingDocs, hWndMDI, DETLS_FLAG, '')
.head 3 +  Function: ShowHistoryVis        !__exported
.head 4 -  Description: Просмотр
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRef
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init(  )
.head 5 -  Call SalCreateWindow( tbl_hist_vis, hWndMDI, nRef )
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: DocView_SaveLangTbl	!__exported
.head 4 -  Description: Записать языковую ьаблицу в файл
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call CurrentLangTable.SaveToFile('C:\\TEMP\\docview.lng','RUS')
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 +  Function: ShowChoiceDocsForm	!__exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  ! nPar1 - флаг: 0-документы пользователя, 1-документы ВСЕХ пользователей
.head 5 -  Number: nPar1
.head 5 -  Number: nPar2
.head 5 -  ! sPar1 - фильтр на документы
.head 5 -  String: sPar1
.head 5 -  ! sPar2 - название фильтра (заголовок окна)
.head 5 -  String: sPar2
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call IniTECHBANK()
.head 5 -  Call DocView_Init()
.head 5 -  Call SalCreateWindow(frm_Ctrl_D, hWin, nPar1, sPar1, sPar2)
.head 5 -  Return TRUE
.head 3 +  Function: IntDocsList		!__exported
.head 4 -  Description: Просмотр списка Внутрибанковских документов
Текущего дня
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxTitle
.head 5 -  String: strAuxCondition
.head 5 -  String: strAuxConditionUnion1
.head 5 -  String: strAuxConditionUnion2
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  ! Документы текущего банковского дня определяются по атрибуту PDAT. И только!
.head 5 -  ! В разных банковских днях показываем только документы дня
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_INTERNAL, 0, DB_SRC_ACTIVE, '', strAuxCondition, strAuxTitle, strAuxConditionUnion1, strAuxConditionUnion2, 0, cFilter)
.head 5 -  Return TRUE
.head 3 +  Function: ExtDocsList		!__exported
.head 4 -  Description: Просмотр списка Внутрибанковских документов
Текущего дня
.head 4 +  Returns
.head 5 -  Boolean: fRes
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  String: strAuxTitle
.head 5 -  String: strAuxCondition
.head 5 -  : cFilter
.head 6 -  Class: cDocFilter
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call DocView_Init()
.head 5 -  Call SalCreateWindow(tbl_ListDocs, hWin, DOC_EXTERNAL, 0, DB_SRC_ACTIVE, '', strAuxCondition, strAuxTitle, '', '', 1, cFilter)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 +  Function: FunMakeFullTableName
.head 4 -  Description: Формирует имя таблицы БД (полное) в зависимоти от типа
СУБД
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strDbName	!! Имя СУБД (с указанием хоста или без/dblink)
.head 5 -  String: strTblName	!! Имя таблицы БД
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strFullName
.head 4 +  Actions
.head 5 -  Set strFullName = ''
.head 5 +  If strDbName != ''
.head 6 +  If SalStrUpperX( SalStrTrimX( GetDBMS() )) = 'ORACLE'
.head 7 -  Set strFullName = strTblName || '@' || strDbName
.head 6 +  Else
.head 7 -  Set strFullName = strDbName || ':' || strTblName
.head 5 +  Else
.head 6 -  Set strFullName = strTblName
.head 5 -  Return strFullName
.head 3 +  Function: GetUIdFromChkListByGId
.head 4 -  Description: Получить Идентификатор пользователя из строки визирования
по идентификатору группы
.head 4 +  Returns
.head 5 -  Number: nUId
.head 4 +  Parameters
.head 5 -  String: strCheckList
.head 5 -  Number: nGrpId
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nOffset
.head 5 -  String: strVisa
.head 5 -  Boolean: fFound
.head 4 +  Actions
.head 5 +  If SalStrLength( strCheckList ) < 6
.head 6 -  Return -1
.head 5 -  Set nOffset = 0
.head 5 +  While nOffset < SalStrLength( strCheckList )
.head 6 -  Set strVisa = SalStrMidX(strCheckList, nOffset, 6)
.head 6 +  If HexSToNumber( SalStrLeftX( strVisa, 2 )) = nGrpId
.head 7 -  Set fFound = TRUE
.head 7 -  Break
.head 6 -  Set nOffset = nOffset + 6
.head 5 +  If fFound
.head 6 -  Return HexSToNumber( SalStrRightX( strVisa, 4 ))
.head 5 +  Else
.head 6 -  Return -1
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 394483806
0000: F601000005010000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F1D003C00 000A6300446F6346
0040: 696C74650072A600 00000500001E0001 0D00FC0000FF270D 0000020004000000
0060: 01000000FFE08001 0000001F1100009C 00020001FD009380 0100007F15600000
0080: 00010D00F4010000 4F800100FE000119 000000040D00D900 01003F8001F90000
00A0: 0701802200004800 0100000A47F0656E 4669407400000004 0000EF02EC000100
00C0: 9F8001FC00001B04 00010DFB00FF6F11 00EE0200FFBF15B9 000100FFFF180180
00E0: 220002006000000B 634744FC4669D900 04003302040001FA 00002780010000FF
0100: C60400010DFE00FF 9B110002FB00FF6F 1500EE0100FF3F
.enddata
.head 3 +  Pushbutton Class: cpbOkLabeled
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:  
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Автолабельная кнопка ОК
.head 4 +  Derived From
.head 5 -  Class: cpbOk
.head 5 -  Class: cAutoLabeledWindow
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Functional Class: cDocFilter
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Number: nFieldNum
.head 5 -  String: smFieldName[*]
.head 5 -  String: smFieldValue[*]
.head 5 -  Number: nmFieldValue[*]
.head 5 -  Date/Time: dmFieldValue[*]
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set i = 0
.head 7 +  While i < nFieldNum
.head 8 +  If smFieldName[i] = 'BANKDATE'
.head 9 -  Set BANKDATE = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'BANKMFO'
.head 9 -  Set BANKMFO = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'PDAT'
.head 9 -  Set PDAT = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'PDAT1'
.head 9 -  Set PDAT1 = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'PDAT2'
.head 9 -  Set PDAT2 = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'USERID'
.head 9 -  Set USERID = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'REF'
.head 9 -  Set REF = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'TT'
.head 9 -  Set TT = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'DK'
.head 9 -  Set DK = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'VOB'
.head 9 -  Set VOB = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'VDAT'
.head 9 -  Set VDAT = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'DATD'
.head 9 -  Set DATD = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'DATP'
.head 9 -  Set DATP = dmFieldValue[i]
.head 8 +  If smFieldName[i] = 'KV'
.head 9 -  Set KV = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'KV2'
.head 9 -  Set KV2 = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'S'
.head 9 -  Set S = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'S2'
.head 9 -  Set S2 = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'NAM_A'
.head 9 -  Set NAM_A = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'NLSA'
.head 9 -  Set NLSA = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'MFOA'
.head 9 -  Set MFOA = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'ID_A'
.head 9 -  Set ID_A = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'NAM_B'
.head 9 -  Set NAM_B = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'NLSB'
.head 9 -  Set NLSB = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'MFOB'
.head 9 -  Set MFOB = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'ID_B'
.head 9 -  Set ID_B = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'SOS'
.head 9 -  Set SOS = nmFieldValue[i]
.head 8 +  If smFieldName[i] = 'TOBO'
.head 9 -  Set TOBO = smFieldValue[i]
.head 8 +  If smFieldName[i] = 'BRANCH'
.head 9 -  Set BRANCH = smFieldValue[i]
.head 8 -  Set i = i + 1
.head 7 -  Return TRUE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbSwitch
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 -  Application Actions
.head 1 -  !
.head 1 +  Table Window: tbl_ListDocs
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Документы
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.338"
.head 4 -  Top:    0.771"
.head 4 -  Width:  16.3"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.427"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 65535
.head 3 -  Discardable? No
.head 2 -  Description: Список банковских документов
.head 2 +  Named Menus
.head 3 +  Menu: menuTDoc
.head 4 -  Resource Id: 6615
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Фильтр...
.head 5 -  Resource Id: 6616
.head 5 -  Keyboard Accelerator: Ctrl+S
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( pbFilter, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Искать...
.head 5 -  Resource Id: 6617
.head 5 -  Keyboard Accelerator: Ctrl+F
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( hWndForm, UM_Search, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Искать &следующий
.head 5 -  Resource Id: 6618
.head 5 -  Keyboard Accelerator: Ctrl+G
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( hWndForm, UM_Search, 1, 0 )
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Печать...
.head 5 -  Resource Id: 6619
.head 5 -  Keyboard Accelerator: Ctrl+P
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( pbPrint, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Документ...
.head 5 -  Resource Id: 6620
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Запрос в ИПС
.head 5 -  Resource Id: 6621
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: nDocType = DOC_EXTERNAL OR nDocType = DOC_MVD_EXTERNAL
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( pbRequest, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Источни&к данных...
.head 5 -  Resource Id: 6622
.head 5 -  Keyboard Accelerator: Ctrl+B
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: nSourceType = DB_SRC_ARCHIVE
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( pbDbName, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 6623
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.49"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Option Button: obCurrent
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.967"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Datetime.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSqlAux(), 'SELECT sysdate INTO :dTmp FROM dual')
.head 8 -  Call SqlFetchNext( hSqlAux(), nFetchRes )
.head 7 +  If obCurrent      !! За ТЕК день
.head 8 -  Set sTmp=DateInQuery( SalFmtFormatDateTime( dTmp, 'MM/dd/yyyy') )
.head 8 -  ! Set strAddCond1='a.pdat between '||sTmp||' and '||sTmp||'+0.9999'
.head 8 -  Set strAddCond1='a.pdat between '||sTmp||' and '||
 "TO_DATE('"||SalFmtFormatDateTime( dTmp, 'dd.MM.yyyy') || '23:59:59' || "','dd/mm/yyyy hh24:mi:ss') "
.head 8 -  ! Set strAddTitle1=' за '||SalFmtFormatDateTime( dTmp, ddMMyyyy() )
.head 8 -  Set strAddTitle1 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocDay1') || ' '||SalFmtFormatDateTime( dTmp, ddMMyyyy() )
.head 7 +  Else !! За все дни
.head 8 -  Set strAddCond1=''
.head 8 -  ! Set strAddTitle1=' за все дни '
.head 8 -  Set strAddTitle1 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocDay2') || ' '
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText(lParam, IifS(obCurrent, 'За текущую дату', 'За все даты'))
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obCurrent, 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipCurrent1'), 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipCurrent2')))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 +  Option Button: obSingle
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Users.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obSingle      !! Один пользователь
.head 8 -  Set strAddCond2=' a.userid='||SalNumberToStrX( GetUserId(),0 )
.head 8 -  ! Set strAddTitle2=' пользователя № '||SalNumberToStrX( GetUserId(),0 )
.head 8 -  Set strAddTitle2 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocUser1') || ' № '||SalNumberToStrX( GetUserId(),0 )
.head 7 +  Else !! Все пользователи
.head 8 -  Set strAddCond2=''
.head 8 -  ! Set strAddTitle2=' всех пользователей '
.head 8 -  Set strAddTitle2 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocUser2') || ' '
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText(lParam, IifS(obSingle, 'Свои', 'Всех пользователей'))
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obSingle, 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipSingle1'), 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipSingle2')))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 +  Option Button: obArchive
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Cabinet.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obArchive      !! Архив прошлых лет
.head 8 -  Set nDocType=DOC_ARCHIVE
.head 8 -  Set nSourceType=DB_SRC_ARCHIVE
.head 8 -  Set strDBName=strDbLinkN
.head 8 -  Set strCondUnion1=''
.head 8 -  Set strCondUnion2=''
.head 8 -  Set strAddCond=''
.head 7 +  Else !! Из Оперативной базы
.head 8 -  Set nDocType=DOC_INTERNAL
.head 8 -  Set nSourceType=DB_SRC_ACTIVE
.head 8 -  Set strDBName=''
.head 8 -  Set strCondUnion1=strCondUnion1do
.head 8 -  Set strCondUnion2=strCondUnion2do
.head 8 -  Set strAddCond=strAddCondDo
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strCondUnion1do=strCondUnion1
.head 7 -  Set strCondUnion2do=strCondUnion2
.head 7 -  Set strAddCondDo=strAddCond
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText(lParam, IifS(obArchive, 'Оперативная', 'Архив'))
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obArchive, 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipArchive1'), 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipArchive2')))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 +  Option Button: obSEP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tips.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obSEP      !! Арихив СЕП
.head 8 -  Set nDocType=DOC_EXTERNAL
.head 8 -  Set nSourceType=DB_SRC_ARCHIVE
.head 8 -  Set strDBName=''
.head 8 -  Set obArchive=FALSE
.head 7 +  Else !! Из Оперативной базы
.head 8 -  Set nDocType=DOC_INTERNAL
.head 8 -  Set nSourceType=DB_SRC_ACTIVE
.head 8 -  Set strDBName=''
.head 8 -  ! Set obArchive=TRUE
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText(lParam, IifS(obSEP, 'Свои', 'СЭП'))
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obSEP, 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipSEP1'), 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipSEP2')))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 +  Option Button: obInward
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\filldown.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obInward      !! Входящие
.head 8 -  Set strAddCond3=' a.mfob='||'\''||GetBankMfo()||'\''
.head 8 -  ! Set strAddTitle3=' пользователя № '||SalNumberToStrX( GetUserId(),0 )
.head 8 -  Set strAddTitle3 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocUser1') || ' № '||SalNumberToStrX( GetUserId(),0 )
.head 7 +  Else !! Все пользователи
.head 8 -  Set strAddCond3=''
.head 8 -  ! Set strAddTitle3=' всех пользователей '
.head 8 -  Set strAddTitle3 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocUser2') || ' '
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText(lParam, IifS(obInward, 'Входящие', 'Все'))
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obInward, 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipInward'), 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipAll')))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 +  Option Button: obOutward
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.267"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\fillup.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obOutward      !! Исходящие
.head 8 -  Set strAddCond4=' a.mfoa='||'\''||GetBankMfo()||'\''
.head 8 -  ! Set strAddTitle4=' пользователя № '||SalNumberToStrX( GetUserId(),0 )
.head 8 -  Set strAddTitle4 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocUser1') || ' № '||SalNumberToStrX( GetUserId(),0 )
.head 7 +  Else !! Все
.head 8 -  Set strAddCond4=''
.head 8 -  ! Set strAddTitle4=' всех пользователей '
.head 8 -  Set strAddTitle4 = ' ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocUser2') || ' '
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText(lParam, IifS(obOutward, 'Исходящие', 'Все'))
.head 7 -  Return XSalTooltipSetText(lParam, IifS(obOutward, 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipOutward'), 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipAll')))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 4 -  ! Background Text: Фактический
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.129"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: System Window Color
.end
.head 4 -  ! Background Text: Плановый
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.129"
.head 6 -  Top:    0.25"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: System Window Color
.end
.head 4 -  ! Background Text: Форвардный
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.429"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Blue
.head 5 -  Background Color: System Window Color
.end
.head 4 -  ! Background Text: Сторно
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.429"
.head 6 -  Top:    0.25"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Red
.head 5 -  Background Color: System Window Color
.end
.head 4 -  !
.head 4 -  Line
.head 5 -  Resource Id: 38052
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.65"
.head 6 -  Begin Y:  0.01"
.head 6 -  End X:  6.65"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Задать фильтр просмотра'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipFilter')
.head 6 +  On SAM_Click
.head 7 +  If SetQueryDFilterEx( cTDocF )
.head 8 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Single
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Контекстный поиск'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipSearch')
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg( hWndForm, UM_Search, 0, 0 )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Перечитать данные'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +  Pushbutton: pbViewDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.217"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Просмотр документа'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipViewDoc')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.65"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Печать таблицы или документов'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 +  Select Case GetTablePrintOpt(  )
.head 8 +  Case 1		! Whole table
.head 9 -  ! закрываем строковые колонки, открываем числовые
.head 9 +  If SalIsWindowVisible(colS)
.head 10 -  Call SalHideWindow(colS)
.head 10 -  Set nPos = SalTblQueryColumnPos(colS)
.head 10 -  Call SalTblSetColumnPos(colSn, nPos)
.head 10 -  Call SalTblSetColumnTitle(hWndForm.tbl_ListDocs.colSn, CurrentLangTable.GetAtomTitle('tbl_ListDocs.colS'))
.head 10 -  Call SalShowWindow(colSn)
.head 9 +  If SalIsWindowVisible(colS2)
.head 10 -  Call SalHideWindow(colS2)
.head 10 -  Set nPos = SalTblQueryColumnPos(colS2)
.head 10 -  Call SalTblSetColumnPos(colS2n, nPos)
.head 10 -  Call SalTblSetColumnTitle(hWndForm.tbl_ListDocs.colS2n, CurrentLangTable.GetAtomTitle('tbl_ListDocs.colS2'))
.head 10 -  Call SalShowWindow(colS2n)
.head 9 -  ! печатаем таблицу
.head 9 -  Call SalGetWindowText( hWndForm, sTmp, 100 )
.head 9 -  Call TablePrint( hWndForm, SalFmtFormatDateTime( GetBankDate(), 'dd/MM/yyyy' ) ||': '||sTmp, '', '' )
.head 9 -  ! закрывем числовые колонки, открываем строковые
.head 9 +  If SalIsWindowVisible(colSn)
.head 10 -  Call SalHideWindow(colSn)
.head 10 -  Call SalShowWindow(colS)
.head 9 +  If SalIsWindowVisible(colS2n)
.head 10 -  Call SalHideWindow(colS2n)
.head 10 -  Call SalShowWindow(colS2)
.head 9 -  Break
.head 8 +  Case 2		! Only selected documents
.head 9 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 10 -  Set nRow=TBL_MinRow
.head 10 +  While SalTblFindNextRow( hWndForm, nRow, ROW_Selected, 0 )
.head 11 -  Call SalTblFetchRow( hWndForm, nRow )
.head 11 -  Call SalStatusSetText( hWndForm, MSG_DOC_PrintVerb || 'N' || SalNumberToStrX( colID, 0 ))
.head 11 -  !
.head 11 -  Call DocsPrint ( colID, strTBLNameWithDB, AUTO_PRINT_DOC )
.head 11 -  !
.head 11 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, FALSE )
.head 10 -  Call SalStatusSetText( hWndForm, 'Выполнено!' )
.head 10 -  Call SalWaitCursor( FALSE )
.head 9 -  Break
.head 8 +  Default
.head 9 -  Break
.head 7 -  Call SalStatusSetText(hWndForm, 'Состояние документа - жмите левой кнопкой мышки на заголовке строки')
.head 4 +  Pushbutton: pbDbName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Dbms.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Выбрать источник данных'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipDbName')
.head 6 +  On SAM_Click
.head 7 +  If FunNSIGet( 'dblist', '', strDBName, strCurrDBSem )
.head 8 -  ! Set new Full qualified Db table name
.head 8 -  Set strTBLNameWithDB = FunMakeFullTableName( strDBName, strTBLName )
.head 8 -  ! Set New Windows Header
.head 8 -  Call Fun_SetWindowsTitle( hWndForm, strWinTitle, strCurrDBSem, strAddTitle )
.head 8 -  ! Init new Query object
.head 8 -  Call Fun_InitQuerySentence( strSqlFields, strSqlBinds, strTBLNameWithDB, strAddCond, strOrderBy, cTDocQ )
.head 8 -  ! send Populate message
.head 8 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbChecks
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.517"
.head 6 -  Top:    0.107"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chekin.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Показать историю виз документа'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipChecks')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0) AND 
   (nDocType = DOC_INTERNAL OR nDocType = DOC_MVD_INTERNAL)
.head 8 -  Call ShowHistoryVis(colREF)
.head 4 -  Line
.head 5 -  Resource Id: 38053
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.783"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  2.783"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbRequest
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.15"
.head 6 -  Top:    0.104"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Запрос в ИПС'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipRequest')
.head 6 +  On SAM_Click
.head 7 -  ! If MessageQuestion( 'Сформировать запрос в ИПС на выбранные документы?' ) = IDNO
.head 7 +  If MessageQuestion( CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTMsgIPS1') ) = IDNO
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set nRow=TBL_MinRow
.head 7 -  !
.head 7 -  Call WaitCursorOn()
.head 7 -  !
.head 7 +  Loop
.head 8 +  If SalTblFindNextRow ( tbl_ListDocs, nRow, ROW_Selected, 0 )
.head 9 -  !
.head 9 -  Call SalTblFetchRow( tbl_ListDocs, nRow )
.head 9 -  !
.head 9 +  If Not SalIsNull( colDAT_B ) And Not SalIsNull( colFN_B )
.head 10 -  Set nS = colSn * SalNumberPower( 10, colDig )
.head 10 -  !
.head 10 +  If NOT SqlPrepareAndExecute( hSql(),
   T( 'INSERT INTO Ips_rrp ( dat_sep, mfoa, nlsa, mfob, nlsb, s, dk, fn_a, kv, rec_a )
       VALUES
      ( :colDAT_B, :colMFOA, :colNLSA, :colMFOB, :colNLSB, :nS, :colDK, :colFN_B, :colKV, :colREC_B )' ) )
.head 11 -  Break
.head 10 +  If NOT SqlCommitEx( hSql(), 'Сохранение данных для запроса в ИПС' )
.head 11 -  Break
.head 8 +  Else
.head 9 -  Break
.head 8 -  !
.head 8 -  ! Call MessageInfo( 'Запрос в ИПС на выбранные документы СЭП успешно сформирован!' )
.head 8 -  Call MessageInfo( CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTMsgIPS2') )
.head 8 +  If SalFileOpen( hFile, GetInformationalDir() || '\\Q', OF_Binary | OF_Create )
.head 9 -  Call SalFileClose( hFile )
.head 8 +  Else
.head 9 -  ! Call MessageError( 'Ошибка при формировании файла Q в каталоге: ' || GetExtDir() )
.head 9 -  Call MessageError( CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTErrIPS1') || ' ' || GetExtDir() )
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  ! Return MessageError( 'Ошибка формирования запроса в ИПС!' )
.head 7 -  Return MessageError( CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTErrIPS2') )
.head 4 -  Line
.head 5 -  Resource Id: 38054
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  7.267"
.head 6 -  Begin Y:  0.031"
.head 6 -  End X:  7.267"
.head 6 -  End Y:  0.49"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 39022
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  11.783"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  11.783"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.767"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Завершить работу'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 4 -  Line
.head 5 -  Resource Id: 38055
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.033"
.head 6 -  Begin Y:  0.031"
.head 6 -  End X:  6.033"
.head 6 -  End Y:  0.51"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  ! ctb_pbHelp: pbHelp
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Help2.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Legend - Left Click on RowHeader'
.head 4 -  ! Line
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  7.883"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  7.883"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbKill
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.133"
.head 6 -  Top:    0.107"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F8
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'ИЗ\'ЯТЬ документ'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipKill')
.head 6 +  On SAM_Click
.head 7 +  If GetUserMark() >= GetGlobalOptionEx('MARKBACK')
.head 8 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0) 
.head 9 -  ! Set sTmp = 'док.' || Str(colREF)
.head 9 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDoc') || Str(colREF)
.head 9 -  ! If MessageQuestion('ИЗЪЯТЬ ' || sTmp || ' на сумму ' || Str(colSn) || ' ?') != IDYES
.head 9 +  If MessageQuestion(CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocBack') || ' ' || sTmp || ' ' || 
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTDocSum') || ' ' || Str(colSn) || ' ?') != IDYES
.head 10 -  Return FALSE
.head 9 +  If colSOS = 0
.head 10 -  Return TRUE
.head 9 +  If colSOS = -2
.head 10 -  Return TRUE
.head 9 +  If not FunNSIGet('BP_REASON', '', sStornoReasonId, sStornoReason)
.head 10 -  Return TRUE
.head 9 +  If not sStornoReasonId
.head 10 -  Return TRUE
.head 9 -  Set nChkId = GetGlobalOptionEx('BACKVISA')
.head 9 +  If nChkId = 0
.head 10 -  Set nChkId = NUMBER_Null
.head 9 +  If DocumentBack(colREF, colSOS, Val(sStornoReasonId), nChkId)
.head 10 -  ! Call MessageInfo('Успешно ИЗЪЯЛИ '||sTmp)
.head 10 -  Call MessageInfo(CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTMsgDocBack') || ' ' || sTmp)
.head 9 +  Else
.head 10 -  ! Call MessageError('Ошибка ИЗЪЯТИЯ ' || sTmp || PutCrLf() || sErrTxt)
.head 10 -  Call MessageError(CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTErrBack') || ' ' || sTmp || PutCrLf() || sErrTxt)
.head 9 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 +  Else
.head 8 -  ! Call MessageError('Для совершения этой операции у вас недостаточно прав. Обратитесь к Администратору АБС.')
.head 8 -  Call MessageError(CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTErrAdm'))
.head 4 +  Pushbutton: pbBlk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.983"
.head 6 -  Top:    0.107"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Блокировать документ'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipBlk')
.head 7 +  If bLetBlk
.head 8 -  Call SalShowWindow( hWndItem )
.head 8 -  Set bLetBlk=FALSE
.head 6 +  On SAM_Click
.head 7 -  ! If MessageQuestion( 'Заблокировать выбранные документы?' ) = IDNO
.head 7 +  If MessageQuestion( CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTMsgBlk') ) = IDNO
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set nRow=TBL_MinRow
.head 7 -  !
.head 7 -  Call WaitCursorOn()
.head 7 -  !
.head 7 +  Loop
.head 8 +  If SalTblFindNextRow ( tbl_ListDocs, nRow, ROW_Selected, 0 )
.head 9 -  Call SalTblFetchRow( tbl_ListDocs, nRow )
.head 9 +  If SalIsNull( colFN_B )
.head 10 +  If NOT SqlPrepareAndExecute( hSql(),
   T( 'UPDATE arc_rrp SET blk=5120 WHERE rec=:colID AND fn_b IS NULL AND sos=3' ) )
.head 11 -  Break
.head 10 +  If NOT SqlCommitEx( hSql(), 'Блокировка REC='||Str(colID) )
.head 11 -  Break
.head 8 +  Else
.head 9 -  Break
.head 8 -  !
.head 8 -  Call MessageInfo( 'Готово' )
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  ! Return MessageError( 'Ошибка при блокировании' )
.head 7 -  Return MessageError( CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTErrBlk') )
.head 4 +  Pushbutton: pbSurvive
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.104"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nUserId = GetUserId()
.head 7 -  Set strSecure = ''
.head 7 +  If EnhancedSecurity(  )
.head 8 -  Set strSecure = ' AND NVL(s.approve,0)=1 AND date_is_valid(s.adate1,s.adate2,s.rdate1,s.rdate2)=1 '
.head 7 -  Call SqlPrepareAndExecute( hSql(), T(
"SELECT DISTINCT t.tt INTO :sTmp
   FROM tts t, staff_tts s
  WHERE s.tt=t.tt AND s.id IN ("|| GetSubstListId( nUserId, TRUE ) ||") AND
     t.fli<3 AND flags[1,1]=1 AND t.tt=:tbl_ListDocs.colTT " || strSecure ))
.head 7 +  If SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Call SalCreateWindow( frm_Doc, hWndMDI, pbSurvive, tbl_ListDocs.colREF )
.head 6 +  On UM_ObjDeactivate
.head 7 +  If lParam
.head 8 -  Call XRoleSet( hSql(), 'DOC_RESURECT', 'PYOD001' )
.head 8 -  Call SalDisableWindow(pbSurvive)
.head 7 +  Else
.head 8 -  Call XRoleUnset( hSql(), 'DOC_RESURECT' )
.head 8 -  Call SalEnableWindow(pbSurvive)
.head 4 -  Background Text: Документов всего
.head 5 -  Resource Id: 26659
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.567"
.head 6 -  Top:    0.167"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgDocCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfDocCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.667"
.head 7 -  Top:    0.131"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPageUp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.083"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr2tol.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'PgUp'
.head 7 +  If bPages
.head 8 -  Call SalShowWindow(hWndItem)
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Set dfPage=IifN(dfPage=1,1,dfPage-1)
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +  Data Field: dfPage
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   12.583"
.head 7 -  Top:    0.156"
.head 7 -  Width:  0.614"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set dfPage=1
.head 7 +  If bPages
.head 8 -  Call SalShowWindow(hWndItem)
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 6 +  On SAM_Validate
.head 7 +  If dfPage<1
.head 8 -  Set dfPage=1
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 +  On SAM_SetFocus
.head 7 -  Call SalMapEnterToTab( TRUE )
.head 6 +  On SAM_KillFocus
.head 7 -  Call SalMapEnterToTab( FALSE )
.head 4 +  Pushbutton: pbPageDn
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.283"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr2tor.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'PgDn'
.head 7 +  If bPages
.head 8 -  Call SalShowWindow(hWndItem)
.head 7 +  Else
.head 8 -  Call SalHideWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Set dfPage=dfPage+1
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 2 +  Contents
.head 3 +  Column: colID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ID
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Document
reference
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpRef = colREF
.head 5 +  On SAM_AnyEdit
.head 6 -  Set colREF = sTmpRef
.head 6 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Transaction
code
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: User
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.543"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Document
number
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MFO - A

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Account - A
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.529"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSn           !numb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS    !str
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Amount
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Curr
ency
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Uppercase
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал. А
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ccy Digits
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Value
Date
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS2n          !numb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
в валютi - B
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS2   !str
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Amount
in Currency - B
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал. Б
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ccy Digits
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISO2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Curr
ency - B
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.857"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Uppercase
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MFO - B

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.086"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Account - B
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.429"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Db
Cr
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cash
symbol
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Type
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Document
date
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFN_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: EPS. Inbound
filename
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.414"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAT_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: File date
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREC_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Record
number
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFN_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: EPS. Outgoing
filename
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.414"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAT_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: File date
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREC_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Record
number
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Transaction layout
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  7.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sos
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCOMM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Comment
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код безбал.
отделения
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colID_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО-А
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAM_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sender
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNB_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sender Bank
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colID_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО-Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAM_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Receiver
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNB_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Receiver Bank
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranchA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
отделения А
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranchB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
отделения B
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: colSEGM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: СЕГМ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Fun_InitQuerySentence
.head 4 -  Description: Составить и проинициализировать запрос
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFields
.head 5 -  String: sBinds
.head 5 -  String: sTable
.head 5 -  String: sAddWhere
.head 5 -  String: sOrderBy
.head 5 -  !
.head 5 -  : Q
.head 6 -  Class: cGenQuery
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSQL
.head 4 +  Actions
.head 5 -  Set sSQL = 'SELECT ' || sFields 
.head 5 +  If sBinds
.head 6 -  Set sSQL = sSQL || ' INTO ' || sBinds
.head 5 -  Set sSQL = sSQL || ' FROM ' || sTable || ' a, tabval$global v'
.head 5 +  If SalStrScan( sFields, 'v2.lcv' ) >= 0
.head 6 -  Set sSQL = sSQL || ', tabval$global v2'
.head 5 +  If nDocType = DOC_EXTERNAL OR nDocType = DOC_MVD_EXTERNAL
.head 6 -  Set sSQL = sSQL || ', banks$base b1, banks$base b2'
.head 5 -  Set sSQL = sSQL || ' WHERE a.kv=v.kv(+)'
.head 5 +  If SalStrScan( sFields, 'v2.lcv' ) >= 0
.head 6 -  Set sSQL = sSQL || ' and a.kv2=v2.kv(+)'
.head 5 +  If sAddWhere != ''
.head 6 -  Set sSQL = sSQL || ' and (' || sAddWhere || ')'
.head 5 +  If sOrderBy
.head 6 -  Set sSQL = sSQL || ' ORDER BY ' || sOrderBy 
.head 5 -  Call Q.Init( T(sSQL) )
.head 3 +  Function: Fun_SetWindowsTitle
.head 4 -  Description: Составить заголовок окна
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 5 -  !
.head 5 -  String: sMainT
.head 5 -  String: sDbName
.head 5 -  String: sAddT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTitle
.head 4 +  Actions
.head 5 -  Set sTitle = sMainT
.head 5 +  If sDbName != '' AND sDbName != STRING_Null
.head 6 -  Set sTitle = sTitle || ' ' || sDbName
.head 5 +  If sAddT != ''
.head 6 -  Set sTitle = sTitle || ' ' || sAddT
.head 5 -  Call SalSetWindowText( hWin, sTitle )
.head 3 +  Function: Fun_SumCol
.head 4 -  Description: Сумирует SELECTED колонку 
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 5 -  String: strTitle
.head 5 -  String: strSuma
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Number: nW
.head 5 -  Number: nH
.head 4 +  Actions
.head 5 -  Call GetWindowRect( hWndForm, nX, nY, nW, nH )
.head 5 -  Call SalTblObjectsFromPoint( hWndForm, wParam-nX, lParam-nY, nH, hWndCol, nH )
.head 5 -  Set strTitle=PadR(' ',100  )
.head 5 -  Call SalTblGetColumnTitle ( hWndCol, strTitle, 100 )
.head 5 +  If SalIsValidNumber( hWndCol )
.head 6 -  Set nH=SalTblColumnSum( hWndForm, SalTblQueryColumnID( hWndCol ), ROW_Selected, 0 )
.head 6 +  If nH
.head 7 -  Set strTitle=SalStrTrimX(strTitle)
.head 7 -  Set strSuma=SalStrTrimX(SalFmtFormatNumber ( nH, 'Default' ))
.head 7 -  Set nH = SalNumberMax( SalStrLength( strTitle ), SalStrLength( strSuma ) )
.head 7 -  Call XSalTooltipSetColors( COLOR_Black, COLOR_Yellow )
.head 7 -  ! Call XSalTooltipShow( hWndForm, PadL(strTitle,nH)||PutLf()||PadL(strSuma,nH))
.head 7 -  Call XSalTooltipShow( hWndForm, strTitle ||PutLf()||PadL(strSuma,nH))
.head 7 -  Call XSalTooltipSetColors( COLOR_Black, COLOR_White )
.head 3 +  Function: Fun_SetThisWinPar
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: pDocType	! Тип документов
.head 5 -  Number: pDocSubType	! ПодТип документов
.head 5 -  Number: pSourceType	! Тип источника документов
.head 5 -  String: pDBName	! Имя БД (для архивного источника)
.head 5 -  String: pAddCond	! Доп. условие фильтра
.head 5 -  String: pAddTitle	! Доп. заголовок окна
.head 5 -  !
.head 5 -  String: pCondUnion1	! Условие для первого селекта в UNION
.head 5 -  String: pCondUnion2	! Условие для второго селекта в UNION
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nDocType=pDocType
.head 5 -  Set nDocSubType=pDocSubType
.head 5 -  Set nSourceType=pSourceType
.head 5 -  Set strDBName=pDBName
.head 5 -  Set strAddCond=pAddCond
.head 5 -  Set strAddTitle=pAddTitle
.head 5 -  Set strCondUnion1=pCondUnion1
.head 5 -  Set strCondUnion2=pCondUnion2
.head 3 +  Function: ToPageStyle
.head 4 -  Description: Обрамляет выборку в стиль со страницами  /*+ FIRST_ROWS(100) */ 
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sSql
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 5 -  ! Number: nPageSize
.head 4 +  Actions
.head 5 -  Set sTmp=SalStrMidX(sSql,SalStrScan(sSql,' INTO '),SalStrLength(sSql)-SalStrScan(sSql,' INTO '))
.head 5 -  Set sTmp=SalStrLeftX(sTmp,SalStrScan(sTmp,' FROM'))
.head 5 -  Return "select * "||sTmp||
       ",:nRowNumb from ( select  /*+ FIRST_ROWS(100) */ myquery.*, rownum rnum from ( "||SalStrReplaceX(sSql,SalStrScan(sSql,' INTO '),SalStrLength(sTmp),'')||
       " ) myquery where rownum <= :nRow2 ) where rnum >= :nRow1"
.head 3 +  Function: CheckFilterSet
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If PAR_DOCFLTR
.head 6 +  If cTDocF.GetFilterWhereClause(FALSE) = ''
and strAddCond = ''
.head 7 -  Call SalTblReset(hWndForm)
.head 7 -  ! Не задан фильтр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgFilterNotSet'),
     CurrentLangTable.GetAtomTitle('DlgMSG_Warning'), MB_IconExclamation | MB_Ok)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nDocType	! Тип документов
.head 3 -  Number: nDocSubType	! ПодТип документов
.head 3 -  Number: nSourceType	! Тип источника документов
.head 3 -  String: strDBName	! Имя БД (для архивного источника)
.head 3 -  String: strAddCond	! Доп. условие фильтра
.head 3 -  String: strAddTitle	! Доп. заголовок окна
.head 3 -  !
.head 3 -  String: strCondUnion1	! Условие для первого селекта в UNION
.head 3 -  String: strCondUnion2	! Условие для второго селекта в UNION
.head 3 -  !
.head 3 -  Number: nFilter		! 1-фильтр за последние 10 дней
.head 3 -  : cFilter
.head 4 -  Class: cDocFilter
.head 2 +  Window Variables
.head 3 -  : TDoc
.head 4 -  Class: cABSConnect
.head 3 -  : TAux
.head 4 -  Class: cABSConnect
.head 3 -  : cTDocMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  : cTDocQ
.head 4 -  Class: cGenQuery
.head 3 -  : cTDocQ2
.head 4 -  Class: cGenQuery
.head 3 -  : cTDocF
.head 4 -  Class: cGenDFilterEx
.head 3 -  Boolean: fUseUnion
.head 3 -  : TDocTable
.head 4 -  Class: cABSTab
.head 3 -  !
.head 3 -  String: strOldTitle
.head 3 -  String: strCurrDBSem
.head 3 -  String: strTBLName
.head 3 -  String: strTBLNameWithDB
.head 3 -  String: strSqlFields
.head 3 -  String: strSqlBinds
.head 3 -  String: strOrderBy
.head 3 -  String: strDSql
.head 3 -  String: strWinTitle
.head 3 -  String: strUnionPartAddCond
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  Number: nS
.head 3 -  Number: nTmp
.head 3 -  Number: nTmp1
.head 3 -  Number: nTmp2
.head 3 -  String: sTmp
.head 3 -  Date/Time: dTmp
.head 3 -  String: sErrTxt
.head 3 -  String: strSecure
.head 3 -  String: strAddCond1
.head 3 -  String: strAddCond2
.head 3 -  String: strAddCond3
.head 3 -  String: strAddCond4
.head 3 -  String: strAddTitle1
.head 3 -  String: strAddTitle2
.head 3 -  String: strAddTitle3
.head 3 -  String: strAddTitle4
.head 3 -  !
.head 3 -  Window Handle: hTitle
.head 3 -  File Handle: hFile
.head 3 -  Number: nFile
.head 3 -  !
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Window Handle: hColumn
.head 3 -  !
.head 3 -  Number: nDigS
.head 3 -  Number: nDigS2
.head 3 -  Number: nMaxDig
.head 3 -  Number: nUserId
.head 3 -  String: strHexMark2Ret
.head 3 -  Long String: lsHexBuf
.head 3 -  !
.head 3 -  String: sStornoReasonId
.head 3 -  String: sStornoReason
.head 3 -  !
.head 3 -  String: strUntilDT
.head 3 -  String: strDbScheN
.head 3 -  String: strDbLinkN
.head 3 -  String: strAccTabN
.head 3 -  String: strBalTabN
.head 3 -  String: strDocTabN
.head 3 -  String: strTrnTabN
.head 3 -  !
.head 3 -  String: strCondUnion1do
.head 3 -  String: strCondUnion2do
.head 3 -  String: strAddCondDo
.head 3 -  !
.head 3 -  String: sNls
.head 3 -  String: sMfo
.head 3 -  String: sNlsp
.head 3 -  String: sNd
.head 3 -  String: sText1
.head 3 -  String: sPond
.head 3 -  String: sNaex
.head 3 -  String: sNaimp
.head 3 -  Number: nEom
.head 3 -  String: sSab0
.head 3 -  String: sOper
.head 3 -  String: AMFO
.head 3 -  Number: nChkId
.head 3 -  !
.head 3 -  Number: sTmpRef
.head 3 -  ! Сторінки
.head 3 -  Boolean: bPages
.head 3 -  Number: nRangeMin
.head 3 -  Number: nRangeMax
.head 3 -  Number: nRowNumb
.head 3 -  Number: nRow1
.head 3 -  Number: nRow2
.head 3 -  Number: nPos
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Приводим окно к общему интерфейсу
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Set nLastSortRow = -1
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  !
.head 4 -  Set strWinTitle = ''
.head 4 -  ! Устанавливаем режим страниц
.head 4 +  If GetGlobalOption('DOCPAGES')
.head 5 -  Set bPages=TRUE
.head 4 +  ! Else
.head 5 -  Call Debug('NOPAG')
.head 4 -  ! Создаем 2 экземпляра объектов коннекта
.head 4 -  Call XConnectGetParams(TDoc)
.head 4 +  If NOT TDoc.Connect()
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return FALSE
.head 4 +  If NOT TAux.Clone(TDoc, TRUE)
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  ! Инициализируем Меню
.head 4 -  ! Call cTDocMenu.Init( hWndForm, 'menuTDoc', 'Документы' )
.head 4 -  Call cTDocMenu.Init(hWndForm, 'menuTDoc', CurrentLangTable.GetAtomTitle('tbl_ListDocs.menuTDoc.cTMenuDocs'))
.head 4 -  !
.head 4 -  ! Настроим выравнивание колонок с номерами счетов
.head 4 +  If GetAccountStructure(nTmp,nTmp,nTmp,nTmp) ! Прижимать влево или вправо
.head 5 -  Call SalTblSetColumnFlags( colNLSA, COL_RightJustify, TRUE )
.head 5 -  Call SalTblSetColumnFlags( colNLSB, COL_RightJustify, TRUE )
.head 4 -  !
.head 4 -  ! Закрываем изначально часть объектов
.head 4 -  Call SalDisableWindow(pbViewDoc)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalDisableWindow(pbRequest)
.head 4 -  ! ******************** пока только работает кнопка АРХИВ
.head 4 -  Call SalUseRegistry(TRUE, INI_CompanyName)
.head 4 -  Call SalGetProfileString(INI_History, 'UntilDate',  '00000000', strUntilDT, INI_ProductName)
.head 4 +  If strUntilDT != '00000000' 
.head 5 -  Call SalGetProfileString(INI_History, 'DbSchema',       'HIST', strDbScheN, INI_ProductName)
.head 5 -  Call SalGetProfileString(INI_History, 'DbLink',             '', strDbLinkN, INI_ProductName)
.head 5 -  Call SalGetProfileString(INI_History, 'Accounts',     'A_HIST', strAccTabN, INI_ProductName)
.head 5 -  Call SalGetProfileString(INI_History, 'Balances',     'B_HIST', strBalTabN, INI_ProductName)
.head 5 -  Call SalGetProfileString(INI_History, 'Documents',    'D_HIST', strDocTabN, INI_ProductName)
.head 5 -  Call SalGetProfileString(INI_History, 'Transactions', 'T_HIST', strTrnTabN, INI_ProductName)
.head 4 -  Call SalDisableWindow(obCurrent)
.head 4 -  Call SalDisableWindow(obSingle)
.head 4 +  If nDocType = DOC_MVD_EXTERNAL OR nDocType = DOC_EXTERNAL OR strUntilDT = '00000000' 
.head 5 -  Call SalDisableWindow(obArchive)
.head 4 -  Call SalDisableWindow(obInward)
.head 4 -  Call SalDisableWindow(obOutward)
.head 4 -  Call SalDisableWindow(obSEP)
.head 4 -  !
.head 4 +  If strCondUnion1 OR strCondUnion2
.head 5 -  Set fUseUnion = TRUE
.head 4 -  !
.head 4 +  If nSourceType = DB_SRC_ACTIVE
.head 5 -  Call SalDisableWindow( pbDbName )
.head 4 -  !
.head 4 -  Set nFilter = IifN(strAddCond!=STRING_Null or nFilter=0, 0, 1)
.head 4 -  !
.head 4 -  Call SalHideWindow(colID_A)
.head 4 -  Call SalHideWindow(colID_B)
.head 4 -  ! Формируем строки запроса с оглядкой на источники данных
.head 4 +  Select Case nDocType
.head 5 +  Case DOC_INTERNAL
.head 6 -  Call SalShowWindow(colID_A)
.head 6 -  Call SalShowWindow(colID_B)
.head 6 -  Set strWinTitle = strWinTitle || HEADER_Int
.head 6 -  ! Лишние колонки -- вон 
.head 6 -  Call SalHideWindow( colMFOA )
.head 6 -  Call SalHideWindow( colFN_B )
.head 6 -  Call SalHideWindow( colDAT_B )
.head 6 -  Call SalHideWindow( colREC_B )
.head 6 -  Call SalHideWindow( colFN_A )
.head 6 -  Call SalHideWindow( colDAT_A )
.head 6 -  Call SalHideWindow( colREC_A )
.head 6 -  Call SalHideWindow( colNB_A )
.head 6 -  Call SalHideWindow( colNB_B )
.head 6 -  !
.head 6 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, 
 a.s,    a.kv,   v.lcv,  v.dig, 
 a.s2,   a.kv2,  v2.lcv lcv2, v2.dig dig2, 
 a.sk,   a.dk,   a.vob,  a.data, a.vdat,  a.tt, a.ref id, a.ref, a.sos, a.userid,
 a.nd,   a.nazn, 1,      a.id_a, a.nam_a, a.id_b, a.nam_b '
.head 6 -  Set strSqlBinds =
':colMFOA, :colMFOB, :colNLSA, :colNLSB, 
 :colSn,   :colKV,   :colISO,  :colDig, 
 :colS2n,  :colKV2,  :colISO2, :colDig2, :colSK,
 :colDK,   :colVOB,  :colDDAT, :colVDAT, :colTT,    :colID,   :colREF, :colSOS, :colUser,
 :colND,   :colNAZN, :colCount,:colID_A, :colNAM_A, :colID_B, :colNAM_B '
.head 6 +  If nHaveTobo = 1
.head 7 -  Call SalShowWindow(colTOBO)
.head 7 -  Set strSqlFields = strSqlFields || ', a.tobo '
.head 7 -  Set strSqlBinds  = strSqlBinds  || ', :colTOBO '
.head 6 +  Else If nHaveTobo = 2
.head 7 +  If nBRANCHAB=1
.head 8 -  Call SalShowWindow(colBranchA)
.head 8 -  Call SalShowWindow(colBranchB)
.head 8 -  Set strSqlFields = strSqlFields || ', a.branch_a, a.branch_b '
.head 8 -  Set strSqlBinds  = strSqlBinds  || ', :colBranchA, :colBranchB '
.head 7 +  Else
.head 8 -  Call SalShowWindow(colTOBO)
.head 8 -  Set strSqlFields = strSqlFields || ', a.tobo '
.head 8 -  Set strSqlBinds  = strSqlBinds  || ', :colTOBO '
.head 6 -  ! Код сегмента для надр
.head 6 +  If GetGlobalOption('DOCSEGM')
.head 7 -  Call SalShowWindow(colSEGM)
.head 7 -  Set strSqlFields = strSqlFields || ', a.segm '
.head 7 -  Set strSqlBinds  = strSqlBinds  || ', :colSEGM '
.head 6 -  Set strOrderBy = '19 DESC'
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strTBLName = 'OPER'
.head 8 -  Set strTBLNameWithDB = strTBLName
.head 8 -  Break
.head 7 +  Case DB_SRC_ARCHIVE
.head 8 -  Set strTBLName = 'ODBDOCS'
.head 8 -  Set strTBLNameWithDB = FunMakeFullTableName(strDBName, strTBLName)
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_Ok | MB_IconStop)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_EXTERNAL
.head 6 -  Set strWinTitle = strWinTitle || HEADER_Ext
.head 6 -  ! Лишние колонки -- вон
.head 6 -  Call SalHideWindow( colUser )
.head 6 -  Call SalHideWindow( colTT )
.head 6 -  Call SalHideWindow( colSK )
.head 6 -  Call SalHideWindow( colVDAT )
.head 6 -  ! Call SalHideWindow( colNAZN )
.head 6 -  Call SalHideWindow( colS2 )
.head 6 -  Call SalHideWindow( colISO2 )
.head 6 -  Call SalDisableWindow( pbChecks )
.head 6 -  !
.head 6 +  If GetGlobalOptionEx('SEPNUM')=2
.head 7 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, a.s, a.kv, v.lcv, v.dig, a.dk, a.vob, a.data, a.datp, 
 a.rec, a.fn_a, a.dat_a, a.rec_a, a.fn_b, a.dat_b, a.rec_b, a.ref, a.sos,
 substr(a.nd,1,10), substr(a.nazn,1,160), 1, 
 substr(decode(mod(a.dk,2),0,a.nam_b,a.nam_a),1,38), b1.nb nb1, 
 substr(decode(mod(a.dk,2),0,a.nam_a,a.nam_b),1,38), b2.nb nb2'
.head 6 +  Else
.head 7 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, a.s, a.kv, v.lcv, v.dig, a.dk, a.vob, a.data, a.datp, 
 a.rec, a.fn_a, a.dat_a, a.rec_a, a.fn_b, a.dat_b, a.rec_b, a.ref, a.sos,
 substr(TranslateDos2Win(a.nd),1,10), substr(TranslateDos2Win(a.nazn),1,160), 1, 
 substr(TranslateDos2Win(decode(mod(a.dk,2),0,a.nam_b,a.nam_a)),1,38), b1.nb nb1, 
 substr(TranslateDos2Win(decode(mod(a.dk,2),0,a.nam_a,a.nam_b)),1,38), b2.nb nb2'
.head 6 -  Set strSqlBinds =
':colMFOA, :colMFOB, :colNLSA, :colNLSB, :colSn, :colKV, :colISO, :colDig,
 :colDK, :colVOB, :colDDAT, :colVDAT,   
 :colID, :colFN_A, :colDAT_A, :colREC_A,:colFN_B, :colDAT_B, :colREC_B, :colREF, :colSOS, 
 :colND, :colNAZN, :colCount, :colNAM_A, :colNB_A, :colNAM_B, :colNB_B '
.head 6 -  Set strOrderBy = 'a.rec DESC'
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strTBLName = 'ARC_RRP'
.head 8 -  Set strTBLNameWithDB = strTBLName
.head 8 -  Break
.head 7 +  Case DB_SRC_ARCHIVE
.head 8 -  Set strTBLName = 'ARCDOCS'
.head 8 -  Set strTBLNameWithDB = FunMakeFullTableName( strDBName, strTBLName )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  Call SalMessageBox( MSG_UnknownSType, MSG_InternalError, MB_Ok | MB_IconStop)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_ARCHIVE    ! Просмотр из архивних таблиц (MIK)
.head 6 -  Set strWinTitle = strWinTitle || HEADER_Arc
.head 6 -  ! Лишние колонки -- вон 
.head 6 -  ! Call SalHideWindow( colMFOA )
.head 6 -  Call SalHideWindow( colFN_B )
.head 6 -  Call SalHideWindow( colDAT_B )
.head 6 -  Call SalHideWindow( colREC_B )
.head 6 -  Call SalHideWindow( colFN_A )
.head 6 -  Call SalHideWindow( colDAT_A )
.head 6 -  Call SalHideWindow( colREC_A )
.head 6 -  Call SalHideWindow( colNAM_A )
.head 6 -  Call SalHideWindow( colNB_A )
.head 6 -  Call SalHideWindow( colNAM_B )
.head 6 -  Call SalHideWindow( colNB_B )
.head 6 -  !
.head 6 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, a.s, a.kv, v.lcv, v.dig, 
 a.s2, a.kv2, v2.lcv lcv2, v2.dig dig2, TO_NUMBER(NULL) sk,
 a.dk, a.vob, a.data, a.vdat, a.tt, a.ref id, a.ref, a.isp, fn_b, dat_b, rec_b, fn_a, dat_a, rec_a,
 a.nd, a.nazn, 1 '
.head 6 -  Set strSqlBinds =
':colMFOA, :colMFOB, :colNLSA, :colNLSB, :colSn, :colKV, :colISO, :colDig,
 :colS2n, :colKV2, :colISO2, :colDig2, :colSK,
 :colDK,   :colVOB,  :colDDAT, :colVDAT, :colTT,    :colID, :colREF, :colUser, 
 :colFN_B, :colDAT_B,:colREC_B,:colFN_A, :colDAT_A, :colREC_A, :colND, :colNAZN, :colCount '
.head 6 -  Set strOrderBy = '19 DESC'
.head 6 +  Select Case nSourceType
.head 7 +  ! Case DB_SRC_ACTIVE
.head 8 -   Set strTBLName = 'OPER'
.head 8 -   Set strTBLNameWithDB = strTBLName
.head 8 -   Break 
.head 7 +  Case DB_SRC_ARCHIVE   ! MIK
.head 8 -  Set strTBLName = strDocTabN
.head 8 -  Set strTBLNameWithDB = FunMakeFullTableName( strDbLinkN, strDocTabN )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  Call SalMessageBox( MSG_UnknownSType, MSG_InternalError, MB_Ok | MB_IconStop )
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_MVD_INTERNAL
.head 6 -  Set strWinTitle = strWinTitle || HEADER_Int
.head 6 -  ! Лишние колонки -- вон 
.head 6 -  Call SalHideWindow(colMFOA)
.head 6 -  Call SalHideWindow(colFN_B)
.head 6 -  Call SalHideWindow(colDAT_B)
.head 6 -  Call SalHideWindow(colREC_B)
.head 6 -  Call SalHideWindow(colFN_A)
.head 6 -  Call SalHideWindow(colDAT_A)
.head 6 -  Call SalHideWindow(colREC_A)
.head 6 -  Call SalHideWindow(colNAM_A)
.head 6 -  Call SalHideWindow(colNB_A)
.head 6 -  Call SalHideWindow(colNAM_B)
.head 6 -  Call SalHideWindow(colNB_B)
.head 6 -  !
.head 6 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, a.s, a.kv, v.lcv, v.dig, 
 a.s2, a.kv2, v2.lcv lcv2, v2.dig dig2, a.sk,
 a.dk, a.vob, a.data, a.vdat, a.tt, a.ref id, a.ref, a.sos, a.userid,
 a.nd, a.nazn, 1 '
.head 6 -  Set strSqlBinds =
':colMFOA, :colMFOB, :colNLSA, :colNLSB, :colSn, :colKV, :colISO, :colDig,
 :colS2n,  :colKV2, :colISO2, :colDig2, :colSK,
 :colDK,   :colVOB,  :colDDAT, :colVDAT, :colTT, :colID, :colREF, :colSOS, :colUser,
 :colND, :colNAZN, :colCount '
.head 6 -  Set strOrderBy = '19 DESC'
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strTBLName = 'MVD_OPER'
.head 8 -  Set strTBLNameWithDB = strTBLName
.head 8 -  Break
.head 7 +  ! Case DB_SRC_ARCHIVE
.head 8 -   Set strTBLName = 'ODBDOCS'
.head 8 -   Set strTBLNameWithDB = FunMakeFullTableName( strDBName, strTBLName )
.head 8 -   Break 
.head 7 +  Default
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  Call SalMessageBox( MSG_UnknownSType, MSG_InternalError, MB_Ok | MB_IconStop )
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_MVD_EXTERNAL
.head 6 -  Set strWinTitle = strWinTitle || HEADER_Ext
.head 6 -  ! Лишние колонки -- вон
.head 6 -  Call SalHideWindow(colUser)
.head 6 -  Call SalHideWindow(colTT)
.head 6 -  Call SalHideWindow(colSK)
.head 6 -  Call SalHideWindow(colS2)
.head 6 -  Call SalHideWindow(colISO2)
.head 6 -  Call SalDisableWindow(pbChecks)
.head 6 -  !
.head 6 +  If GetGlobalOptionEx('SEPNUM')=2
.head 7 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, a.s, a.kv, v.lcv, v.dig, a.dk, a.vob, a.data, a.datp, 
 a.rec, a.fn_a, a.dat_a, a.rec_a, a.fn_b, a.dat_b, a.rec_b, a.ref, a.sos,
 substr(a.nd,1,10), substr(a.nazn,1,160), 1, 
 substr(decode(mod(a.dk,2),0,a.nam_b,a.nam_a),1,38), b1.nb nb1, 
 substr(decode(mod(a.dk,2),0,a.nam_a,a.nam_b),1,38), b2.nb nb2 '
.head 6 +  Else
.head 7 -  Set strSqlFields = 
'a.mfoa, a.mfob, a.nlsa, a.nlsb, a.s, a.kv, v.lcv, v.dig, a.dk, a.vob, a.data, a.datp, 
 a.rec, a.fn_a, a.dat_a, a.rec_a, a.fn_b, a.dat_b, a.rec_b, a.ref, a.sos,
 substr(TranslateDos2Win(a.nd),1,10), substr(TranslateDos2Win(a.nazn),1,160), 1, 
 substr(TranslateDos2Win(decode(mod(a.dk,2),0,a.nam_b,a.nam_a)),1,38), b1.nb nb1, 
 substr(TranslateDos2Win(decode(mod(a.dk,2),0,a.nam_a,a.nam_b)),1,38), b2.nb nb2'
.head 6 -  Set strSqlBinds =
':colMFOA, :colMFOB, :colNLSA, :colNLSB, :colSn, :colKV, :colISO, :colDig,
 :colDK, :colVOB, :colDDAT, :colVDAT,   
 :colID, :colFN_A, :colDAT_A, :colREC_A,:colFN_B, :colDAT_B, :colREC_B, :colREF, :colSOS, 
 :colND, :colNAZN, :colCount, :colNAM_A, :colNB_A, :colNAM_B, :colNB_B '
.head 6 -  Set strOrderBy = 'a.rec DESC'
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strTBLName = 'MVD_ARC_RRP'
.head 8 -  Set strTBLNameWithDB = strTBLName
.head 8 -  Break
.head 7 +  ! Case DB_SRC_ARCHIVE
.head 8 -   Set strTBLName = 'ARCDOCS'
.head 8 -   Set strTBLNameWithDB = FunMakeFullTableName( strDBName, strTBLName )
.head 8 -   Break 
.head 7 +  Default
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  Call SalMessageBox( MSG_UnknownSType, MSG_InternalError, MB_Ok | MB_IconStop)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Default
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call SalMessageBeep( MB_IconStop )
.head 6 -  Call SalMessageBox( MSG_UnknownDType, MSG_InternalError, MB_Ok | MB_IconStop )
.head 6 -  Return FALSE
.head 6 -  Break
.head 4 -  !
.head 4 -  ! Получим семантическое имя БД для архивного источника
.head 4 +  If nSourceType = DB_SRC_ARCHIVE
.head 5 -  Call SqlPrepareAndExecute( TAux.hSql(), T('SELECT name INTO :strCurrDBSem FROM Dblist WHERE dbname=:strDBName' ))
.head 5 -  Call SqlFetchNext( TAux.hSql(), nFetchRes )
.head 5 -  Call SalDisableWindow( pbChecks )
.head 5 -  Set strWinTitle = strWinTitle || HEADER_Arc
.head 4 -  !
.head 4 -  ! Сворачивание БИСов платежных документов СЭП !!!!!!!!
+ наименование банков
.head 4 +  If nDocType = DOC_EXTERNAL OR nDocType = DOC_MVD_EXTERNAL
.head 5 +  If strAddCond != ''
.head 6 -  Set strAddCond = strAddCond || ' AND '
.head 5 -  Set strAddCond = strAddCond || ' a.bis<=1 '
.head 5 -  Set strAddCond = strAddCond || ' AND decode(mod(a.dk,2),0,a.mfob,a.mfoa)=b1.mfo AND decode(mod(a.dk,2),0,a.mfoa,a.mfob)=b2.mfo  '
.head 4 -  !
.head 4 -  ! Подмножество документов (ПОКА ТОЛЬКО на СТАРТЕ ДНЯ)
.head 4 +  If nDocSubType
.head 5 +  If strAddCond
.head 6 -  Set strAddCond = strAddCond || ' AND '
.head 5 -  Set strAddCond = strAddCond || ' a.ref IN (SELECT ref FROM tmp_log) '
.head 5 -  Call SalShowWindow( colCOMM )
.head 4 -  ! Инициализируем фильтр на таблицу
.head 4 -  Call cTDocF.Init(strTBLName, 'a')
.head 4 -  !
.head 4 -  ! Инициализируем основной запрос по форме
.head 4 +  If fUseUnion
.head 5 -  Set strUnionPartAddCond = strAddCond
.head 5 +  If strUnionPartAddCond
.head 6 -  Set strUnionPartAddCond = strUnionPartAddCond || ' AND ' || strCondUnion1
.head 5 +  Else
.head 6 -  Set strUnionPartAddCond = strCondUnion1
.head 5 -  Call Fun_InitQuerySentence( strSqlFields, strSqlBinds, strTBLNameWithDB, strUnionPartAddCond, '', cTDocQ )
.head 5 -  !
.head 5 -  Set strUnionPartAddCond = strAddCond
.head 5 +  If strUnionPartAddCond
.head 6 -  Set strUnionPartAddCond = strUnionPartAddCond || ' AND ' || strCondUnion2
.head 5 +  Else
.head 6 -  Set strUnionPartAddCond = strCondUnion2
.head 5 -  Call Fun_InitQuerySentence( strSqlFields, '', strTBLNameWithDB, strUnionPartAddCond, '', cTDocQ2 )
.head 4 +  Else
.head 5 -  Call Fun_InitQuerySentence( strSqlFields, strSqlBinds, strTBLNameWithDB, strAddCond, strOrderBy, cTDocQ )
.head 4 -  !
.head 4 -  ! Поменяем заголовочек окна
.head 4 -  Call Fun_SetWindowsTitle(hWndForm, strWinTitle, strCurrDBSem, strAddTitle)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig = 2
.head 4 -  ! Привязка к диференциатору колонок 
.head 4 -  Call TDocTable.Init(hWndForm, nDocType*10+nDocSubType, GetUserLoginName(), TRUE)
.head 4 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalGetWindowText(hWndForm, strOldTitle, 254)
.head 4 +  If nFilter
.head 5 +  Select Case nDocType
.head 6 +  Case DOC_INTERNAL
.head 7 -  Call hWndForm.tbl_ListDocs.cTDocF.cNewFilter.NewString('', -1, 'PDAT', -1, strTBLName, '>=', SalFmtFormatDateTime(SalDateCurrent()-10, 'dd/MM/yyyy'), 'Документы введенные за последние 10 дней')
.head 7 -  Break
.head 6 +  Case DOC_EXTERNAL
.head 7 -  Call hWndForm.tbl_ListDocs.cTDocF.cNewFilter.NewString('', -1, 'DAT_A', -1, strTBLName, '>=', SalFmtFormatDateTime(SalDateCurrent()-10, 'dd/MM/yyyy'), 'Документы за последние 10 дней')
.head 7 -  Break
.head 6 +  Case DOC_ARCHIVE
.head 7 -  Break
.head 6 +  Case DOC_MVD_INTERNAL
.head 7 -  Break
.head 6 +  Case DOC_MVD_EXTERNAL
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 +  ! If bKnopki   ! (MIK) 
.head 5 -   Return SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +  If SetQueryDFilterEx(cTDocF)
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Else
.head 5 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 4 -  Call SalStatusSetText(hWndForm, 'Состояние документа - жмите левой кнопкой мышки на заголовке строки')
.head 3 -  !
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If CheckFilterSet()
.head 5 +  If fUseUnion
.head 6 -  Set strDSql = T(cTDocQ.GetFullSQLStringDEx( cTDocF ))
.head 6 -  Set strDSql = strDSql || ' UNION ' || T(cTDocQ2.GetFullSQLStringDEx( cTDocF ))
.head 6 +  If strOrderBy
.head 7 -  Set strDSql = strDSql || ' ORDER BY ' || strOrderBy
.head 5 +  Else
.head 6 -  Set strDSql = T(cTDocQ.GetFullSQLStringDEx( cTDocF ))
.head 5 +  If hWndForm.tbl_ListDocs.cTDocF.GetFilterWhereClause(FALSE)
.head 6 -  ! Call SalSetWindowText(hWndForm, strOldTitle || " [Фильтр]")
.head 6 -  Call SalSetWindowText(hWndForm, strOldTitle || " [" ||
  CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTFilter') || "]")
.head 5 +  Else
.head 6 -  Call SalSetWindowText(hWndForm, strOldTitle)
.head 5 -  !
.head 5 +  If bPages  ! Переводим выборку в формат со страницами
.head 6 -  Call SalTblQueryVisibleRange ( hWndForm, nRangeMin, nRangeMax )
.head 6 -  Set nRow1=(nRangeMax-nRangeMin+1)*(dfPage-1)+1
.head 6 -  Set nRow2=(nRangeMax-nRangeMin+1)* dfPage
.head 6 -  Set strDSql=ToPageStyle(strDSql)
.head 5 -  !
.head 5 -  ! Инициализация cFilter
.head 5 -  Call cFilter.Init()
.head 5 -  !
.head 5 -  ! Call SalTblPopulate(hWndForm, TDoc.hSql(), strDSql, TBL_FillNormal)
.head 5 -  Call SalTblPopulate(hWndForm, TDoc.hSql(), strDSql, TBL_FillAll)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Set dfDocCount = SalTblColumnSum(hWndForm, SalTblQueryColumnID( colCount ), 0, 0)
.head 5 -  !
.head 5 -  Call SalDisableWindow(pbViewDoc)
.head 5 -  Call SalDisableWindow(pbRequest)
.head 5 -  Call SalEnableWindow(pbPrint)
.head 5 -  Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 -  !
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! Чтения TABVAL здесь больше не будет !!!
.head 4 +  ! If SqlPrepareAndExecute( TAux.hSql(), 'SELECT lcv, dig INTO :colISO, :colDig FROM tabval WHERE kv=:colKV')
.head 5 -  Call SqlFetchNext( TAux.hSql(), nFetchRes )
.head 4 +  ! If nDocType = DOC_INTERNAL OR nDocType = DOC_MVD_INTERNAL OR nDocType = DOC_ARCHIVE
.head 5 +  If SqlPrepareAndExecute( TAux.hSql(), 'SELECT lcv, dig INTO :colISO2, :colDig2 FROM tabval WHERE kv=:colKV2')
.head 6 -  Call SqlFetchNext( TAux.hSql(), nFetchRes )
.head 4 +  If nDocSubType
.head 5 +  If SqlPrepareAndExecute( TAux.hSql(), 'SELECT msg INTO :colCOMM FROM tmp_log WHERE ref=:colREF')
.head 6 -  Call SqlFetchNext( TAux.hSql(), nFetchRes )
.head 4 +  If colDK >= 2
.head 5 -  ! Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,255 ) ) ! голубой
.head 4 +  If (colVOB = 96 OR colVOB = 99) AND colMFOA = GetBankMfo()
.head 5 -  ! Call SalStatusSetText( hWndForm, SalNumberToStrX(( XSalGet3DAndSysColor( COLOR_3DShadow )), 0))
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize )
.head 4 +  If colVDAT != GetBankDate()
.head 5 -  Call XSalTblSetCellBackColor( colVDAT, SalColorFromRGB( 230,255,230 ) ) ! светло-зеленый
.head 4 -  ! проверка на 3 знака
.head 4 -  ! colSn, colS2n - сумма в коп. валюты
.head 4 -  Set colSn  = colSn  * SalNumberPower( 10, -colDig )
.head 4 -  Set colS2n = colS2n * SalNumberPower( 10, -colDig2 )
.head 4 -  !
.head 4 -  Set colS  = Dig4( colSn *SalNumberPower( 10, colDig  )/100, colDig,  nMaxDig )
.head 4 -  Set colS2 = Dig4( colS2n*SalNumberPower( 10, colDig2 )/100, colDig2, nMaxDig )
.head 4 -  !
.head 4 +  If colSOS < 5
.head 5 +  If nDocType = DOC_INTERNAL OR nDocType = DOC_MVD_INTERNAL
.head 6 +  Select Case colSOS
.head 7 +  Case DOC_PAY_BACK
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_DarkRed )
.head 8 -  Break
.head 7 +  Case DOC_PAY_STORNO
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_Red )
.head 8 -  Break
.head 7 +  Case DOC_PAY_INFO
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_Teal )
.head 8 -  Break
.head 7 +  Case DOC_PAY_BOOKED
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_DarkGreen )
.head 8 -  Break
.head 7 +  Case DOC_PAY_FEATURE
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_Blue )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_Purple )
.head 8 -  Break
.head 5 +  Else
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 204,224,247 ) )
.head 3 +  On SAM_TblDoDetails
.head 4 -  Call SalEnableWindow( pbViewDoc )
.head 4 -  !
.head 4 +  If (nDocType = DOC_EXTERNAL OR nDocType = DOC_MVD_EXTERNAL OR nDocType = DOC_ARCHIVE) 
AND NOT SalIsNull(colFN_B) AND NOT SalIsNull(colDAT_B)
.head 5 -  Call SalEnableWindow( pbRequest )
.head 4 +  Else
.head 5 -  Call SalDisableWindow( pbRequest )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalEnableWindow( pbViewDoc )
.head 4 -  Call DocView( hWndMDI, colID, nDocType, nSourceType, strDBName )
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( hWndForm.tbl_ListDocs.colS ), COL_GetID )
.head 5 -  Set hColumn = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( hWndForm.tbl_ListDocs.colSn ), COL_GetID )
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( hWndForm.tbl_ListDocs.colS2 ), COL_GetID )
.head 5 -  Set hColumn = SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( hWndForm.tbl_ListDocs.colS2n ), COL_GetID )
.head 4 -  !
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nSortOrder )
.head 4 -  Call SalSendMsg (hWndForm, SAM_RowSetContext, 0, 0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_CornerClick
.head 4 -  Call SetTblColumnStatus( hWndForm, TDocTable )
.head 3 -  !
.head 3 +  On SAM_Activate
.head 4 -  Call cTDocMenu.Enable( wParam )
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call cTDocMenu.ShowMenu( wParam, lParam )
.head 3 +  On WM_Paint
.head 4 -  Call TDocTable.MarkTableAsCustomisable(  )
.head 3 -  !
.head 3 +  On SAM_Close
.head 4 -  Call SalDestroyWindow( hWndForm )
.head 3 +  On SAM_Destroy
.head 4 -  Call cTDocMenu.Kill(  )
.head 4 -  Call TDocTable.Destructor(  )
.head 4 -  Call SalStatusSetText(hWndForm, '')
.head 4 -  ! ! Disactivation of  function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(TDoc.hSql(),' DocViewListArc('||strAddCond||','||strAddTitle ||') ')
.head 4 -  !
.head 4 +  If TDoc.IsConnected(  )
.head 5 -  Call TDoc.Disconnect(  )
.head 4 +  If TAux.IsConnected(  )
.head 5 -  Call TAux.Disconnect(  )
.head 4 -  !
.head 4 -  Call SalSetFocus( SalParentWindow( hWndForm ))
.head 3 +  On SAM_Help
.head 4 -  Call SalLoadApp("WinHlp32.exe","-w Win1 -i Fi_18 " || GetHelpFile() )
.head 3 -  !
.head 3 +  On UM_Search
.head 4 -  Call TblFindString( hWndForm, wParam+1 )
.head 3 +  On SAM_ContextMenu
.head 4 -  Call Fun_SumCol()
.head 3 +  On SAM_RowHeaderClick
.head 4 -  ! Set sTmp = 'Фактический'
.head 4 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipFakt')
.head 4 -  ! Call DebugN(nDocType)
.head 4 -  ! Call DebugN(colSOS)
.head 4 +  If colSOS < 5
.head 5 +  If nDocType = DOC_INTERNAL
.head 6 +  Select Case colSOS
.head 7 +  Case DOC_PAY_BACK
.head 8 -  ! Set sTmp = 'Снят с обработки'
.head 8 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipBack')
.head 8 -  Break
.head 7 +  Case DOC_PAY_STORNO
.head 8 -  ! Set sTmp = 'Возвращен контроллером'
.head 8 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipStorno')
.head 8 -  Break
.head 7 +  Case DOC_PAY_INFO
.head 8 -  ! Set sTmp = 'Информационный'
.head 8 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipInfo')
.head 8 -  Break
.head 7 +  Case DOC_PAY_BOOKED
.head 8 -  ! Set sTmp = 'Плановый'
.head 8 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipBooked')
.head 8 -  Break
.head 7 +  Case DOC_PAY_FEATURE
.head 8 -  ! Set sTmp = 'Форвардный'
.head 8 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipFeature')
.head 8 -  Break
.head 7 +  Default
.head 8 -  ! Set sTmp = 'Неизвестное состояние'
.head 8 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipDefault')
.head 8 -  ! Break
.head 5 +  Else If nDocType = DOC_ARCHIVE
.head 6 -  ! Set sTmp = 'Архивний'
.head 6 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipArchive')
.head 5 +  Else
.head 6 -  ! Set sTmp = 'Состояние ' || Str(colSOS)
.head 6 -  Set sTmp = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipSos') || ' ' || Str(colSOS)
.head 4 +  If colVOB = 96 OR colVOB = 99
.head 5 -  ! Set sTmp = sTmp || ', исправительный'
.head 5 -  Set sTmp = sTmp || ', ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipVob99')
.head 4 +  If colDK >= 2
.head 5 -  ! Set sTmp = sTmp || IifS(sTmp='Информационный', '', ', информационный')
.head 5 -  Set sTmp = sTmp || IifS(sTmp=CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipInfo'), '', 
', ' || CurrentLangTable.GetAtomTitle('tbl_ListDocs.cTTipInfo'))
.head 4 -  Call XSalTooltipSetColors(SalColorGet(colTT, COLOR_IndexCellText), COLOR_LightGray)
.head 4 -  Call XSalTooltipShow(hWndForm, sTmp)
.head 4 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On UM_ObjActivate
.head 4 -  ! Set strAddCond = ''
.head 4 +  ! If strAddCond1
.head 5 -   Set strAddCond = strAddCond||IifS(strAddCond='','',' and ')||strAddCond1
.head 4 +  ! If strAddCond2
.head 5 -   Set strAddCond = strAddCond||IifS(strAddCond='','',' and ')||strAddCond2
.head 4 +  ! If strAddCond3
.head 5 -   Set strAddCond = strAddCond||IifS(strAddCond='','',' and ')||strAddCond3
.head 4 +  ! If strAddCond4
.head 5 -   Set strAddCond = strAddCond||IifS(strAddCond='','',' and ')||strAddCond4
.head 4 -  ! Call Debug(strAddCond)
.head 4 -  Set strAddTitle='Документы '||strAddTitle1||' '||strAddTitle2||' '||strAddTitle3||' '||strAddTitle4
.head 4 -  Call SalSendMsg( hWndForm, SAM_Create, 0, 0 )
.head 4 -  Call SalSendMsg( hWndForm, SAM_CreateComplete, 0, 0 )
.head 3 +  On WM_KeyUp
.head 4 +  If bPages and wParam=VK_PageUp
.head 5 -  Call SalSendMsg( pbPageUp, SAM_Click, 0, 0 )
.head 4 +  If bPages and wParam=VK_PageDown
.head 5 -  Call SalSendMsg( pbPageDn, SAM_Click, 0, 0 )
.head 4 +  If wParam=VK_F12
.head 5 -  Set bPages=not bPages
.head 5 -  Call SalSendMsg( pbPageUp, SAM_Create, 0, 0 )
.head 5 -  Call SalSendMsg( dfPage, SAM_Create, 0, 0 )
.head 5 -  Call SalSendMsg( pbPageDn, SAM_Create, 0, 0 )
.head 1 -  !
.head 1 +  Form Window: frm_ViewDoc
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.025"
.head 4 -  Top:    0.813"
.head 4 -  Width:  11.071"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.594"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Default
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: None
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Просмотр атрибутов документа вместе с дополнительной информацией.
.head 2 +  Named Menus
.head 3 +  Menu: menuDocs
.head 4 -  Resource Id: 22188
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: На&печатать
.head 5 -  Resource Id: 22189
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbPrint, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Закр&ыть
.head 5 -  Resource Id: 22190
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.375"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPrint
.data CLASSPROPSSIZE
0000: 1400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000100 00000000
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.043"
.head 6 -  Top:    0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Распечатать документ (F5)'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ViewDoc.cBTipPrint') || ' (F5)'
.head 6 +  On SAM_Click
.head 7 -  ! Call DocsPrintFromParam(nDocId, nCcyA, nVob, strFaceNum || ' (#' || SalNumberToStrX(nIntRef,0) || ')', dfMfoA,
     strOkpoA, dfBankA, dfAccA, dfSender, dfSummA*100, nSk, nDk, dfMfoB, strOkpoB, dfBankB, dfAccB, dfReceiver,
     nCcyB, dfSummB*100, mlDetails, dtDocDate, PRINT_DOC)
.head 7 -  Call DocsPrint(nDocId, strSqlTblName, PRINT_DOC)
.head 4 -  Line
.head 5 -  Resource Id: 22187
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.557"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  0.557"
.head 6 -  End Y:  0.396"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.data CLASSPROPSSIZE
0000: 5600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573004300 746162446F630974 61625374616D7073
0020: 097461624D6F6465 6C09746162416464 4174720974616256 6973617309746162
0040: 5357494654097461 624B530974616242 495300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.671"
.head 6 -  Top:    0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Закрыть документ'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ViewDoc.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Line
.head 5 -  Resource Id: 22191
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.2"
.head 6 -  Begin Y:  0.01"
.head 6 -  End X:  1.2"
.head 6 -  End Y:  0.385"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  ! ctb_pbUpdate: pbSave
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    0.048"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +   Message Actions 
.head 6 +   On SAM_Click
.head 7 -  Call SalSendMsg(dlg_TabViewModel.tblModel, UM_ObjActivate, 0, 0)
.head 6 +   On SAM_Create
.head 7 -   Set strTip = 'Сохранить изменения (F2)'
.head 4 +  ! Check Box: cbAlign
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Выровнять по данным
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  3.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Set bAlign = cbAlign
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162557365466F 6E74000700506172 656E740000546162 466F6E744E616D65
0020: 000E004D53205361 6E73205365726966 0000546162546F70 4D617267696E0002
0040: 0030000054616246 6F726D5061676573 0061000909646C67 5F54616256696577
0060: 4D6F64656C09646C 675F546162566965 77446F7009646C67 5F54616256696577
0080: 436865636B09646C 675F546162576965 7653574946540964 6C675F5461625669
00A0: 65774B5309646C67 5F54616256696577 4249530000546162 447261775374796C
00C0: 65000B0057696E39 355374796C650000 5461625269676874 4D617267696E0002
00E0: 003000005461624E 616D657300430074 6162446F63097461 625374616D707309
0100: 7461624D6F64656C 0974616241646441 7472097461625669 7361730974616253
0120: 5749465409746162 4B53097461624249 5300005461624C61 62656C7300620026
0140: C4EEEAF3ECE5EDF2 0926D2E5F52E20F0 E5EAE2E8E7E8F2FB 09C1F3F52E2026EC
0160: EEE4E5EBFC09C4EE EF2E2026F0E5EAE2 E8E7E8F2FB0926C2 E8E7FB09532E572E
0180: 492E462E542E20D1 EEEEE1F9E5EDE8E5 200926CAEEF8F2EE F0E8F109C1C8D1FB
01A0: 0000546162506167 65436F756E740002 0031000054616242 6F74746F6D4D6172
01C0: 67696E0002003000 0054616243757272 656E740007007461 62446F6300005461
01E0: 624C6566744D6172 67696E0002003000 00546162466F6E74 53697A6500020038
0200: 00005461624F7269 656E746174696F6E 000A00546162734F 6E546F7000000000
0220: 0000000000000000 0000000000000000 0000000000000000 0000
.enddata
.data CLASSPROPSSIZE
0000: 3A02
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  !
.head 6 -  Call picTabs.SetLabel(0,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs0'), TRUE)
.head 6 -  Call picTabs.SetLabel(1,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs1'), TRUE)
.head 6 -  Call picTabs.SetLabel(2,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs2'), TRUE)
.head 6 -  Call picTabs.SetLabel(3,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs3'), TRUE)
.head 6 -  Call picTabs.SetLabel(4,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs4'), TRUE)
.head 6 -  Call picTabs.SetLabel(5,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs5'), TRUE)
.head 6 -  Call picTabs.SetLabel(6,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs6'), TRUE)
.head 6 -  Call picTabs.SetLabel(7,CurrentLangTable.GetAtomTitle('frm_ViewDoc.cTabs7'), TRUE)
.head 6 -  !
.head 6 +  If nDocType = DOC_EXTERNAL OR nDocType = DOC_MVD_EXTERNAL
.head 7 +  If nIntRef = NUMBER_Null OR nIntRef = 0
.head 8 -  Call picTabs.Enable(2, FALSE)
.head 8 -  Call picTabs.Enable(3, FALSE)
.head 8 -  Call picTabs.Enable(4, FALSE)
.head 7 -  Call picTabs.Enable(5, FALSE)
.head 6 +  Else
.head 7 +  If nSWRef = NUMBER_Null or nSWRef = 0
.head 8 -  Call picTabs.Enable(5, FALSE)
.head 6 -  ! BIS
.head 6 +  If not nBISCount
.head 7 -  Call picTabs.Delete(7, TRUE)
.head 6 -  ! KS
.head 6 +  If GetGlobalOption('M_KOST') = '1'
.head 7 +  If not nKSCount
.head 8 -  Call picTabs.Enable(6, FALSE)
.head 6 +  Else
.head 7 -  Call picTabs.Delete(6, TRUE)
.head 6 -  Call picTabs.InitializeFormPages(SalNumberToStrX(nDocType,0) || ';' || SalNumberToStrX(nDocId, 0) || ';' ||
     SalNumberToStrX(nIntRef, 0) || ';' || SalNumberToStrX(nRecID, 0))
.head 3 -  !
.head 3 +  Data Field: tDocTitle
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.171"
.head 6 -  Top:    0.458"
.head 6 -  Width:  10.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: tDocDate
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.667"
.head 6 -  Width:  4.443"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: tValueDateTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.214"
.head 6 -  Top:    0.917"
.head 6 -  Width:  2.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfValueDate
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.229"
.head 6 -  Top:    0.893"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tDebetTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.6"
.head 6 -  Top:    0.917"
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: tSenderTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.314"
.head 6 -  Top:    1.25"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSenderOKPOTitle
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSenderOKPO
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.417"
.head 6 -  Top:    1.202"
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: tAccATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.586"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tCcyATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSender
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.329"
.head 6 -  Top:    1.479"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfAccA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    1.438"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 5 +  On VTM_LeftDoubleClick
.head 6 +  If dfMfoA = GetBankMfo() and SqlPrepareAndExecute(hSql(), "
   SELECT acc
   INTO   :nAcc
   FROM   saldo
   WHERE  nls=:dfAccA and kv=:nCcyA") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call ShowTurnForAccount(nAcc, GetBankDateEx())
.head 3 +  Data Field: dfCcyA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.438"
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tBankATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.329"
.head 6 -  Top:    1.74"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tMfoATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.1"
.head 6 -  Top:    1.74"
.head 6 -  Width:  0.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSummATitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.74"
.head 6 -  Width:  1.171"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.329"
.head 6 -  Top:    1.958"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfMfoA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    1.917"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfSummA
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    1.917"
.head 6 -  Width:  2.357"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 22192
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.155"
.head 5 -  Width:  7.971"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: tKreditTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.6"
.head 6 -  Top:    2.25"
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Инвертируем названия Дебет/Кредит в зависимости от nDk
.head 6 +  If nDk = 0 OR nDk = 2
.head 7 -  ! Call FunSwapLabelsName( tDebetTitle, tKreditTitle )
.head 7 -  Call FunSwapLabelsName(dfSender, dfReceiver)
.head 7 -  Call FunSwapLabelsName(dfAccA, dfAccB)
.head 7 -  Call FunSwapLabelsName(dfBankA, dfBankB)
.head 7 -  Call FunSwapLabelsName(dfMfoA, dfMfoB)
.head 7 -  Call FunSwapLabelsName(dfSenderOKPO, dfReceiverOKPO)
.head 7 +  If dfCcyA != dfCcyB and (not SalIsNull(dfCcyA)) and (not SalIsNull(dfCcyB))
.head 8 -  Call FunSwapLabelsName(dfCcyA, dfCcyB)
.head 7 +  If dfSummA != dfSummB and (not SalIsNull(dfSummA)) and (not SalIsNull(dfSummB)) and SalStrToNumber(dfSummB) != 0
.head 8 -  Call FunSwapLabelsName(dfSummA, dfSummB)
.head 3 +  Data Field: tReceiverTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    2.552"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tReceiverOKPOTitle
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    2.548"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfReceiverOKPO
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.417"
.head 6 -  Top:    2.5"
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: tAccBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.071"
.head 6 -  Top:    2.552"
.head 6 -  Width:  1.586"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tCcyBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    2.552"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfReceiver
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.314"
.head 6 -  Top:    2.781"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfAccB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.071"
.head 6 -  Top:    2.74"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 5 +  On VTM_LeftDoubleClick
.head 6 +  If dfMfoB = GetBankMfo() and SqlPrepareAndExecute(hSql(), "
   SELECT acc
   INTO :nAcc
   FROM saldo
   WHERE nls=:dfAccB and kv=:nCcyB") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call ShowTurnForAccount(nAcc, GetBankDateEx())
.head 3 +  Data Field: dfCcyB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    2.74"
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tBankBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.314"
.head 6 -  Top:    3.042"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tMfoBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.086"
.head 6 -  Top:    3.042"
.head 6 -  Width:  0.957"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSummBTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    3.042"
.head 6 -  Width:  1.171"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.208"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.314"
.head 6 -  Top:    3.26"
.head 6 -  Width:  5.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfMfoB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.071"
.head 6 -  Top:    3.219"
.head 6 -  Width:  1.971"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfSummB
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.243"
.head 6 -  Top:    3.219"
.head 6 -  Width:  2.357"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 22194
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.452"
.head 5 -  Width:  7.971"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 22193
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    1.155"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.381"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Multiline Field: mlSummPr
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    3.563"
.head 6 -  Width:  10.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.396"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Data Field: tDetailsTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    3.917"
.head 6 -  Width:  3.443"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.177"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlDetails
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000700 746162446F630000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 240
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.083"
.head 6 -  Width:  10.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.542"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  ! ВременнАя статистика по документу
.head 3 -  !
.head 3 -  ! Group Box: Основные 
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.271"
.head 5 -  Top:    0.417"
.head 5 -  Width:  9.286"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.762"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Times New Roman
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: tPostedTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    0.631"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPosted
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.607"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Data Field: tVisedTitle
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    0.893"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVised
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.869"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 -  ! Group Box: Система электронных платежей 
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.271"
.head 5 -  Top:    1.229"
.head 5 -  Width:  9.286"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.438"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Times New Roman
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: tArrivedTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.457"
.head 6 -  Top:    1.51"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfArrived
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    1.469"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Data Field: tReceivedTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.457"
.head 6 -  Top:    1.813"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfInFile
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    1.771"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfInFileDate
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.243"
.head 6 -  Top:    1.771"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Data Field: tInFilePayTitle
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.457"
.head 6 -  Top:    2.438"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfInFilePay
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    2.375"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Data Field: tInFileReceivedTitle
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 7300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.457"
.head 6 -  Top:    2.125"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfInFileReceived
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 7300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    2.073"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Data Field: tSendedTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.457"
.head 6 -  Top:    2.927"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfOutFile
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    2.885"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = sTmp
.head 3 +  Data Field: dfOutFileDate
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.243"
.head 6 -  Top:    2.885"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Data Field: tChekedTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 7300000000
.enddata
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.471"
.head 6 -  Top:    3.24"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfCheckedDate
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 7300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    3.198"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set dTmp = MyValue
.head 5 +  On SAM_AnyEdit
.head 6 -  Set MyValue = dTmp
.head 3 +  Picture: pic2
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    0.524"
.head 5 -  Width:  9.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.655"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Основные
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 56489
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    0.44"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgGeneral
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    1.333"
.head 5 -  Width:  9.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Система электронных платежей
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 56490
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.25"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: TabActivateFinish
.head 4 -  Description: Indicates that a tab has been activated.
This function is called after the child windows have been shown
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nTab = 0
.head 6 +  If nCcyA = nCcyB or nDocType = DOC_EXTERNAL or nDocType = DOC_MVD_EXTERNAL
.head 7 -  Call picTabs.HideWindow(tCcyBTitle)
.head 7 -  Call picTabs.HideWindow(dfCcyB)
.head 7 -  Call picTabs.HideWindow(tSummBTitle)
.head 7 -  Call picTabs.HideWindow(dfSummB)
.head 3 +  Function: FunSwapLabelsName
.head 4 -  Description: Поменять названия ярлыков местами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWinA
.head 5 -  Window Handle: hWinB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strNameA
.head 5 -  String: strNameB
.head 4 +  Actions
.head 5 +  If hWinA = hWndNULL or hWinB = hWndNULL
.head 6 -  Return FALSE
.head 5 -  Call SalGetWindowText(hWinA, strNameA, 250)
.head 5 -  Call SalGetWindowText(hWinB, strNameB, 250)
.head 5 -  !
.head 5 -  Call SalSetWindowText(hWinA, strNameB)
.head 5 -  Call SalSetWindowText(hWinB, strNameA)
.head 5 -  !
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nDocId		! Идентификатор документа (Rec/Ref)
.head 3 -  Number: nDocType	! Тип документа (Int/Ext)
.head 3 -  Number: nSourceType	! Тип источника данных (Current/Archive)
.head 3 -  String: strSourceName	! Имя БД (для архивной базы)
.head 2 +  Window Variables
.head 3 -  : TDoc
.head 4 -  Class: cABSConnect
.head 3 -  : cDocMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  !
.head 3 -  String: strWinTitle
.head 3 -  Window Handle: hTitle
.head 3 -  !
.head 3 -  String: strSqlFields
.head 3 -  String: strSqlBinds
.head 3 -  String: strSqlTblName
.head 3 -  String: strSqlMTblName
.head 3 -  String: strSqlPKName
.head 3 -  !
.head 3 -  Number: nIntRef
.head 3 -  Number: nSWRef
.head 3 -  Number: nDk
.head 3 -  Number: nSk
.head 3 -  Number: nCcyA
.head 3 -  Number: nCcyB
.head 3 -  String: nCcyAUnit
.head 3 -  String: nCcyBUnit
.head 3 -  String: strOkpoA
.head 3 -  String: strOkpoB
.head 3 -  Number: nVob
.head 3 -  String: strMonth
.head 3 -  String: strVob
.head 3 -  String: strFaceNum
.head 3 -  Date/Time: dtDocDate
.head 3 -  !
.head 3 -  Number: nKSCount
.head 3 -  Number: nBISCount
.head 3 -  !
.head 3 -  Number: nDigA
.head 3 -  Number: nDigB
.head 3 -  Number: nSummA
.head 3 -  Number: nSummB
.head 3 -  !
.head 3 -  String: sTmp
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nAcc
.head 3 -  Number: nRecID
.head 3 -  !
.head 3 -  Number: nT
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Call cDocMenu.Init(hWndForm, 'menuDocs', 'Документ')
.head 4 -  Call cDocMenu.Init(hWndForm, 'menuDocs', CurrentLangTable.GetAtomTitle('frm_ViewDoc.menuDocs.cTMenuDoc'))
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  ! Здесь не удалять! єто временно закомментировал MIK
.head 4 +  ! If nSourceType = DB_SRC_ARCHIVE and strSourceName = ''
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SalMessageBeep(MB_IconStop)
.head 5 -  Call SalMessageBox(MSG_UnknownSName, MSG_InternalError, MB_Ok | MB_IconStop)
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Call XConnectGetParams(TDoc)
.head 4 +  If NOT TDoc.Connect()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  ! Set strWinTitle = HEADER_Docs
.head 4 -  Set strWinTitle = CurrentLangTable.GetAtomTitle('cTHEADER_Docs')
.head 4 +  Select Case nDocType
.head 5 +  Case DOC_INTERNAL
.head 6 -  Set strSqlFields = 'mfoa,id_a,id_b,nlsa,mfob,nlsb,s,sk,s2,nd,nam_a,nam_b,nazn,data,datp,pdat,vdat,dk,kv,kv2,vob'
.head 6 -  Set strSqlBinds  = ':dfMfoA,:dfSenderOKPO,:dfReceiverOKPO,:dfAccA,:dfMfoB,:dfAccB,:nSummA,:nSk,:nSummB,:strFaceNum,
    :dfSender,:dfReceiver,:mlDetails,:dtDocDate,:dfArrived,:dfPosted,:dfValueDate,:nDk,:nCcyA,:nCcyB,:nVob'
.head 6 -  Set strSqlPKName = 'Ref'
.head 6 -  ! Set strWinTitle = strWinTitle || ' ' || HEADER_Int
.head 6 -  Set strWinTitle = strWinTitle || ' ' || CurrentLangTable.GetAtomTitle('cTHEADER_Int')
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strSqlTblName = 'OPER'
.head 8 -  Break
.head 7 +  Case DB_SRC_ARCHIVE
.head 8 -  Set strSqlTblName = FunMakeFullTableName(strSourceName, 'ODBDOCS')
.head 8 -  ! Set strWinTitle = strWinTitle || HEADER_Arc
.head 8 -  Set strWinTitle = strWinTitle || CurrentLangTable.GetAtomTitle('cTHEADER_Arc')
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_EXTERNAL
.head 6 -  Set strSqlFields = 'mfoa,id_a,id_b,nlsa,mfob,nlsb,s,nd,nam_a,nam_b,nazn,data,datp,trunc(dat_a),fn_a,dat_a,fn_b,dat_b,
    dk,kv,vob,ref'
.head 6 -  Set strSqlBinds  = ':dfMfoA,:dfSenderOKPO,:dfReceiverOKPO,:dfAccA,:dfMfoB,:dfAccB,:nSummA,:strFaceNum,:dfSender,
    :dfReceiver,:mlDetails,:dtDocDate,:dfArrived,:dfValueDate,:dfInFile,:dfInFileDate,:dfOutFile,:dfOutFileDate,:nDk,
    :nCcyA,:nVob,:nIntRef'
.head 6 -  Set strSqlPKName = 'Rec'
.head 6 -  ! Set strWinTitle = strWinTitle || ' ' || HEADER_Ext
.head 6 -  Set strWinTitle = strWinTitle || ' ' || CurrentLangTable.GetAtomTitle('cTHEADER_Ext')
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strSqlTblName = 'ARC_RRP'
.head 8 -  Break
.head 7 +  Case DB_SRC_ARCHIVE
.head 8 -  Set strSqlTblName = FunMakeFullTableName(strSourceName, 'ARCDOCS')
.head 8 -  ! Set strWinTitle = strWinTitle || HEADER_Arc
.head 8 -  Set strWinTitle = strWinTitle || CurrentLangTable.GetAtomTitle('cTHEADER_Arc')
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_ARCHIVE
.head 6 -  Set strSqlFields = 'mfoa,id_a,id_b,nlsa,mfob,nlsb,s,TO_NUMBER(NULL),s2,nd,nam_a,nam_b,nazn,data,datp,pdat,vdat,dk,kv,
    kv2,vob'
.head 6 -  Set strSqlBinds  = ':dfMfoA,:dfSenderOKPO,:dfReceiverOKPO,:dfAccA,:dfMfoB,:dfAccB,:nSummA,:nSk,:nSummB,:strFaceNum,
    :dfSender,:dfReceiver,:mlDetails,:dtDocDate,:dfArrived,:dfPosted,:dfValueDate,:nDk,:nCcyA,:nCcyB,:nVob'
.head 6 -  Set strSqlPKName = 'Ref'
.head 6 -  ! Set strWinTitle = strWinTitle || ' ' || HEADER_Arc
.head 6 -  Set strWinTitle = strWinTitle || ' ' || CurrentLangTable.GetAtomTitle('cTHEADER_Arc')
.head 6 +  Select Case nSourceType
.head 7 +  ! Case DB_SRC_ACTIVE
.head 8 -   Set strSqlTblName = 'OPER'
.head 8 -   Break 
.head 7 +  Case DB_SRC_ARCHIVE
.head 8 -  ! Set strSqlTblName = FunMakeFullTableName(strSourceName, tbl_ListDocs.strDocTabN)
.head 8 -  Set strSqlTblName = FunMakeFullTableName(tbl_ListDocs.strDbLinkN, tbl_ListDocs.strDocTabN)
.head 8 -  ! Set strWinTitle = strWinTitle || HEADER_Arc
.head 8 -  Set strWinTitle = strWinTitle || CurrentLangTable.GetAtomTitle('cTHEADER_Arc')
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_MVD_INTERNAL
.head 6 -  Set strSqlFields = 'mfoa,id_a,id_b,nlsa,mfob,nlsb,s,sk,s2,nd,nam_a,nam_b,nazn,data,datp,pdat,vdat,dk,kv,kv2,vob'
.head 6 -  Set strSqlBinds  = ':dfMfoA,:dfSenderOKPO,:dfReceiverOKPO,:dfAccA,:dfMfoB,:dfAccB,:nSummA,:nSk,:nSummB,:strFaceNum,
   :dfSender,:dfReceiver,:mlDetails,:dtDocDate,:dfArrived,:dfPosted,:dfValueDate,:nDk,:nCcyA,:nCcyB,:nVob'
.head 6 -  Set strSqlPKName = 'Ref'
.head 6 -  ! Set strWinTitle = strWinTitle || ' ' || HEADER_Int
.head 6 -  Set strWinTitle = strWinTitle || ' ' || CurrentLangTable.GetAtomTitle('cTHEADER_Int')
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strSqlTblName = 'MVD_OPER'
.head 8 -  Break
.head 7 +  ! Case DB_SRC_ARCHIVE
.head 8 -  Set strSqlTblName = FunMakeFullTableName(strSourceName, 'ODBDOCS')
.head 8 -  ! Set strWinTitle = strWinTitle || HEADER_Arc
.head 8 -  Set strWinTitle = strWinTitle || CurrentLangTable.GetAtomTitle('cTHEADER_Arc')
.head 8 -  Break 
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Case DOC_MVD_EXTERNAL
.head 6 -  Set strSqlFields = 'mfoa,id_a,id_b,nlsa,mfob,nlsb,s,nd,nam_a,nam_b,nazn,data,datp,trunc(dat_a),fn_a,dat_a,fn_b,dat_b,
    dk,kv,vob,ref'
.head 6 -  Set strSqlBinds  = ':dfMfoA,:dfSenderOKPO,:dfReceiverOKPO,:dfAccA,:dfMfoB,:dfAccB,:nSummA,:strFaceNum,:dfSender,
   :dfReceiver,:mlDetails,:dtDocDate,:dfArrived,:dfValueDate,:dfInFile,:dfInFileDate,:dfOutFile,:dfOutFileDate,:nDk,
   :nCcyA,:nVob,:nIntRef'
.head 6 -  Set strSqlPKName = 'Rec'
.head 6 -  ! Set strWinTitle = strWinTitle || ' ' || HEADER_Ext
.head 6 -  Set strWinTitle = strWinTitle || ' ' || CurrentLangTable.GetAtomTitle('cTHEADER_Ext')
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strSqlTblName = 'MVD_ARC_RRP'
.head 8 -  Break
.head 7 +  ! Case DB_SRC_ARCHIVE
.head 8 -  Set strSqlTblName = FunMakeFullTableName(strSourceName, 'ARCDOCS')
.head 8 -  ! Set strWinTitle = strWinTitle || HEADER_Arc
.head 8 -  Set strWinTitle = strWinTitle || CurrentLangTable.GetAtomTitle('cTHEADER_Arc')
.head 8 -  Break 
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 -  Break
.head 5 +  Default
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBeep(MB_IconStop)
.head 6 -  Call SalMessageBox(MSG_UnknownDType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 6 -  Break
.head 4 -  !
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get main Atributes
.head 4 -  ! Call SalHideWindow(dfVised)
.head 4 -  ! Call SalHideWindow(tVisedTitle)
.head 4 -  Set dfVised = DATETIME_Null
.head 4 +  If SqlPrepareAndExecute(TDoc.hSql(), T('
   SELECT ' || strSqlFields  || '
   INTO   ' || strSqlBinds   || '
   FROM   ' || strSqlTblName || '
   WHERE  ' || strSqlPKName  || '=:nDocId'))
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 5 -  ! Call SalShowWindow(dfVised)
.head 5 -  ! Call SalShowWindow(tVisedTitle)
.head 5 +  If nDocType = DOC_INTERNAL or nDocType = DOC_MVD_INTERNAL
.head 6 -  ! Call Debug('1')
.head 6 +  If SqlPrepareAndExecute(TDoc.hSql(), T('
   SELECT max(DAT)
   INTO   :dfVised
   FROM   oper_visa
   WHERE  ref=:nDocId'))
.head 7 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 7 +  ! If dfVised = DATETIME_Null
.head 8 -   Call SalHideWindow(dfVised)
.head 8 -   Call SalHideWindow(tVisedTitle)
.head 4 -  ! -------------------------------------------
.head 4 -  If GetGlobalOptionEx('SEPNUM') = 2
.head 4 +  Else
.head 5 -  ! Make OEM<->ANSI decoding for external documents
.head 5 +  If nDocType = DOC_EXTERNAL or nDocType = DOC_MVD_EXTERNAL
.head 6 -  Set dfReceiver = StrDosToWinX(dfReceiver)
.head 6 -  Set dfSender   = StrDosToWinX(dfSender)
.head 6 -  Set mlDetails  = StrDosToWinX(mlDetails)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get Document type and number
.head 4 +  If nDk >= 2
.head 5 +  If nDk = 2
.head 6 -  ! Set strVob = 'ІНФОРМАЦІЙНИЙ ЗАПИТ'
.head 6 -  Set strVob = CurrentLangTable.GetAtomTitle('dlg_ViewDop.tSVobDk2')
.head 5 +  Else
.head 6 -  ! Set strVob = 'ІНФОРМАЦІЙНЕ ПОВІДОМЛЕННЯ'
.head 6 -  Set strVob = CurrentLangTable.GetAtomTitle('dlg_ViewDop.tSVobDk3')
.head 4 +  Else
.head 5 -  Call SqlPrepareAndExecute(TDoc.hSql(), '
     SELECT name 
     INTO   :strVob
     FROM   vob
     WHERE  vob=:nVob')
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  Set tDocTitle = SalStrTrimX(SalStrUpperX(strVob) || ' №' || strFaceNum)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get document date in word
.head 4 -  Set tDocDate = IifS(nDocType=DOC_EXTERNAL or nDocType=DOC_MVD_EXTERNAL, '', CurrentLangTable.GetAtomTitle('tTimeFrom') ||
    ' ' || SalNumberToStrX(SalDateDay(dtDocDate), 0) || ' ' || GetMonthName(SalDateMonth(dtDocDate), TRUE) || ' ' ||
     SalNumberToStrX(SalDateYear(dtDocDate), 0) || ' ' || CurrentLangTable.GetAtomTitle('tYear'))
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get banks names
.head 4 +  If dfMfoA != STRING_Null
.head 5 -  Call SqlPrepareAndExecute(TDoc.hSql(), '
     SELECT nb
     INTO   :dfBankA
     FROM   banks
     WHERE  mfo=:dfMfoA')
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 +  If dfMfoB != STRING_Null
.head 5 -  Call SqlPrepareAndExecute(TDoc.hSql(), '
     SELECT nb
     INTO   :dfBankB
     FROM   banks
     WHERE  mfo=:dfMfoB')
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get currency nams and units
.head 4 +  If nCcyA != NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT lcv,unit,dig
   INTO   :dfCcyA,:nCcyAUnit,:nDigA
   FROM   tabval
   WHERE  kv=:nCcyA')
.head 6 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 +  If nCcyA != nCcyB and (nDocType = DOC_INTERNAL or nDocType = DOC_MVD_INTERNAL)
.head 5 +  If nCcyB != NUMBER_Null
.head 6 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT lcv,unit,dig
   INTO   :dfCcyB,:nCcyBUnit,:nDigB
   FROM   tabval
   WHERE  kv=:nCcyB')
.head 7 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set dfCcyB = dfCcyA
.head 5 -  Set nCcyBUnit = nCcyAUnit
.head 5 -  Set nDigB  = nDigA
.head 5 -  Call picTabs.HideWindow(tCcyBTitle)
.head 5 -  Call picTabs.HideWindow(dfCcyB)
.head 5 -  Call picTabs.HideWindow(tSummBTitle)
.head 5 -  Call picTabs.HideWindow(dfSummB)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get summ by characters
.head 4 +  If nCcyA = GetBaseVal()
.head 5 -  Set mlSummPr = SumPr(nSummA, 'F', CurrentLangTable.GetAtomTitle('tBaseCcy'),
    CurrentLangTable.GetAtomTitle('tBaseCcyUnit'))
.head 4 +  Else
.head 5 -  Set mlSummPr = SumPr(nSummA, 'F', dfCcyA, nCcyAUnit || '.')
.head 4 -  ! проверка на 3 знака
.head 4 -  Set dfSummA = Dig4(nSummA/100, nDigA, nDigA)
.head 4 -  Set dfSummB = Dig4(nSummB/100, nDigB, nDigB)
.head 4 -  ! -------------------------------------------
.head 4 -  ! Get time statistics
.head 4 +  If nDocType = DOC_INTERNAL or nDocType = DOC_MVD_INTERNAL
.head 5 +  If dfMfoA = dfMfoB and dfMfoB = GetBankMfo()
.head 6 -  !
.head 6 -  Call SalDisableWindow(tSendedTitle)
.head 6 -  Call EnableWindow(dfOutFile, FALSE)
.head 6 -  Call EnableWindow(dfOutFileDate, FALSE)
.head 6 -  Call SalDisableWindow(tChekedTitle)
.head 6 -  Call EnableWindow(dfCheckedDate, FALSE)
.head 6 -  !
.head 6 -  Call SalDisableWindow(tReceivedTitle)
.head 6 -  Call EnableWindow(dfInFile, FALSE)
.head 6 -  Call EnableWindow(dfInFileDate, FALSE)
.head 6 -  Call SalDisableWindow(tInFilePayTitle)
.head 6 -  Call EnableWindow(dfInFilePay, FALSE)
.head 6 -  Call SalDisableWindow(tInFileReceivedTitle)
.head 6 -  Call EnableWindow(dfInFileReceived, FALSE)
.head 6 -  !
.head 5 -  ! Just trap the situation when document directed to outer space
.head 5 +  Else
.head 6 +  Select Case nSourceType
.head 7 +  Case DB_SRC_ACTIVE
.head 8 -  Set strSqlMTblName = 'ARC_RRP'
.head 8 -  Break
.head 7 +  Case DB_SRC_ARCHIVE
.head 8 -  Set strSqlTblName = FunMakeFullTableName(strSourceName, 'ARCDOCS')
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Call SalMessageBox(MSG_UnknownSType, MSG_InternalError, MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 8 -  Break
.head 6 +  If dfMfoA != GetBankMfo()
.head 7 -  !
.head 7 -  Call SalDisableWindow(tSendedTitle)
.head 7 -  Call EnableWindow(dfOutFile, FALSE)
.head 7 -  Call EnableWindow(dfOutFileDate, FALSE)
.head 7 -  Call SalDisableWindow(tChekedTitle)
.head 7 -  Call EnableWindow(dfCheckedDate, FALSE)
.head 7 -  !
.head 7 -  Call SqlPrepareAndExecute(TDoc.hSql(), T("
     SELECT fn,dat,datk,dat_2
     FROM   Zag_a z," || strSqlMTblName || " a " || "
     INTO   :dfInFile,:dfInFileDate,:dfInFilePay,:dfInFileReceived
     WHERE  z.fn=a.fn_a and z.dat=a.dat_a and a.ref=:nDocId"))
.head 7 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  !
.head 7 -  Call SalDisableWindow(tReceivedTitle)
.head 7 -  Call SalDisableWindow(tInFilePayTitle)
.head 7 -  Call SalDisableWindow(tInFileReceivedTitle)
.head 7 -  Call EnableWindow(dfInFile, FALSE)
.head 7 -  Call EnableWindow(dfInFileDate, FALSE)
.head 7 -  Call EnableWindow(dfInFilePay, FALSE)
.head 7 -  Call EnableWindow(dfInFileReceived, FALSE)
.head 7 -  !
.head 7 -  Call SqlPrepareAndExecute(TDoc.hSql(), T( "
     SELECT fn,dat,datk
     FROM   Zag_b z," || strSqlMTblName || " a " || "
     INTO   :dfOutFile,:dfOutFileDate,:dfCheckedDate
     WHERE  z.fn=a.fn_b and z.dat=a.dat_b and a.ref=:nDocId"))
.head 7 -  Call SqlFetchNext( TDoc.hSql(), nFetchRes )
.head 5 -  !
.head 5 -  Set nIntRef = nDocId
.head 5 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT swref
   INTO   :nSWRef
   FROM   sw_oper
   WHERE  ref=:nDocId')
.head 6 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 5 -  Call SalSetWindowText(hWndForm, strWinTitle || ', ' || strSqlPKName || ': ' || SalNumberToStrX(nDocId, 0))
.head 4 +  Else
.head 5 +  If SalIsNull(dfInFile)
.head 6 -  Set dfPosted = dfInFileDate
.head 6 -  Call SalClearField(dfInFileDate)
.head 5 +  If SalIsNull(dfOutFile)
.head 6 -  Set dfPosted = dfOutFileDate
.head 6 -  Call SalClearField(dfOutFileDate)
.head 5 -  !
.head 5 +  If not SalIsNull(dfInFile) and not SalIsNull(dfInFileDate)
.head 6 +  If SqlPrepareAndExecute(TDoc.hSql(), T("
   SELECT datk,dat_2
   FROM   Zag_a
   INTO   :dfInFilePay,:dfInFileReceived
   WHERE  fn=:dfInFile and dat=:dfInFileDate"))
.head 7 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 5 +  If not SalIsNull(dfOutFile) and not SalIsNull(dfOutFileDate)
.head 6 +  If SqlPrepareAndExecute(TDoc.hSql(), T("
   SELECT datk
   FROM   Zag_b
   INTO   :dfCheckedDate
   WHERE  fn=:dfOutFile and dat=:dfOutFileDate"))
.head 7 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 5 -  Call SalSetWindowText(hWndForm, strWinTitle || ', ' || strSqlPKName || ': ' || SalNumberToStrX(nDocId, 0) || ' ( Ref: '
     || SalNumberToStrX(nIntRef, 0) || ' )')
.head 4 -  ! KOSHTORIS
.head 4 -  Set nKSCount = 0
.head 4 +  If GetGlobalOption('M_KOST') = '1'
.head 5 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT COUNT(*)
   INTO   :nKSCount
   FROM   KS_DOC_VIEW
   WHERE  REF=:nDocId')
.head 6 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  ! BIS
.head 4 -  Set nBISCount=0
.head 4 +  If SqlPrepareAndExecute(TDoc.hSql(), '
   SELECT bis,rec
   INTO   :nBISCount,:nRecID
   FROM   arc_rrp
   WHERE  bis<=1 and ' || IifS(nDocType=DOC_EXTERNAL or nDocType=DOC_MVD_EXTERNAL, 'REC', 'REF') || '=:nDocId')
.head 5 -  Call SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  !
.head 4 +  If not dfInFile
.head 5 -  ! попробовать высветить имя файла КЛИЕНТ-БАНК
.head 5 -  ! пробуем тэг IDF
.head 5 +  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT value
   INTO   :dfInFile
   FROM   operw
   WHERE  ref=:nDocId and tag='IDF  '") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT pdat
   INTO   :dfInFileDate
   FROM   oper
   WHERE  ref=:nDocId") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  ! пробуем тэг FN_KB
.head 6 +  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT value
   INTO   :dfInFile
   FROM   operw
   WHERE  ref=:nDocId and tag='FN_KB'") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 7 +  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT f_tableexists('KLPV')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If nT = 1
.head 9 -  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT datedokkb
   INTO   :dfInFileDate
   FROM   klpv
   WHERE  ref=:nDocId") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 9 +  Else
.head 10 +  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT f_tableexists('ZAYAVKA')
   INTO   :nT
   FROM   dual") and
   SqlFetchNext(hSql(), nFetchRes)
.head 11 +  If nT = 1
.head 12 -  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT datedokkb
   INTO   :dfInFileDate
   FROM   zayavka
   WHERE  ref=:nDocId") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 7 +  Else
.head 8 -  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT k.naex,k.datedokkb
   INTO   :dfInFile,:dfInFileDate
   FROM   klp k, klpond d
   WHERE  d.ref=:nDocId and d.filename=k.naex and d.pond=k.pond") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  If SqlPrepareAndExecute(TDoc.hSql(), "
   SELECT k.naex,k.datedokkb
   INTO   :dfInFile,:dfInFileDate
   FROM   klp k, klpond d
   WHERE  d.ref=:nDocId and d.filename=k.naex and d.pond=k.pond") and SqlFetchNext(TDoc.hSql(), nFetchRes)
.head 4 -  !
.head 4 -  Call SalSetFocus(hWndForm.frm_ViewDoc.picTabs)
.head 4 -  ! Set bAlign = FALSE
.head 3 +  On SAM_Activate
.head 4 -  Call cDocMenu.Enable(wParam)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 +  If TDoc.IsConnected()
.head 5 -  Call TDoc.Disconnect()
.head 4 -  Call cDocMenu.Kill()
.head 4 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_MenuSelect, 0, 0)
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call cDocMenu.ShowMenu(wParam, lParam)
.head 3 +  On SAM_Help
.head 4 -  ! Call SalLoadApp('WinHlp32.exe', '-w Win1 -i Fi_18 ' || GetHelpFile())
.head 1 +  Dialog Box: dlg_TabViewCheck
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Визы на Документе
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  8.45"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.448"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список виз на документе (Закладка)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblCMarks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.029"
.head 6 -  Top:    0.01"
.head 6 -  Width:  9.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.104"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colAction
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отметка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colGroup
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Группа контроля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUser
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пользователь
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy hhhh:mm:ss
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colActionId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ActionId
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colActionId = 0
.head 7 -  ! 'Ввел документ'
.head 7 -  Set colAction = CurrentLangTable.GetAtomTitle('dlg_TabViewCheck.tblCMarks.cTInputDoc')
.head 7 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkBlue)
.head 6 +  Else If colActionId = 1
.head 7 -  ! 'Визировал'
.head 7 -  Set colAction = CurrentLangTable.GetAtomTitle('dlg_TabViewCheck.tblCMarks.cTVisa')
.head 7 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkRed)
.head 6 +  Else If colActionId = 2
.head 7 -  ! 'Оплатил'
.head 7 -  Set colAction = CurrentLangTable.GetAtomTitle('dlg_TabViewCheck.tblCMarks.cTPay')
.head 7 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkRed)
.head 6 +  Else If colActionId = 3
.head 7 -  ! 'Сторнировал'
.head 7 -  Set colAction = CurrentLangTable.GetAtomTitle('dlg_TabViewCheck.tblCMarks.cTReject')
.head 7 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkRed)
.head 6 +  Else If colActionId = 4
.head 7 -  ! 'Ожидает...'
.head 7 -  Set colAction = CurrentLangTable.GetAtomTitle('dlg_TabViewCheck.tblCMarks.cTWait') || '...'
.head 7 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkGreen)
.head 5 +  On WM_KeyDown
.head 6 +  If wParam=VK_F4
.head 7 +  If GetSignOn() = 0 ! ЭЦП отключена - вернуть Пусто
.head 8 -  Call SalMessageBox( 'ЭЦП отключена!!', 'Сообщение', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  Set nContext = SalTblQueryContext( hWndItem )
.head 7 -  ! Сначала проверка, поставлена ли виза на данную строку ??
.head 7 +  If NOT SqlPrepareAndExecute( hSql(), 
"select nvl(length(rtrim(chk))/6,0) from oper where ref=:nDRef into :nMaxVisaLevel" )
.head 8 -  Call SalMessageBox( 'Не могу получить MAX уровень визы', 'Ошибка', MB_Ok | MB_IconStop )
.head 8 -  Return FALSE
.head 7 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 7 +  If FETCH_Ok != nFetchRes
.head 8 -  Call SalMessageBox( 'Не могу получить MAX уровень визы', 'Ошибка', MB_Ok | MB_IconStop )
.head 8 -  Return FALSE
.head 7 +  If nContext > nMaxVisaLevel
.head 8 -  Call SalMessageBox( 'Данная виза еще не наложена', 'Предупреждение', MB_Ok | MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 -  Call CheckExtraSign( nContext )
.head 6 +  If wParam=VK_F12
.head 7 -  Return CheckSepSign()
.head 2 +  Functions
.head 3 +  Function: CheckExtraSign
.head 4 -  Description: Проверка ЭЦП на док.
+ проверка ЭЦП N-ой визы,
в зависимости от номера выделенной строки
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nContext
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRes
.head 5 -  Window Handle: wnd
.head 4 +  Actions
.head 5 -  Set nRes = 0
.head 5 +  If GetSignOn() = 0 ! ЭЦП отключена - вернуть Пусто
.head 6 -  Call SalMessageBox( 'ЭЦП отключена!!', 'Сообщение', MB_Ok )
.head 6 -  Return 0
.head 5 +  While TRUE
.head 6 +  If NOT m_Doc.SetDocR( nDRef, FALSE )
.head 7 -  Call SalMessageBox( 'Не могу установить экземпляр документа', 
'Ошибка', MB_IconStop | MB_Ok )
.head 7 -  Set nRes = -1
.head 7 -  Break
.head 6 -  ! ! -------------------------------------- MIK
.head 6 +  If GetGlobalOption('INTSIGN')='2'               ! новая внутрення подпись
.head 7 +  If NOT m_Doc.cDocInt(nContext,NUMBER_Null)
.head 8 -  Set nRes = -1
.head 8 -  Break
.head 7 +  Else
.head 8 +  If m_Doc.IsSignExist()
.head 9 -  Call SalMessageBox( 'Внутренняя ЭЦП верна', 'Проверка ЭЦП', MB_Ok )
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Внутренняя ЭЦП отсутствует', 'Проверка ЭЦП', 
MB_Ok|MB_IconExclamation )
.head 6 -  ! ! -------------------------------------- MIK
.head 6 +  Else ! старая внутрення подпись
.head 7 +  If NOT m_Doc.CheckDocSign('LVL', nContext)
.head 8 -  Set nRes = -1
.head 8 -  Break
.head 7 +  Else
.head 8 -  Call SalMessageBox( 'ЭЦП верна', 'Проверка ЭЦП', MB_Ok )
.head 6 -  Break
.head 5 -  Return nRes
.head 3 +  Function: CheckSepSign
.head 4 -  Description: Проверка ЭЦП СЭП
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If GetSignOn() = 0 ! ЭЦП отключена - вернуть Пусто
.head 6 -  Call SalMessageBox( 'ЭЦП отключена!!', 'Сообщение', MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If NOT m_Doc.SetDocR( nDRef, FALSE )
.head 6 -  Call SalMessageBox( 'Не могу установить экземпляр документа', 
'Ошибка', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If NOT m_Doc.CheckDocSign('LVL', 0)
.head 6 -  Call SalMessageBox( 'Ошибка при проверке внешней ЭЦП (СЭП)',
'Ошибка', MB_IconStop | MB_Ok )
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Внешняя ЭЦП верна', 'Проверка внешней ЭЦП', MB_Ok )
.head 6 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  Number: nMaxVisaLevel
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  : CurC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 3 -  Number: nContext
.head 3 -  : m_Doc
.head 4 -  Class: cDoc
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug( 'PAGEM_Initialize event handler: check = '||_check )
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 3
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber(InParam[0])
.head 4 -  Set nDId   = SalStrToNumber(InParam[1])
.head 4 -  Set nDRef  = SalStrToNumber(InParam[2])
.head 4 -  !
.head 4 -  Call XConnectGetParams(TabC)
.head 4 +  If not TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call CurC.Clone(TabC, TRUE)
.head 4 -  !
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(hWndForm.dlg_TabViewCheck.tblCMarks, TabC.hSql(),
"select markid, checkgroup, username, dat
   into :hWndForm.dlg_TabViewCheck.tblCMarks.colActionId, :hWndForm.dlg_TabViewCheck.tblCMarks.colGroup,
        :hWndForm.dlg_TabViewCheck.tblCMarks.colUser, :hWndForm.dlg_TabViewCheck.tblCMarks.colDate
   from v_visalist
  where ref=:nDRef
  order by counter", TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nTabXSize, nTabYSize)
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels(hWndForm, nTabXSize, FALSE) - 4
.head 4 -  Set nTabYSize = SalFormUnitsToPixels(hWndForm, nTabYSize, TRUE) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.dlg_TabViewCheck.tblCMarks,
     SalPixelsToFormUnits(hWndForm, 3, FALSE), SalPixelsToFormUnits(hWndForm, 3, TRUE))
.head 4 -  Call SalSetWindowSize(hWndForm.dlg_TabViewCheck.tblCMarks,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewCheck.tblCMarks, nTabXSize, FALSE),
     SalPixelsToFormUnits(hWndForm.dlg_TabViewCheck.tblCMarks, nTabYSize, TRUE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewCheck.tblCMarks.colAction,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewCheck.tblCMarks.colAction, (nTabXSize)*.14, FALSE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewCheck.tblCMarks.colGroup,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewCheck.tblCMarks.colGroup, (nTabXSize)*.32-15, FALSE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewCheck.tblCMarks.colUser,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewCheck.tblCMarks.colUser, (nTabXSize)*.32-15, FALSE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewCheck.tblCMarks.colDate,
     SalPixelsToFormUnits(hWndForm.dlg_TabViewCheck.tblCMarks.colDate, (nTabXSize)*.21-10, FALSE))
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 4 +  If CurC.IsConnected()
.head 5 -  Call CurC.Disconnect()
.head 1 +  Dialog Box: dlg_TabViewDop
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Дополнительные реквизиты документа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.929"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.438"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список доп.реквизитов документа (Закладка)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblDop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.0"
.head 6 -  Width:  8.757"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реквизит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.443"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.686"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? Yes
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp2 = colValue
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colValue = sTmp2
.head 8 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 6 -  !
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SalStrLength(SalStrTrimX(sTmp))=1
.head 7 -  Set s1ChrList=s1ChrList||SalStrTrimX(sTmp)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  String: strSQL
.head 3 -  String: strDRec
.head 3 -  String: strDRecTag
.head 3 -  String: strDRecVal
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 3 -  String: sTmp        ! tag
.head 3 -  String: sTmp2
.head 3 -  String: s1ChrList   ! 1 char tag list
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize( strPassPar, '', ';', InParam ) < 3
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber( InParam[0] )
.head 4 -  Set nDId   = SalStrToNumber( InParam[1] )
.head 4 -  Set nDRef  = SalStrToNumber( InParam[2] )
.head 4 +  If nDRef
.head 5 -  Set strSQL = T('
SELECT f.name
     , o.value, o.tag
INTO :tblDop.colTag
   , :tblDop.colValue, :sTmp
FROM operw o
   , op_field f
WHERE  o.ref = :nDRef
  AND  o.tag = f.tag
')
.head 4 -  Call XConnectGetParams( TabC )
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 +  If nDRef
.head 5 -  Call SalTblPopulate( hWndForm.dlg_TabViewDop.tblDop, TabC.hSql(), strSQL, TBL_FillAll )
.head 4 -  ! разбираем строку дополнительных реквизитов
.head 4 +  If nDType=DOC_ARCHIVE
.head 5 -  Set strSQL = T('SELECT drec  INTO :strDRec FROM '||FunMakeFullTableName( tbl_ListDocs.strDbLinkN, tbl_ListDocs.strDocTabN )||' WHERE ref = :nDId')
.head 4 +  Else If nDType = DOC_EXTERNAL OR nDType = DOC_MVD_EXTERNAL
.head 5 -  Set strSQL = T('SELECT d_rec INTO :strDRec FROM arc_rrp WHERE rec = :nDId')
.head 4 +  Else
.head 5 -  Set strSQL = T('SELECT d_rec INTO :strDRec FROM oper    WHERE ref = :nDRef')
.head 4 +  If SqlPrepareAndExecute(  TabC.hSql(), strSQL )
.head 5 -  Call SqlFetchNext( TabC.hSql(), nFetchRes )
.head 5 -  ! Call Debug(Str(nDRef)||' '||strDRec)
.head 5 +  If strDRec
.head 6 +  If nDType = DOC_ARCHIVE
.head 7 +  While strDRec
.head 8 -  Set strDRec    = SalStrRightX( strDRec, SalStrLength( strDRec )-1 )
.head 8 -  Set strDRecTag = SalStrLeftX( strDRec, SalStrScan( strDRec, '>'))
.head 8 -  Set strDRec    = SalStrRightX( strDRec, SalStrLength( strDRec )-SalStrLength( strDRecTag )-1 )
.head 8 -  Set strDRecVal = SalStrLeftX( strDRec, SalStrScan( strDRec, '<') )
.head 8 -  Set strDRec    = SalStrMidX( strDRec, SalStrScan( strDRec, '>')+1, SalStrLength( strDRec ) )
.head 8 -  Call SqlPrepareAndExecute(  TabC.hSql(),'SELECT name INTO :strDRecTag FROM op_field WHERE tag=:strDRecTag' )
.head 8 +  If not SqlFetchNext( TabC.hSql(), nFetchRes )
.head 9 -  Set strDRecTag='Допоміжний реквізит '||strDRecTag
.head 8 -  Set nRow = SalTblInsertRow( hWndForm.dlg_TabViewDop.tblDop, TBL_MaxRow )
.head 8 +  If nRow != TBL_Error
.head 9 -  Call SalTblSetContext( hWndForm.dlg_TabViewDop.tblDop, nRow )
.head 9 -  Call SalTblSetRowFlags( hWndForm.dlg_TabViewDop.tblDop, nRow, ROW_New, FALSE )
.head 9 -  Set hWndForm.dlg_TabViewDop.tblDop.colTag   = strDRecTag
.head 9 -  Set hWndForm.dlg_TabViewDop.tblDop.colValue = strDRecVal
.head 6 +  Else
.head 7 -  Set strDRec = SalStrRightX( strDRec, SalStrLength( strDRec )-1 )
.head 7 +  While strDRec
.head 8 -  Set strDRecTag = SalStrLeftX( strDRec, 1)
.head 8 -  Set strDRec    = SalStrMidX( strDRec, 1, SalStrLength( strDRec )-1 )
.head 8 -  Set strDRecVal = SalStrLeftX( strDRec, SalStrScan( strDRec, '#') )
.head 8 -  Set strDRec    = SalStrMidX( strDRec, SalStrScan( strDRec, '#')+1, SalStrLength( strDRec ) )
.head 8 +  If SalStrScan( s1ChrList, strDRecTag)<0  ! не было в operw -> добавляем в таблицу
.head 9 -  !
.head 9 -  Call SqlPrepareAndExecute(  TabC.hSql(),'SELECT name INTO :strDRecTag FROM op_field WHERE tag=:strDRecTag' )
.head 9 +  If not SqlFetchNext( TabC.hSql(), nFetchRes )
.head 10 -  Set strDRecTag='Допоміжний реквізит СЕП '||strDRecTag
.head 9 -  Set nRow = SalTblInsertRow( hWndForm.dlg_TabViewDop.tblDop, TBL_MaxRow )
.head 9 +  If nRow != TBL_Error
.head 10 -  Call SalTblSetContext( hWndForm.dlg_TabViewDop.tblDop, nRow )
.head 10 -  Call SalTblSetRowFlags( hWndForm.dlg_TabViewDop.tblDop, nRow, ROW_New, FALSE )
.head 10 -  Set hWndForm.dlg_TabViewDop.tblDop.colTag   = strDRecTag
.head 10 -  Set hWndForm.dlg_TabViewDop.tblDop.colValue = strDRecVal
.head 4 +  ! If frm_ViewDoc.cbAlign
.head 5 -  Call VisTblAutoSizeColumn(dlg_TabViewDop.tblDop, hWndNULL)
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nTabXSize, nTabYSize)
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels(hWndForm, nTabXSize, FALSE) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels(hWndForm, nTabYSize, TRUE ) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.dlg_TabViewDop.tblDop, 
	SalPixelsToFormUnits(hWndForm, 3, FALSE), 
	SalPixelsToFormUnits(hWndForm, 3, TRUE ))
.head 4 -  Call SalSetWindowSize(hWndForm.dlg_TabViewDop.tblDop, 
	SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop, nTabXSize, FALSE), 
	SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop, nTabYSize, TRUE ))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewDop.tblDop.colTag, 
	SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop.colTag, (nTabXSize)/3, FALSE))
.head 4 -  Call SalTblSetColumnWidth(hWndForm.dlg_TabViewDop.tblDop.colValue, 
	SalPixelsToFormUnits(hWndForm.dlg_TabViewDop.tblDop.colValue, (nTabXSize)*2/3-45, FALSE))
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 1 +  Dialog Box: dlg_TabViewModel
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Дополнительные реквизиты документа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.167"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.438"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Бухгалтерская модель документа (Закладка)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblModel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.029"
.head 6 -  Top:    0.021"
.head 6 -  Width:  13.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colTema
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Z
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: РЕФ
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SqlPrepareAndExecute( hSql(), 'SELECT ref INTO :nTmp FROM oper WHERE ref=:colRef' )
.head 8 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalMessageBox( 'Не знайдено РЕФ '||Str(colRef), 'Увага', MB_IconHand )
.head 9 -  Set colRef=nDRef
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
оплаты
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colNLS
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colNLS = sTmp
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ДЕБЕТ

.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ДЕБЕТ

.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КРЕДИТ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumKs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КРЕДИТ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumDQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ДЕБЕТ
экв.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumKQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КРЕДИТ
экв.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подробности платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SOS
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: DK
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDig
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: dig
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colStmt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: #
проводки
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTmp
.head 5 -  Number: nRow
.head 5 -  Boolean: bHnH
.head 5 -  Window Handle: hWndParent
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 7 -  Call SalTblSetColumnFlags( colNLS, COL_RightJustify, TRUE )
.head 6 -  Call SalTblSetLockedColumns( hWndItem, 5 )
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 6 -  !
.head 5 +  On SAM_FetchRowDone
.head 6 -  ! проверка на 3 знака
.head 6 -  Set colSumDs=Dig4( colSumD, colDig, nMaxDig )
.head 6 -  Set colSumKs=Dig4( colSumK, colDig, nMaxDig )
.head 6 -  !
.head 6 -  Set colRef=nDRef
.head 6 -  !
.head 6 +  If colSumD=0
.head 7 -  Set colSumD=NUMBER_Null
.head 7 -  Set colSumDs=''
.head 6 +  If colSumK=0
.head 7 -  Set colSumK=NUMBER_Null
.head 7 -  Set colSumKs=''
.head 6 +  If colSumDQ=0
.head 7 -  Set colSumDQ=NUMBER_Null
.head 6 +  If colSumKQ=0
.head 7 -  Set colSumKQ=NUMBER_Null
.head 6 +  If colSOS < 5
.head 7 +  Select Case colSOS
.head 8 +  Case DOC_PAY_STORNO
.head 9 -  Call SetTblRowColor( hWndForm, COLOR_Red )
.head 9 -  Break
.head 8 +  Case DOC_PAY_BOOKED
.head 9 -  Call SetTblRowColor( hWndForm, COLOR_DarkGreen )
.head 9 -  Break
.head 8 +  Case DOC_PAY_FEATURE
.head 9 -  Call SetTblRowColor( hWndForm, COLOR_Blue )
.head 9 -  Break
.head 8 +  Default
.head 9 -  Call SetTblRowColor( hWndForm, COLOR_Purple )
.head 9 -  Break
.head 6 +  If gl_OB22 = '1' and colSumD >0
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(),
"select ZVT_F(a.nbs,ak.NBS,a.branch,ak.branch,o.tt,p.MFOA,p.MFOB,p.TT)
 into :colTema  
 from opldok o, accounts a, oper p,  opldok ok, accounts ak  
 where o.ref = p.REF  and o.acc=a.acc  and o.dk=0   
   and o.ref = ok.ref and ok.dk=1  and ok.acc=ak.acc and o.stmt =ok.stmt 
   and o.ref =:nDRef  and o.stmt=:colStmt " )
and SqlFetchNext( hSqlAux2(), nFetchRes)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam=119  ! F8 ---------------------
.head 7 -  Set bHnH=not bHnH
.head 7 +  If bHnH
.head 8 -  Call SalShowWindow( colRef )
.head 8 -  Call SalEnableWindow ( colRef )
.head 7 +  Else
.head 8 -  Call SalHideWindow( colRef )
.head 8 -  Call SalDisableWindow ( colRef )
.head 6 +  Else If wParam=113  ! F2 --------------------- 
.head 7 -  Call SalSendMsg( hWndForm, UM_ObjActivate, 0, 0 )
.head 5 +  On UM_ObjActivate
.head 6 +  If GetUserMark() >= GetGlobalOptionEx( 'MARKBACK' )
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  If SalTblFindNextRow ( hWndForm, nRow, ROW_Edited, 0 )
.head 8 +  If MessageQuestion( 'Перенести операцію '||colTT||' з РЕФ ' ||Str(nDRef)|| ' на РЕФ ' || Str(colRef) || ' ?') = IDYES
.head 9 +  If SqlPrepareAndExecute( hSql(),'update opldok set ref=:colRef WHERE ref=:nDRef AND stmt=:tblModel.colStmt' )
.head 10 -  Call SqlCommit( hSql() )
.head 10 -  Call MessageInfo( 'Успішно ПЕРЕНЕСЛИ  '||colTT||' з РЕФ ' ||Str(nDRef)|| ' на РЕФ ' || Str(colRef) )
.head 10 -  Call SaveFInfoToLog( 'Виконали перенос операції '||colTT||' з РЕФ ' ||Str(nDRef)|| ' на РЕФ ' || Str(colRef) )
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 7 -  Call SalSendMsg( SalParentWindow( hWndForm ), UM_Populate, 0, 0 )
.head 6 +  Else
.head 7 -  Call MessageError( 'Для операції перенесення у Вас недостатньо прав. Зверніться до Адміністратора АБС.' )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  String: strSQL
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 3 -  !
.head 3 -  Number: nMaxDig
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize( strPassPar, '', ';', InParam ) < 3
.head 5 -  Return FALSE
.head 4 -  ! Call Debug(strPassPar)
.head 4 -  Set nDType = SalStrToNumber( InParam[0] )
.head 4 -  Set nDId   = SalStrToNumber( InParam[1] )
.head 4 -  Set nDRef  = SalStrToNumber( InParam[2] )
.head 4 -  !
.head 4 -  Call XConnectGetParams( TabC )
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  ! Показывать или не показывать эквиваленты по валюте
.head 4 +  If SqlPrepareAndExecute( hSqlAux(),
  "SELECT val FROM params WHERE par='EQV' and val='YES' ") and SqlFetchNext( hSqlAux(), nFetchRes ) 
.head 5 -  Call SalShowWindow( tblModel.colSumDQ )
.head 5 -  Call SalShowWindow( tblModel.colSumKQ )
.head 4 +  If nDType=DOC_ARCHIVE
.head 5 -  Set strSQL = "
 SELECT o.fdat,o.tt,o.nlsa,t.lcv,o.s/100,0,
       (SELECT nms FROM "||FunMakeFullTableName( tbl_ListDocs.strDbLinkN, tbl_ListDocs.strAccTabN )||" WHERE nls=o.nlsa AND kv=o.kv AND daos>=o.fdat) nms,
        'o.txt',5,0,t.dig,o.sq/100,0, 0, o.kv
   FROM "||FunMakeFullTableName( tbl_ListDocs.strDbLinkN, tbl_ListDocs.strTrnTabN )||" o, tabval t
  WHERE o.ref=:nDId AND o.kv=t.kv 
 UNION ALL
 SELECT o.fdat,o.tt,o.nlsb,t.lcv,0,o.s/100,
       (SELECT nms FROM "||FunMakeFullTableName( tbl_ListDocs.strDbLinkN, tbl_ListDocs.strAccTabN )||" WHERE nls=o.nlsb AND kv=o.kv AND daos>=o.fdat) nms,
       'o.txt',5,0,t.dig,0,o.sq/100, 0, o.kv
   FROM "||FunMakeFullTableName( tbl_ListDocs.strDbLinkN, tbl_ListDocs.strTrnTabN )||" o, tabval t 
  WHERE o.ref=:nDId AND o.kv=t.kv
  ORDER BY fdat,lcv,tt 
  INTO :tblModel.colDAT, :tblModel.colTT,   :tblModel.colNLS,
       :tblModel.colKV,  :tblModel.colSumD, :tblModel.colSumK, :tblModel.colNMS, 
       :tblModel.colNAZN,:tblModel.colSOS,  :tblModel.colDK,   :tblModel.colDig, 
       :tblModel.colSumDQ, :tblModel.colSumKQ,:tblModel.colStmt,:nTmp "
.head 4 +  Else
.head 5 -  Set strSQL = "
 SELECT o.fdat, o.tt, a.nls, a.kv, decode(o.dk,0,o.s/100,0),
	decode(o.dk,0,0,o.s/100), a.nms, o.txt, o.sos, o.dk, t.dig,  
        decode(o.dk,0,o.sq/100,0), decode(o.dk,0,0,o.sq/100), o.stmt
 INTO :tblModel.colDAT, :tblModel.colTT,   :tblModel.colNLS,
      :tblModel.colKV,  :tblModel.colSumD, :tblModel.colSumK, :tblModel.colNMS, 
      :tblModel.colNAZN,:tblModel.colSOS,  :tblModel.colDK,   :tblModel.colDig, 
      :tblModel.colSumDQ, :tblModel.colSumKQ,:tblModel.colStmt
  FROM opldok o, accounts a, tabval t 
 WHERE ref=:nDRef AND o.acc=a.acc AND a.kv=t.kv 
 ORDER BY o.fdat,a.kv,o.stmt,o.tt,o.dk "
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig=DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig = 4
.head 4 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +  ! If frm_ViewDoc.cbAlign
.head 5 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, hWndNULL)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nTabXSize, nTabYSize )
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels( hWndForm, nTabXSize, FALSE ) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels( hWndForm, nTabYSize, TRUE ) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc( hWndForm.dlg_TabViewModel.tblModel, 
	SalPixelsToFormUnits( hWndForm, 3, FALSE ), 
	SalPixelsToFormUnits( hWndForm, 3, TRUE ) )
.head 4 -  Call SalSetWindowSize( hWndForm.dlg_TabViewModel.tblModel, 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewModel.tblModel, nTabXSize, FALSE ), 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewModel.tblModel, nTabYSize, TRUE ) )
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If gl_OB22 = STRING_Null
.head 5 -  Set gl_OB22 = GetGlobalOption('OB22')
.head 5 +  If gl_OB22 != '1'
.head 6 -  Set gl_OB22 = '0'
.head 4 +  If gl_OB22 = '0'
.head 5 -  Call SalHideWindow( tblModel.colTema )
.head 4 -  Call SalTblPopulate(hWndForm.dlg_TabViewModel.tblModel, TabC.hSql(), strSQL, TBL_FillAll)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colNLS)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colSumDs)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colSumKs)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colSumDQ)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colSumKQ)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colNMS)
.head 4 -  Call VisTblAutoSizeColumn(dlg_TabViewModel.tblModel, dlg_TabViewModel.tblModel.colNAZN)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Dialog Box: dlg_TabWievSWIFT
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: S.W.I.F.T. Сообщение
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.229"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.719"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: S.W.I.F.T. сообщение
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlSWIFT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  7.129"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.406"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New Cyr
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On UM_NoFontChange
.head 6 -  Return TRUE
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  : TabH
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Number: nSWId
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize( strPassPar, '', ';', InParam ) < 3
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber( InParam[0] )
.head 4 -  Set nDId   = SalStrToNumber( InParam[1] )
.head 4 -  Set nDRef  = SalStrToNumber( InParam[2] )
.head 4 -  !
.head 4 -  Call XConnectGetParams(TabC)
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call TabH.Clone(TabC, TRUE)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SqlPrepareAndExecute(TabC.hSql(), 
"SELECT o.swref INTO :nSWId FROM sw_oper o WHERE o.ref=:nDRef ORDER BY o.swref")
.head 4 +  While SqlFetchNext(TabC.hSql(), nFetchRes)
.head 5 -  Set mlSWIFT = mlSWIFT || Sw_MtAsTextEx(TabH.hSql(), nSWId, nDRef) || PutCrLf()
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nTabXSize, nTabYSize )
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels( hWndForm, nTabXSize, FALSE ) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels( hWndForm, nTabYSize, TRUE ) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc( hWndForm.dlg_TabWievSWIFT.mlSWIFT, 
	SalPixelsToFormUnits( hWndForm, 3, FALSE ), 
	SalPixelsToFormUnits( hWndForm, 3, TRUE ) )
.head 4 -  Call SalSetWindowSize( hWndForm.dlg_TabWievSWIFT.mlSWIFT, 
	SalPixelsToFormUnits( hWndForm.dlg_TabWievSWIFT.mlSWIFT, nTabXSize, FALSE ), 
	SalPixelsToFormUnits( hWndForm.dlg_TabWievSWIFT.mlSWIFT, nTabYSize, TRUE ) )
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 4 +  If TabH.IsConnected()
.head 5 -  Call TabH.Disconnect()
.head 1 +  Dialog Box: dlg_TabViewKS
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: КОШТОРИС
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    1.729"
.head 4 -  Width:  12.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.167"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Свойства документа КОШТОРИСА (Закладка)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblProvs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  11.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colREF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: dig
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: dig
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Стан
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах- А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.571"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах - Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.571"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума экв.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подробиці
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_RowSetContext
.head 6 -  Call PopulateFileInfo()
.head 3 +  Child Table: tblIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    1.155"
.head 6 -  Width:  11.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.786"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colREF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: dig
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTMT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: dig
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ДК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPFM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ПФМ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ФП
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMVZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МВЗ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ВЗ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNDR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НДР
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colERR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Помилка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Data Field: tKS
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.095"
.head 6 -  Width:  9.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Courier New
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tToKSTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    2.429"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tToKontrTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    2.679"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tReadyR3Title
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    2.929"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tSentTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    3.179"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: tQuitTitle
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 7461625374616D70 730000
.enddata
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    3.429"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfToKS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    2.405"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfToKontr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    2.655"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfReadyR3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    2.905"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSentInFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    3.155"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSentInFileDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.483"
.head 6 -  Top:    3.155"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfQuit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    3.405"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Localize
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set tToKSTitle='Передано в кошторис:'
.head 5 -  Set tToKontrTitle='Передано в контролеру:'
.head 5 -  Set tReadyR3Title='Підготовлен до передачі в R3:'
.head 5 -  Set tSentTitle='Передано R3 в файлі:'
.head 5 -  Set tQuitTitle='Сквитовано:'
.head 5 -  Set tKS='Технічна інформація для вибраної проводки'
.head 3 +  Function: PopulateFileInfo
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If tblProvs.colSTMT!=nStmt
.head 6 -  ! Населяю таблицу
.head 6 -  Call SalTblReset( dlg_TabViewKS.tblIS )
.head 6 -  Call SalTblPopulate( tblIS, TabC.hSql(), 
"
SELECT 
  REF,  STMT,  DK,  PFM,  FP,  MVZ,  VZ,  NDR,  SI,  ERRMSG
INTO
  :tblIS.colREF, :tblIS.colSTMT, :tblIS.colDK, :tblIS.colPFM, :tblIS.colFP, 
  :tblIS.colMVZ, :tblIS.colVZ, :tblIS.colNDR, :tblIS.colSI, :tblIS.colERR
FROM KS_IS_VIEW 
WHERE  REF=:tblProvs.colREF AND STMT=:tblProvs.colSTMT 
ORDER BY SORT_ORDER, STMT,DK,SI"
, TBL_FillAll )
.head 6 -  ! + Данные о файлах и датах
.head 6 +  If SqlPrepareAndExecute( TabC.hSql(), "
SELECT
  TO_CHAR( DATE_IN, 'dd/mm/yyyy hh24:mi:ss' ), 
  TO_CHAR( DATE_CONTR, 'dd/mm/yyyy hh24:mi:ss' ), 
  TO_CHAR( DATE_R3, 'dd/mm/yyyy hh24:mi:ss' ), 
  F_N, 
  TO_CHAR( FN_S_DATE, 'dd/mm/yyyy hh24:mi:ss' ), 
  TO_CHAR( FN_R_DATE, 'dd/mm/yyyy hh24:mi:ss' ) 
INTO :dfToKS, :dfToKontr, :dfReadyR3, :dfSentInFile, :dfSentInFileDate, :dfQuit 
FROM KS_DOC_VIEW 
WHERE REF=:tblProvs.colREF AND STMT=:tblProvs.colSTMT" )
.head 7 -  Call SqlFetchNext( TabC.hSql(), nFetchRes )
.head 7 +  If tblProvs.colSTATE!=90
.head 8 -  Set dfQuit=''
.head 6 -  Set nStmt=tblProvs.colSTMT
.head 6 +  If tblProvs.colSTATE=100
.head 7 -  Set tReadyR3Title='Остаточно знят з обробки:'
.head 6 +  Else
.head 7 -  Set tReadyR3Title='Підготовлен до передачі в R3:'
.head 3 +  Function: GetColumnCaptionProc
.head 4 -  Description: Получить наименование колонки из KS_META_NAMES
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: strColID
.head 5 -  Receive String: strColTitle
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 +  If strColID='PFM'
.head 7 -  Set strColTitle='ПФМ'
.head 6 +  Else If strColID='FP'
.head 7 -  Set strColTitle='ФП'
.head 6 +  Else If strColID='MVZ'
.head 7 -  Set strColTitle='МВЗ'
.head 6 +  Else If strColID='VZ'
.head 7 -  Set strColTitle='ВЗ'
.head 6 +  Else If strColID='NDR'
.head 7 -  Set strColTitle='№ док.рез.'
.head 6 +  Else
.head 7 -  Set strColTitle=''
.head 6 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute( TabC.hSql(), 'SELECT NAME_BRIFF INTO :strColTitle FROM KS_META_NAMES WHERE ID=:strColID' )
.head 6 +  If NOT SqlFetchNext( TabC.hSql(), nFetchRes )
.head 7 -  Set Result=''
.head 3 +  Function: GetColumnCaption
.head 4 -  Description: Получить наименование колонки из KS_META_NAMES
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strColID
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 4 +  Actions
.head 5 -  Call GetColumnCaptionProc(strColID, Result)
.head 5 -  Return Result
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 3 -  Number: nObjectX
.head 3 -  Number: nObjectY
.head 3 -  Number: nTableMargin
.head 3 -  !
.head 3 -  Number: nCount
.head 3 -  !
.head 3 -  Number: nStmt
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  ! Проверка наличия модуля КОШТОРИС
.head 4 +  If NOT GetGlobalOption( 'M_KOST' ) = '1'
.head 5 -  Return FALSE
.head 4 -  ! Получаю референс
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize( strPassPar, '', ';', InParam ) < 3
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber( InParam[0] )
.head 4 -  Set nDId   = SalStrToNumber( InParam[1] )
.head 4 -  Set nDRef  = SalStrToNumber( InParam[2] )
.head 4 -  ! Соед.
.head 4 -  Call XConnectGetParams( TabC )
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  ! Проверяю наличие информации
.head 4 +  If SqlPrepareAndExecute( TabC.hSql(), '
SELECT COUNT(*) INTO :nCount FROM KS_DOC_VIEW 
WHERE  REF=:nDRef ' )
.head 5 +  If SqlFetchNext( TabC.hSql(), nFetchRes )
.head 6 +  If nCount=0
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Return FALSE
.head 4 +  Else
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  ! Локализация
.head 4 -  Call Localize()
.head 4 -  ! Названия колонок
.head 4 -  Call SalTblSetColumnTitle( tblIS.colPFM, GetColumnCaption('PFM') )
.head 4 -  Call SalTblSetColumnTitle( tblIS.colFP, GetColumnCaption('FP') )
.head 4 -  Call SalTblSetColumnTitle( tblIS.colMVZ, GetColumnCaption('MVZ') )
.head 4 -  Call SalTblSetColumnTitle( tblIS.colVZ, GetColumnCaption('VZ') )
.head 4 -  Call SalTblSetColumnTitle( tblIS.colNDR, GetColumnCaption('NDR') )
.head 4 -  ! Население проводок
.head 4 -  Call SalTblPopulate( tblProvs, TabC.hSql(), 
"
SELECT 
  REF,STMT,FDAT,TT,STATE,NLSA,KVA,NLSB,S/100,NAZN 
INTO
  :tblProvs.colREF,:tblProvs.colSTMT,:tblProvs.colDAT, :tblProvs.colTT,:tblProvs.colSTATE, 
  :tblProvs.colNLSD,:tblProvs.colKV,  :tblProvs.colNLSK,:tblProvs.colS, :tblProvs.colNAZN 
FROM KS_ALL_DOCS_AUX 
WHERE  REF=:nDRef 
ORDER BY STMT"
, TBL_FillAll )
.head 4 -  Call SalTblSetContext( tblProvs, 0 )
.head 4 -  Call SalTblSetRowFlags( tblProvs, 0, ROW_Selected, TRUE )
.head 4 -  Call SalSendMsg( tblProvs, SAM_RowSetContext, 0, 0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nTabXSize, nTabYSize )
.head 4 -  ! Размер формы
.head 4 -  Set nTabXSize = SalFormUnitsToPixels( hWndForm, nTabXSize, FALSE ) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels( hWndForm, nTabYSize - 1.8, TRUE )
.head 4 -  ! Зазмер и положение таблицы проводок
.head 4 -  Call SalSetWindowLoc( hWndForm.dlg_TabViewKS.tblProvs, 
	SalPixelsToFormUnits( hWndForm, 3, FALSE ), 
	SalPixelsToFormUnits( hWndForm, 3, TRUE ) )
.head 4 -  Call SalSetWindowSize( hWndForm.dlg_TabViewKS.tblProvs, 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewKS.tblProvs, nTabXSize, FALSE ), 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewKS.tblProvs, nTabYSize/2, TRUE ) )
.head 4 -  ! Зазмер и положение таблицы ИС
.head 4 -  Call SalSetWindowLoc( hWndForm.dlg_TabViewKS.tblIS, 
	SalPixelsToFormUnits( hWndForm, 3, FALSE ), 
	SalPixelsToFormUnits( hWndForm, nTabYSize/2, TRUE ) )
.head 4 -  Call SalSetWindowSize( hWndForm.dlg_TabViewKS.tblIS, 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewKS.tblIS, nTabXSize, FALSE ), 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewKS.tblIS, nTabYSize/2, TRUE ) )
.head 4 -  Set nTableMargin = SalPixelsToFormUnits( hWndForm, 3, TRUE ) +
                    SalPixelsToFormUnits( hWndForm.dlg_TabViewKS.tblIS, nTabYSize, TRUE )
.head 4 -  ! Положение других 
.head 4 -  Call SalGetWindowLoc( tKS, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( tKS, nObjectX, nTableMargin + 0.119 )
.head 4 -  !
.head 4 -  Call SalGetWindowLoc( tToKSTitle, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( tToKSTitle, nObjectX, nTableMargin + 0.429 )
.head 4 -  Call SalGetWindowLoc( dfToKS, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( dfToKS, nObjectX, nTableMargin + 0.429 )
.head 4 -  !
.head 4 -  Call SalGetWindowLoc( tToKontrTitle, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( tToKontrTitle, nObjectX, nTableMargin + 0.679 )
.head 4 -  Call SalGetWindowLoc( dfToKontr, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( dfToKontr, nObjectX, nTableMargin + 0.679 )
.head 4 -  !
.head 4 -  Call SalGetWindowLoc( tReadyR3Title, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( tReadyR3Title, nObjectX, nTableMargin + 0.929 )
.head 4 -  Call SalGetWindowLoc( dfReadyR3, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( dfReadyR3, nObjectX, nTableMargin + 0.929 )
.head 4 -  !
.head 4 -  Call SalGetWindowLoc( tSentTitle, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( tSentTitle, nObjectX, nTableMargin + 1.179 )
.head 4 -  Call SalGetWindowLoc( dfSentInFile, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( dfSentInFile, nObjectX, nTableMargin + 1.179 )
.head 4 -  Call SalGetWindowLoc( dfSentInFileDate, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( dfSentInFileDate, nObjectX, nTableMargin + 1.179 )
.head 4 -  !
.head 4 -  Call SalGetWindowLoc( tQuitTitle, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( tQuitTitle, nObjectX, nTableMargin + 1.429 )
.head 4 -  Call SalGetWindowLoc( dfQuit, nObjectX, nObjectY )
.head 4 -  Call SalSetWindowLoc( dfQuit, nObjectX, nTableMargin + 1.429 )
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 1 +  Dialog Box: dlg_TabViewBIS
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: БИСы
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.929"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.438"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список БИСов
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.0"
.head 6 -  Width:  8.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 240
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -   Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 6 -  !
.head 5 +  On SAM_FetchRowDone
.head 6 +  ! If SalStrLength(SalStrTrimX(sTmp))=1
.head 7 -   Set s1ChrList=s1ChrList||SalStrTrimX(sTmp)
.head 6 -  If GetGlobalOptionEx('SEPNUM')=2
.head 6 +  Else
.head 7 -  Set colNazn = StrDosToWinX(colNazn)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: InParam[5]
.head 3 -  Number: nDType
.head 3 -  Number: nDId
.head 3 -  Number: nDRef
.head 3 -  Number: nDRec
.head 3 -  String: strPassPar
.head 3 -  !
.head 3 -  : TabC
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  String: strSQL
.head 3 -  !
.head 3 -  Number: nTabXSize
.head 3 -  Number: nTabYSize
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize( strPassPar, '', ';', InParam ) < 4
.head 5 -  Return FALSE
.head 4 -  Set nDType = SalStrToNumber( InParam[0] )
.head 4 -  Set nDId   = SalStrToNumber( InParam[1] )
.head 4 -  Set nDRef  = SalStrToNumber( InParam[2] )
.head 4 -  Set nDRec  = SalStrToNumber( InParam[3] )
.head 4 -  Call XConnectGetParams( TabC )
.head 4 +  If NOT TabC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  !
.head 4 -  ! anny - 26-04-2007 неправильно отображались бисы
.head 4 -  Set strSQL = T(
"SELECT b.nazn||decode(b.nazns,33,b.d_rec,'')
 INTO :tblBIS.colNazn 
 FROM arc_rrp a, arc_rrp b 
 WHERE a.rec=:nDRec 
       and (b.ref = a.ref or (a.fn_a = b.fn_a  and (a.rec_a-a.bis) = (b.rec_a-b.bis) )   ) 
       and a.bis=1 
       and (   a.fn_a is not null AND a.fn_a=b.fn_a AND a.dat_a=b.dat_a 
             OR a.fn_a is null AND a.dat_a=b.dat_a 
             OR a.fn_a is null AND a.dat_a is null AND a.fn_b=b.fn_b AND a.dat_b=b.dat_b
           )
       and a.rec<>b.rec AND a.bis<b.bis AND b.bis>0 
 ORDER BY b.bis")
.head 4 -  ! Call DebugN(nDRec)
.head 4 -  Call SalTblPopulate( hWndForm.dlg_TabViewBIS.tblBIS, TabC.hSql(), strSQL, TBL_FillAll )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nTabXSize, nTabYSize )
.head 4 -  !
.head 4 -  Set nTabXSize = SalFormUnitsToPixels( hWndForm, nTabXSize, FALSE ) - 6
.head 4 -  Set nTabYSize = SalFormUnitsToPixels( hWndForm, nTabYSize, TRUE ) - 6
.head 4 -  !
.head 4 -  Call SalSetWindowLoc( hWndForm.dlg_TabViewBIS.tblBIS, 
	SalPixelsToFormUnits( hWndForm, 3, FALSE ), 
	SalPixelsToFormUnits( hWndForm, 3, TRUE ) )
.head 4 -  Call SalSetWindowSize( hWndForm.dlg_TabViewBIS.tblBIS, 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewBIS.tblBIS, nTabXSize, FALSE ), 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewBIS.tblBIS, nTabYSize, TRUE ) )
.head 4 -  Call SalTblSetColumnWidth( hWndForm.dlg_TabViewBIS.tblBIS.colNazn, 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewBIS.tblBIS.colNazn, nTabXSize-40, FALSE ) )
.head 4 -  ! Call SalTblSetColumnWidth( hWndForm.dlg_TabViewDop.tblDop.colValue, 
	SalPixelsToFormUnits( hWndForm.dlg_TabViewDop.tblDop.colValue, (nTabXSize)*2/3-40, FALSE ) )
.head 3 +  On SAM_Destroy
.head 4 +  If TabC.IsConnected()
.head 5 -  Call TabC.Disconnect()
.head 1 -  !
.head 1 +  Form Window: tbl_CheckingDocs
.head 2 -  Class: cGenericTableFrm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Состояние документов по ПРОЦЕССИНГУ платежей в/из  СЭП  НБУ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.393"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 52147
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 52148
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 24
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 52149
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblSos
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableFrm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  6.017"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.869"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: nn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: tt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.686"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Состояние
документов
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: kol
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество
документов
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.189"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: su
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
документов(коп)
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.878"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nNn
.head 5 -  Number: nCount
.head 5 -  Number: nSum
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT nn, count(*), sum(s) 
 INTO :nNn, :nCount, :nSum 
 FROM v_procaccdoc " || IifS(sFilter='', "", "WHERE " || sFilter) || "
 GROUP BY nn")
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If nn = nNn
.head 9 -  Set kol = nCount
.head 9 -  Set su  = nSum
.head 9 -  Break
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 6 -  Call SalSetFocus(hWndForm)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If kol=0
.head 7 -  Set kol = NUMBER_Null
.head 7 -  Set su  = NUMBER_Null
.head 5 +  On SAM_DoubleClick
.head 6 +  If kol != NUMBER_Null
.head 7 +  If nCurrentNn = 7
.head 8 -  Set bLetBlk = TRUE
.head 7 -  Call DocViewList(hWndMDI, "(a.rec in (select rec from v_procaccdoc where nn=" || Str(nCurrentNn) || 
  IifS(sFilter="", "", " AND (" || sFilter || ")") || "))", 
  sCurrentName || ' на ' || SalFmtFormatDateTime(GetBankDate(),ddMMyyyy()))
.head 5 +  On SAM_RowSetContext
.head 6 +  If kol = NUMBER_Null
.head 7 -  Call SalDisableWindow(pbDetails)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(pbDetails)
.head 6 -  Set nCurrentNn = nn
.head 6 -  Set sCurrentName = name
.head 6 +  If bMV_VPS
.head 7 -  Call SalSendMsg(tblKv, UM_Populate, 0, 0)
.head 3 +  Child Table: tblKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.45"
.head 6 -  Top:    0.06"
.head 6 -  Width:  5.65"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.619"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCount
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Количество
документов
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
документов(коп)
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nCount
.head 5 -  Number: nEqv
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nCount = 0
.head 6 -  Set nEqv = 0
.head 6 -  Call SalTblPopulate(hWndForm, hSqlAux(), 
"SELECT kv, count(*), sum(s) 
 INTO :hWndForm.tblKv.colKv, :hWndForm.tblKv.colCount, :hWndForm.tblKv.colSum  
 FROM v_procaccdoc
 WHERE nn=:nCurrentNn " || IifS(sFilter='', "", "AND (" || sFilter || ")") || "
 GROUP BY kv
 ORDER BY kv", TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 6 +  If nCount > 0
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, nRow, COLOR_LightGray)
.head 7 -  Set colKv = 'Экв.'
.head 7 -  Set colCount = nCount
.head 7 -  Set colSum = nEqv
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set nCount = nCount + colCount
.head 6 -  Set nEqv = nEqv + GetEQVal(Val(colKv), dBankDate, colSum)
.head 5 +  On SAM_DoubleClick
.head 6 +  If SalTblQueryContext(hWndForm) != nRow AND colKv
.head 7 +  If nCurrentNn = 7
.head 8 -  Set bLetBlk = TRUE
.head 7 -  Call DocViewList(hWndMDI, "(a.kv=" || colKv || " AND a.rec in (select rec from v_procaccdoc where nn=" || Str(nCurrentNn) || 
  IifS(sFilter="", "", " AND (" || sFilter || ")") || "))", 
  sCurrentName || ' на ' || SalFmtFormatDateTime(GetBankDate(),ddMMyyyy()))
.head 3 +  Custom Control: cSpl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  12.283"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: FLAG
.head 3 -  String: sFilter
.head 2 +  Window Variables
.head 3 -  Boolean: bMV_VPS
.head 3 -  Date/Time: dBankDate
.head 3 -  Number: nCurrentNn
.head 3 -  String: sCurrentName
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_CheckingDocs.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  Set bMV_VPS = GetGlobalOptionEx('MV_VPS')
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Set hWndForm.tbl_CheckingDocs.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.tbl_CheckingDocs.strSqlPopulate = 
"SELECT nn, tt, name 
 INTO :hWndForm.tblSos.nn,  :hWndForm.tblSos.tt, :hWndForm.tblSos.name
 FROM v_procacc 
 ORDER BY nn"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  !
.head 4 -  Call cSpl.setBarSize(5)
.head 4 -  Call cSpl.setLeftFrame(tblSos)
.head 4 +  If bMV_VPS
.head 5 -  Call cSpl.setRightFrame(tblKv)
.head 5 -  Call cSpl.setBarPosition(600)
.head 5 -  Call SalHideWindow(hWndForm.tbl_CheckingDocs.tblSos.su)
.head 4 +  Else
.head 5 -  Call cSpl.setBarPosition(1000)
.head 5 -  Call SalDisableWindow(tblKv)
.head 5 -  Call SalShowWindow(hWndForm.tbl_CheckingDocs.tblSos.su)
.head 1 -  !
.head 1 +  Form Window: frm_Doc
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    0.917"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6913
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 6914
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 6915
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 6916
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6917
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 6908
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set frm_Doc.bFixAll=FALSE
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Set frm_Doc.bFixAll=TRUE
.head 6 -  Set bRUR6=FALSE
.head 6 +  If frm_Doc.aFlg[35]
.head 7 -  Call SqlPrepareAndExecute( hSql(),
"SELECT TRIM(tag),value INTO :frm_Doc.sTmp1,:frm_Doc.sTmp2
   FROM operw
  WHERE ref=:frm_Doc.m_nRef
  ORDER BY DECODE(tag,'20',0,1),tag")
.head 7 +  While SqlFetchNext(hSql(),nFetchRes)
.head 8 +  If frm_Doc.sTmp1='20' and SalStrScan(frm_Doc.sTmp2,'+')>=0
.head 9 -  Set bRUR6=TRUE
.head 8 -  Set frm_Doc.i=VisArrayFindString (frm_Doc.aTag, SalStrTrimX( frm_Doc.sTmp1 ))
.head 8 +  If frm_Doc.i>0
.head 9 +  If bRUR6 and SalStrScan('50K,52D,57D,58D,59,70,72,',frm_Doc.aTag[i]||',')>=0
.head 10 -  Call SqlPrepareAndExecute( hSqlAux3(),
"SELECT SUBSTR(bars_swift.SwiftToStr(:frm_Doc.sTmp2,'RUR6'),1,254) INTO :frm_Doc.sTmp2
   FROM dual")
.head 10 -  Call SqlFetchNext(hSqlAux3(),nFetchRes)
.head 10 -  Set frm_Doc.aVal[frm_Doc.i]=SalStrTrimX(VisStrSubstitute(
VisStrSubstitute(frm_Doc.sTmp2,SalNumberToChar( 13 ),' '),SalNumberToChar( 10 ),PutCrLf()))
.head 9 +  Else
.head 10 -  Set frm_Doc.aVal[frm_Doc.i]=SalStrTrimX(frm_Doc.sTmp2)
.head 6 -  Set frm_Doc.aVal[0]=SalStrTrimX(frm_Doc.m_sNazn)
.head 6 -  Call SalListSetSelect( lb1, 0 )
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set frm_Doc.nSk=frm_Doc.m_nSk
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  ! Set dfSk=frm_Doc.nSk
.head 6 -  ! Call DebugN(frm_Doc.nSk)
.head 6 +  ! If frm_Doc.nSk = NUMBER_Null
.head 7 -    Call SalDisableWindow( hWndItem )
.head 7 -    Call SalHideWindow(dfSk)
.head 7 -    Call SalHideWindow(dfSkN)
.head 6 +  ! Else If frm_Doc.nSk > 0
.head 7 -    Call frm_Doc.HideIt( hWndItem )
.head 6 +  If not frm_Doc.nSk_TT and frm_Doc.nSk
.head 7 -  Call SalShowWindow(dfSk)
.head 7 -  Call SalShowWindow(dfSkN)
.head 7 -  Call frm_Doc.UnHideIt( hWndItem )
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNssA
.head 4 -  Class Child Ref Key: 159
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSlashD
.head 4 -  Class Child Ref Key: 162
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNssB
.head 4 -  Class Child Ref Key: 163
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSlashK
.head 4 -  Class Child Ref Key: 164
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWnd
.head 3 -  Number: nRef
.head 2 +  Window Variables
.head 3 -  String: sFlags_TT
.head 3 -  Number: i
.head 3 -  Boolean: bRUR6
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalSendMsg(hWnd,UM_ObjDeactivate, 0, 1)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalDisableWindow(pbNewDoc)
.head 4 -  Call SalDisableWindow(pbNewTTs)
.head 3 +  On UM_Choose
.head 4 -  Set dDat=GetBankDate()
.head 4 +  If SetDocR(nRef, FALSE)
.head 5 -  Set bDocStart=TRUE
.head 5 -  Set bFixAll=TRUE
.head 5 -  Set bFixNlsA=FALSE
.head 5 -  Set bFixKvA=FALSE
.head 5 -  Set bFixKvB=FALSE
.head 5 -  Set bFixNlsB=FALSE
.head 5 -  Set bFixMfoB=FALSE
.head 5 -  Set bFixDocD=FALSE
.head 5 -  Set bFixValD1=FALSE
.head 5 -  Set sFixKvA=STRING_Null
.head 5 -  Set sFixNlsA=STRING_Null
.head 5 -  Set sFixKvB=STRING_Null
.head 5 -  Set sFixNlsB=STRING_Null
.head 5 -  Set sFixMfoB=STRING_Null
.head 5 -  Set dFixDocD=DATETIME_Null
.head 5 -  Set dFixValD1=DATETIME_Null
.head 5 -  Set nFixVob=NUMBER_Null
.head 5 -  !
.head 5 -  Set dfNlsA=A.Nls
.head 5 -  Set dfNlsB=B.Nls
.head 5 -  Set dfBankB=B.Bank
.head 5 -  ! Set dfDocD=m_dDatD
.head 5 -  ! Set dfValD1=m_dDatV1
.head 5 -  Set dfKvA=Str(A.Kv)
.head 5 -  Set dfKvB=Str(B.Kv)
.head 5 -  Set nVob=m_nVob
.head 5 -  Set m_nSos=0
.head 5 -  Call SqlPrepareAndExecute( hSql(), T(
"SELECT DISTINCT t.tt,t.name,t.fli,t.flv,t.dk,t.kv,t.kvk,NULL tnlsa,NULL tnlsb,t.mfob,t.sk,t.flags
   INTO :sTT,:sTTN,:nFli,:nFlv,:nDk,:nKvA_TT,:nKvB_TT,:sNlsA_TT,:sNlsB_TT,:sBankB_TT,:nSk_TT,:sFlags_TT
   FROM tts t WHERE t.tt = :m_sTT") )
.head 5 +  If SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Call Flgs2aFlg(sFlags_TT)
.head 6 -  Set nDk=m_nDk
.head 6 +  If nDk = NUMBER_Null
.head 7 -  Set nDk=1
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Не найдена операция '||m_sTT, CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 6 -  Return SalDestroyWindow( hWndForm )
.head 4 +  Else
.head 5 -  Call SalMessageBox( 'Не найден документ РЕФ № '||Str(nRef), CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 5 -  Return SalDestroyWindow( hWndForm )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('DocWTit')||' - [ ' ||sTTN|| ' ]' )
.head 4 -  Call SalSendMsg( hWndForm, UM_Clear, 0, 0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On UM_Insert
.head 4 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 4 -  Call SalDisableWindow(pbNewDoc)
.head 4 -  Call SalDisableWindow(pbNewTTs)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( hWnd,UM_ObjDeactivate, 0, 0)
.head 1 -  !
.head 1 +  Table Window: tbl_hist_vis
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Журнал виз
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.32"
.head 4 -  Top:    0.267"
.head 4 -  Width:  12.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.0"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61212
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.49"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.92"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61213
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.917"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  3.917"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.017"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61214
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colRef
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colUId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colGId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colStat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Состояние
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пользователь
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colGr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Группа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nRef
.head 2 +  Window Variables
.head 3 -  Number: i
.head 3 -  String: strWhere
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_hist_vis.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set tbl_hist_vis.fFilterAtStart = TRUE
.head 4 -  Set tbl_hist_vis.nFlags = GT_ReadOnly
.head 4 -  Set tbl_hist_vis.strFilterTblName = 'v_visalist'
.head 4 -  Set tbl_hist_vis.strPrintFileName = 'Visahist.txt'
.head 4 -  Set strWhere = ""
.head 4 +  If nRef != 0
.head 5 -  Set strWhere = " AND ref=:nRef "
.head 5 -  ! Set tbl_hist_vis.strTitleAux = 'Документ Ref: ' || SalNumberToStrX(nRef, 0)
.head 5 -  Set tbl_hist_vis.strTitleAux = CurrentLangTable.GetAtomTitle('cTHEADER_Docs') || ' Ref: ' || SalNumberToStrX(nRef, 0)
.head 5 -  Call SalHideWindow(hWndForm.tbl_hist_vis.colRef)
.head 5 -  Set fFilterAtStart = FALSE
.head 4 -  Set tbl_hist_vis.strSqlPopulate =
"SELECT ref, dat, markid, username, checkgroup 
   INTO :hWndForm.tbl_hist_vis.colRef, :hWndForm.tbl_hist_vis.colDat,
        :hWndForm.tbl_hist_vis.colStat, 
        :hWndForm.tbl_hist_vis.colFIO, :hWndForm.tbl_hist_vis.colGr 
   FROM v_visalist
  WHERE markid <> 4 " || strWhere || "
  order by ref, counter"
.head 4 -  Call SalDisableWindow(tbl_hist_vis.pbDetails)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Activate
.head 4 -  Call SalSendMsg( SalParentWindow( hWndForm ), UM_MenuSelect, 0, 0 )
.head 3 +  On UM_Populate
.head 4 +  If strSqlPopulate != ''
.head 5 +  If fFilterAtStart
.head 6 -  Set fFilterAtStart = NOT fFilterAtStart
.head 6 +  If NOT SetQueryFilter( cF )
.head 7 -  Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 5 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 5 -  Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
.head 5 -  Call SalTblSetContext(hWndForm, 0)
.head 5 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  Select Case colStat
.head 5 +  Case 0
.head 6 -  ! Set colSt='Ввел документ'
.head 6 -  Set colSt = CurrentLangTable.GetAtomTitle('dlg_TabViewCheck.tblCMarks.cTInputDoc')
.head 6 -  Break
.head 5 +  Case 1	! Визирование
.head 6 -  ! Set colSt='Визирование'
.head 6 -  Set colSt = CurrentLangTable.GetAtomTitle('tbl_hist_vis.cTStat1')
.head 6 -  Break
.head 5 +  Case 2	! Оплата
.head 6 -  ! Set colSt='Оплата'
.head 6 -  Set colSt = CurrentLangTable.GetAtomTitle('tbl_hist_vis.cTStat2')
.head 6 -  Call SalTblSetCellTextColor( colSt, COLOR_Blue, TRUE )
.head 6 -  Break
.head 5 +  Case 3	! Сторнирование
.head 6 -  ! Set colSt='Сторнирование'
.head 6 -  Set colSt = CurrentLangTable.GetAtomTitle('tbl_hist_vis.cTStat3')
.head 6 -  Call SalTblSetCellTextColor( colSt, COLOR_Red, TRUE )
.head 6 -  Break
.head 5 +  Default
.head 6 -  Break
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( SalParentWindow( hWndForm ), UM_MenuSelect, 0, 0 )
.head 4 -  Call SalSetFocus(SalParentWindow( hWndForm ))
.head 1 -  !
.head 1 +  Form Window: frm_Ctrl_D
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Информация  о  ДОКУМЕНТАХ [Навигация]
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.79"
.head 4 -  Top:    0.308"
.head 4 -  Width:  9.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.583"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Информация о документах
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.13"
.head 5 -  Top:    0.1"
.head 5 -  Width:  9.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Архив документов
.head 4 -  Resource Id: 54388
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.02"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgArch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: NDOK1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.75"
.head 5 -  Top:    1.167"
.head 5 -  Width:  1.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If FLAG      !! ВСЕ пользователи за ТЕК день
.head 7 -  ! Введенные документы за ss5
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTNDOKAll') || ' ' ||
    CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTData') || ' ' || sCurrDate || ' ' || sWinTitle
.head 7 -  Set sDopFilter = IifS(sFilter='', "", "(" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 2
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = SalFmtFormatStrDateTime(SalFmtFormatDateTime(SalDateCurrent(), 'dd.MM.yyyy'), 'dd.MM.yyyy')
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(SalDateCurrent()), SalDateMonth(SalDateCurrent()), SalDateDay(SalDateCurrent()), 23, 59, 59)
.head 6 +  Else !! ТЕК пользователь за ТЕК день
.head 7 -  ! Введенные документы пользователя за ss5
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTNDOKUser') || ' ' ||
    CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTData') || ' ' || sCurrDate || ' ' || sWinTitle
.head 7 -  Set sDopFilter = "a.userid=:USERID" || IifS(sFilter='', "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 3
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = SalFmtFormatStrDateTime(SalFmtFormatDateTime(SalDateCurrent(), 'dd.MM.yyyy'), 'dd.MM.yyyy')
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(SalDateCurrent()), SalDateMonth(SalDateCurrent()), SalDateDay(SalDateCurrent()), 23, 59, 59)
.head 7 -  Set cFilter.smFieldName[2]  = 'USERID'
.head 7 -  Set cFilter.nmFieldValue[2] = GetUserId()
.head 6 -  Call IntDocsList(hWndMDI, sTitle, sDopFilter,
     "a.ref in (SELECT ref FROM ref_que) and a.sos>=0",
     "a.pdat between :PDAT1 and :PDAT2",
     cFilter)
.head 3 +  Pushbutton: NDOK2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.75"
.head 5 -  Top:    2.0"
.head 5 -  Width:  1.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFilterDat = GetDat()
.head 6 +  If FLAG     !! ВСЕ пользователи за ВСЕ дни
.head 7 -  ! Архив введенных документов
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTNDOKArch') ||
    IifS(dfDatFrom!=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatFrom') || " " || SalFmtFormatDateTime(dfDatFrom, 'dd/MM/yyyy'), "") ||
    IifS(dfDatTo  !=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatTo')   || " " || SalFmtFormatDateTime(dfDatTo,   'dd/MM/yyyy'), "") || " " || sWinTitle
.head 7 -  Set sDopFilter = IifS(sFilterDat='', IifS(sFilter='', "", sFilter), " a.pdat " || sFilterDat || IifS(sFilter="", "", " and (" || sFilter || ")"))
.head 7 -  Set cFilter.nFieldNum = 2
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = dfDatFrom
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  ! Set cFilter.dmFieldValue[1] = dfDatTo
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(dfDatTo), SalDateMonth(dfDatTo), SalDateDay(dfDatTo), 23, 59, 59)
.head 6 +  Else !! ТЕК пользователь за ВСЕ дни
.head 7 -  ! Введенные документы пользователя
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTNDOKUser') ||
    IifS(dfDatFrom!=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatFrom') || " " || SalFmtFormatDateTime(dfDatFrom, 'dd/MM/yyyy'), "") ||
    IifS(dfDatTo  !=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatTo')   || " " || SalFmtFormatDateTime(dfDatTo,   'dd/MM/yyyy'), "") || " " || sWinTitle
.head 7 -  Set sDopFilter = IifS(sFilterDat='', "", " a.pdat " || sFilterDat || " and ") || " a.userid=:USERID" || IifS(sFilter="", "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 3
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = dfDatFrom
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  ! Set cFilter.dmFieldValue[1] = dfDatTo
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(dfDatTo), SalDateMonth(dfDatTo), SalDateDay(dfDatTo), 23, 59, 59)
.head 7 -  Set cFilter.smFieldName[2]  = 'USERID'
.head 7 -  Set cFilter.nmFieldValue[2] = GetUserId()
.head 6 -  Call IntDocsList(hWndMDI, sTitle, sDopFilter, "", "", cFilter)
.head 3 +  Pushbutton: MODOK1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.15"
.head 5 -  Top:    1.167"
.head 5 -  Width:  1.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If FLAG         !! ВСЕ пользователи за ТЕК день
.head 7 -  ! Межбанковские поступления за ss2
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTMODOKAll') || ' ' ||
    CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTData') || ' ' || sBankDate || ' ' || sWinTitle
.head 7 -  Set sDopFilter = "a.dat_a BETWEEN :BANKDATE AND :BANKDATE + 0.9999 AND a.mfob=:BANKMFO AND a.sos>3" || IifS(sFilter='', "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 2
.head 7 -  Set cFilter.smFieldName[0]  = 'BANKDATE'
.head 7 -  Set cFilter.dmFieldValue[0] = GetBankDate()
.head 7 -  Set cFilter.smFieldName[1]  = 'BANKMFO'
.head 7 -  Set cFilter.smFieldValue[1] = GetBankMfo()
.head 6 +  Else !! ТЕК пользователь за ТЕК день
.head 7 -  ! Межбанковские поступления на счета пользователя за ss2
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTMODOKUser') || ' ' ||
    CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTData') || ' ' || sBankDate || ' ' || sWinTitle
.head 7 -  Set sDopFilter = "a.dat_a BETWEEN :BANKDATE AND :BANKDATE + 0.9999 AND a.mfob=:BANKMFO AND a.sos>3 and a.nlsb in " || sNlsIsp || IifS(sFilter='', "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 2
.head 7 -  Set cFilter.smFieldName[0]  = 'BANKDATE'
.head 7 -  Set cFilter.dmFieldValue[0] = GetBankDate()
.head 7 -  Set cFilter.smFieldName[1]  = 'BANKMFO'
.head 7 -  Set cFilter.smFieldValue[1] = GetBankMfo()
.head 6 -  Call ExtDocsList(hWndMDI, sTitle, sDopFilter, cFilter)
.head 3 +  Pushbutton: MODOK2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.15"
.head 5 -  Top:    2.0"
.head 5 -  Width:  1.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFilterDat = GetDat()
.head 6 +  If FLAG      !! ВСЕ пользователи за ВСЕ дни
.head 7 -  ! Межбанковские поступления
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTMODOKAll') ||
     IifS(dfDatFrom!=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatFrom') || " " || SalFmtFormatDateTime(dfDatFrom, 'dd/MM/yyyy'), "") ||
     IifS(dfDatTo  !=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatTo')   || " " || SalFmtFormatDateTime(dfDatTo,   'dd/MM/yyyy'), "") || " " || sWinTitle
.head 7 -  Set sDopFilter = IifS(sFilterDat='', "", "a.datp " || sFilterDat || " and ") || " a.mfob=:BANKMFO AND a.sos>3" || IifS(sFilter='', "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 3
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = dfDatFrom
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  ! Set cFilter.dmFieldValue[1] = dfDatTo
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(dfDatTo), SalDateMonth(dfDatTo), SalDateDay(dfDatTo), 23, 59, 59)
.head 7 -  Set cFilter.smFieldName[2]  = 'BANKMFO'
.head 7 -  Set cFilter.smFieldValue[2] = GetBankMfo()
.head 6 +  Else !! ТЕК пользователь за ВСЕ дни
.head 7 -  ! Межбанковские поступления на счета пользователя
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTMODOKUser') ||
     IifS(dfDatFrom!=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatFrom') || " " || SalFmtFormatDateTime(dfDatFrom, 'dd/MM/yyyy'), "") ||
     IifS(dfDatTo  !=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatTo')   || " " || SalFmtFormatDateTime(dfDatTo,   'dd/MM/yyyy'), "") || " " || sWinTitle
.head 7 -  Set sDopFilter = "a.datp " || sFilterDat || " and a.mfob=:BANKMFO AND a.sos>3" || " and a.nlsb in " || sNlsIsp || IifS(sFilter="", "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 3
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = dfDatFrom
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  ! Set cFilter.dmFieldValue[1] = dfDatTo
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(dfDatTo), SalDateMonth(dfDatTo), SalDateDay(dfDatTo), 23, 59, 59)
.head 7 -  Set cFilter.smFieldName[2]  = 'BANKMFO'
.head 7 -  Set cFilter.smFieldValue[2] = GetBankMfo()
.head 6 -  Call ExtDocsList(hWndMDI, sTitle, sDopFilter, cFilter)
.head 3 +  Pushbutton: VODOK1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    1.167"
.head 5 -  Width:  1.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If FLAG       !! ВСЕ пользователи за ТЕК день
.head 7 -  ! Внутренние поступления на счета за ss2
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTVODOKAll') || ' ' ||
    CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTData') || ' ' || sBankDate || ' ' || sWinTitle
.head 7 -  Set sDopFilter = "a.datp=:BANKDATE" || IifS(sFilter="", "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 1
.head 7 -  Set cFilter.smFieldName[0]  = 'BANKDATE'
.head 7 -  Set cFilter.dmFieldValue[0] = GetBankDate()
.head 6 +  Else !! ТЕК пользователь за ТЕК день
.head 7 -  ! Внутренние поступления на счета пользователя за ss2
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTVODOKUser') || ' ' ||
    CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTData') || ' ' || sBankDate || ' ' || sWinTitle
.head 7 -  Set sDopFilter = "a.datp=:BANKDATE AND (a.dk=1 and a.nlsb in " || sNlsIsp || " OR a.dk=0 and a.nlsa in " || sNlsIsp || ") " || IifS(sFilter="", "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 1
.head 7 -  Set cFilter.smFieldName[0]  = 'BANKDATE'
.head 7 -  Set cFilter.dmFieldValue[0] = GetBankDate()
.head 6 -  Call IntDocsList(hWndMDI, sTitle, sDopFilter, "", "",  cFilter)
.head 3 +  Pushbutton: VODOK2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    2.0"
.head 5 -  Width:  1.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFilterDat = GetDat()
.head 6 +  If FLAG      !! ВСЕ пользователи за ВСЕ дни
.head 7 -  ! Внутренние поступления на счета
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTVODOKAll') ||
    IifS(dfDatFrom!=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatFrom') || " " || SalFmtFormatDateTime(dfDatFrom, 'dd/MM/yyyy'), "") ||
    IifS(dfDatTo  !=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatTo')   || " " || SalFmtFormatDateTime(dfDatTo,   'dd/MM/yyyy'), "") || " " || sWinTitle
.head 7 -  Set sDopFilter = IifS(sFilterDat='', "", " a.pdat " || sFilterDat || " and ") || " (a.sos is not NULL) " || IifS(sFilter='', "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 2
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = dfDatFrom
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  ! Set cFilter.dmFieldValue[1] = dfDatTo
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(dfDatTo), SalDateMonth(dfDatTo), SalDateDay(dfDatTo), 23, 59, 59)
.head 6 +  Else !! ТЕК пользователь за ВСЕ дни
.head 7 -  ! Внутренние поступления на счета пользователя
.head 7 -  Set sTitle = CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTVODOKUser') ||
    IifS(dfDatFrom!=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatFrom') || " " || SalFmtFormatDateTime(dfDatFrom, 'dd/MM/yyyy'), "") ||
    IifS(dfDatTo  !=DATETIME_Null, " " || CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDatTo')   || " " || SalFmtFormatDateTime(dfDatTo,   'dd/MM/yyyy'), "") || " " || sWinTitle
.head 7 -  Set sDopFilter = IifS(sFilterDat='', "", " a.pdat " || sFilterDat || " and ") || " (a.dk=1 and a.nlsb in " || sNlsIsp || " OR a.dk=0 and a.nlsa in " || sNlsIsp || ") " || IifS(sFilter='', "", " and (" || sFilter || ")")
.head 7 -  Set cFilter.nFieldNum = 2
.head 7 -  Set cFilter.smFieldName[0]  = 'PDAT1'
.head 7 -  Set cFilter.dmFieldValue[0] = dfDatFrom
.head 7 -  Set cFilter.smFieldName[1]  = 'PDAT2'
.head 7 -  ! Set cFilter.dmFieldValue[1] = dfDatTo
.head 7 -  Set cFilter.dmFieldValue[1] = SalDateConstruct( SalDateYear(dfDatTo), SalDateMonth(dfDatTo), SalDateDay(dfDatTo), 23, 59, 59)
.head 6 -  Call IntDocsList(hWndMDI, sTitle, sDopFilter, "", "",  cFilter)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: В&ыход
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    3.45"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  Background Text: Все
документы
.head 4 -  Resource Id: 54389
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.3"
.head 5 -  Top:    0.583"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.354"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Межбанковские
(полученные)
.head 4 -  Resource Id: 54390
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    0.583"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.354"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Внутрибанковские
(полученные)
.head 4 -  Resource Id: 54391
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.1"
.head 5 -  Top:    0.583"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.354"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: * Введенные
за
.head 4 -  Resource Id: 54392
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.155"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.345"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocDay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfCurrentDay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.5"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ** Все дни
.head 4 -  Resource Id: 54393
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.869"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocAllDay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: с
.head 4 -  Resource Id: 54394
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.15"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDatFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDatFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    2.071"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: по
.head 4 -  Resource Id: 54395
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.37"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDatTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDatTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    2.321"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 54396
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.25"
.head 5 -  Begin Y:  1.036"
.head 5 -  End X:  9.3"
.head 5 -  End Y:  1.036"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 5
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 54397
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.286"
.head 5 -  Begin Y:  1.813"
.head 5 -  End X:  9.333"
.head 5 -  End Y:  1.813"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 5
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 54398
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  2.2"
.head 5 -  Begin Y:  2.604"
.head 5 -  End X:  2.2"
.head 5 -  End Y:  0.521"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 54399
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  4.6"
.head 5 -  Begin Y:  2.604"
.head 5 -  End X:  4.6"
.head 5 -  End Y:  0.521"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 54400
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  7.0"
.head 5 -  Begin Y:  2.604"
.head 5 -  End X:  7.0"
.head 5 -  End Y:  0.521"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 54401
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.283"
.head 5 -  Begin Y:  2.667"
.head 5 -  End X:  9.333"
.head 5 -  End Y:  2.667"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 5
.head 4 -  Line Color: Default
.head 3 -  Background Text: * В выборках используется реальная дата ввода документов
.head 4 -  Resource Id: 54402
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.8"
.head 5 -  Width:  5.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPrimTek
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: ** Можно менять даты
.head 4 -  Resource Id: 54403
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.0"
.head 5 -  Width:  5.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPrimAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: GetDat
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If dfDatFrom
.head 6 +  If dfDatTo
.head 7 -  Return " between :PDAT1 and :PDAT2"
.head 6 +  Else
.head 7 -  Return " >= :PDAT1"
.head 5 +  Else If dfDatTo
.head 6 -  Return " <= :PDAT2"
.head 5 -  Return ""
.head 2 +  Window Parameters
.head 3 -  Boolean: FLAG
.head 3 -  String: sFilter
.head 3 -  String: sWinTitle
.head 2 +  Window Variables
.head 3 -  String: sBankDate
.head 3 -  String: sNlsIsp
.head 3 -  String: sCurrDate
.head 3 -  Date/Time: dtCurrent
.head 3 -  String: sFilterDat
.head 3 -  String: sTitle
.head 3 -  String: sDopFilter
.head 3 -  : cFilter
.head 4 -  Class: cDocFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 +  If FLAG
.head 5 -  ! ДОКУМЕНТЫ ВСЕХ ПОЛЬЗОВАТЕЛЕЙ [Навигация]
.head 5 -  Call SalSetWindowText(hWndForm,
     CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTAllUsersDocs') || ' [' ||
     CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTNavigation') || '] ' || sWinTitle)
.head 5 -  Call SalDisableWindow(VODOK1)
.head 5 -  Call SalDisableWindow(VODOK2)
.head 5 -  Call SalSetWindowLabelText(bgDocAll, CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDocAll'))
.head 5 -  Call SalSetWindowLabelText(bgDocMB, CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDocMB'))
.head 5 -  Call SalSetWindowLabelText(bgDocVB, CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDocVB'))
.head 4 +  Else
.head 5 -  ! ДОКУМЕНТЫ ПОЛЬЗОВАТЕЛЯ GetUserRealName() [Навигация]
.head 5 -  Call SalSetWindowText(hWndForm,
     CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTUserDocs') || ' ' || GetUserRealName() || ' [' ||
     CurrentLangTable.GetAtomTitle('frm_Ctrl_D.cTNavigation') || '] ' || sWinTitle )
.head 5 -  Call SalSetWindowLabelText(bgDocAll, CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDocAll_User'))
.head 5 -  Call SalSetWindowLabelText(bgDocMB, CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDocMB_User'))
.head 5 -  Call SalSetWindowLabelText(bgDocVB, CurrentLangTable.GetAtomTitle('frm_Ctrl_D.bgDocVB_User'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSqlAux(), 'SELECT sysdate INTO :dfCurrentDay FROM dual')
.head 5 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 4 -  Set dfDatFrom = dfCurrentDay - 10
.head 4 -  Set dfDatTo   = dfCurrentDay
.head 4 -  Set sBankDate = SalFmtFormatDateTime(GetBankDate(),ddMMyyyy())
.head 4 -  Set sNlsIsp   = '(SELECT nls FROM accounts ac WHERE a.kv=ac.kv and isp in ('||GetSubstListId( GetUserId(), TRUE )||'))'
.head 4 -  Set sCurrDate = SalFmtFormatDateTime(dfCurrentDay, ddMMyyyy())
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation call function' role
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
.head 5 -  Call XRoleUnset(hSql(), ' F_Ctrl_D('||SalNumberToStrX(FLAG,0) || ') ' )
.head 4 -  Call SalSetFocus( SalParentWindow( hWndForm ))
.head 1 -  !
