Application Description: Казначейские штучки
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000990000 002C000000020000 0003000000000000 00BB010000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730A7370
0080: 6C506C616E446F68
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533032332E 617064175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: GenTblF.apl
		File Include: Gentbld.apl
		File Include: Gentbls.apl
		File Include: Genlist.apl
		File Include: XSALIMG.APL
		File Include: XSALSPL.APL
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: Docview.apd
		Dynalib: Custacnt.apd
		Dynalib: nsiapi.apd
		File Include: Docfun6.apl
		File Include: Docwis6.apl
		File Include: Winapi.apl
		File Include: Xsalcpt.apl
		File Include: vttblwin.apl
		File Include: Vtmeter.apl
		File Include: Vtdos.apl
		File Include: Vtarray.apl
		File Include: Vtfile.apl
		File Include: Vtmsgbox.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				Number: ID_Ok = 0
				Number: ID_Yes = 1
				Number: ID_No = 2
				String: ApdNum   =  '23'
				String: ApdVer   =  '56'
				! История изменений: -----------------------------------------------------|
				! 08 27-04-04  MIK     Положил начало контролю версий                     |
				! 09 29-04-04  MIK     Сделал плановые показатели по доходам              |
				! 10 25-05-04  MIK     Исправил имя справочника gr412mb (убрал ГОД)       |
				! 11 29-05-06  MIK     Приехала К2,K2B из procapi.apd                     |
				! 12 04-09-06  MIK     В p_asse добавил 3111,3121,3141,3151,3717          |
				! 13 18-12-06  MIK     в К2 раскрасил строки при закрытом счете           |
				! 14 04-06-08  MIK     Импорт DBF по плановых показателей по нак 373      |
				! 15 14-07-08  MIK     Виніс в пареметри список рах. K2_ASSE      |
				! 16 15-07-08  MIK     Параметр PLN373  N-стара структура,Y-нова, пусто-нова, з розширенням dbf    |
				! 17 24-03-09  MIK     В К2 зробив динамічний вибір бухмоделі по рах ДЕБ. Привів в порядок дес.точку в планах МБ
				! 18 28-08-09  MIK     Відкриття рахунків за власними надходженнами розпорядників коштів
				! 19 06-10-09  MIK     Не працювало з параметром Параметр PLN373='N'
				! 20 19-11-09  MIK     Длд власних не працював імпорт файлів Б 255 байт
				! 21 01-12-09  MIK     В розборі виписок зробив вилучення рядка виписки
				! 22 02-12-09  MIK     Исправил опечатку при суммировке плановых по МБ
				! 23 02-12-09  MIK     Не выбиралось територии при к-обл с 1 знак
				! 24 14-12-09  MIK     Сделал разархивацию выписок 
				! 25 17-12-09  MIK     Сделал новый формат выписок из ЕКСИМБИНКА
				! 26 24-12-09  MIK     Сделал выборку остатка НОСТРО для разбора выписок
				! 27 03-01-10  MIK     Заклав ф-ю "Перерахування коштів по реєстру"
				! 28 15-01-10  MIK     У виписках зробив прийом поточних виписок
				! 29 15-01-10  MIK     У виписках прибрав зменшення лічильника при повторному розборі
				! 30 02-02-10  MIK     Загубили імпорт НБУ вставили назад
				! 31 04-02-10  MIK     Перша робоча версія "Перерахування коштів по реєстру"
				! 32 08-02-10  MIK     У виписках поправив сортування, щоб свіжі виписки заверху
				! 33 25-02-10  MIK     В розборі виписок зробив можливість СТОРНО
				! 34 09-03-10  MIK     В розборі виписок підправив парент на hWndMDI щоб не блимало
				! 35 30-04-10  MIK     Додав в "перерахування коштів" par=nGrp (більш універсвльна версія, без обл)
				! 36 15-09-10  MIK     Додав дату документа та можливысть вилучення окремих рядків
				! 37 21-09-10  MIK     Додав можливість виклику процедури в перекритті, дещо порихтував
				! 38 12-10-10  MIK     Додав параметр для RO (тільки для перегляду) в Розгортанні дотацій+перекриття мінусової суми як дебет
				! 39 27-10-10  MIK     У Власних надходженнях враховуємо, що 3125 можуть бути закриті
				! 40 15-02-11  MIK     В планових показниках вибираємо тільки ККД по op_ter 
				! 41 24-05-11  MIK     Додав можливість мультивалютних перекриттів, 7-сума в валюті вирах. 8-з колонки S2
				! 42 03-06-11  MIK     Виключив з виборки budj закриті символи в Планових показниках
				! 43 07-06-11  MIK     В перекриттях можливість установки локальної банківської дати
				! 44 11-08-11  MIK     В розборі виписок зробив зміним маску файлу ЕкзимБанку
				! 45 18-08-11  MIK     В оплаті картотеки для ОКПО-Б = 0000000000 вибираємо тег '#ф'
				! 46 29-08-11  MIK     В перекриттях можливість імпорту даних з зовнішніх файлів
				! 47 10-10-11  MIK     Плмилка при оплаті картотеки для ОКПО-Б = 0000000000 вибираємо тег '#ф' давала 6115
				! 48 22-12-11  MIK     В перекриттях можливість роботи блоками по Рах А чи по-одному (пар виклику для IRBIS і всіх)
				! 49 29-03-12  MIK     В Планових МБ послабив виборку в формі
				! 50 15-04-12  MIK     Замінив виклик imp_fil на imp_fil0
				! 51 02-10-12  MIK     Додав флаги для виборки колонки DK та D_REC
				! 52 06-02-13  MIK     Прибрав VIDPL з К2
				! 53 26-02-13  MIK     Прибрав формування квитанцій в старий КБ
				! 54 13-06-13  MIK     Вставив чистку  K2_que
				! 55 13-06-15  MIK     При розборі валютних виписок дату валютування за минулий міс проводимо з vob=96
				! 56 09-03-16  MIK     В форму перекриття додав колонку "Субрахунок"
		Resources
		Variables
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin6
			Window Handle: hWin7
			Window Handle: hWin11
			Boolean: bApdInited
			Number: nFetchRes
			! Boolean: bFormulaSum
			! Boolean: bEnableTbl
			Number: nGrp
			Boolean: bRefrech
			Number: dMDate
			Number: dYDate
		Internal Functions
			Function: Sel023	! __exported
				Description: Bars023_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					Number: nFlags
				Actions
					Call Ini023()
					! 001х - локальная банковская дата
					Set nFlags = ( nMode & 0xFFF0 ) / 16
					Set nMode = nMode & 0x000F
					Select Case nMode
						Case 1    ! Разворот остатков на 9 к.
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow(frm_DV,hWndParent,nPar,strPar01,strPar02)
							Else
								Call SalBringWindowToTop(hWin1)
							Break
						Case 2    ! Плановые показатели по доходам ДБ / МБ 
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(splPlanDoh,hWndParent,IifN(nPar=0,2,nPar),strPar01,strPar02)
							Else
								Call SalBringWindowToTop(hWin2)
							Break
						Case 3    ! Картотека К-2  (Приехала из provapi.apd) 
							If not IsWindow(hWin3)
								Select Case nPar
									Case 0   ! Просмотр / Оплата
										Set hWin3 = SalCreateWindow(K2,hWndParent,nPar,strPar01,strPar02)
										Break
									Case 1   ! Только просмотр
										Set hWin3 = SalCreateWindow(K2,hWndParent,nPar,strPar01,strPar02)
										Break
									Case 8   ! Старая, Вся K2,  просмотр и оплата
										Set hWin3 = SalCreateWindow(K2,hWndParent,0,'K2',strPar02)
										Break
									Case 9   ! Старая, Исп К2,  просмотр и оплата
										Set hWin3 = SalCreateWindow(K2,hWndParent,0,'K2','k.isp=:K2.nIsp')
										Break
									Case 10  ! Старая, Вся K22, просмотр и оплата
										Set hWin3 = SalCreateWindow(K2,hWndParent,0,'K22',strPar02)
										Break
									Case 11  ! Старая, Исп K22, просмотр и оплата
										Set hWin3 = SalCreateWindow(K2,hWndParent,0,'K22','k.isp=:K2.nIsp')
										Break
									Case 12  ! Старая, Вся K22: Просмотр
										Set hWin3 = SalCreateWindow(K2,hWndParent,1,'K22',strPar02)
										Break
									Case 13  ! Старая, Исп К22: Просмотр
										Set hWin3 = SalCreateWindow(K2,hWndParent,1,'K22','k.isp=:K2.nIsp')
										Break
							Else
								Call SalBringWindowToTop(hWin3)
							Break
						Case 4    ! Бронирование средств K-2 (Приехала из provapi.apd) 
							If not IsWindow(hWin4)
								Set hWin4 = SalCreateWindow( K2b, hWndParent, nPar)
							Else
								Call SalBringWindowToTop(hWin4)
							Break
						Case 11   ! Разбор выписок из КБ (типа картотеки КРЕДИТОРОВ)
							If not IsWindow(hWin11)
								Set hWin11 = SalCreateWindow( frm_VypB, hWndParent, nPar, strPar01 ,strPar02)
							Else
								Call SalBringWindowToTop ( frm_VypB )
							Break
						Case 6   ! Відкриття рахунків за власними надходженнями
							If not IsWindow(hWin6)
								Set hWin6 = SalCreateWindow( splOp3522, hWndParent, nPar, strPar01 ,strPar02)
							Else
								Call SalBringWindowToTop ( splOp3522 )
							Break
						Case 7   ! Перерахування коштів згідно реєстру
							If not IsWindow(hWin7)
								Set hWin7 = SalCreateWindow( tblPerekryt, hWndParent, nMode, nPar, strPar01 ,strPar02, nFlags & 0x0001, nFlags & 0x0002, nFlags & 0x0004, nFlags & 0x0008, nFlags & 0x0010)
							Else
								Call SalBringWindowToTop ( tblPerekryt )
							Break
						Case 8   ! Перерахування коштів згідно реєстру (Мультивалютна)
							If not IsWindow(hWin7)
								Set hWin7 = SalCreateWindow( tblPerekryt, hWndParent, nMode, nPar, strPar01 ,strPar02, nFlags & 0x0001, nFlags & 0x0002, nFlags & 0x0004, nFlags & 0x0008, nFlags & 0x0010)
							Else
								Call SalBringWindowToTop ( tblPerekryt )
							Break
			Function: Ini023
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						! Инициализация LNG-файла
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars023.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							! dlg_RefListF
							Call CurrentLangTable.AddAtom('dlg_RefListF.cTWndTitle','Ввод операций')
							Call CurrentLangTable.AddAtom('dlg_RefListF.pbAction','Открыть')
							Call CurrentLangTable.AddAtom('dlg_RefListF.pbActionClose','Закрыть')
							Call CurrentLangTable.AddAtom('dlg_RefListF.pbActionShow','Показать')
							Call CurrentLangTable.AddAtom('dlg_RefListF.cTInputOperations','Операции ввода')
							Call CurrentLangTable.AddAtom('dlg_RefListF.cTErrMenu','ошибка построения меню')
							! dlgInkast
							Call CurrentLangTable.AddAtom('dlgInkast.cTWndTitle','Справочник Инкассаторов/Подотчетных лиц')
							Call CurrentLangTable.AddAtom('dlgInkast.tbl.colFio','ФИО')
							Call CurrentLangTable.AddAtom('dlgInkast.bgSearchStr','Поиск:')
							Call CurrentLangTable.AddAtom('dlgInkast.pbOk','Выбрать')
						!
						Call DocWisInit( 'frmDoc' )
						Set bApdInited = TRUE
					Return bApdInited
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
			Functional Class: cDocPerekryt
				Description:
				Derived From
					Class: cDoc
				Class Variables
				Instance Variables
					Boolean: bSignInit
				Functions
					Function: sIni
						Description: Инициализировать ЭЦП
						Returns
							Boolean:
						Parameters
						Static Variables
							! Boolean: bSignInited
							! Number: nTim
						Local variables
							! String: strUxDateTime
							String: strDay
							Number: nDay
							Number: nErrorSign
							String: strErrorSign
							String: strPinCode
						Actions
			Functional Class: cK2Doc
				Description:
				Derived From
					Class: cDoc
				Class Variables
				Instance Variables
					Number: nK2Mode
					Number: nK2Ref
					String: sK2Nls9
					String: sK2NlsK
				Functions
					Function: iDoc
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set cDoc.m_nPyD=0   ! Запретить оплату по факт остатку
							Return cDoc.iDoc()
					Function: oDoc
						Description: Оплатить документ с
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							String: sErrTxt
						Actions
							While TRUE
								If cDoc.oDoc()
									If nK2Mode = 3
										If not SqlPLSQLCommand(hSql(), "p_asse(cDoc.m_nRef)")
											Set sErrTxt = 'Невозможно выполнить ASSE ' || cDoc.m_sTT
											Break
									If cDoc.A.Bank = GetBankMfo() and
											  (cDoc.m_sTT = 'K2D' or cDoc.m_sTT = 'K2C' or cDoc.m_sTT = 'K2I')
										If not SqlPLSQLCommand(hSql(),
												  "gl.DynTT(0,cDoc.m_nRef,cDoc.m_dDatV1,1-cDoc.m_nDk,cDoc.B.Kv,cDoc.B.Nls,cDoc.B.S,
												                                                 cDoc.A.Kv,cDoc.A.Nls,cDoc.A.S)")
											Set sErrTxt = 'Невозможно выполнить связанную операцию для ' || cDoc.m_sTT
											Break
									If cDoc.B.Bank = GetBankMfo() and
											  (cDoc.m_sTT = 'K2I' or cDoc.m_sTT = 'K2E' or cDoc.m_sTT = 'K2C' or cDoc.m_sTT = 'K2G')
										If not SqlPLSQLCommand(hSql(),
												  "gl.DynTT(0,cDoc.m_nRef,cDoc.m_dDatV1,cDoc.m_nDk,cDoc.A.Kv,cDoc.A.Nls,cDoc.A.S,
												                                                 cDoc.B.Kv,cDoc.B.Nls,cDoc.B.S)")
											Set sErrTxt = 'Невозможно выполнить связанную операцию для ' || cDoc.m_sTT
											Break
									If not cDoc.P_Fac(cDoc.m_nRef, SalFmtFormatDateTime(cDoc.m_dDatV1, 'MM-dd-yyyy'))
										Set sErrTxt = 'Невозможно оплатить док. РЕФ #' || Str(cDoc.m_nRef)
										Break
									If not cDoc.PayV(1,nK2Ref,cDoc.m_dDatV1,'K2O',1,cDoc.A.Kv,sK2NlsK,cDoc.A.S,cDoc.B.Kv,sK2Nls9,cDoc.B.S)
										Set sErrTxt = 'Невозможно оплатить док. K2-РЕФ #' || Str(nK2Ref)
										Break
									Return TRUE
								Else
									Return FALSE
							Call SqlRollback(hSql())
							Call MessageErrorEx('Ошибка : ' || sErrTxt || '.')
							Return FALSE
			Form Window Class: cGenericTableSpl2
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Title:
				Icon File:
				Accesories Enabled? Yes
				Visible? Class Default
				Display Settings
					Display Style? Default
					Visible at Design time? Yes
					Automatically Created at Runtime? No
					Initial State: Normal
					Maximizable? Class Default
					Minimizable? Class Default
					System Menu? Class Default
					Resizable? Class Default
					Window Location and Size
						Left:  
						Top:   
						Width:  12.314"
						Width Editable? Class Default
						Height: 7.385"
						Height Editable? Class Default
					Form Size
						Width:  Class Default
						Height: Class Default
						Number of Pages: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Next Class Child Key: 35
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				Description:
				Derived From
				Menu
				Tool Bar
					Display Settings
						Display Style? Class Default
						Location? Class Default
						Visible? Class Default
						Size: 0.427"
						Size Editable? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
					Contents
						Pushbutton: pbIns
							Class Child Ref Key: 0
							Class ChildKey: 15
							Class: ctb_pbInsert
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   0.133"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Вставить новую запись'
								On SAM_Click
									Call SalSendMsg(tbl, UM_Insert, 0, 0)
						Pushbutton: pbDel
							Class Child Ref Key: 0
							Class ChildKey: 16
							Class: ctb_pbDelete
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   0.583"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Пометить/Снять пометку на удаление'
								On SAM_Click
									Call SalSendMsg(tbl, UM_Delete, 0, 0)
						Pushbutton: pbRefresh
							Class Child Ref Key: 0
							Class ChildKey: 17
							Class: ctb_pbRefresh
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   1.033"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Перечитать записи в таблице'
								On SAM_Click
									Call SalSendMsg(tbl, UM_Populate, 0, 0)
						Pushbutton: pbUpdate
							Class Child Ref Key: 0
							Class ChildKey: 18
							Class: ctb_pbUpdate
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   1.483"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Сохранить значения в базе данных'
								On SAM_Click
									Call SalSendMsg(tbl, UM_Update, 0, 0)
						Line
							Resource Id: 56336
							Class Child Ref Key: 0
							Class ChildKey: 19
							Class:
							Coordinates
								Begin X:  1.983"
								Begin Y:  0.417"
								End X:  1.983"
								End Y:  0.0"
							Visible? Yes
							Line Style: Etched
							Line Thickness: 1
							Line Color: 3D Shadow Color
						Pushbutton: pbSearch
							Class Child Ref Key: 0
							Class ChildKey: 20
							Class: ctb_pbSearch
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   2.083"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Поиск по значению первичного ключа'
								On SAM_Click
									Call SalSendMsg(hWndForm, UM_Search, 0, 0)
						Pushbutton: pbFilter
							Class Child Ref Key: 0
							Class ChildKey: 21
							Class: ctb_pbFilter
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   2.533"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Установить фильтр...'
								On SAM_Click
									If SetQueryFilter(tbl.cF)
										Call SalPostMsg(tbl, UM_Populate, 0, 0)
						Pushbutton: pbDetails
							Class Child Ref Key: 0
							Class ChildKey: 31
							Class: ctb_pbDetail
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   2.983"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Подробная информация для строки таблицы'
								On SAM_Click
									Call SalSendMsg(tbl, UM_DoubleClick, 0, 0)
						Pushbutton: pbPrint
							Class Child Ref Key: 0
							Class ChildKey: 22
							Class: ctb_pbPrint
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   3.433"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: F5
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Печать таблицы'
								On SAM_Click
									Call SalSendMsg(hWndForm, UM_Print, 0, 0)
						Line
							Resource Id: 56337
							Class Child Ref Key: 0
							Class ChildKey: 23
							Class:
							Coordinates
								Begin X:  3.933"
								Begin Y:  0.417"
								End X:  3.933"
								End Y:  0.0"
							Visible? Yes
							Line Style: Etched
							Line Thickness: 1
							Line Color: 3D Shadow Color
						Pushbutton: pbExit
							Class Child Ref Key: 0
							Class ChildKey: 25
							Class: ctb_pbCancel
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   4.083"
								Top:    0.06"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Esc
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									Set strTip = 'Завершить работу'
								On SAM_Click
									Call SalSendMsg(hWndForm, UM_Close, 0, 0)
						Line
							Resource Id: 56338
							Class Child Ref Key: 0
							Class ChildKey: 26
							Class:
							Coordinates
								Begin X:  4.633"
								Begin Y:  0.417"
								End X:  4.633"
								End Y:  0.0"
							Visible? Yes
							Line Style: Etched
							Line Thickness: 1
							Line Color: 3D Shadow Color
				Contents
					Child Table: tbl
						Class Child Ref Key: 0
						Class ChildKey: 28
						Class:
						Property Template:
						Class DLL Name:
						Display Settings
							Window Location and Size
								Left:   0.1"
								Top:    0.083"
								Width:  11.986"
								Width Editable? Yes
								Height: 2.573"
								Height Editable? Yes
							Visible? Yes
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: System Window Color
							View: Table
							Allow Row Sizing? No
							Lines Per Row: Default
						Memory Settings
							Maximum Rows in Memory: Default
							Discardable? No
						Contents
						Functions
							Function: GetFirstEditableColumn
								Description: Получить первую редактируюмую колонку
								Returns
									Window Handle:
								Parameters
									Window Handle: hWndTbl
								Static Variables
								Local variables
									Number: nCol
									Window Handle: hWndCol
								Actions
									Set nCol=1
									Loop
										Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol, COL_GetPos)
										If hWndCol=hWndNULL
											Break
										If SalTblQueryColumnFlags(hWndCol, COL_Editable) AND
												SalIsWindowVisible(hWndCol)
											Break
										Set nCol=nCol+1
									Return hWndCol
						Window Variables
							Window Handle: hCol
							!
							: cCstTab1
								Class: cABSTab
							: cMain
								Class: cABSConnect
							: cF
								Class: cGenFilter
							: cQ
								Class: cGenQuery
							String: strDSql
						Message Actions
							On UM_Create
								If nTabInstance1
									Call cCstTab1.Init(hWndItem, nTabInstance1, GetUserLoginName(), NOT fNoReposition1)
							On UM_Insert
								If NOT SalTblAnyRows(hWndForm, ROW_New, 0)
									Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
								Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
								Set hCol = GetFirstEditableColumn(hWndForm)
								Call SalTblSetContext(hWndForm, nRow)
								Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
							On UM_Delete
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
												not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
									Else
										Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
							On UM_Populate
								If strSqlPopulate != ''
									If fFilterAtStart
										Call SetQueryFilter(cF)
										Set fFilterAtStart = NOT fFilterAtStart
									Call tbl.cQ.Init(strSqlPopulate)
									Call SalWaitCursor(TRUE)
									Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
									Set strDSql = cQ.GetFullSQLString(cF)
									Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
									Call SalTblSetContext(hWndForm, 0)
									Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
									Call SalWaitCursor(FALSE)
							On UM_Update
								Call SalWaitCursor(TRUE)
								Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
								If strSqlDelete != ''
									Call SqlPrepare(cMain.hSql(), T(strSqlDelete))
									Call SalTblDoDeletes(hWndForm, cMain.hSql(), ROW_MarkDeleted)
								If strSqlInsert != ''
									Call SqlPrepare(cMain.hSql(), T(strSqlInsert))
									Call SalTblDoInserts(hWndForm, cMain.hSql(), TRUE)
								If strSqlUpdate != ''
									Call SqlPrepare(cMain.hSql(), T(strSqlUpdate))
									Call SalTblDoUpdates(hWndForm, cMain.hSql(), TRUE)
								Call SqlCommit(cMain.hSql())
								Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
								Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
							On UM_DoubleClick
								Call SalSendMsg(SalParentWindow(hWndForm), UM_DoubleClick, wParam, lParam)
							On SAM_ContextMenu
								If nFlags & GT_ReadOnly
									Call SalTrackPopupMenu(hWndForm, 'popupEditP', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
								Else
									Call SalTrackPopupMenu(hWndForm, 'popupEditF', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
							On SAM_EndCellTab
								Call SalSendMsg(hWndForm, UM_Insert, 0, 0)
								Return TRUE
							On SAM_CaptionDoubleClick
								Call SalTblSortRows(hWndForm,SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), TBL_SortIncreasing)
							On SAM_CornerClick
								If nTabInstance1
									Call SetTblColumnStatus( hWndItem, cCstTab1 )
							On WM_Paint
								Call cCstTab1.MarkTableAsCustomisable(  )
							On SAM_Destroy
								Call cCstTab1.Destructor(  )
							On SAM_TblDoDetails
								Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
					Custom Control: ccSplitter
						Class Child Ref Key: 0
						Class ChildKey: 33
						Class: cXSalHSplitter
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name: XSal2_32.dll
							MS Windows Class Name: XSal:Splitter32
							Style:  0x00000000
							ExStyle:  0x00000000
							Title:
							Window Location and Size
								Left:   Default
								Top:    Default
								Width:  Class Default
								Width Editable? Yes
								Height: Class Default
								Height Editable? Yes
							Visible? Yes
							Border? No
							Etched Border? No
							Hollow? Yes
							Vertical Scroll? No
							Horizontal Scroll? No
							Tab Stop? None
							Tile To Parent? Yes
							Font Name: Arial
							Font Size: 10
							Font Enhancement: Italic
							Text Color: Default
							Background Color: Dark Aqua
							DLL Settings
						Message Actions
					Child Table: tbl2
						Class Child Ref Key: 0
						Class ChildKey: 35
						Class:
						Property Template:
						Class DLL Name:
						Display Settings
							Window Location and Size
								Left:   6.633"
								Top:    0.024"
								Width:  5.5"
								Width Editable? Yes
								Height: 5.0"
								Height Editable? Yes
							Visible? Yes
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							View: Table
							Allow Row Sizing? No
							Lines Per Row: Default
						Memory Settings
							Maximum Rows in Memory: 2000
							Discardable? No
						Contents
						Functions
						Window Variables
							Boolean: bSortOrd
							: cCstTab2
								Class: cABSTab
							String: strSqlPopulate	! Строка SQL SELECT
							String: strSqlInsert	! Строка SQL INSERT
							String: strSqlDelete	! Строка SQL DELETE
							String: strSqlUpdate	! Строка SQL UPDATE
						Message Actions
							On UM_Create
								Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
								If nTabInstance2
									Call cCstTab2.Init(hWndItem, nTabInstance2, GetUserLoginName(), NOT fNoReposition2)
							On UM_Populate
								Call SalWaitCursor(TRUE)
								Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate),TBL_FillAll)
								Call SalWaitCursor(FALSE)
							On SAM_ColumnSelectClick
								Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
								Set bSortOrd = not bSortOrd
								Call SalTblSortRows(tbl2, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
							On SAM_CornerClick
								If nTabInstance2
									Call SetTblColumnStatus( hWndItem, cCstTab2 )
							On SAM_ContextMenu
								Call SalTblQueryFocus( hWndForm, nRow, hWndCol )
								If SalTblQueryRowFlags ( hWndForm, nRow, ROW_Selected )
									Call Fun_SumCol()
								Else
									If nFlags & GT_ReadOnly
										Call SalTrackPopupMenu(hWndForm, 'popupEditP', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
									Else
										Call SalTrackPopupMenu(hWndForm, 'popupEditF', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0, 0)
							On WM_Paint
								Call cCstTab2.MarkTableAsCustomisable(  )
							On SAM_Destroy
								Call cCstTab2.Destructor(  )
				Class Variables
				Instance Variables
					! Параметры класса:
					! NB: описание переменных -- аналогично cGenericTable (см.!)
					Number: nFlags
					String: strSqlPopulate
					String: strSqlInsert
					String: strSqlDelete
					String: strSqlUpdate
					String: strFilterTblName ! Имя основной таблицы для фильтра
					String: strTitleAux
					String: strPrintFileName ! Имя файла печати (без путей)
					Boolean: fFilterAtStart  ! Начинать население таблицы с фильтра
					Number: nTabInstance1    ! Номер варианта таблицы 1 для динамической настройки
					Number: nTabInstance2    ! Номер варианта таблицы 1 для динамической настройки
					Boolean: fNoReposition1  ! Не использовать настройку положения колонок для таб 1
					Boolean: fNoReposition2  ! Не использовать настройку положения колонок для таб 1
					! Внутренние переменные:
					Number: nRow
					String: strOldTitle
					! ! ! Координаты и размер окна
					Number: nWinX
					Number: nWinY
					Number: nWinW
					Number: nWinH
					! ! Для суммирования колонок
					Window Handle: hWndCol
				Functions
					Function: ReturnValue
						Description:
						Returns
							Number: nRes
						Parameters
						Static Variables
						Local variables
						Actions
							Return 999
					Function: ReInitQueryString
						Description: Переинициализировать служебные SQL строки
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							If strSqlPopulate != ''
								Call tbl.cQ.Init(strSqlPopulate)
					Function: Fun_SumCol
						Description: Сумирует SELECTED колонку
						Returns
						Parameters
						Static Variables
						Local variables
							Window Handle: hWndCol
							String: strTitle
							String: strSuma
							Number: nX
							Number: nY
							Number: nW
							Number: nH
						Actions
							Call GetWindowRect( hWndForm, nX, nY, nW, nH )
							Call SalTblObjectsFromPoint( hWndForm, wParam-nX, lParam-nY, nH, hWndCol, nH )
							Set strTitle=PadR(' ',100  )
							Call SalTblGetColumnTitle ( hWndCol, strTitle, 100 )
							If SalIsValidNumber( hWndCol )
								Set nH=SalTblColumnSum( hWndForm, SalTblQueryColumnID( hWndCol ), ROW_Selected, 0 )
								If nH
									Set strTitle=SalStrTrimX(strTitle)
									Set strSuma=SalStrTrimX(SalFmtFormatNumber ( nH, 'Default' ))
									Set nH = SalNumberMax( SalStrLength( strTitle ), SalStrLength( strSuma ) )
									Call XSalTooltipSetColors( COLOR_Black, COLOR_Yellow )
									Call XSalTooltipShow( hWndForm, strTitle ||PutLf()||PadL(strSuma,nH))
									Call XSalTooltipSetColors( COLOR_Black, COLOR_White )
				Message Actions
					On UM_Create
						Call SalWaitCursor(TRUE)
						Call XConnectGetParams(tbl.cMain)
						If NOT tbl.cMain.Connect()
							Call SalWaitCursor(FALSE)
							Call SalDestroyWindow(hWndForm)
						!
						Call XSalTooltipSetUserDefault()
						Call SaveInfoToLog(MSG_Invoke() || strTitleAux)
						If strTitleAux != ''
							Call SalGetWindowText(hWndForm, strOldTitle, 256)
							Call SalSetWindowText(hWndForm, strOldTitle || ': [' || strTitleAux || ']')
						!
						If strFilterTblName != ''
							Call tbl.cF.Init(strFilterTblName, strFilterTblName)
						Else
							Call SalDisableWindow(pbFilter)
						!
						If nFlags & GT_NoIns
							Call SalDisableWindow(pbIns)
						If nFlags & GT_NoDel
							Call SalDisableWindow(pbDel)
						If nFlags & GT_NoUpd
							Call SalDisableWindow(pbUpdate)
						Call ccSplitter.setBarPosition( 500 )
						Call ccSplitter.setTopFrame( tbl )
						Call ccSplitter.setBottomFrame( tbl2 )
					On SAM_CreateComplete
						Call SalWaitCursor(FALSE)
						If strFilterTblName
							Call SalSendMsg(pbFilter, SAM_Click, 0, 0)
						Else
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
					On UM_DoubleClick
					On UM_Print
						If strPrintFileName
							Call SalGetWindowText(tbl, strOldTitle, 100)
							Call TablePrint(tbl, strOldTitle, GetPrnDir() || '\\' || strPrintFileName, '')
					On UM_Search
						Call TblFindString(tbl,  DFIND_First)
					On UM_Close
						If SalTblAnyRows(tbl, ROW_Edited | ROW_MarkDeleted | ROW_New, 0)
							Call SalMessageBeep(MB_IconQuestion)
							If SalMessageBox('В таблице присутсвуют несохраненные изменения. Игнорировать их?',
									'Внимание!', MB_IconQuestion | MB_YesNo) != IDYES
								Return FALSE
						Call SalDestroyWindow(hWndForm)
					On SAM_Destroy
						If tbl.cMain.IsConnected()
							Call tbl.cMain.Disconnect()
						Call SaveInfoToLog('Выход из диалога: ' || strTitleAux)
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_StrId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Dialog Box: dlg_DV
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Додавання рахуків 9 к.
		Accesories Enabled? Class Default
		Visible? No
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: 4.881"
				Height Editable? Class Default
			Absolute Screen Location? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nValue=TBL_MinRow
							Set sMDate_DV = SalNumberToStrX(dMDate,0)
							If Len( sMDate_DV ) = 1
								Set sMDate_DV = "0"||SalNumberToStrX(dMDate,0)
							Set sYins_DV = SalStrTrimX( SalNumberToStrX(nYins_DV,0))
							While SalTblFindNextRow(dlg_DV.tbl, nValue,4, 0 )
								Call SalTblSetFocusRow(dlg_DV.tbl, nValue )
								If SqlPLSQLCommand( hSql(), " 
										PIU_MONTH_OST( dlg_DV.tbl.ACC , sMDate_DV ,sYins_DV )" )
									Call SqlCommit( hSql() )
								Else
									Call SqlRollback( hSql() )
							Call SalSendClassMessage( SAM_Click, wParam, lParam )
							Set bRefrech = TRUE
				Line
					Resource Id: 53354
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53355
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.017"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53356
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  1.867"
						Begin Y:  Class Default
						End X:  1.867"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbIn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cpbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.05"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\4.bmp
					Picture Transparent Color: Magenta
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nRow=TBL_MinRow
							While SalTblFindNextRow( dlg_DV.tbl, nRow, 2, 0 )
								Call SalTblSetRowFlags( dlg_DV.tbl, nRow, ROW_Edited, TRUE )
				Pushbutton: pbNo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cpbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.5"
						Top:    0.05"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\5.bmp
					Picture Transparent Color: Magenta
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nRow=TBL_MinRow
							While SalTblFindNextRow( dlg_DV.tbl, nRow, 2, 0 )
								Call SalTblSetRowFlags( dlg_DV.tbl, nRow, ROW_Edited, FALSE )
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Владелец
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.733"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.933"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? Yes
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblPopulate(dlg_DV.tbl, hSql(), T(dlg_DV.strSqlPopulate), TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Set dlg_DV.strSqlPopulate="select a.nls,t.nr,a.acc
								from accounts a ,tl_terra_2003 t,params p, month_ost_g m
								where a.acc not in (select acc 
								                                     from MONTH_OST 
								                                  where cnt in (0,1) and SUBSTR(MDAT,3) = :dYDate) and
								      t.ID_KEY= substr(a.nls,12,14) and p.par='KOBL_412' and t.obl=p.val  and 
								      a.nls like m.nbs||'_'||m.sim||'%' and  m.id=:nGrp and a.nbs=m.nbs and a.dazs is null    
								order by a.nls
								INTO :dlg_DV.tbl.NLS,:dlg_DV.tbl.Name,:dlg_DV.tbl.ACC  "
						Set nYins_DV = SalStrToNumber( SalStrRightX(GetBankDateEx(  ),4))
		Functions
		Window Parameters
		Window Variables
			Number: nRow
			Number: nYins_DV
			Number: nValue
			String: sMDate_DV
			String: sAcc_DV
			String: sYins_DV
		Message Actions
			On UM_DoubleClick
				Set nRow=SalTblQueryContext( dlg_DV.tbl )
				Call SalTblSetRowFlags( dlg_DV.tbl, nRow, ROW_Edited, TRUE )
	Table Window: frm_DV
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Розгортання помісячного розпису дотації та вилучень
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.302"
				Width:  11.55"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bRefrech = FALSE
							Call SalModalDialog( dlg_DV,hWndNULL )
							If bRefrech = TRUE
								Call SalSendMsg( frm_DV,    UM_Populate, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nValue=TBL_MinRow
							Set sMDate_DV = SalNumberToStrX(dMDate,0)
							! Call Debug('Start')
							If Len( sMDate_DV ) = 1
								Set sMDate_DV = "0"||SalNumberToStrX(dMDate,0)
							! Call Debug('Start sMDate_DV')
							Set sYins = SalStrTrimX( SalNumberToStrX(nYins,0))
							! Call Debug('Start sYins')
							While SalTblFindNextRow(frm_DV, nValue,ROW_Edited, 0 )
								Call SalTblSetFocusRow(frm_DV, nValue )
								! Call Debug('Start SqlPLSQLCommand')
								! Call Debug('Start sMDate_DV='||sMDate_DV)
								! Call Debug('Start sYins='||sYins)
								! Call Debug("
										wp_month_ost_all("||SalNumberToStrX(frm_DV.ACC,0)||",'"||  
										                              sMDate_DV||"','"||
										                              sYins||"',"||
										                              SalNumberToStrX(frm_DV.M00*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.OSTF_N*100,0)||","||
										                              SalNumberToStrX(frm_DV.M01*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M02*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M03*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M04*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M05*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M06*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M07*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M08*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M09*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M10*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M11*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M12*100        ,0)||") ")
								If SqlPLSQLCommand( hSql(), "
										wp_month_ost_all("||SalNumberToStrX(frm_DV.ACC,0)||",'"||  
										                              sMDate_DV||"','"||
										                              sYins||"',"||
										                              SalNumberToStrX(frm_DV.M00*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.OSTF_N*100,0)||","||
										                              SalNumberToStrX(frm_DV.M01*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M02*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M03*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M04*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M05*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M06*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M07*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M08*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M09*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M10*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M11*100        ,0)||","||
										                              SalNumberToStrX(frm_DV.M12*100        ,0)||") ")
									Call SqlCommit( hSql() )
									Call SalTblSetRowFlags( frm_DV, nRow, 0, TRUE )
									! Call Debug('commit SqlPLSQLCommand')
								Else
									Call SqlRollback( hSql() )
								! Call Debug('Finish SqlPLSQLCommand')
							Call SalSendClassMessage( SAM_Click, wParam, lParam )
				Line
					Resource Id: 53357
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.65"
						Begin Y:  Class Default
						End X:  3.65"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.45"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53358
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.983"
						Begin Y:  Class Default
						End X:  2.983"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.117"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53359
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Combo Box: cmbGroups
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.783"
						Top:    0.09"
						Width:  5.4"
						Width Editable? Class Default
						Height: 3.202"
						Height Editable? Class Default
					Visible? Class Default
					Editable? No
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbGroups.Init( hWndItem )
								Call cmbGroups.Populate( hSql(), 'id', 'name', 'month_ost_g', 'ORDER BY name' )
								Call cmbGroups.SetSelectById( nGrp )
						On SAM_Click
							Call SalSendClassMessage( SAM_Click, 0, 0 )
							Set nGrp=cmbGroups.nCurrentId
							Call SalSendMsg( frm_DV, UM_Populate, 0, 0 )
							If not (SalStrLeftX(sFlags,1) = '0')
								Call SalEnableWindow( pbIns )
								Call SalEnableWindow( pbDel )
								Call SalEnableWindow( pbUpdate )
						On VTM_KeyDown
							If wParam = VK_F12 and not (SalStrLeftX(sFlags,1) = '0')
								Set nAltStatus = VisGetKeyState( VK_Alt )
								Set nCtlStatus = VisGetKeyState( VK_Control )
								If (nAltStatus & KS_Down) AND (nCtlStatus & KS_Down)
									Call SalModalDialog( dlg_Month_Ost_G,hWndNULL )
									Call SalSendMsg( frm_DV.cmbGroups,    SAM_Create, 0, 0 )
		Contents
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? Yes
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Name
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Владелец
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Месячный
						Остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OstY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Годовой 
						Остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: M00
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ГОД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						дотации
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTF_N
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма погаш.
						остатка дот.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If (OSTF_N > OSTF)
							Call SalMessageBox('Сумма превышает сумму недовыданной дотации !!!','Дотация ... ', MB_Ok)
							Return VALIDATE_Cancel
						Else
							If (OSTF_N < 0)
								Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
								Return VALIDATE_Cancel
							Else
								Return VALIDATE_Ok
			Column: M01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЯНВАРЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M01 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФЕВРАЛЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M02 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МАРТ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M03 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: АПРЕЛЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M04 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МАЙ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M05 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ИЮНЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M06 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ИЮЛЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M07 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: АВГУСТ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M08 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: СЕНТЯБРЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M09 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКТЯБРЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M10 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НОЯБРЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M11 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: M12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ДЕКАБРЬ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						Set M00=(M01+M02+M03+M04+M05+M06+M07+M08+M09+M10+M11+M12)
					! On SAM_Validate
						                                                                                                                                                                                                         If (M12 < 0)
							                                                                                                                                                                                                         Call SalMessageBox( 'Сумма меньше нуля !!!', 'Дотация ... ', MB_Ok )
							                                                                                                                                                                                                         Return VALIDATE_Cancel
						                                                                                                                                                                                                         Else 
							                                                                                                                                                                                                         Return VALIDATE_Ok
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MON
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: sumColumn
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalTblDefineSplitWindow(hWndForm, 1,TBL_Split_Adjustable)
					Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					!
					Set frm_DV.NLS = "Всего :"
					Set frm_DV.OST=iOST
					Set frm_DV.OSTF=iOSTF
					Set frm_DV.OstY=iOSTY
					Set frm_DV.M00=iM00
					Set frm_DV.M01=iM01
					Set frm_DV.M02=iM02
					Set frm_DV.M03=iM03
					Set frm_DV.M04=iM04
					Set frm_DV.M05=iM05
					Set frm_DV.M06=iM06
					Set frm_DV.M07=iM07
					Set frm_DV.M08=iM08
					Set frm_DV.M09=iM09
					Set frm_DV.M10=iM10
					Set frm_DV.M11=iM11
					Set frm_DV.M12=iM12
		Window Parameters
			Number: nPar     ! не исп
			String: sFlags   ! 0-(RO/RW)
			String: sFilt    ! не исп
		Window Variables
			String: dYDate_DV
			String: sDisableColumn
			Number: nYins
			Number: nValue
			Number: nValueSum
			String: strPopulate
			! String: strPrintFileName
			Number: nValueY
			Number: nAltStatus
			Number: nCtlStatus
			Number: nRow
			String: sMDate_DV
			String: sYins
			! cListStringId: cQ
.winattr class :
				Class: cListStringId
.end
			Number: iOST
			Number: iOSTF
			Number: iOSTY
			Number: iM00
			Number: iM01
			Number: iM02
			Number: iM03
			Number: iM04
			Number: iM05
			Number: iM06
			Number: iM07
			Number: iM08
			Number: iM09
			Number: iM10
			Number: iM11
			Number: iM12
		Message Actions
			On SAM_Create
				Set strFilterTblName='MONTH_OST_VIEW'
				Set nValue=0
				Set frm_DV.nTabInstance = 1
				Set frm_DV.nFlags=GT_NoRet | GT_NoIns | GT_NoUpd | GT_NoDel
				Call SalTblSetLockedColumns(hWndForm, 4)
				Set fFilterAtStart=FALSE
				Set frm_DV.strPrintFileName = 'month.txt'
				Call PrepareWindow(hWndForm)
				Set dYDate_DV=SalNumberToStrX( SalDateYear( GetBankDate()),0)
				Call SalCenterWindow( frm_DV )
				Call SalTblSetTableFlags( frm_DV, TBL_Flag_SizableCols, TRUE )
				Call SalTblSetTableFlags( hWndForm, TBL_Flag_SelectableCols, FALSE )
				Set dMDate=1
				Set dYDate_DV =  GetBankDateEx(  )
				Set nYins = SalStrToNumber( SalStrRightX(dYDate_DV,4))
				Set dYDate = nYins 
				Set dYDate_DV =  SalStrLeftX( dYDate_DV,SalStrScan( dYDate_DV,'/' ) )
				! !
				! Call SalFileGetCurrentDirectory(sCurDir)
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('Bars023', 'DisableColumn', '0', sDisableColumn,GetIniFileName())
				! !
				! If SalStrToNumber( sDisableColumn ) = 0
				While dMDate < SalStrToNumber( dYDate_DV)
					! Call Debug( sDisableColumn)
					If SalStrToNumber( sDisableColumn ) = 0
						Select Case dMDate
							Case 1
								Call SalDisableWindow(frm_DV.M01)
								Break
							Case 2
								Call SalDisableWindow(frm_DV.M02)
								Break
							Case 3
								Call SalDisableWindow(frm_DV.M03)
								Break
							Case 4
								Call SalDisableWindow(frm_DV.M04)
								Break
							Case 5
								Call SalDisableWindow(frm_DV.M05)
								Break
							Case 6
								Call SalDisableWindow(frm_DV.M06)
								Break
							Case 7
								Call SalDisableWindow(frm_DV.M07)
								Break
							Case 8
								Call SalDisableWindow(frm_DV.M08)
								Break
							Case 9
								Call SalDisableWindow(frm_DV.M09)
								Break
							Case 10
								Call SalDisableWindow(frm_DV.M10)
								Break
							Case 11
								Call SalDisableWindow(frm_DV.M11)
								Break
							Case 12
								Call SalDisableWindow(frm_DV.M12)
								Break
					Set dMDate=dMDate+1
				Call SalFontSet(M01, GetFontName(GetFontTables()), GetFontSize(GetFontTables()), FONT_EnhBold)
				!
				! Call SalDisableWindow( pbUpdate )
				! Call SalDisableWindow( pbIns )
				! Call SalDisableWindow( pbDel )
				! Call SalDisableWindow( pbUpdate )
				! Call SalDisableWindow( pbFull )
				Set frm_DV.strSqlDelete='update MONTH_OST set cnt=cnt+2 where acc = :frm_DV.ACC and SUBSTR(MDAT,3)=:nYins'
				Set frm_DV.strSqlPopulate="select  /*+ INDEX (a XAK_NLS_KV_ACCOUNTS) */
						MONTH_OST_VIEW.nls,MONTH_OST_VIEW.nr,MONTH_OST_VIEW.acc, 
						MONTH_OST_VIEW.ostc/100 ,MONTH_OST_VIEW.ostf/100 ,a.ostc/100 , 
						MONTH_OST_VIEW.m00/100,MONTH_OST_VIEW.m01/100,
						MONTH_OST_VIEW.m02/100,MONTH_OST_VIEW.m03/100,MONTH_OST_VIEW.m04/100,MONTH_OST_VIEW.m05/100,
						MONTH_OST_VIEW.m06/100,MONTH_OST_VIEW.m07/100,MONTH_OST_VIEW.m08/100,MONTH_OST_VIEW.m09/100,
						MONTH_OST_VIEW.m10/100,MONTH_OST_VIEW.m11/100,MONTH_OST_VIEW.m12/100,MONTH_OST_VIEW.MDAT  
						from MONTH_OST_VIEW ,  MONTH_OST_G   ,ACCOUNTS a  
						where MONTH_OST_G.id=:nGrp and   
						MONTH_OST_VIEW.nls like MONTH_OST_G.NBS||'_'||MONTH_OST_G.SIM||'%'   and  
						a.nls like MONTH_OST_G.NBSD||'_'||MONTH_OST_G.SIM||substr(MONTH_OST_VIEW.nls,9)  and  
						MONTH_OST_VIEW.ydat = :dYDate  
						order by MONTH_OST_VIEW.nls  
						INTO :frm_DV.NLS,:frm_DV.Name,:frm_DV.ACC, :frm_DV.OST, :frm_DV.OSTF, :frm_DV.OstY, :frm_DV.M00, :frm_DV.M01,
						:frm_DV.M02, :frm_DV.M03, :frm_DV.M04, :frm_DV.M05, :frm_DV.M06, :frm_DV.M07, :frm_DV.M08,
						:frm_DV.M09, :frm_DV.M10, :frm_DV.M11, :frm_DV.M12, :frm_DV.MON  "
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_Destroy
				Set nGrp = -1
			On SAM_FetchRowDone
				Set nRow=SalTblQueryContext( frm_DV )
				If dMDate>=1
					If dMDate=1
						If frm_DV.MON >= dMDate
							Call SalColorSet( M01, 100, COLOR_Blue)
						Else
							Call SalColorSet( M01, 100, COLOR_Red)
							If frm_DV.M01 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M01, 100, COLOR_Gray )
				If dMDate>=2
					If dMDate=2
						If frm_DV.MON >= dMDate
							Call SalColorSet( M02, 100, COLOR_Blue)
						Else
							Call SalColorSet( M02, 100, COLOR_Red)
							If frm_DV.M02 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M02, 100, COLOR_Gray )
				If dMDate>=3
					If dMDate=3
						If frm_DV.MON >= dMDate
							Call SalColorSet( M03, 100, COLOR_Blue)
						Else
							Call SalColorSet( M03, 100, COLOR_Red)
							If frm_DV.M03 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M03, 100, COLOR_Gray )
				If dMDate>=4
					If dMDate=4
						If frm_DV.MON >= dMDate
							Call SalColorSet( M04, 100, COLOR_Blue)
						Else
							Call SalColorSet( M04, 100, COLOR_Red)
							If frm_DV.M04 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M04, 100, COLOR_Gray )
				If dMDate>=5
					If dMDate=5
						If frm_DV.MON >= dMDate
							Call SalColorSet( M05, 100, COLOR_Blue)
						Else
							Call SalColorSet( M05, 100, COLOR_Red)
							If frm_DV.M05 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M05, 100, COLOR_Gray )
				If dMDate>=6
					If dMDate=6
						If frm_DV.MON >= dMDate
							Call SalColorSet( M06, 100, COLOR_Blue)
						Else
							Call SalColorSet( M06, 100, COLOR_Red)
							If frm_DV.M06 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M06, 100, COLOR_Gray )
				If dMDate>=7
					If dMDate=7
						If frm_DV.MON >= dMDate
							Call SalColorSet( M07, 100, COLOR_Blue)
						Else
							Call SalColorSet( M07, 100, COLOR_Red)
							If frm_DV.M07 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M07, 100, COLOR_Gray )
				If dMDate>=8
					If dMDate=8
						If frm_DV.MON >= dMDate
							Call SalColorSet( M08, 100, COLOR_Blue)
						Else
							Call SalColorSet( M08, 100, COLOR_Red)
							If frm_DV.M08 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M08, 100, COLOR_Gray )
				If dMDate>=9
					If dMDate=9
						If frm_DV.MON >= dMDate
							Call SalColorSet( M09, 100, COLOR_Blue)
						Else
							Call SalColorSet( M09, 100, COLOR_Red)
							If frm_DV.M09 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M09, 100, COLOR_Gray )
				If dMDate>=10
					If dMDate=10
						If frm_DV.MON >= dMDate
							Call SalColorSet( M10, 100, COLOR_Blue)
						Else
							Call SalColorSet( M10, 100, COLOR_Red)
							If frm_DV.M10 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M10, 100, COLOR_Gray )
				If dMDate>=11
					If dMDate=11
						If frm_DV.MON >= dMDate
							Call SalColorSet( M11, 100, COLOR_Blue)
						Else
							Call SalColorSet( M11, 100, COLOR_Red)
							If frm_DV.M11 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M11, 100, COLOR_Gray )
				If dMDate>=12
					If dMDate=12
						If frm_DV.MON >= dMDate
							Call SalColorSet( M12, 100, COLOR_Blue)
						Else
							Call SalColorSet( M12, 100, COLOR_Red)
							If frm_DV.M12 != 0
								Call SalTblSetRowFlags( frm_DV, nRow, ROW_Edited, TRUE )
					Else
						Call SalColorSet( M12, 100, COLOR_Gray )
				Set iOST=iOST+OST
				Set iOSTF=iOSTF+OSTF
				Set iOSTY=iOSTY+OstY
				Set iM00=iM00+M00
				Set iM01=iM01+M01
				Set iM02=iM02+M02
				Set iM03=iM03+M03
				Set iM04=iM04+M04
				Set iM05=iM05+M05
				Set iM06=iM06+M06
				Set iM07=iM07+M07
				Set iM08=iM08+M08
				Set iM09=iM09+M09
				Set iM10=iM10+M10
				Set iM11=iM11+M11
				Set iM12=iM12+M12
			On UM_Populate
				Set iOST=0
				Set iOSTF=0
				Set iOSTY=0
				Set iM00=0
				Set iM01=0
				Set iM02=0
				Set iM03=0
				Set iM04=0
				Set iM05=0
				Set iM06=0
				Set iM07=0
				Set iM08=0
				Set iM09=0
				Set iM10=0
				Set iM11=0
				Set iM12=0
				Call SalSendClassMessage( UM_Populate, 0, 0 )
				Call sumColumn()
				If nGrp >= 0 
					Call SalWaitCursor(TRUE)
					! Call SalTblPopulate(hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll)
					Call cQ.Init( frm_DV.strSqlPopulate )
					Call SalWaitCursor(FALSE)
	Dialog Box: dlg_Month_Ost_G
		Class: cGenericTableDlg
		Property Template:
		Class DLL Name:
		Title: Группы отбора счетов ...
		Accesories Enabled? Class Default
		Visible? No
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Type of Dialog: Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.6"
				Width Editable? Class Default
				Height: 4.881"
				Height Editable? Class Default
			Absolute Screen Location? No
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 11
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 12
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40833
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 13
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40834
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbOk
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableDlg
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.017"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40835
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableDlg
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tbl
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cGenericTableDlg
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colid
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNbs
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: NBS
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 4
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSim
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Символ
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNbsd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: NBS год.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 4
						Data Type: String
						Justify: Left
						Width:  1.217"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNBS3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: NBS 3 класс
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colISNBS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Контроль
								по счету года
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKOEF
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Коэф.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colCompress
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сворачивать
								остатки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblPopulate(dlg_Month_Ost_G.tbl, hSql(), T(dlg_Month_Ost_G.strSqlPopulate), TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Set dlg_Month_Ost_G.nTabInstance = 1
						Set dlg_Month_Ost_G.strSqlPopulate="select ID, NAME, NBS, SIM, NBSD, NBS3, ISNBS, KOEF, isCompress  
								  from MONTH_OST_G
								INTO :dlg_Month_Ost_G.tbl.colid,:dlg_Month_Ost_G.tbl.colName,:dlg_Month_Ost_G.tbl.colNbs,
								          :dlg_Month_Ost_G.tbl.colSim,:dlg_Month_Ost_G.tbl.colNbsd,
								          :dlg_Month_Ost_G.tbl.colNBS3,:dlg_Month_Ost_G.tbl.colISNBS,:dlg_Month_Ost_G.tbl.colKOEF,
								          :dlg_Month_Ost_G.tbl.colCompress"
						Set dlg_Month_Ost_G.strSqlInsert='insert into MONTH_OST_G ( name, nbs, sim, nbsd, NBS3, ISNBS, KOEF, isCompress)  
								 values ( :dlg_Month_Ost_G.tbl.colName,:dlg_Month_Ost_G.tbl.colNbs,
								                :dlg_Month_Ost_G.tbl.colSim,:dlg_Month_Ost_G.tbl.colNbsd,
								                :dlg_Month_Ost_G.tbl.colNBS3,:dlg_Month_Ost_G.tbl.colISNBS,:dlg_Month_Ost_G.tbl.colKOEF,
								                :dlg_Month_Ost_G.tbl.colCompress)'
						Set dlg_Month_Ost_G.strSqlUpdate='update MONTH_OST_G set 
								name = :dlg_Month_Ost_G.tbl.colName,
								nbs = :dlg_Month_Ost_G.tbl.colNbs,
								sim = :dlg_Month_Ost_G.tbl.colSim,
								nbsd = :dlg_Month_Ost_G.tbl.colNbsd ,
								NBS3 = :dlg_Month_Ost_G.tbl.colNBS3,
								ISNBS = :dlg_Month_Ost_G.tbl.colISNBS,
								KOEF = :dlg_Month_Ost_G.tbl.colKOEF,
								isCompress = :dlg_Month_Ost_G.tbl.colCompress  
								where id = :dlg_Month_Ost_G.tbl.colid '
						Set dlg_Month_Ost_G.strSqlDelete='delete fRom MONTH_OST_G 
								 where id=:dlg_Month_Ost_G.tbl.colid'
					On SAM_ColumnSelectClick
					On SAM_EndCellTab
					On UM_DoubleClick
		Functions
		Window Parameters
		Window Variables
		Message Actions
	Form Window: splPlanDoh   ! 02 - Планові показники по доходах
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Планові показники по доходах МБ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.302"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl2, UM_Insert, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl2, UM_Delete, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl2, UM_Update, 0, 0)
							! Call SalSendMsg(pbRun,SAM_Click, 0, 0)
				Line
					Resource Id: 6463
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call SalHideWindow(hWndItem)
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(tbl2, UM_DoubleClick, 0, 0)
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set sFilNem='PL'||IifS( nPar=1,'DB','MB' )||SalFmtFormatDateTime(GetBankDate(),'ddMM')||'.'||tbl.colId_Key
							Call TablePrint(tbl2, 'Планові показники по доходах '||IifS( nPar=1,'ДБ','МБ' ),GetPrnDir() ||'\\'||sFilNem,'')
				Line
					Resource Id: 6464
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.983"
						Begin Y:  0.405"
						End X:  3.983"
						End Y:  -0.012"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 6465
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  4.583"
						Begin Y:  0.405"
						End X:  4.583"
						End Y:  -0.012"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbImport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.086"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_DOWN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Імпорт файлів з МінФін'
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 0)
							Call SalSendMsg(pbRefresh,SAM_Click, 0, 0)
				Custom Control: ccProgressBar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cMeter
					Property Template:
					Class DLL Name:
					Display Settings
						DLL Name:
						MS Windows Class Name:
						Style:  Class Default
						ExStyle:  Class Default
						Title:
						Window Location and Size
							Left:   8.986"
							Top:    0.071"
							Width:  3.983"
							Width Editable? Class Default
							Height: 0.25"
							Height Editable? Class Default
						Visible? Yes
						Border? Class Default
						Etched Border? Class Default
						Hollow? Class Default
						Vertical Scroll? Class Default
						Horizontal Scroll? Class Default
						Tab Stop? Class Default
						Tile To Parent? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Dark Blue
						Background Color: 3D Face Color
						DLL Settings
					Message Actions
						On SAM_Create
							Call SalSetFocus( hWndItem )
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.086"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: F12
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call MakePayments()
							Call SalSendMsg(pbRefresh,SAM_Click, 0, 0)
						On SAM_Create
							Set strTip = 'Виконати проведення по рахунках'
				Line
					Resource Id: 39344
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  8.786"
						Begin Y:  0.405"
						End X:  8.786"
						End Y:  -0.012"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbPreView
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд файлу друку'
							! Set strTip = CurrentLangTable.GetAtomTitle('tblAcrInt.cBTipPreView')
							Call SalDisableWindow( hWndItem )
						On SAM_Click
							! Call DirectView(sFilNem)
							If (SalStrScan( sFilNem ,  '.rtf' )!= -1)         !!== RTF format
								If (   SalLoadApp(GetEditorPath(), sFilNem  )   = FALSE     )
									! Call SalMessageBox('Не удалось загрузить приложение SalLoadApp : GetEditorPath()','Внимание',0)
									Call SalMessageBox('Не вдалось загрузити програму SalLoadApp :'|| GetEditorPath(),'Увага!',0)
							Else !!== TXT format
								Call DirectView(sFilNem)
				Pushbutton: pbReport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Logfile.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Cформувати відомість'
							! Set strTip = CurrentLangTable.GetAtomTitle('tblAcrInt.cBTipReport')
						On SAM_Click
							If nPar=1
								Set strBind='G1,G2,KKD,NAME,S1,S2'
								Set sFilNem=GetPrnDir()||'\\ROZR'||SalFmtFormatDateTime(GetBankDate(),'ddMM')||'.'||tbl.colId_Key||'.rtf'
								Set sQrpNem='dku_928.qrp'
							Else
								Set strBind='KTK,GR,S230,KKD,KVK,S1,S2,S3,S4'
								Set sFilNem=GetPrnDir()||'\\P412'||SalFmtFormatDateTime(GetBankDate(),'ddMM')||'.'||tbl.colId_Key
								Set sQrpNem='BARS023.QRP'
							Call SalWaitCursor( TRUE )
							Call SalStatusSetText ( hWndForm, sFilNem )
							Set nInd=0
							Call SalReportPrintToFile( hWndForm,
									     GetTemplateDir() || '\\' || sQrpNem,
									     sFilNem, strBind, strBind, 1, RPT_PrintAll, 1, 1, IifN(nPar=1,TRUE,FALSE), nInd )
							If nInd>4
								Call SalMessageBox( 'Ошибка '||SalNumberToStrX( nInd, 0 )||' при формировании отчета', 'Внимание', MB_IconExclamation )
							! Call zarez12(sFilNem, 90, 'sDeviceDef')
							Call SalWaitCursor( FALSE)
							Call SalStatusSetText ( hWndForm, 'Готово' )
							Call SalEnableWindow( pbPrint )
							Call SalEnableWindow( pbPreView )
				Option Button: obTotal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\CHILDS.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							If nPar=1
								Call SalHideWindow(hWndItem)
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, IifS(obTotal, 'З підлеглими терр.', 'Без підлеглих терр.'))
						On UM_NoFontChange
							Return TRUE
				Line
					Resource Id: 15005
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  6.286"
						Begin Y:  0.406"
						End X:  6.286"
						End Y:  -0.01"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ЗФ /
					Window Location and Size
						Left:   6.386"
						Top:    0.073"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
				Check Box: cb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: СФ
					Window Location and Size
						Left:   7.186"
						Top:    0.073"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
				Line
					Resource Id: 15006
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  7.986"
						Begin Y:  0.406"
						End X:  7.986"
						End Y:  -0.01"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    1.75"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: colId_Key
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ключ
						Visible? Class Default
						Editable? No
						Maximum Data Length: 3
						Data Type: Class Default
						Justify: Class Default
						Width:  0.717"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKtk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								території
						Visible? Class Default
						Editable? No
						Maximum Data Length: 8
						Data Type: Class Default
						Justify: Center
						Width:  1.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  8.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlPopulate
					Number: nRow
				Message Actions
					On UM_Populate
						Set strSqlPopulate=
								     "SELECT id_key,idt,name
								        INTO :colId_Key, :colKtk, :colName
								        FROM ktk WHERE id_key IS NOT NULL       
								    ORDER BY id_key"
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate),TBL_FillAll)
						Set nRow = VisTblFindString (tbl, 0, colId_Key, sId_Key)
						If nRow=-1
							Call SalTblSetContext( hWndForm, 0 )
						Else
							Call SalTblSetContext( hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( hWndForm, nRow )
						Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
					On SAM_KillFocus
						! Set hWndLost=hWndForm
						Set sId_Key=colId_Key
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: colKkd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: КЕКД
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colGr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Фо
								нд
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: 2
						Data Type: Class Default
						Justify: Center
						Width:  0.433"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: За
								рік
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS01
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Січень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS02
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Лютий
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS03
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Березень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS04
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Квітень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS05
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Травень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS06
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Червень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS07
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Липень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS08
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Серпень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS09
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вересень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS10
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Жовтень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS11
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Листопад
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS12
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Грудень
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKkdN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: 1024
						Data Type: Class Default
						Justify: Left
						Width:  0.433"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRowId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlPopulate	! Строка SQL SELECT
					String: strSqlInsert	! Строка SQL INSERT
					String: strSqlDelete	! Строка SQL DELETE
					String: strSqlUpdate	! Строка SQL UPDATE
					String: strTitleAux
					Window Handle: hCol
					: cMain
						Class: cABSConnect
					Number: nRow
					Number: nS
					Number: nS01
					Number: nS02
					Number: nS03
					Number: nS04
					Number: nS05
					Number: nS06
					Number: nS07
					Number: nS08
					Number: nS09
					Number: nS10
					Number: nS11
					Number: nS12
				Message Actions
					On UM_Populate
						If nPar=1
							Set strSqlPopulate=
									     "SELECT p.kkd,p.gr,p.s,p.s01,p.s02,p.s03,p.s04,p.s05,p.s06,p.s07,p.s08,p.s09,p.s10,p.s11,p.s12,SUBSTR(b.name,1,254),p.ROWID
									        INTO :colKkd,:colGr,:colS,:colS01,:colS02,:colS03,:colS04,:colS05,:colS06,:colS07,:colS08,:colS09,:colS10,:colS11,:colS12,:colKkdN,:colRowId
									        FROM plan_DB p,kkd_minfin b 
									       WHERE p.kkd=b.kkd            
									         AND p.id_key=:tbl.colId_Key "||
									      IifS( cb1 & cb2,' and p.gr IN (1,2) ',IifS(cb1,' and p.gr=1','')||IifS(cb2,' and p.gr=2',''))||   
									     " ORDER BY p.kkd"
						Else
							! Set strSqlPopulate=
									     "SELECT p.kkd,p.gr,p.s/100,p.s01/100,p.s02/100,p.s03/100,p.s04/100,p.s05/100,p.s06/100,p.s07/100,p.s08/100,p.s09/100,p.s10/100,p.s11/100,p.s12/100,SUBSTR(b.name_kkd,1,254),p.ROWID
									        INTO :colKkd,:colGr,:colS,:colS01,:colS02,:colS03,:colS04,:colS05,:colS06,:colS07,:colS08,:colS09,:colS10,:colS11,:colS12,:colKkdN,:colRowId
									        FROM plan_MB p,budj b 
									       WHERE p.kkd=b.kkd and
									             b.nbs=( CASE WHEN p.gr=1 THEN '3141'ELSE '3151' END )
									         AND p.id_key=:tbl.colId_Key "||
									      IifS( cb1 & cb2,' and p.gr IN (1,2) ',IifS(cb1,' and p.gr=1','')||IifS(cb2,' and p.gr=2',''))||   
									     " ORDER BY p.kkd"
							! Set strSqlPopulate=  (До 29-03-2012)
									     "SELECT p.kkd,p.gr,p.s/100,p.s01/100,p.s02/100,p.s03/100,p.s04/100,p.s05/100,p.s06/100,p.s07/100,p.s08/100,p.s09/100,p.s10/100,p.s11/100,p.s12/100,SUBSTR(b.name_kkd,1,254),p.ROWID
									        INTO :colKkd,:colGr,:colS,:colS01,:colS02,:colS03,:colS04,:colS05,:colS06,:colS07,:colS08,:colS09,:colS10,:colS11,:colS12,:colKkdN,:colRowId
									        FROM plan_MB p,budj b 
									       WHERE p.kkd=b.kkd  AND p.id_key=:tbl.colId_Key AND (b.dtzs > :dDat or b.dtzs IS NULL)
									       AND   b.nbs=( CASE WHEN p.gr=1 THEN '3141'ELSE '3151' END )
									       AND
									      (CASE b.ter WHEN '0' THEN  1-SIGN(INSTR(','||NVL(b.OP_TER,'00')||',','"||','||sObl||','||"'))
									                  WHEN '1' THEN    SIGN(INSTR(','||NVL(b.OP_TER,'00')||',','"||','||sObl||','||"'))
									                  WHEN '7' THEN    SIGN(INSTR(','||NVL(b.OP_TER,'00')||',','"||','||sObl||','||"'||p.id_key||','))
									                  ELSE 0 END) > 0 "||
									            IifS( cb1 & cb2,' and p.gr IN (1,2) ',IifS(cb1,' and p.gr=1','')||
									            IifS( cb2,' and p.gr=2',''))||   
									     " ORDER BY p.kkd"
							Set strSqlPopulate=
									     "SELECT p.kkd,p.gr,p.s/100,p.s01/100,p.s02/100,p.s03/100,p.s04/100,p.s05/100,p.s06/100,
									                                p.s07/100,p.s08/100,p.s09/100,p.s10/100,p.s11/100,p.s12/100,
									     (SELECT SUBSTR(name_kkd,1,254) FROM budj WHERE kkd like SUBSTR(p.kkd,1,6)||'__' AND rownum=1), p.ROWID
									        INTO :colKkd,:colGr,:colS,:colS01,:colS02,:colS03,:colS04,:colS05,:colS06,:colS07,:colS08,:colS09,:colS10,:colS11,:colS12,:colKkdN,:colRowId
									        FROM plan_MB p WHERE p.id_key=:tbl.colId_Key "||
									            IifS( cb1 & cb2,' and p.gr IN (1,2) ',IifS(cb1,' and p.gr=1','')||
									            IifS( cb2,' and p.gr=2',''))||   
									     " ORDER BY p.kkd"
						Set nS=0
						Set nS01=0
						Set nS02=0
						Set nS03=0
						Set nS04=0
						Set nS05=0
						Set nS06=0
						Set nS07=0
						Set nS08=0
						Set nS09=0
						Set nS10=0
						Set nS11=0
						Set nS12=0
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate),TBL_FillAll)
						!
						Call SalTblDefineSplitWindow ( hWndForm, 1, TRUE )
						Set nRow=SalTblInsertRow (  hWndForm, TBL_MinRow )
						Call SalTblSetContext ( hWndForm, nRow)
						Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE )
						Set tbl2.colS=nS
						Set tbl2.colS01=nS01
						Set tbl2.colS02=nS02
						Set tbl2.colS03=nS03
						Set tbl2.colS04=nS04
						Set tbl2.colS05=nS05
						Set tbl2.colS06=nS06
						Set tbl2.colS07=nS07
						Set tbl2.colS08=nS08
						Set tbl2.colS09=nS09
						Set tbl2.colS10=nS10
						Set tbl2.colS11=nS11
						Set tbl2.colS12=nS12
						!
						Set nRow = VisTblFindString (tbl2, 0, colKkd, sKkd)
						If nRow=-1
							Call SalTblSetContext( hWndForm, 0 )
						Else
							Call SalTblSetContext( hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( hWndForm, nRow )
						! Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If NOT SalTblAnyRows(hWndForm, ROW_New, 0)
							Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						Set hCol = tbl.GetFirstEditableColumn(hWndForm)
						Call SalTblSetContext(hWndForm, nRow)
						Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					On UM_Update
						Call SalWaitCursor(TRUE)
						Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
						If strSqlDelete != ''
							Call SqlPrepare(tbl.cMain.hSql(), T(strSqlDelete))
							Call SalTblDoDeletes(hWndForm, tbl.cMain.hSql(), ROW_MarkDeleted)
						If strSqlInsert != ''
							Call SqlPrepare(tbl.cMain.hSql(), T(strSqlInsert))
							Call SalTblDoInserts(hWndForm, tbl.cMain.hSql(), TRUE)
						If strSqlUpdate != ''
							Call SqlPrepare(tbl.cMain.hSql(), T(strSqlUpdate))
							Call SalTblDoUpdates(hWndForm, tbl.cMain.hSql(), TRUE)
						Call SqlCommit(tbl.cMain.hSql())
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On SAM_Create
						Set strSqlDelete='DELETE FROM plan_'||IifS(nPar=1,'DB','MB')||' WHERE rowid=:colRowId'
						Set strSqlInsert='INSERT INTO plan_'||IifS(nPar=1,'DB','MB')||
								 ' (id_key,kkd,dat,gr,s,s01,s02,s03,s04,s05,s06,s07,s08,s09,s10,s11,s12) VALUES '||
								 IifS(nPar=1,'(:sId_Key,:colKkd,:dDat,:colGr,:colS,:colS01,:colS02,:colS03,:colS04,:colS05,:colS06,:colS07,:colS08,:colS09,:colS10,:colS11,100*:colS12)',
								             '(:sId_Key,:colKkd,:dDat,:colGr,100*:colS,100*:colS01,100*:colS02,100*:colS03,100*:colS04,100*:colS05,100*:colS06,100*:colS07,100*:colS08,100*:colS09,100*:colS10,100*:colS11,100*:colS12)')
						Set strSqlUpdate='UPDATE plan_'||IifS(nPar=1,'DB','MB')||IifS(nPar=1,
								' SET kkd=:colKkd,dat=:dDat,fn=NULL,gr=:colGr,s=:colS,
								      s01=:colS01,s02=:colS02,s03=:colS03,s04=:colS04,s05=:colS05,s06=:colS06,
								      s07=:colS07,s08=:colS08,s09=:colS09,s10=:colS10,s11=:colS11,s12=:colS12',
								' SET kkd=:colKkd,dat=:dDat,fn=NULL,gr=:colGr,s=100*:colS,
								      s01=100*:colS01,s02=100*:colS02,s03=100*:colS03,s04=100*:colS04,s05=100*:colS05,s06=100*:colS06,
								      s07=100*:colS07,s08=100*:colS08,s09=100*:colS09,s10=100*:colS10,s11=100*:colS11,s12=100*:colS12')||
								' WHERE rowid=:colRowId'
						Call SalSendClassMessage( SAM_Create, 0, 0 )
					On SAM_CreateComplete
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On SAM_KillFocus
						! Set hWndLost=hWndForm
						Set sKkd=colKkd
					On SAM_FetchRowDone
						Set nS=nS+tbl2.colS
						Set nS01=nS01+tbl2.colS01
						Set nS02=nS02+tbl2.colS02
						Set nS03=nS03+tbl2.colS03
						Set nS04=nS04+tbl2.colS04
						Set nS05=nS05+tbl2.colS05
						Set nS06=nS06+tbl2.colS06
						Set nS07=nS07+tbl2.colS07
						Set nS08=nS08+tbl2.colS08
						Set nS09=nS09+tbl2.colS09
						Set nS10=nS10+tbl2.colS10
						Set nS11=nS11+tbl2.colS11
						Set nS12=nS12+tbl2.colS12
						Set nTmp=colS01+colS02+colS03+colS04+colS05+colS06+colS07+colS08+colS09+colS10+colS11+colS12
						If nTmp!=0 and nTmp!=colS
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle) 
					On SAM_RowHeaderClick
						Set nTmp=colS01+colS02+colS03+colS04+colS05+colS06+colS07+colS08+colS09+colS10+colS11+colS12
						If nTmp!=0
							Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
							Call XSalTooltipShow(hWndForm, 'Відхилення: '||Str(colS-nTmp))
							Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
					On UM_DoubleClick
						Call FunNSIEditFFiltered("plan_"||IifS( nPar=1,'dbh','mbh' ), 
								     IifN(SalStrMidX(sFlagI,5,1)='0',2,9999),
								    " id_key='"||splPlanDoh.tbl.colId_Key||"'"||
								   " and kkd='"||splPlanDoh.tbl2.colKkd||"'"||
								    " and gr='"||splPlanDoh.tbl2.colGr||"'"  )
		Functions
			Function: ImportMinFin
				Description: Собственно импорт файла 
				Returns
					Boolean:
				Parameters
					String: strFilePath
					String: strFileName
				Static Variables
				Local variables
					File Handle: hF
					Long String: strBuffer
					!
					String: strHFName
					String: strHMfo
					Number: nHLines
					Boolean: fProcError
					!
					Number: nIterator
					String: strOKPO
					Number: nTgr
					Number: nAct
					Number: nObl
					String: strDt
					String: strKkd
					String: strSum
					String: strFond
					String: strKmis
					String: strNdov
					Long String: strComm
					Date/Time: dDdov
					Number: nKmis
					Number: nSum
					Date/Time: dDt
					String: strId_Key
					String: strBackUpPath
					String: YYMMDD
					File Handle: hFile
					Boolean: bZag
					String: sTmp
				Actions
					If NOT SalFileOpen( hF, strFilePath || strFileName, OF_Read | OF_Text )
						Call SalMessageBeep( MB_IconStop )
						Call SaveErrorToLog( 'Неможливо відкрити файл ' || strFilePath )
						Call SalMessageBox( 'Неможливо відкрити файл ' || strFilePath, 'Помилка', MB_IconStop | MB_Ok )
						Return FALSE
					Call SalWaitCursor(TRUE)
					Call SalStatusSetText ( hWndForm, strFilePath || strFileName )
					Call SalShowWindow(ccProgressBar)
					Set strId_Key=IifS(nPar=1,'001',SalStrRightX(strFileName,3))
					Set bZag=TRUE
					While SalFileGetStr( hF, strBuffer, 2900 )
						Set nIterator   = SalStrToNumber(SalStrTrimX(SalStrLeftX( strBuffer, 32 )))
						If bZag
							Set bZag=FALSE
							If strFileName!=SalStrMidX( strBuffer, 32, 12 )
								Call SalMessageBox( 'Ош. структуры файла '||strFilePath||strFileName, 'Ошибка!', MB_IconStop | MB_Ok )
								Call SalFileClose( hF )
								Call SalHideWindow(ccProgressBar)
								Call SalWaitCursor(FALSE)
								Return FALSE
							Set strHFName=SalStrMidX( strBuffer, 32, 12 )
							Set nHLines=SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 74, 10 )))
						Set strDt   = SalStrMidX( strBuffer, 32, 10 )
						Set dDt=SalFmtFormatStrDateTime(strDt,'dd.MM.yyyy')
						If SalStrLeftX(strFileName,3)='ROC'
							Set strNdov   = '0'
							Set dDdov   = SalFmtFormatStrDateTime('01.01.2004','dd.MM.yyyy')
							Set strKkd   = SalStrTrimX(SalStrMidX( strBuffer, 66, 8 ))
							Set strFond  = SalStrTrimX(SalStrMidX( strBuffer, 80, 2 ))
							Set nKmis  = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 82, 2 )))
							Set nSum   = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 84, 15 )))
						Else If SalStrLeftX(strFileName,3)='RRM' or SalStrLeftX(strFileName,3)='RZD'
							Set strNdov   = SalStrTrimX(SalStrMidX( strBuffer, 47, 15 ))
							Set dDdov   = SalFmtFormatStrDateTime( SalStrTrimX(SalStrMidX( strBuffer, 62, 10 )),'dd.MM.yyyy')
							Set strKkd   = SalStrTrimX(SalStrMidX( strBuffer, 91, 8 ))
							Set strFond  = SalStrTrimX(SalStrMidX( strBuffer, 105, 2 ))
							Set nKmis  = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 107, 2 )))
							Set nSum   = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 109, 15 )))
						Else If SalStrLeftX(strFileName,3)='ROT' 
							Set strNdov   = '0'
							Set dDdov   = SalFmtFormatStrDateTime('01.01.2004','dd.MM.yyyy')
							Set strKkd   = SalStrTrimX(SalStrMidX( strBuffer, 74, 8 ))
							Set strFond  = SalStrTrimX(SalStrMidX( strBuffer, 88, 2 ))
							Set nKmis  = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 90, 2 )))
							Set nSum   = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 92, 15 )))
						Else If SalStrLeftX(strFileName,3)='RZT' or SalStrLeftX(strFileName,3)='RRT'
							Set strNdov   = SalStrTrimX(SalStrMidX( strBuffer, 55, 15 ))
							Set dDdov   = SalFmtFormatStrDateTime( SalStrTrimX(SalStrMidX( strBuffer, 70, 10 )),'dd.MM.yyyy')
							Set strKkd   = SalStrTrimX(SalStrMidX( strBuffer, 99, 8 ))
							Set strFond  = SalStrTrimX(SalStrMidX( strBuffer, 113, 2 ))
							Set nKmis  = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 115, 2 )))
							Set nSum   = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 117, 15 )))
						Else If SalStrLeftX(strFileName,2)='KO' !-- ДБ Стартовий річний або по місяцях
							Set strNdov   = '0'
							Set dDdov   = SalFmtFormatStrDateTime(SalStrMidX( strBuffer, 32, 10 ),'dd.MM.yyyy')
							Set strKkd   = SalStrTrimX(SalStrMidX( strBuffer, 81, 6 ))||'00'
							Set strFond  = SalStrTrimX(SalStrMidX( strBuffer, 102, 1 ))
							Set nKmis  = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 104, 2 )))
							Set sTmp=SalStrMidX( strBuffer,106,15)
							If SalStrScan(sTmp,',')>=0
								Set sTmp=SalStrReplaceX(sTmp,SalStrScan(sTmp,','),1,'.')
							Set nSum   = SalStrToNumber(SalStrTrimX(sTmp))
							Set strComm   = ''
						Else If SalStrLeftX(strFileName,2)='KZ' !-- ДБ Стартовий річний або по місяцях
							Set strNdov   = SalStrTrimX(SalStrMidX( strBuffer, 45, 10 ))
							Set dDdov   = SalFmtFormatStrDateTime(SalStrMidX( strBuffer, 60, 8 ),'ddMMyyyy')
							Set strKkd   = SalStrTrimX(SalStrMidX( strBuffer, 81, 6 ))||'00'
							Set strFond  = SalStrTrimX(SalStrMidX( strBuffer, 102, 1 ))
							Set nKmis  = SalStrToNumber(SalStrTrimX(SalStrMidX( strBuffer, 104, 2 )))
							Set sTmp=SalStrMidX( strBuffer,106,15)
							If SalStrScan(sTmp,',')>=0
								Set sTmp=SalStrReplaceX(sTmp,SalStrScan(sTmp,','),1,'.')
							Set nSum   = SalStrToNumber(SalStrTrimX(sTmp))   !--*100000
							Set strComm   = SalStrTrimX(SalStrMidX( strBuffer, 144, 512 ))
						Else
							Set strKkd  = ''
						If strKkd and nIterator>5 and (strFond='1' or strFond='2')
							If not SqlPLSQLCommand(hSql(),'in_doh'||IifS(nPar=1,'DB','MB')||'(strFileName,dDt,dDdov,strNdov,strId_Key,strKkd,strFond,nKmis,nSum'||IifS(nPar=1,',strComm','')||')')
								Call SqlRollback(hSql())
								Break
						Call ccProgressBar.SetProgress( nIterator / nHLines * 100)
					Call SqlCommitEx( hSql(), 'Імпорт файлу ' || strFilePath || strFileName || ' завершено' )
					Call SalFileClose( hF )
					! BackUp
					Call SalStatusSetText ( hWndForm, 'BackUp' )
					Set YYMMDD=SalFmtFormatDateTime( dDat, 'yyMMdd' )
					Set strBackUpPath=strFilePath||'\\'||YYMMDD
					If not VisDosExist(strBackUpPath)
						If not SalFileCreateDirectory( strBackUpPath )
							Call SalMessageBox( 'Неможливо створити каталог:'||strBackUpPath, 'Увага', MB_IconStop )
					Call SalFileCopy( strFilePath||strFileName, strBackUpPath||'\\'||strFileName, TRUE )
					Call SalFileOpen( hFile, strFilePath||strFileName, OF_Delete )
					Call SalHideWindow(ccProgressBar)
					Call SalWaitCursor(FALSE)
					Call SalStatusSetText ( hWndForm, 'Готово' )
			Function: PutFileToLob
				Description: Загрузка данных из файла в поле BLOB с последующей записью в BLOB или CLOB
				Returns
					Boolean:
				Parameters
					String: strFilePath
					String: strFileName
				Static Variables
				Local variables
					File Handle: hF
					Long String: strBuffer
					!
					String: strHFName
					String: strHMfo
					Number: nHLines
					Boolean: fProcError
					!
					Number: nIterator
					String: strOKPO
					Number: nTgr
					Number: nAct
					Number: nObl
					String: strDt
					String: strKkd
					String: strSum
					String: strFond
					String: strKmis
					String: strNdov
					Date/Time: dDdov
					Number: nKmis
					Number: nSum
					Date/Time: dDt
					String: strId_Key
					String: strBackUpPath
					String: YYMMDD
					File Handle: hFile
					Boolean: bZag
					Number: i
					String: DELETE
					String: xxx  
				Actions
					! Это максимальный теоритический предел для вставки в БД
					Set xxx=SalStrUpperX( SalStrLeftX(strFileName,3) )
					! Call Debug(strFilePath || strFileName)
					If VisFileOpen( hF, strFilePath || strFileName, OF_Binary | OF_Read ) != VTERR_Ok
						Call SalMessageBeep( MB_IconStop )
						Call SaveErrorToLog( 'Невозможно открыть файл ' || strFilePath )
						Call SalMessageBox( 'Невозможно открыть файл ' || strFilePath, 'Ошибка!', MB_IconStop | MB_Ok )
						Return FALSE
					Call SalWaitCursor(TRUE)
					Call SalStatusSetText ( hWndForm, strFilePath || strFileName )
					Call SalShowWindow(ccProgressBar)
					Call SqlPLSQLCommand(hSql(),"dbf.op(0)")
					Loop
						! Call ccProgressBar.SetProgress( nIterator / nHLines * 100)
						Call SalStrSetBufferLength(strBuffer, 2901)
						Set i = VisFileRead(hF, strBuffer, 2900)
						Call SalStrSetBufferLength(strBuffer, i+1)
						If not SqlPLSQLCommand(hSql(),"dbf.ap(strBuffer)" )
						If i<2900
							Break
					If xxx='ROT'
						Set DELETE = "DELETE from PLAN_mbh WHERE id_key=SUBSTR('"||strFileName||"',10,3);"||
								             "DELETE from PLAN_mb  WHERE id_key=SUBSTR('"||strFileName||"',10,3);"
					Else If xxx='RRT'
						Set DELETE = "DELETE from PLAN_mbh WHERE id_key=SUBSTR('"||strFileName||"',10,3) AND fn LIKE 'RRT%';"
					Else
						Set DELETE = ''
					! Call Debug(SalStrLeftX(strFileName,3))
					Set strBuffer=
							"BEGIN"||PutLf()||DELETE||PutLf()||
							"FOR c IN (SELECT * FROM tmp_dbf) LOOP"||PutLf()||
							" in_dohMB(SUBSTR('"||strFileName||"',1,12),c.kod,"||IifS(xxx='ROT',"c.data,'0'","c.ddate,c.dnumb")||","||PutLf()||
							"          SUBSTR('"||strFileName||"',10,3),c.kkd,"||IifS(xxx='ROT','c.kkfn','c.kkfb')||",c.month,c.summ,c.note);"||PutLf()||
							"END LOOP;"||PutLf()||
							"END;"
					Call SqlPLSQLCommand(hSql(),"dbf.cl(strBuffer)")
					Call SqlCommitEx( hSql(), 'Обработка файла ' || strFilePath || strFileName || ' закончена' )
					Call VisFileClose ( hF )
					! BackUp
					Call SalStatusSetText ( hWndForm, 'BackUp' )
					Set YYMMDD=SalFmtFormatDateTime( dDat, 'yyMMdd' )
					Set strBackUpPath=strFilePath||'\\'||YYMMDD
					If not VisDosExist(strBackUpPath)
						If not SalFileCreateDirectory( strBackUpPath )
							Call SalMessageBox( 'Не могу создать каталог:'||strBackUpPath, 'Внимание', MB_IconStop )
					Call SalFileCopy( strFilePath||strFileName, strBackUpPath||'\\'||strFileName, TRUE )
					Call SalFileOpen( hFile, strFilePath||strFileName, OF_Delete )
					Call SalHideWindow(ccProgressBar)
					Call SalWaitCursor(FALSE)
					Call SalStatusSetText ( hWndForm, 'Готово' )
			Function: MakePayments
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Date/Time: dDat
				Actions
					Call SalWaitCursor(TRUE)
					If SqlPLSQLCommand(hSql(),'pay_doh'||IifS(nPar=1,'DB','MB')||'(dDat)')
						Call SqlCommitEx( hSql(), 'Pay_doh'||IifS(nPar=1,'DB','MB')||' закончена' )
					Else
						Call SqlRollback(hSql())
					Call SalWaitCursor(FALSE)
			Function: GetFilNem
				Description: Ищет "свободное" имя файла
				Returns
					String:
				Parameters
					String: sFn
				Static Variables
				Local variables
					Number: i
					String: sTmp
					Date/Time: dDatTmp
				Actions
					Set i=0
					While i<=999
						Set sTmp=GetPrnDir()||'\\'||sFn||'.'||SalFmtFormatNumber(i,'000')
						If SalFileGetDateTime(sTmp,dDatTmp)
							Set i=i+1
						Else
							Break
					Return sTmp
		Window Parameters
			Number: nPar     ! 1-ДБ, 2-МБ
			String: sFlags   ! 0-Ins,1-Del,2-Save,3-Run,4-Imp,5-Ref(RO/RW)
			String: sFilt    ! Предустановленный фильтер
		Window Variables
			String: sId_Key
			String: sKkd
			Number: nTmp
			Number: nFiles
			Number: nFetchRes
			String: strBind
			String: sFilNem
			String: sQrpNem
			Number: nInd
			String: sMinFinDir
			String: sFiles[*]
			Date/Time: dDat
			! KTK,FDAT,GR,S230,KEKD,KVK,DD,YYYY,PR,PLAN
			! KKD,NAME,S1,S2
			Number: KTK
			Date/Time: FDAT
			Number: GR
			Number: S230
			String: G1
			String: G2
			String: KKD
			String: NAME
			Number: KVK
			Number: S1
			Number: S2
			Number: S3
			Number: S4
			!
			String: sMask[*]
			Boolean: bProcesd
			Number: i
			String: sKtkMask
			String: strReport
			String: sFlagI
			String: sObl
		Message Actions
			On SAM_Create
				Call SalMapEnterToTab( TRUE )
				Call SalSetWindowText ( hWndForm, 'Планові показники по '||IifS( nPar=1,'ДБ','МБ' ))
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call ShowApdVersion('02')
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('Directory', 'MinFinDir', GetPrnDir(), sMinFinDir, GetIniFileName())
				Set sMinFinDir = sMinFinDir || IifS(Right(sMinFinDir, 1)='\\', '', '\\')
				Set dDat=GetBankDate()
				Set splPlanDoh.nTabInstance2 = 1
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				Set sFlagI=sFlags||'11111111'
				! ! Управление кнопками
				If SalStrMidX(sFlagI,0,1)='0'
					Call SalDisableWindow( pbIns )
				If SalStrMidX(sFlagI,1,1)='0'
					Call SalDisableWindow( pbDel )
				If SalStrMidX(sFlagI,2,1)='0'
					Call SalDisableWindow( pbUpdate )
				If SalStrMidX(sFlagI,3,1)='0'
					Call SalDisableWindow( pbRun )
				If SalStrMidX(sFlagI,4,1)='0'
					Call SalDisableWindow( pbImport )
				! Call SalDisableWindow( pbDetails )
				Set sObl=GetGlobalOption('KOBL_412')
			On SAM_Close
				Call SalMapEnterToTab( FALSE )
			On UM_ObjActivate
				If nPar=1
					Set sMask[0]='KO??????.YDY'
					Set sMask[1]='KO??????.MDY'
					Set sMask[2]='KZ??????.YDW'
					Set sMask[3]='KZ??????.MDW'
				Else
					Set sMask[0]='ROC?????.???'
					Set sMask[1]='RRM?????.???'
					Set sMask[2]='RZD?????.???'
					Set sMask[3]='ROT?????.???'
					Set sMask[4]='RZT?????.???'
					Set sMask[5]='RRT?????.???'
				Set bProcesd=FALSE
				Set i=0
				While i<IifN(nPar=1,4,6)
					Set nFiles = VisDosEnumFiles (sMinFinDir||sMask[i]||IifS(GetGlobalOption('PLN373')='N' or nPar=1,'','.DBF'), FA_Standard, sFiles)
					If nFiles > 0
						While nFiles>0
							Set nFiles=nFiles-1
							Set sFiles[nFiles]=SalStrMidX(sFiles[nFiles],5,2)||SalStrMidX(sFiles[nFiles],3,2)||sFiles[nFiles]
						Set nFiles=VisArraySort (sFiles, SORT_Descending, DT_String)
						While nFiles>0
							Set nFiles=nFiles-1
							If GetGlobalOption('PLN373')='N' or nPar=1
								Call ImportMinFin(sMinFinDir,SalStrMidX(sFiles[nFiles],4,12))
							Else
								Call PutFileToLob(sMinFinDir,SalStrMidX(sFiles[nFiles],4,16))
							Set bProcesd=TRUE
					Set i=i+1
				If not bProcesd
					Call MessageAttention('Немає файлів для імпорту: ' || sMinFinDir||IifS(nPar=1,'(KO,KZ)','(ROC,RRM,RZD,ROT,RZT,RRT)'))
			On SAM_ReportStart
				Set sKtkMask=tbl.colKtk
				If nPar=1
					Set strReport=
							  "SELECT substr(p.kkd,1,1) g1, substr(p.kkd,1,2) g2, to_char(p.kkd) kkd,
							          substr(b.name, 1,254) name, 
							          sum(decode(p.gr,1,p.s,0)) s1,
							          sum(decode(p.gr,1,0,p.s)) s2
							     INTO :G1,:G2,:KKD,:NAME,:S1,:S2
							     FROM plan_dbh p, kkd_minfin b
							    WHERE p.kkd = b.kkd
							      AND p.id_key = :tbl.colId_Key
							      AND mes=0 
							      AND datd >= trunc(to_date(:dDat), 'YEAR')  
							      AND datd <=:dDat   
							GROUP BY p.kkd, b.name"
				Else
					If obTotal
						If SalStrRightX(sKtkMask,2)='00'
							Set sKtkMask=SalStrLeftX(sKtkMask,SalStrLength(sKtkMask)-2)
							If SalStrRightX(sKtkMask,2)='00'
								Set sKtkMask=SalStrLeftX(sKtkMask,SalStrLength(sKtkMask)-2)
								If SalStrRightX(sKtkMask,2)='00'
									Set sKtkMask=SalStrLeftX(sKtkMask,SalStrLength(sKtkMask)-2)
						Set sKtkMask=sKtkMask||'%'
					Set strReport=
							  "SELECT g.gr,p.s230,g.kekd,
								  SUM(DECODE (SUBSTR (s.nbs, 1, 1), '3', -1, '6', 1, 0) * (s.kos - s.dos)) S1,
								  SUM(DECODE (SUBSTR (s.nbs, 1, 1), '3', -1, '6', 1, 0) * (s.ost)) S2,
								  SUM(DECODE (SUBSTR (s.nbs, 1, 1), '9', -s.ost,0)) S3
							     INTO :GR,:S230,:KKD,:S1,:S2,:S3
							     FROM gr412"||IifS( nPar=1,'gb','mb' )||" g, sal s, specparam p
							    WHERE (s.dos > 0 OR s.kos > 0 OR s.ost <> 0) 
							      AND s.nbs IN ("||IifS(nPar=1,"'3111','3121','6511','6112','9311','9312'",
							                                   "'3141','3151','6121','6122','9323','9324'")||")
							      AND s.acc = p.acc
							      AND g.s230 = p.s230 AND g.gr IN ('1','2') AND ktk LIKE '"||sKtkMask||"' AND fdat=:dDat
							    GROUP BY g.gr,p.s230,g.kekd
							    ORDER BY g.gr,p.s230,g.kekd"
				Call SqlPrepare( hSql(),strReport )
				Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'TERRNAME', sKtkMask||' '||tbl.colName )
				Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'BANKNAME', GetBankName() )
				Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'OUR_BANK_NAME', GetBankName() )
				Call SalReportSetDateTimeVar(SalNumberToWindowHandle( wParam ),'DAT', dDat )
				Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'SDAT1', SalFmtFormatDateTime ( dDat, 'dd-MM-yyyy' ) )
			On SAM_ReportFetchInit
				Return SqlExecute( hSql() )
			On SAM_ReportFetchNext
				If SqlFetchNext( hSql(), nFetchRes )
					If nPar=1
						Set G1=SalStrLeftX ( KKD, 1)
						Set G2=SalStrLeftX ( KKD, 2)
					Else
						Set KTK=SalStrToNumber(tbl.colKtk)
						If S3
							Set S4=SalNumberRound( S2*100/S3 )
						Else
							Set S4=0
					Return TRUE
	Table Window: K2	       ! 03 - Просмотр и оплата K2 по выбору
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Картотека - 2
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.05"
				Top:    1.146"
				Width:  16.95"
				Width Editable? Class Default
				Height: 7.262"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.057"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Справка по счетам клиента'
						On SAM_Click
							If SqlPrepareAndExecute(hSql(), "
									   SELECT u.rnk
									   INTO :nTmp
									   FROM cust_acc u, accounts a
									   WHERE a.nls=:K2.NLSA and a.kv=:n980 and u.acc=a.acc") and SqlFetchNext(hSql(), i)
								Call ShowCustAccountsEx(nTmp)
				Pushbutton: pbDel !! Изъять Документ из К-2
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.871"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Изъять Документ из К-2'
						On SAM_Click
							If K2.OTM = 0
								If SalMessageBox("УДАЛИТЬ документ " || Str(K2.REF) || " на сумму " ||
										   SalNumberToStrX(K2.S, 2) || " ?", "Платеж клиента аннулируется !",
										   MB_YesNo | MB_IconQuestion) = 6
									Set sErrTxt=''
									While TRUE
										If SqlPrepareAndExecute(hSql(), "
												   SELECT ref
												   INTO :nAcc
												   FROM oper
												   WHERE ref=:K2.REF FOR UPDATE of ref NOWAIT") and SqlFetchNext(hSql(), i)
											If SqlPrepareAndExecute(hSql(), "
													   SELECT a.nls,sum(decode(o.dk,0,o.s,-o.s))
													   INTO :NLS9,:nSum
													   FROM opldok o, accounts a
													   WHERE o.ref=:K2.REF and a.acc=o.acc AND
													         o.acc IN (SELECT acc
													                   FROM opldok
													                   WHERE tt='K2B' and dk=0 and ref=:K2.REF)
													   GROUP BY a.nls") and SqlFetchNext(hSql(), i)
												If nSum < K2.S*100 or K2.S<0
													Set sErrTxt = "Сумма документа исчерпана"
													Break
												If cDoc.PayV(1, K2.REF, GetBankDate(), 'K2X', 1, 980, s9Kontr, K2.S*100, 980, NLS9, K2.S*100)   
													If SqlPrepareAndExecute(hSql(), 'DELETE FROM k2_que WHERE ref=:K2.REF')
														Call SaveInfoToLog('Вилучення з черги РЕФ='||Str(K2.REF) )
													Call SqlCommit(hSql())
													Call ColorStr(COLOR_Red, sDel, 1)
													! запись в журнал событий
													Call SaveInfoToLog('ВИСНОВОК(Изъят)  ' || K2.ND || '  ' || K2.NLSA
															     || '  ' || K2.MFOB || '  ' || K2.NLSB || '  ' ||
															     SalNumberToStrX(K2.SD, 2) || '  ' || SalNumberToStrX(K2.S, 2))
													Return TRUE
												Break
											Break
										Break
									Call SqlRollback(hSql())
									If sErrTxt
										Call MessageErrorEx('Ошибка : ' || sErrTxt || '.')
							Else
								Call SalMessageBox("Исчерпан РЕФ=" || Str(K2.REF), "Ошибка !", MB_IconInformation)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.286"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate !! Опл. 1 Док. из К-2 (зеленая кнопка)
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.757"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Оплатить 1 документ вне очереди'
						On SAM_Click
							If K2.OTM = 0 and K2.OSTC > 0 and K2.S
								If K2.SO = NUMBER_Null
									Set K2.SO = SalNumberMin(K2.OSTC, K2.S)
								If Oplata1(K2.SO*100, 1)
									Call SalMessageBox('Оплачен из К-2  РЕФ=' || Str(K2.REF), "Успешно !", MB_OK)
							Else
								Call SalMessageBox(" Невозможная оплата РЕФ=" || Str(K2.REF), "Ошибка !", MB_IconInformation)
				Line
					Resource Id: 16291
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.729"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.171"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.314"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Документ в К-2'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.614"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16292
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.057"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16293
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbPaket
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSort
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.2"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Оплатить Пакетом по очередности и дате'
						On SAM_Click
							If SalMessageBox("Оплатить документы ПАКЕТОМ в пределах остатка ?", "Внимание !",
									   MB_YesNo | MB_IconQuestion) = IDNO
								Return FALSE
							Set NLSA1 = '*'
							Set nS = 0
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(K2,nRow, 0, 0)
								Call SalTblSetContext(K2,nRow)
								Call SalTblSetFocusRow(K2,nRow)
								Call SalTblSetRowFlags(K2,nRow, ROW_Selected, TRUE)
								If nRow >= 0 and K2.OTM = 0 and K2.S > 0
									If NLSA1 != K2.NLSA
										! остаток
										If SqlPrepareAndExecute(hSql(), "
												   SELECT acc,ostc/100
												   INTO :nAcc,:nS
												   FROM accounts
												   WHERE nls=:K2.NLSA and kv=:n980 and ostc>0") and SqlFetchNext(hSql(), i)
											! броня
											If SqlPrepareAndExecute(hSql(), "
													   SELECT s
													   INTO :nSb
													   FROM k2_b
													   WHERE acc=:nAcc and fdat=BANKDATE")
												If SqlFetchNext(hSql(), i)
													Set nS = nS - nSb
										Else
											Set nS = 0
										Set NLSA1 = K2.NLSA
									If nS > 0
										Set nSdok = SalNumberMin(nS, K2.S)
										If Oplata1(nSdok*100, 0)
											Set nS = nS - nSdok
									Call SalTblSetRowFlags(K2, nRow, ROW_Selected, FALSE)
				Pushbutton: pbUpdate1 !! Опл. 1 Док. из К-2 c овердрафтом (красная кнопка)
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSort
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.514"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\App1.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Оплатить 1 документ вне очереди c овердрафтом'
						On SAM_Click
							If K2.OTM = 0 and K2.S
								If K2.SO = NUMBER_Null
									Set K2.SO = K2.S
								If Oplata1(K2.SO*100, 2)
									Call SalMessageBox('Оплачен из К-2  РЕФ=' || Str(K2.REF), "Успешно !", MB_OK)
							Else
								Call SalMessageBox("Исчерпан РЕФ=" || Str(K2.REF), "Ошибка !", MB_IconInformation)
				Data Field: dfNumSelect
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 6
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.717"
							Top:    0.095"
							Width:  0.85"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dfSumSelect
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 10
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.533"
							Top:    0.095"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbAsse
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.063"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\C2.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Оплатить 1 документ c подкреплением с котловых'
						On SAM_Click
							If SalStrScan(sK2_ASSE, SalStrLeftX(K2.NLSA,4)) >= 0
								If K2.OTM = 0 and K2.S
									If K2.SO = NUMBER_Null
										Set K2.SO = K2.S
									If Oplata1(K2.SO*100, 3)
										Call SalMessageBox('Оплачен из К-2  РЕФ=' || Str(K2.REF), "Успешно !", MB_OK)
								Else
									Call SalMessageBox("Исчерпан РЕФ=" || Str(K2.REF), "Ошибка !", MB_IconInformation)
							Else
								Call SalMessageBox("Только для "||sK2_ASSE, "Ошибка !", MB_IconInformation)
		Contents
			Column: TT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Т
						и
						п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: И
						с
						п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет-
						плательщика
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Номер
						документа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						на сч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						на сч
						консолид
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: OCH
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: О
						ч
						р
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.217"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				              List Values 
				              Message Actions 
			Column: FDAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						помещ.
						в К-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						осн
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: KOD
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				              List Values 
				              Message Actions 
			! Column: NAME
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид платежа
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				              List Values 
				              Message Actions 
			Column: SD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Первичная
						сумма
						док-та
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Неоплач.
						остаток
						 док-та
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						последней
						оплаты
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет-Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.429"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						новый
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						оплаты
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_ContextMenu
						Return FALSE
			Column: FINGER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: ColorStr
				Description:
				Returns
				Parameters
					Number: nCol
					String: sTmp
					Number: nOtm
				Static Variables
				Local variables
				Actions
					Call SaveFInfoToLog(sTmp)
					Call SalTblSetCellTextColor(K2.ISP,  nCol, FALSE)
					Call SalTblSetCellTextColor(K2.NLSA, nCol, FALSE)
					! Call SalTblSetCellTextColor(K2.OCH,  nCol, FALSE)
					Call SalTblSetCellTextColor(K2.FDAT1,nCol, FALSE)
					Call SalTblSetCellTextColor(K2.REF,  nCol, FALSE)
					! Call SalTblSetCellTextColor(K2.KOD,  nCol, FALSE)
					! Call SalTblSetCellTextColor(K2.NAME, nCol, FALSE)
					Call SalTblSetCellTextColor(K2.SD,   nCol, FALSE)
					Call SalTblSetCellTextColor(K2.S,    nCol, FALSE)
					Call SalTblSetCellTextColor(K2.FDAT2,nCol, FALSE)
					Call SalTblSetCellTextColor(K2.MFOB, nCol, FALSE)
					Call SalTblSetCellTextColor(K2.NLSB, nCol, FALSE)
					Set K2.OTM = nOtm
			Function: Oplata1
				Description:
				Returns
					Boolean:
				Parameters
					Number: nDok
					Number: nOdin
				Static Variables
				Local variables
					Number: nVob
					! Number: nKD
					String: sVid
					String: sNBSB
					String: sOKPO
					String: sDREC
					String: sOKPOA
					Date/Time: dDatD
					String: sTmp
					String: sErrTxt
				Actions
					If nDok = 0
						Call SalMessageBox("Сумма = 0.00 !!! ", "Внимание ... ",MB_IconQuestion)
						Return FALSE
					If nOdin >0 and SalMessageBox("ОПЛАТИТЬ документ " || Str(K2.REF) || " на сумму " ||
							   SalNumberToStrX(nDok/100, 2) || " ?", "Будет сформирован дополнительный платеж !",
							   MB_YesNo | MB_IconQuestion) = IDNO
						Return FALSE
					! Set nRef = NUMBER_Null
					! Set nKD = 0
					Set sNBSB = Left(K2.NLSB, 4)
					Set sErrTxt = ''
					While TRUE
						If SqlPrepareAndExecute(hSql(), "
								   SELECT p.nd,p.nam_a,p.nam_b,p.nazn,p.datd,to_char(p.datd,'DD-MM-YY'),p.vob,p.id_b,p.id_a,
								          DECODE(p.id_b,'0000000000', 
								            CASE WHEN INSTR(p.d_rec,'#ф') > 0 THEN p.d_rec ELSE
								         (SELECT '#ф'||TRIM(value)||'#' FROM operw WHERE tag='ф' AND ref=p.ref) END, NULL)
								     INTO :sND,:sNAM_A,:sNAM_B,:sNAZN,:dDatD,:sDATD,:nVob,:sOKPO,:sOKPOA,:sDREC
								     FROM oper p
								    WHERE p.ref=:K2.REF FOR UPDATE of p.ref NOWAIT")
							If SqlFetchNext(hSql(), i)
								Set nSum = 0
								If SqlPrepareAndExecute(hSql(), "
										   SELECT a.nls,sum(decode(o.dk,0,o.s,-o.s))
										     INTO :NLS9,:nSum
										     FROM opldok o, accounts a
										    WHERE o.ref=:K2.REF AND a.acc=o.acc AND
										          o.acc IN (SELECT acc
										                      FROM opldok
										                     WHERE tt='K2B' AND dk=0 AND ref=:K2.REF)
										    GROUP BY a.nls") and SqlFetchNext(hSql(), i)
								If nSum < nDok or nDok < 0
									Set sErrTxt = "Сумма документа исчерпана"
									Break
								If sBankMfo != K2.MFOB and sOKPO != V_Okpo(sOKPO)
									Set sErrTxt = "Недопустимый код ОКПО получателя " || sOKPO
									Break
								! ==Вибор операции========================================
								Set nDelta = 0
								Set i = SalStrScan(sNbsList, SalStrLeftX(K2.NLSA, 4))
								If i >= 0 and i+4 < SalStrLength(sNbsList)
									Set nDelta = SalStrToNumber(SalStrMidX(sNbsList, SalStrScan(sNbsList, SalStrLeftX(K2.NLSA, 4))+4, 1))
								Set nVidPl = IifN(K2.MFOB=GetBankMfo(), 2, 1) + nDelta
								! ========================================================
								! возврат клиенту: МежБанк+Внутр с уменьшением А-6 кл
								If nVidPl = 1
									Set sTT = IifS(K2.MFOB=GetBankMfo(), 'K2I', 'K2D')
								! Перезач.на другой вид дохода: Внутр с уменьшением А-6 + увеличением Б-6
								Else If nVidPl = 2
									Set sTT = 'K2C'
								! С недоходного счета на произвольный: МежБанк+Внутр без 6
								! пример А=3412 реалізована застава в Местный бюжет через МежБанк
								Else If nVidPl = 4
									Set sTT = IifS(K2.MFOB=GetBankMfo(), 'K2E', 'K2F')
								! С недоходного счета на доходный:Внутр c увеличением Б-6
								! пример А=3412 реалізована застава на погашение задолженности по налогам
								Else If nVidPl = 5
									Set sTT = 'K2G'
								Else
									Set sTT = 'K2D'
								If sDREC
									Set sTmp = sDREC
								Else
									Set sTmp = SalStrTrimX('#C' || IifS(nDok=nSum, 'ОПЛАТА', 'Ч/О') || ' Док.' || sND
											    || ' від ' || sDATD || IifS(nDok=nSum, '', '. Залишок ' ||
											    SalNumberToStrX((nSum-nDok)/100, 2)) || '#')
								! Call cDoc.SetDoc(0, sTT, 1, IifN(nDok=K2.S*100, nVob, 6), sND,
										     IifD(nDok=K2.S*100, dDatD, GetBankDate()), GetBankDate(), GetBankDate(),
										     GetBankDate(), K2.NLSA, sNAM_A, sBankMfo, '', n980, nDok, sOKPOA, K2.NLSB,
										     sNAM_B, K2.MFOB, '', n980, nDok, sOKPO, sNAZN, sTmp, GetIdOper(), '',
										     NUMBER_Null, 0)
								Call cDoc.SetDoc(0, sTT, 1, IifN(nDok=K2.S*100, nVob, 6), sND,
										     GetBankDate(), GetBankDate(), GetBankDate(),GetBankDate(),
										     K2.NLSA, sNAM_A, sBankMfo, '', n980, nDok, sOKPOA, K2.NLSB,
										     sNAM_B, K2.MFOB, '', n980, nDok, sOKPO, sNAZN, sTmp, GetIdOper(), '',
										     NUMBER_Null, 0)
								Set cDoc.nK2Ref  = K2.REF
								Set cDoc.nK2Mode = nOdin
								Set cDoc.sK2Nls9 = NLS9
								Set cDoc.sK2NlsK = s9Kontr
								! Set bO8 = TRUE
								! Set nOK = 0
								! Вилучити з черги на оплату К2
								If nDok=nSum and SqlPrepareAndExecute(hSql(), 'DELETE FROM k2_que WHERE ref=:K2.REF')
									Call SaveInfoToLog('Вилучення з черги РЕФ='||Str(K2.REF) )
								If cDoc.oDoc() and SqlCommit(hSql())
									Set K2.REFN = cDoc.m_nRef
									Set K2.SO = nDok / 100
									Call ColorStr(COLOR_Blue, 'Оплачено из К2:' || PutCrLf() || 'СчетА=' || K2.NLSA
											     || ',МфоБ=' || K2.MFOB || ',СчетБ=' || K2.NLSB || ',' || PutCrLf() ||
											     'Перв.сумма.док.=' || Str(K2.SD) || ',Неопл.ост.док.=' || Str(K2.S) ||
											     ',Сумма опл.=' || Str(K2.SO) || ',' || PutCrLf() || 'Реф.К2=' ||
											     Str(K2.REF) || ',Реф.опл.=' || Str(K2.REFN), 1)
									! запись в журнал событий
									Call SaveInfoToLog('ВИСНОВОК(' || IifS(K2.S=K2.SO, 'Оплач', 'Ч.опл') || ')  '
											     || K2.ND || '  ' || K2.NLSA || '  ' || K2.MFOB || '  ' || K2.NLSB || '  '
											     || SalNumberToStrX(K2.SD, 2) || '  ' || SalNumberToStrX(K2.SO, 2))
									Return TRUE
								Break
							Break
						Break
					Call SqlRollback(hSql())
					If sErrTxt
						Call MessageErrorEx('Ошибка : ' || sErrTxt || '.')
					Return FALSE
			Function: NumberToHexSX36mom
				Description: Преобразует число в строку 36-ричных кодов
				Returns
					String:
				Parameters
					Number: nNumber
				Static Variables
				Local variables
					String: strHex
					Number: nRmd
					Number: nDvd
				Actions
					Set nDvd = nNumber
					Set nRmd = 0
					Set strHex = ''
					Loop
						If nDvd = 0
							Break
						Set nRmd = SalNumberMod(nDvd, 36)
						Set nDvd = SalNumberTruncate(nDvd/36, 10, 0)
						! If nRmd < 10
							                                                                                                                                                                                    Set strHex = SalNumberToChar(nRmd+48) || strHex
						! Else
							                                                                                                                                                                                    Set strHex = SalNumberToChar(nRmd+55) || strHex
						Set strHex = SalNumberToChar(nRmd+IifN(nRmd<10, 48, 55)) || strHex
					If SalNumberMod(SalStrLength(strHex), 2) != 0
						Set strHex = '0' || strHex
					Return strHex
		Window Parameters
			Number: nPar        ! 0- Просмотр/Оплата, 1-Только просмотр
			String: sViewName   ! Имя рабочего представления
			String: sFilt       ! Предустановленный фильтр
		Window Variables
			Number: nRow
			String: NLSA1
			Number: nS
			Number: nSb
			Number: nAcc
			Number: nSdok
			!
			: cDoc
				Class: cK2Doc
			String: s9Kontr  !! контрсчет по внебалансу
			Number: n980     !! базовая валюта
			String: NLS9     !! счет по внебалансу
			Number: nSum
			Number: i
			! Number: nRef
			String: sBankMfo
			String: sOperID
			String: sDel
			String: sND
			String: sTT
			String: sNAM_A
			String: sNAM_B
			String: sNAZN
			String: sDATD
			!
			String: sBackDocPath
			! Number: nOK
			String: sErrTxt
			! cGenFilter: cF
.winattr class :
				Class: cGenFilter
.end
			String: sTabName
			!
			Number: nIsp
			String: sUserId
			!
			! Boolean: bO8
			Number: nValue
			Number: nAltStatus
			Number: nCtlStatus
			Number: nTmp
			Date/Time: dTmp
			!
			Number: nTimeWaitMessage
			String: sTimeWaitMessage
			String: sK2_ASSE
			!
			String: sNbsList ! список б/с вида с VIDPL  BBBBV,BBBBV,....
			Number: nVidPl
			Number: nDelta
		Message Actions
			On SAM_Create
				Call SalTblSetLockedColumns(hWndForm, 2)
				Set K2.nTabInstance = 1
				Set K2.nIsp = GetUserId()
				Set sUserId = NumberToHexSX36mom(nIsp)
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('ElektroKlients', 'BackDocPath', GetPrnDir(), sBackDocPath,GetIniFileName())
				Call SalGetProfileString('ElektroKlients', 'TimeWaitMessage', '3', sTimeWaitMessage,GetIniFileName())
				Set nTimeWaitMessage = Max(0, Val(sTimeWaitMessage))
				Call SalCenterWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call ShowApdVersion('03')
				If nPar = 1
					Call SalHideWindow(pbDel)
					Call SalHideWindow(pbUpdate)
				If sViewName
					Set sTabName = sViewName
				Else
					Set sTabName = 'K22'
				If GetGlobalOption('K2_ASSE')  ! Список допустимих Б/Р в p_asse
					Set sK2_ASSE=GetGlobalOption('K2_ASSE')
				Else
					Set sK2_ASSE='3111,3121,3141,3151,3717,3131,3311,3321,3411,3421,3422'
				If GetGlobalOption('K2_LIST')  ! Список видов платежей в К2
					Set sNbsList=GetGlobalOption('K2_LIST')
				Set K2.strPrintFileName = 'K2.txt'
				Set K2.strFilterTblName = sTabName
				Set K2.fFilterAtStart = TRUE
				Set K2.strSqlPopulate = "
						    SELECT k.tt,k.isp,k.nlsa,k.fdat1,k.ref,k.sd/100,k.s/100,
						           k.fdat2,k.mfob,k.nlsb,0,1,k.nd,k.datd
						      INTO :K2.TT1,:K2.ISP,:K2.NLSA,:K2.FDAT1,:K2.REF,:K2.SD,:K2.S,
						           :K2.FDAT2,:K2.MFOB,:K2.NLSB,:K2.OTM,:K2.FINGER,:K2.ND,:K2.DATD
						      FROM "|| sTabName ||" k "|| IifS(SalStrLength(SalStrTrimX(sFilt)),
						    "WHERE "|| sFilt,'')||"
						     ORDER BY nlsa,fdat1"
				Set sDel = 'Вилучення з К2'
				Set n980 = GetBaseVal()
				Set sBankMfo = GetBankMfo()
				Set sOperID = GetIdOper()
				Call SqlPrepareAndExecute(hSql(), "SELECT nlsm INTO :s9Kontr FROM tts WHERE tt='K2O'")
				If not SqlFetchNext(hSql(), i)
					Call Debug('Не описана операция K2O')
					Call SalDestroyWindow(hWndForm)
				Call SalTblSetTableFlags(K2, TBL_Flag_SingleSelection, TRUE)
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call K2.cF.Init(sTabName, 'k')
			On SAM_FetchRowDone
				If SqlPrepareAndExecute(hSqlAux2(), "
						   SELECT a1.ostc/100,a2.ostc/100
						   INTO :K2.OSTC,:K2.OSTSK
						   FROM accounts a1,accounts a2
						   WHERE a1.accc=a2.acc (+) AND a1.kv=980 and a1.nls=:K2.NLSA") and
						   SqlFetchNext(hSqlAux2(), i)
				Set dfNumSelect = dfNumSelect + 1
				Set dfSumSelect = dfSumSelect + K2.S
				!
				If sBankMfo=K2.MFOB and GetGlobalOption('K2_CHKB')='Y'
					! ! Красим строки
					If SqlPrepareAndExecute(hSqlAux2(), "
							   SELECT a.blkk,a.dazs INTO :nTmp,:dTmp
							     FROM accounts a
							    WHERE a.nls=:K2.NLSB AND a.kv=980") AND
							   SqlFetchNext(hSqlAux2(), i)
						If nTmp    ! Счет блокирован
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle )
						If dTmp    ! Счет закрыт
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )
					Else
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_DarkAqua )
			On UM_DoubleClick
				Call DocViewContentsEx(hWndMDI, K2.REF)
			On UM_Populate
				Set dfNumSelect = 0
				Set dfSumSelect = 0
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_ContextMenu
				Call SalWaitCursor(TRUE)
				If SqlPrepareAndExecute(hSqlAux2(), "
						   SELECT p_assa(:K2.NLSA,(:K2.S)*100)/100
						   INTO :K2.SO
						   FROM DUAL") and SqlFetchNext(hSqlAux2(), i)
				Call SalWaitCursor(FALSE)
				Return FALSE
			On VTM_KeyDown
				If wParam = VK_F12
					Set nAltStatus = VisGetKeyState(VK_Alt)
					Set nCtlStatus = VisGetKeyState(VK_Control)
					If (nAltStatus & KS_Down) AND (nCtlStatus & KS_Down)
						Set nValue=TBL_MinRow
						Call SalWaitCursor(TRUE)
						While SalTblFindNextRow(K2, nValue,0, 0)
							Call SalTblSetFocusRow(K2, nValue)
							If SqlPrepareAndExecute(hSqlAux2(), "
									   SELECT p_assa(:K2.NLSA,(:K2.S)*100)/100
									   INTO :K2.SO
									   FROM DUAL") and SqlFetchNext(hSqlAux2(), i)
						! Call SalSendClassMessage(SAM_Click, wParam, lParam)
						Call SalWaitCursor(FALSE)
	Table Window: K2b	       ! 04 - Бронирование средств от К-2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Бронирование средств от Картотеки-2
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.54"
				Top:    0.45"
				Width:  10.4"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16295
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16296
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16297
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: RI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.143"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.743"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЛС
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.143"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call SqlPrepareAndExecute( hSqlAux2(),
								"SELECT acc,nms
								 INTO :ACC,:NMS FROM saldo
								 WHERE nls=:NLS and kv=:nKv")
						Return IifN( SqlFetchNext( hSqlAux2(), nI ), VALIDATE_Ok, VALIDATE_Cancel)
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование ЛС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.143"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата  действия
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма брони
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.214"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar
		Window Variables
			Number: nKv
			Number: nI
		Message Actions
			On SAM_Create
				Set K2b.strPrintFileName = 'K2_B'
				Set K2b.strFilterTblName = 'ACCOUNTS'
				Set nKv=GetBaseVal()
				Set K2b.strSqlPopulate="
						 SELECT k2_b.rowid,
						        k2_b.acc,
						        accounts.nls,
						        accounts.nms,
						        k2_b.fdat,
						        k2_b.s
						 INTO :K2b.RI,
						      :K2b.ACC,
						      :K2b.NLS,
						      :K2b.NMS,
						      :K2b.FDAT,
						      :K2b.S
						 FROM k2_b, accounts WHERE k2_b.acc=accounts.acc
						 ORDER BY k2_b.fdat desc,accounts.nls"
				Set K2b.strSqlDelete=
						      "DELETE FROM k2_b WHERE rowid=:K2b.RI"
				Set K2b.strSqlInsert=
						      "INSERT INTO k2_b (acc,fdat,s)
						       VALUES (:K2b.ACC,:K2b.FDAT,:K2b.S)"
				Set K2b.strSqlUpdate=
						      "UPDATE k2_b SET acc=:K2b.ACC, fdat=:K2b.FDAT, s=:K2b.S WHERE rowid=:K2b.RI"
				Call SalSendClassMessage( SAM_Create, 0, 0 )
	Form Window: frm_VypB    ! 05 - Розбір виписок з КБ
		Class: cGenericTableSpl2
		Property Template:
		Class DLL Name:
		Title: Розбір виписок з КБ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.35"
				Top:    1.792"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Розбір виписок по валютних рахунках для ДКУ
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndLost, UM_Update, 0, 0)
				Line
					Resource Id: 56339
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If tbl2.colRef
								Call DocViewContentsEx(hWndMDI, tbl2.colRef)
						On SAM_Create
							Set strTip = 'Документ '
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 56340
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 56341
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbImport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_DOWN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Імпорт файлів виписок'
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 0)
							! Call SalSendMsg(pbRun,SAM_Click, 0, 0)
				Custom Control: ccProgressBar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cMeter
					Property Template:
					Class DLL Name:
					Display Settings
						DLL Name:
						MS Windows Class Name:
						Style:  Class Default
						ExStyle:  Class Default
						Title:
						Window Location and Size
							Left:   7.083"
							Top:    0.071"
							Width:  3.983"
							Width Editable? Class Default
							Height: 0.25"
							Height Editable? Class Default
						Visible? Yes
						Border? Class Default
						Etched Border? Class Default
						Hollow? Class Default
						Vertical Scroll? Class Default
						Horizontal Scroll? Class Default
						Tab Stop? Class Default
						Tile To Parent? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Dark Blue
						Background Color: 3D Face Color
						DLL Settings
					Message Actions
						On SAM_Create
							Call SalSetFocus( hWndItem )
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Опл
					Window Location and Size
						Left:   4.786"
						Top:    0.073"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set cb1=TRUE
						On SAM_Click
							Call SalSendMsg(tbl,UM_Populate,0,0)
				Pushbutton: Unzip
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: Zip
					Window Location and Size
						Left:   11.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bProcesd=FALSE
							Set nFiles  = VisDosEnumFiles (sVypDirZip||'*.*', FA_Archive, sFiles)
							If nFiles > 0
								Set nFiles=VisArraySort (sFiles, SORT_Descending, DT_String)
								While nFiles>0
									Set nFiles=nFiles-1
									If SalLoadAppAndWait (sPkUnzip||' '||sVypDirZip||sFiles[nFiles]||' '||sVypDir,5,nRet)
										! Call Debug('D:\\TOOLS\\pkunzip.exe '||sVypDirZip||sFiles[nFiles]||' '||sVypDir)
										Set bProcesd=TRUE
										!
										Set YYMMDD=SalFmtFormatDateTime( dDat, 'yyMMdd' )
										Set strBackUpPath=sVypDirZip||'\\'||YYMMDD
										If not VisDosExist(strBackUpPath)
											If not SalFileCreateDirectory( strBackUpPath )
												Call SalMessageBox( 'Не могу создать каталог:'||strBackUpPath, 'Внимание', MB_IconStop )
										Call SalFileCopy( sVypDirZip||sFiles[nFiles], strBackUpPath||'\\'||sFiles[nFiles], TRUE )
										Call SalFileOpen( hFile, sVypDirZip||sFiles[nFiles], OF_Delete )
									Else
										Call Debug('Ошибка! D:\\TOOLS\\pkunzip.exe '||sVypDirZip||sFiles[nFiles]||' '||sVypDir||'-'||Str(nRet))
							If not bProcesd
								Call MessageAttention('Нема ZIP файлів виписок: ' || sVypDirZip)
				Pushbutton: pbKill
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.133"
						Top:    0.107"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: F8
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							! Set strTip = 'ИЗ\'ЯТЬ документ'
							! Set strTip = CurrentLangTable.GetAtomTitle('tbl_ListDocs.cBTipKill')
						On SAM_Click
							If SalTblAnyRows(tbl2, ROW_Selected, 0)
								Set sTmp = ' док. РЕФ.№' || Str(tbl2.colRef)
								Set errTxt=''
								Set nCurRow2 = SalTblQueryContext ( tbl2 )
								If tbl2.colRef and tbl2.colS
									If MessageQuestion('Виконати СТОРНО ' || sTmp || ' на сумму ' || Str(tbl2.colS) || ' ?') != IDYES
										Return FALSE
									Loop
										If not SqlPrepareAndExecute(hSqlAux(),
												"SELECT 1 INTO :nFetchRes FROM vyp_doc WHERE ROWID=:tbl2.colRowID 
												 AND EXISTS (SELECT 1 FROM opldok WHERE fdat=:dDat AND ref=:tbl2.colRef) FOR UPDATE OF sos NOWAIT")
											Set errTxt='Немає доступу до'
											Break
										If not SqlFetchNext(hSqlAux(),nFetchRes)
											Set errTxt='Не за поточну дату'
											Break
										If not SqlPLSQLCommand( hSqlAux(),"gl.bck(tbl2.colRef,9)")
											Set errTxt='Помилка 1 вилучення'
											Break
										If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_doc SET ref=NULL,sos=0 WHERE ROWID=:tbl2.colRowID")
											Set errTxt='Помилка 2 вилучення'
											Break
										If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_zag SET nopl=nopl+1 WHERE id=:tbl2.colId")
											Set errTxt='Помилка 3 вилучення'
											Break
										Call SqlCommitEx( hSqlAux(), 'Вилучили ' || sTmp )
										Call MessageInfo('Успішно СТОРНО '|| sTmp)
										Break
									Call SqlRollback(hSqlAux())
									If errTxt
										Call MessageError(errTxt || sTmp )
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
		Contents
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl2
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? Class Default
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: #
								вип.
						Visible? Yes
						Editable? No
						Maximum Data Length: 10
						Data Type: String
						Justify: Left
						Width:  0.543"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colMFO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: МФО
								банку
						Visible? Yes
						Editable? No
						Maximum Data Length: 10
						Data Type: String
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ім"я
								файлу вип.
						Visible? Yes
						Editable? No
						Maximum Data Length: 24
						Data Type: String
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								імпорту
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.267"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDATV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								виписки
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.267"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								вал.
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.743"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рахунок
								в банку
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOST_VH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Початкове
								сальдо
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOST_IS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кінцеве
								сальдо
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOST_ISNO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вихідне сальдо
								НОСТРО
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSDE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Обороти
								Дебет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSKR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Обороти
								Кредит
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNOPL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Неопл.
						Visible? Yes
						Editable? No
						Maximum Data Length: 1
						Data Type: Number
						Justify: Right
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nMinRow
					Number: nMaxRow
					Number: nRow
					Number: nTmp
					Date/Time: dTmp
				Message Actions
					On UM_Populate
						Set frm_VypB.strSqlPopulate = '
								    SELECT a.id,a.mfo,a.fn,a.dat,a.vdat,a.kv,a.nls,a.ost_vx/100,a.ost_is/100,a.sde/100,a.skr/100,a.nopl
								      FROM vyp_zag a '||
								    IifS(cb1,' WHERE a.nopl>0','') ||' ORDER BY vdat DESC,mfo,nls,kv
								     INTO :frm_VypB.tbl.colID,
								          :frm_VypB.tbl.colMFO,
								          :frm_VypB.tbl.colFN,
								          :frm_VypB.tbl.colDAT,
								          :frm_VypB.tbl.colDATV,
								          :frm_VypB.tbl.colKV,
								          :frm_VypB.tbl.colNLS,
								          :frm_VypB.tbl.colOST_VH,
								          :frm_VypB.tbl.colOST_IS,
								          :frm_VypB.tbl.colSDE,
								          :frm_VypB.tbl.colSKR,
								          :frm_VypB.tbl.colNOPL '
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
						! ! Установить на старое место
						Set nCurRow = VisTblFindString (tbl, 0, colID, sID) !--VisTblFindString (tbl, 0, colNlsA, sNls)
						If nCurRow=-1
							Call SalTblSetContext( tbl, 0 )
						Else
							Call SalTblSetContext( tbl, nCurRow )
							Call SalTblSetRowFlags( tbl, nCurRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( tbl, nCurRow )
						Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
					On SAM_TblDoDetails
						Call SalSendMsg(tbl2,UM_Populate,0,0)
					On SAM_KillFocus
						Set hWndLost=hWndForm
						Set sID=colID
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					On UM_Update
						Call SalWaitCursor(TRUE)
						Set nRow = TBL_MinRow
						While SalTblFindNextRow ( hWndForm, nRow, ROW_MarkDeleted, 0 )
							Call SalTblSetContext( hWndForm, nRow )
							Call SalMessageBeep(MB_IconQuestion)
							If SalMessageBox('Вилучити виписку по рах. '||colNLS||'('||Str(colKV)||') за дату '||SalFmtFormatDateTime ( colDATV, 'dd/MM/yyyy' )||' з розбору виписки ?',
									'Увага!', MB_IconQuestion | MB_YesNo) != IDYES
								Break
							Call SaveInfoToLog('Вилучення виписки по рах. '||colNLS||'('||Str(colKV)||') за дату '||SalFmtFormatDateTime ( colDATV, 'dd/MM/yyyy' ))
							If not SqlPrepareAndExecute( hSqlAux(),"DELETE FROM vyp_doc WHERE id=:colID")
								Break
							If not SqlPrepareAndExecute( hSqlAux(),"DELETE FROM vyp_zag WHERE id=:colID")
								Break
							Call SqlCommit(hSqlAux())
						Call SqlRollback(hSqlAux())
						Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						Set dTmp = colDATV + IifN(SalDateWeekday ( colDATV )=6,3,1)
						If SqlPrepareAndExecute(hSqlAux(),
								" SELECT -ost/100 INTO :colOST_ISNO FROM sal s 
								   WHERE s.fdat = :dTmp
								     AND (s.nls,s.kv) IN ( SELECT nls,kv FROM vyp_nls n WHERE n.nlsv=:colNLS AND n.kv=:colKV )" )
								and SqlFetchNext(hSqlAux(), nFetchRes )
						If colOST_ISNO=colOST_IS
							Call XSalTblSetRowBackColor( hWndForm,lParam,COLOR_LightGreen)
			Custom Control: ccSplitter
				Class Child Ref Key: 33
				Class ChildKey: 0
				Class: cGenericTableSpl2
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl2
				Class Child Ref Key: 35
				Class ChildKey: 0
				Class: cGenericTableSpl2
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.329"
						Top:    3.021"
						Width:  11.857"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? Class Default
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: #
								вип.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.557"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDatV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								зарахування
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  Class Default
						Width Editable? Class Default
						Format: Date
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNlsK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рах.
								відправника
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKv
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								вал.
						Visible? Class Default
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.7"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер
								документа
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сума
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сума
								Деб.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSdQ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Еквівалент
								Деб.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сума
								Кред.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSkQ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Еквівалент
								Кред.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSos
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Відм.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSndr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
								Відправника
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRcvr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
								Отримувача
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNazn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Призначення платежу
						Visible? Class Default
						Editable? No
						Maximum Data Length: 160
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRowID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: SetColorRow
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nInd
						Actions
							If tbl2.colSd > 0
								Set nInd=COLOR_Red
							Else If tbl2.colSk > 0
								Set nInd=COLOR_DarkBlue
							Else
								Set nInd=COLOR_Black
							Call SalTblSetCellTextColor( tbl2.colS, nInd, FALSE )
							Call XSalTblSetRowBackColor( tbl2,lParam,IifN(colSos=5,COLOR_LightGreen,IifN(colSos=-1,SalColorFromRGB(255, 221, 249),COLOR_White)))
				Window Variables
					String: sNlsA
					String: sNlsB
					Number: nMinRow
					Number: nMaxRow
					Number: nRow
					Number: nTmp
					Number: nS
					Number: nN
					Number: nPvt
				Message Actions
					On UM_Populate
						Set strSqlPopulate='SELECT id,ref,vdat,nlsk,kv,nd,sd/100,sdq/100,sk/100,skq/100,sos,namk,NULL,nazn,ROWID
								    INTO :frm_VypB.tbl2.colId, :frm_VypB.tbl2.colRef, :frm_VypB.tbl2.colDatV,:frm_VypB.tbl2.colNlsK,:frm_VypB.tbl2.colKv,:frm_VypB.tbl2.colNd,
								         :frm_VypB.tbl2.colSd, :frm_VypB.tbl2.colSdQ, :frm_VypB.tbl2.colSk,  :frm_VypB.tbl2.colSkQ,
								         :frm_VypB.tbl2.colSos,:frm_VypB.tbl2.colSndr,:frm_VypB.tbl2.colRcvr,:frm_VypB.tbl2.colNazn, :frm_VypB.tbl2.colRowID
								    FROM vyp_doc WHERE id=:frm_VypB.tbl.colID '||IifS(cb1,'AND NVL(sos,0)=0','')||' ORDER BY sk,sd'
						Set nS=0
						Set nN=0
						Call SalSendClassMessage(UM_Populate, 0, 0)
						! Считать итог  Call SalWaitCursor(FALSE)
						Call SalTblDefineSplitWindow ( tbl2, 1, TRUE )
						Set nTmp=SalTblInsertRow (  tbl2, TBL_MinRow )
						Call SalTblSetContext ( tbl2, nTmp)
						Call SalTblSetRowFlags( tbl2, nTmp, ROW_New, FALSE )
						Set tbl2.colS=nS
						Set tbl2.colKv=nN
						!
						Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
						! ! Установить на старое место
						Call SalTblQueryScroll ( hWndForm, nTmp, nMinRow, nMaxRow )
						If nCurRow2 > nMaxRow
							Set nCurRow2=nMaxRow
						Call SalTblSetContext( hWndForm, nCurRow2 )
						Call SalTblSetRowFlags( hWndForm, nCurRow2, ROW_Selected, TRUE )
						Call SalTblSetFocusRow( hWndForm, nCurRow2 )
						!
					On SAM_DoubleClick
						If tbl2.colSk>0 or tbl2.colSd>0 
							Set nPvt=1   ! оттнимать от общего счетчика док
							If not(tbl2.colSos=0 and frm_VypB.tbl2.colRef = NUMBER_Null)
								Call SalMessageBox( 'Цей документ виписки вже було оброблено.', 'Увага!', MB_IconQuestion )
								Return FALSE
								! If SalMessageBox( 'Цей документ виписки вже було оброблено.
										Виконати повторно?', 'Увага!', MB_IconQuestion | MB_YesNo ) != IDYES
									                                                                Return FALSE
								! Call SaveFInfoToLog('Користувая вибрав ПОВТОРНУ обробку док.'||tbl2.colNd)
								! Set nPvt=0    ! не оттнимать от общего счетчика док
							Call SalDisableWindow(tbl2)
							Call SqlPrepareAndExecute(hSql(),
									"SELECT 1 INTO :nFetchRes FROM vyp_doc WHERE ROWID=:tbl2.colRowID FOR UPDATE OF sos NOWAIT")
							If not SqlFetchNext(hSql(),nFetchRes)
								Call SqlRollback(hSql())
								Call MessageErrorEx('Неможливо отримати доступ до документу '||tbl2.colNd||' на суму '||Str(IifN(tbl2.colSd=0,tbl2.colSk,tbl2.colSd)))
								Return FALSE 
							If tbl.colNLS
								Call SqlPrepareAndExecute(hSql(),"SELECT nls INTO :sNlsA FROM vyp_nls WHERE nlsv=:tbl.colNLS and kv=:tbl.colKV")
								Call SqlFetchNext(hSql(),nFetchRes)
							! Call DebugN(IifN(tbl2.colSd=0,tbl2.colSk,tbl2.colSd))
							Call SalCreateWindow( frmDoc, hWndMDI, frm_VypB,
									     tbl, tbl2.colId, tbl2.colRowID, tbl2.colNd, '003', tbl2.colKv, IifN(tbl2.colSd=0,tbl2.colSk,tbl2.colSd),
									     tbl2.colSndr, tbl2.colRcvr, sNlsA, sNlsB, tbl2.colNazn, tbl2.colDatV, 
									   ' and t.tt IN (SELECT tt from vyp_tt ) and t.dk='||IifS(tbl2.colSd=0,'1','0')||IifS(tbl2.colKv=980,' and t.flv=0',''), nPvt )
					On SAM_KillFocus
						Set nCurRow2 = SalTblQueryContext ( tbl2 )
						Set hWndLost=hWndForm
					On SAM_FetchRowDone
						Call SetColorRow()
						Set tbl2.colS=IifN(tbl2.colSd=0,tbl2.colSk,tbl2.colSd)
						Set nS=nS+tbl2.colS
						Set nN=nN+1
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					On UM_Update
						Call SalWaitCursor(TRUE)
						Set nRow = TBL_MinRow
						While SalTblFindNextRow ( hWndForm, nRow, ROW_MarkDeleted, 0 )
							Call SalTblSetContext( hWndForm, nRow )
							If colS>0 and colSos=0
								Call SalMessageBeep(MB_IconQuestion)
								If SalMessageBox('Вилучити документ '||colNd||' на суму '||Str(colS)||' з розбору виписки ?',
										'Увага!', MB_IconQuestion | MB_YesNo) != IDYES
									Break
								Call SaveInfoToLog('Вилучення рядка виписки документ '||colNd||' на суму '||Str(colS))
								If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_doc SET sos=-1 WHERE ROWID=:colRowID")
									Break
								If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_zag SET nopl=nopl-1 WHERE id=:colId")
									Break
								Call SqlCommit(hSqlAux())
						Call SqlRollback(hSqlAux())
						Call SalSendMsg(tbl, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On SAM_CaptionDoubleClick
						Call SalTblSortRows(hWndForm,SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), TBL_SortIncreasing)
		Functions
			Function: Vyp_imp
				Description: Импорт выписок 
				Returns
					Boolean:
				Parameters
					String: strFilePath
					String: strFileName
				Static Variables
				Local variables
					File Handle: hF
					Long String: strBuffer
					!
					String: strHFName
					String: strHMfo
					Number: nHLines
					Boolean: fProcError
					!
					Number: nIterator
					String: strOKPO
					Number: nTgr
					Number: nAct
					Number: nObl
					String: strDt
					String: strKkd
					String: strSum
					String: strFond
					String: strKmis
					String: strNdov
					Date/Time: dDdov
					Number: nKmis
					Number: nSum
					Date/Time: dDt
					String: strId_Key
					String: strBackUpPath
					String: YYMMDD
					File Handle: hFile
					Boolean: bZag
					Number: i
				Actions
					If VisFileOpen( hF, strFilePath || strFileName, OF_Binary | OF_Read ) != VTERR_Ok
						Call SalMessageBeep( MB_IconStop )
						Call SaveErrorToLog( 'Невозможно открыть файл ' || strFilePath )
						Call SalMessageBox( 'Невозможно открыть файл ' || strFilePath, 'Ошибка!', MB_IconStop | MB_Ok )
						Return FALSE
					Call SalWaitCursor(TRUE)
					Call SalStatusSetText ( hWndForm, strFilePath || strFileName )
					Call SalShowWindow(ccProgressBar)
					Call SqlPLSQLCommand(hSql(),"dbf.op(0)")
					Loop
						! Call ccProgressBar.SetProgress( nIterator / nHLines * 100)
						Call SalStrSetBufferLength(strBuffer, 2901)
						Set i = VisFileRead(hF, strBuffer, 2900)
						Call SalStrSetBufferLength(strBuffer, i+1)
						If not SqlPLSQLCommand(hSql(),"dbf.ap(strBuffer)" )
							Call SqlRollbackEx(hSql(),'Помилка 1 імпорту файлу '||strFileName)
							Call VisFileClose ( hF )
							Return FALSE
						If i<2900
							Break
					If not SqlPLSQLCommand(hSql(),"vyp_imp(strFileName)")
						Call SqlRollbackEx(hSql(),'Помилка 2 імпорту файлу '||strFileName)
						Call VisFileClose ( hF )
						Return FALSE
					Call SqlCommitEx( hSql(), 'Обработка файла ' || strFilePath || strFileName || ' закончена' )
					Call VisFileClose ( hF )
					! BackUp
					Call SalStatusSetText ( hWndForm, 'BackUp' )
					Set YYMMDD=SalFmtFormatDateTime( dDat, 'yyMMdd' )
					Set strBackUpPath=strFilePath||'\\'||YYMMDD
					If not VisDosExist(strBackUpPath)
						If not SalFileCreateDirectory( strBackUpPath )
							Call SalMessageBox( 'Не могу создать каталог:'||strBackUpPath, 'Внимание', MB_IconStop )
					Call SalFileCopy( strFilePath||strFileName, strBackUpPath||'\\'||strFileName, TRUE )
					Call SalFileOpen( hFile, strFilePath||strFileName, OF_Delete )
					Call SalHideWindow(ccProgressBar)
					Call SalWaitCursor(FALSE)
					Call SalStatusSetText ( hWndForm, 'Готово' )
		Window Parameters
			Number: nPar     ! не использ
			String: sFlags   ! кнопки+признаки     '11111,V' (мультивал)
			String: sFilt    ! Предустановленный фильтер
		Window Variables
			Number: nKv
			Date/Time: dDat
			String: sAMFO
			String: sFlagI
			!
			String: sCurTT
			String: strTTArr[*,2]
			String: strTT
			String: strTTName
			Number: nTTArr
			!
			! String: sPref
			String: sVypDir
			String: sVypDirZip
			String: sFiles[*]
			Boolean: bProcesd
			Number: i
			Number: nFiles
			Number: nUserId
			String: sMask[*]
			!
			Number: nRet
			String: strBackUpPath
			String: YYMMDD
			File Handle: hFile
			String: sPkUnzip
			Window Handle: hWndLost
			String: sTmp
			String: sID
			Number: nCurRow
			Number: nCurRow2
			String: errTxt
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call ShowApdVersion('05')
				Set frm_VypB.nFlags=GT_NoRet | GT_NoIns 
				!
				Call SalUseRegistry(TRUE, GetCompanyName())
				Call SalGetProfileString('Credit&Loans', 'UnarchCommand', 'pkunzip', sPkUnzip, GetProductName())
				! Call Debug(sPkUnzip)
				! Каталог для импорта выписок
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('Directory', 'ImpVypDir', GetPrnDir(), sVypDir, GetIniFileName())
				Set sVypDir = sVypDir || IifS(Right(sVypDir, 1)='\\', '', '\\')
				! Каталог для зазипованых файлов 
				Call SalGetProfileString('Import', 'VypZipPath', GetPrnDir(), sVypDirZip, GetIniFileName())
				Set sVypDirZip = sVypDirZip || IifS(Right(sVypDirZip, 1)='\\', '', '\\')
				! флаги управления окном
				If SalStrScan(sFlags,',')>=0
					Set sFlagI=SalStrLeftX(sFlags,SalStrScan(sFlags,','))||'1111111'
				Else
					Set sFlagI=sFlags||'1111111'
				!
				Set nUserId = GetUserId()
				Set nKv      = GetBaseVal()
				Set dDat     = GetBankDate()
				Set sAMFO    = GetBankMfo()
				Set frm_VypB.nTabInstance1 = 1
				Set frm_VypB.nTabInstance2 = 1
				Set strFilterTblName = 'vyp_zag'
				Set strPrintFileName = 'VYP.txt'
				Call SalTblSetTableFlags(tbl, TBL_Flag_SingleSelection, TRUE)
				! Созданием списка операций для обработки
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call ccSplitter.setBarPosition( 330 )
				Call tbl.cF.Init(strFilterTblName, 'a')
			On UM_ObjActivate
				Set bProcesd=FALSE
				Set i=0
				Set sMask[0]='20??????.DBF'  !-- Ексім поточна
				Set sMask[1]='N???D???.???'  !-- Ексім текстова
				Set sMask[2]='*_20??????.DBF'   !-- Ексім кліент-Банк  (Стар/Новый)
				Set sMask[3]='C???????.U??'        !-- НБУ клієнт-Банк
				While i<4
					Set nFiles  = VisDosEnumFiles (sVypDir||sMask[i], FA_Archive, sFiles)
					If nFiles > 0
						Set nFiles=VisArraySort (sFiles, SORT_Descending, DT_String)
						While nFiles>0
							Set nFiles=nFiles-1
							Call Vyp_imp(sVypDir,sFiles[nFiles])
							Set bProcesd=TRUE
					Set i=i+1
				If bProcesd
					Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Else
					Call MessageAttention('Нема файлів виписок: ' || sVypDir)
			On UM_ObjDeactivate
				If lParam
					Call SalDisableWindow(pbRefresh)
					Call SalDisableWindow(pbUpdate)
					Call SalDisableWindow(pbSearch)
					Call SalDisableWindow(pbFilter)
					Call SalDisableWindow(pbDetails)
					Call SalDisableWindow(pbPrint)
					Call SalDisableWindow(tbl)
					Call SalDisableWindow(tbl2)
				Else
					Call SalEnableWindow(pbRefresh)
					Call SalEnableWindow(pbUpdate)
					Call SalEnableWindow(pbSearch)
					Call SalEnableWindow(pbFilter)
					Call SalEnableWindow(pbDetails)
					Call SalEnableWindow(pbPrint)
					Call SalEnableWindow(tbl)
					Call SalEnableWindow(tbl2)
	Form Window: frmDoc
		Class: cDocW
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Зарахування надходжень по виписці
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbPayDoc
					Class Child Ref Key: 27
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 29
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrtDoc
					Class Child Ref Key: 30
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7374
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text:
					Resource Id: 7375
					Class Child Ref Key: 75
					Class ChildKey: 0
					Class: cDocW
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Justify: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Line
					Resource Id: 7376
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 7377
					Class Child Ref Key: 59
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfZn
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfOst
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pbNewDoc
					Class Child Ref Key: 53
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call SalDisableWindow(hWndItem)
				Pushbutton: pbNewTTs
					Class Child Ref Key: 60
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call SalDisableWindow(hWndItem)
				Pushbutton: pbDocBal
					Class Child Ref Key: 72
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHelp
					Class Child Ref Key: 62
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSaveKor
					Class Child Ref Key: 64
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbLocalD
					Class Child Ref Key: 148
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7378
					Class Child Ref Key: 77
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbHotVytyag
					Class Child Ref Key: 138
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotFio
					Class Child Ref Key: 141
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotName
					Class Child Ref Key: 137
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotOstat
					Class Child Ref Key: 150
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Data Field: dfValD1
				Class Child Ref Key: 25
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbVob
				Class Child Ref Key: 39
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text:
				Resource Id: 7373
				Class Child Ref Key: 36
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfNd
				Class Child Ref Key: 23
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDateFrom
				Class Child Ref Key: 155
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDocD
				Class Child Ref Key: 22
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankA
				Class Child Ref Key: 4
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvA
				Class Child Ref Key: 50
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsA
				Class Child Ref Key: 2
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPlat
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamA
				Class Child Ref Key: 7
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call frmDoc.UnHideIt( hWndItem )
						If sSndr
							Set dfNamA = sSndr
			Data Field: dfOkpoA
				Class Child Ref Key: 139
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call frmDoc.UnHideIt( hWndItem )
			Data Field: dfPlatB
				Class Child Ref Key: 9
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbA
				Class Child Ref Key: 6
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankB
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPoluB
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbB
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvB
				Class Child Ref Key: 51
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsB
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfPolu
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamB
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfOkpoB
				Class Child Ref Key: 140
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNA
				Class Child Ref Key: 135
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumA
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						If nAmnt
							Set dfSumA=nAmnt
							! Call DebugN(nAmnt)
							Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
							Call SalSendMsg( dfKvA, UM_Update, 0, 0 )
							Set frmDoc.nS=nAmnt
						Call SalSendClassMessage(SAM_Create, 0, 0)
			Data Field: dfSumNB
				Class Child Ref Key: 122
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumB
				Class Child Ref Key: 21
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						! Call SalSendMsg( dfKvB, UM_Update, 0, 0 )
						Call SalSendClassMessage(SAM_Create, 0, 0)
			Data Field: dfRatNomN
				Class Child Ref Key: 123
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNom
				Class Child Ref Key: 57
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNC
				Class Child Ref Key: 125
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumC
				Class Child Ref Key: 44
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquivN
				Class Child Ref Key: 144
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquiv
				Class Child Ref Key: 145
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			List Box: lb1
				Class Child Ref Key: 85
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
			Multiline Field: dfNazn
				Class Child Ref Key: 24
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					String Type: Class Default
					Editable? Class Default
				Display Settings
					Border? Class Default
					Word Wrap? Class Default
					Vertical Scroll? Class Default
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Message Actions
					On SAM_Create
						Set dfNazn=strNazn
						Call SalSendClassMessage( SAM_Create, 0, 0 )
			Data Field: dfSkN
				Class Child Ref Key: 115
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSk
				Class Child Ref Key: 48
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD1N
				Class Child Ref Key: 160
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2N
				Class Child Ref Key: 131
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2
				Class Child Ref Key: 66
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfD
				Class Child Ref Key: 132
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfK
				Class Child Ref Key: 133
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfLocDat
				Class Child Ref Key: 149
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbUgrnt
				Class Child Ref Key: 130
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfVytyagN
				Class Child Ref Key: 142
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Picture: pic1f
				Class Child Ref Key: 156
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Picture: pic2f
				Class Child Ref Key: 157
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Picture: pic3f
				Class Child Ref Key: 158
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfSub
				Class Child Ref Key: 167
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSubN
				Class Child Ref Key: 166
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
			Function: oDoc
				Description: Вставить и оплатить документ
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nDelta
				Actions
					Set nDelta = nAmnt*SalNumberPower(10, nDigA)-frmDoc.A.S
					! Call Debug('Дельта '||Str(nDelta))
					If nDelta>=0
						If cDocW.oDoc()
							If nDelta
								If not SqlPrepareAndExecute( hSqlAux(),
										   "INSERT INTO vyp_doc ( id, ref, vdat,  nlsk, kv , namk, nd, sos, nazn,"||
										    IifS(frmDoc.nDk=0,'sd,sdq,sk,skq','sk,skq,sd,sdq')||" )
										    SELECT id,:frmDoc.m_nRef,vdat,nlsk,kv,namk,nd,5,nazn,:frmDoc.A.S,:frmDoc.B.S,0,0 FROM vyp_doc WHERE ROWID=:sRowID")
									Return FALSE
								If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_doc SET "||
										IifS(frmDoc.nDk=0,'sd=sd-',  'sk=sk-')  ||":frmDoc.A.S,"||
										IifS(frmDoc.nDk=0,'sdq=sdq-','skq=skq-')||":frmDoc.B.S WHERE ROWID=:sRowID")
									Return FALSE
							Else
								If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_doc SET ref=:frmDoc.m_nRef,sos=5 WHERE ROWID=:sRowID")
									Return FALSE
								If not SqlPrepareAndExecute( hSqlAux(),"UPDATE vyp_zag SET nopl=nopl-:nPvt WHERE id=:nId")
									Return FALSE
							Return TRUE
					Return FALSE
			Function: iDoc
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If GetGlobalOption('VYP_FAKT')
						Set cDocW.m_nFlg=1   ! Платить только по факту 
					Return cDocW.iDoc()
		Window Parameters
			Window Handle: hWnd    ! Родительское окно
			Window Handle: hWndTbl ! Родительская таблица
			Number: nId         ! Номер виписки
			String: sRowID	    ! ROWID для отметки
			String: sNd         ! Номер документа
			String: sSWT_TT     ! Код операции
			Number: nKv         ! Код валюты 
			Number: nAmnt       ! Сумма
			String: sSndr       ! Отправитель
			String: sRcvr       ! Получатель
			String: strNlsA     ! Счет А
			String: strNlsB     ! Счет Б
			String: strNazn     ! Назначение платежа
			Date/Time: dtVDat   ! Дата валютирования
			String: strFilter   ! Фильтр допустимых операций
			Number: nPvt        ! Флаг повторного розбору  0-повтор  1-нормальний
		Window Variables
		Message Actions
			On SAM_Create
				Set sTTFilter=strFilter
				Call SalSendMsg(hWnd,UM_ObjDeactivate, 0, 1)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Insert
				If SalDateMonth( dfValD1 ) < SalDateMonth( GetBankDate() ) and SalDateYear( dfValD1 ) = SalDateYear( GetBankDate() )
						or SalDateYear( dfValD1 ) < SalDateYear( GetBankDate() )
					Set nVob=96
					! Call DebugN(nVob)
				Call SalSendClassMessage(UM_Insert, 0, 0)
				Call SalDisableWindow(pbNewDoc)
			On SAM_Destroy
				Call SqlRollback(hSql())   ! Разлочим если чего залочили
				Call SalSendMsg( hWnd,UM_ObjDeactivate, 0, 0)
				Call SalSendMsg( hWndTbl, UM_Populate, 0, 0)
				Call SalSetFocus(hWndTbl)
			On UM_Clear
				Set nKvA_TT=nKv
				Set sDeb_Up='Y'
				Set sNlsA_TT=strNlsA
				! Set sNlsB_TT=strNlsB
				Set bFixValD1 = TRUE
				Set dFixValD1 = dtVDat
				Call SalSendClassMessage(UM_Clear, 0, 0)
				Set dfNd=sNd
	Form Window: splOp3522   ! 05 - Відкриття рахунків власних надходжень
		Class: cGenericTableSpl2
		Property Template:
		Class DLL Name:
		Title: Рахунки за власними надходженнями розпорядників
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.823"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Відкриття рахунків власних надходжень
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 64060
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 64061
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 64062
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl2
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbImport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.086"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_DOWN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Імпорт файлів-заявок на відкриття рахунків'
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 0)
							Call SalSendMsg(pbRefresh,SAM_Click, 0, 0)
				Custom Control: ccProgressBar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cMeter
					Property Template:
					Class DLL Name:
					Display Settings
						DLL Name:
						MS Windows Class Name:
						Style:  Class Default
						ExStyle:  Class Default
						Title:
						Window Location and Size
							Left:   8.986"
							Top:    0.071"
							Width:  3.983"
							Width Editable? Class Default
							Height: 0.25"
							Height Editable? Class Default
						Visible? Yes
						Border? Class Default
						Etched Border? Class Default
						Hollow? Class Default
						Vertical Scroll? Class Default
						Horizontal Scroll? Class Default
						Tab Stop? Class Default
						Tile To Parent? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Dark Blue
						Background Color: 3D Face Color
						DLL Settings
					Message Actions
						On SAM_Create
							Call SalSetFocus( hWndItem )
		Contents
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl2
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: colNLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реєстраційний
								рахунок
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Left
						Width:  1.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва 
								рахунку
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Left
						Width:  3.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.543"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKPK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: КПК
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 7
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKTK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: КТК
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 8
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKTKname
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Назва
								території
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If colKTKname.Init(hWndItem)
									Call colKTKname.Populate(hSql(), 'obl||tw_rn||sr_pg||selo', "id_key||' '||nu", 'tl_terra', "WHERE obl=:splOp3522.sObl AND INSTR('01234569',type)>0 ORDER BY id_key")
							On SAM_AnyEdit
								! Call hWndParent.Frm_Customer.IsEdited()
								Set tbl.colKTK = splOp3522.tbl.colKTKname.GetKey(
										    SalListQuerySelection(colKTKname))
				Functions
				Window Variables
					Number: nMinRow
					Number: nMaxRow
					Number: nTmp
					Number: nRow
				Message Actions
					On UM_Populate
						Set splOp3522.strSqlPopulate = "
								    SELECT a.nls,a.nms,a.acc,s.ktk,s.kpk
								     FROM accounts a, specparam s WHERE a.acc=s.acc (+) AND a.dazs IS NULL"
								     || IifS(SalStrLength(SalStrTrimX(sFilt)),' AND '||sFilt,'')
								     ||' ORDER BY nls 
								 INTO     :splOp3522.tbl.colNLS,
								          :splOp3522.tbl.colNMS,
								          :splOp3522.tbl.colACC,
								          :splOp3522.tbl.colKTK,
								          :splOp3522.tbl.colKPK'
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call VisTblAutoSizeColumn(hWndForm, tbl.colNMS)
						! ! Установить на старое место
						Set nRow = VisTblFindString (tbl, 0, colNLS, sNls)
						If nRow=-1
							Call SalTblSetContext( hWndForm, 0 )
						Else
							Call SalTblSetContext( hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( hWndForm, nRow )
						! Call SalTblQueryScroll ( tbl, nTmp, nMinRow, nMaxRow )
						! If nCurRow1 > nMaxRow
							                                                                                                         Set nCurRow1=nMaxRow
						! Call SalTblSetContext( tbl, nCurRow1 )
						! Call SalTblSetRowFlags( tbl, nCurRow1, ROW_Selected, TRUE )
						! Call SalTblSetFocusRow( tbl, nCurRow1 )
						Call SalSendMsg(tbl, SAM_TblDoDetails, 0, 0)
					On UM_Update
						! Set splOp3522.strSqlUpdate='UPDATE specparam SET kpk=:splOp3522.tbl.colKPK WHERE acc=:splOp3522.tbl.colACC'
						! Call SalSendClassMessage( UM_Update, 0, 0 )
						Call SalSendMsg(tbl2, UM_Update, 0, 0)
					! On UM_Update
						                                                                                                          Call SalWaitCursor(TRUE)
						                                                                                                          Set nRow = TBL_MinRow
						                                                                                                          Set nTmp = 0
						                                                                                                          While SalTblFindNextRow ( hWndForm, nRow, 0, ROW_MarkDeleted )
							                                                                                                          Call SalTblSetContext( hWndForm, nRow )
							                                                                                                          If not SqlPLSQLCommand(hSql(),"a3125(splOp3522.tbl2.colKkd,splOp3522.tbl.colKPK,splOp3522.tbl.colKTK,splOp3522.tbl.colACC)")
								                                                                                                          Break 
							                                                                                                          Set nTmp=nTmp+colKoef
						                                                                                                          If not nSch
							                                                                                                          Set nSch=SalStrToNumber( tbl.colNlsA )
							                                                                                                          Set tbl.colIds=nSch
						                                                                                                          Call SqlPrepareAndExecute( hSql(), 'SELECT ids FROM perekr_s WHERE ids=:nSch')
						                                                                                                          If not SqlFetchNext(hSql(),nFetchRes)
							                                                                                                          Set sTmp='Схема для рах.'||tbl.colNlsA
							                                                                                                          Call SqlPrepareAndExecute( hSql(), 'INSERT INTO perekr_s (ids,name) VALUES (:nSch,:sTmp)')
							                                                                                                          Call SalTblSetRowFlags( tbl, SalTblQueryContext( tbl ), ROW_Edited, TRUE )
						                                                                                                          If nTmp = 1 or nTmp=0
							                                                                                                          Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
							                                                                                                          If strSqlDelete != ''
								                                                                                                          Call SqlPrepare(tbl.cMain.hSql(), T(strSqlDelete))
								                                                                                                          Call SalTblDoDeletes(hWndForm, tbl.cMain.hSql(), ROW_MarkDeleted)
							                                                                                                          If strSqlInsert != ''
								                                                                                                          Call SqlPrepare(tbl.cMain.hSql(), T(strSqlInsert))
								                                                                                                          Call SalTblDoInserts(hWndForm, tbl.cMain.hSql(), TRUE)
							                                                                                                          If strSqlUpdate != ''
								                                                                                                          Call SqlPrepare(tbl.cMain.hSql(), T(strSqlUpdate))
								                                                                                                          Call SalTblDoUpdates(hWndForm, tbl.cMain.hSql(), TRUE)
							                                                                                                          Call SqlCommit(tbl.cMain.hSql())
							                                                                                                          Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
						                                                                                                          Else 
							                                                                                                          Call SqlRollback(tbl.cMain.hSql())
							                                                                                                          Call SalMessageBox( 'Сумма коеф не равна 1 ', 'Внимание', MB_IconExclamation )
						                                                                                                          Call SalWaitCursor(FALSE)
					On SAM_KillFocus
						Set nCurRow1 = SalTblQueryContext ( tbl )
						Set nCurRow2 = 0
						Set sNls=colNLS
					On SAM_FetchRowDone
						Call colKTKname.SetSelectById( colKTK )
			Custom Control: ccSplitter
				Class Child Ref Key: 33
				Class ChildKey: 0
				Class: cGenericTableSpl2
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl2
				Class Child Ref Key: 35
				Class ChildKey: 0
				Class: cGenericTableSpl2
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   10.933"
						Top:    0.274"
						Width:  5.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colOTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Відm.
								відкр.
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.557"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рахунок
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKKD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ККД
						Visible? Class Default
						Editable? No
						Maximum Data Length: 8
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNazn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nMinRow
					Number: nMaxRow
					Number: nRow
					Number: nTmp
					! Number: nCurRow
					String: KPK
					String: KTK
					String: KKD
				Message Actions
					On UM_Populate
						Set strSqlPopulate="SELECT 
								NVL(
								   (SELECT a.nls FROM accounts a, acc_3125 n, specparam s 
								     WHERE a.acc=s.acc AND s.kekd = b.kkd AND n.accr=:splOp3522.tbl.colACC 
								       AND a.acc=n.acc AND a.dazs IS NULL), 
								b.nbs||'_'||b.new_sim||'FFnnnn'), b.kkd, TRIM(SUBSTR(b.name_kkd,1,100)) FROM budj b WHERE nbs = '3125'
								    INTO :splOp3522.tbl2.colNLS, 
								         :splOp3522.tbl2.colKKD,
								         :splOp3522.tbl2.colNazn "
						! Set strSqlUpdate='UPDATE specparam SET kpk=:splOp3522.tbl.colKPK WHERE acc=:splOp3522.tbl.colACC'
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
						! ! Установить на старое место
						! Call SalTblQueryScroll ( hWndForm, nTmp, nMinRow, nMaxRow )
						! If nCurRow2 > nMaxRow
							                                                                                                          Set nCurRow2=nMaxRow
						! Call SalTblSetContext( hWndForm, nCurRow2 )
						! Call SalTblSetRowFlags( hWndForm, nCurRow2, ROW_Selected, TRUE )
						! Call SalTblSetFocusRow( hWndForm, nCurRow2 )
					On UM_Update
						Call SalWaitCursor(TRUE)
						Set nRow = TBL_MinRow
						While SalTblFindNextRow ( hWndForm, nRow, 0, 0 )
							Call SalTblSetContext( hWndForm, nRow )
							If colOTM
								Set KPK=SalStrRightX( '0000000'||SalNumberToStrX(tbl.colKPK,0), 7)
								Set KTK=SalStrRightX('00000000'||SalNumberToStrX(tbl.colKTK,0), 8)
								Set KKD=SalStrRightX( '0000000'||SalNumberToStrX(tbl2.colKKD,0), 8)
								If SqlPLSQLCommand(tbl.cMain.hSql(),"a3125(KKD, KPK, KTK, splOp3522.tbl.colACC)")
									Call SqlCommit(tbl.cMain.hSql())
								Else
									Call SqlRollback(tbl.cMain.hSql())
									Call SalMessageBox( 'Помилка виклику процедури a3125 для КЕКД '||KKD, 'Помилка', MB_IconExclamation )
									Break
							Else If SalStrRightX(splOp3522.tbl2.colNLS,6) != 'FFnnnn'
								If not SqlPrepareAndExecute(hSql(),
										 "DELETE FROM acc_3125 WHERE accr=:splOp3522.tbl.colACC AND
										  acc = (SELECT acc FROM accounts WHERE nls=:splOp3522.tbl2.colNLS AND kv=980)")
									Call SqlRollback(tbl.cMain.hSql())
									Call SalMessageBox( "Неможливо від'єднати рах. "||splOp3522.tbl2.colNLS||" від "||splOp3522.tbl.colNLS, 'Помилка', MB_IconExclamation )
									Break
						Call SalSendMsg(tbl, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						Set colOTM = IifN(SalStrRightX(colNLS,1)='n', 0, 1)
					! On SAM_KillFocus
						                                                                                                          Set nCurRow2 = SalTblQueryContext ( tbl2 )
		Functions
			Function: PutFileToLob
				Description: Загрузка данных из файла в поле BLOB с последующей записью в BLOB или CLOB
				Returns
					Boolean:
				Parameters
					String: strFilePath
					String: strFileName
				Static Variables
				Local variables
					File Handle: hF
					Long String: strBuffer
					!
					String: strHFName
					String: strHMfo
					Number: nHLines
					Boolean: fProcError
					!
					Number: nIterator
					String: strOKPO
					Number: nTgr
					Number: nAct
					! String: sObl
					String: strDt
					String: strKkd
					String: strSum
					String: strFond
					String: strKmis
					String: strNdov
					Date/Time: dDdov
					Number: nKmis
					Number: nSum
					Date/Time: dDt
					String: strId_Key
					String: strBackUpPath
					String: YYMMDD
					File Handle: hFile
					Boolean: bZag
					Number: i
				Actions
					! Это максимальный теоритический предел для вставки в БД
					! Call Debug(strFilePath || strFileName)
					If VisFileOpen( hF, strFilePath || strFileName, OF_Binary | OF_Read ) != VTERR_Ok
						Call SalMessageBeep( MB_IconStop )
						Call SaveErrorToLog( 'Невозможно открыть файл ' || strFilePath )
						Call SalMessageBox( 'Невозможно открыть файл ' || strFilePath, 'Ошибка!', MB_IconStop | MB_Ok )
						Return FALSE
					Call SalWaitCursor(TRUE)
					Call SalStatusSetText ( hWndForm, strFilePath || strFileName )
					Call SalShowWindow(ccProgressBar)
					Call SqlPLSQLCommand(hSql(),"dbf.op(0)")
					Loop
						! Call ccProgressBar.SetProgress( nIterator / nHLines * 100)
						Call SalStrSetBufferLength(strBuffer, 2901)
						Set i = VisFileRead(hF, strBuffer, 2900)
						Call SalStrSetBufferLength(strBuffer, 2901)
						If not SqlPLSQLCommand(hSql(),"dbf.pp(i+1,strBuffer)" )
						If i<2900
							Break
					Set strBuffer=
							"DECLARE"||PutLf()||
							"acc_ NUMBER;"||PutLf()|| 
							"BEGIN"||PutLf()||
							"  FOR c IN (SELECT * FROM tmp_dbf ) LOOP"||PutLf()||
							"      begin"||PutLf()||
							"         SELECT acc into acc_ FROM accounts WHERE kv=980 and nls=c.nls;"||PutLf()||
							"      exception when no_data_found then goto m1;"||PutLf()||
							"      end;"||PutLf()||
							"      a3125( c.kekd, c.kpk, c.ktk, acc_);"||PutLf()||
							"   <<m1>> NULL;"||PutLf()||
							"  END LOOP;"||PutLf()||
							"END;"
					! Call Debug(strBuffer)
					Call SqlPLSQLCommand(hSql(),"dbf.cl(strBuffer)")
					Call SqlCommitEx( hSql(), 'Обработка файла ' || strFilePath || strFileName || ' закончена' )
					Call VisFileClose ( hF )
					! BackUp
					Call SalStatusSetText ( hWndForm, 'BackUp' )
					Set YYMMDD=SalFmtFormatDateTime( dDat, 'yyMMdd' )
					Set strBackUpPath=strFilePath||'\\'||YYMMDD
					If not VisDosExist(strBackUpPath)
						If not SalFileCreateDirectory( strBackUpPath )
							Call SalMessageBox( 'Не могу создать каталог:'||strBackUpPath, 'Внимание', MB_IconStop )
					Call VisFileCopy( strFilePath||strFileName, strBackUpPath||'\\'||strFileName )
					Call VisFileOpen( hF, strFilePath||strFileName, OF_Delete )
					Call SalHideWindow(ccProgressBar)
					Call SalWaitCursor(FALSE)
					Call SalStatusSetText ( hWndForm, 'Готово' )
		Window Parameters
			Number: nPar     ! не использ
			String: sFlags   ! кнопки+признаки     '11111,V' не используется
			String: sFilt    ! Предустановленный фильтер
		Window Variables
			String: sAMFO
			String: sFlagI
			Number: nUserId
			Number: nKv
			Date/Time: dDat
			Number: nCurRow1
			Number: nCurRow2
			String: sObl
			String: sNls
			!
			String: sMask[*]
			Number: nFiles
			String: sFiles[*]
			String: sImpDir
			Boolean: bProcesd
			Number: i
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call ShowApdVersion('06')
				Set splOp3522.nFlags=GT_NoRet | GT_NoIns | GT_NoDel
				! Каталог для импорта выписок
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('Import', '3125Path', GetPrnDir(), sImpDir, GetIniFileName())
				Set sImpDir = sImpDir || IifS(Right(sImpDir, 1)='\\', '', '\\')
				! Call Debug(sImpDir)
				! флаги управления окном
				If SalStrScan(sFlags,',')>=0
					Set sFlagI=SalStrLeftX(sFlags,SalStrScan(sFlags,','))||'1111111'
				Else
					Set sFlagI=sFlags||'1111111'
				!
				Set sObl= GetGlobalOption('KOBL_412')
				Set nUserId = GetUserId()
				Set nKv      = GetBaseVal()
				Set dDat     = GetBankDate()
				Set sAMFO    = GetBankMfo()
				Set splOp3522.nTabInstance1 = 1
				Set splOp3522.nTabInstance2 = 1
				Set strFilterTblName = 'accounts'
				Set strPrintFileName = 'VYP.txt'
				Call SalTblSetTableFlags(tbl, TBL_Flag_SingleSelection, TRUE)
				! Созданием списка операций для обработки
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Call ccSplitter.setBarPosition( 650 )
				Call tbl.cF.Init(strFilterTblName, 'a')
			On UM_ObjActivate
				Set sMask[0]='SH*.DBF'
				Set bProcesd=FALSE
				Set i=0
				While i<1
					Set nFiles = VisDosEnumFiles (sImpDir||sMask[i], FA_Standard, sFiles)
					If nFiles > 0
						While nFiles>0
							Set nFiles=nFiles-1
							! Set sFiles[nFiles]=SalStrMidX(sFiles[nFiles],5,2)||SalStrMidX(sFiles[nFiles],3,2)||sFiles[nFiles]
						Set nFiles=VisArraySort (sFiles, SORT_Descending, DT_String)
						While nFiles>0
							Set nFiles=nFiles-1
							Call PutFileToLob(sImpDir,sFiles[nFiles])
							Set bProcesd=TRUE
					Set i=i+1
				If not bProcesd
					Call MessageAttention('Немає файлів для імпорту: ' || sImpDir)
	Table Window: tblPerekryt     ! 06 - Перерахування коштів по реєстру
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Перерахування коштів згідно реєстру
		Icon File:
		Accesories Enabled? Class Default
		Visible? No
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.06"
				Top:    0.567"
				Width:  13.533"
				Width Editable? Class Default
				Height: 5.952"
				Height Editable? Class Default
			Font Name: Default
			Font Size: Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: System Window Color
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? No
		Description: Перерахування коштів згідно реєстру
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If nOpt  ! По одній/групами
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									Call SalTblSetContext( hWndForm, nRow )
									Call SalTblSetRowFlags(hWndForm,nRow,ROW_MarkDeleted,
											not SalTblQueryRowFlags(hWndForm,nRow,ROW_MarkDeleted))
							Else
								Set nRowContext = SalTblQueryContext ( hWndForm )
								Call SalArraySetUpperBound ( aId, 1, -1 )
								Set i=0
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									Call SalTblSetContext( hWndForm, nRow )
									Set aId[i]=colNlsA||Str(colKvA)
									Set i=i+1
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, 0, 0)
									Call SalTblSetContext( hWndForm, nRow )
									If VisArrayFindString (aId, colNlsA||Str(colKvA))>=0
										Call SalTblSetRowFlags(hWndForm,nRow,ROW_MarkDeleted,
												not SalTblQueryRowFlags(hWndForm,nRow,ROW_MarkDeleted))
								Call SalTblSetContext( hWndForm, nRowContext )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 13099
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 13100
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  11.683"
						Begin Y:  -0.012"
						End X:  11.683"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр'
						On SAM_Click
							If SetQueryFilter( cF )
								Set sFilt=''
								If cF.GetFilterWhereClause( FALSE )
									Set sFilt = 'AND '|| cF.GetFilterWhereClause( FALSE )
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Click
							                                                                                   Set sFilNem=GetFilNem('PREE'||SalFmtFormatDateTime(GetBankDate(),'ddMM'))
							                                                                                   Call TablePrint(tblPerekryt, 'Перерахування коштів згідно реєстру',sFilNem,'')
				Line
					Resource Id: 13101
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 13102
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				! Background Text: Гр.:
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.283"
						Top:    0.119"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
.end
				Combo Box: cmbGrps
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.283"
						Top:    0.095"
						Width:  4.3"
						Width Editable? Class Default
						Height: 5.06"
						Height Editable? Class Default
					Visible? Class Default
					Editable? No
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If nPar>0   ! Задано групу
								If cmbGrps.Init( hWndItem )
									Call cmbGrps.Populate( hSql(), 'idg', 'name', 'perekr_g', 'ORDER BY name' )
									Call cmbGrps.SetSelectById( Str(nPar) )
									Set sGrp=cmbGrps.strCurrentId
								Call SalDisableWindow ( hWndItem )
								Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
							Else If SalStrLeftX(sBankMfo,1)='8' and nPar=-1 ! Для казначейств - задано реєстр
								If cmbGrps.Init( hWndItem )
									Call cmbGrps.Populate( hSql(), "nap", "nap||' - '||kkd||' / '||kpk", 'nap', " WHERE mask LIKE '___1%' UNION ALL SELECT 0,'Вибрати' FROM dual  ORDER BY nap" )
									Call cmbGrps.SetSelectById( '0' )
									! Set sGrp=cmbGrps.strCurrentId
							Else If SalStrLeftX(sBankMfo,1)='8' and nPar!=-1! Для казначейств - задано реєстр
								If cmbGrps.Init( hWndItem )
									Call cmbGrps.Populate( hSql(), 'obl', "obl||'-'||nb", 'obl_kaz', "UNION ALL SELECT '00','Всі' FROM dual ORDER BY obl" )
									Call cmbGrps.SetSelectById( sGrp )
							Else ! Нема групи
								! Call SalDisableWindow ( hWndItem )
								Call SalHideWindow ( hWndItem )
						On SAM_Click
							Call SalSendClassMessage( SAM_Click, 0, 0 )
							Set sGrp=cmbGrps.strCurrentId
							Set nI = 0
							Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.83"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bOk=TRUE
							Set sNlsA = STRING_Null
							Set nKvA = 0
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tblPerekryt, nRow, 0, ROW_MarkDeleted )
								Call SalTblSetContext( tblPerekryt, nRow )
								Call SalTblSetFocusRow( tblPerekryt, nRow )
								Call SalTblSetRowFlags( tblPerekryt, nRow, ROW_Selected, TRUE )
								Set dfNrow=nRow + 1
								If nOpt or (sNlsA != colNlsA or nKvA != colKvA)
									If bOk and sNlsA and nKvA
										Call SqlCommit(hSql())
										If nRow > 900
											Call SalMessageBox( 'Переполнение таблицы. Часть данных не обработана.','Внимание', MB_IconExclamation )
											Break
									Set sNlsA=colNlsA
									Set nKvA=colKvA
									Set bOk=TRUE
								If colAmount and colSel 
									If nFdr
										Set sNazn=colNazn
										Set sDrec=colDrec
									Else
										If SalStrLength(colNazn)<=160
											Set sNazn=colNazn
											Set sDrec=''
										Else
											Set sNazn=SalStrTrimX(SalStrLeftX(colNazn,160))
											Set sDrec='#П'||SalStrTrimX(SalStrRightX(colNazn,SalStrLength(colNazn)-160))||'#'
									Call cDoc.SetDoc( 0, colTT, colDk, colVob, colNd, IifD(colDatD=DATETIME_Null,dDat,colDatD), dDat, dDat, dDat,
											     colNlsA, colPlat, sBankMfo,'', colKvA, colAmount,  colOkpoA,
											     colNlsB, colPolu,  colMfoB,'', colKvB, colAmount2, colOkpoB, 
											     sNazn, sDrec ,GetIdOper(),'',NUMBER_Null,0 )
									If GetGlobalOption('SUB')='1'
										Set cDoc.m_sSub=colSub
									If cDoc.oDoc()
										If not SqlPrepareAndExecute( hSql()," UPDATE "|| strTabN || " SET (ref,sos)=(SELECT ref,(CASE WHEN dk IN (0,1) THEN sos ELSE 1 END) FROM oper WHERE ref=:cDoc.m_nRef) WHERE id=:colId")
											Call SqlRollback(hSql())
											Set bOk=FALSE
										Set nI = nI + 1
									Else
										Call SqlRollback(hSql())
										Set bOk=FALSE
								Call SalTblSetRowFlags( tblPerekryt, nRow, ROW_Selected, FALSE )
							If bOk and sNlsA and nKvA
								Call SqlCommit(hSql())
								Call SaveFInfoToLog( 'Перерахування коштів ' ||  sGrp || ' - ' || cmbGrps || ' обробленено ' || SalNumberToStrX( nI, 0) || ' документов ' || IifS(bOk,'',' з помилками' ))
								Call MessageInfoEx('Готово.')
							Call SalWaitCursor( TRUE )
							Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
							Call SalWaitCursor( FALSE )
						On SAM_Create
							Set strTip = 'Виконати проведення'
				Data Field: dfNrow
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 5
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.971"
							Top:    0.115"
							Width:  0.85"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? No
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold
						Text Color: Default
						Background Color: 3D Face Color
						Input Mask: Unformatted
					Message Actions
				Pushbutton: UnSel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.586"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F3
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Call SalHideWindow( tblPerekryt.colSel )
						On SAM_Click
							Set bSel=not bSel
							If bSel
								Call SalHideWindow( tblPerekryt.colSel )
							Else
								Call SalShowWindow( tblPerekryt.colSel )
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tblPerekryt, nRow, 0, 0 )
								Call SalTblSetContext( tblPerekryt, nRow )
								Set tblPerekryt.colSel=bSel
				Pushbutton: pbAcrue
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSort
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати нарахування'
							If strPrcN
								Call SalShowWindow(hWndItem)
							Else
								Call SalHideWindow(hWndItem)
						On SAM_Click
							If strPrcN
								If not SqlPLSQLCommand(hSql(), strPrcN)
									Call SqlRollback(hSql())
									Call MessageErrorEx('Помилка: Неможливо виконати процедуру ' || strPrcN || '.')
								Else
									Call SqlCommit(hSql())
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Pushbutton: pbLocalD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.12"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Rep_join.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalModalDialog( dlg_SetLocDat, hWndForm, dDat)
							Call SalSendMsg( dfLocDat, SAM_Create, 0, 0 )
						On SAM_Create
							If nFbk
								Call SalShowWindow(hWndItem)
							Else
								Call SalHideWindow(hWndItem)
							Set strTip = 'Встановити локальную дату'
				Data Field: dfLocDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.583"
							Top:    0.119"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? No
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold
						Text Color: Red
						Background Color: 3D Face Color
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							If dDat=GetBankDate()
								Call SalHideWindow(dfLocDat)
							Else
								Set dfLocDat=dDat
								Call SalShowWindow(dfLocDat)
				Pushbutton: pbImport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DOC_DOWN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							If nFim
								Call SalShowWindow(hWndItem)
							Else
								Call SalHideWindow(hWndItem)
							Set strTip = 'Імпорт файлів'
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_ObjActivate, 0, 0)
							! Call SalSendMsg(pbRun,SAM_Click, 0, 0)
				Custom Control: ccProgressBar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cMeter
					Property Template:
					Class DLL Name:
					Display Settings
						DLL Name:
						MS Windows Class Name:
						Style:  Class Default
						ExStyle:  Class Default
						Title:
						Window Location and Size
							Left:   7.283"
							Top:    0.071"
							Width:  3.983"
							Width Editable? Class Default
							Height: 0.25"
							Height Editable? Class Default
						Visible? Yes
						Border? Class Default
						Etched Border? Class Default
						Hollow? Class Default
						Vertical Scroll? Class Default
						Horizontal Scroll? Class Default
						Tab Stop? Class Default
						Tile To Parent? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Dark Blue
						Background Color: 3D Face Color
						DLL Settings
					Message Actions
						On SAM_Create
							! Call SalSetFocus( hWndItem )
							If nFim
								Call SalShowWindow(hWndItem)
							Else
								Call SalHideWindow(hWndItem)
		Contents
			Column: colSel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пом
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.457"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If nOpt  ! По одній/групами
							Set nRow = TBL_MinRow
						Else
							Set nRowContext = SalTblQueryContext ( hWndForm )
							Set sNlsA = colNlsA
							Set nKvA = colKvA
							Set bSelTmp=colSel
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tblPerekryt, nRow, 0, 0 )
								Call SalTblSetContext( tblPerekryt, nRow )
								If colNlsA=sNlsA and colKvA = nKvA
									Set colSel=bSelTmp
								Call SalTblSetRowFlags(hWndForm,nRow,ROW_Edited,FALSE)
							Call SalTblSetContext( hWndForm, nRowContext )
			Column: colVob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						оп.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.486"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colTT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						оп.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Center
				Width:  0.486"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNlsA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						А
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKvA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВАЛ
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.457"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNlsB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKvB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВАЛ
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If nMode=8
							Call SalShowWindow( hWndItem )
						Else
							Call SalHideWindow( hWndItem )
			Column: colMfoB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 9
				Data Type: String
				Justify: Center
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Д/К
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.414"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Формула
						суммы
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOstC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.867"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAmount
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAmountS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAmount2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAmountS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If nMode=8
							Call SalShowWindow( hWndItem )
						Else
							Call SalHideWindow( hWndItem )
			Column: colOstB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.867"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPlat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Плательщик
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  3.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPolu
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Получатель
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  3.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNazn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подробности платежа                          
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 217
				Data Type: String
				Justify: Left
				Width:  5.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDrec
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Допреквизити
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 217
				Data Type: String
				Justify: Left
				Width:  5.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If nFdr
							Call SalShowWindow( hWndItem )
						Else
							Call SalHideWindow( hWndItem )
			Column: colAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Внутр
						# Сч.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOkpoA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						А
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOkpoB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						Док
				Visible? Yes
				Editable? No
				Maximum Data Length: 10
				Data Type: String
				Justify: Left
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDatD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						Док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.3"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: colLevB
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рівень
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                     List Values 
				                                                                                     Message Actions 
			! Column: colSumR
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                     List Values 
				                                                                                     Message Actions 
			! Column: colKoef
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Коеф.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                   List Values 
				                                                                                   Message Actions 
			Column: colKod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colFormula
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Long String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSub
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Субрахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If GetGlobalOption('SUB')='1'
							Call SalShowWindow(hWndItem)
						Else
							Call SalHideWindow(hWndItem)
			Column: colSSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ssp
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colFlagDat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: ImpFiles
				Description: Импорт выписок 
				Returns
					Boolean:
				Parameters
					String: strFilePath
					String: strFileName
				Static Variables
				Local variables
					File Handle: hF
					Long String: strBuffer
					!
					String: strHFName
					String: strHMfo
					Number: nHLines
					Boolean: fProcError
					!
					Number: nIterator
					String: strOKPO
					Number: nTgr
					Number: nAct
					Number: nObl
					String: strDt
					String: strKkd
					String: strSum
					String: strFond
					String: strKmis
					String: strNdov
					Date/Time: dDdov
					Number: nKmis
					Number: nSum
					Date/Time: dDt
					String: strId_Key
					String: strBackUpPath
					String: YYMMDD
					File Handle: hFile
					Boolean: bZag
					Number: i
				Actions
					If VisFileOpen( hF, strFilePath || strFileName, OF_Binary | OF_Read ) != VTERR_Ok
						Call SalMessageBeep( MB_IconStop )
						Call SaveErrorToLog( 'Невозможно открыть файл ' || strFilePath )
						Call SalMessageBox( 'Невозможно открыть файл ' || strFilePath, 'Ошибка!', MB_IconStop | MB_Ok )
						Return FALSE
					Call SalWaitCursor(TRUE)
					Call SalStatusSetText ( hWndForm, strFilePath || strFileName )
					Call SalShowWindow(ccProgressBar)
					Call SqlPLSQLCommand(hSql(),"dbf.op(0)")
					Loop
						! Call ccProgressBar.SetProgress( nIterator / nHLines * 100)
						Call SalStrSetBufferLength(strBuffer, 2901)
						Set i = VisFileRead(hF, strBuffer, 2900)
						Call SalStrSetBufferLength(strBuffer, i+1)
						If not SqlPLSQLCommand(hSql(),"dbf.ap(strBuffer)" )
							Call SqlRollbackEx(hSql(),'Помилка 1 імпорту файлу '||strFileName)
							Call VisFileClose ( hF )
							Return FALSE
						If i<2900
							Break
					If not SqlPLSQLCommand(hSql(),"imp_fil0(0,strFileName)")
						Call SqlRollbackEx(hSql(),'Помилка 2 імпорту файлу '||strFileName)
						Call VisFileClose ( hF )
						Return FALSE
					Call SqlCommitEx( hSql(), 'Обработка файла ' || strFilePath || strFileName || ' закончена' )
					Call VisFileClose ( hF )
					! BackUp
					Call SalStatusSetText ( hWndForm, 'BackUp' )
					Set YYMMDD=SalFmtFormatDateTime( dDat, 'yyMMdd' )
					Set strBackUpPath=strFilePath||'\\'||YYMMDD
					If not VisDosExist(strBackUpPath)
						If not SalFileCreateDirectory( strBackUpPath )
							Call SalMessageBox( 'Не могу создать каталог:'||strBackUpPath, 'Внимание', MB_IconStop )
					Call SalFileCopy( strFilePath||strFileName, strBackUpPath||'\\'||strFileName, TRUE )
					Call SalFileOpen( hFile, strFilePath||strFileName, OF_Delete )
					Call SalHideWindow(ccProgressBar)
					Call SalWaitCursor(FALSE)
					Call SalStatusSetText ( hWndForm, 'Готово' )
			Function: SetColorRow
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strTabPrcN
			String: sFiltP
			Boolean: nFbk   !  1 - открыть кнопку Лок Банк Дат
			Boolean: nFim   !  2 - открыть кнопку Импорт файлов
			Boolean: nOpt   !  4 - 0 - Блоки по рахА, 1 - Блоки по кожному рядку
			Boolean: nFdk   !  8 - 0 - Нету DK, 1 - Есть DK
			Boolean: nFdr   ! 16 - 0 - Нету drec, 1 - Есть drec
		Window Variables
			String: sNazn
			String: sDrec
			String: strTabN  ! Назва таблиці
			String: strPrcN  ! Назва процедури
			String: sBankMfo
			: cF
				Class: cGenFilter
			String: sFilt
			!
			String: sGrp
			Number: nRow
			: cDoc
				Class: cDocPerekryt
			Date/Time: dDat
			Date/Time: DAT
			! String: ACC
			String: sMfoB
			String: sS
			Number: nFetchRes
			! Number: nS
			! Number: nAcc
			Number: nRowLast
			String: sNlsA
			Number: nKvA
			Boolean: bOk
			Boolean: bSel
			Boolean: bSelTmp
			Boolean: bSSP
			! Boolean: bOpt  ! 0 - Блоки по рахА, 1 - Блоки по кожному рядку
			Number: nTmp
			Number: nFnp   ! 1 - не ставить %% в назначении платежа
			Number: nColo
			!
			Number: nRatO
			Number: nRatB
			Number: nRatS
			!
			String: sFilNem
			Number: nSuma
			Number: nI
			Number: nId
			Date/Time: dDatD
			String: sErrTxt
			Number: nMaxDig
			Number: nRowContext
			String: aId[*]
			Number: i
			Number: nPrty
			String: sTT
			String: sNLS
			String: sFNAM
			!
			Boolean: bProcesd
			String: sMask[*]
			String: sFiles[*]
			Number: nFiles
			! String: sFiles
			String: sVypDir
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set nFlags=GT_NoRet | GT_NoIns
				Set tblPerekryt.nTabInstance = 1
				!
				! Call DebugN(nFim)
				! Set bOpt = TRUE
				Set bSel = TRUE
				Set sGrp='00'
				! If SalStrScan(strTabN,'P') >= 0  ! Не ставить %% в назначении платежа 
					                                                                        Set nFnp=1
				! If SalStrScan(strTabN,'T') >= 0  ! Кнопка ТАЙМЕР
					                                                                                     Call SalShowWindow(obTimer)
				If SalStrScan(strTabPrcN,',') >= 0  ! Есть имя процедуры для вызова
					Set strTabN = SalStrLeftX(strTabPrcN,SalStrScan(strTabPrcN,','))
					Set strPrcN = SalStrRightX(strTabPrcN,SalStrLength(strTabPrcN)-SalStrScan(strTabPrcN,',')-1)
				Else
					Set strTabN = strTabPrcN
					Set strPrcN = ''
				If sFiltP
					Set sFiltP=' AND '||sFiltP
				Set dDat=GetBankDate()
				Set DAT=dDat
				Set sBankMfo = GetBankMfo()
				Set sFNAM = 'Перерахування коштів'
				! Отр код операції і рахунок
				If GetGlobalOption(strTabN)
					Call SqlPrepareAndExecute(hSql(), "SELECT SUBSTR(val,1,3),SUBSTR(val,5),comm INTO :sTT,:sNLS,:sFNAM FROM params WHERE par=:strTabN")
					If SqlFetchNext(hSql(),nFetchRes)
						Set sNLS=KeyAccount( sBankMfo, sNLS)
				! Каталог для импорта выписок
				If nFim
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString('Directory', 'ImpPayDir', GetPrnDir(), sVypDir, GetIniFileName())
					Set sVypDir = sVypDir || IifS(Right(sVypDir, 1)='\\', '', '\\')
					Set i=0
					While i<=9
						Call SalGetProfileString('Import', 'ImpMask'||Str(i), '', sMask[i], GetIniFileName())
						! Call Debug('ImpMask'||Str(i)||'='||sMask[i])
						Set i=i+1
				!
				Call SalSetWindowText( hWndForm, sFNAM )
				Call ShowApdVersion('07')
				Call cF.Init(strTabN, 'a')
				Set nMaxDig = DigInit()
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Populate
				! Set nS=0
				Set sNlsA = STRING_Null
				Set nKvA = 0
				Set nRowLast=0
				! Set tblPerekryt.strPrintFileName='Perekr.'||SalStrRightX('000'||SalNumberToStrX(nGrp,0),3)
				Set sErrTxt=''
				Call SalEnableWindow(pbRun)
				! Головна виборка з реєстру
				Set tblPerekryt.strSqlDelete="DELETE FROM " || strTabN || " a WHERE id=:tblPerekryt.colId"
						
				Set tblPerekryt.strSqlPopulate=
						"SELECT "||IifS(nFdk,"dk,","NULL,")||
						         IifS(nFdr,"d_rec,","NULL,")||
						"nlsa, kva, mfob, nlsb, NVL(kvb,kva), tt, vob, SUBSTR(a.nd,1,10), datd, s, nam_a, nam_b, 
						       SUBSTR(a.nazn,1,217), okpoa, okpob, id "
						||",CASE WHEN "
						|| IifS(nMode=8,"NVL(s2,0)=0 AND ","")||"kva<>NVL(kvb,kva) AND (kva=980 or NVL(kvb,kva)=980) 
						    THEN DECODE(kva,980,gl.p_ncurval(NVL(kvb,kva),s,gl.bd),gl.p_icurval(kva,s,gl.bd)) 
						    ELSE "|| IifS(nMode=8,"s2","s") ||" END"
						|| IifS( GetGlobalOption('SUB')='1' ,",sub","")||
						"  FROM " || strTabN || " a WHERE NVL(a.sos,0) = 0 " 
						||IifS( sGrp='00', "", " AND a.grp=:tblPerekryt.sGrp " ) ||sFiltP||" "||sFilt||
						" ORDER BY a.grp,SUBSTR(a.nlsa,1,4),SUBSTR(a.nlsa,-3),a.kva,a.id "||
						" INTO :tblPerekryt.colDk,  :tblPerekryt.colDrec,
						       :tblPerekryt.colNlsA,:tblPerekryt.colKvA,
						       :tblPerekryt.colMfoB,:tblPerekryt.colNlsB,:tblPerekryt.colKvB,
						       :tblPerekryt.colTT,  :tblPerekryt.colVob, :tblPerekryt.colNd,
						       :tblPerekryt.colDatD,:tblPerekryt.colAmount,
						       :tblPerekryt.colPlat,:tblPerekryt.colPolu, :tblPerekryt.colNazn,
						       :tblPerekryt.colOkpoA,:tblPerekryt.colOkpoB,:tblPerekryt.colId,:tblPerekryt.colAmount2"||
						IifS( GetGlobalOption('SUB')='1' ,", :tblPerekryt.colSub","")
				! Call Debug('='||tblPerekryt.sGrp||'*'||tblPerekryt.strSqlPopulate)
				Call SalWaitCursor(TRUE)
				Set dfNrow=0
				Call SalTblPopulate(hWndForm, cMain.hSql(), strSqlPopulate, TBL_FillAll)
				Call SalWaitCursor(FALSE)
				!
				If sErrTxt   ! Были ошибки при населении таблицы
					Call SalDisableWindow(pbRun)
					Call MessageErrorEx(sErrTxt||'.')
			On SAM_FetchRowDone
				Set dfNrow=lParam+1 
				Set colSel=bSel
				If not nFdk
					If colAmount<0
						Set colDk=0
						Set colAmount=-colAmount
					Else
						Set colDk=1
				If sTT
					Set colTT=sTT
				! Установка дефолтного счета Дебет
				If sNLS
					Set colNlsA=sNLS
				! Раскраска атомарних групп строк
				If nOpt
					Set nColo=IifN(nColo=COLOR_LightGray,COLOR_IndexWindow,COLOR_LightGray)
				Else
					If sNlsA != colNlsA or nKvA != colKvA
						Set sNlsA=colNlsA
						Set nKvA=colKvA
						Set nColo=IifN(nColo=COLOR_LightGray,COLOR_IndexWindow,COLOR_LightGray)
				! *********************************************
				Set colAmountS = Dig4(colAmount/100, 2, nMaxDig)
				If nMode=8
					Set colAmountS2 = Dig4(colAmount2/100, 2, nMaxDig)
				If not cDoc.sTranN(colNazn, colNazn, colTT, colNlsA, sBankMfo, colKvA, colAmount, colNlsB, colMfoB, colKvB, colAmount2, 0, 0, 0)
					Set sErrTxt='Ошибка формирования назначения платежа '|| colNazn
				Set nRowLast=lParam
				If nColo=COLOR_LightGray or nColo=COLOR_Salmon
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColo) ! серый
				If not (colNlsB and colMfoB and colKvB)
					Call SalTblSetRowFlags(hWndForm,lParam,ROW_MarkDeleted,TRUE)
			On SAM_CreateComplete
				Call SalEnableWindow(pbFilter)
				! Call SalTblSetTableFlags( hWndForm, TBL_Flag_SelectableCols, FALSE )
				Call SalWaitCursor( FALSE )
			On SAM_Destroy
				If nFbk
					Set dDat=GetBankDate()
					Call Pl_dat(dDat)
			On WM_SetFocus
				If dDat and nFbk
					Call Pl_dat(dDat)
			On SAM_ColumnSelectClick
			On UM_ObjActivate
				Set bProcesd=FALSE
				Set i=0
				While i<=9
					If sMask[i]
						! Call Debug(sVypDir||sMask[i])
						Set nFiles  = VisDosEnumFiles (sVypDir||sMask[i], FA_Archive, sFiles)
						If nFiles > 0
							Set nFiles=VisArraySort (sFiles, SORT_Descending, DT_String)
							While nFiles>0
								Set nFiles=nFiles-1
								Call ImpFiles(sVypDir,sFiles[nFiles])
								Set bProcesd=TRUE
					Set i=i+1
				If bProcesd
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Else
					Call MessageAttention('Нема файлів в кат: ' || sVypDir)
