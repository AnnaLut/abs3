.head 0 +  Application Description: !----------------------------------------!
! ACCOUNTS.APL+CUSTOMER.APL=CUSTACNT.APL !
! библиотека функций работы с счетами и  !
! клиентами                              !
!----------------------------------------!
! ООО Унити-Барс (C) 1996-2016           !
! Разработчики: Сыропоршнев Д.Л.,        !
!               Марценюк М.П.,           !
!               Чупахина Н.А.            !
!----------------------------------------!
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000390100 002C000000030000 0003000000010000 0061020000F8FFFF
0040: FFE1FFFFFFFFFFFF FFFFFFFFFF1E0300 00C4010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D03000000075769 6E646F7773107462
0080: 6C5F4163636F756E 74734C6973740743 6F6C756D6E73
.enddata
.data DT_MAKERUNDLG
0000: 02000000001A513A 5C4241525339385C 42494E5C63757374 61636E742E657865
0020: 17513A5C42415253 39385C42494E5C52 544C49422E646C6C 17513A5C42415253
0040: 39385C42494E5C52 544C49422E617063 01000101011B513A 5C4241525339385C
0060: 4C4942524152595C 52544C49422E7275 6E1B513A5C424152 5339385C4C494252
0080: 4152595C52544C49 422E646C6C1B513A 5C4241525339385C 4C4942524152595C
00A0: 52544C49422E6170 630000010101185C 4241525339385C42 494E5C6375737461
00C0: 636E742E61706418 5C4241525339385C 42494E5C6163636F 756E74732E646C6C
00E0: 185C424152533938 5C42494E5C616363 6F756E74732E6170 630000010101001B
0100: 513A5C4241525339 385C4C4942524152 595C52544C49422E 646C6C1B513A5C42
0120: 41525339385C4C49 42524152595C5254 4C49422E61706300 00010101
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0200000000000000 00001027C1140500 1D00FFFF4D61696E
0020: 0029000100040000 0000000000E91E80 0A00008600FFFF49 6E7465726E616C20
0040: 46756E6374696F6E 7300200001000400 000000000000E91E 800A0000DF00FFFF
0060: 5661726961626C65 73001E0001000400 000000000000F51E 100D0000F400FFFF
0080: 436C617373657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0218B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Dfltrapi.apd
.head 2 -  Dynalib: Service.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Bars000.apd
.head 2 -  ! Dynalib: Bars010.apd
.head 2 -  Dynalib: Depo.apd
.head 2 -  Dynalib: CC_DOC.APD
.head 2 -  !
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: GENLBUTN.APL
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: GENTBLD.APL
.head 2 -  File Include: GENTBLF.APL
.head 2 -  File Include: Genfiltr.apl
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: Genemnu.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: Vttblwin.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Vtcal.apl
.head 2 -  File Include: Vtmsgbox.apl
.head 2 -  File Include: VTARRAY.APL
.head 2 -  File Include: VTDOS.APL
.head 2 -  File Include: VTLBX.APL
.head 2 -  File Include: xsalcpt.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: QCKTABS.APL
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: gencust.apl
.head 2 -  File Include: GENACC.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Window Color
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: System Window Color
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: ###000
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Input: 99/99/9999
.head 3 -  Number: ###000' Кр';###000' Дб'
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Number: ###000;###000
.head 3 -  Input: 999,99
.head 3 -  Date/Time: MM-dd-yyyy
.head 3 -  Date/Time: d
.head 3 -  Number: #0000
.head 3 -  Input: 99999999
.head 3 -  Input: 9999999999
.head 3 -  Number: #00000
.head 3 -  Date/Time: dd/MM/yyyy hhhh:mm:ss
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  Number: CVIEW_ApproveKK = 0x4000000	! подтверждение изменений КК
.head 4 -  Number: AVIEW_HIST = 0x0100 ! Просмотр истории счетов
.head 4 -  !
.head 4 -  String: MSG_DOC_IErrorMfoEx='Укажите правильный код банка СЭП - МФО. Выбрать  из справочника?'
.head 4 -  String: MSG_DOC_IErrorBicEx='Укажите правильный код банка SWIFT - BIC. Выбрать  из справочника?'
.head 4 -  !
.head 4 -  Number: TAB_Hide = 0
.head 4 -  Number: TAB_ReadOnly = 1
.head 4 -  Number: TAB_Edit = 2
.head 4 -  !
.head 4 -  String: Criteria_CustRisk = 'Risk'
.head 4 -  String: Criteria_CustRept = 'Rept'
.head 4 -  String: Criteria_CustCtg  = 'Ctg'
.head 4 -  !
.head 4 -  String: sK050SPD = '910'
.head 4 -  String: sK051SPD = '91'
.head 2 +  Resources
.head 3 +  Bitmap: bmpAccListOptions
.head 4 -  File Name: /Bars98/Resource/Bmp/tabler.bmp
.head 3 +  Icon: PIC_Level0
.head 4 -  File Name: \BARS98\RESOURCE\ICO\MONEY.ICO
.head 3 +  Icon: PIC_Level1
.head 4 -  File Name: \BARS98\RESOURCE\ICO\TTS0.ICO
.head 3 +  Icon: PIC_Level2
.head 4 -  File Name: \BARS98\RESOURCE\ICO\TTS1.ICO
.head 2 +  Variables
.head 3 -  Boolean: fInitLib
.head 3 -  Window Handle: h_Frm_DR
.head 3 -  Window Handle: h_Frm_SP
.head 3 -  Window Handle: hWndObject
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  Boolean: bShowBookedRecord
.head 3 -  ! nCountryCode вычитывается при инициализации библиотеки
.head 3 -  Number: nCountryCode
.head 3 -  Number: nCountryCrimea
.head 3 -  Number: nCountryCrimeaVEZ
.head 3 -  !
.head 3 -  Number: PAR_NBUBANK
.head 3 -  Number: PAR_HAVETOBO
.head 3 -  Number: PAR_ACCFLTR
.head 3 -  Number: PAR_CUSTFLTR
.head 3 -  Number: PAR_CUSTSIGN
.head 3 -  Number: PAR_CUSTADRT
.head 3 -  Number: PAR_CUSTRISK
.head 3 -  Number: PAR_CUSTREPT
.head 3 -  Number: PAR_CUSTCTG
.head 3 -  Number: PAR_EN_FS
.head 3 -  String: PAR_BANKTYPE
.head 3 -  String: PAR_ORGTYPE
.head 3 -  String: PAR_CUSTK072
.head 3 -  Boolean: bPAR_RI
.head 3 -  Boolean: bPAR_PHCODE
.head 3 -  Boolean: bPAR_ACCMSP
.head 3 -  Boolean: bPAR_CUSTMNI
.head 3 -  Boolean: bPAR_CUSTMPSP
.head 3 -  Boolean: bPAR_CUSTMDR
.head 3 -  Boolean: bPAR_CUSTCLV
.head 3 -  Boolean: bPAR_ACCRESERVE
.head 3 -  Boolean: bUPDATE_ACC_PHONE
.head 3 -  String: sGlobalBankDate
.head 3 -  Date/Time: dGlobalBankDate
.head 3 -  Boolean: bFIN_2
.head 3 -  Boolean: bNbsProf
.head 3 -  Boolean: bEditFMRisk
.head 3 -  Number: nCustDRTab
.head 3 -  ! Number: nAccSPTab
.head 3 -  Window Handle: hFrmCustomer
.head 2 +  Internal Functions
.head 3 +  Function: ShowCustAcc_Init
.head 4 -  Description: Инициализация лингвистической таблицы и прочего
для библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fInitLib
.head 6 -  ! ORGTYPE - тип организации (KAZNA и проч.)
.head 6 -  Set PAR_ORGTYPE  = GetGlobalOption('ORGTYPE')
.head 6 -  Set PAR_BANKTYPE = GetGlobalOption('BANKTYPE')
.head 6 -  Set PAR_CUSTK072 = GetGlobalOption('CUSTK072')
.head 6 +  If PAR_CUSTK072  = STRING_Null
.head 7 -  Set PAR_CUSTK072 = 'N'
.head 6 -  Set PAR_CUSTK072 = VisStrSubstitute(PAR_CUSTK072, ' ', '')
.head 6 -  Set PAR_CUSTK072 = "'" || VisStrSubstitute(PAR_CUSTK072, ",", "','") || "'"
.head 6 -  Set PAR_NBUBANK  = GetGlobalOptionEx('NBUBANK')
.head 6 -  Set PAR_HAVETOBO = GetGlobalOptionEx('HAVETOBO')
.head 6 -  Set PAR_ACCFLTR  = GetGlobalOptionEx('ACCFLTR')
.head 6 -  Set PAR_CUSTFLTR = GetGlobalOptionEx('CUSTFLTR')
.head 6 -  Set PAR_CUSTSIGN = GetGlobalOptionEx('CUSTSIGN')
.head 6 -  Set PAR_CUSTADRT = GetGlobalOptionEx('CUSTADRT')
.head 6 -  Set PAR_CUSTRISK = GetGlobalOptionEx('CUSTRISK')
.head 6 -  Set PAR_CUSTREPT = GetGlobalOptionEx('CUSTREPT')
.head 6 -  Set PAR_CUSTCTG  = GetGlobalOptionEx('CUSTCTG')
.head 6 -  Set PAR_EN_FS    = GetGlobalOptionEx('EN_FS')
.head 6 -  Set bPAR_RI       = GetGlobalOptionEx('RI') = 1
.head 6 -  Set bPAR_PHCODE   = GetGlobalOptionEx('PH_CODE')=1
.head 6 -  Set bPAR_ACCMSP   = GetGlobalOptionEx('ACCMSP')=1
.head 6 -  Set bPAR_CUSTMNI  = GetGlobalOptionEx('CUSTMNI')=1
.head 6 -  Set bPAR_CUSTMPSP = GetGlobalOptionEx('CUSTMPSP')=1
.head 6 -  Set bPAR_CUSTMDR  = GetGlobalOptionEx('CUSTMDR')=1
.head 6 -  Set bPAR_CUSTCLV  = GetGlobalOptionEx('CUST_CLV')=1
.head 6 -  Set bPAR_ACCRESERVE = GetGlobalOptionEx('ACC_RESERVE')=1
.head 6 -  Set bUPDATE_ACC_PHONE = GetValueStr("select substr(value, 1, 1) from cac_params where name = 'UPDATE_ACC_PHONE'")='1'
.head 6 -  ! Глобальная банковская дата
.head 6 -  Set sGlobalBankDate = GetValueStr("select val from params where par = 'BANKDATE'")
.head 6 -  Set dGlobalBankDate = DATETIME_Null
.head 6 +  If sGlobalBankDate
.head 7 -  Set dGlobalBankDate = SalFmtFormatStrDateTime(sGlobalBankDate, 'MM/dd/yyyy')
.head 6 -  ! Разрешить пользователю редактировать Риски в карточке Клиента
.head 6 -  Set bEditFMRisk = FALSE
.head 6 +  If PAR_CUSTRISK
.head 7 -  Set bEditFMRisk = Val(GetValueStr("select cac_get_editfmrisk(user_id) from dual"))
.head 6 -  ! FIN_2 - 1=Установлено модуль "Аналiз фiнiнсового стану клiєнта"
.head 6 -  Set bFIN_2 = GetGlobalOptionEx('FIN_2') = 1
.head 6 -  ! Профили счетов?
.head 6 -  Set bNbsProf = Val(GetValueStr("select count(*) from all_tables where table_name='NBS_PROF'"))
.head 6 -  ! Код страны банка
.head 6 -  Set nCountryCode = GetBankCountryCode()
.head 6 -  Set nCountryCrimea = 11
.head 6 -  Set nCountryCrimeaVEZ = 900
.head 6 -  !
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\custacnt.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTAt',                     'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr',                    'Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTBankDayClose',           'Банковский День ЗАКРЫТ!')
.head 7 -  Call CurrentLangTable.AddAtom('cTGetFromNsi',             'Выбрать из справочника')
.head 7 -  Call CurrentLangTable.AddAtom('cTLeftHeaderClickForEdit', 'Левый клик на заголовке строки - для редактирования')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('cBTipIns',                 'Добавить запись')
.head 7 -  Call CurrentLangTable.AddAtom('cBTipUpd',                 'Редактировать запись')
.head 7 -  Call CurrentLangTable.AddAtom('cBTipDel',                 'Удалить запись')
.head 7 -  Call CurrentLangTable.AddAtom('cBTipNsi',                 'Выбрать значение из сравочника')
.head 7 -  Call CurrentLangTable.AddAtom('cBTipRefresh',             'Перечитать данные')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgAcc',                 'Счет')
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgRnk',                 'РНК')
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgNd',                  'НД')
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgNotSaveData',         'В карточке есть несохраненные данные!')
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgIgnoreAndExit',       'Игнорировать изменения и выйти?')
.head 7 -  Call CurrentLangTable.AddAtom('cTMsgFilterNotSet',        'Не задан фильтр!')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('cTErrRekv',                'Ошибка заполнения реквизитов')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrVal',                 'Неверное значение реквизита')
.head 7 -  ! ====================================================
.head 7 -  ! CloseCustomer
.head 7 -  Call CurrentLangTable.AddAtom('CloseCustomer_cTQuestionClose', 'Закрыть Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('CloseCustomer_cTMess11',        'У клиента в наличии')
.head 7 -  Call CurrentLangTable.AddAtom('CloseCustomer_cTMess12',        'незакрытых счетов')
.head 7 -  Call CurrentLangTable.AddAtom('CloseCustomer_cTMess21',        'Клиент не может быть закрыт датой')
.head 7 -  Call CurrentLangTable.AddAtom('CloseCustomer_cTMess22',        'меньшей даты открытия')
.head 7 -  Call CurrentLangTable.AddAtom('CloseCustomer_cTClose',         'Закрыт клиент')
.head 7 -  ! ====================================================
.head 7 -  ! ResurectCustomer
.head 7 -  Call CurrentLangTable.AddAtom('ResurectCustomer_cTQuestion',   'Перерегистрировать Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('ResurectCustomer_cTMess11',     'Клиент не может быть перерегистрирован датой')
.head 7 -  Call CurrentLangTable.AddAtom('ResurectCustomer_cTMess12',     'меньшей даты закрытия')
.head 7 -  Call CurrentLangTable.AddAtom('ResurectCustomer_cTResurect',   'Перерегистрирован клиент')
.head 7 -  ! ====================================================
.head 7 -  ! CloseAccount
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNotFound', 'не найден !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNotNullF', 'ненулевой остаток(Ф) !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNotNullP', 'ненулевой остаток(П) !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNotNullB', 'ненулевой остаток(Б) !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccOb',       'имеет обороты !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccClose',    'уже закрыт !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccDat1',     'нельзя закрыть датой, меньшей даты открытия')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccDat2',     'нельзя закрыть датой, меньшей даты последнего движения по счету')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNErr',     'Ошибка поиска счетов начисления %%!')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccN',        'Счет начисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNNotP',    'возможно недоначислены %% !')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccNUsed',    'используется для нескольких счетов!')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccDone',     'Продолжать закрытие счета?')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccN1',       'может еще быть задействован!')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccErr',      'Закрыть невозможно')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccQ',        'закрыть?')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccIsClose',  'закрыт')
.head 7 -  Call CurrentLangTable.AddAtom('CloseAcc_cTAccErr2',     'не закрывается.')
.head 7 -  ! ====================================================
.head 7 -  ! CheckPersonOkpo
.head 7 -  Call CurrentLangTable.AddAtom('CheckPersonOkpo.cTOkpoBirthday', 'Код ОКПО не соответствует дате рождения клиента!')
.head 7 -  Call CurrentLangTable.AddAtom('CheckPersonOkpo.cTOkpoSex',      'Код ОКПО не соответствует полу клиента!')
.head 7 -  ! ====================================================
.head 7 -  ! Frm_CustomerList
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTWndTitleKontragents',  'Контрагенты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTWndTitleBanks',        'Банки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTWndTitleCorporations', 'Юридические лица')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTWndTitlePersons',      'Физические лица')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTWndTitleSPD',          'Физические лица-СПД')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipAll',               'Контрагенты всех типов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipPersons',           'Контрагенты - физические лица')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipSPD',               'Контрагенты - физические лица-СПД')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipCorporations',      'Контрагенты - юридические лица')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipBanks',             'Контрагенты - банки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipShowClosed',        'Показывать закрытых контрагентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipRegisterNew',       'Зарегистрировать нового контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipClose',             'Закрыть контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipResurect',          'Перерегистрировать закрытого контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipFilter',            'Установить фильтр')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipFind',              'Искать запись')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipRefresh',           'Перечитать данные')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipDossier',           'Показать карточку контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipAccounts',          'Показать счета контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipCustParHistory',    'История изменения параметров Клиента...')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipPrint',             'Печать')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cBTipExit',              'Выйти')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.bgCustCount',            'Клиентов всего')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colRNK',                 'Регистра~ционный~номер')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colND',                  'Номер~документа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colOKPO',                'ОКПО')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colTYPENAME',            'Тип~контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colBSNSMAN',             'Предпри~нима~тель')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colNAME',                'Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colDATEON',              'Дата~регистрации')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colDATEOFF',             'Дата~закрытия')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.colRNKP',                'Рег. №~холдинга')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTCustList',             'Список клиентов банка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_CustomerList.cTSPD',                  'СПД')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_AccountsList
.head 7 -  ! menuAccounts
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenuAcc', 'Счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu0',   'Таблица')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu01',  'Фильтр...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu02',  'Печать...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu03',  'Выбрать значение из справочника')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu04',  'Сохранить изменения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu05',  'Перечитать')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu06',  'Показать итоги по валютам')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu07',  'Выход')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu1',   'Вид')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu11',  'Финансовые показатели')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu12',  'Лимиты')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu13',  'Спецпараметры')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu14',  'Связанные счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu15',  'Информация о доступе')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu16',  'Блокировки')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu2',   'Открыть счет...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu3',   'Атрибуты счета...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu4',   'Закрыть счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu5',   'Реанимировать счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu6',   'Перерегистрировать счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu7',   'Документы по счету ВНУТРЕННИЕ и НАЧ.МЕЖБАНК')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu8',   'Документы по счету ОТВ.МЕЖБАНК')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu9',   'Документы по технологическому счету...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu10',  'Движения по счету')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.menuAccounts.cTMenu11',  'История счета')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTWndTitleCust',         'Счета Контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTWndTitleTech',         'Технологические Счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTWndTitleTax',          'Счета налогового учета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTWndTitleLinked',       'Счета, связанные со счетом')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTWndTitleUser',         'Счета Пользователя')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTWndTitleAccounts',     'Счета банка')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipFinancial',         'Показать/спрятать финансовые атрибуты')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipInterests',         'Показать/спрятать %% ставки')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipLimits',            'Показать/спрятать информацию о лимитах')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipSpecial',           'Показать/спрятать спецпараметры счетов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipLinks',             'Показать/спрятать связанные счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipAccess',            'Показать/спрятать информацию по доступу к счетам')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipBlock',             'Показать/спрятать информацию по блокировкам счетов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipClosed',            'Показать/спрятать закрытые счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipOpenAccount',       'Открыть счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipEditAccount',       'Просмотр/редактирование атрибутов счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipCloseAccount',      'Закрыть счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipResurectAccount',   '"Реанимировать" счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipDeregAccount',      'Перерегистрировать счет на другого клиента')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipPopulate',          'Перечитать таблицу')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipGetValueFromNSI',   'Выбрать значение из справочника')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipUpdateAttribute',   'Сохранить изменения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipFilter',            'Установить фильтр просмотра')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipDocProcessingAcc',  'Показать подокументный состав процессингового счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipPrint',             'Печать')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipOutboundDocs',      'Документы по счету ОТВЕТНЫЙ СЭП')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipInboundDocs',       'Документы по счету ВНУТРЕННИЕ и НАЧАЛЬНЫЙ МЕЖБАНК')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipTurnAll',           'Обороты за период дат')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipTurnForAccounts',   'Обороты по счету')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipAccHistory',        'История счета...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipAccParHistory',     'История изменения параметров счета...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipLinkedAccounts',    'Показать связанные счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipCcySummary',        'Итоги по валютам...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipExit',              'Завершить работу')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cBTipSort',              'Сортировать счета без учета КР')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.bgAccCount',   'Счетов всего')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colACC',       'Внутренний~номер')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colNLS',       'Номер~счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colKV',        'KV')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colISO',       'Вал~юта')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colNMS',       'Наименование счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colCUSTNAME',  'Наименование клиента')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colNLSALT',    'Альтерн.~номер счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colIS',        'Входящий~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colISq',       'Входящий~остаток~(экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colIS_D',      'Входящий~остаток~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colIS_Dq',     'Входящий~остаток~Дебет (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colIS_K',      'Входящий~остаток~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colIS_Kq',     'Входящий~остаток~Кредит (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colDOS',       'Обороты~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colDOSq',      'Обороты~Дебет~(экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colKOS',       'Обороты~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colKOSq',      'Обороты~Кредит~(экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTC',      'Фактический~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTCq',     'Фактический~остаток~(экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTC_D',    'Фактический~остаток~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTC_Dq',   'Фактический~остаток~Дебет (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTC_K',    'Фактический~остаток~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTC_Kq',   'Фактический~остаток~Кредит (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTB',      'Плановый~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTBq',     'Плановый~остаток~(экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTB_D',    'Плановый~остаток~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTB_Dq',   'Плановый~остаток~Дебет (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTB_K',    'Плановый~остаток~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTB_Kq',   'Плановый~остаток~Кредит (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTF',      'Будущий~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTFq',     'Будущий~остаток~(экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTF_D',    'Будущий~остаток~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTF_Dq',   'Будущий~остаток~Дебет (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTF_K',    'Будущий~остаток~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOSTF_Kq',   'Будущий~остаток~Кредит (экв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colDAPP',      'Дата~последнего~движения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colLIM',       'Лимит~на счете')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colLIM100',    'Лимит (х100)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colNBS',       'Баланс.~счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colACCC',      'Вн. номер связн. счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colPAP',       'Акт~Пас')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colTIP',       'Тип~счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colNLSC',      'Номер счета~консолидации')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colNMSC',      'Наименование счета~консолидации')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colVID',       'Вид~счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colMDAT',      'Дата~погашения~остатка')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colR011',      'R011')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colR013',      'R013')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colS080',      'S080')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colS180',      'S180')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colS190',      'S190')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colS200',      'S200')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colS230',      'S230')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colS240',      'S240')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOWN',       'ID испол'||PutCrLf()||'нителя')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colONAME',     'ФИО'||PutCrLf()||'исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colSecI',      'Код доступа'||PutCrLf()||'исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colURD',       'До'||PutCrLf()||PutCrLf()||'См')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colUDB',       'ст'||PutCrLf()||PutCrLf()||'Дб')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colUKR',       'уп'||PutCrLf()||PutCrLf()||'Кр')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colGROUP',     'ID группы'||PutCrLf()||'доступа')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colGNAME',     'Наименование'||PutCrLf()||'группы')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colSecO',      'Код доступа'||PutCrLf()||'непривелигированых')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colORD',       'До'||PutCrLf()||'В'||PutCrLf()||'См')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colODB',       'ст'||PutCrLf()||'с'||PutCrLf()||'Дб')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOKR',       'уп'||PutCrLf()||'е'||PutCrLf()||'Кр')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colBDCODE',    'Код блок.'||PutCrLf()||'Дб')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colBLKD',      'Блокировка'||PutCrLf()||'по Дебету')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colBKCODE',    'Код блок.'||PutCrLf()||'Кр')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colBLKK',      'Блокировка'||PutCrLf()||'по Кредиту')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colDAOS',      'Дата'||PutCrLf()||'открытия')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colDAZS',      'Дата'||PutCrLf()||'закрытия')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colOKPO',      'ЕДРПОУ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colRAT',       '%%'||PutCrLf()||'ставка')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colTOBO',      'Код безбал.'||PutCrLf()||'отделения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.colBranchTip', 'Тип~безбал.~отделения')
.head 7 -  ! Message
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgResurect1',       'Вы уверены, что хотите ВОССТАНОВИТЬ отмеченные счета?')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgResurect2',       'Эта операция применима только для счетов закрытых ТЕКУЩЕЙ банковской датой.')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccNotResurect',  'не может быть восстановлен, так как')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccNotResurect1', 'закрыт~контрагент')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccNotResurect2', 'не был закрыт вообще или дата закрытия больше текущей')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccNotResurect3', 'не был закрыт вообще или закрыт не сегодня')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccResurect',     'Восстановлен счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgUser',            'Пользователь')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccNotOpen',      'не открыт')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgUserIsp',         'не является ответ.исполнителем')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgDereg1',          'Вы уверены, что хотите ПЕРЕРЕГИСТРИРОВАТЬ отмеченные счета на другого контрагента?')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgDereg2',          'Эта операция применима только для счетов, открытых ТЕКУЩЕЙ банковской датой.')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccDereg1',       'Перерегистрирован счет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTMsgAccDereg2',       'на клиента')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTDocMB',      'Межбанковские поступления за')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTDocInt',     'Документы Внутр. и Нач.Межбанковские')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTOn',         'за')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTAccUpdate',  'Изменение реквизитов для счетов...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTSpecUpdate', 'Изменение спецпараметров для счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTAccList',    'Список лицевых счетов клиентов банка')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTPap1',       'A')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTPap2',       'П')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTPap3',       'А/П')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTAccArest',   'Арестован')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTAccBlock',   'Блокирован')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccountsList.cTAccClose',   'Закрыт')
.head 7 -  ! ====================================================
.head 7 -  ! dlgAccListOptions
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cTWndTitle',  'Параметры просмотра')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbOstDK',     'Показывать остатки двумя колонками (Д/К)')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbSumEqv',    'Показывать эквиваленты')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbFinancial', 'Показывать финансовые атрибуты')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbInterests', 'Показывать %% ставки')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbLimits',    'Показывать информацию о лимитах')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbSpecial',   'Показывать спецпараметры счетов')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbLinks',     'Показывать связанные счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbBlock',     'Показывать информацию по блокировкам счетов')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.cbClosed',    'Показывать закрытые счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlgAccListOptions.pbOk',        'Применить')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_AccTurn4Day
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cTWndTitle',  'Выписка по счету')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cBTipLegend', 'Легенда...')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cBTipHide',   'Спрятать плановые обороты')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cBTipShow',   'Показать плановые обороты')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colTT',       'Оп')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colRef',      'Референс')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colSDe',      'Обороти~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colSKr',      'Обороти~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colSQDe',     'Обороти~Дебет (екв)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colSQKr',     'Обороти~Кредит (екв)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colTXT',      'Комментарий')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.colVdat',     'Дата~валютирования')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cTVx',        'Входящее сальдо')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cTFact',      'Сумма фактических оборотов')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_AccTurn4Day.cTIsx',       'Исходящее сальдо')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_Acc_Sal_Day
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.cTWndTitle', 'История счета')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.bgFrom',     'C')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.bgTo',       'По')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colFdat',    'Дата~движения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colVx',      'Залишок~Вхiдний')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colSDe',     'Обороти~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colSKr',     'Обороти~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colIsx',     'Залишок~Вихiдний')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colVQ',      'Залишок~Вхiдний (екв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colSDQ',     'Обороти~Дебет (екв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colSKQ',     'Обороти~Кредит (екв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colIsQ',     'Залишок~Вихiдний (екв.)')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.colFdatB',   'Дата~движения')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.cTHistory',  'История')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.cTItog',     'Итог')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.cTSrKalend', 'Ср-Календ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_Acc_Sal_Day.cTSrBank',   'Ср-Банк')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_ParHistory
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.cTWndTitleAcc',  'История изменения параметров счета')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.cTWndTitleRnk',  'История изменения параметров клиента')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.bgFrom',         'C')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.bgTo',           'По')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.colColSemantic', 'Параметр')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.colValOld',      'Старое~значение')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.colValNew',      'Новое~значение')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.colChgDate',     'Дата~изменения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.colIdUser',      'Внес~изменения')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_ParHistory.colFioUser',     'ФИО~пользователя')
.head 7 -  ! ====================================================
.head 7 -  ! tbl_CcySummarise
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.cTWndTitle', 'Итог по таблице')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colKV',      'Вал~юта')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colCcy',     'Вал~юта')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colISD',     'Входящий~остаток~ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colISK',     'Входящий~остаток~КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colDOS',     'Обороты~Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colKOS',     'Обороты~Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colOSTCD',   'Исходящий~остаток~ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colOSTCK',   'Исходящий~остаток~КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.colRAT',     'Средневзвешенная~ставка')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('tbl_CcySummarise.cTEqv',      'Экв.')
.head 7 -  ! ====================================================
.head 7 -  ! win_StmtLegend
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('win_StmtLegend.bgD', 'Сальдо: Дебет')
.head 7 -  Call CurrentLangTable.AddAtom('win_StmtLegend.bgK', 'Сальдо: Кредит')
.head 7 -  Call CurrentLangTable.AddAtom('win_StmtLegend.bgC', 'Обороты: Фактические')
.head 7 -  Call CurrentLangTable.AddAtom('win_StmtLegend.bgB', 'Обороты: Плановые')
.head 7 -  Call CurrentLangTable.AddAtom('win_StmtLegend.bgF', 'Обороты: Форвардные')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_ListValuts
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ListValuts.cTWndTitle', 'Список валют')
.head 7 -  ! button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ListValuts.pbSave',     'Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ListValuts.pbExit',     'Выход')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_RefPsEx
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.cTWndTitle1', 'Классы...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.cTWndTitle2', 'Разделы...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.cTWndTitle3', 'Группы...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.cTWndTitle4', 'Балансовые счета...')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.colNBS',      'Бал~счет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.colNAME_NBS', 'Наименование балансового счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.colXAR_NBS',  'Хар-~ка')
.head 7 -  ! button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.pbSave',      'Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_RefPsEx.pbExit',      'Выход')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_ChooseCustomer
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTWndTitle',               'Поиск клиента')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.bgInputData',              'Введите данные для поиска:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.bgOkpo',                   'ОКПО')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.bgNmk',                    'Ниаменование')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.bgFio',                    'ФИО')
.head 7 -  ! button
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.pbOk',                     'Выбрать')
.head 7 -  ! tbl
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.tblCustomer.colRnk',       'Рнк')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.tblCustomer.colNmk',       'Наименование~клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.tblCustomer.colPasspSer',  'Серия~паспорта')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.tblCustomer.colPasspNum',  'Номер~паспорта')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.tblCustomer.colBirthDay',  'Дата~рождения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.tblCustomer.colMfo',       'МФО')
.head 7 -  ! msg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTMsgAttrNotSet',          'Не заполнен реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTMsgCustomerNotFound',    'Клиент с указанными данными не найден!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTMsgChooseCustomer',      'Выбрать из зарегистрированных клиентов?')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTMsgClientFromOutSystem', 'Выбранный клиент зарегистрирован в другой системе.')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTMsgSyncClient',          'Синхронизировать данные клиента?')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustomer.cTMsgCheckClientParams',   'Проверьте параметры клиента.')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_ChooseCustType
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.cTWndTitle',    'Выберите тип контрагента')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.rbPerson',      'Физическое лицо')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.rbCPD',         'Физическое лицо-СПД')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.rbCorporation', 'Юридическое лицо')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.rbBank',        'Банк')
.head 7 -  ! button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.pbOpen',        'Открыть')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ChooseCustType.pbCancel',      'Отменить')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_SetDat
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetDat.cTWndTitle', 'Укажите даты...')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetDat.bgS',        'С')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetDat.bgPo',       'По')
.head 7 -  ! button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetDat.pbOk',       'Применить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_SetDat.pbCancel',   'Отменить')
.head 7 -  ! ====================================================
.head 7 -  ! Frm_Customer
.head 7 -  ! menuCustomer
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenuCust', 'Контрагенты')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu0',    'Просмотр')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu01',   'Все')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu02',   'Физические лица')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu03',   'Юридические лица')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu04',   'Банки-контрагенты')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu05',   'Показывать закрытых')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu1',    'Карточка контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu2',    'Счета контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu3',    'Зарегистрировать Нового')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu4',    'Закрыть контрагента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu5',    'Перерегистрирвать')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu6',    'Фильтр')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu7',    'Сортировка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu8',    'Искать')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu9',    'Искать снова')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu10',   'Перечитать')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu11',   'Выход')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.menuCustomer.cTMenu12',   'Печать...')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTWndTitleOpen',          'Регистрация клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTWndTitleEdit',          'Просмотр/Редактирование реквизитов клиента.')
.head 7 -  ! Tabs
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustGeneral',         'Основные')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustNI',              'Рекв.налогопл.')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustEN',              'Эк. нормативы')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustOwn',             'Реквизиты клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustInfo',            'Доп.информация')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustDR',              'Доп.реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustRel',             'Связ.лица')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustCard',            'Карты и инструменты')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustRisk',            'Риски')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustRept',            'Репутация')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTabCustCtg',             'Категории')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipOpen',               'Зарегистрировать клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipSave',               'Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipClose',              'Закрыть клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipPrint',              'Печать справки')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipDeals',              'Договора')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipAccounts',           'Счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipT8',                 'Фінансова звітність та Аналіз фінінсового стану')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipQuestion',           'Ключевое слово')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cBTipExit',               'Выйти')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTBanks',                 'Банк')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTCorps',                 'Юридическое лицо')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTPerson',                'Физическое лицо')
.head 7 -  ! Message
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgOpen',               'Выполнить регистрацию нового Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgSave',               'Сохранить изменения в реквизитах Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgOpenOK',             'Регистрация нового Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgSaveOK',             'Сохранение изменений в реквизитах Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgRNK1',               'Клиенту банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgRNK2',               'присвоен регистрационный номер')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgRNK3',               'Сохранены реквизиты Клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgTerr1',              'Одно из наименований клиента похоже на наименование из списка террористов.')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgTerr2',              'Продолжить регистрацию клиента?')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgTerr3',              'Продолжить обновление реквизитов клиента?')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgTerr4',              'Приостановлена регистрация/обновление клиента из-за подозрения в принадлежности к списку террористов')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTMsgTerr5',              'Продолжена регистрация/обновление клиента, подозреваемого в принадлежности к списку террористов')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTErrCust',               'Не удалось прочитать данные клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTErrOpen',               'Ошибка регистрации Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTErrEdit',               'Ошибка обновления реквизитов Клиента банка')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Customer.cTErrTel',                'Не заполнен один из реквизитов')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustGeneral
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.pbCard',          'Выбрать карту')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgDateOn',        'Дата регистрации:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgDateOff',       'Дата закрытия:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgRnk',           'Регистрационный №:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNd1',           '№ договора:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmk',           'Наименование клиента (нац):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmkF',          'Фамилия:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmkI',          'Имя:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmkO',          'Отчество:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmk4',          'Имя-4 нерезидента:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmkv',          'Наименование (межд.):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNmkk',          'Наименование (краткое):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgAdr',           'Адрес клиента:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgAdr2',          'Адрес фактический:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgAdr3',          'Адрес почтовый:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgAdrUr',         'Адрес (юридический):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgAdrPropiska',   'Адрес (место прописки):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgAdrFLP',        'Место проживания (юрид. адрес):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgK014',          'Тип клиента (K014):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgK030',          'Резидентность (K030):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgCodcagent',     'Характеристика клиента (K010):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgCountry',       'Страна клиента (K040):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgPrinsider',     'Признак инсайдера (K060):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgTgr',           'Тип гос. реестра:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgStmt',          'Вид выписки:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgOkpo',          'Идентификационный код:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgNRezidCode',    'Код в стране регистрации:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgSab',           'Электронный код клиента:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgBC',            'НЕ является клиентом банка')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.bgCard',          'Номер карты:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.tblAcc.colName',  'Наименование инструмента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.tblAcc.colApply', 'Выбрать')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.cTErrIdk',        'Введите правильный Идентификационный код клиента ( ОКПО )!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.cTErrOkpo',       'Клиент банка с введенным ОКПО уже зарегистрирован!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.cTErrOkpoDat',    'Введенное ОКПО зарегистрировано у закрытого клиента!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.cTErrSab',        'Введите правильный электронный код клиента!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustGeneral.cTErrSymb',       'содержит недопустимые символы!')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustNI
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.cbUseNi',     'Заполнять реквизиты Налогоплательщика')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgC_reg',     'Областная НИ:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgC_dst',     'Районная НИ:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgAdm',       'Адм. орган регистрации:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgRgadm',     'Номер регистрации в ДПА:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgDateA',     'Дата рег. в Адм:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgRgtax',     'Номер регистрации в ДПИ:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgDateT',     'Дата рег. в НИ:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgPDVInfo', 'Дані про платника ПДВ')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgNomPDV',  '№ в реестре плательщиков ПДВ:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.bgTaxf',      'Индивидуальный налоговый номер:')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.cTErrTaxf',   'Введите правильный налоговый код клиента в НИ!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.cTErrRgtax',  'Введите правильный регистрационный номер клиента в НИ!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.cTErrDateT',  'Введите правильную дату регистрации клиента в НИ!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.cTErrDateA',  'Введите правильную дату регистрации клиента в администрации!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNI.cTErrKod',    'Неизвестный код!')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustEN
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.cbUseEn',   'Заполнять Экономические нормативы')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.bgIse',     'Инст. сек. экономики (K070):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.bgFs',      'Форма собственности (K080):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.bgOe',      'Отрасль экономики (K090):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.bgVed',     'Вид эк. деятельности (K110):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.bgK050',    'Форма хозяйствования (K050):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.bgSed',     'Форма хозяйствования (K051):')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.cTErrIse',  'Нет такого сектора')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.cTErrForm', 'Нет такой формы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.cTErrOe',   'Нет такой отрасли')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.cTErrVed',  'Нет такого вида')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustEN.cTErrEN',   'Неверно заполнены эк. нормативы')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustBanks
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgRating', 'Рейтинг банка:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgMfo',    'Код банка МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgBic',    'Код банка BIC:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgBicAlt', 'Альтернативный BIC-код:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bg1PB',    'Код банка для 1ПБ:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgRuk',    'Руководитель:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgBuh',    'Гл. бухгалтер банка:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgTelR',   'Телефон руководителя:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.bgTelB',   'Телефон гл. бухгалтера:')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustBank.cTErr1PB', 'Неверно указан код банка для 1ПБ.')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustCorps
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.cBTipSWReceiver',           'Реквизиты получателя SWIFT-сообщения')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgNmku',                    'Наименование по уставу:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgRuk',                     'Руководитель:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgBuh',                     'Гл. бухгалтер предприятия:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgTelR',                    'Телефон руководителя:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgTelB',                    'Телефон гл. бухгалтера:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgTelFax',                  'Факс:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgEMail',                   'Адрес электронной почты:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgAddress',                 'Адреса клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.bgMain',                    'Реквизиты в других банках')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colTypeName',    'Тип адреса')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colCountryName', 'Страна')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colZip',         'Индекс')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colDomain',      'Область')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colRegion',      'Регион')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colLocality',    'Населенный пукт')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colAddress',     'Адрес (улица, дом, квартира)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAddress.colTerritoryId', 'Код территории')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAcc.colMfo',             'МФО')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAcc.colNls',             '№ счета')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAcc.colKvName',          'Валюта')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAcc.colComm',            'Примечание')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.tblAcc.colBankName',        'Название банка')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.cTErrMfo',                  'Несуществующее МФО!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.cTErrNls',                  'Неверный контрольный разряд счета!')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCorp.cTMsgTerrNotSet',           'Не заполнен код территории!')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustPerson
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cbAnonymous',               'Заполнять персональные реквизиты')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgPassp',                   'Вид документа:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgSer',                     'Серия:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgNumDoc',                  'Номер:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgOrgan',                   'Кем выдан:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgPdate',                   'Когда выдан:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgBday',                    'Дата рождения:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgBplace',                  'Место рождения:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgSex',                     'Пол:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgTeld',                    'Дом. телефон:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgTelw',                    'Раб. телефон:')
.head 7 -  ! ID
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgActualDate',              'Действителен до:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgEddrId',                  'Уникальный номер записи в ЕГДР:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgNumDocID',                'Номер паспорта-ID-карты:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgPdateID',                 'Дата выдачи:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.bgOrganID',                 'Орган, который выдал:')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colTypeName',    'Тип адреса')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colCountryName', 'Страна')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colZip',         'Индекс')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colDomain',      'Область')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colRegion',      'Регион')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colLocality',    'Населенный пукт')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colAddress',     'Адрес (улица, дом, квартира)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.tblAddress.colTerritoryId', 'Код территории')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTN',                       'Неопределен')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTM',                       'Мужской')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTG',                       'Женский')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTMsgPassp',                'Уже зарегистрирован клиент с введенными паспортными данными!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTMsgPasspClose',           'Существует закрытый клиент с введенными паспортными данными!')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrPdate',                'Введите правильную дату выдачи документа!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrBday',                 'Введите правильную дату рождения!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrSer',                  'Серия паспорта должна содержать 2 символа!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrNumDoc',               'Номер паспорта должен содержать 6 цифр!')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrPhoneCode',            'Неверный код! Выбрать из справочника?')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrPhoneLen',             'Номер телефона должен содержать 9 цифр!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrPhoneM',               'Некорректно заполнен мобильный телефон!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrPhoneD',               'Некорректно заполнен домашний телефон!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustPerson.cTErrPhoneEmpty',           'Нужно заполнить телефон!')
.head 7 -  !
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustInfo
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgIsp',              'Менеджер клиента:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgNotes',            'Примечание:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgIndicate',         'Класс заемщика:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgMB',               'Принадлежность малому бизнесу:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgAdr_alt',          'Альтернативный адрес:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgLim',              'Лимит на активные операции:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgNom_dog',          '№ дог. за сопровождение:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgLim_kass',         'Лимит кассы:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgRnkP',             'Рег.№ холдинга:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgNotesec',          'Примечание для службы безопасности:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.bgMain',             'Реквизиты в других банках')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.tblAcc.colMfo',      'МФО')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.tblAcc.colNls',      '№ счета')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.tblAcc.colKvName',   'Валюта')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.tblAcc.colComm',     'Примечание')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.tblAcc.colBankName', 'Название банка')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustInfo.cTErrNomPDV',        'Введите правильный номер!')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustDR
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.tblDR.colDR',    'Реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.tblDR.colNDR',   'Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.tblDR.colVal',   'Значение')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cbDROpt',        'Проверять заполнение обязательных реквизитов')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTErrNumber',    'должно быть число!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTErrData',      'должна быть дата!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTErrValOnNsi',  'Неверное значение реквизита!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTErrValOnNsi_', 'Выберите значение из справочника!')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTF4',           'для вызова справочника')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTF6',           'для редактирования')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTMemoEditor',   'Редактирование реквизита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTOpt',          'Обязательный реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTВDoubNoEdit',  'Двойной клик - посмотреть значение по ключу')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustDR.cTValueAbsents', 'Значение отсутствует в справочнике')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustRel
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.cBTipNsiRel',                   'Выбрать значение из сравочника НЕклиентов банка')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colRnkB',        'РНК связанного~клиента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colName',        'Наименование или ФИО~свяанного лица')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colDocTypeName', 'Тип~документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colDocSerial',   'Серия~документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colDocNumber',   'Номер~документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colDocDate',     'Дата выдачи~документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colDocIssuer',   'Место выдачи~документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colBirthDay',    'Дата~рождения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colBirthPlace',  'Место~рождения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colSexName',     'Пол')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colAdr',         'Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colTel',         'Телефон')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colEMail',       'Адрес~эл. почты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colCustType',    'Признак участника~(1-ЮЛ, 2-ФЛ)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colOkpo',        'Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colCountry',     'Код~страны')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colRegion',      'Код~региона')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colFs',          'Форма~собственности~(K081)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colVed',         'Код вида~эконом. деят-ти~(K110)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colSed',         'Код орг.-правовой~формы хоз-ния~(K051)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colIse',         'Код инст.сетора~экономики~(K070)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblCustomerRel.colNotes',       'Примечание')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelations.colRelName',       'Признак~связанности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelations.colRelFlag',       'Привя-~зать')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colVaga1',        'Удельный вес~прямого участия~в уставном фонде')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colVaga2',        'Удельный вес~опосредствованного участия~в уставном фонде')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colTypeName',     'Тип~довереного лица')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colPosition',     'Должность')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colPosition_r',   'Должность~в род. падеже')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colDocTypeName',  'Тип~документа доверенности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colDocument',     'Документ~доверенности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colTRegnum',      'Номер регистрации~доверенности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colTRegdat',      'Дата регистрации~доверенности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colBDate',        'Дата начала~действия доверенности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colEDate',        'Дата окончания~действия доверенности')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colNName',        'ФИО~нотариуса')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colNRegion',      'Нотариальный~округ')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colSignPrivs',    'Право~подписи')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colLastName',     'Фамилия')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colFirstName',    'Имя')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colMiddleName',   'Отчество')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colNameR',        'ФИО дов. лица~в род. падеже')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colRelBDate',     'Дата начала~действия полномочий')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.tblRelDetails.colRelEDate',     'Дата окончания~действия полномочий')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.cTMsgRnkBNotFound',             'Не найден клиент с указанным РНК')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.cTMsgRnkRelNotFound',           'Не найден НЕклиент банка с указанным №')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.cTMsgRelNotSet',                'Не указан тип связи для связанного лица!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRel.cTMsgVaga100',                  'Значение не должно превышать 100')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_ChooseCustRel
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.cTWndTitle', 'Выбор клиента/связанного лица')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.rbPerson',   'Физическое лицо')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.rbCorp',     'Юридическое лицо')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.bgRnk',      'Рег.номер клиента/связ.лица')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.bgOkpo',     'ОКПО клиента/связ.лица')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.bgFio',      'ФИО/наим. клиента/связ.лица')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.pbSearch',   'Поиск')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.pbOk',       'Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ChooseCustRel.pbCancel',   'Отменить')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustRelExtern
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.cTWndTitle', 'Редактирование параметров связанного лица')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgNmk',      'Наименование связ.лица')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgOkpo',     'ОКПО')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgCountry',  'Страна')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgReg',      'Регион')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgAdr',      'Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgTel',      'Телефон')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgEMail',    'Адрес эл.почты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgVed',      'Вид эк. деятельности (K110)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgSed',      'Форма хозяйствования (K051)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgIse',      'Инст. сек. экономики (K070)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgDoc',      'Документ')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgDocSer',   'Серия документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgDocNum',   'Номер документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgDocDate',  'Дата выдачи документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgDocIssue', 'Орган выдачи документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgBDay',     'Дата рождения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgBPlace',   'Место рождения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgSex',      'Пол')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.bgComm',     'Примечание')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.pbOk',       'Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustRelExtern.pbCancel',   'Отменить')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustAdr
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.pbDubl',        'Заполнить')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.pbOk',          'Применить')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.pbCancel',      'Отменить')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgAdr',         'Адрес клиента:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgCountry',     'Страна')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgTerritoryId', 'Код территории:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgIndex',       'Индекс:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgObl',         'Область:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgReg',         'Район:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgCity',        'Населенный пункт:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustAdr.bgStreet',      'Улица, дом, кв.:')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustNNCard
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cBTipAddCard',              'Добавить карту')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cBTipCloseCard',            'Закрыть карту')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cBTipChangeCard',           'Сменить карту')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cBTipEditCard',             'Редактировать карту')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colCardTypeName',   'Тип.~Карты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colID',             'Ид.~Карты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colACS_ID',         'Ид.~в АКС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colPOOL_NO',        '№~пула')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colISSUER_DATE',    'Дата~старта карты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colEXPIRE_DATE',    'Дата~окончания')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colSTATUS',         'Статус~для АКС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colSTOP_STATUS',    'Статус постановки карты~в STOP лист')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colComment',        'Коментарий')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colClosed',         'Признак~закрытой карточки')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colChgType',        'Тип~изменения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblCard.colChgDate',        'Дата~изменения')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colTOOL_ID',        'Ид. инструмента~АБС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colTOOL_ACS_ID',    'Ид. инструмента~в АКС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colTOOL_TYPE_NAME', 'Наименование~типа инструмента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colENTER_DATE',     'Дата начала~действия')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colEXPIRE_DATE',    'Дата окончания~действия')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colLIM_NUM',        'Номер~схемы лимитов')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colLIM_NAME',       'Наименование~схемы лимитов')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colLOAD_NLS',       'Счет~загрузки')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colLOAD_NMS',       'Наименование~счета загрузки')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colLIM_NUM',        'Номер~схемы лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colLIM_NAME',       'Наименование~схемы лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colINS_NLS',        'Счет~инструмента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colINS_NMS',        'Наименование~счета инструмента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colChgType',        'Тип~изменения')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.tblTool.colChgDate',        'Дата~изменения')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cTCard',                    'Карты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cTTool',                    'Инструменты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCard.cTArc',                     'архив')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustNNCardAdd
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.cTWndTitle',                'Просмотр/редактирование карты')
.head 7 -  ! pb
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.pbSave',                    'Применить')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.bgCardId',                  'Ид.карты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.bgCardTypeId',              'Тип карты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.bgComment',                 'Коментарий')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.bgKeyPhrase',               'Ключевая фраза')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colTOOL_ID',        'Ид. инструмента~АБС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colTOOL_ACS_ID',    'Ид. инструмента~в АКС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colTOOL_TYPE_NAME', 'Наименование~типа инструмента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colENTER_DATE',     'Дата начала~действия')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colEXPIRE_DATE',    'Дата окончания~действия')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colLIM_NUM',        'Номер~схемы лимитов')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colLIM_NAME',       'Наименование~схемы лимитов')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colLOAD_NLS',       'Счет~загрузки')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colLOAD_NMS',       'Наименование~счета загрузки')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colLIM_NUM',        'Номер~схемы лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colLIM_NAME',       'Наименование~схемы лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colINS_NLS',        'Счет~инструмента')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardAdd.tblTool.colINS_NMS',        'Наименование~счета инструмента')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustNNCardEditTool
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardEditTool.cTWndTitle',   'Инструмент')
.head 7 -  ! pb
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardEditTool.pbSave',       'Применить')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardEditTool.bgLoadAcc',    'Счет загрузки')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardEditTool.bgLimit',      'Схема лимита')
.head 7 -  ! msg
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustNNCardEditTool.cTMsgLoadAcc', 'Не указан счет загрузки!')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_KeyPhrase
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_KeyPhrase.cTWndTitle', 'Ключевое слово для постановки карты в стоп-лист')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_KeyPhrase.pbSave',     'Применить')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_KeyPhrase.bgQuestion', 'Вопрос:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_KeyPhrase.bgAnswer',   'Ответ:')
.head 7 -  ! ====================================================
.head 7 -  ! Frm_Account
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTWndTitleOpen',   'Открытие ЛС')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTWndTitleEdit',   'Обновление реквизитов ЛС №')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTWndTitleView',   'Просмотр реквизитов ЛС №')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTWndTitleKlient', 'Контрагент банка: Рег.№')
.head 7 -  ! Tabs
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccGeneral',   'Основные')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccFinancial', 'Финансовые')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccRights',    'Права доступа')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccSP',        'Спецпараметры')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccAcrn',      'Проценты')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccRates',     'Тарифы')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccSob',       'График событий')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTabAccNNLimit',   'Схемы лимитов')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipOpen',        'Открыть счет')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipOpenKv',      'Открыть по валютам')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipSave',        'Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipClose',       'Закрыть счет')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipPrint',       'Печать справки')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipExit',        'Выйти')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cBTipProf',        'Выбрать профиль')
.head 7 -  ! Field
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cbOnAllValuts',    'По валютам')
.head 7 -  ! Message
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgSec',         'Проставление прав доступа для пользователей ' ||
'"Другие" существенно повышает риск нежелательного доступа к счету. Продолжать с текущими установками?')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpen',        'Открыть')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenV',       'ВНЕСИСТЕМНЫЙ')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenLS',      'лицевой счет')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenKv',      'валюта')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenV2',      'ВНЕСИСТЕМНЫЕ')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenLS2',     'лицевые счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenKv2',     'по выбранным валютам')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgSave',        'Сохранить изменения в реквизитах лицевого счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenOK',      'Открыт лицевой счет')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgOpenOK2',     'Открыты лицевые счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgSaveOK',      'Сохранены изменения в реквизитах лицевого счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgAccReg',      'уже зарегистрирован за клиентом')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTMsgDone',        'Продолжить регистрацию счета?')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTErrOwner',       'Не определен Контрагент - владелец счета!')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTErrAcc',         'Не удалось прочитать данные счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTErrOpen',        'Ошибка открытия лицевого счета')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_Account.cTErrEdit',        'Ошибка обновления лицевого счета')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccGeneral
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgDateOn',      'Дата открытия:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgDateOff',     'Дата закрытия:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgNbs',         'Балансовый счет (R020):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgNls',         '№ счета:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgNlsAlt',      'Альтернативный №:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgNms',         'Наименование:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgValuta',      'Валюта (R030):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgUser',        'Исполнитель:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgPap',         'А/П/АП (T020):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgXar',         'Характеристика:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgTip',         'Тип счета:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgPos',         'Признак счета:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgVid',         'Вид счета (НИ):')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgVidBlkD',     'Блокировка по Дебету:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgVidBlkK',     'Блокировка по Кредиту:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgMfo',         'МФО для процессинг.счета:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgTobo',        'Код безбаланс. отделения:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.bgToboName',    'Название безбаланс. отделения:')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.pbAccountMask', 'Рассчитать № счета по маске')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.cTErrNbs',      'Нет такого балансового счета~или балансовый счет закрыт')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.cTErrNls',      'Лицевой счет с таким номером и валютой уже существует!')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.cTErrIsp',      'Нет исполнителя с таким номером')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.cTErrPap',      'Признак АКТ-ПАС не отвечает плану счетов.')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.cTErrNbsK014',  'Недопустимый балансовый счет~для типа клиента')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccGeneral.cTMfo',         'Введите или выберите МФО')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccFinancial
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgLimit',      'Лимит овердрафта:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgLimitMinus', 'Неснижаемый остаток:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgMaxLim',     'Max остаток на счете:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgDapp',       'Дата последней операции:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgNom',        'в Номинале')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgOb',         'Обороты:')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgD',          'Д')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgK',          'К')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.bgOst',        'Остаток:')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccFinancial.cTEqv',        'в Эквиваленте')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccRights
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.tblGrp.colId',      '№ группы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.tblGrp.colName',    'Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.tblGrpAll.colId',   '№ группы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.tblGrpAll.colName', 'Наименование')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.pbAdd',             'Добавить счет в выбранные группы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.pbDrop',            'Удалить счет из выбранных групп')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.bgAccGrp',          'Выбранные группы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRights.bgAllGrp',          'Доступные группы')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccSP
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSP.cbSPOpt',      'Проверять заполнение обязательных спецпараметров')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSP.tblSP.colSem', 'Наименование спецпараметра')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSP.tblSP.colZsp', 'Значение')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSP.cTF4',         'для вызова справочника')
.head 7 -  ! ====================================================
.head 7 -  ! frm_ProcAccounts
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgGroups',     'Тип % картки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgDaty',       'Дати')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNachisleni', 'Нарахування')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgVyplaty',    'Виплати')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgPrekrasch',  'Закінчення')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgAcrnParams', 'Параметри нарахування')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgMetodN',     'Метод нарахування')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgBaseGN',     'Базовий рік')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgPeriodN',    'Періодичність')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgOstatN',     'Залишок')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNachN',      'Операція нарахування %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgTTN',        'Тип')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgValN1',      'Вал')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNlsN1',      'Рах нар %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgValN2',      'Вал')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNlsN2',      'КонтрРахунок')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgVyplN',      'Операція виплати %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgTT2',        'Тип')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgKvC',        'Вал')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNlsC',       'Рахунок виплати')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNamC',       'Назва рахунку')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgMfoC',       'МФО')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgOkpoC',      'ЗКПО')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgNazn',       'Призначення платежу')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.bgRates',      '%% ставки')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cbBank',       'Рахунок в інш.банку')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cBTipCopy',    'Перенести параметры из основной карточки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cBTipIns',     'Добавить новую запись')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cBTipDel',     'Пометить/Снять пометку на удаление')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTMess11',     'Счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTMess12',     'не открыт')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTMess13',     'Открыть ?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTMess2',      'Нар.%%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTMess3',      'АвтоОткрытие сч.')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTErrKR',      'Конр.разряд')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.cTErrAcc',     'Не открыт счет с внутренним №')
.head 7 -  ! table
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.tbl.dIntDat',  'Дата')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.tbl.nIr',      'Ставка~індивідуальна')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.tbl.sOp',      'Фор-~мула')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ProcAccounts.tbl.sBr',      'Базова ставка')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccRates
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colName',  'Наименование тарифа-комиссии')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colCur',   'Базовая~Вал.')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colRate',  'Тариф~в "коп"')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colCom',   'Комиссия (%)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colMin',   'Минимум~в "коп"')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colKvMin', 'Валюта~MIN~суммы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colMax',   'Максимум~в "коп"')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colKvMax', 'Валюта~MAX~суммы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colBDate', 'Дата начала~действия тарифа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.tblRates.colEDate', 'Дата окончания~действия тарифа')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.cTF4',              'Установить значения по умолчанию')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.cTGeneralRate',     'Общий тариф')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccRates.cTIndividualRate',  'Индивидуальный тариф')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccSob
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSob.tblAccSob.colDAT', 'Дата~события')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSob.tblAccSob.colID',  '№~п/п')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSob.tblAccSob.colISP', 'Ид.~исп.')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSob.tblAccSob.colFIO', 'ФИО~исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSob.tblAccSob.colTXT', 'Текст')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccSob.cTErrDAT',         'Дата должна быть не меньше банковской!')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccNNLimit
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.cBTipAddLimit',           'Добавить лимит')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.cBTipDelLimit',           'Удалить лимит')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.cBTipChangeLimit',        'Изменить лимит')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.cBTipPosUp',              'Переместить вверх')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.cBTipPosDown',            'Переместить вниз')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimId',       'Ід. ліміту')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimNum',      'Номер лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimValue',    'Сума ліміту')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimValueAcs', 'Сума ліміту в АКС')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimFixBal',   'Остатот фикс. Суммы')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimStatus',   'Состояние')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimError',    'Ошибка')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimit.tblLimit.colLimDeleted',  'Признак удаленного лимита')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_AccNNLimitAdd
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.cTWndTitleAdd',    'Добавление лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.cTWndTitleChange', 'Изменение лимита')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.pbSave',           'Применить')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.cbIsFix',          'Признак фиксированной суммы лимита')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.bgFixAmnt',        'Фиксированная сумма')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.bgFixDays',        'Период фикс. cуммы ')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.bgMinBal',         'Неснижаемый остаток')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.bgMaxBal',         'Макс. cумма лимита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_AccNNLimitAdd.bgPrcBal',         'Процент дост. Остатка')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_ProcAccounts
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ProcAccounts.cTWndTitle', 'Параметры начисления %% по счету')
.head 7 -  ! Call CurrentLangTable.AddAtom('dlg_ProcAccounts.cTWndTitle', 'Параметри нарахування %% по рахунку')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ProcAccounts.cBTipSave',  'Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ProcAccounts.cBTipClose', 'Выйти')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_GetProf
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_GetProf.cTWndTitle',      'Выберите профиль')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_GetProf.cBTipDetails',    'Просмотреть значения профиля')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_GetProf.tblProf.colNp',   '№~п/п')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_GetProf.tblProf.colName', 'Наименование~профиля')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_ShowProf
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ShowProf.cTWndTitle',         'Значения профиля')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ShowProf.tblProfVal.colName', 'Наименование поля')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_ShowProf.tblProfVal.colVal',  'Значение')
.head 7 -  ! ====================================================
.head 7 -  ! dlgEditCustSign
.head 7 -  Call CurrentLangTable.AddAtom('dlgEditCustSign.cTWndTitle', 'Образец подписи/печати')
.head 7 -  ! pb
.head 7 -  Call CurrentLangTable.AddAtom('dlgEditCustSign.pbSave',     'Применить')
.head 7 -  ! Message
.head 7 -  Call CurrentLangTable.AddAtom('dlgEditCustSign.cTMsgEdit1', 'Данные были изменены!')
.head 7 -  Call CurrentLangTable.AddAtom('dlgEditCustSign.cTMsgEdit2', 'Сохранить изменения?')
.head 7 -  Call CurrentLangTable.AddAtom('dlgEditCustSign.cTMsgSize',  'Размер файла превышает допустимый')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_CustPrnt
.head 7 -  Call CurrentLangTable.AddAtom('dlg_CustPrnt.cTWndTitle', 'Печать...')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_CustPrnt.pbOk',       'Применить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_CustPrnt.bgCalendar', 'Выберите дату')
.head 7 -  ! ====================================================
.head 7 -  ! DlgSWReceiver
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.cTWndTitle',  'Реквизиты получателя SWIFT-сообщения')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.pbSave',      'Применить')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgBank',      'Банк')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgAcc',       'Счет')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW56',      'Банк-посредник')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW56_Name', 'Название')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW56_Adr',  'Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW56_Code', 'SWIFT-код')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW57',      'Банк-Бенефициар')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW57_Name', 'Название')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW57_Adr',  'Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW57_Code', 'SWIFT-код')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW57_Acc',  'Счет в банке-посреднике')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW59',      'Бенефициар')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW59_Name', 'Название')
.head 7 -  Call CurrentLangTable.AddAtom('DlgSWReceiver.bgSW59_Adr',  'Адрес')
.head 7 -  ! ====================================================
.head 7 -  ! dlgFindNls
.head 7 -  Call CurrentLangTable.AddAtom('dlgFindNls.cTWndTitle','Поиск счета')
.head 7 -  ! ====================================================
.head 7 -  ! Dlg_CustCriteria
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colRiskId',       'Код~риска')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colRiskName',     'Показатель~риска')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colReptId',       'Код~репутации')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colReptName',     'Показатель~репутации')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colCategoryId',   'Код~категории')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colCategoryName', 'Показатель~категории')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_CustCriteria.colValue',        'Установить')
.head 7 -  ! ====================================================
.head 7 -  ! dlgParHist
.head 7 -  Call CurrentLangTable.AddAtom('dlgParHist.tblParam.colDat1',  'Дата~установки')
.head 7 -  Call CurrentLangTable.AddAtom('dlgParHist.tblParam.colValue', 'Значение')
.head 7 -  ! ====================================================
.head 7 -  ! dlgCheckOkpo
.head 7 -  Call CurrentLangTable.AddAtom('dlgCheckOkpo.cTWndTitle', 'Проверка ОКПО')
.head 7 -  Call CurrentLangTable.AddAtom('dlgCheckOkpo.pbOk',       'Сохранить')
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('CheckOkpoPassp.cTMsg1', 'Клієнт з такими даними вже зареєстрований з РНК')
.head 7 -  Call CurrentLangTable.AddAtom('CheckOkpoPassp.cTMsg2', 'Змініть введені дані або скористайтесь відкритою карткою клієнта!')
.head 7 -  ! ====================================================
.head 7 -  !
.head 6 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\tmp.lng','RUS')
.head 6 -  Set fInitLib = TRUE
.head 5 -  Return fInitLib
.head 3 +  Function: CustAcnt_SaveLangFile ! __exported
.head 4 -  Description: Сохранить языковую таблицу в файл
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call CurrentLangTable.SaveToFile('C:\\TEMP\\custacnt.lng','RUS')
.head 3 -  !
.head 3 -  ! CUSTOMER.APL - функции
.head 3 -  !
.head 3 +  Function: ShowCustomers         ! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 5 -  Number: para !! 1-только клиенты: 2-только счета : 3 - все
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFlags
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 +  If nMode = 100
.head 6 -  Call SalCreateWindow(frmRelations, hWndMDI, para)
.head 5 +  Else If nMode = 101
.head 6 -  Set nFlags = CVIEW_ApproveKK | CVIEW_ReadOnly
.head 6 -  Call SalCreateWindow(frm_CustomerList, hWndMDI, nFlags, 0, 'a.req_type in (0,1)')
.head 5 +  Else
.head 6 -  Set nFlags = SetControlFlags(nMode, para)
.head 6 -  Call SalCreateWindow(frm_CustomerList, hWndMDI, nFlags, 0, '')
.head 5 -  Return TRUE
.head 3 +  Function: ShowCustomersByType   ! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 5 -  Number: para !! 1-только клиенты: 2-только счета : 3 - все
.head 5 -  Number: nType	! 4-NNдерж., 5-NNторг., 6-NNAll
.head 5 -  String: strAddCond
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFlags
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Set nFlags = SetControlFlags( nMode, para )
.head 5 -  Call SalCreateWindow( frm_CustomerList, hWndMDI, nFlags, nType, strAddCond )
.head 5 -  Return TRUE
.head 3 +  Function: EditCustPerson        ! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Физлицо
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  ! Call SalBringWindowToTop(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 3, NUMBER_Null, nCtlFlags, hWndParent, 0, '', 0, TRUE)
.head 3 +  Function: EditCustCorps         ! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Юрлицо
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 2, NUMBER_Null, nCtlFlags, hWndParent, 0, '', 0, TRUE)
.head 3 +  Function: EditCustBanks		! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Банк
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  ! 0- показывать все
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 1, NUMBER_Null, nCtlFlags, hWndParent, 0, '', 0, TRUE)
.head 3 +  Function: EditCustPersonEx      ! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Физлицо
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: sAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 3, NUMBER_Null, nCtlFlags, hWndParent, nPar,
    sAccFilter, bNN, TRUE)
.head 3 +  Function: EditCustPersonSPD     ! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Физлицо
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: sAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 10, NUMBER_Null, nCtlFlags, hWndParent, nPar,
    sAccFilter, bNN, TRUE)
.head 3 +  Function: EditCustPersonFL      ! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Физлицо
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: sAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 9, NUMBER_Null, nCtlFlags, hWndParent, nPar,
    sAccFilter, bNN, TRUE)
.head 3 +  Function: EditCustCorpsEx       ! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Юрлицо
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: sAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 2, NUMBER_Null, nCtlFlags, hWndParent, nPar,
    sAccFilter, bNN, TRUE)
.head 3 +  Function: EditCustBanksEx	! __exported
.head 4 -  Description: Редактирование реквизитов клиента - Банк
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: sAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, 1, NUMBER_Null, nCtlFlags, hWndParent, nPar,
    sAccFilter, bNN, TRUE)
.head 3 +  Function: F_Frm_DR		! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRNK
.head 5 -  Number: nCType
.head 5 -  Number: nCtrlFlags
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 +  If nRNK > 0
.head 6 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRNK, nCType, NUMBER_Null,
    nCtrlFlags | AVIEW_ReadOnly | CVIEW_DROnly, hWndNULL, 6, '', 0, TRUE)
.head 6 +  ! If not IsWindow(h_Frm_DR)
.head 7 -  Set h_Frm_DR = SalCreateWindow(Frm_Customer, hWndMDI, nRNK, nCType, nCtrlFlags | AVIEW_ReadOnly | CVIEW_DROnly,
    hWndNULL, 6, '', 0, TRUE)
.head 3 +  Function: EditCustomer		! __exported
.head 4 -  Description: Редактирование реквизитов клиента
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nType
.head 5 -  Number: nRezid
.head 5 -  Number: nRnk
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: sAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRetRnk
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Call ShowCustAcc_Init()
.head 5 +  If nRnk = 0 and PAR_HAVETOBO = 2
.head 6 -  ! Выбрать из зарегистрированных клиентов?
.head 6 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgChooseCustomer'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
.head 7 +  If SalModalDialog(Dlg_ChooseCustomer, hWndForm, nType, nRezid, nRetRnk)
.head 8 -  Set nRnk = nRetRnk
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, nType, nRezid, nCtlFlags, hWndParent, nPar, sAccFilter,
    bNN, TRUE)
.head 3 +  Function: ShowCLV
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nType
.head 5 -  Number: nCtlFlags
.head 5 -  Window Handle: hWndParent
.head 5 -  String: sAccFilter
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If IsWindow(hFrmCustomer)
.head 6 -  Call SalDestroyWindow(hFrmCustomer)
.head 5 -  Set hFrmCustomer = SalCreateWindow(Frm_Customer, hWndMDI, nRnk, nType, NUMBER_Null, nCtlFlags, hWndParent, 0,
    sAccFilter, FALSE, FALSE)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: SetControlFlags
.head 4 -  Description: Установить управляющие флаги для функции
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 5 -  Number: nParam
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFlg
.head 5 -  String: sTmp
.head 5 -  Number: nTip
.head 4 +  Actions
.head 5 -  Set nFlg = 0
.head 5 -  Set sTmp = Left(Str(nParam)||'0',2)
.head 5 -  Set nTip = Val(Left(sTmp,1))
.head 5 +  If nMode = ACCESS_FULL_NoPrintTbl
.head 6 -  Set nFlg = CVIEW_NoPrintTbl
.head 5 +  If nMode = ACCESS_READONLY
.head 6 -  Set nFlg = CVIEW_ReadOnly | AVIEW_ReadOnly
.head 5 +  If nMode = ACCESS_READONLY_NoPrintTbl
.head 6 -  Set nFlg = CVIEW_ReadOnly | CVIEW_NoPrintTbl | AVIEW_ReadOnly
.head 5 +  If nMode = ACCESS_HOLDING
.head 6 -  Set nFlg = CVIEW_ReadOnly | AVIEW_ReadOnly | CVIEW_Holding
.head 5 +  If nMode = ACCESS_DRONLY
.head 6 -  ! Set nFlg = CVIEW_ReadOnly | AVIEW_ReadOnly | CVIEW_DROnly
.head 6 -  Set nFlg = AVIEW_ReadOnly | CVIEW_DROnly
.head 6 -  Set nTip = 1
.head 5 -  ! Доступ по клиентам
.head 5 +  If Subs(sTmp,2,1) = '1'
.head 6 -  Set nFlg = nFlg | CVIEW_Saldo
.head 5 -  ! Доступ по счетам клиентов
.head 5 +  Else If Subs(sTmp,2,1) = '2'
.head 6 -  Set nFlg = nFlg | AVIEW_Saldo
.head 5 -  ! Доступ по клиентам + Доступ по счетам клиентов
.head 5 +  Else If Subs(sTmp,2,1) = '3'
.head 6 -  Set nFlg = nFlg | CVIEW_Saldo | AVIEW_Saldo
.head 5 -  !
.head 5 +  Select Case nTip
.head 6 +  Case 2   ! Счета только
.head 7 -  Set nFlg = nFlg | CVIEW_ReadOnly | CVIEW_Accounts
.head 7 -  Break
.head 6 +  Case 3   ! Счета + контрагенты
.head 7 -  Set nFlg = nFlg | CVIEW_Accounts
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 5 -  Return nFlg
.head 3 +  Function: CloseCustomer
.head 4 -  Description: Выполнить закрытие клиента банка
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: RNK
.head 5 -  String: strName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDat
.head 5 -  Number: nActiveAcc
.head 5 -  Date/Time: dDat
.head 4 +  Actions
.head 5 -  ! If MessageQuestion('Закрыть Клиента банка: ' || strName || '?') = IDNO
.head 5 +  If MessageQuestion(CurrentLangTable.GetAtomTitle('CloseCustomer_cTQuestionClose') ||
   ': ' || strName || '?' ) = IDNO
.head 6 -  Return FALSE
.head 5 -  Set nActiveAcc = 0
.head 5 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT count(*)
     INTO :nActiveAcc
     FROM accounts a, cust_acc ca
     WHERE a.acc=ca.acc and ca.rnk=:RNK and a.dazs is null"))
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nActiveAcc
.head 6 -  ! Call SalMessageBox('У клиента в наличии ' || SalNumberToStrX(nActiveAcc, 0) ||
     ' незакрытых счетов!', 'Внимание!', MB_IconStop | MB_Ok)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CloseCustomer_cTMess11') || ' ' ||
     SalNumberToStrX(nActiveAcc, 0) || ' ' ||
     CurrentLangTable.GetAtomTitle('CloseCustomer_cTMess12') || '!',
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Set sDat = GetBankDateEx()
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT date_on
   INTO :dDat
   FROM customer
   WHERE rnk=:RNK") and SqlFetchNext(hSql(), nFetchRes) and GetBankDate() < dDat
.head 6 -  ! Call SalMessageBox('Клиент не может быть закрыт датой (' || SalFmtFormatDateTime(
     GetBankDate(), 'dd/MM/yyyy') || '), меньшей даты открытия (' ||
     SalFmtFormatDateTime(dDat, 'dd/MM/yyyy') || ')!', 'Внимание!',
     MB_IconStop | MB_Ok)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CloseCustomer_cTMess21') || ' (' ||
     SalFmtFormatDateTime(GetBankDate(), 'dd/MM/yyyy') || '), ' ||
     CurrentLangTable.GetAtomTitle('CloseCustomer_cTMess22') || ' (' ||
     SalFmtFormatDateTime(dDat, 'dd/MM/yyyy') || ')!',
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If not SqlPrepareAndExecute(hSql(), T("
   UPDATE customer
   SET date_off=" || DateInQuery(sDat) || "
   WHERE rnk=:RNK"))
.head 6 -  Return FALSE
.head 5 -  ! If not SqlCommitEx(hSql(), 'Закрыт клиент:' || Str(RNK) || ':' || strName)
.head 5 +  If not SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('CloseCustomer_cTClose') ||
   ':' || Str(RNK) || ':' || strName)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: ResurectCustomer
.head 4 -  Description: Перерегистрировать закрытого клиента
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRNK
.head 5 -  String: strName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtDateOff
.head 5 -  Date/Time: dCurrDate
.head 5 -  String: strCurrDate
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  ! If MessageQuestion('Перерегистрировать Клиента банка: ' || strName || '?') = IDNO
.head 5 +  If MessageQuestion(CurrentLangTable.GetAtomTitle('ResurectCustomer_cTQuestion') || ': '
   || strName || '?') = IDNO
.head 6 -  Return FALSE
.head 5 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT date_off
     INTO :dtDateOff
     FROM customer
     WHERE rnk=:nRNK"))
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If dtDateOff = DATETIME_Null
.head 6 -  Return FALSE
.head 5 -  Set dCurrDate = GetBankDate()
.head 5 +  If dCurrDate < dtDateOff
.head 6 -  ! Call SalMessageBox('Клиент не может быть перерегистрирован датой (' ||
     SalFmtFormatDateTime(dCurrDate, 'dd/MM/yyyy') || '), меньшей даты закрытия (' ||
     SalFmtFormatDateTime(dtDateOff, 'dd/MM/yyyy') || ')!', 'Внимание!',
     MB_IconStop | MB_Ok)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('ResurectCustomer_cTMess11') ||
     ' (' || SalFmtFormatDateTime(dCurrDate, 'dd/MM/yyyy') || '), ' ||
     CurrentLangTable.GetAtomTitle('ResurectCustomer_cTMess12') || ' (' ||
     SalFmtFormatDateTime(dtDateOff, 'dd/MM/yyyy') || ')!',
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  ! If not SqlCommitEx(hSql(), 'Перерегистрирован клиент:' || Str(nRNK) || ':' ||
   strName)
.head 5 +  If SqlPLSQLCommand( hSql(), "KL.RESURRECT_CUSTOMER( nRNK, sErrMsg )" )
.head 6 +  If ( sErrMsg = STRING_Null )
.head 7 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle( 'ResurectCustomer_cTResurect') || ':' || Str(nRNK) || ':' || strName )
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SqlRollbackEx(hSql(), sErrMsg )
.head 7 -  Call SalMessageBox( sErrMsg, CurrentLangTable.GetAtomTitle( 'cTErr' ), MB_IconStop )
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SqlRollback( hSql() )
.head 6 -  Return FALSE
.head 3 +  Function: CheckMfoNls
.head 4 -  Description: Проверка MFO & NLS
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: MFO
.head 5 -  String: NLS
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: kol
.head 4 +  Actions
.head 5 +  If MFO != STRING_Null  !! есть МФО
.head 6 -  Set kol=0
.head 6 -  Call SqlPrepareAndExecute( hSql(),
 T( "SELECT  count(*) INTO :kol FROM banks WHERE mfo = :MFO" ))
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If kol = 0 OR kol = NUMBER_Null
.head 7 -  Call Debug("Ошибочное МФО: " || MFO )
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 -  !
.head 3 -  ! ACCOUNTS - функции
.head 3 -  !
.head 3 +  Function: ShowAccountsList       ! __exported
.head 4 -  Description: Просмотр счетов банка "General"
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_ALL, AVIEW_AllOptions, '', FALSE)
.head 3 -  !
.head 3 +  Function: ShowAllAccounts        ! __exported
.head 4 -  Description: Просмотр всех счетов банка
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_ALL, AVIEW_Financial | AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Interest, '', FALSE)
.head 3 +  Function: ShowInfoAccounts       ! __exported
.head 4 -  Description: Информационный просмотр технологических счетов банка в СЭП ( для руководства банка )
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_ALL, AVIEW_Financial | AVIEW_ExistOnly | AVIEW_ReadOnly , '', FALSE)
.head 3 +  Function: ShowCustAccounts       ! __exported
.head 4 -  Description: Регистрация клиентов банка и открытие счетов
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, nRnk, AVIEW_CUST, AVIEW_Financial, '', FALSE)
.head 3 +  Function: ShowCustAccountsEx     ! __exported
.head 4 -  Description: Просмотр клиентов банка и счетов
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Return SalCreateWindow(tbl_AccountsList, hWndMDI, nRnk, AVIEW_CUST, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial, '', FALSE)
.head 3 +  Function: ShowTechAccounts       ! __exported
.head 4 -  Description: Регистрация ВСЕХ технологических счетов банка в СЭП
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_TECH, AVIEW_ExistOnly | AVIEW_Financial, '', FALSE)
.head 3 +  Function: ShowTechAccountsEx     ! __exported
.head 4 -  Description: Просмотр технологических счетов банка УЧАСТНИКА СЭП
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMfo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, nMfo, AVIEW_TECH, AVIEW_ExistOnly | AVIEW_Financial | AVIEW_ReadOnly, '', FALSE)
.head 3 +  Function: ShowUserAccounts       ! __exported
.head 4 -  Description: Просмотр всех счетов доступных пользователю
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_USER, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial | AVIEW_Interest, 
     IifS(PAR_ORGTYPE='KAZNA','#2222',''), FALSE)
.head 3 +  Function: ShowNalogAccounts      ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_TAX, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial, '', FALSE)
.head 3 +  Function: ShowLNKAccounts        ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: accc
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, accc, AVIEW_LINKED, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial, '', FALSE)
.head 3 -  !
.head 3 +  Function: ShowAccF               ! __exported
.head 4 -  Description: Табличная форма обн счетов с предустановленным фильтром
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  String: DopFiltr     ! предустановленный фильтр
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0,
AVIEW_ALL,
AVIEW_Linked |
AVIEW_Limit |
AVIEW_Financial | AVIEW_Interest |
AVIEW_Access |
AVIEW_Special, DopFiltr, FALSE)
.head 3 -  !
.head 3 +  Function: ShowAcc   		 ! __exported
.head 4 -  Description: Разные Просмотры-модификации счетов банка
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nPar
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 +  Select Case nPar
.head 6 +  Case 1   !! ShowAccountsList - Просмотр счетов банка "General"
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_ALL, AVIEW_AllOptions, '', FALSE)
.head 7 -  Break
.head 6 +  Case 2   !! ShowAllAccounts  - Просмотр ВСЕХ счетов
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_ALL, AVIEW_Financial | AVIEW_ExistOnly | AVIEW_ReadOnly, '', FALSE)
.head 7 -  Break
.head 6 +  Case 3   !! ShowUserAccounts - Просмотр всех счетов доступных пользователю
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_USER, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial | AVIEW_Interest, '', FALSE)
.head 7 -  Break
.head 6 +  Case 4   !! ShowNalogAccounts- Просмотр счетов налогового учета
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_TAX, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial, '', FALSE)
.head 7 -  Break
.head 6 +  Case 5   !! ShowTechAccounts - Просмотр ВСЕХ технологических счетов банка в СЭП
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_TECH, AVIEW_ExistOnly | AVIEW_ReadOnly | AVIEW_Financial, '', FALSE)
.head 7 -  Break
.head 6 +  Case 6   !! ShowInfoAccounts - Информационный просмотр технологических счетов банка в СЭП ( для руководства банка )
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_ALL, AVIEW_Financial | AVIEW_ExistOnly | AVIEW_ReadOnly, '', FALSE)
.head 7 -  Break
.head 6 +  Case 7   !! ShowAccountsList - Просмотр/редактирование лимитов счетов 
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_USER, AVIEW_Limit | AVIEW_ExistOnly | AVIEW_NoEdit | AVIEW_NoClose | AVIEW_NoOpen, '', FALSE)
.head 7 -  Break
.head 6 +  Case 8   !! ShowAccountsList - Просмотр/редактирование блокировок счетов 
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0, AVIEW_USER, AVIEW_Blocked | AVIEW_ExistOnly | AVIEW_NoEdit | AVIEW_NoClose | AVIEW_NoOpen, '', FALSE)
.head 7 -  Break
.head 6 +  ! Case 11    !! Полный доступ с предустановленным фильтром
.head 7 -                Break 
.head 6 +  Default
.head 7 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, 0,
AVIEW_ALL,
AVIEW_Linked |
AVIEW_Limit |
AVIEW_Financial | AVIEW_Interest |
AVIEW_Access |
AVIEW_Special, '', FALSE)
.head 3 +  Function: ShowAccList         	 ! __exported
.head 4 -  Description: Универсальные Просмотры-модификации счетов банка
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nAccType
.head 5 -  Number: nAccFlags
.head 5 -  String: strAccFilter
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNlsSN   ! номер счета начисленных % для двух ид через запятую
.head 5 -  String: sNlsSD   ! номер счета дох/расх для двух ид через запятую
.head 5 -  String: sNlsSN0   ! номер счета начисленных %
.head 5 -  String: sNlsSD0   ! номер счета дох/расх
.head 5 -  String: sNlsSN2   ! номер счета начисленных %
.head 5 -  String: sNlsSD2   ! номер счета дох/расх
.head 5 -  Number: i
.head 5 -  Number: n
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 +  If nId = -1
.head 6 -  Set sNlsSN0 = ''
.head 6 -  Set sNlsSD0 = ''
.head 6 -  Set sNlsSN2 = ''
.head 6 -  Set sNlsSD2 = ''
.head 6 +  If strAccFilter
.head 7 -  Set i = SalStrScan(strAccFilter, '|')
.head 7 -  Set sNlsSN = Subs(strAccFilter, 1, i)
.head 7 -  Set sNlsSD = Subs(strAccFilter, i+2, Len(strAccFilter)-i-1)
.head 7 -  ! Умолчательній счет нач % для двух ид
.head 7 +  If sNlsSN != STRING_Null
.head 8 -  Set i=1
.head 8 -  Set n = SalStrLength( sNlsSN )
.head 8 +  While i <= n
.head 9 +  If Subs(sNlsSN,i,1)=','
.head 10 -  Set sNlsSN0 = Subs(sNlsSN, 1, i-1 )
.head 10 -  Set sNlsSN2 = Subs(sNlsSN, i+1, n-i )
.head 10 -  Break
.head 9 -  Set i=i+1
.head 8 +  If i > n
.head 9 -  Set sNlsSN0 = sNlsSN
.head 9 -  Set sNlsSN2 = STRING_Null
.head 7 +  Else
.head 8 -  Set sNlsSN0 = STRING_Null
.head 8 -  Set sNlsSN2 = STRING_Null
.head 7 -  ! Умолчательній счет доходов для двух ид
.head 7 +  If sNlsSD != STRING_Null
.head 8 -  Set i=1
.head 8 -  Set n = SalStrLength( sNlsSD )
.head 8 +  While i <= n
.head 9 +  If Subs(sNlsSD,i,1)=','
.head 10 -  Set sNlsSD0 = Subs(sNlsSD, 1, i-1 )
.head 10 -  Set sNlsSD2 = Subs(sNlsSD, i+1, n-i )
.head 10 -  Break
.head 9 -  Set i=i+1
.head 8 +  If i > n
.head 9 -  Set sNlsSD0 = sNlsSD
.head 9 -  Set sNlsSD2 = STRING_Null
.head 7 +  Else
.head 8 -  Set sNlsSD0 = STRING_Null
.head 8 -  Set sNlsSD2 = STRING_Null
.head 6 -  Return SalModalDialog(dlg_ProcAccounts, hWndForm, nAccType, nAccFlags, sNlsSN0, sNlsSD0, sNlsSN2, sNlsSD2)
.head 5 +  Else
.head 6 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, nId, nAccType, nAccFlags, strAccFilter, FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: ShowAccListNN        	 ! __exported
.head 4 -  Description: Универсальные Просмотры-модификации счетов банка
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nAccType
.head 5 -  Number: nAccFlags
.head 5 -  String: strAccFilter
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_AccountsList, hWndMDI, nId, nAccType, nAccFlags, strAccFilter, bNN)
.head 3 +  Function: ShowAccSpecParams	 ! __exported
.head 4 -  Description: Просмотр спецпараметров счета
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  Number: nAccessMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 +  If nAcc > 0
.head 6 +  If not IsWindow(h_Frm_SP)
.head 7 -  ! Set h_Frm_SP = SalCreateWindow(Frm_Account, hWndForm, 0, nAcc, 0, nAccessMode, hWndForm, 3 )
.head 7 -  Set h_Frm_SP = SalCreateWindow(Frm_Account, hWndForm, 0, nAcc, 0, nAccessMode, hWndForm, '0002000', FALSE)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop(Frm_Account)
.head 3 +  Function: ShowAccSpecParamsEx	 ! __exported
.head 4 -  Description: Просмотр спецпараметров счета
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  Number: nAccessMode
.head 5 -  Window Handle: hWndParent
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 +  If nAcc > 0
.head 6 +  If not IsWindow(h_Frm_SP)
.head 7 -  ! Set h_Frm_SP = SalCreateWindow(Frm_Account, hWndForm, 0, nAcc, 0, nAccessMode, hWndParent, 3 )
.head 7 -  Set h_Frm_SP = SalCreateWindow(Frm_Account, hWndForm, 0, nAcc, 0, nAccessMode, hWndParent, '0002000', FALSE)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop(Frm_Account)
.head 3 -  ! Просмотр счетов филиала (by Ivan)
.head 3 +  Function: ShowBranchAcc          ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hParent
.head 5 -  Boolean: fEditable
.head 5 -  String: strMfo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: nNewWin
.head 5 -  Number: nOpts
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 +  If fEditable
.head 6 -  Set nOpts=AVIEW_ExistOnly
.head 5 +  Else
.head 6 -  Set nOpts=AVIEW_ReadOnly
.head 5 -  Set nOpts=nOpts | AVIEW_AllOptions
.head 5 -  Set nNewWin=SalCreateWindow(tbl_AccountsList, hParent, 0,  AVIEW_ALL, nOpts, 
                            " A.ACC IN (SELECT ACC FROM BANK_ACC WHERE MFO='" || strMfo || "') ", FALSE)
.head 5 -  Call SalSetWindowText( nNewWin, 'Счета филиала ' || strMfo )
.head 3 -  !
.head 3 +  Function: ShowTurnForAccount     ! __exported
.head 4 -  Description: Показать обороты по счету
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  String: sDat
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow( tbl_AccTurn4Day, hWndMDI, nAcc, '', NUMBER_Null, sDat )
.head 3 +  Function: ShowTurnForAccountHist ! __exported
.head 4 -  Description: Показать обороты по счету
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  String: sDat
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow( tbl_AccTurn4Day, hWndMDI, nAcc, sNls, nKv, sDat )
.head 3 +  Function: Show_Sal_Day           ! __exported
.head 4 -  Description: Показать сальдовку по счету с НЕустановленным интервалом дат
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow( tbl_Acc_Sal_Day, hWndMDI,nAcc,'',0,DATETIME_Null,DATETIME_Null )
.head 3 +  Function: Show_Sal_DayHist       ! __exported
.head 4 -  Description: Показать сальдовку по счету с НЕустановленным интервалом дат
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow( tbl_Acc_Sal_Day, hWndMDI,nAcc,sNls,nKv,DATETIME_Null,DATETIME_Null )
.head 3 +  Function: Show_Sal_Day_P         ! __exported
.head 4 -  Description: Показать сальдовку по счету с установленным интервалом дат
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  Date/Time: Pdat11
.head 5 -  Date/Time: Pdat22
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow( tbl_Acc_Sal_Day,hWndMDI,nAcc,sNls,nKv,Pdat11,Pdat22 )
.head 3 -  !
.head 3 +  Function: ShowRefPsEx            ! __exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nK014
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNls
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalModalDialog(dlg_RefPsEx, hWndForm, nK014, sNls)
.head 5 -  Return sNls
.head 3 +  Function: OperWithAccount        ! __exported
.head 4 -  Description: Операции со счетами - Открыть счет/Закрыть счет/Просмотр счета и тд.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAccMode
.head 5 -  Number: nAcc
.head 5 -  Number: nRnk
.head 5 -  Number: nAccessMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  ! Call SalCreateWindow(Frm_Account, hWndMDI, nAccMode, nAcc, nRnk, nAccessMode, hWndMDI, 0 )
.head 5 -  ! ??? ''/'2222222' ???
.head 5 -  Call SalCreateWindow(Frm_Account, hWndMDI, nAccMode, nAcc, nRnk, nAccessMode, hWndMDI, '', FALSE)
.head 3 +  Function: OperWithAccountEx      ! __exported
.head 4 -  Description: Операции со счетами - Открыть счет/Закрыть счет/Просмотр счета и тд.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAccMode
.head 5 -  Number: nAcc
.head 5 -  Number: nRnk
.head 5 -  Number: nAccessMode
.head 5 -  Window Handle: hWndParent
.head 5 -  ! Number: nPar
.head 5 -  String: sFilterOnTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(Frm_Account, hWndMDI, nAccMode, nAcc, nRnk, nAccessMode, hWndParent, sFilterOnTab, FALSE)
.head 3 +  Function: OperWithAccountNN      ! __exported
.head 4 -  Description: Операции со счетами - Открыть счет/Закрыть счет/Просмотр счета и тд.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAccMode
.head 5 -  Number: nAcc
.head 5 -  Number: nRnk
.head 5 -  Number: nAccessMode
.head 5 -  Window Handle: hWndParent
.head 5 -  ! Number: nPar
.head 5 -  String: sFilterOnTab
.head 5 -  Boolean: bNN
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(Frm_Account, hWndMDI, nAccMode, nAcc, nRnk, nAccessMode, hWndParent, sFilterOnTab, bNN)
.head 3 -  !
.head 3 +  Function: CloseAccount           ! __exported
.head 4 -  Description: Закрыть счет
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nAcrD
.head 5 -  Number: nAcrK
.head 5 -  String: sKV
.head 5 -  String: sNLS
.head 5 -  String: sNLSN
.head 5 -  String: sStr
.head 5 -  Date/Time: DAZS
.head 5 -  Date/Time: DAPP
.head 5 -  Date/Time: DAOS
.head 5 -  Number: nVid
.head 5 -  Number: S1
.head 5 -  Number: S2
.head 5 -  Number: S3
.head 5 -  Boolean: bFL
.head 5 -  Boolean: bFLEIntc
.head 5 -  Date/Time: dDat
.head 5 -  Date/Time: dAcrDat
.head 5 -  Date/Time: dStpDat
.head 5 -  String: sDat
.head 5 -  Boolean: bAccCloseReason
.head 5 -  String: sPK
.head 5 -  String: sSem
.head 5 -  Number: nCount
.head 5 -  Boolean: bCloseAccN
.head 5 -  !
.head 5 -  Number: hBtnOperType3
.head 5 -  Number: hBtnOperType5
.head 5 -  Number: hBtns[*]
.head 5 -  Number: nOperType
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set dDat  = GetBankDate()
.head 5 -  Set sDat  = GetBankDateEx()
.head 5 -  Set sNLSN = ''
.head 5 -  Set bFL   = FALSE
.head 5 -  Set bFLEIntc = FALSE
.head 5 -  Set bCloseAccN = TRUE
.head 5 -  ! Счет
.head 5 -  Set sStr = CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' '
.head 5 +  Loop
.head 6 +  If not SqlPrepareAndExecute(hSql(), T(
"SELECT a.ostc, a.ostb, a.ostf, a.dapp, a.dazs, a.daos, a.kv, a.NLS, a.vid
   INTO :S1, :S2, :S3, :DAPP, :DAZS, :DAOS, :sKV, :sNLS, :nVid
   FROM accounts a 
  WHERE a.acc=:nAcc"))
or not SqlFetchNext(hSql(), nTmp)
.head 7 -  ! не найден !
.head 7 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotFound')
.head 7 -  Break
.head 6 +  Else
.head 7 -  Set sStr = sStr || sNLS || "(" || sKV || "): "
.head 7 +  If S1 != 0
.head 8 -  ! ненулевой остаток(Ф) !
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotNullF')
.head 8 -  Break
.head 7 +  If S2 != 0
.head 8 -  ! ненулевой остаток(П) !
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotNullP')
.head 8 -  Break
.head 7 +  If S3 != 0
.head 8 -  ! ненулевой остаток(Б) !
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotNullB')
.head 8 -  Break
.head 7 +  If DAPP = dDat
.head 8 -  ! имеет обороты !
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccOb')
.head 8 -  Break
.head 7 +  If DAZS != DATETIME_Null
.head 8 -  ! уже закрыт !
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccClose')
.head 8 -  Break
.head 7 +  If DAOS >  dDat
.head 8 -  ! нельзя закрыть датой, меньшей даты открытия (DAOS)
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccDat1') || " (" || SalFmtFormatDateTime(DAOS, 'dd/MM/yyyy') || ")"
.head 8 -  Break
.head 7 +  If DAPP >= dDat
.head 8 -  ! нельзя закрыть датой, меньшей даты последнего движения по счету (DAOS)
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccDat2') || " (" || SalFmtFormatDateTime(DAOS, 'dd/MM/yyyy') || ")"
.head 8 -  Break
.head 7 -  ! Счет нач. %%
.head 7 +  If not SqlPrepareAndExecute(hSqlAux(),
"SELECT i.acra, i.acr_dat, i.stp_dat, a.ostc, a.ostb, a.ostf, a.dapp, a.nls
   INTO :nAcrK, :dAcrDat, :dStpDat, :S1, :S2, :S3, :DAPP, :sNLSN
   FROM accounts a, int_accn i
  WHERE i.acra = a.acc AND a.dazs is NULL and i.acc=:nAcc AND i.acra<>:nAcc")
.head 8 -  ! Ошибка поиска счетов начисления %%!
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNErr')
.head 8 -  Break
.head 7 +  While SqlFetchNext(hSqlAux(), nTmp)
.head 8 -  ! Счет начисления %% sNLSN
.head 8 -  Set sStr = CurrentLangTable.GetAtomTitle('CloseAcc_cTAccN') || " " || sNLSN || ": "
.head 8 +  If S1 != 0
.head 9 -  ! ненулевой остаток(Ф) !
.head 9 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotNullF')
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If S2 != 0
.head 9 -  ! ненулевой остаток(П) !
.head 9 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotNullP')
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If S3 != 0
.head 9 -  ! ненулевой остаток(Б) !
.head 9 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNotNullB')
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If DAPP = dDat
.head 9 -  ! имеет обороты !
.head 9 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccOb')
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If (( dStpDat = DATETIME_Null and dDat > dAcrDat ) 
     or ( dStpDat != DATETIME_Null and dStpDat > dAcrDat ))
.head 9 -  ! недоначислены %% ! Продолжать закрытие счета?
.head 9 +  If SalMessageBox(sStr || 
   CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNNotP') || ' ' ||
   CurrentLangTable.GetAtomTitle('CloseAcc_cTAccDone'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDNO
.head 10 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNNotP')
.head 10 -  Set bCloseAccN = FALSE
.head 10 -  Break
.head 8 +  Else If DAPP > dAcrDat
.head 9 -  ! Счет начисления %% sNLSN может еще быть задействован! Продолжать закрытие счета?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('CloseAcc_cTAccN') || ' ' || sNLSN || ' ' ||
   CurrentLangTable.GetAtomTitle('CloseAcc_cTAccN1') || ' ' ||
   CurrentLangTable.GetAtomTitle('CloseAcc_cTAccDone'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDNO
.head 10 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccN')
.head 10 -  Set bCloseAccN = FALSE
.head 10 -  Break
.head 8 +  If SqlPrepareAndExecute(hSql(), "select count(*) into :nCount from int_accn where acra = :nAcrK")
and SqlFetchNext(hSql(), nFetchRes) and nCount > 1
.head 9 -  ! используется для нескольких счетов. закрыть?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('CloseAcc_cTAccN') || ' ' || sNLSN || ' ' ||
   CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNUsed') || ' ' || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccQ'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDNO
.head 10 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccNUsed')
.head 10 -  Set bCloseAccN = FALSE
.head 8 -  !
.head 8 +  If bCloseAccN
.head 9 +  If NOT SqlPrepareAndExecute(hSql(), "UPDATE accounts SET dazs=" || DateInQuery( sDat ) || " WHERE acc=:nAcrK")
.head 10 -  ! Закрыть невозможно
.head 10 -  Set sStr = sStr || " " || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccErr') || " "
.head 10 -  Set bFLEIntc = TRUE
.head 9 +  If NOT SqlPrepareAndExecute(hSql(), "UPDATE int_accn SET stp_dat=" || DateInQuery( sDat ) || ",
       acr_dat=" || DateInQuery(sDat) || " WHERE acc=:nAcc AND acra=:nAcrK")
.head 10 -  ! Закрыть невозможно 
.head 10 -  Set sStr = sStr || " " || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccErr') || " "
.head 10 -  Set bFLEIntc = TRUE
.head 7 +  If bFLEIntc
.head 8 -  Break
.head 7 -  !
.head 7 -  ! Счет sNLS (sKV): закрыть?
.head 7 -  Set sStr = CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' ' || sNLS || "(" || sKV || "): " ||
    IifS(bCloseAccN=TRUE and sNLSN, PutCrLf() || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccN') || " " || sNLSN || ": " || PutCrLf(), "")
.head 7 +  If SalMessageBox(sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccQ'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  ! Выбираем причину закрытия счета
.head 8 -  Set bAccCloseReason = Val(GetValueStr("SELECT COUNT(*) FROM ALL_TABLES WHERE TABLE_NAME='ACC_CLOSEREASONS'"))
.head 8 +  If bAccCloseReason
.head 9 -  ! Выбираем причину закрытия счета
.head 9 +  If not FunNSIGet("acc_closereasons", "name", sPK, sSem)
.head 10 -  Set sStr = ''
.head 10 -  Break
.head 9 -  ! Сохранение причины закрытия счета
.head 9 +  If not SqlPrepareAndExecute(hSql(), "insert into accountsw(acc, tag, value) values(:nAcc, 'RCLOS', :sPK)")
.head 10 -  ! не закрывается.
.head 10 -  Set sStr = sStr || " " || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccErr2')
.head 10 -  Break
.head 9 +  If bCloseAccN and sNLSN
.head 10 +  If not SqlPrepareAndExecute(hSql(), "insert into accountsw(acc, tag, value) values(:nAcrK, 'RCLOS', :sPK)")
.head 11 -  ! не закрывается.
.head 11 -  Set sStr = sStr || " " || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccErr2')
.head 11 -  Set bFLEIntc = TRUE
.head 11 -  Break
.head 8 -  !
.head 8 +  If nVid
.head 9 -  Call VisMessageSetBkgdColor(COLOR_LightGray)
.head 9 -  Set hBtnOperType3 = VisMessageLoadButton('За ініциативою клієнта', 3)
.head 9 -  Set hBtnOperType5 = VisMessageLoadButton('Не за ініціативою клієнта', 5)
.head 9 -  Set hBtns[0] = hBtnOperType3
.head 9 -  Set hBtns[1] = hBtnOperType5
.head 9 -  Set nOperType = VisMessageBox('Виберіть тип операції закриття (для ДПА):', 'Вибір...', MBF_IconQuestion, hBtns, 2)
.head 9 -  Call VisMessageFreeButton(hBtnOperType3)
.head 9 -  Call VisMessageFreeButton(hBtnOperType5)
.head 9 +  If not SqlPLSQLCommand(hSql(), "accreg.setAccountwParam(nAcc, 'DPAOTYPE', '" || Str(nOperType) || "')")
.head 10 -  Set sStr = sStr || " неможливо вказати тип операції закриття для ДПА"
.head 10 -  Break
.head 8 +  If SqlPrepareAndExecute(hSql(), "UPDATE accounts SET dazs=" || DateInQuery(sDat) || " WHERE acc=:nAcc")
.head 9 -  ! закрыт
.head 9 -  Set sStr = sStr || " " || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccIsClose') || " "
.head 9 -  Set bFL  = TRUE
.head 8 +  Else
.head 9 -  ! Закрыть невозможно
.head 9 -  Set sStr = sStr || " " || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccErr') || " "
.head 7 +  Else
.head 8 -  ! не закрывается.
.head 8 -  Set sStr = sStr || CurrentLangTable.GetAtomTitle('CloseAcc_cTAccErr2')
.head 7 -  Break
.head 5 +  If not bFL
.head 6 +  If sStr
.head 7 -  Call SqlRollbackEx(hSql(), sStr)
.head 7 -  Call MessageError(sStr)
.head 5 +  Else
.head 6 -  Call SqlCommitEx(hSql(), sStr)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return bFL
.head 3 +  Function: ShowParHistory	 ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode	! 1- nPar=Acc, 2- nPar=Rnk
.head 5 -  Number: nPar
.head 5 -  String: sPar
.head 5 -  String: sFilter
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ShowCustAcc_Init( )
.head 5 -  Call SalCreateWindow(tbl_ParHistory, hWndParent, nMode, nPar, '', 0, DATETIME_Null, DATETIME_Null, sPar, sFilter)
.head 3 -  !
.head 3 +  Function: CheckOkpo
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nCusttype
.head 5 -  String: sOkpo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRet
.head 4 +  Actions
.head 5 +  If nCusttype = 3
.head 6 +  If sOkpo != STRING_Null and sOkpo != '0000000000'
.head 7 -  ! ФО резидент - 10 цифр, які перевіряються по даті народження.
.head 7 -  ! Якщо ідентифікаційного коду немає, то для введення допускається тільки значення "0000000000" (десять нулів)
.head 7 +  If SalStrLength(sOkpo) < 10
.head 8 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 8 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 7 -  ! унеможливити введення в поле ІПН 10 однакових цифр, окрім десяти „0" для ФО-резидентів
.head 7 +  If Subs(sOkpo,1,1) = Subs(sOkpo,2,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,3,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,4,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,5,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,6,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,7,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,8,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,9,1) and
   Subs(sOkpo,1,1) = Subs(sOkpo,10,1)
.head 8 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 8 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 5 +  Else If nCusttype = 2
.head 6 -  ! ЮО резидент - 8 цифр. Має проводитись контроль достовірності коду шляхом розрахунку контрольного розряду.
.head 6 -  ! Якщо ідентифікаційного коду немає, то для введення допускається тільки значення "000000000" (дев'ять нулів)
.head 6 +  If SalStrLength(sOkpo) != 8 and sOkpo != '000000000'
.head 7 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 6 -  ! проверка ОКПО на контрольный разряд
.head 6 +  ! If SalStrLength(sOkpo) = 8
.head 7 +  If sOkpo != V_Okpo(sOkpo)
.head 8 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 8 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 5 -  !
.head 5 -  ! НОВАЯ проверка ОКПО на контрольный разряд
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT F_VALIDOKPO(:sOkpo)
   INTO   :nRet
   FROM   dual") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nRet != 0
.head 7 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 6 +  Else
.head 7 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 6 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 5 -  !
.head 5 -  ! Return TRUE
.head 3 +  Function: CheckPersonOkpo
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sOkpo
.head 5 -  Date/Time: dBirthday
.head 5 -  String: sSex
.head 5 -  Receive String: sMsg
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sOkpo != STRING_Null and sOkpo != '0000000000'
.head 6 +  If dBirthday != DATETIME_Null
.head 7 +  If SalFmtFormatStrDateTime('31/12/1899', 'dd/MM/yyyy') + Val(Subs(sOkpo,1,5)) != dBirthday
.head 8 -  ! Код ОКПО не соответствует дате рождения клиента!
.head 8 -  Set sMsg = CurrentLangTable.GetAtomTitle('CheckPersonOkpo.cTOkpoBirthday')
.head 8 -  Return FALSE
.head 6 +  If sSex != STRING_Null and Len(sOkpo) > 8
.head 7 +  If SalNumberMod(Val(Subs(sOkpo,9,1)), 2) != SalNumberMod(Val(sSex), 2)
.head 8 -  ! Код ОКПО не соответствует полу клиента!
.head 8 -  Set sMsg = CurrentLangTable.GetAtomTitle('CheckPersonOkpo.cTOkpoSex')
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: CheckPersonOkpoPassp
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: bSpd
.head 5 -  String: sOkpo
.head 5 -  Number: nPasspId
.head 5 -  String: sPasspSer
.head 5 -  String: sPasspNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRnk
.head 4 +  Actions
.head 5 +  If sOkpo != STRING_Null and sOkpo != '0000000000'
.head 6 -  Call SqlPrepareAndExecute(hSql(),
"select max(c.rnk) into :nRnk
   from customer c, person p
  where c.rnk = p.rnk
    and c.okpo = :sOkpo
    and p.passp = :nPasspId
    and p.ser = :sPasspSer
    and p.numdoc = :sPasspNum 
    and nvl(trim(c.sed), '00') " || IifS(bSpd=TRUE, "=", "<>") || "'91'")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nRnk
.head 7 -  ! Клієнт з такими даними вже зареєстрований з РНК nRnk!
! Змініть введені дані або скористайтесь відкритою карткою клієнта!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CheckOkpoPassp.cTMsg1') || ' ' || Str(nRnk) || ' !' || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('CheckOkpoPassp.cTMsg2'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: CheckFio
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sFio
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: nValue
.head 4 +  Actions
.head 5 -  Set i = 1
.head 5 +  While i <= Len(sFio)
.head 6 -  Set nValue = Asc(SalStrUpperX(Subs(sFio, i, 1)))
.head 6 -  ! при введенні ПІБ ФО окрім літер латиниці та кирилиці допускаються лише символи „-„ та „'„
.head 6 +  If nValue = 39 or nValue = 45
or (nValue >= 65 and nValue <= 90)
or (nValue >= 192 and nValue <= 223)
or nValue = 165 or nValue = 168 or nValue = 170 or nValue = 175 or nValue = 178
.head 7 -  ! good
.head 6 +  Else
.head 7 -  Return FALSE
.head 6 -  Set i = i + 1
.head 5 -  Return TRUE
.head 3 +  Function: CheckPasspSer
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nDocId
.head 5 -  String: sSer
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nDocId = 1
.head 6 +  If sSer != ''
.head 7 +  If Len(sSer) != 2
.head 8 -  ! Серия паспорта должна содержать 2 символа!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrSer'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: CheckPasspNum
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nDocId
.head 5 -  String: sNumDoc
.head 5 -  Window Handle: hNumDoc
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nDocId = 1
.head 6 +  If sNumDoc != ''
.head 7 +  If Len(sNumDoc) != 6
.head 8 -  ! Номер паспорта должен содержать 6 цифр!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrNumDoc'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 7 +  If not SalIsValidNumber(hNumDoc)
.head 8 -  ! Номер паспорта: должно быть число!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgNumDoc') || ' ' ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrNumber'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: smsPIN
.head 4 -  Description: Функция, вызывающая диалог смс-отсправки кода подтверждения при регистрации/обновлении клиента
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: RNK
.head 5 -  String: CellNumber
.head 5 -  Number: PIN
.head 5 -  Number: res
.head 5 -  String: pmsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCellphone_Confirmation
.head 4 +  Actions
.head 5 -  ! Вызвать окно Dlg_PhonePIN
.head 5 -  ! If 
.head 5 -  Call SqlPrepareAndExecute( hSql(), "SELECT to_number(value) INTO :nCellphone_Confirmation FROM cac_params WHERE name='CELLPHONE_CONFIRMATION'")
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If nCellphone_Confirmation = 1
.head 6 +  If SalModalDialog(Dlg_PhonePIN, hWndForm, RNK, CellNumber, PIN, res, pmsg) = 0
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 2776239410
0000: BA0200005F010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F01008041 0000000200000000
00C0: 0D63526164696F00 4C697374426F7886 9000000005000067 010D00FFFFC90D00
00E0: 0001FD00FF071A00 000001F700FF1F27 0000DC000100FF7F 34700000000100FF
0100: FF21018011000003 0000000010416273 7400726163744375 7374006F6D657238
0120: 000000F60200EC01 0D00FFBF0DA10003 040000FFFF800180 2B0000000461000F
0140: 416272074163636F 75806E746C000000 043D00010DFB00FF 6F0D00EE0300FFBF
0160: 11B9000100FFFFE0 1E00000001FE00FF 03
.enddata
.head 3 +  Pushbutton Class: cpbOkLabeled
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:  
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Автоназываемая кнопка
.head 4 +  Derived From
.head 5 -  Class: cpbOk
.head 5 -  Class: cAutoLabeledWindow
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: cpbCancelLabeled
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:  
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Автоназываемая кнопка
.head 4 +  Derived From
.head 5 -  Class: cpbCancel
.head 5 -  Class: cAutoLabeledWindow
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: cpbRefreshLabeled
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:  
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Автоназываемая кнопка
.head 4 +  Derived From
.head 5 -  Class: cAutoLabeledWindow
.head 5 -  Class: cpbRefresh
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Functional Class: cGenFilterAcc
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cGenDFilterEx
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: GetFilterWhereClause
.head 6 -  Description: Получить часть запроса where из заданого фильтра
.head 6 +  Returns
.head 7 -  Long String:
.head 6 +  Parameters
.head 7 -  Date/Time: dDat1
.head 7 -  Date/Time: dDat2
.head 7 -  Boolean: fStandAlone
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Long String: sWhere
.head 7 -  String: sFilterTmp
.head 7 -  Number: nFilterScan
.head 7 -  Long String: sTmpWhere
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Set sWhere = cNewFilter.getWhere(sFTabAlias)
.head 7 -  Set sTmpWhere = cSimpleFilter.getWhere()
.head 7 +  If sTmpWhere
.head 8 -  Set sWhere = IifS(sWhere='', '',  sWhere || ' AND (') || sTmpWhere || IifS(sWhere='', '', ')')
.head 7 +  If not fStandAlone
.head 8 -  Set sTmpWhere = cSysFilter.getWhere(sFTabAlias)
.head 8 +  If sTmpWhere
.head 9 -  Set sWhere = IifS(sWhere='', '',  sWhere || ' AND (') || sTmpWhere || IifS(sWhere='', '', ')')
.head 8 -  Set sTmpWhere = cUserFilter.getWhere(sFTabAlias)
.head 8 +  If sTmpWhere
.head 9 -  Set sWhere = IifS(sWhere='', '',  sWhere || ' AND (') || sTmpWhere || IifS(sWhere='', '', ')')
.head 7 -  !
.head 7 -  ! If dDat1 != dGlobalBankDate or dDat2 != dGlobalBankDate
.head 7 -  Set sFilterTmp = sWhere
.head 7 -  Set nFilterScan = SalStrScan(sFilterTmp, SalStrUpperX('A.DOS'))
.head 7 +  While nFilterScan != -1
.head 8 -  Set sFilterTmp = SalStrReplaceX(sFilterTmp, nFilterScan, 5, 'fdos(a.acc,:dDat1,:dDat2)')
.head 8 -  Set nFilterScan = SalStrScan(sFilterTmp, SalStrUpperX('A.DOS'))
.head 7 -  Set nFilterScan = SalStrScan(sFilterTmp, SalStrUpperX('A.KOS'))
.head 7 +  While nFilterScan != -1
.head 8 -  Set sFilterTmp = SalStrReplaceX(sFilterTmp, nFilterScan, 5, 'fkos(a.acc,:dDat1,:dDat2)')
.head 8 -  Set nFilterScan = SalStrScan(sFilterTmp, SalStrUpperX('A.KOS'))
.head 7 -  Set nFilterScan = SalStrScan(sFilterTmp, SalStrUpperX('A.OSTC'))
.head 7 +  While nFilterScan != -1
.head 8 -  Set sFilterTmp = SalStrReplaceX(sFilterTmp, nFilterScan, 6, 'fost_h(a.acc,:dDat2)')
.head 8 -  Set nFilterScan = SalStrScan(sFilterTmp, SalStrUpperX('A.OSTC'))
.head 7 -  Set sWhere = sFilterTmp
.head 7 -  !
.head 7 -  Return sWhere
.head 3 +  Functional Class: cGenQueryAcc
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cGenQuery
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: GetFullSQLString
.head 6 -  Description: получить полную строку запроса
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  : F
.head 8 -  Class: cGenFilterAcc
.head 7 -  Date/Time: dDat1
.head 7 -  Date/Time: dDat2
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sQuery
.head 7 -  String: sNewFrom
.head 7 -  String: sNewWhere
.head 7 -  Number: nFilterScan
.head 6 +  Actions
.head 7 -  Set sNewWhere = F.GetFilterWhereClause(dDat1, dDat2, FILTER_Complex)
.head 7 -  Set sNewFrom = F.GetFilterFromClause( FILTER_Complex )
.head 7 +  If sNewWhere != ''
.head 8 +  If sWhereClause != ''
.head 9 -  Set sNewWhere = sWhereClause || ' AND ' || sNewWhere 
.head 7 +  Else
.head 8 -  Set sNewWhere = sWhereClause
.head 7 -  Call F.MergeFromClause ( sNewFrom, sTableList)
.head 7 -  !
.head 7 -  Set sQuery = sAction
.head 7 +  If sAction = 'SELECT'
.head 8 -  Set sQuery = sQuery || ' ' || sColumnList 
.head 8 +  If sBindList != ''
.head 9 -  Set sQuery = sQuery || ' INTO ' || sBindList
.head 8 -  Set sQuery = sQuery || ' FROM ' || sNewFrom
.head 8 +  If sNewWhere != ''
.head 9 -  Set sQuery = sQuery || ' WHERE ' || sNewWhere
.head 8 +  If sGroupClause != ''
.head 9 -  Set sQuery = sQuery || ' GROUP BY ' || sGroupClause
.head 8 +  If sOrderClause != ''
.head 9 -  Set sQuery = sQuery || ' ORDER BY ' || sOrderClause
.head 7 +  Else If sAction = 'UPDATE'
.head 8 -  Set sQuery = sQuery || ' ' || sTableList || ' SET ' ||
sBindList
.head 8 +  If sWhereClause != ''
.head 9 -  Set sQuery = sQuery || ' WHERE ' || sNewWhere
.head 7 +  Else If sAction = 'INSERT'
.head 8 -  Set sQuery = sQuery || ' INTO ' || sTableList ||
' (' || sColumnList || ') VALUES (' || sBindList || ')'
.head 7 +  Else If sAction = 'DELETE'
.head 8 -  Set sQuery = sQuery || ' FROM ' || sTableList
.head 8 +  If sWhereClause != ''
.head 9 -  Set sQuery = sQuery || ' WHERE ' || sNewWhere
.head 7 +  Else
.head 8 -  Set sQuery = ''
.head 7 -  Return sQuery
.head 3 +  Functional Class: cNNCardTools
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nToolId
.head 5 -  Number: nToolAcsId
.head 5 -  Number: nToolTypeId
.head 5 -  String: sToolTypeName
.head 5 -  Date/Time: dToolEnter
.head 5 -  Date/Time: dToolExpire
.head 5 -  Number: nLoadAccId
.head 5 -  String: sLoadAccNls
.head 5 -  String: sLoadAccNms
.head 5 -  Number: nLimitId
.head 5 -  String: sLimitNum
.head 5 -  String: sLimitName
.head 5 -  String: sToolAccNls
.head 5 -  String: sToolAccNms
.head 5 -  String: sChgType
.head 5 -  Date/Time: dChgDate
.head 4 -  Functions
.head 3 +  Functional Class: cNNCard
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCardTypeId
.head 5 -  String: sCardTypeName
.head 5 -  Number: nCardId
.head 5 -  Number: nCardIdOld
.head 5 -  Number: nCardAcsId
.head 5 -  Number: nCardPoolNo
.head 5 -  String: sCardStatus
.head 5 -  Date/Time: dCardExpered
.head 5 -  Date/Time: dCardIssuer
.head 5 -  String: sCardStopStatus
.head 5 -  String: sCardComment
.head 5 -  String: sClosed
.head 5 -  String: sChgType
.head 5 -  Date/Time: dChgDate
.head 5 -  String: sCardQuestion
.head 5 -  String: sCardAnswer
.head 5 -  Boolean: bInserted
.head 5 -  Boolean: bDeleted
.head 5 -  Boolean: bChanged
.head 5 -  Boolean: bChangeComment
.head 5 -  Boolean: bChangeKeyPhrase
.head 5 -  Boolean: bChangeTools
.head 5 -  : ToolsList[*]
.head 6 -  Class: cNNCardTools
.head 5 -  Number: nToolsListNum
.head 4 -  Functions
.head 3 +  Functional Class: cNNCardList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRnk
.head 5 -  Boolean: bArc
.head 5 -  Number: nListNum
.head 5 -  : CardList[*]
.head 6 -  Class: cNNCard
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nParRnk
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRnk = nParRnk
.head 7 -  Set bArc = FALSE
.head 7 -  Set nListNum = 0
.head 7 -  Return TRUE
.head 5 +  Function: SetCardArc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bParArc
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bArc = bParArc
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  !
.head 7 -  Number: nCardId
.head 7 -  Number: nCardTypeId
.head 7 -  String: sCardTypeName
.head 7 -  Number: nCardAcsId
.head 7 -  Number: nCardPoolNo
.head 7 -  Date/Time: dCardIssuer
.head 7 -  Date/Time: dCardExpered
.head 7 -  String: sCardStatus
.head 7 -  String: sCardStopStatus
.head 7 -  String: sCardComment
.head 7 -  String: sClosed
.head 7 -  String: sChgType
.head 7 -  Date/Time: dChgDate
.head 7 -  String: sCardQuestion
.head 7 -  String: sCardAnswer
.head 6 +  Actions
.head 7 -  Set nIndex = 0
.head 7 +  If not SqlPrepareAndExecute(hSql(), 
"select card_type, card_id, card_acsid, card_poolno, card_status,
        card_expired, card_issued, card_stopstatus, card_comment, closed, " ||
        IifS(bArc=TRUE, "change_type, change_date", "null, null") || "
   into :sCardTypeName, :nCardId, :nCardAcsId, :nCardPoolNo, :sCardStatus,
        :dCardExpered, :dCardIssuer, :sCardStopStatus, :sCardComment, :sClosed,
        :sChgType, :dChgDate
   from " || IifS(bArc=TRUE, "v_customer_nncards_history", "v_customer_nncards") || "
  where cust_id = :nRnk 
  order by card_status, card_acsid" || IifS(bArc=TRUE, ", change_date", ""))
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! Основные реквизиты карты
.head 8 -  Set CardList[nIndex].sCardTypeName   = sCardTypeName
.head 8 -  Set CardList[nIndex].nCardId         = nCardId
.head 8 -  Set CardList[nIndex].nCardAcsId      = nCardAcsId
.head 8 -  Set CardList[nIndex].nCardPoolNo     = nCardPoolNo
.head 8 -  Set CardList[nIndex].sCardStatus     = sCardStatus
.head 8 -  Set CardList[nIndex].dCardExpered    = dCardExpered
.head 8 -  Set CardList[nIndex].dCardIssuer     = dCardIssuer
.head 8 -  Set CardList[nIndex].sCardStopStatus = sCardStopStatus
.head 8 -  Set CardList[nIndex].sCardComment    = sCardComment
.head 8 -  Set CardList[nIndex].sClosed         = sClosed
.head 8 -  Set CardList[nIndex].sChgType        = sChgType
.head 8 -  Set CardList[nIndex].dChgDate        = dChgDate
.head 8 -  Set CardList[nIndex].bInserted = FALSE
.head 8 -  Set CardList[nIndex].bDeleted  = FALSE
.head 8 -  Set CardList[nIndex].bChanged  = FALSE
.head 8 -  ! Ключевая фраза
.head 8 +  If not SqlPLSQLCommand(hSqlAux(), "bars_nnacs.get_card_keyphrase(nCardId, sCardQuestion, sCardAnswer)")
.head 9 -  Return FALSE
.head 8 -  Set CardList[nIndex].sCardQuestion = sCardQuestion
.head 8 -  Set CardList[nIndex].sCardAnswer   = sCardAnswer
.head 8 -  ! Инструменты
.head 8 -  Call PopulateCardTools(CardList[nIndex], nCardId)
.head 8 -  Set nIndex = nIndex + 1
.head 7 -  Set nListNum = nIndex
.head 7 -  Return TRUE
.head 5 +  Function: PopulateCardTools
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : cCard
.head 8 -  Class: cNNCard
.head 7 -  Number: nCardId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nToolIndex
.head 7 -  !
.head 7 -  Number: nToolId
.head 7 -  Number: nToolAcsId
.head 7 -  String: sToolTypeName
.head 7 -  Date/Time: dToolEnter
.head 7 -  Date/Time: dToolExpire
.head 7 -  Number: nLoadAccId
.head 7 -  String: sLoadAccNls
.head 7 -  String: sLoadAccNms
.head 7 -  Number: nLimitId
.head 7 -  String: sLimitNum
.head 7 -  String: sLimitName
.head 7 -  String: sToolAccNls
.head 7 -  String: sToolAccNms
.head 7 -  String: sChgType
.head 7 -  Date/Time: dChgDate
.head 6 +  Actions
.head 7 -  Set nToolIndex = 0
.head 7 -  Call SqlPrepareAndExecute(hSqlAux(), 
"select tool_id, tool_acsid, tooltype_name,
        tool_enter, tool_expire, 
        loadacc_id, loadacc_num, loadacc_name, 
        lim_id, lim_num, lim_name, 
        toolacc_num, toolacc_name, " ||
        IifS(bArc=TRUE, "change_type, change_date", "null, null") || "
   into :nToolId, :nToolAcsId, :sToolTypeName, 
        :dToolEnter, :dToolExpire, 
        :nLoadAccId, :sLoadAccNls, :sLoadAccNms, 
        :nLimitId, :sLimitNum, :sLimitName, 
        :sToolAccNls, :sToolAccNms,
        :sChgType, :dChgDate
   from " || IifS(bArc=TRUE, "v_customer_nncardtools_history", "v_customer_nncardtools") || "
  where card_id = :nCardId
  order by card_id, tool_id")
.head 7 +  While SqlFetchNext(hSqlAux(), nFetchRes)
.head 8 -  Set cCard.ToolsList[nToolIndex].nToolId       = nToolId
.head 8 -  Set cCard.ToolsList[nToolIndex].nToolAcsId    = nToolAcsId
.head 8 -  Set cCard.ToolsList[nToolIndex].nToolTypeId   = NUMBER_Null
.head 8 -  Set cCard.ToolsList[nToolIndex].sToolTypeName = sToolTypeName
.head 8 -  Set cCard.ToolsList[nToolIndex].dToolEnter    = dToolEnter
.head 8 -  Set cCard.ToolsList[nToolIndex].dToolExpire   = dToolExpire
.head 8 -  Set cCard.ToolsList[nToolIndex].nLoadAccId    = nLoadAccId
.head 8 -  Set cCard.ToolsList[nToolIndex].sLoadAccNls   = sLoadAccNls
.head 8 -  Set cCard.ToolsList[nToolIndex].sLoadAccNms   = sLoadAccNms
.head 8 -  Set cCard.ToolsList[nToolIndex].nLimitId      = nLimitId
.head 8 -  Set cCard.ToolsList[nToolIndex].sLimitNum     = sLimitNum
.head 8 -  Set cCard.ToolsList[nToolIndex].sLimitName    = sLimitName
.head 8 -  Set cCard.ToolsList[nToolIndex].sToolAccNls   = sToolAccNls
.head 8 -  Set cCard.ToolsList[nToolIndex].sToolAccNms   = sToolAccNms
.head 8 -  Set cCard.ToolsList[nToolIndex].sChgType      = sChgType
.head 8 -  Set cCard.ToolsList[nToolIndex].dChgDate      = dChgDate
.head 8 -  Set nToolIndex = nToolIndex + 1
.head 7 -  Set cCard.nToolsListNum = nToolIndex
.head 7 -  Return TRUE
.head 5 +  Function: Save
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  Number: nCardId
.head 7 -  Number: nCardTypeId
.head 7 -  String: sCardComment
.head 7 -  String: sCardQuestion
.head 7 -  String: sCardAnswer
.head 7 -  Number: nCardIdOld
.head 7 -  Number: nToolIndex
.head 7 -  Number: nToolId
.head 7 -  Number: nLoadAccId
.head 7 -  Number: nLimitId
.head 6 +  Actions
.head 7 -  Set nIndex = 0
.head 7 +  While nIndex < nListNum
.head 8 -  Set nCardId = CardList[nIndex].nCardId
.head 8 +  If CardList[nIndex].bInserted
.head 9 -  ! если новую карточку сразу не удалили
.head 9 +  If not CardList[nIndex].bDeleted
.head 10 -  Set nCardTypeId   = CardList[nIndex].nCardTypeId
.head 10 -  Set sCardComment  = CardList[nIndex].sCardComment
.head 10 -  Set sCardQuestion = CardList[nIndex].sCardQuestion
.head 10 -  Set sCardAnswer   = CardList[nIndex].sCardAnswer
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.assign_card_customer(nCardId, nRnk, nCardTypeId, 
   sCardComment, sCardQuestion, sCardAnswer)")
.head 11 -  Return FALSE
.head 10 -  Set nToolIndex = 0
.head 10 +  While nToolIndex < CardList[nIndex].nToolsListNum
.head 11 -  Set nToolId    = CardList[nIndex].ToolsList[nToolIndex].nToolId
.head 11 -  Set nLoadAccId = CardList[nIndex].ToolsList[nToolIndex].nLoadAccId
.head 11 -  Set nLimitId   = CardList[nIndex].ToolsList[nToolIndex].nLimitId
.head 11 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.assign_card_tool(nToolId, nLoadAccId, nLimitId)")
.head 12 -  Return FALSE
.head 11 -  Set nToolIndex = nToolIndex + 1
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.add_customer_card(nRnk)")
.head 11 -  Return FALSE
.head 8 +  Else If CardList[nIndex].bDeleted
.head 9 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.close_customer_card(nRnk, nCardId)")
.head 10 -  Return FALSE
.head 8 +  Else If CardList[nIndex].bChanged
.head 9 -  Set nCardIdOld = CardList[nIndex].nCardIdOld
.head 9 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.change_customer_card(nRnk, nCardIdOld, nCardId)")
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 +  If CardList[nIndex].bChangeComment
.head 10 -  Set sCardComment = CardList[nIndex].sCardComment
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.change_card_comment(nCardId, sCardComment)")
.head 11 -  Return FALSE
.head 9 +  If CardList[nIndex].bChangeKeyPhrase
.head 10 -  Set sCardQuestion = CardList[nIndex].sCardQuestion
.head 10 -  Set sCardAnswer   = CardList[nIndex].sCardAnswer
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.change_card_keyphrase(nCardId, sCardQuestion, sCardAnswer)")
.head 11 -  Return FALSE
.head 9 +  If CardList[nIndex].bChangeTools
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.assign_card_customer(nCardId, nRnk, NUMBER_Null,
   STRING_Null, STRING_Null, STRING_Null)")
.head 11 -  Return FALSE
.head 10 -  Set nToolIndex = 0
.head 10 +  While nToolIndex < CardList[nIndex].nToolsListNum
.head 11 -  Set nToolId    = CardList[nIndex].ToolsList[nToolIndex].nToolId
.head 11 -  Set nLoadAccId = CardList[nIndex].ToolsList[nToolIndex].nLoadAccId
.head 11 -  Set nLimitId   = CardList[nIndex].ToolsList[nToolIndex].nLimitId
.head 11 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.assign_card_tool(nToolId, nLoadAccId, nLimitId)")
.head 12 -  Return FALSE
.head 11 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.change_card_loadacc(nCardId)")
.head 12 -  Return FALSE
.head 11 -  Set nToolIndex = nToolIndex + 1
.head 8 -  Set nIndex = nIndex + 1
.head 7 -  Return TRUE
.head 5 +  Function: GetIndexByCardId
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nCardId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nListNum
.head 8 +  If CardList[nIterator].nCardId = nCardId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 5 +  Function: AddCard
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 7 -  Number: nCardTypeId
.head 7 -  String: sCardTypeName
.head 7 -  Number: nCardAcsId
.head 7 -  Number: nCardPoolNo
.head 7 -  Date/Time: dCardIssuer
.head 7 -  Date/Time: dCardExpered
.head 7 -  String: sCardComment
.head 7 -  String: sCardQuestion
.head 7 -  String: sCardAnswer
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = nListNum
.head 7 -  Set CardList[nIndex].nCardId       = nCardId
.head 7 -  Set CardList[nIndex].nCardTypeId   = nCardTypeId
.head 7 -  Set CardList[nIndex].sCardTypeName = sCardTypeName
.head 7 -  Set CardList[nIndex].nCardAcsId    = nCardAcsId
.head 7 -  Set CardList[nIndex].nCardPoolNo   = nCardPoolNo
.head 7 -  Set CardList[nIndex].dCardIssuer   = dCardIssuer
.head 7 -  Set CardList[nIndex].dCardExpered  = dCardExpered
.head 7 -  Set CardList[nIndex].sCardComment  = sCardComment
.head 7 -  Set CardList[nIndex].sCardQuestion = sCardQuestion
.head 7 -  Set CardList[nIndex].sCardAnswer   = sCardAnswer
.head 7 -  Set CardList[nIndex].bInserted = TRUE
.head 7 -  Set nListNum = nListNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: AddCardTool
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 7 -  Number: nToolId
.head 7 -  Number: nToolAcsId
.head 7 -  Number: nToolTypeId
.head 7 -  String: sToolTypeName
.head 7 -  Date/Time: dToolEnter
.head 7 -  Date/Time: dToolExpire
.head 7 -  Number: nLoadAccId
.head 7 -  String: sLoadAccNls
.head 7 -  String: sLoadAccNms
.head 7 -  Number: nLimitId
.head 7 -  String: sLimitNum
.head 7 -  String: sLimitName
.head 7 -  String: sToolAccNls
.head 7 -  String: sToolAccNms
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  Number: nToolIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByCardId(nCardId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set nToolIndex = CardList[nIndex].nToolsListNum
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nToolId        = nToolId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nToolAcsId     = nToolAcsId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nToolTypeId    = nToolTypeId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sToolTypeName  = sToolTypeName
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].dToolEnter     = dToolEnter
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].dToolExpire    = dToolExpire
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nLoadAccId     = nLoadAccId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLoadAccNls    = sLoadAccNls
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLoadAccNms    = sLoadAccNms
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nLimitId       = nLimitId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLimitNum      = sLimitNum
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLimitName     = sLimitName
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sToolAccNls    = sToolAccNls
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sToolAccNms    = sToolAccNms
.head 7 -  Set CardList[nIndex].nToolsListNum = CardList[nIndex].nToolsListNum + 1
.head 7 -  Return TRUE
.head 5 +  Function: ChangeCard
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardIdOld
.head 7 -  Number: nCardIdNew
.head 7 -  Number: nCardAcsId
.head 7 -  Number: nCardPoolNo
.head 7 -  Date/Time: dCardIssuer
.head 7 -  Date/Time: dCardExpered
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByCardId(nCardIdOld)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set CardList[nIndex].sCardTypeName   = STRING_Null
.head 7 -  Set CardList[nIndex].nCardId         = nCardIdNew
.head 7 -  Set CardList[nIndex].nCardIdOld      = nCardIdOld
.head 7 -  Set CardList[nIndex].nCardAcsId      = nCardAcsId
.head 7 -  Set CardList[nIndex].nCardPoolNo     = nCardPoolNo
.head 7 -  Set CardList[nIndex].sCardStatus     = STRING_Null
.head 7 -  Set CardList[nIndex].dCardExpered    = dCardExpered
.head 7 -  Set CardList[nIndex].dCardIssuer     = dCardIssuer
.head 7 -  Set CardList[nIndex].sCardStopStatus = STRING_Null
.head 7 -  Set CardList[nIndex].sCardComment    = STRING_Null
.head 7 -  Set CardList[nIndex].sClosed         = 'N'
.head 7 -  Set CardList[nIndex].sChgType        = STRING_Null
.head 7 -  Set CardList[nIndex].dChgDate        = DATETIME_Null
.head 7 -  Set CardList[nIndex].bInserted = FALSE
.head 7 -  Set CardList[nIndex].bDeleted  = FALSE
.head 7 -  Set CardList[nIndex].bChanged  = TRUE
.head 7 -  Call PopulateCardTools(CardList[nIndex], nCardIdNew)
.head 7 -  Return TRUE
.head 5 +  Function: SetCardDeleteFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 7 -  Boolean: bDeleted
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByCardId(nCardId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set CardList[nIndex].bDeleted = bDeleted
.head 7 -  Return TRUE
.head 5 +  Function: ChangeComment
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 7 -  String: sCardComment
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByCardId(nCardId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set CardList[nIndex].sCardComment = sCardComment
.head 7 -  Set CardList[nIndex].bChangeComment = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: ChangeKeyPhrase
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 7 -  String: sCardQuestion
.head 7 -  String: sCardAnswer
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByCardId(nCardId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set CardList[nIndex].sCardQuestion = sCardQuestion
.head 7 -  Set CardList[nIndex].sCardAnswer   = sCardAnswer
.head 7 -  Set CardList[nIndex].bChangeKeyPhrase = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: ChangeCardTool
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCardId
.head 7 -  Number: nToolIndex
.head 7 -  Number: nLimitId
.head 7 -  String: sLimitNum
.head 7 -  String: sLimitName
.head 7 -  Number: nLoadAccId
.head 7 -  String: sLoadNls
.head 7 -  String: sLoadNms
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = GetIndexByCardId(nCardId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nLimitId    = nLimitId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLimitNum   = sLimitNum
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLimitName  = sLimitName
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].nLoadAccId  = nLoadAccId
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLoadAccNls = sLoadNls
.head 7 -  Set CardList[nIndex].ToolsList[nToolIndex].sLoadAccNms = sLoadNms
.head 7 -  Set CardList[nIndex].bChangeTools = TRUE
.head 7 -  Return TRUE
.head 3 +  Functional Class: cNNLimit
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nLimId
.head 5 -  String: sLimNum
.head 5 -  Number: nLimValue
.head 5 -  Number: nLimValueAcs
.head 5 -  Number: nLimFixBal
.head 5 -  String: sLimStatus
.head 5 -  String: sLimError
.head 5 -  Boolean: bLimDeleted
.head 5 -  Number: nLimPos
.head 5 -  ! for change
.head 5 -  String: sLimIsFix
.head 5 -  Number: nLimFixAmnt
.head 5 -  Number: nLimFixDays
.head 5 -  Number: nLimMinBal
.head 5 -  Number: nLimMaxBal
.head 5 -  Number: nLimPrcBal
.head 5 -  !
.head 5 -  Boolean: bDeleted
.head 5 -  ! Boolean: bInserted
.head 5 -  Boolean: bChanged
.head 5 -  Boolean: bChangePos
.head 4 -  Functions
.head 3 +  Functional Class: cNNLimitList
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nAcc
.head 5 -  Number: nListNum
.head 5 -  : LimitList[*]
.head 6 -  Class: cNNLimit
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nParAcc
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nAcc = nParAcc
.head 7 -  Set nListNum = 0
.head 7 -  Return TRUE
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLimId
.head 7 -  String: sLimNum
.head 7 -  Number: nLimValue
.head 7 -  Number: nLimValueAcs
.head 7 -  Number: nLimFixBal
.head 7 -  String: sLimStatus
.head 7 -  String: sLimError
.head 7 -  Boolean: bLimDeleted
.head 7 -  Number: nLimPos
.head 7 -  String: sLimIsFix
.head 7 -  Number: nLimFixAmnt
.head 7 -  Number: nLimFixDays
.head 7 -  Number: nLimMinBal
.head 7 -  Number: nLimMaxBal
.head 7 -  Number: nLimPrcBal
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 +  If not SqlPrepareAndExecute(hSql(), 
"select lim_id, lim_num, lim_value, lim_value_acs, lim_fixbal, 
        lim_status, lim_error, decode(lim_deleted,'Y',1,0), lim_pos,
        lim_isfix, lim_fixamnt, lim_fixdays, lim_minbal, lim_maxbal, lim_prcbal
   into :nLimId, :sLimNum, :nLimValue, :nLimValueAcs, :nLimFixBal, 
        :sLimStatus, :sLimError, :bLimDeleted, :nLimPos,
        :sLimIsFix, :nLimFixAmnt, :nLimFixDays, :nLimMinBal, :nLimMaxBal, :nLimPrcBal
   from v_account_nnlimits
  where acc_id = :nAcc
  order by lim_pos")
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call addLimit(nLimId, sLimNum, nLimValue, nLimValueAcs, nLimFixBal, 
     sLimStatus, sLimError, bLimDeleted, nLimPos,
     sLimIsFix, nLimFixAmnt, nLimFixDays, nLimMinBal, nLimMaxBal, nLimPrcBal, nIndex)
.head 7 -  Return TRUE
.head 5 +  Function: addLimit
.head 6 -  Description: Добавление лимита в спмсок
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLimId
.head 7 -  String: sLimNum
.head 7 -  Number: nLimValue
.head 7 -  Number: nLimValueAcs
.head 7 -  Number: nLimFixBal
.head 7 -  String: sLimStatus
.head 7 -  String: sLimError
.head 7 -  Boolean: bLimDeleted
.head 7 -  Number: nLimPos
.head 7 -  String: sLimIsFix
.head 7 -  Number: nLimFixAmnt
.head 7 -  Number: nLimFixDays
.head 7 -  Number: nLimMinBal
.head 7 -  Number: nLimMaxBal
.head 7 -  Number: nLimPrcBal
.head 7 -  !
.head 7 -  Receive Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nIndex = nListNum
.head 7 -  Set LimitList[nIndex].nLimId       = nLimId
.head 7 -  Set LimitList[nIndex].sLimNum      = sLimNum
.head 7 -  Set LimitList[nIndex].nLimValue    = nLimValue
.head 7 -  Set LimitList[nIndex].nLimValueAcs = nLimValueAcs
.head 7 -  Set LimitList[nIndex].nLimFixBal   = nLimFixBal
.head 7 -  Set LimitList[nIndex].sLimStatus   = sLimStatus
.head 7 -  Set LimitList[nIndex].sLimError    = sLimError
.head 7 -  Set LimitList[nIndex].bLimDeleted  = bLimDeleted
.head 7 -  Set LimitList[nIndex].nLimPos      = nLimPos
.head 7 -  ! for change
.head 7 -  Set LimitList[nIndex].sLimIsFix    = sLimIsFix
.head 7 -  Set LimitList[nIndex].nLimFixAmnt  = nLimFixAmnt
.head 7 -  Set LimitList[nIndex].nLimFixDays  = nLimFixDays
.head 7 -  Set LimitList[nIndex].nLimMinBal   = nLimMinBal
.head 7 -  Set LimitList[nIndex].nLimMaxBal   = nLimMaxBal
.head 7 -  Set LimitList[nIndex].nLimPrcBal   = nLimPrcBal
.head 7 -  !
.head 7 -  Set LimitList[nIndex].bDeleted   = FALSE
.head 7 -  Set LimitList[nIndex].bChanged   = FALSE
.head 7 -  Set LimitList[nIndex].bChangePos = FALSE
.head 7 -  !
.head 7 -  Set nListNum = nListNum + 1
.head 7 -  !
.head 7 -  Return TRUE
.head 5 +  Function: Save
.head 6 -  Description: Сохранение в БД изменений (update + delete)
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  !
.head 7 -  Number: nLimId
.head 7 -  String: sLimIsFix
.head 7 -  Number: nLimFixAmnt
.head 7 -  Number: nLimFixDays
.head 7 -  Number: nLimMinBal
.head 7 -  Number: nLimMaxBal
.head 7 -  Number: nLimPrcBal
.head 7 -  Number: nLimPos
.head 7 -  !
.head 7 -  Boolean: bApplyChange
.head 6 +  Actions
.head 7 -  Set nIndex = 0
.head 7 +  While nIndex < nListNum
.head 8 -  Set bApplyChange = FALSE
.head 8 -  Set nLimId = LimitList[nIndex].nLimId
.head 8 +  If LimitList[nIndex].bDeleted
.head 9 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.delete_limit(nLimId)")
.head 10 -  Return FALSE
.head 9 -  Set bApplyChange = TRUE
.head 8 +  Else
.head 9 +  If LimitList[nIndex].bChanged
.head 10 -  Set sLimIsFix   = LimitList[nIndex].sLimIsFix
.head 10 -  Set nLimFixAmnt = LimitList[nIndex].nLimFixAmnt
.head 10 -  Set nLimFixDays = LimitList[nIndex].nLimFixDays
.head 10 -  Set nLimMinBal  = LimitList[nIndex].nLimMinBal
.head 10 -  Set nLimMaxBal  = LimitList[nIndex].nLimMaxBal
.head 10 -  Set nLimPrcBal  = LimitList[nIndex].nLimPrcBal
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.change_limit(nLimId, 
   sLimIsFix, nLimFixAmnt, nLimFixDays, nLimMinBal, nLimMaxBal, nLimPrcBal)")
.head 11 -  Return FALSE
.head 10 -  Set bApplyChange = TRUE
.head 9 +  If LimitList[nIndex].bChangePos
.head 10 -  Set nLimPos = LimitList[nIndex].nLimPos
.head 10 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.set_limit_pos(nLimId, nLimPos)")
.head 11 -  Return FALSE
.head 10 -  Set bApplyChange = TRUE
.head 8 +  If bApplyChange
.head 9 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.apply_limit_change(nAcc)")
.head 10 -  Return FALSE
.head 8 -  Set nIndex = nIndex + 1
.head 7 -  Return TRUE
.head 5 +  Function: SaveNewLimit
.head 6 -  Description: Сохранение в БД изменений (insert)
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLimIdOut
.head 7 -  !
.head 7 -  String: sLimIsFix
.head 7 -  Number: nLimFixAmnt
.head 7 -  Number: nLimFixDays
.head 7 -  Number: nLimMinBal
.head 7 -  Number: nLimMaxBal
.head 7 -  Number: nLimPrcBal
.head 7 -  !
.head 7 -  Receive Number: nIndex
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLimId
.head 7 -  String: sLimNum
.head 7 -  Number: nLimValue
.head 7 -  Number: nLimValueAcs
.head 7 -  Number: nLimFixBal
.head 7 -  String: sLimStatus
.head 7 -  String: sLimError
.head 7 -  Boolean: bLimDeleted
.head 7 -  Number: nLimPos
.head 6 +  Actions
.head 7 -  ! Сохраняем
.head 7 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.add_limit(nAcc, NUMBER_Null, nLimIdOut,
   sLimIsFix, nLimFixAmnt, nLimFixDays, nLimMinBal, nLimMaxBal, nLimPrcBal)")
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 7 +  If not SqlPLSQLCommand(hSql(), "bars_nnacs.apply_limit_change(nAcc)")
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 7 -  Call SqlCommit(hSql())
.head 7 -  ! Читаем сохраненный лимит
.head 7 -  Call SqlPrepareAndExecute(hSql(),
"select lim_id, lim_num, lim_value, lim_value_acs, lim_fixbal, 
        lim_status, lim_error, decode(lim_deleted,'Y',1,0), lim_pos,
        lim_isfix, lim_fixamnt, lim_fixdays, lim_minbal, lim_maxbal, lim_prcbal
   into :nLimId, :sLimNum, :nLimValue, :nLimValueAcs, :nLimFixBal, 
        :sLimStatus, :sLimError, :bLimDeleted, :nLimPos,
        :sLimIsFix, :nLimFixAmnt, :nLimFixDays, :nLimMinBal, :nLimMaxBal, :nLimPrcBal
   from v_account_nnlimits
  where acc_id = :nAcc and lim_id = :nLimIdOut
  order by lim_pos")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Добавляем новы1 лимит в список
.head 7 -  Call addLimit(nLimId, sLimNum, nLimValue, nLimValueAcs, nLimFixBal, 
     sLimStatus, sLimError, bLimDeleted, nLimPos,
     sLimIsFix, nLimFixAmnt, nLimFixDays, nLimMinBal, nLimMaxBal, nLimPrcBal, nIndex)
.head 7 -  Return TRUE
.head 5 +  Function: getIndexByLimitId
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLimId
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIterator
.head 7 -  Boolean: fFound
.head 6 +  Actions
.head 7 +  If NOT nLimId
.head 8 -  Return -1
.head 7 -  Set nIterator = 0
.head 7 +  While nIterator < nListNum
.head 8 +  If LimitList[nIterator].nLimId = nLimId
.head 9 -  Set fFound = TRUE
.head 9 -  Break
.head 8 -  Set nIterator = nIterator + 1
.head 7 +  If fFound
.head 8 -  Return nIterator
.head 5 +  Function: getLimitByIndex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Receive Number: nLimId
.head 7 -  Receive String: sLimNum
.head 7 -  Receive Number: nLimValue
.head 7 -  Receive Number: nLimValueAcs
.head 7 -  Receive Number: nLimFixBal
.head 7 -  Receive String: sLimStatus
.head 7 -  Receive String: sLimError
.head 7 -  Receive Boolean: bLimDeleted
.head 7 -  Receive Number: nLimPos
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nLimId       = LimitList[nIndex].nLimId
.head 7 -  Set sLimNum      = LimitList[nIndex].sLimNum
.head 7 -  Set nLimValue    = LimitList[nIndex].nLimValue
.head 7 -  Set nLimValueAcs = LimitList[nIndex].nLimValueAcs
.head 7 -  Set nLimFixBal   = LimitList[nIndex].nLimFixBal
.head 7 -  Set sLimStatus   = LimitList[nIndex].sLimStatus
.head 7 -  Set sLimError    = LimitList[nIndex].sLimError
.head 7 -  Set bLimDeleted  = LimitList[nIndex].bLimDeleted
.head 7 -  Set nLimPos      = LimitList[nIndex].nLimPos
.head 7 -  Return TRUE
.head 5 +  Function: changeLimit
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  String: sLimIsFix
.head 7 -  Number: nLimFixAmnt
.head 7 -  Number: nLimFixDays
.head 7 -  Number: nLimMinBal
.head 7 -  Number: nLimMaxBal
.head 7 -  Number: nLimPrcBal
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set LimitList[nIndex].sLimIsFix   = sLimIsFix
.head 7 -  Set LimitList[nIndex].nLimFixAmnt = nLimFixAmnt
.head 7 -  Set LimitList[nIndex].nLimFixDays = nLimFixDays
.head 7 -  Set LimitList[nIndex].nLimMinBal  = nLimMinBal
.head 7 -  Set LimitList[nIndex].nLimMaxBal  = nLimMaxBal
.head 7 -  Set LimitList[nIndex].nLimPrcBal  = nLimPrcBal
.head 7 -  Set LimitList[nIndex].bChanged = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: changeLimPos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 7 -  Number: nPos
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set LimitList[nIndex].nLimPos = nPos
.head 7 -  Set LimitList[nIndex].bChangePos = TRUE
.head 7 -  Return TRUE
.head 5 +  Function: setLimitDeleteFlag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLimId
.head 7 -  Boolean: bDeleted
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nIndex = getIndexByLimitId(nLimId)
.head 7 +  If nIndex = -1
.head 8 -  Return FALSE
.head 7 -  Set LimitList[nIndex].bDeleted = bDeleted
.head 7 -  Return TRUE
.head 3 +  Functional Class: cCustTab
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: TabNum
.head 5 -  String: Label
.head 5 -  String: Name
.head 5 -  String: DlgName
.head 5 -  Window Handle: hWnd
.head 5 -  Number: EditMode
.head 5 -  Boolean: isEdited
.head 4 -  Functions
.head 3 +  Functional Class: cAccTab
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: TabNum
.head 5 -  String: Label
.head 5 -  String: Name
.head 5 -  String: DlgName
.head 5 -  Window Handle: hWnd
.head 5 -  Number: EditMode
.head 5 -  ! Boolean: isEdited
.head 4 -  Functions
.head 3 +  Functional Class: cAccListOptions
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: bFinance	! Флаги состояния View
.head 5 -  Boolean: bOstDK		! .........==.........
.head 5 -  Boolean: bSumEqv	! .........==.........
.head 5 -  Boolean: bLimits	! .........==.........
.head 5 -  Boolean: bLinkAcc	! .........==.........
.head 5 -  Boolean: bSpecial	! .........==.........
.head 5 -  Boolean: bInterests	! .........==.........
.head 5 -  Boolean: bBlocked	! .........==.........
.head 5 -  Boolean: bClosed	! .........==.........
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bFinance   = FALSE
.head 7 -  Set bOstDK     = FALSE
.head 7 -  Set bSumEqv    = FALSE
.head 7 -  Set bLimits    = FALSE
.head 7 -  Set bLinkAcc   = FALSE
.head 7 -  Set bSpecial   = FALSE
.head 7 -  Set bInterests = FALSE
.head 7 -  Set bBlocked   = FALSE
.head 7 -  Set bClosed    = FALSE
.head 7 -  Return TRUE
.head 3 +  Functional Class: cParHist
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nND		! Acc/Rnk
.head 5 -  Number: nParId		! Id параметра
.head 5 -  String: sParSemantic	! Название параметра русским языком
.head 5 -  String: sTabName	! Имя таблицы-хранилища параетров (accountspv)
.head 5 -  String: sKeyName	! Имя колонки-ключа (accountspv.acc)
.head 5 -  String: sValName	! Имя колонки для хранения значения параметра в таблице-хранилище (accountspv.value)
.head 5 -  String: sType		! Тип параметра (N, D, S)
.head 5 -  String: sNsiTabName	! Имя справочника, откуда можно выбирать значение параметра (KL_R011)
.head 5 -  String: sNsiPkName	! Колонка-ключ, кот. будет выбираться из справочника для значения параметра (KL_R011.R011)
.head 5 -  String: sNsiSqlWhere	! Фильтр на справочник (R020=:NBS AND D_CLOSE IS NULL)
.head 5 -  String: sNsiColumnCheck	! Имя колонки из справочника, по которому контролируется значение параметра (R011)
.head 4 -  Functions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cpbLabeledOk
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Check Box:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box: cGenComboBox_NumId
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 -  ! ------------!
.head 1 -  ! Контрагенты !
.head 1 -  ! ------------!
.head 1 +  Table Window: frm_CustomerList
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Контрагенты
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.32"
.head 4 -  Top:    0.267"
.head 4 -  Width:  12.45"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.881"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 64000
.head 3 -  Discardable? No
.head 2 -  Description: Список контрагентов банка
.head 2 +  Named Menus
.head 3 +  Menu: menuCustomer
.head 4 -  Resource Id: 42061
.head 4 -  Title: (untitled)
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Popup Menu: &Просмотр
.head 5 -  Resource Id: 42062
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Все
.head 6 -  Resource Id: 42063
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: obAll
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(obAll, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Физические лица
.head 6 -  Resource Id: 42064
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: obPersons
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(obPersons, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Физические лица-СПД
.head 6 -  Resource Id: 38420
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: obSPD
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(obSPD, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Юридические лица
.head 6 -  Resource Id: 42065
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: obCorporations
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(obCorporations, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Банки-контрагенты
.head 6 -  Resource Id: 42066
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: obBanks
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(obBanks, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: Показывать закрытых
.head 6 -  Resource Id: 42067
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: obShowClosed
.head 6 +  Menu Actions
.head 7 -  Set obShowClosed = 1 - obShowClosed
.head 7 -  Call SalPostMsg(obShowClosed, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Карточка контрагента
.head 5 -  Resource Id: 42068
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbDossier, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Счета контрагента
.head 5 -  Resource Id: 42069
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: nCtrlFlags & CVIEW_Accounts
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbAccounts, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Зарегистрировать &Нового
.head 5 -  Resource Id: 42070
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & CVIEW_ReadOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbRegisterNew, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Закрыть контрагента
.head 5 -  Resource Id: 42071
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & CVIEW_ReadOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbClose, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Пе&ререгистрирвать
.head 5 -  Resource Id: 42072
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & CVIEW_ReadOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbResurect, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Фильтр
.head 5 -  Resource Id: 42073
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbFilter, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Со&ртировка
.head 5 -  Resource Id: 42074
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbSort, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Искать
.head 5 -  Resource Id: 42075
.head 5 -  Keyboard Accelerator: Ctrl+F
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbFind, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Искать сно&ва
.head 5 -  Resource Id: 42076
.head 5 -  Keyboard Accelerator: Ctrl+G
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call TblFindString( hWndForm, DFIND_Again )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Перечитать
.head 5 -  Resource Id: 42077
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbRefresh, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 42078
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbExit, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Печать...
.head 5 -  Resource Id: 38389
.head 5 -  Keyboard Accelerator: Ctrl+P
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: FALSE
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( hWndForm, UM_Print, 0, 0 )
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Option Button: obAll		! Контрагенты всех типов
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.057"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Smthing.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Контрагенты всех типов
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipAll'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Option Button: obPersons	! Контрагенты - физические лица
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.486"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custpers.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Контрагенты - физические лица
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipPersons'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Option Button: obSPD		! Контрагенты - физические лица-СПД
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.917"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\USER.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Контрагенты - физические лица-СПД
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipSPD'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Option Button: obCorporations	! Контрагенты - юридические лица
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Контрагенты - юридические лица
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipCorporations'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Option Button: obBanks		! Контрагенты - банки
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custbank.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Контрагенты - банки
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipBanks'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Set MyValue = TRUE
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 42079
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.283"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  2.283"
.head 6 -  End Y:  0.469"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Option Button: obShowClosed	! Показывать закрытых контрагентов
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.4"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custclsd.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Показывать закрытых контрагентов
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipShowClosed'))
.head 6 +  On UM_NoFontChange
.head 7 -  Return TRUE
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 42080
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.9"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  2.9"
.head 6 -  End Y:  0.469"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbRegisterNew	! Зарегистрировать нового контрагента
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Зарегистрировать нового контрагента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipRegisterNew')
.head 7 +  If nCtrlFlags & CVIEW_ReadOnly
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen()
.head 8 -  Set nChooseCustType = 0
.head 8 +  If obAll
.head 9 +  If not SalModalDialog(dlg_ChooseCustType, hWndForm, IifN(nCTypeNN>0,TRUE,FALSE),
   nChooseCustType, nChooseCustRezid)
.head 10 -  Return TRUE
.head 8 +  Else
.head 9 -  Set nChooseCustType = IifN(obBanks, 1, IifN(obCorporations, 2, IifN(obPersons,9,10)))
.head 9 +  If not SalModalDialog(dlg_ChooseCustType, hWndForm, IifN(nCTypeNN>0,TRUE,FALSE),
   nChooseCustType, nChooseCustRezid)
.head 10 -  Return TRUE
.head 8 +  If nChooseCustType
.head 9 -  Call EditCustomer(nChooseCustType, nChooseCustRezid, 0, nCtrlFlags, hWndForm, 0, sCustFilterTab || IifS(sAccFilter='#', '', '#' || sAccFilter), IifN(nCTypeNN>0,TRUE,FALSE))
.head 7 +  Else
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  ! Банковский День ЗАКРЫТ!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTBankDayClose'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 4 +  Pushbutton: pbClose		! Закрыть контрагента...
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.433"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Закрыть контрагента...
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipClose')
.head 7 +  If nCtrlFlags & CVIEW_ReadOnly or nCtrlFlags & CVIEW_ApproveKK
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0) and colDATEOFF = DATETIME_Null
.head 8 +  If IsBankDayOpen()
.head 9 +  If CloseCustomer(colRNK, colNAME)
.head 10 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbResurect		! Перерегистрировать закрытого контрагента
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.867"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перерегистрировать закрытого контрагента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipResurect')
.head 7 +  If nCtrlFlags & CVIEW_ReadOnly
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 +  If IsBankDayOpen() AND NOT SalIsNull(colDATEOFF)
.head 9 +  If ResurectCustomer(colRNK, colNAME)
.head 10 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  !
.head 4 +  Pushbutton: pbFilter		! Установить фильтр
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.933"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Установить фильтр
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipFilter')
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilterEx(FCust)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbFind		! Искать запись
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Искать запись
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipFind')
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(hWndForm, DFIND_First)
.head 4 +  Pushbutton: pbRefresh	! Перечитать данные
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перечитать данные
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbPrint		! Друк
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Друк
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(hWndForm, UM_Print, 0, 0)
.head 4 +  Pushbutton: pbSort
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.933"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 7 -  Set strTip = 'Установить порядок сортировки'
.head 6 -  On SAM_Click
.head 4 -  Line
.head 5 -  Resource Id: 42081
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.383"
.head 6 -  Begin Y:  0.048"
.head 6 -  End X:  6.383"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 57996
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.383"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  4.383"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbDossier		! Показать карточку контрагента
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать карточку контрагента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipDossier')
.head 6 +  On SAM_Click
.head 7 +  If colRNK
.head 8 -  Set nCtrl4Dossier = nCtrlFlags
.head 8 +  If NOT SalIsNull(colDATEOFF)
.head 9 -  Set nCtrl4Dossier = nCtrl4Dossier | CVIEW_Closed
.head 8 -  !
.head 8 -  Set bShowKK = TRUE
.head 8 +  If bPAR_CUSTCLV
.head 9 +  If nCtrlFlags & CVIEW_ApproveKK
.head 10 -  Set bShowKK = FALSE
.head 9 +  Else
.head 10 +  If colReqType = 1
.head 11 -  Call VisMessageSetBkgdColor(COLOR_LightGray)
.head 11 -  Set hBtns[0] = hBtnShowKK
.head 11 -  Set hBtns[1] = hBtnShowChange
.head 11 -  Set hBtns[2] = hBtnExit
.head 11 -  Set nChoose = VisMessageBox('Переглянути КК в режимі', 'Перегляд...', MBF_IconQuestion, hBtns, 3)
.head 11 +  If nChoose = 0
.head 12 -  Set nCtrl4Dossier = nCtrl4Dossier | CVIEW_ReadOnly
.head 12 -  Set bShowKK = TRUE
.head 11 +  Else If nChoose = 1
.head 12 -  Set bShowKK = FALSE
.head 11 +  Else
.head 12 -  Return TRUE
.head 10 +  Else If colReqType = 0 or colReqType = 2
.head 11 -  Set bShowKK = FALSE
.head 10 +  Else
.head 11 -  Set bShowKK = TRUE
.head 8 -  !
.head 8 +  If bShowKK
.head 9 +  Select Case colTYPE
.head 10 +  Case 1
.head 11 -  Call EditCustBanksEx(colRNK, nCtrl4Dossier, hWndForm, 
     IifN(nCtrl4Dossier & CVIEW_DROnly, 6, 0), 
     sCustFilterTab || IifS(sAccFilter='#', '', '#' || sAccFilter), 0)
.head 11 -  Break
.head 10 +  Case 2
.head 11 -  Call EditCustCorpsEx(colRNK, nCtrl4Dossier, hWndForm, 
     IifN(nCtrl4Dossier & CVIEW_DROnly, 6, 0), 
     sCustFilterTab || IifS(sAccFilter='#', '', '#' || sAccFilter), 
     IifN(nCTypeNN>3, TRUE, FALSE))
.head 11 -  Break
.head 10 +  Case 3
.head 11 +  If nCType = 10
.head 12 -  Call EditCustPersonSPD(colRNK, nCtrl4Dossier, hWndForm, 
     IifN(nCtrl4Dossier & CVIEW_DROnly, 6, 0), 
     sCustFilterTab || IifS(sAccFilter='#', '', '#' || sAccFilter), 
     IifN(nCTypeNN>3, TRUE, FALSE))
.head 11 +  Else
.head 12 -  Call EditCustPersonFL(colRNK, nCtrl4Dossier, hWndForm, 
     IifN(nCtrl4Dossier & CVIEW_DROnly, 6, 0), 
     sCustFilterTab || IifS(sAccFilter='#', '', '#' || sAccFilter), 
     IifN(nCTypeNN>3, TRUE, FALSE))
.head 11 -  Break
.head 10 +  Default
.head 11 -  Break
.head 8 +  Else
.head 9 -  Call ShowCLV(colRNK, IifN(colTYPE=1, 1, IifN(colTYPE=2, 2, IifN(colTYPE=3 and nCType=10, 10, 9))),
     nCtrl4Dossier, hWndForm, sCustFilterTab || IifS(sAccFilter='#', '', '#' || sAccFilter))
.head 4 +  Pushbutton: pbAccounts		! Показать счета контрагента
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.917"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать счета контрагента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipAccounts')
.head 7 +  If NOT (nCtrlFlags & CVIEW_Accounts)
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If colRNK
.head 8 +  If not bPAR_CUSTCLV
or bPAR_CUSTCLV and (colReqType = NUMBER_Null or colReqType = 1)
.head 9 -  Call ShowAccListNN(colRNK, AVIEW_CUST, nAccFlags, sAccFilter, IifN(nCTypeNN>0, TRUE, FALSE))
.head 8 +  Else
.head 9 -  Call SalMessageBox('Відсутня можливість відкриття рахунків по клієнту ' || Str(colRNK), 'Інформація', MB_Ok | MB_IconAsterisk)
.head 4 +  Pushbutton: pbShowCustParHist	! История изменения параметров Клиента...
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.35"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOKS1.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! История изменения параметров Клиента...
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipCustParHistory')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 +  If colRNK
.head 9 -  Call ShowParHistory(hWndMDI, 2, colRNK, '', '')
.head 4 -  Line
.head 5 -  Resource Id: 42082
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  7.867"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  7.867"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit		! Выйти
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_CustomerList.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Background Text: Клиентов всего
.head 5 -  Resource Id: 43974
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.6"
.head 6 -  Top:    0.179"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgCustCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfCustCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.5"
.head 7 -  Top:    0.119"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Регистра
ционный
номер
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
документа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
контрагента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.714"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTYPENAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
контрагента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.714"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBSNSMAN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Предпри
нима
тель
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 91
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATEON
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
регистрации
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATEOFF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
закрытия
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRNKP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег. №
холдинга
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: flag
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCustCount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Tobo
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! CUST_CLV
.head 3 +  Column: colReqType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colReqStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Статус
КК
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: MakePopulateString
.head 4 -  Description: Создает SQL строку населения таблицы
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strUserCondition
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strQuery
.head 5 -  Number: nTmp
.head 5 -  Number: nTmp1
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 +  If obAll
.head 6 +  If NOT SalIsWindowVisible(colTYPENAME)
.head 7 -  Call SalShowWindow(colTYPENAME)
.head 6 -  Set nCustType = 0
.head 6 +  If nCtrlFlags & CVIEW_ApproveKK
.head 7 -  ! Контрагенты
.head 7 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleKontragents') || '. Підтвердження змін КК')
.head 6 +  Else
.head 7 -  ! Контрагенты
.head 7 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleKontragents'))
.head 5 +  Else
.head 6 +  If SalIsWindowVisible(colTYPENAME)
.head 7 -  Call SalHideWindow(colTYPENAME)
.head 6 -  !
.head 6 +  If obBanks
.head 7 -  Set nCustType = 1
.head 7 -  ! Контрагенты. [Банки]
.head 7 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleKontragents') || '. [' || 
     CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleBanks') || ']')
.head 6 +  Else If obCorporations
.head 7 -  Set nCustType = 2
.head 7 -  ! Контрагенты. [Юридические лица]
.head 7 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleKontragents') || '. [' || 
     CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleCorporations') || ']')
.head 6 +  Else If obPersons
.head 7 -  Set nCustType = 3
.head 7 -  ! Контрагенты. [Физические лица]
.head 7 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleKontragents') || '. [' || 
     CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitlePersons') || ']')
.head 6 +  Else
.head 7 -  Set nCustType = 3
.head 7 -  ! Контрагенты. [Физические лица-СПД]
.head 7 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleKontragents') || '. [' || 
     CurrentLangTable.GetAtomTitle('frm_CustomerList.cTWndTitleSPD') || ']')
.head 5 -  !
.head 5 +  If nCtrlFlags & CVIEW_Holding
.head 6 -  Set strQuery = 
"SELECT DISTINCT a.rnk, a.nd, a.okpo, a.custtype, t.name, nvl(trim(a.sed),'00'), 
        a.nmk, a.date_on, a.date_off, a.rnkp, " ||
        IifS(PAR_HAVETOBO>0, "a.tobo,", "null,") || 
        IifS(bPAR_CUSTCLV=TRUE, "req_type, req_status,", "null, null,") || "
        decode(a.rnk,b.rnkp,1,0), 1
   INTO :colRNK, :colND, :colOKPO, :colTYPE, :colTYPENAME, :colBSNSMAN,
        :colNAME, :colDATEON, :colDATEOFF, :colRNKP, 
        :colTOBO, :colReqType, :colReqStatus, :colF, :colCustCount
   FROM v_customer a, custtype t, v_customer b" || 
        IifS(nCtrlFlags & CVIEW_Saldo = 1, ", saldo s ", "") || "
  WHERE t.custtype = a.custtype AND a.rnk=b.rnkp(+) " || 
        IifS(nCtrlFlags & CVIEW_Saldo = 1, " AND a.rnk=s.rnk ", "")
.head 5 +  Else
.head 6 -  Set strQuery = 
"SELECT DISTINCT a.rnk, a.nd, a.okpo, a.custtype, t.name, nvl(trim(a.sed),'00'),
        a.nmk, a.date_on, a.date_off, " ||
        IifS(PAR_HAVETOBO>0, "a.tobo,", "null,") ||
        IifS(bPAR_CUSTCLV=TRUE, "req_type, req_status,", "null, null,") || " 1 
   INTO :colRNK, :colND, :colOKPO, :colTYPE, :colTYPENAME, :colBSNSMAN,
        :colNAME, :colDATEON, :colDATEOFF, 
        :colTOBO, :colReqType, :colReqStatus, :colCustCount 
   FROM v_customer a, custtype t " || 
        IifS(nCtrlFlags & CVIEW_Saldo, ", saldo s ", "") || "
  WHERE t.custtype = a.custtype " || 
        IifS(nCtrlFlags & CVIEW_Saldo, " AND a.rnk=s.rnk ", "")
.head 5 -  !
.head 5 +  If nCustType > 0
.head 6 -  Set strQuery = strQuery || " AND a.custtype = :nCustType" || 
    IifS(obPersons=TRUE, " and trim(sed) <> '" || sK051SPD || "'", "") || 
    IifS(obSPD=TRUE, " and trim(sed) = '" || sK051SPD || "'", "")
.head 5 +  Else If nCTypeNN > 0
.head 6 -  Set strQuery = strQuery || " AND a.custtype <> 1"
.head 5 -  Set sCustFilterTab = ""
.head 5 -  Set sAccFilter = ""
.head 5 +  If strUserCondition
.head 6 -  Set nTmp = SalStrScan(strUserCondition, '#')
.head 6 +  If nTmp >= 0
.head 7 -  Set sTmp = strUserCondition
.head 7 -  Set strUserCondition = Subs(strUserCondition, 1, nTmp)
.head 7 -  ! sAccFilter = <AccFilter>#<AccFilterTab>#<CustFilterTab>
.head 7 -  Set sAccFilter = Subs(sTmp,nTmp+2,Len(sTmp)-nTmp-1)
.head 7 -  Set nTmp = SalStrScan(sAccFilter, '#')
.head 7 +  If nTmp >= 0
.head 8 -  ! sTmp = <AccFilterTab>#<CustFilterTab>
.head 8 -  Set sTmp = Subs(sAccFilter,nTmp+2,Len(sAccFilter)-nTmp-1)
.head 8 -  Set nTmp1 = SalStrScan(sTmp, '#')
.head 8 +  If nTmp1 >= 0
.head 9 -  ! <CustFilterTab>
.head 9 -  Set sCustFilterTab = Subs(sTmp,nTmp1+2,Len(sTmp)-nTmp1-1)
.head 9 -  Set sAccFilter = Subs(sAccFilter,0,Len(sAccFilter)-Len(sCustFilterTab)-1)
.head 6 +  If strUserCondition
.head 7 -  Set strQuery = strQuery || " AND (" || strUserCondition || ")"
.head 7 -  Set bDopFilter = TRUE
.head 5 -  !
.head 5 +  If obShowClosed
.head 6 +  If NOT SalIsWindowVisible(colDATEOFF)
.head 7 -  Call SalShowWindow(colDATEOFF)
.head 5 +  Else
.head 6 +  If SalIsWindowVisible(colDATEOFF)
.head 7 -  Call SalHideWindow(colDATEOFF)
.head 6 -  Set strQuery = strQuery || " AND a.date_off IS NULL "
.head 5 -  !
.head 5 -  Set strQuery = strQuery || " ORDER BY " || sOrd
.head 5 -  !
.head 5 -  Return strQuery
.head 3 +  Function: CheckFilterSet
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If PAR_CUSTFLTR
.head 6 +  If FCust.GetFilterWhereClause(FALSE) = '' and not bDopFilter
.head 7 -  Call SalTblReset(hWndForm)
.head 7 -  ! Не задан фильтр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgFilterNotSet'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  ! nCtrlFlags - Управляющие флаги
.head 3 -  Number: nCtrlFlags
.head 3 -  ! nCType - Тип клиента:
.head 3 -  ! 0 - все клиенты
.head 3 -  ! 1 - Банк
.head 3 -  ! 2 - ЮЛ
.head 3 -  ! 3 - ФЛ
.head 3 -  ! 4 - NNдерж.
.head 3 -  ! 5 - NNторг.
.head 3 -  ! 6 - NNAll (держ.торг.)
.head 3 -  ! 9 - ФЛ-неСПД = 3
.head 3 -  ! 10- ФЛ-СПД
.head 3 -  Number: nCType
.head 3 -  ! strAddCond - Строка типа <CustFilter>#<AccFilter>#<AccFilterTab>#<CustFilterTab>
.head 3 -  ! <CustFilter>    - a.custtype=1
.head 3 -  ! <AccFilter>     - a.pap=1
.head 3 -  ! <AccFilterTab>  - 2220011
.head 3 -  ! <CustFilterTab> - 22211000
.head 3 -  ! Напр., 'a.custtype=3###22200111'
.head 3 -  String: strAddCond
.head 2 +  Window Variables
.head 3 -  : CCust
.head 4 -  Class: cABSConnect
.head 3 -  : CMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  : FCust
.head 4 -  Class: cGenFilterEx
.head 3 -  : QCust
.head 4 -  Class: cGenQuery
.head 3 -  !
.head 3 -  String: strMainSql
.head 3 -  String: strDynSql
.head 3 -  Number: nCustType
.head 3 -  String: sOrd
.head 3 -  Boolean: bDopFilter
.head 3 -  !
.head 3 -  Number: nCtrl4Dossier
.head 3 -  Number: nFocusRow
.head 3 -  Window Handle: hWndFocusCol
.head 3 -  !
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Window Handle: hColumn
.head 3 -  String: sAccFilter
.head 3 -  String: sCustFilterTab
.head 3 -  Number: nAccFlags
.head 3 -  Number: nCTypeNN
.head 3 -  Number: nChooseCustType
.head 3 -  Number: nChooseCustRezid
.head 3 -  !
.head 3 -  Number: hBtnShowKK
.head 3 -  Number: hBtnShowChange
.head 3 -  Number: hBtnExit
.head 3 -  Number: hBtns[*]
.head 3 -  Number: nChoose
.head 3 -  Boolean: bShowKK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call XConnectGetParams(CCust)
.head 4 +  If NOT CCust.Connect()
.head 5 -  Return FALSE
.head 4 -  ! Call CMenu.Init( hWndForm, 'menuCustomer', '&Контрагенты' )
.head 4 -  Call CMenu.Init(hWndForm, 'menuCustomer', CurrentLangTable.GetAtomTitle('Frm_Customer.menuCustomer.cTMenuCust'))
.head 4 -  !
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  Set bDopFilter = FALSE
.head 4 -  Set nLastSortRow = -1
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  ! Set nCTypeNN
.head 4 -  Set nCTypeNN = 0
.head 4 +  If nCType >= 4 and nCType <= 6
.head 5 -  Set nCTypeNN = nCType
.head 5 -  Set nCType = IifN(nCType=4, 3, IifN(nCType=5, 2, 0))
.head 5 +  If nCType = 0
.head 6 -  Call SalDisableWindow(obBanks)
.head 4 +  If nCType = 9
.head 5 -  Set nCType = 3
.head 4 -  ! Set nAccFlags
.head 4 -  Set nAccFlags =  AVIEW_Financial
.head 4 +  If nCTypeNN
.head 5 -  Set nAccFlags = nAccFlags | AVIEW_Linked
.head 4 +  If nCtrlFlags & CVIEW_Holding
.head 5 -  Call SalShowWindow(colRNKP)
.head 5 -  Set nAccFlags = nAccFlags | CVIEW_Holding | AVIEW_ExistOnly | AVIEW_ReadOnly
.head 4 +  Else
.head 5 -  Call SalHideWindow(colRNKP)
.head 5 +  If nCtrlFlags & AVIEW_ReadOnly
.head 6 -  Set nAccFlags = nAccFlags | AVIEW_ExistOnly | AVIEW_ReadOnly
.head 5 +  If nCtrlFlags & AVIEW_Saldo
.head 6 -  Set nAccFlags = nAccFlags | AVIEW_Saldo
.head 4 -  ! Set Print Button
.head 4 +  If nCtrlFlags & CVIEW_NoPrintTbl
.head 5 -  Call SalDisableWindow(pbPrint)
.head 4 -  ! Set Option Button 
.head 4 +  If nCType
.head 5 -  Set obAll = FALSE
.head 5 -  Call SalDisableWindow(obAll)
.head 5 +  Select Case nCType
.head 6 +  Case 1		! Banks
.head 7 -  Set obBanks = TRUE
.head 7 -  Set obPersons = FALSE
.head 7 -  Set obSPD = FALSE
.head 7 -  Set obCorporations = FALSE
.head 7 -  Call SalDisableWindow(obPersons)
.head 7 -  Call SalDisableWindow(obSPD)
.head 7 -  Call SalDisableWindow(obCorporations)
.head 7 -  Break
.head 6 +  Case 2		! Corporations
.head 7 -  Set obCorporations = TRUE
.head 7 -  Set obPersons = FALSE
.head 7 -  Set obSPD = FALSE
.head 7 -  Set obBanks = FALSE
.head 7 -  Call SalDisableWindow(obPersons)
.head 7 -  Call SalDisableWindow(obSPD)
.head 7 -  Call SalDisableWindow(obBanks)
.head 7 -  Break
.head 6 +  Case 3		! Persons-notSPD
.head 7 -  Set obPersons = TRUE
.head 7 -  Set obSPD = FALSE
.head 7 -  Set obCorporations = FALSE
.head 7 -  Set obBanks = FALSE
.head 7 -  Call SalDisableWindow(obSPD)
.head 7 -  Call SalDisableWindow(obCorporations)
.head 7 -  Call SalDisableWindow(obBanks)
.head 7 -  Break
.head 6 +  Case 10		! Persons-SPD
.head 7 -  Set obSPD = TRUE
.head 7 -  Set obPersons = FALSE
.head 7 -  Set obCorporations = FALSE
.head 7 -  Set obBanks = FALSE
.head 7 -  Call SalDisableWindow(obPersons)
.head 7 -  Call SalDisableWindow(obCorporations)
.head 7 -  Call SalDisableWindow(obBanks)
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set obBanks = TRUE
.head 7 -  Set obPersons = FALSE
.head 7 -  Set obSPD = FALSE
.head 7 -  Set obCorporations = FALSE
.head 7 -  Break
.head 4 +  Else
.head 5 -  Set obAll = TRUE
.head 5 -  Set obPersons = FALSE
.head 5 -  Set obSPD = FALSE
.head 5 -  Set obCorporations = FALSE
.head 5 -  Set obBanks = FALSE
.head 4 -  Set obShowClosed = FALSE
.head 4 -  !
.head 4 +  If PAR_HAVETOBO > 0
.head 5 -  Call SalShowWindow(colTOBO)
.head 5 -  Call SalTblSetColumnTitle(colTOBO, CurrentLangTable.GetAtomTitle('tbl_AccountsList.colTOBO'))
.head 4 -  !
.head 4 +  If PAR_BANKTYPE = 'PRVX'
.head 5 -  Call SalSetMaxDataLength(colNAME, 182)
.head 4 +  Else
.head 5 -  Call SalSetMaxDataLength(colNAME, 70)
.head 4 -  !
.head 4 +  If bPAR_CUSTCLV
.head 5 -  Call SalShowWindow(colReqStatus)
.head 5 -  Set hBtnShowKK = VisMessageLoadButton('До внесення змін', 0)
.head 5 -  Set hBtnShowChange = VisMessageLoadButton('Після внесення змін', 1)
.head 5 -  Set hBtnExit = VisMessageLoadButton('Вийти', 2)
.head 4 -  !
.head 4 -  Call FCust.Init('v_customer', 'a')
.head 4 -  Set sOrd = ' a.rnk DESC '
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 +  If SetQueryFilterEx(FCust)
.head 5 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Else
.head 5 -  Call SalPostMsg(pbExit, SAM_Click, 0, 0)
.head 3 +  On SAM_Activate
.head 4 -  Call CMenu.Enable(wParam)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set strMainSql = MakePopulateString(strAddCond)
.head 4 +  If CheckFilterSet()
.head 5 -  Call QCust.Init(T(strMainSql))
.head 5 -  !
.head 5 -  Set strDynSql = QCust.GetFullSQLStringEx(FCust)
.head 5 -  Call SalTblQueryFocus(hWndForm, nFocusRow, hWndFocusCol)
.head 5 -  Call SalTblPopulate(hWndForm, CCust.hSql(), T(strDynSql), TBL_FillNormal)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 +  If PAR_BANKTYPE = 'PRVX'
.head 6 -  Call SalTblSetColumnWidth(colNAME, 10)
.head 5 -  Set dfCustCount = SalTblColumnSum(hWndForm, SalTblQueryColumnID(colCustCount), 0, 0)
.head 5 -  Call SalTblSetFocusRow(hWndForm, nFocusRow)
.head 5 -  Call SalTblSetContext(hWndForm, nFocusRow)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If nCtrlFlags & CVIEW_Holding
.head 5 +  If colF
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
.head 4 +  If colBSNSMAN = sK051SPD
.head 5 -  Set colTYPENAME = colTYPENAME || "-" || CurrentLangTable.GetAtomTitle('frm_CustomerList.cTSPD')
.head 4 +  If bPAR_CUSTCLV
.head 5 +  If colReqType = 0
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Sky)
.head 5 +  Else If colReqType = 1
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightPeriwinkle)
.head 5 +  Else If colReqType = 2
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Salmon)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalPostMsg(pbDossier, SAM_Click, 0, 0)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colRNK), COL_GetID)
.head 5 -  Set sOrd = " a.rnk" || IifS(nSortOrder=0," desc","")
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colND), COL_GetID)
.head 5 -  Set sOrd = " a.nd" || IifS(nSortOrder=0," desc","")
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOKPO), COL_GetID)
.head 5 -  Set sOrd = " a.okpo" || IifS(nSortOrder=0," desc","")
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colTYPENAME), COL_GetID)
.head 5 -  Set sOrd = " a.custtype" || IifS(nSortOrder=0," desc","") || ", a.rnk"
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colBSNSMAN), COL_GetID)
.head 5 -  Set sOrd = " 5" || IifS(nSortOrder=0," desc","") || ", a.rnk"
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colNAME), COL_GetID)
.head 5 -  Set sOrd = " a.nmk" || IifS(nSortOrder=0," desc","")
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colDATEON), COL_GetID)
.head 5 -  Set sOrd = " a.date_on" || IifS(nSortOrder=0," desc","") || ", a.rnk"
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colDATEOFF), COL_GetID)
.head 5 -  Set sOrd = " a.date_off" || IifS(nSortOrder=0," desc","") || ", a.rnk"
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colRNKP), COL_GetID)
.head 5 -  Set sOrd = " a.rnkp" || IifS(nSortOrder=0," desc","") || ", a.rnk"
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colTOBO), COL_GetID)
.head 5 -  Set sOrd = " a.tobo" || IifS(nSortOrder=0," desc","") || ", a.rnk"
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 4 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call CMenu.ShowMenu(wParam, lParam)
.head 3 +  On UM_Print
.head 4 -  ! Список клиентов банка
.head 4 -  Call TablePrint(hWndForm, SalFmtFormatDateTime( GetBankDate(), 'dd/MM/yyyy' ) || ': ' || 
     CurrentLangTable.GetAtomTitle('frm_CustomerList.cTCustList'),
     GetPrnDir() || '/Customer.lst', '')
.head 3 +  On SAM_Destroy
.head 4 -  Call SaveInfoToLog('Выход из диалога: Контрагенты.')
.head 4 -  Call VisMessageFreeButton(hBtnShowKK)
.head 4 -  Call VisMessageFreeButton(hBtnShowChange)
.head 4 -  Call VisMessageFreeButton(hBtnExit)
.head 4 +  If CCust.IsConnected()
.head 5 -  Call CCust.Disconnect()
.head 4 -  Call CMenu.Kill()
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 +  Dialog Box: Dlg_ChooseCustomer
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Поиск клиента
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.3"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Введите данные для поиска:
.head 4 -  Resource Id: 59753
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.1"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgInputData
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.15"
.head 5 -  Width:  6.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.95"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: ОКПО
.head 4 -  Resource Id: 59751
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.4"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.35"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: наименование
.head 4 -  Resource Id: 59752
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.7"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.65"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.2"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tblCustomer.colRnk = NUMBER_Null and tblCustomer.colClientId
.head 7 -  Call CreateCustomer(tblCustomer.colClientId, tblCustomer.colRnk)
.head 6 +  If tblCustomer.colRnk
.head 7 -  Set nRnk = tblCustomer.colRnk
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.367"
.head 5 -  Top:    1.2"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull(dfOkpo)
.head 7 -  ! Не заполнен реквизит <ОКПО>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgAttrNotSet') || "<" || 
     CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.bgOkpo') || ">", 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Call SalSetFocus(dfOkpo)
.head 7 -  Return TRUE
.head 6 +  If SalIsNull(dfNmk)
.head 7 -  ! Не заполнен реквизит <Наименование>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgAttrNotSet') || "<" || 
     CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.bgNmk') || ">", 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Call SalSetFocus(dfNmk)
.head 7 -  Return TRUE
.head 6 -  Call SalSendMsg(tblCustomer, UM_Populate, 0, 0)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.6"
.head 5 -  Top:    1.2"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Child Table: tblCustomer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    1.75"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.2"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRnk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: РНК
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNmk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPasspSer
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Серия
паспорта
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPasspNum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
паспорта
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBirthDay
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
рождения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colClientId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: РНК
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set nCount = 0
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"select rnk, nmk, mfo, passp_ser, passp_num, bday, client_id
   into :colRnk, :colNmk, :colMfo, :colPasspSer, :colPasspNum, :colBirthDay, :colClientId
   from v_choice_customer
  where okpo = :dfOkpo
    and upper(nmk) like '%'||upper(:dfNmk)||'%' 
    and custtype = :cType
    and rezid = :nRezid
  order by nmk, rnk", TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 +  If nCount = 0
.head 7 -  ! Клиент с указанными данными не найден!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgCustomerNotFound'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Call SalDisableWindow(pbOk)
.head 6 +  Else
.head 7 -  Call SalSetFocus(hWndForm)
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 7 -  Call SalEnableWindow(pbOk)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set nCount = nCount + 1
.head 6 +  If colClientId
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Sky)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 +  Functions
.head 3 +  Function: CreateCustomer
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nClientId
.head 5 -  Receive Number: nOutRnk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: pRnk
.head 4 +  Actions
.head 5 -  ! Выбранный клиент зарегистрирован в другой системе. Синхронизировать данные клиента?
.head 5 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgClientFromOutSystem') || PutCrLf() ||
   CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgSyncClient'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo) = IDNO
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set pRnk = nOutRnk
.head 5 +  If not SqlPLSQLCommand(hSql(), "bars_client.create_outcustomer(nClientId, pRnk)")
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Set nOutRnk = NUMBER_Null
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox('ERROR!!!', 'Error', 0)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommitEx(hSql(), "CUST. Зарегистрирован новый клиент РНК " || Str(nOutRnk))
.head 5 -  Set nOutRnk = pRnk
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  ! Клиенту банка colNmk присвоен регистрационный номер: nCustomerRN. Проверьте параметры клиента.
.head 5 -  Call MessageInfo(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgRNK1') || ' ' || tblCustomer.colNmk || ' ' ||
     CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgRNK2') || ' ' || Str(nOutRnk) || PutCrLf() || 
     CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTMsgCheckClientParams'))
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  ! cType -тип клиента:
.head 3 -  ! 1 - Банк 
.head 3 -  ! 2 - ЮЛ
.head 3 -  ! 9 - ФЛ неСПД
.head 3 -  ! 10- ФЛ СПД
.head 3 -  Number: cType
.head 3 -  ! nRezid - резидентность:
.head 3 -  ! 1 - резидент
.head 3 -  ! 2 - нерезидент
.head 3 -  Number: nRezid
.head 3 -  Receive Number: nRnk
.head 2 +  Window Variables
.head 3 -  Number: nCount
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalDisableWindow(pbOk)
.head 4 +  Select Case cType
.head 5 +  Case 1
.head 6 -  Call SalHideWindow(tblCustomer.colPasspSer)
.head 6 -  Call SalHideWindow(tblCustomer.colPasspNum)
.head 6 -  Call SalHideWindow(tblCustomer.colBirthDay)
.head 6 -  Break
.head 5 +  Case 9
.head 6 -  Call SalHideWindow(tblCustomer.colMfo)
.head 6 -  Call SalSetWindowLabelText(bgNmk, CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.bgFio'))
.head 6 -  Break
.head 5 +  Case 10
.head 6 -  Call SalHideWindow(tblCustomer.colMfo)
.head 6 -  Call SalSetWindowLabelText(bgNmk, CurrentLangTable.GetAtomTitle('Dlg_ChooseCustomer.bgFio'))
.head 6 -  Break
.head 5 +  Default
.head 6 -  Call SalHideWindow(tblCustomer.colPasspSer)
.head 6 -  Call SalHideWindow(tblCustomer.colPasspNum)
.head 6 -  Call SalHideWindow(tblCustomer.colBirthDay)
.head 6 -  Call SalHideWindow(tblCustomer.colMfo)
.head 6 -  Break
.head 1 +  Dialog Box: dlg_ChooseCustType
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выберите тип контрагента
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.65"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбор типа контрагента
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picPerson
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.1"
.head 5 -  Width:  0.486"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.344"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\Custpers.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Highlight Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picSPD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.45"
.head 5 -  Width:  0.486"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.344"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\USER.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Highlight Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picCorporation
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.8"
.head 5 -  Width:  0.486"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.344"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Highlight Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picBanks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    1.15"
.head 5 -  Width:  0.486"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.344"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\Custbank.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Highlight Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Radio Button: rbPerson
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Физическое лицо
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    0.2"
.head 5 -  Width:  3.071"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCustType = 9
.head 6 -  Call SetRezid()
.head 3 +  Radio Button: rbSPD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Физическое лицо-СПД
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    0.55"
.head 5 -  Width:  3.071"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCustType = 10
.head 6 -  Call SetRezid()
.head 3 +  Radio Button: rbCorporation
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Юридическое лицо
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    0.9"
.head 5 -  Width:  3.071"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCustType = 2
.head 6 -  Call SetRezid()
.head 3 +  Radio Button: rbBank
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Банк
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    1.25"
.head 5 -  Width:  3.071"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCustType = 1
.head 6 -  Call SetRezid()
.head 3 -  Line
.head 4 -  Resource Id: 58514
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  1.6"
.head 5 -  End X:  6.0"
.head 5 -  End Y:  1.6"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Picture: picRezid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    1.7"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.345"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \bars98\RESOURCE\BMP\ukr_flag.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Highlight Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picNRezid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    2.05"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.345"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \bars98\RESOURCE\BMP\neukr_flag.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Highlight Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Radio Button: rbRezid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Резидент
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    1.8"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCustRezid = 1
.head 3 +  Radio Button: rbNRezid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нерезидент
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    2.15"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nCustRezid = 2
.head 3 -  Line
.head 4 -  Resource Id: 58515
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  2.5"
.head 5 -  End X:  6.0"
.head 5 -  End Y:  2.5"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Pushbutton: pbOpen
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Открыть
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    2.7"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.2"
.head 5 -  Top:    2.7"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 +  Functions
.head 3 +  Function: SetRezid
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalEnableWindow(rbNRezid)
.head 5 +  If rbSPD
.head 6 -  Set rbRezid = TRUE
.head 6 -  Set nCustRezid = 1
.head 6 -  Call SalDisableWindow(rbNRezid)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Boolean: bParNN
.head 3 -  Receive Number: nCustType
.head 3 -  Receive Number: nCustRezid
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_ChooseCustType.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If nCustType
.head 5 -  Call SalDisableWindow(rbPerson)
.head 5 -  Call SalDisableWindow(rbSPD)
.head 5 -  Call SalDisableWindow(rbCorporation)
.head 5 -  Call SalDisableWindow(rbBank)
.head 5 +  Select Case nCustType
.head 6 +  Case 1
.head 7 -  Set rbBank = TRUE
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set rbCorporation = TRUE
.head 7 -  Break
.head 6 +  Case 9
.head 7 -  Set rbPerson = TRUE
.head 7 -  Break
.head 6 +  Case 10
.head 7 -  Set rbSPD = TRUE
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set nCustType = 9
.head 7 -  Set rbPerson = TRUE
.head 7 -  Break
.head 4 +  Else
.head 5 -  Set nCustType = 9
.head 4 -  Call SetRezid()
.head 4 -  Set nCustRezid = 1
.head 4 +  If bParNN
.head 5 -  Call SalHideWindow(picSPD)
.head 5 -  Call SalHideWindow(rbSPD)
.head 5 -  Call SalHideWindow(picBanks)
.head 5 -  Call SalHideWindow(rbBank)
.head 5 -  Call SalDisableWindow(rbRezid)
.head 5 -  Call SalHideWindow(picNRezid)
.head 5 -  Call SalHideWindow(rbNRezid)
.head 1 -  ! Карточка клиента
.head 1 +  Form Window: Frm_Customer
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Карточка клиента
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.5"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.45"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nCtrlFlags & CVIEW_ApproveKK
.head 8 -  Set strTip = 'Підтвердити зміни КК'
.head 7 +  Else
.head 8 +  If nCustomerRN = 0
.head 9 -  ! Зарегистрировать клиента
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipOpen')
.head 8 +  Else
.head 9 -  ! Сохранить
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipSave')
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen()
.head 8 +  If nCtrlFlags & CVIEW_ApproveKK
.head 9 +  If ApproveKK()
.head 10 -  Call SalMessageBox('Зміни по клієнту ' || Str(nCustomerRN) || ' підтверджено', 'Інформація', MB_IconAsterisk | MB_Ok)
.head 10 -  Set fParentRefresh = TRUE
.head 10 -  Call SalDestroyWindow(hWndForm)
.head 8 +  Else
.head 9 +  If SaveCustomerData()
.head 10 -  Set fParentRefresh = TRUE
.head 10 -  Set fIsEdit = FALSE
.head 10 -  Call SalDisableWindow(hWndItem)
.head 10 +  If cTabCustGeneral.EditMode != TAB_Hide
.head 11 -  Call SalEnableWindow(pbPrint)
.head 11 -  Call SalEnableWindow(pbClose)
.head 10 +  If bPAR_CUSTCLV
.head 11 -  Call SalDestroyWindow(hWndForm)
.head 7 +  Else
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  ! Банковский День ЗАКРЫТ!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTBankDayClose'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 4 +  Pushbutton: pbClose
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nCtrlFlags & CVIEW_ApproveKK
.head 8 -  Set strTip = 'Відхилити зміни КК'
.head 7 +  Else
.head 8 -  ! Закрыть клиента
.head 8 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipClose')
.head 8 +  If nCtrlFlags & CVIEW_ReadOnly
.head 9 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen()
.head 8 +  If nCtrlFlags & CVIEW_ApproveKK
.head 9 +  If RejectKK()
.head 10 -  Call SalMessageBox('Зміни по клієнту ' || Str(nCustomerRN) || ' відхилено', 'Інформація', MB_IconAsterisk | MB_Ok)
.head 10 -  Set fParentRefresh = TRUE
.head 10 -  Call SalDestroyWindow(hWndForm)
.head 8 +  Else
.head 9 +  If CloseCustomer(hWndCust.AbstractCustomer..getRnk(), hWndCust.AbstractCustomer..getNmk())
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Set cTabCustGeneral.hWnd.Dlg_CustGeneral.dfDateOff = hWndCust.AbstractCustomer..getDateOff()
.head 10 -  Call SalDisableWindow(pbSave)
.head 10 -  Call SalDisableWindow(pbClose)
.head 10 -  Call SalDisableWindow(pbAccounts)
.head 10 +  If NOT (nCtrlFlags & CVIEW_DROnly)
.head 11 +  If cTabCustGeneral.EditMode = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustGeneral.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustNI.EditMode      = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustNI.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustEN.EditMode      = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustEN.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustInfo.EditMode    = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustInfo.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustOwn.EditMode     = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustOwn.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustDR.EditMode      = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustDR.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustRel.EditMode     = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustRel.hWnd, SAM_DoInit, 0, 0)
.head 11 +  If cTabCustNNCard.EditMode  = TAB_Edit
.head 12 -  Call SalSendMsg(cTabCustNNCard.hWnd, SAM_DoInit, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать справки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 -  Call PrintCustomerData()
.head 4 -  Line
.head 5 -  Resource Id: 40161
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.583"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.583"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbDeals
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\OPEN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipDeals')
.head 7 +  If nCtrlFlags & CVIEW_ReadOnly or nCtrlFlags & CVIEW_Closed or nCustomerRN = 0
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditFFiltered("CUSTOMER_DEAL", 1, "rnk=" || Str(nCustomerRN))
.head 4 +  Pushbutton: pbAccounts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Счета
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipAccounts')
.head 7 +  If NOT ( nCtrlFlags & CVIEW_Accounts )
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Set nAccFlags =  AVIEW_Financial
.head 7 +  If nCtrlFlags & CVIEW_Holding
.head 8 -  Set nAccFlags = nAccFlags | CVIEW_Holding | AVIEW_ExistOnly | AVIEW_ReadOnly
.head 7 +  Else
.head 8 +  If nCtrlFlags & AVIEW_ReadOnly
.head 9 -  Set nAccFlags = nAccFlags | AVIEW_ExistOnly | AVIEW_ReadOnly
.head 8 +  If nCtrlFlags & AVIEW_Saldo
.head 9 -  Set nAccFlags = nAccFlags | AVIEW_Saldo
.head 7 -  Call ShowAccListNN(nCustomerRN, AVIEW_CUST, nAccFlags, sAccFilter, bNN)
.head 4 +  Pushbutton: pb_T8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Фінансова звітність та Аналіз фінінсового стану
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipT8')
.head 6 +  On SAM_Click
.head 7 +  If not bFIN_2
.head 8 -  Call MessageError("Не установлено модуль " || PutCrLf() || strTip)
.head 7 +  Else
.head 8 +  If nCType = 2 OR nCType = 3
.head 9 +  If Val(sOKPO) != NUMBER_Null AND Val(sOKPO) != 0
.head 10 -  Call DEPO( hWndMDI, IifN (nCtrlFlags & CVIEW_ReadOnly , -1, 0), Val(sOKPO) )
.head 4 -  Line
.head 5 -  Resource Id: 44915
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.15"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  3.15"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 49627
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.883"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  3.883"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipExit')
.head 6 +  On SAM_Click
.head 7 +  If fIsEdit
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgNotSaveData') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('cTMsgIgnoreAndExit'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  Call SalDestroyWindow(hWndForm)
.head 7 +  Else
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 +  Pushbutton: pbCustSign
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbEdit
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.017"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Подписи и печати
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipCustSign')
.head 6 +  On SAM_Click
.head 7 +  If SalModalDialog(dlgEditCustSign, hWndForm,  NOT (nCtrlFlags & CVIEW_ReadOnly), nCustSignId)
.head 8 -  Set cTabCustGeneral.isEdited = TRUE
.head 8 -  Call setEdited()
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000100
0020: 0000546162426F74 746F6D4D61726769 6E00020030000054 616250616765436F
0040: 756E740002003100 005461624C616265 6C73000100000054 61624E616D657300
0060: 0100000054616252 696768744D617267 696E000200300000 5461624472617753
0080: 74796C65000B0057 696E39355374796C 650000546162466F 726D506167657300
00A0: 0100000054616254 6F704D617267696E 0002003000005461 624F7269656E7461
00C0: 74696F6E00010000 0000000000000000 0000000000000000 00000000000000
.enddata
.data CLASSPROPSSIZE
0000: DF00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 +  If fDestroy
.head 7 -  Return FALSE
.head 6 -  Set nTabNum = 0
.head 6 -  ! Режим "Показывать только Доп. рекв"
.head 6 +  If nCtrlFlags & CVIEW_DROnly
.head 7 -  Call createTab(cTabCustDR, FALSE)
.head 6 -  ! NN: General + Own + DR + NNCard
.head 6 +  Else If bNN
.head 7 -  ! General
.head 7 -  Call createTab(cTabCustGeneral, FALSE)
.head 7 -  ! Own - bank/corp/person
.head 7 -  Call createTab(cTabCustOwn, FALSE)
.head 7 -  ! DR
.head 7 -  Call createTab(cTabCustDR, FALSE)
.head 7 -  ! NNCard - при регистрация нового клиента закрываем для редактирования
.head 7 -  Call createTab(cTabCustNNCard, IifN(nCustomerRN=0, TRUE, FALSE))
.head 6 -  ! General + NI + EN + Own + Info + DR + Rel
.head 6 +  Else
.head 7 -  ! закладку показывать/нет смотрим по фильтру (фильтр определяется в параметрах + на SAM_Create)
.head 7 -  ! General
.head 7 -  Call createTab(cTabCustGeneral, FALSE)
.head 7 -  ! NI
.head 7 -  Call createTab(cTabCustNI, FALSE)
.head 7 -  ! EN
.head 7 -  Call createTab(cTabCustEN, FALSE)
.head 7 -  ! Own - bank/corp/person
.head 7 -  Call createTab(cTabCustOwn, FALSE)
.head 7 -  ! Info
.head 7 -  Call createTab(cTabCustInfo, FALSE)
.head 7 -  ! DR
.head 7 -  Call createTab(cTabCustDR, FALSE)
.head 7 -  ! Rel - не показываем для нового клиента
.head 7 -  Call createTab(cTabCustRel, IifN(nCustomerRN=0, TRUE, FALSE))
.head 7 -  ! Risk
.head 7 +  If PAR_CUSTRISK
.head 8 -  Call createTab(cTabCustRisk, FALSE)
.head 7 -  ! Rept
.head 7 +  If PAR_CUSTREPT
.head 8 -  Call createTab(cTabCustRept, FALSE)
.head 7 -  ! Category
.head 7 +  If PAR_CUSTCTG and nCType = 2
.head 8 -  Call createTab(cTabCustCtg, FALSE)
.head 6 -  ! Удаляем последнюю пустую закладку
.head 6 -  Call picTabs.Delete(nTabNum, TRUE)
.head 6 -  ! Инициализация закладок
.head 6 -  Call picTabs.InitializeFormPages(
     SalNumberToStrX(nCustomerRN,0)|| ';' ||
     SalNumberToStrX(nCType,0)     || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) || ';' ||
     Str(SalWindowHandleToNumber(hWndCust)))
.head 6 +  If PAR_CUSTRISK and cTabCustRisk.EditMode != TAB_Hide
.head 7 -  Set sCriteriaCode = Criteria_CustRisk
.head 7 -  Call SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_Insert, 0, 0)
.head 6 +  If PAR_CUSTREPT and cTabCustRept.EditMode != TAB_Hide
.head 7 -  Set sCriteriaCode = Criteria_CustRept
.head 7 -  Call SalSendMsg(picTabs.Items[cTabCustRept.TabNum].m_hWndPage, UM_Insert, 0, 0)
.head 6 +  If PAR_CUSTCTG and cTabCustCtg.EditMode != TAB_Hide
.head 7 -  Set sCriteriaCode = Criteria_CustCtg
.head 7 -  Call SalSendMsg(picTabs.Items[cTabCustCtg.TabNum].m_hWndPage, UM_Insert, 0, 0)
.head 6 -  ! Показываем первую закладку
.head 6 -  Call picTabs.BringToTop(nTabCurrent, TRUE)
.head 6 -  Set fCustActivate = TRUE
.head 5 +  On TABSM_TabActivateStart
.head 6 +  If fCustActivate
.head 7 -  ! Обрабатываем предыдущую закладку
.head 7 -  Call GetName(nPrevActivTab, sGetName)
.head 7 +  If sGetName = 'CustRisk'
.head 8 -  Set sCriteriaCode = Criteria_CustRisk
.head 8 -  Call SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_Update, 0, 0)
.head 7 +  If sGetName = 'CustRept'
.head 8 -  Set sCriteriaCode = Criteria_CustRept
.head 8 -  Call SalSendMsg(picTabs.Items[cTabCustRept.TabNum].m_hWndPage, UM_Update, 0, 0)
.head 7 +  If sGetName = 'CustCtg'
.head 8 -  Set sCriteriaCode = Criteria_CustCtg
.head 8 -  Call SalSendMsg(picTabs.Items[cTabCustCtg.TabNum].m_hWndPage, UM_Update, 0, 0)
.head 7 -  ! Активная закладка
.head 7 -  Set nActivTab = GetTop()
.head 7 -  Call GetName(wParam, sGetName)
.head 7 +  If sGetName = 'CustBank'
.head 8 -  Call SalSendMsg(cTabCustOwn.hWnd, SAM_User, 0, 0)
.head 7 +  If sGetName = 'CustCorp'
.head 8 -  Call SalSendMsg(cTabCustOwn.hWnd, SAM_User, 0, 0)
.head 7 +  If sGetName = 'CustPerson'
.head 8 -  Call SalSendMsg(cTabCustOwn.hWnd, SAM_User, 0, 0)
.head 7 +  If sGetName = 'CustInfo'
.head 8 -  Call SalSendMsg(cTabCustInfo.hWnd, SAM_User, 0, 0)
.head 7 +  If sGetName = 'CustRisk'
.head 8 -  Set sCriteriaCode = Criteria_CustRisk
.head 8 -  Call SalSendMsg(picTabs.Items[nActivTab].m_hWndPage, UM_Insert, 0, 0)
.head 7 +  If sGetName = 'CustRept'
.head 8 -  Set sCriteriaCode = Criteria_CustRept
.head 8 -  Call SalSendMsg(picTabs.Items[nActivTab].m_hWndPage, UM_Insert, 0, 0)
.head 7 +  If sGetName = 'CustCtg'
.head 8 -  Set sCriteriaCode = Criteria_CustCtg
.head 8 -  Call SalSendMsg(picTabs.Items[nActivTab].m_hWndPage, UM_Insert, 0, 0)
.head 7 -  Call GetLabel(wParam, sGetName)
.head 7 -  Call SaveInfoToLog("CUSTOMER [" || Str(nCustomerRN) || "]. Активирована закладка '" || sGetName || "'")
.head 7 -  ! Запоминаем активную закладку
.head 7 -  Set nPrevActivTab = nActivTab
.head 2 +  Functions
.head 3 +  Function: createTabOld
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : CustTab
.head 6 -  Class: cCustTab
.head 5 -  Boolean: bDisableTab	! Насильно закрыть закладку для редактирования (напр., при рег. нового клиента)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call picTabs.Insert(nTabNum,TRUE)
.head 5 -  Call picTabs.SetLabel(nTabNum, CustTab.Label, TRUE)
.head 5 -  Call picTabs.SetName(nTabNum, CustTab.Name)
.head 5 +  If bDisableTab
.head 6 -  Call picTabs.Enable(nTabNum, FALSE)
.head 5 +  Else
.head 6 +  If CustTab.EditMode != TAB_Hide
.head 7 -  Call picTabs.AddPage(CustTab.Name, CustTab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(CustTab.EditMode=TAB_Hide, FALSE, TRUE))
.head 5 -  Call picTabs.CreatePage(CustTab.Name)
.head 5 -  Set CustTab.TabNum = nTabNum
.head 5 -  Set nTabNum = nTabNum + 1
.head 5 -  Return TRUE
.head 3 +  Function: createTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : CustTab
.head 6 -  Class: cCustTab
.head 5 -  Boolean: bDisableTab	! Насильно закрыть закладку для редактирования (напр., при рег. нового клиента)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call picTabs.Insert(nTabNum,TRUE)
.head 5 -  Call picTabs.SetLabel(nTabNum, CustTab.Label, TRUE)
.head 5 -  Call picTabs.SetName(nTabNum, CustTab.Name)
.head 5 +  ! If bDisableTab
.head 6 -  Call picTabs.Enable(nTabNum, FALSE)
.head 5 +  ! Else
.head 6 +  If CustTab.EditMode != TAB_Hide
.head 7 -  Call picTabs.AddPage(CustTab.Name, CustTab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(CustTab.EditMode=TAB_Hide, FALSE, TRUE))
.head 5 -  !
.head 5 -  Call picTabs.AddPage(CustTab.Name, CustTab.DlgName, hWndNULL)
.head 5 -  Call picTabs.Enable(nTabNum, IifN(CustTab.EditMode=TAB_Hide or bDisableTab=TRUE, FALSE, TRUE))
.head 5 -  !
.head 5 -  Call picTabs.CreatePage(CustTab.Name)
.head 5 -  Set CustTab.TabNum = nTabNum
.head 5 -  Set nTabNum = nTabNum + 1
.head 5 -  Return TRUE
.head 3 +  Function: linkTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : CustTab
.head 6 -  Class: cCustTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If CustTab.DlgName
.head 6 -  Call picTabs.AddPage(CustTab.Name, CustTab.DlgName, hWndNULL)
.head 5 -  Return TRUE
.head 3 +  Function: InitCustTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Label
.head 5 -  Set cTabCustGeneral.Label = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustGeneral') || ' '
.head 5 -  Set cTabCustNI.Label      = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustNI') || ' '
.head 5 -  Set cTabCustEN.Label      = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustEN') || ' '
.head 5 -  Set cTabCustOwn.Label     = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustOwn') || ' '
.head 5 -  Set cTabCustInfo.Label    = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustInfo') || ' '
.head 5 -  Set cTabCustDR.Label      = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustDR') || ' '
.head 5 -  Set cTabCustRel.Label     = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustRel') || ' '
.head 5 -  Set cTabCustNNCard.Label  = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustCard') || ' '
.head 5 -  Set cTabCustRisk.Label    = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustRisk') || ' '
.head 5 -  Set cTabCustRept.Label    = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustRept') || ' '
.head 5 -  Set cTabCustCtg.Label     = ' ' || CurrentLangTable.GetAtomTitle('Frm_Customer.cTabCustCtg') || ' '
.head 5 -  ! Name
.head 5 -  Set cTabCustGeneral.Name = 'CustGeneral'
.head 5 -  Set cTabCustNI.Name      = 'CustNI'
.head 5 -  Set cTabCustEN.Name      = 'CustEN'
.head 5 -  Set cTabCustOwn.Name     = IifS(nCType=1, 'CustBank', IifS(nCType=2, 'CustCorp', 'CustPerson'))
.head 5 -  Set cTabCustInfo.Name    = 'CustInfo'
.head 5 -  Set cTabCustDR.Name      = 'CustDR'
.head 5 -  Set cTabCustRel.Name     = 'CustRel'
.head 5 -  Set cTabCustNNCard.Name  = 'CustCard'
.head 5 -  Set cTabCustRisk.Name    = 'CustRisk'
.head 5 -  Set cTabCustRept.Name    = 'CustRept'
.head 5 -  Set cTabCustCtg.Name     = 'CustCtg'
.head 5 -  ! DlgName
.head 5 -  Set cTabCustGeneral.DlgName = 'Dlg_CustGeneral'
.head 5 -  Set cTabCustNI.DlgName      = 'Dlg_CustNI'
.head 5 -  Set cTabCustEN.DlgName      = 'Dlg_CustEN'
.head 5 -  Set cTabCustOwn.DlgName     = IifS(nCType=1, 'Dlg_CustBank', IifS(nCType=2, 'Dlg_CustCorp', 'Dlg_CustPerson'))
.head 5 -  Set cTabCustInfo.DlgName    = 'Dlg_CustInfo'
.head 5 -  ! Set cTabCustDR.DlgName    = 'Dlg_CustDR'
.head 5 -  Set sCustomerFieldCType = "nvl(" || IifS(nCType=1, "b", IifS(nCType=2, IifS(nCRezid=1,"u","u_nrez"), IifS(nCRezid=1,IifS(bPersonSPD=TRUE,"f_spd","f"),"f_nrez"))) || ",0)"
.head 5 -  Call SqlPrepareAndExecute(hSql(),
"select count(unique f.code)
   into :nCustDRTab
   from customer_field f, customer_field_codes s
  where f.code = s.code and " || sCustomerFieldCType || " > 0")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! ! если все ДР относятся к одному модулю, населяем одну таблицу
.head 5 +  If nCustDRTab = 1
.head 6 -  Set cTabCustDR.DlgName = 'Dlg_CustDR'
.head 5 -  ! ! иначе разбиваем по закладкам
.head 5 +  Else
.head 6 -  Set cTabCustDR.DlgName = 'Dlg_CustDRTab'
.head 5 -  Set cTabCustRel.DlgName    = 'Dlg_CustRel'
.head 5 -  Set cTabCustNNCard.DlgName = 'Dlg_CustNNCard'
.head 5 -  Set cTabCustRisk.DlgName   = 'Dlg_CustCriteria'
.head 5 -  Set cTabCustRept.DlgName   = 'Dlg_CustCriteria'
.head 5 -  Set cTabCustCtg.DlgName    = 'Dlg_CustCriteria'
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: SetCustTabEditMode
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nSetValue
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set cTabCustGeneral.EditMode = nSetValue
.head 5 -  Set cTabCustNI.EditMode      = nSetValue
.head 5 -  Set cTabCustEN.EditMode      = nSetValue
.head 5 -  Set cTabCustOwn.EditMode     = nSetValue
.head 5 -  Set cTabCustInfo.EditMode    = nSetValue
.head 5 -  Set cTabCustDR.EditMode      = nSetValue
.head 5 -  Set cTabCustRel.EditMode     = nSetValue
.head 5 -  Set cTabCustNNCard.EditMode  = nSetValue
.head 5 -  Set cTabCustRisk.EditMode    = nSetValue
.head 5 -  Set cTabCustRept.EditMode    = nSetValue
.head 5 -  Set cTabCustCtg.EditMode     = nSetValue
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: InitCustomerData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT hWndCust.AbstractCustomer..initCustomerAddress(0, bShowKK, bPAR_CUSTCLV)
.head 6 -  Return FALSE
.head 5 +  If NOT hWndCust.AbstractCustomer..populateCustomerAddress()
.head 6 -  Return FALSE
.head 5 +  If PAR_ORGTYPE != 'KAZNA'
.head 6 +  If NOT hWndCust.AbstractCustomer..initCorpAcc(0, nCType, bShowKK)
.head 7 -  Return FALSE
.head 6 +  If NOT hWndCust.AbstractCustomer..initCustomerElement(0, nCType, bShowKK, bPAR_CUSTCLV)
.head 7 -  Return FALSE
.head 6 +  If NOT hWndCust.AbstractCustomer..populateCustomerElement()
.head 7 -  Return FALSE
.head 6 +  If PAR_CUSTRISK
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerRisk(0, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerRisk()
.head 8 -  Return FALSE
.head 6 +  If PAR_CUSTREPT
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerRept(0, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerRept()
.head 8 -  Return FALSE
.head 6 +  If PAR_CUSTCTG
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerCategory(0, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerCategory()
.head 8 -  Return FALSE
.head 5 -  Set nCustSignId = NUMBER_Null
.head 5 -  Return TRUE
.head 3 +  Function: ReadCustomerData
.head 4 -  Description: Вычитывает реквизиты клиента
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sName
.head 5 -  String: sOkpo
.head 4 +  Actions
.head 5 -  ! Режим "Показывать только Доп. рекв"
.head 5 +  If nCtrlFlags & CVIEW_DROnly
.head 6 +  If NOT hWndCust.AbstractCustomer..initCustomerElement(nCustomerRN, nCType, bShowKK, bPAR_CUSTCLV)
.head 7 -  Return FALSE
.head 6 +  If NOT hWndCust.AbstractCustomer..populateCustomerElement()
.head 7 -  Return FALSE
.head 5 -  ! NN: General + Own + DR + NNCard
.head 5 +  Else If bNN
.head 6 -  ! General
.head 6 +  If NOT hWndCust.AbstractCustomer..populateCustomerAttribute()
.head 7 -  Return FALSE
.head 6 -  ! Own
.head 6 +  If NOT hWndCust.AbstractCustomer..populateOwnAttribute()
.head 7 -  Return FALSE
.head 6 -  ! DR
.head 6 +  If NOT hWndCust.AbstractCustomer..initCustomerElement(nCustomerRN, nCType, bShowKK, bPAR_CUSTCLV)
.head 7 -  Return FALSE
.head 6 +  If NOT hWndCust.AbstractCustomer..populateCustomerElement()
.head 7 -  Return FALSE
.head 5 -  ! General + NI + EN + Own + Info + DR + Rel
.head 5 +  Else
.head 6 -  ! General + NI + EN + Info
.head 6 +  If cTabCustGeneral.EditMode != TAB_Hide
or cTabCustNI.EditMode      != TAB_Hide
or cTabCustEN.EditMode      != TAB_Hide
or cTabCustInfo.EditMode    != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerAttribute()
.head 8 -  Return FALSE
.head 7 -  ! -- PRAVEX --
.head 7 +  If PAR_BANKTYPE = 'PRVX' and nCType = 2
.head 8 -  Call SqlPrepareAndExecute(hSql(), "select nmk into :sCorpNmk from corps where rnk=:nCustomerRN")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If sCorpNmk
.head 9 -  Call hWndCust.AbstractCustomer..setNmk(sCorpNmk)
.head 7 -  ! Fio+Adr
.head 7 +  If cTabCustGeneral.EditMode != TAB_Hide AND (nCType = 2 OR nCType = 3)
.head 8 +  If nCType = 3
.head 9 +  If NOT SqlPrepareAndExecute(hSql(), 
"SELECT substr(min(decode(tag, 'SN_LN', value, '')),1,100), 
        substr(min(decode(tag, 'SN_FN', value, '')),1,100), 
        substr(min(decode(tag, 'SN_MN', value, '')),1,100), 
        substr(min(decode(tag, 'SN_4N', value, '')),1,100)
   INTO :sNmkF, :sNmkI, :sNmkO, :sNmk4
   FROM customerw 
  WHERE rnk=:nCustomerRN 
    AND tag in ('SN_LN', 'SN_FN', 'SN_MN', 'SN_4N')")
.head 10 -  Return FALSE
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If nCType != 1 and NOT isNBU
.head 9 +  ! If NOT SqlPrepareAndExecute(hSql(), 
"SELECT substr(min(decode(tag, 'FGIDX', value, '')),1,20), 
        substr(min(decode(tag, 'FGOBL', value, '')),1,30), 
        substr(min(decode(tag, 'FGDST', value, '')),1,30), 
        substr(min(decode(tag, 'FGTWN', value, '')),1,60), 
        substr(min(decode(tag, 'FGADR', value, '')),1,100) 
   INTO :sIdx, :sObl, :sDst, :sTwn, :sAdr 
   FROM customerw 
  WHERE rnk=:nCustomerRN 
    AND tag in ('FGIDX', 'FGOBL', 'FGDST', 'FGTWN', 'FGADR')")
.head 10 -  Return FALSE
.head 9 -  ! Call SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If NOT hWndCust.AbstractCustomer..initCustomerAddress(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 10 -  Return FALSE
.head 9 +  If NOT hWndCust.AbstractCustomer..populateCustomerAddress()
.head 10 -  Return FALSE
.head 7 -  ! NI
.head 7 +  If cTabCustNI.EditMode != TAB_Edit
.head 8 -  Call hWndCust.AbstractCustomer..setUseNI(FALSE)
.head 7 -  ! EN
.head 7 +  If cTabCustEN.EditMode != TAB_Edit
.head 8 -  Call hWndCust.AbstractCustomer..setUseEN(FALSE)
.head 7 -  Set bPersonSPD = IifN(hWndCust.AbstractCustomer..getK050()=sK050SPD,TRUE,FALSE)
.head 7 -  ! Info
.head 7 +  If cTabCustInfo.EditMode != TAB_Hide
.head 8 +  If NOT hWndCust.AbstractCustomer..populateCustomerDopInfo()
.head 9 -  Return FALSE
.head 8 -  ! Для ПРАВЭКСа для физ.лиц-СПД читаем счета в других банках
.head 8 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD
.head 9 +  If NOT hWndCust.AbstractCustomer..initCorpAcc(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 10 -  Return FALSE
.head 9 +  If NOT hWndCust.AbstractCustomer..populateCorpAcc()
.head 10 -  Return FALSE
.head 6 -  ! Own
.head 6 +  If cTabCustOwn.EditMode != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..populateOwnAttribute()
.head 8 -  Return FALSE
.head 7 -  Set nCustSignId = hWndCust.AbstractCustomer..getSealId()
.head 7 +  If nCType = 3
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"SELECT substr(min(value),1,20)
   INTO :sPhoneMob
   FROM " || IifS(bShowKK=TRUE, "customerw", "clv_customerw") || "
  WHERE rnk = :nCustomerRN 
    AND tag = 'MPNO '")
.head 9 -  Return FALSE
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! DR
.head 6 +  If cTabCustDR.EditMode != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerElement(nCustomerRN, nCType, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerElement()
.head 8 -  Return FALSE
.head 6 -  ! Rel
.head 6 +  If cTabCustRel.EditMode != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerRel(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerRel()
.head 8 -  Return FALSE
.head 6 -  ! Risk
.head 6 +  If PAR_CUSTRISK and cTabCustRisk.EditMode != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerRisk(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerRisk()
.head 8 -  Return FALSE
.head 6 -  ! Rept
.head 6 +  If PAR_CUSTREPT and cTabCustRisk.EditMode != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerRept(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerRept()
.head 8 -  Return FALSE
.head 6 -  ! Category
.head 6 +  If PAR_CUSTCTG and cTabCustCtg.EditMode != TAB_Hide
.head 7 +  If NOT hWndCust.AbstractCustomer..initCustomerCategory(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 8 -  Return FALSE
.head 7 +  If NOT hWndCust.AbstractCustomer..populateCustomerCategory()
.head 8 -  Return FALSE
.head 5 -  ! Okpo, nmk
.head 5 +  If cTabCustGeneral.EditMode != TAB_Hide 
or cTabCustNI.EditMode      != TAB_Hide
or cTabCustEN.EditMode      != TAB_Hide
or cTabCustInfo.EditMode    != TAB_Hide
.head 6 -  Set sOKPO     = hWndCust.AbstractCustomer..getOkpo()
.head 6 -  Set sReadNmk  = hWndCust.AbstractCustomer..getNmk()
.head 6 -  Set sReadNmkk = hWndCust.AbstractCustomer..getNmkk()
.head 6 -  Set sReadNmkv = hWndCust.AbstractCustomer..getNmkv()
.head 6 -  Set nCountry  = hWndCust.AbstractCustomer..getCountry()
.head 5 +  Else
.head 6 -  Call SqlPrepareAndExecute(hSql(), "SELECT nmk, okpo, country INTO :sName, :sOkpo, :nCountry FROM customer WHERE rnk=:nCustomerRN")
.head 6 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Call hWndCust.AbstractCustomer..setNmk(sName)
.head 6 -  Set sOKPO = sOkpo
.head 5 -  Return TRUE
.head 3 +  Function: CheckCustomerData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErr
.head 5 -  String: sErrPar
.head 5 -  String: sTmpM
.head 5 -  String: sTmpD
.head 5 -  Number: nIdTr
.head 5 -  String: sCheckNmk
.head 5 -  String: sCheckNmkk
.head 5 -  String: sCheckNmkv
.head 4 +  Actions
.head 5 -  ! Статус КК = Нова
.head 5 -  ! реквізит "дата реєстрації" не визначений, програмний контроль повноти заповнення реквізитів не здійснюється
.head 5 -  ! bVerifyClientParams
.head 5 -  !
.head 5 -  ! Проверка для открытых закладок
.head 5 -  ! General
.head 5 +  If cTabCustGeneral.EditMode = TAB_Edit or bNN
.head 6 -  Call hWndCust.AbstractCustomer..setDateOn(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfDateOn)
.head 6 -  Call hWndCust.AbstractCustomer..setNd(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNd1)
.head 6 -  ! Для МВО для ЮЛ адрес можно не заполнять, для проверки рисуем ...
.head 6 +  If bNN and nCType = 2 and cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr = STRING_Null
.head 7 -  Call hWndCust.AbstractCustomer..setAdr('...')
.head 6 +  Else
.head 7 -  Call hWndCust.AbstractCustomer..setAdr(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr)
.head 6 -  Call hWndCust.AbstractCustomer..setCodcagent(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfCodcagent)
.head 6 -  Call hWndCust.AbstractCustomer..setCountry(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfCountry)
.head 6 -  Call hWndCust.AbstractCustomer..setPrinsider(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfPrinsider)
.head 6 -  Call hWndCust.AbstractCustomer..setTgr(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfTgr)
.head 6 -  Call hWndCust.AbstractCustomer..setOkpo(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 6 -  Call hWndCust.AbstractCustomer..setNRezidCode(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNRezidCode)
.head 6 -  Call hWndCust.AbstractCustomer..setStmt(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfStmt)
.head 6 -  Call hWndCust.AbstractCustomer..setSab(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfSab)
.head 6 -  Call hWndCust.AbstractCustomer..setTobo(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfTobo)
.head 6 -  Set sOKPO = hWndCust.AbstractCustomer..getOkpo()
.head 6 -  ! Fio
.head 6 +  If nCType = 3 and not bPersonSPD and not bNN
.head 7 -  Set sNmkF = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkF
.head 7 -  Set sNmkI = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkI
.head 7 -  Set sNmkO = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkO
.head 7 -  Set sNmk4 = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmk4
.head 7 +  If bVerifyClientParams
.head 8 +  If sNmkF = ''
.head 9 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkF') || '>'
.head 9 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkF)
.head 9 -  Return FALSE
.head 8 +  If nCRezid = 1
.head 9 +  If sNmkI = ''
.head 10 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkI') || '>'
.head 10 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 10 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 10 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkI)
.head 10 -  Return FALSE
.head 9 +  If sNmkO = ''
.head 10 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkO') || '>'
.head 10 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 10 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 10 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkO)
.head 10 -  Return FALSE
.head 6 -  ! Adr
.head 6 +  If (nCType = 2 OR nCType = 3) AND (NOT isNBU or bNN)
.head 7 -  ! Set sIdx = cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sZip
.head 7 -  ! Set sObl = cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sDomain
.head 7 -  ! Set sDst = cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sRegion
.head 7 -  ! Set sTwn = cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sLocality
.head 7 -  ! Set sAdr = cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sAddress
.head 7 -  ! Set nTerrId = cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.nTerritoryId
.head 7 +  ! If PAR_CUSTADRT = 1 and nTerrId = NUMBER_Null
.head 8 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgTerritoryId') || '>'
.head 8 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  ! Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.pbTerritoryId)
.head 8 -  Return FALSE
.head 7 -  ! Call hWndCust.AbstractCustomer..setCustomerAddress( 
     1, hWndCust.AbstractCustomer..getCountry(), sIdx, 
     sObl, sDst, sTwn, sAdr, nTerrId)
.head 7 +  If not CheckCustomerAdr(cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1)
.head 8 -  Return FALSE
.head 7 +  If bVerifyClientParams
.head 8 +  If cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sAddress = '' AND not bNN
.head 9 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustAdr.bgStreet') || '>'
.head 9 -  Call SalMessageBox( sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok )
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr)
.head 9 -  Return FALSE
.head 7 +  If cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr2 != ''
.head 8 +  If not CheckCustomerAdr(cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr2)
.head 9 -  Return FALSE
.head 7 +  If cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr3 != ''
.head 8 +  If not CheckCustomerAdr(cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr3)
.head 9 -  Return FALSE
.head 6 -  ! NN: Adr + Name + NNAcc
.head 6 +  If bNN
.head 7 +  If NOT CheckCustomerDataNNGeneral()
.head 8 -  Return FALSE
.head 7 -  ! Спецпараметры (SA%, SN%, NN%)
.head 7 -  Call SetSpecparamAttributeNN()
.head 6 +  Else
.head 7 -  Call hWndCust.AbstractCustomer..setNmk(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmk)
.head 7 -  Call hWndCust.AbstractCustomer..setNmkk(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkk)
.head 7 -  Call hWndCust.AbstractCustomer..setNmkv(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkv)
.head 7 -  Call hWndCust.AbstractCustomer..setDateOff(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfDateOff)
.head 7 -  Call hWndCust.AbstractCustomer..setBC(0)
.head 7 -  ! Спецпараметры (FG%)
.head 7 -  Call SetSpecparamAttribute()
.head 6 -  ! Проверка на принадлежность к списку террористов
.head 6 +  If bVerifyClientParams
.head 7 -  Set sCheckNmk  = hWndCust.AbstractCustomer..getNmk()
.head 7 -  Set sCheckNmkk = hWndCust.AbstractCustomer..getNmkk()
.head 7 -  Set sCheckNmkv = hWndCust.AbstractCustomer..getNmkv()
.head 7 +  If sCheckNmk  != '' and (sReadNmk  = '' or sReadNmk  != '' and sReadNmk  != sCheckNmk) 
or sCheckNmkk != '' and (sReadNmkk = '' or sReadNmkk != '' and sReadNmkk != sCheckNmkk) 
or sCheckNmkv != '' and (sReadNmkv = '' or sReadNmkv != '' and sReadNmkv != sCheckNmkv) 
.head 8 +  If SqlPLSQLCommand(hSql(), "kl.checkFM(sCheckNmk, sCheckNmkk, sCheckNmkv, nIdTr)")
and nIdTr > 0
.head 9 -  ! Одно из наименований клиента похоже на наименование из списка террористов. 
  Продолжить регистрацию клиента?
  Продолжить обновление реквизитов клиента?
.head 9 +  If IDNO = SalMessageBox(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgTerr1') || PutCrLf() || IifS(nCustomerRN=0, 
   CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgTerr2'),
   CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgTerr3')), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo)
.head 10 -  ! Приостановлена регистрация/обновление клиента из-за подозрения в принадлежности к списку террористов
.head 10 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgTerr4') || " (RNK=" || Str(nCustomerRN) || ")")
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  ! Продолжена регистрация/обновление клиента, подозреваемого в принадлежности к списку террористов
.head 10 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgTerr5') || " (RNK=" || Str(nCustomerRN) || ")")
.head 5 -  ! NI
.head 5 +  If cTabCustNI.EditMode = TAB_Edit AND not bNN
.head 6 -  Call hWndCust.AbstractCustomer..setUseNI(cTabCustNI.hWnd.Dlg_CustNI.cbUseNi)
.head 6 -  Call hWndCust.AbstractCustomer..setCReg(cTabCustNI.hWnd.Dlg_CustNI.dfRegId)
.head 6 -  Call hWndCust.AbstractCustomer..setCDst(cTabCustNI.hWnd.Dlg_CustNI.dfDstId)
.head 6 -  Call hWndCust.AbstractCustomer..setAdm(cTabCustNI.hWnd.Dlg_CustNI.dfAdm)
.head 6 -  Call hWndCust.AbstractCustomer..setRgAdm(cTabCustNI.hWnd.Dlg_CustNI.dfRgadm)
.head 6 -  Call hWndCust.AbstractCustomer..setDateA(cTabCustNI.hWnd.Dlg_CustNI.dfDateA)
.head 6 -  Call hWndCust.AbstractCustomer..setRgTax(cTabCustNI.hWnd.Dlg_CustNI.dfRgtax)
.head 6 -  Call hWndCust.AbstractCustomer..setDateT(cTabCustNI.hWnd.Dlg_CustNI.dfDateT)
.head 6 -  Call hWndCust.AbstractCustomer..setNomPDV(cTabCustNI.hWnd.Dlg_CustNI.dfNomPDV)
.head 6 -  Call hWndCust.AbstractCustomer..setTaxf(cTabCustNI.hWnd.Dlg_CustNI.dfTaxf)
.head 5 -  ! EN
.head 5 +  If cTabCustEN.EditMode = TAB_Edit AND not bNN
.head 6 -  Call hWndCust.AbstractCustomer..setUseEN(cTabCustEN.hWnd.Dlg_CustEN.cbUseEn)
.head 6 -  Call hWndCust.AbstractCustomer..setIse(cTabCustEN.hWnd.Dlg_CustEN.dfIse)
.head 6 -  Call hWndCust.AbstractCustomer..setFs(cTabCustEN.hWnd.Dlg_CustEN.dfFs)
.head 6 -  Call hWndCust.AbstractCustomer..setVed(cTabCustEN.hWnd.Dlg_CustEN.dfVed)
.head 6 -  Call hWndCust.AbstractCustomer..setOe(cTabCustEN.hWnd.Dlg_CustEN.dfOe)
.head 6 -  Call hWndCust.AbstractCustomer..setSed(cTabCustEN.hWnd.Dlg_CustEN.dfSed)
.head 6 -  Call hWndCust.AbstractCustomer..setK050(cTabCustEN.hWnd.Dlg_CustEN.dfK050)
.head 5 -  ! Banks | Corps | Person
.head 5 +  If cTabCustOwn.EditMode = TAB_Edit OR bNN
.head 6 -  ! Banks
.head 6 +  If nCType = BANKS
.head 7 -  Call hWndCust.AbstractCustomer..setRating(cTabCustOwn.hWnd.Dlg_CustBank.dfRating)
.head 7 -  Call hWndCust.AbstractCustomer..setMfo(cTabCustOwn.hWnd.Dlg_CustBank.dfMfo)
.head 7 -  Call hWndCust.AbstractCustomer..setBic(cTabCustOwn.hWnd.Dlg_CustBank.dfBic)
.head 7 -  Call hWndCust.AbstractCustomer..setBicAlt(cTabCustOwn.hWnd.Dlg_CustBank.dfBicAlt)
.head 7 -  Call hWndCust.AbstractCustomer..setKodB(IifN(cTabCustOwn.hWnd.Dlg_CustBank.df1PB='',NUMBER_Null,Val(cTabCustOwn.hWnd.Dlg_CustBank.df1PB)))
.head 7 -  Call hWndCust.AbstractCustomer..setRuk(cTabCustOwn.hWnd.Dlg_CustBank.dfRuk)
.head 7 -  Call hWndCust.AbstractCustomer..setTelR(cTabCustOwn.hWnd.Dlg_CustBank.dfTelR)
.head 7 -  Call hWndCust.AbstractCustomer..setBuh(cTabCustOwn.hWnd.Dlg_CustBank.dfBuh)
.head 7 -  Call hWndCust.AbstractCustomer..setTelB(cTabCustOwn.hWnd.Dlg_CustBank.dfTelB)
.head 6 -  ! Corps
.head 6 +  If nCType = CORPS
.head 7 -  Call hWndCust.AbstractCustomer..setNmku(cTabCustOwn.hWnd.Dlg_CustCorp.dfNmku)
.head 7 -  Call hWndCust.AbstractCustomer..setRuk(cTabCustOwn.hWnd.Dlg_CustCorp.dfRuk)
.head 7 -  Call hWndCust.AbstractCustomer..setTelR(cTabCustOwn.hWnd.Dlg_CustCorp.dfTelR)
.head 7 -  Call hWndCust.AbstractCustomer..setBuh(cTabCustOwn.hWnd.Dlg_CustCorp.dfBuh)
.head 7 -  Call hWndCust.AbstractCustomer..setTelB(cTabCustOwn.hWnd.Dlg_CustCorp.dfTelB)
.head 7 -  Call hWndCust.AbstractCustomer..setTelFax(cTabCustOwn.hWnd.Dlg_CustCorp.dfTelFax)
.head 7 -  Call hWndCust.AbstractCustomer..setEMail(cTabCustOwn.hWnd.Dlg_CustCorp.dfEMail)
.head 7 -  Call hWndCust.AbstractCustomer..setSealId(nCustSignId)
.head 7 -  Call SalSendMsg(cTabCustOwn.hWnd, UM_Update, 0, 0)
.head 6 -  ! Person
.head 6 +  If nCType = PERSON
.head 7 -  Call hWndCust.AbstractCustomer..setUsePerson(cTabCustOwn.hWnd.Dlg_CustPerson.cbAnonymous)
.head 7 -  Call hWndCust.AbstractCustomer..setSer(cTabCustOwn.hWnd.Dlg_CustPerson.dfSer)
.head 7 -  Call hWndCust.AbstractCustomer..setNumDoc(cTabCustOwn.hWnd.Dlg_CustPerson.dfNumDoc)
.head 7 -  Call hWndCust.AbstractCustomer..setOrgan(cTabCustOwn.hWnd.Dlg_CustPerson.dfOrgan)
.head 7 -  Call hWndCust.AbstractCustomer..setPDate(cTabCustOwn.hWnd.Dlg_CustPerson.dfPdate)
.head 7 -  Call hWndCust.AbstractCustomer..setBDay(cTabCustOwn.hWnd.Dlg_CustPerson.dfBday)
.head 7 -  Call hWndCust.AbstractCustomer..setBPlace(cTabCustOwn.hWnd.Dlg_CustPerson.dfBplace)
.head 7 -  ! Call hWndCust.AbstractCustomer..setTelD(cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld)
.head 7 -  Call hWndCust.AbstractCustomer..setTelW(cTabCustOwn.hWnd.Dlg_CustPerson.dfTelw)
.head 7 -  Call hWndCust.AbstractCustomer..setPassp(cTabCustOwn.hWnd.Dlg_CustPerson.dfDocId)
.head 7 -  Call hWndCust.AbstractCustomer..setSex(Str(cTabCustOwn.hWnd.Dlg_CustPerson.dfSex))
.head 7 -  !
.head 7 -  ! Call Debug('ActualDate = ' || SalFmtFormatDateTime(Dlg_CustPerson.dfActualDate, 'dd-MM-yyyy'))
.head 7 -  !
.head 7 -  Call hWndCust.AbstractCustomer..setActualDate(cTabCustOwn.hWnd.Dlg_CustPerson.dfActualDate)
.head 7 -  Call hWndCust.AbstractCustomer..setEddrId(cTabCustOwn.hWnd.Dlg_CustPerson.dfEddrId)
.head 7 +  If bPAR_PHCODE
.head 8 +  If SalGetMaxDataLength(cTabCustOwn.hWnd.Dlg_CustPerson.dfTelm) = 7
.head 9 -  Set sTmpM = cTabCustOwn.hWnd.Dlg_CustPerson.dfKodm || cTabCustOwn.hWnd.Dlg_CustPerson.dfTelm
.head 9 +  If bVerifyClientParams
.head 10 +  If sTmpM != '' and Len(sTmpM) != 9
.head 11 -  ! Некорректно заполнен моб.тел
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneM'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 11 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 11 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfKodm)
.head 11 -  Return FALSE
.head 8 +  Else
.head 9 -  Set sTmpM = cTabCustOwn.hWnd.Dlg_CustPerson.dfTelm
.head 8 +  If SalGetMaxDataLength(cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld) = 7
.head 9 -  Set sTmpD = cTabCustOwn.hWnd.Dlg_CustPerson.dfKodd || cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld
.head 9 +  If bVerifyClientParams
.head 10 +  If sTmpD != '' and Len(sTmpD) != 9
.head 11 -  ! Некорректно заполнен дом.тел
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneD'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 11 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 11 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfKodd)
.head 11 -  Return FALSE
.head 8 +  Else
.head 9 -  Set sTmpD = cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld
.head 8 -  !
.head 8 +  If bVerifyClientParams
.head 9 +  If sTmpM = '' and cTabCustOwn.hWnd.Dlg_CustPerson.cbNoTelm = FALSE
and not (nCtrlFlags & CVIEW_ApproveKK)
.head 10 -  ! Нужно заполнить телефон!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneEmpty'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 10 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 10 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfKodm)
.head 10 -  Return FALSE
.head 9 +  If sTmpM = '' and sTmpD = ''
and not (nCtrlFlags & CVIEW_ApproveKK)
.head 10 -  ! Нужно заполнить телефон!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneEmpty'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 10 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 10 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfKodm)
.head 10 -  Return FALSE
.head 8 -  !
.head 8 +  If SalGetMaxDataLength(cTabCustOwn.hWnd.Dlg_CustPerson.dfTelm) = 7
.head 9 -  Set sPhoneMob = IifS(sTmpM='', '', '+380' || sTmpM)
.head 8 +  Else
.head 9 -  Set sPhoneMob = sTmpM
.head 8 +  If SalGetMaxDataLength(cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld) = 7
.head 9 -  Call hWndCust.AbstractCustomer..setTelD(IifS(sTmpD='', '', '+380' || sTmpD))
.head 8 +  Else
.head 9 -  Call hWndCust.AbstractCustomer..setTelD(sTmpD)
.head 7 +  Else
.head 8 -  Set sPhoneMob = cTabCustOwn.hWnd.Dlg_CustPerson.dfTelm
.head 8 -  Call hWndCust.AbstractCustomer..setTelD(cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld)
.head 7 -  ! Call SalSendMsg(cTabCustOwn.hWnd, UM_Update, 0, 0)
.head 7 +  If bNN
.head 8 +  If NOT CheckCustomerDataNNPerson()
.head 9 -  Return FALSE
.head 7 +  If bVerifyClientParams
.head 8 +  If not CheckPasspSer(hWndCust.AbstractCustomer..getPassp(), hWndCust.AbstractCustomer..getSer())
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfSer)
.head 9 -  Return FALSE
.head 8 +  Else If not CheckPasspNum(hWndCust.AbstractCustomer..getPassp(), hWndCust.AbstractCustomer..getNumDoc(), cTabCustOwn.hWnd.Dlg_CustPerson.dfNumDoc)
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfNumDoc)
.head 9 -  Return FALSE
.head 7 -  Call hWndCust.AbstractCustomer..setElementValue('MPNO ', sPhoneMob)
.head 7 -  Set sNewMobPhone = sPhoneMob
.head 5 -  ! Info
.head 5 +  If cTabCustInfo.EditMode = TAB_Edit AND not bNN
.head 6 -  Call hWndCust.AbstractCustomer..setIsp(cTabCustInfo.hWnd.Dlg_CustInfo.dfIsp)
.head 6 -  Call hWndCust.AbstractCustomer..setNotes(cTabCustInfo.hWnd.Dlg_CustInfo.dfNotes)
.head 6 -  Call hWndCust.AbstractCustomer..setCRisk(cTabCustInfo.hWnd.Dlg_CustInfo.dfCriskId)
.head 6 -  Call hWndCust.AbstractCustomer..setMB('9')
.head 6 -  Call hWndCust.AbstractCustomer..setAdrAlt(cTabCustInfo.hWnd.Dlg_CustInfo.dfAdr_alt)
.head 6 -  Call hWndCust.AbstractCustomer..setLim(cTabCustInfo.hWnd.Dlg_CustInfo.dfLim)
.head 6 -  Call hWndCust.AbstractCustomer..setNomDog(cTabCustInfo.hWnd.Dlg_CustInfo.dfNom_dog)
.head 6 -  Call hWndCust.AbstractCustomer..setLimKass(cTabCustInfo.hWnd.Dlg_CustInfo.dfLim_kass)
.head 6 -  Call hWndCust.AbstractCustomer..setRnkP(cTabCustInfo.hWnd.Dlg_CustInfo.dfRnkP)
.head 6 -  Call hWndCust.AbstractCustomer..setNotesec(cTabCustInfo.hWnd.Dlg_CustInfo.mlNotesec)
.head 6 -  Call SalSendMsg(cTabCustInfo.hWnd, UM_Update, 0, 0)
.head 5 -  ! DR
.head 5 +  If cTabCustDR.EditMode = TAB_Edit OR bNN AND nCustomerRN != 0
.head 6 +  If bVerifyClientParams
.head 7 +  If 2 = SalSendMsg(cTabCustDR.hWnd, UM_BeforeClose, 0, 0)
.head 8 -  Call picTabs.BringToTop(cTabCustDR.TabNum, TRUE)
.head 8 -  Call SalSendMsg(cTabCustDR.hWnd, UM_Clear, 0, 0)
.head 8 -  Return FALSE
.head 6 -  Call SalSendMsg(cTabCustDR.hWnd, UM_Update, 0, 0)
.head 5 -  ! Rel
.head 5 +  If cTabCustRel.EditMode = TAB_Edit AND not bNN AND nCustomerRN != 0
.head 6 +  If bVerifyClientParams
.head 7 +  If 2 = SalSendMsg(cTabCustRel.hWnd, UM_BeforeClose, 0, 0)
.head 8 -  Call picTabs.BringToTop(cTabCustRel.TabNum, TRUE)
.head 8 -  Call SalSendMsg(cTabCustRel.hWnd, UM_Clear, 0, 0)
.head 8 -  Return FALSE
.head 6 -  Call SalSendMsg(cTabCustRel.hWnd, UM_Update, 0, 0)
.head 5 -  ! Risk
.head 5 +  If cTabCustRisk.EditMode = TAB_Edit AND not bNN or nCtrlFlags & CVIEW_ApproveKK
.head 6 -  Set sCriteriaCode = Criteria_CustRisk
.head 6 +  If bVerifyClientParams
.head 7 +  If 2 = SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_BeforeClose, 0, 0)
.head 8 -  Call picTabs.BringToTop(cTabCustRisk.TabNum, TRUE)
.head 8 -  Call SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_Clear, 0, 0)
.head 8 -  Return FALSE
.head 6 -  Call SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_Update, 0, 0)
.head 5 -  ! Rept
.head 5 +  If cTabCustRept.EditMode = TAB_Edit AND not bNN
.head 6 -  Set sCriteriaCode = Criteria_CustRept
.head 6 -  Call SalSendMsg(picTabs.Items[cTabCustRept.TabNum].m_hWndPage, UM_Update, 0, 0)
.head 5 -  ! Category
.head 5 +  If cTabCustCtg.EditMode = TAB_Edit AND not bNN
.head 6 -  Set sCriteriaCode = Criteria_CustCtg
.head 6 -  Call SalSendMsg(picTabs.Items[cTabCustCtg.TabNum].m_hWndPage, UM_Update, 0, 0)
.head 5 -  !
.head 5 -  ! Err
.head 5 +  If cTabCustGeneral.EditMode = TAB_Edit or cTabCustNI.EditMode = TAB_Edit or cTabCustEN.EditMode = TAB_Edit
.head 6 +  If bVerifyClientParams
.head 7 -  Set sErr = ''
.head 7 -  Set sErr = hWndCust.AbstractCustomer..getErrDataEx(sErrPar)
.head 7 +  If sErr
.head 8 -  ! Ошибка заполнения реквизитов
.head 8 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 +  If sErrPar = 'NMK'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmk)
.head 8 +  Else If sErrPar = 'NMKV'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkv)
.head 8 +  Else If sErrPar = 'FIOF'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkF)
.head 8 +  Else If sErrPar = 'FIOI'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkI)
.head 8 +  Else If sErrPar = 'FIOO'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkO)
.head 8 +  Else If sErrPar = 'ADR'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr)
.head 8 +  Else If sErrPar = 'COUNTRY'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.cmbCountry)
.head 8 +  ! Else If sErrPar = 'CODCAGENT'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.cmbCodcagent)
.head 8 +  Else If sErrPar = 'TGR'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.cmbTgr)
.head 8 +  Else If sErrPar = 'OKPO'
.head 9 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 8 +  Else If sErrPar = 'CREG'
.head 9 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.cmbC_reg)
.head 8 +  Else If sErrPar = 'CDST'
.head 9 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.cmbC_dst)
.head 8 +  Else If sErrPar = 'DATET'
.head 9 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.dfDateT)
.head 8 +  Else If sErrPar = 'DATEA'
.head 9 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.dfDateA)
.head 8 +  Else If sErrPar = 'ISE'
.head 9 -  Call picTabs.BringToTop(cTabCustEN.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustEN.hWnd.Dlg_CustEN.dfIse)
.head 8 +  ! Else If sErrPar = 'FS'
.head 9 -  Call picTabs.BringToTop(cTabCustEN.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustEN.hWnd.Dlg_CustEN.dfFs)
.head 8 +  ! Else If sErrPar = 'OE'
.head 9 -  Call picTabs.BringToTop(cTabCustEN.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustEN.hWnd.Dlg_CustEN.dfOe)
.head 8 +  Else If sErrPar = 'SED'
.head 9 -  Call picTabs.BringToTop(cTabCustEN.TabNum, TRUE)
.head 9 -  ! Call SalSetFocus(cTabCustEN.hWnd.Dlg_CustEN.dfSed)
.head 9 -  Call SalSetFocus(cTabCustEN.hWnd.Dlg_CustEN.dfK050)
.head 8 +  Else If sErrPar = 'VED'
.head 9 -  Call picTabs.BringToTop(cTabCustEN.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustEN.hWnd.Dlg_CustEN.dfVed)
.head 8 -  Return FALSE
.head 5 -  ! Err NI
.head 5 +  If cTabCustNI.EditMode = TAB_Edit and hWndCust.AbstractCustomer..isUseNI() and ( nCType = 2 or nCType = 3 and bPersonSPD )
.head 6 +  If bVerifyClientParams
.head 7 +  If hWndCust.AbstractCustomer..getAdm() = STRING_Null
.head 8 -  ! Ошибка заполнения реквизитов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustNI.bgAdm'), CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.dfAdm)
.head 8 -  Return FALSE
.head 7 +  If hWndCust.AbstractCustomer..getRgAdm() = STRING_Null
.head 8 -  ! Ошибка заполнения реквизитов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustNI.bgRgadm'), CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.dfRgadm)
.head 8 -  Return FALSE
.head 7 +  If hWndCust.AbstractCustomer..getDateA() = DATETIME_Null
.head 8 -  ! Ошибка заполнения реквизитов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustNI.bgDateA'), CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 -  Call picTabs.BringToTop(cTabCustNI.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustNI.hWnd.Dlg_CustNI.dfDateA)
.head 8 -  Return FALSE
.head 5 -  ! Err Person
.head 5 +  If cTabCustOwn.EditMode = TAB_Edit
.head 6 +  If bVerifyClientParams
.head 7 -  Set sErr = ''
.head 7 -  Set sErr = hWndCust.AbstractCustomer..getErrData(sErrPar)
.head 7 +  If sErr
.head 8 -  ! Ошибка заполнения реквизитов
.head 8 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 +  If sErrPar = 'MFO'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustBank.dfMfo)
.head 8 +  Else If sErrPar = 'PASSP'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.cmbPassp)
.head 8 +  Else If sErrPar = 'SER'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfSer)
.head 8 +  Else If sErrPar = 'NUMDOC'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfNumDoc)
.head 8 +  Else If sErrPar = 'ORGAN'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfOrgan)
.head 8 +  Else If sErrPar = 'PDATE'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfPdate)
.head 8 +  Else If sErrPar = 'BDAY'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfBday)
.head 8 +  Else If sErrPar = 'ACTUALDATE'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfActualDate)
.head 8 +  Else If sErrPar = 'EDDRID'
.head 9 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 9 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfEddrId)
.head 8 -  Return FALSE
.head 5 -  ! Err CustRisk
.head 5 +  ! If PAR_CUSTRISK and nCtrlFlags & CVIEW_ApproveKK
.head 6 -  Set sCriteriaCode = Criteria_CustRisk
.head 6 +  If 2 = SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_BeforeClose, 0, 0)
.head 7 -  Call picTabs.BringToTop(cTabCustRisk.TabNum, TRUE)
.head 7 -  Call SalSendMsg(picTabs.Items[cTabCustRisk.TabNum].m_hWndPage, UM_Clear, 0, 0)
.head 7 -  Return FALSE
.head 5 -  ! Для МВО для ЮЛ адрес можно не заполнять, если для проверки нарисовано ..., возвращаем пусто
.head 5 +  If bNN and nCType = 2 and hWndCust.AbstractCustomer..getAdr() = '...'
.head 6 -  Call hWndCust.AbstractCustomer..setAdr('')
.head 5 -  ! Проверка ОКПО 
.head 5 +  If bVerifyClientParams
.head 6 -  ! Проверка ОКПО для ФЛ-резидента
.head 6 +  If cTabCustGeneral.EditMode = TAB_Edit and cTabCustOwn.EditMode = TAB_Edit and
   nCType = 3 and nCRezid = 1 and hWndCust.AbstractCustomer..getTgr() != 3 and sOKPO
.head 7 +  If not CheckOkpo(3, hWndCust.AbstractCustomer..getOkpo())
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 8 -  Return FALSE
.head 7 +  If not CheckPersonOkpo(
   hWndCust.AbstractCustomer..getOkpo(), 
   hWndCust.AbstractCustomer..getBDay(),
   hWndCust.AbstractCustomer..getSex(), sMsg)
.head 8 -  ! Повторный ввод ОКПО
.head 8 +  If not (nCtrlFlags & CVIEW_ApproveKK)
.head 9 +  If not SalModalDialog(dlgCheckOkpo, hWndForm,
   sOKPO, 
   hWndCust.AbstractCustomer..getBDay(),
   hWndCust.AbstractCustomer..getSex(), sMsg)
.head 10 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 10 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 10 -  Return FALSE
.head 9 -  Call hWndCust.AbstractCustomer..setOkpo(sOKPO)
.head 6 -  ! Проверка ОКПО для ЮЛ-резидента
.head 6 +  If cTabCustGeneral.EditMode = TAB_Edit and
   nCType = 2 and nCRezid = 1 and hWndCust.AbstractCustomer..getTgr() != 3 and sOKPO
.head 7 +  If not CheckOkpo(2, hWndCust.AbstractCustomer..getOkpo())
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 8 -  Return FALSE
.head 6 -  ! Проверка дубля клиента-ФЛ/ФЛ-СПД
.head 6 +  If cTabCustGeneral.EditMode = TAB_Edit and cTabCustOwn.EditMode = TAB_Edit and
   nCType = 3 and nCRezid = 1 and hWndCust.AbstractCustomer..getTgr() != 3 and sOKPO and
   nCustomerRN = 0
.head 7 +  If not CheckPersonOkpoPassp(bPersonSPD, hWndCust.AbstractCustomer..getOkpo(),
hWndCust.AbstractCustomer..getPassp(), hWndCust.AbstractCustomer..getSer(), hWndCust.AbstractCustomer..getNumDoc())
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 8 -  Return FALSE
.head 5 -  ! Call Debug('check')
.head 5 -  ! Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: CheckCustomerAdr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : cAdr
.head 6 -  Class: cCustAddress
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! String: sIdx
.head 5 -  ! String: sObl
.head 5 -  ! String: sDst
.head 5 -  ! String: sTwn
.head 5 -  ! String: sAdr
.head 5 -  String: sErr
.head 4 +  Actions
.head 5 -  Set sErr = ''
.head 5 -  ! Set sIdx = cAdr.sZip
.head 5 -  ! Set sObl = cAdr.sDomain
.head 5 -  ! Set sDst = cAdr.sRegion
.head 5 -  ! Set sTwn = cAdr.sLocality
.head 5 -  ! Set sAdr = cAdr.sAddress
.head 5 -  ! Set nTerrId = cAdr.nTerritoryId
.head 5 +  If PAR_CUSTADRT = 1 and cAdr.nTerritoryId = NUMBER_Null
.head 6 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgTerritoryId') || '>'
.head 6 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 6 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 6 -  Return FALSE
.head 5 -  ! Call hWndCust.AbstractCustomer..setCustomerAddress( 
     cAdr.nTypeId, hWndCust.AbstractCustomer..getCountry(), sIdx, 
     sObl, sDst, sTwn, sAdr, nTerrId)
.head 5 -  Call hWndCust.AbstractCustomer..setCustomerAddress(cAdr)
.head 5 -  Return TRUE
.head 3 +  Function: CheckCustomerDataNNGeneral
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErr
.head 5 -  String: sErrPar
.head 4 +  Actions
.head 5 -  Call hWndCust.AbstractCustomer..setTaxf(STRING_Null)
.head 5 -  Call hWndCust.AbstractCustomer..setIsp(NUMBER_Null)
.head 5 -  Call hWndCust.AbstractCustomer..setRnkP(NUMBER_Null)
.head 5 -  Call hWndCust.AbstractCustomer..setLim(NUMBER_Null)
.head 5 -  ! Call hWndCust.AbstractCustomer..setNomPDV(STRING_Null)
.head 5 -  Call hWndCust.AbstractCustomer..setUseNI(FALSE)
.head 5 -  Call hWndCust.AbstractCustomer..setUseEN(FALSE)
.head 5 -  !
.head 5 +  If nCType = 3
.head 6 -  Set sErr = ''
.head 6 -  Set sNNNmkF = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkF
.head 6 -  Set sNNNmkI = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkI
.head 6 -  Set sNNNmkO = cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkO
.head 6 +  If sNNNmkF = ''
.head 7 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkF') || '>'
.head 7 -  Set sErrPar = 'NMKF'
.head 6 +  If sNNNmkI = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkI') || '>'
.head 7 -  Set sErrPar = IifS(sErrPar='', 'NMKI', sErrPar)
.head 6 +  If sNNNmkO = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkO') || '>'
.head 7 -  Set sErrPar = IifS(sErrPar='', 'NMKO', sErrPar)
.head 6 +  If cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sLocality = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgCity') || '>'
.head 7 -  Set sErrPar = IifS(sErrPar='', 'CITY', sErrPar)
.head 6 +  If cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sAddress = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgStreet') || '>'
.head 7 -  Set sErrPar = IifS(sErrPar='', 'STREET', sErrPar)
.head 6 +  If cTabCustGeneral.hWnd.Dlg_CustGeneral.cmbPrinsider.GetNameById(hWndCust.AbstractCustomer..getPrinsider()) = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgPrinsider') || '>'
.head 7 -  Set sErrPar = IifS(sErrPar='', 'PRINSIDER', sErrPar)
.head 6 +  If hWndCust.AbstractCustomer..getTobo() = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgTobo') || '>'
.head 7 -  Set sErrPar = IifS(sErrPar='', 'TOBO', sErrPar)
.head 6 +  If sErr
.head 7 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 7 +  If sErrPar = 'NMKF'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkF)
.head 7 +  Else If sErrPar = 'NMKI'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkI)
.head 7 +  Else If sErrPar = 'NMKO'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmkO)
.head 7 +  Else If sErrPar = 'CITY'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  ! Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfCity)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr)
.head 7 +  Else If sErrPar = 'STREET'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  ! Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfStreet)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfAdr)
.head 7 +  Else If sErrPar = 'PRINSIDER'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.cmbPrinsider)
.head 7 +  Else If sErrPar = 'TOBO'
.head 8 -  Call picTabs.BringToTop(cTabCustGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfTobo)
.head 7 -  Return FALSE
.head 6 -  Call hWndCust.AbstractCustomer..setNmk(sNNNmkF || ' ' || sNNNmkI || ' ' || sNNNmkO)
.head 6 -  Call SalSendMsg(cTabCustGeneral.hWnd, UM_Update, 0, 0)
.head 5 +  Else
.head 6 -  Call hWndCust.AbstractCustomer..setNmk(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfNmk)
.head 5 -  Call hWndCust.AbstractCustomer..setNmkv(hWndCust.AbstractCustomer..getNmk())
.head 5 -  Call hWndCust.AbstractCustomer..setNmkk(Subs(hWndCust.AbstractCustomer..getNmk(),1,35))
.head 5 -  Call hWndCust.AbstractCustomer..setOkpo(cTabCustGeneral.hWnd.Dlg_CustGeneral.dfOkpo)
.head 5 -  Return TRUE
.head 3 +  Function: CheckCustomerDataNNPerson
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nPassp
.head 5 -  String: sSer
.head 5 -  Date/Time: dBDay
.head 5 -  String: sTelD
.head 5 -  String: sTelW
.head 5 -  String: sErr
.head 5 -  String: sErrPar
.head 4 +  Actions
.head 5 +  If nCType = 3 AND hWndCust.AbstractCustomer..isUsePerson()
.head 6 -  Set sErr = ''
.head 6 -  Set sErrPar = ''
.head 6 -  Set nPassp = hWndCust.AbstractCustomer..getPassp()
.head 6 -  Set sSer   = hWndCust.AbstractCustomer..getSer()
.head 6 -  Set dBDay  = hWndCust.AbstractCustomer..getBDay()
.head 6 -  Set sTelD  = hWndCust.AbstractCustomer..getTelD()
.head 6 -  Set sTelW  = hWndCust.AbstractCustomer..getTelW()
.head 6 +  If nPassp = 1 AND sSer = ''
.head 7 -  Set sErr = CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgSer') || '>'
.head 7 -  Set sErrPar = 'SER'
.head 6 +  If dBDay = DATETIME_Null
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' ||
    CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgBday') || '>'
.head 7 -  Set sErrPar = 'BDAY'
.head 6 +  If sTelD = '' AND sTelW = ''
.head 7 -  Set sErr = IifS(sErr='', '', sErr || PutCrLf()) || 
    CurrentLangTable.GetAtomTitle('Frm_Customer.cTErrTel') || ': ' || '<' ||
    CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgTeld') || '>' || ', ' || '<' ||
    CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgTelw') || '>'
.head 7 -  Set sErrPar = 'TEL'
.head 6 +  If sErr
.head 7 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 7 +  If sErrPar = 'SER'
.head 8 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfSer)
.head 7 +  Else If sErrPar = 'BDAY'
.head 8 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfBday)
.head 7 +  Else If sErrPar = 'TEL'
.head 8 -  Call picTabs.BringToTop(cTabCustOwn.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabCustOwn.hWnd.Dlg_CustPerson.dfTeld)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: setEdited
.head 4 -  Description: Высталяет признак наличия изменений
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT fIsEdit
.head 6 -  Set fIsEdit = TRUE
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 +  Function: SetSpecparamAttribute
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nCType = 3
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_LN', sNmkF)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_FN', sNmkI)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_MN', sNmkO)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_4N', sNmk4)
.head 5 +  If nCType = 2 OR nCType = 3
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('FGIDX', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sZip)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('FGOBL', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sDomain)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('FGDST', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sRegion)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('FGTWN', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sLocality)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('FGADR', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sAddress)
.head 5 -  Return TRUE
.head 3 +  Function: SetSpecparamAttributeNN
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Адрес
.head 5 -  Set sNNCountry = GetValueStr("SELECT name FROM country WHERE country=" || Str(hWndCust.AbstractCustomer..getCountry()))
.head 5 -  Call hWndCust.AbstractCustomer..setElementValue('SAZIP', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sZip)
.head 5 -  Call hWndCust.AbstractCustomer..setElementValue('SACON', sNNCountry)
.head 5 -  Call hWndCust.AbstractCustomer..setElementValue('SAOBL', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sDomain)
.head 5 -  Call hWndCust.AbstractCustomer..setElementValue('SAREG', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sRegion)
.head 5 -  Call hWndCust.AbstractCustomer..setElementValue('SASTL', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sLocality)
.head 5 -  Call hWndCust.AbstractCustomer..setElementValue('SAADR', cTabCustGeneral.hWnd.Dlg_CustGeneral.cAdr1.sAddress)
.head 5 -  ! Для физ. лица
.head 5 +  If nCType = 3
.head 6 -  ! ФИО
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_LN', sNNNmkF)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_FN', sNNNmkI)
.head 6 -  Call hWndCust.AbstractCustomer..setElementValue('SN_MN', sNNNmkO)
.head 5 -  Return TRUE
.head 3 +  Function: SaveCustomerData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: res
.head 5 -  String: pmsg
.head 5 -  Long String: sErrMsg
.head 4 +  Actions
.head 5 -  ! Выполнить регистрацию нового Клиента банка:
  Сохранить изменения в реквизитах Клиента банка: cCustomer.getNmk() ?
.head 5 +  If MessageQuestion(IifS(nCustomerRN=0,
   CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgOpen'),
   CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgSave')) || ': ' ||
   hWndCust.AbstractCustomer..getNmk() || ' ?') = IDNO
.head 6 -  Return FALSE
.head 5 +  If not CheckCustomerData()
.head 6 -  ! Call Debug('CheckCustomerData')
.head 6 -  Return FALSE
.head 5 +  If nCustomerRN = 0
.head 6 +  While TRUE
.head 7 -  Set nActivTab = picTabs.GetTop()
.head 7 -  ! Save customer
.head 7 +  If NOT hWndCust.AbstractCustomer..saveCustomerAttribute()
.head 8 -  ! Call Debug('saveCustomerAttribute')
.head 8 -  Break
.head 7 +  If not hWndCust.AbstractCustomer..saveCustomerEN()
.head 8 -  ! Call Debug('saveCustomerEN')
.head 8 -  Break
.head 7 -  ! Save Accs
.head 7 +  If bNN 
.head 8 +  If not SaveNNAccs()
.head 9 -  ! Call Debug('SaveNNAccs')
.head 9 -  Break
.head 7 -  ! Save customer_address
.head 7 +  ! If (nCType = 2 OR nCType = 3) AND hWndCust.AbstractCustomer..isShowCustomerAddress()
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerAddress()
.head 9 -  Return FALSE
.head 7 +  If (nCType = 2 OR nCType = 3)
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerAddress()
.head 9 -  ! Call Debug('saveCustomerAddress')
.head 9 -  Return FALSE
.head 7 -  ! Save cust_bank / corps / person
.head 7 +  If NOT hWndCust.AbstractCustomer..saveOwnAttribute()
.head 8 -  ! Call Debug('saveOwnAttribute')
.head 8 -  Break
.head 7 -  ! Save customerw
.head 7 +  If NOT hWndCust.AbstractCustomer..saveCustomerElement()
.head 8 -  ! Call Debug('saveCustomerElement')
.head 8 -  Break
.head 7 -  ! Save customer risk
.head 7 +  If cTabCustRisk.isEdited
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerRisk()
.head 9 -  ! Call Debug('saveCustomerRisk')
.head 9 -  Break
.head 7 -  ! Save customer rept
.head 7 +  If cTabCustRept.isEdited
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerRept()
.head 9 -  ! Call Debug('saveCustomerRept')
.head 9 -  Break
.head 7 -  ! Save customer category
.head 7 +  If cTabCustCtg.isEdited
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerCategory()
.head 9 -  ! Call Debug('saveCustomerCategory')
.head 9 -  Break
.head 7 +  If not CheckPublic(hWndCust.AbstractCustomer..getNmk())
.head 8 -  ! Call Debug('getNmk')
.head 8 -  Break
.head 7 +  ! If nCType = 3
.head 8 +  If not (cTabCustOwn.hWnd.Dlg_CustPerson.cbNoTelm)
.head 9 -  Set res = smsPIN(nCustomerRN, "+380"||cTabCustOwn.hWnd.Dlg_CustPerson.dfKodm||cTabCustOwn.hWnd.Dlg_CustPerson.dfTelm, 0, res, pmsg)
.head 9 +  If res != 0
.head 10 -  Break 
.head 7 -  ! Регистрация нового Клиента банка: cCustomer.getNmk()
.head 7 +  If SqlPLSQLCommand( hSql(), "P_BEFORE_SAVE_CLIENT( nCustomerRN, sErrMsg )" ) 
AND ( sErrMsg = STRING_Null )
.head 8 +  If NOT SqlCommitEx( hSql(), 
   CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgOpenOK') || ': ' ||
   Str(hWndCust.AbstractCustomer..getRnk()) || ' ' || hWndCust.AbstractCustomer..getNmk())
.head 9 -  ! Call Debug('SqlCommitEx')
.head 9 -  Break
.head 8 -  ! Клиенту банка cCustomer.getNmk присвоен регистрационный номер: nCustomerRN
.head 8 -  Call MessageInfo(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgRNK1') || ' ' ||
     hWndCust.AbstractCustomer..getNmk() || ' ' ||
     CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgRNK2') || ' ' ||
     NumberToStr(hWndCust.AbstractCustomer..getRnk()) ||
     IifS(bPAR_CUSTCLV=TRUE and not (nCtrlFlags & CVIEW_ApproveKK) and (nCType=3 and bPersonSPD=TRUE or nCType=2), PutCrLf() || 'Зміни набудуть чинності після підтвердження контролером.', ''))
.head 8 -  Set nCustomerRN = hWndCust.AbstractCustomer..getRnk()
.head 8 -  ! Инициализация закладок, доступных после регистрации клиента
.head 8 -  ! Call Debug('before if bNN')
.head 8 +  If bNN 
.head 9 -  Call picTabs.AddPage(cTabCustNNCard.Name, cTabCustNNCard.DlgName, hWndNULL)
.head 9 -  Call picTabs.Enable(cTabCustNNCard.TabNum, TRUE)
.head 8 +  Else
.head 9 -  Set cTabCustGeneral.hWnd.Dlg_CustGeneral.dfRnk = nCustomerRN
.head 9 -  ! Info
.head 9 +  If cTabCustInfo.EditMode != TAB_Hide
.head 10 -  ! Для ПРАВЭКСа для физ.лиц-СПД читаем счета в других банках
.head 10 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD
.head 11 +  If NOT hWndCust.AbstractCustomer..initCorpAcc(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 12 -  Return FALSE
.head 9 -  ! Rel
.head 9 +  If cTabCustRel.EditMode != TAB_Hide
.head 10 -  Call hWndCust.AbstractCustomer..initCustomerRel(nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 10 -  Call linkTab(cTabCustRel)
.head 10 -  Call picTabs.Enable(cTabCustRel.TabNum, TRUE)
.head 8 -  ! Call Debug('before If nCtrlFlags & CVIEW_Accounts')
.head 8 +  If nCtrlFlags & CVIEW_Accounts
.head 9 -  Call SalEnableWindow(pbAccounts)
.head 8 -  ! Call Debug('before SqlPLSQLCommand')
.head 8 +  If not SqlPLSQLCommand(hSql(), "p_after_edit_client(nCustomerRN)")
.head 9 -  Call SqlRollbackEx(hSql(), "РНК " || Str(nCustomerRN) || ": ошибка выполнения p_after_edit_client")
.head 8 +  Else
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SalPostMsg(hWndForm, UM_Populate, 6, 0)
.head 8 +  ! If bPAR_CUSTCLV
.head 9 -  Call hWndCust.AbstractCustomer..setShowKK(FALSE)
.head 8 -  Call picTabs.InitializeFormPages( 
     SalNumberToStrX(nCustomerRN,0)|| ';' ||
     SalNumberToStrX(nCType,0)     || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) || ';' || 
     Str(SalWindowHandleToNumber(hWndCust)))
.head 8 -  Call picTabs.BringToTop(nActivTab,TRUE)
.head 8 -  !
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Call SqlRollbackEx(hSql(), "P_BEFORE_SAVE_CLIENT: РНК " || Str(nCustomerRN) || sErrMsg )
.head 8 -  Call MessageError( sErrMsg )
.head 5 +  Else
.head 6 +  While TRUE
.head 7 -  Set nActivTab = picTabs.GetTop()
.head 7 +  If bNN
.head 8 -  ! Save customer
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerAttribute()
.head 9 -  ! Call Debug('saveCustomerAttribute')
.head 9 -  Break
.head 8 -  ! Save Accs
.head 8 +  If not SaveNNAccs()
.head 9 -  ! Call Debug('SaveNNAccs')
.head 9 -  Break
.head 8 +  If not SaveNNCard()
.head 9 -  ! Call Debug('SaveNNCard')
.head 9 -  Break
.head 8 -  ! Save cust_bank / corps / person
.head 8 +  If NOT hWndCust.AbstractCustomer..saveOwnAttribute()
.head 9 -  ! Call Debug('saveOwnAttribute')
.head 9 -  Break
.head 8 -  ! Save customerw
.head 8 +  If NOT hWndCust.AbstractCustomer..saveCustomerElement()
.head 9 -  ! Call Debug('saveCustomerElement')
.head 9 -  Break
.head 7 +  Else
.head 8 -  ! Сохранякм только те рекв., кот. редактировались
.head 8 -  ! General + NI + EN + Info
.head 8 +  If cTabCustGeneral.isEdited OR cTabCustNI.isEdited OR cTabCustEN.isEdited OR cTabCustInfo.isEdited
or bPAR_CUSTCLV
.head 9 -  ! Save customer
.head 9 +  If not hWndCust.AbstractCustomer..saveCustomerAttribute()
.head 10 -  ! Call Debug('saveCustomerAttribute')
.head 10 -  Break
.head 9 -  ! Save customer_address
.head 9 +  If (nCType = 2 OR nCType = 3)
.head 10 +  If not hWndCust.AbstractCustomer..saveCustomerAddress()
.head 11 -  Return FALSE
.head 9 -  ! EN
.head 9 +  If cTabCustEN.isEdited or bPAR_CUSTCLV
.head 10 +  If not hWndCust.AbstractCustomer..saveCustomerEN()
.head 11 -  ! Call Debug('saveCustomerEN')
.head 11 -  Break
.head 9 -  ! Save rnk_rekv
.head 9 +  If cTabCustInfo.isEdited
.head 10 +  If not hWndCust.AbstractCustomer..saveCustomerInfo()
.head 11 -  ! Call Debug('saveCustomerInfo')
.head 11 -  Break
.head 10 -  ! Для ПРАВЭКСа для физ.лиц-СПД читаем счета в других банках
.head 10 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD
.head 11 +  If NOT hWndCust.AbstractCustomer..saveCorpAcc()
.head 12 -  Return FALSE
.head 8 -  ! Bank + Corp + Person
.head 8 +  If cTabCustOwn.isEdited
or bPAR_CUSTCLV
.head 9 -  ! Save cust_bank / corps / person
.head 9 -  ! Call Debug('before hWndCust.AbstractCustomer..saveOwnAttribute')
.head 9 +  If NOT hWndCust.AbstractCustomer..saveOwnAttribute()
.head 10 -  ! Call Debug('saveOwnAttribute')
.head 10 -  Break
.head 9 -  ! Call Debug('after hWndCust.AbstractCustomer..saveOwnAttribute')
.head 9 +  ! If nCType = 3 and bUPDATE_ACC_PHONE and sOldMobPhone != sNewMobPhone
.head 10 +  If not SqlPLSQLCommand(hSql(),
   "bars_sms_acc.change_acc_phones(sOldMobPhone,sNewMobPhone,nCustomerRN)")
.head 11 -  ! Call Debug('bars_sms_acc.change_acc_phones')
.head 11 -  Break 
.head 10 -  Set res = smsPIN(nCustomerRN, sNewMobPhone, 0, res, pmsg)
.head 10 +  If res != 0
.head 11 -  ! Call Debug('res')
.head 11 -  Break 
.head 8 -  ! DR / доп.рекв. SN% (ФИО) / доп.рекв. FG% (адрес) / доп.рекв. MPNO (моб.тел.)
.head 8 +  If cTabCustDR.isEdited
or cTabCustGeneral.isEdited and (nCType = 2 or nCType = 3)
or cTabCustOwn.isEdited and nCType = 3
or bPAR_CUSTCLV
.head 9 -  ! Save customerw
.head 9 +  If not hWndCust.AbstractCustomer..saveCustomerElement()
.head 10 -  ! Call Debug('saveCustomerElement')
.head 10 -  Break
.head 8 -  ! Rel
.head 8 +  If cTabCustRel.isEdited
or bPAR_CUSTCLV
.head 9 -  ! Save customer_extern + customer_rel
.head 9 +  If NOT hWndCust.AbstractCustomer..saveCustomerRel()
.head 10 -  ! Call Debug('saveCustomerRel')
.head 10 -  Break
.head 8 -  ! Save customer risk
.head 8 +  If cTabCustRisk.isEdited
or bPAR_CUSTCLV
.head 9 +  If NOT hWndCust.AbstractCustomer..saveCustomerRisk()
.head 10 -  ! Call Debug('saveCustomerRisk')
.head 10 -  Break
.head 8 -  ! Save customer rept
.head 8 +  If cTabCustRept.isEdited
.head 9 +  If NOT hWndCust.AbstractCustomer..saveCustomerRept()
.head 10 -  ! Call Debug('saveCustomerRept')
.head 10 -  Break
.head 8 -  ! Save customer category
.head 8 +  If cTabCustCtg.isEdited
.head 9 +  If NOT hWndCust.AbstractCustomer..saveCustomerCategory()
.head 10 -  ! Call Debug('saveCustomerCategory')
.head 10 -  Break
.head 7 +  If SqlPLSQLCommand( hSql(), "P_BEFORE_SAVE_CLIENT( nCustomerRN, sErrMsg )" ) 
AND ( sErrMsg = STRING_Null )
.head 8 -  ! Сохранение изменений в реквизитах Клиента банка: cCustomer.getNmk()
.head 8 +  If not SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgSaveOK') || ': ' ||
   Str(hWndCust.AbstractCustomer..getRnk()) || ' ' || hWndCust.AbstractCustomer..getNmk())
.head 9 -  ! Call Debug('getNmk')
.head 9 -  Break
.head 8 -  ! Сохранены реквизиты Клиента
.head 8 -  ! Call MessageInfo(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgRNK3') || ' ' || hWndCust.AbstractCustomer..getNmk() || '.' ||
     IifS(bPAR_CUSTCLV=TRUE and not (nCtrlFlags & CVIEW_ApproveKK) and not bVerifyClientParams and (nCType=3 and bPersonSPD=TRUE or nCType=2), 
     PutCrLf() || 'Зміни набудуть чинності після підтвердження контролером.', ''))
.head 8 -  Call MessageInfo(CurrentLangTable.GetAtomTitle('Frm_Customer.cTMsgRNK3') || ' ' || hWndCust.AbstractCustomer..getNmk() || '.' ||
     IifS(bPAR_CUSTCLV=TRUE and not (nCtrlFlags & CVIEW_ApproveKK) and (nCType=3 and bPersonSPD=TRUE or nCType=2), 
     PutCrLf() || 'Зміни набудуть чинності після підтвердження контролером.', ''))
.head 8 +  If not SqlPLSQLCommand(hSql(), "p_after_edit_client(nCustomerRN)")
.head 9 -  Call SqlRollbackEx(hSql(), "РНК " || Str(nCustomerRN) || ": ошибка выполнения p_after_edit_client")
.head 8 +  Else
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SalPostMsg(hWndForm, UM_Populate, 6, 0)
.head 8 +  ! If bPAR_CUSTCLV
.head 9 -  Call hWndCust.AbstractCustomer..setShowKK(FALSE)
.head 8 -  ! Инициализация после сохранения
.head 8 -  Call picTabs.InitializeFormPages( 
     SalNumberToStrX(nCustomerRN,0)|| ';' ||
     SalNumberToStrX(nCType,0)     || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) || ';' || 
     Str(SalWindowHandleToNumber(hWndCust)))
.head 8 -  Call picTabs.BringToTop(nActivTab,TRUE)
.head 8 -  !
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Call SqlRollbackEx(hSql(), "P_BEFORE_SAVE_CLIENT: РНК " || Str(nCustomerRN) || sErrMsg )
.head 8 -  Call MessageError( sErrMsg )
.head 5 -  Call hWndCust.AbstractCustomer..setRnk(nCustomerRN)
.head 5 -  Call SqlRollback(hSql())
.head 5 -  ! Ошибка регистрации Клиента банка:
  Ошибка обновления реквизитов Клиента банка: cCustomer.getNmk()
.head 5 -  Return MessageError(IifS(nCustomerRN=0,
       CurrentLangTable.GetAtomTitle('Frm_Customer.cTErrOpen'),
       CurrentLangTable.GetAtomTitle('Frm_Customer.cTErrEdit') ) || ': ' ||
       hWndCust.AbstractCustomer..getNmk())
.head 3 +  Function: SaveNNAccs
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: nTmpRnk
.head 5 -  Number: nType
.head 5 -  String: sOpen
.head 4 +  Actions
.head 5 -  Set nTmpRnk = hWndCust.AbstractCustomer..getRnk()
.head 5 -  Set i = 0
.head 5 +  While i < cTabCustGeneral.hWnd.Dlg_CustGeneral.nNNAccsNum
.head 6 -  Set nType = cTabCustGeneral.hWnd.Dlg_CustGeneral.nmNNAccs[i,0]
.head 6 -  Set sOpen = IifS(cTabCustGeneral.hWnd.Dlg_CustGeneral.nmNNAccs[i,1]=1,'Y','N')
.head 6 +  If not SqlPLSQLCommand(hSql(), "bars_mvo.set_customer_reqacc(nTmpRnk, nType, sOpen)")
.head 7 -  Return FALSE
.head 6 -  Set i = i + 1
.head 5 -  Return TRUE
.head 3 +  Function: SaveNNCard
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not cTabCustNNCard.hWnd.Dlg_CustNNCard.cCardList.Save()
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: PrintCustomerData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dDatPrnt
.head 5 -  String: sTemplateId
.head 5 -  Long String: sDoc
.head 5 -  : cCnc
.head 6 -  Class: cABSConnect
.head 5 -  : cCnc2
.head 6 -  Class: cABSConnect
.head 5 -  String: sValue
.head 5 -  Number: nDat
.head 4 +  Actions
.head 5 -  Set dDatPrnt = dDat
.head 5 +  If GetGlobalOption('CUSTPRNT') = '1'
.head 6 +  If not SalModalDialog(dlg_CustPrnt, hWndForm, dDatPrnt)
.head 7 -  Return FALSE
.head 5 -  Set nDat = Val(
    SalNumberToStrX(SalDateDay(dDatPrnt), 0) || 
    SalStrRightX('00' || SalNumberToStrX(SalDateMonth(dDatPrnt), 0), 2) ||
    SalNumberToStrX(SalDateYear(dDatPrnt), 0))
.head 5 +  If NOT cdoc_SelectDocTemplate("DOC_SCHEME", "ID", "NAME", " ID LIKE 'CUST%' ", sTemplateId)
.head 6 -  Return FALSE
.head 5 +  If sTemplateId
.head 6 -  Call XConnectGetParams(cCnc)
.head 6 +  If cCnc.Connect() and cCnc2.Clone(cCnc, TRUE)
.head 7 -  Set sDoc = cdoc_CreateDocFromTemplate(cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nCustomerRN, nDat)
.head 7 +  If sDoc
.head 8 -  Call cdoc_ShowDoc(sDoc, TRUE, FALSE)
.head 7 -  Call cCnc.Disconnect()
.head 7 -  Call cCnc2.Disconnect()
.head 5 -  Return TRUE
.head 3 +  Function: ApproveKK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bVerifyClientParams = TRUE
.head 5 -  Set cTabCustGeneral.EditMode = TAB_Edit
.head 5 -  Set cTabCustNI.EditMode   = TAB_Edit
.head 5 -  Set cTabCustEN.EditMode   = TAB_Edit
.head 5 -  Set cTabCustOwn.EditMode  = TAB_Edit
.head 5 -  Set cTabCustInfo.EditMode = TAB_Edit
.head 5 -  Set cTabCustDR.EditMode   = TAB_Edit
.head 5 -  Set cTabCustRel.EditMode  = TAB_Edit
.head 5 +  If not CheckCustomerData()
.head 6 -  Return FALSE
.head 5 +  If not SqlPLSQLCommand(hSql(), "bars_clv.set_customer_visa(nCustomerRN, 1)")
.head 6 -  Call SqlRollbackEx(hSql(), 'Помилка при виконанні процедури підтвердження змін РНК ' || Str(nCustomerRN))
.head 6 -  Call SalMessageBox('Помилка при виконанні процедури підтвердження змін РНК ' || Str(nCustomerRN), 'Інформація', MB_IconExclamation | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  ! При подтверждении изменений надо пересчитать Рівень ризику
.head 5 +  If not SqlPLSQLCommand(hSql(), "fm_set_rizik(nCustomerRN)")
.head 6 -  Call SqlRollbackEx(hSql(), 'Помилка при виконанні процедури fm_set_rizik при підтвердження змін РНК ' || Str(nCustomerRN))
.head 6 -  Call SalMessageBox('Помилка при виконанні процедури fm_set_rizik при підтвердження змін РНК ' || Str(nCustomerRN), 'Інформація', MB_IconExclamation | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommitEx(hSql(), 'Зміни РНК ' || Str(nCustomerRN) || ' підтверджено')
.head 5 -  Return TRUE
.head 3 +  Function: RejectKK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not SqlPLSQLCommand(hSql(), "bars_clv.set_customer_visa(nCustomerRN, 0)")
.head 6 -  Call SqlRollbackEx(hSql(), 'Помилка при виконанні процедури відхилення змін РНК ' || Str(nCustomerRN))
.head 6 -  Call SalMessageBox('Помилка при виконанні процедури відхилення змін РНК ' || Str(nCustomerRN), 'Інформація', MB_IconExclamation | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommitEx(hSql(), 'Зміни РНК ' || Str(nCustomerRN) || ' відхилено')
.head 5 -  Return TRUE
.head 3 +  Function: CheckPublic
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNMK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nDlgRet
.head 5 -  String: sMSG
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select bars.finmon_is_public(:sNMK, null, 1) into :sMSG from DUAL")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If sMSG != '0'
.head 6 -  Set nDlgRet = SalMessageBox('Увага! Виявлено збіг з переліком публічних діячів, ідентифікатор в переліку ='|| sMSG ||'. Зверніться до підрозділу фінансового моніторингу!', 'Інформація', MB_IconExclamation | MB_OkCancel)
.head 6 +  If nDlgRet = IDCANCEL
.head 7 -  Return FALSE
.head 6 +  If nDlgRet = IDOK
.head 7 -  Return TRUE
.head 5 +  Else
.head 6 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nCustomerRN
.head 3 -  ! nCType -тип клиента:
.head 3 -  ! 1 - Банк 
.head 3 -  ! 2 - ЮЛ
.head 3 -  ! 3 - ФЛ (все)
.head 3 -  ! 9 - ФЛ неСПД
.head 3 -  ! 10- ФЛ СПД
.head 3 -  ! на SAM_Create nCType преобразуем 9,10=>3
.head 3 -  Number: nCType
.head 3 -  ! nCRezid - резидентность - нужна только для регистрации нового клиента, для старых ориентируемся на codcagent
.head 3 -  ! 1 - резидент
.head 3 -  ! 2 - нерезидент
.head 3 -  Number: nCRezid
.head 3 -  Number: nCtrlFlags
.head 3 -  Window Handle: hWndParent
.head 3 -  ! nPar - Не используется
.head 3 -  Number: nPar
.head 3 -  ! sCustFilter - Строка типа <CustFilterTab>#<AccFilter>#<AccFilterTab>
.head 3 -  ! <CustFilterTab> - 22211000
.head 3 -  ! <AccFilter>     - a.pap=1
.head 3 -  ! <AccFilterTab>  - 2220011
.head 3 -  String: sCustFilter
.head 3 -  ! bNN - Признак NN
.head 3 -  Boolean: bNN
.head 3 -  ! bShowKK
.head 3 -  ! TRUE  - Реквизиты клиената из customer
.head 3 -  ! FALSE - Реквизиты клиената из clv_customer (в режиме "Після внесення змін")
.head 3 -  Boolean: bShowKK
.head 2 +  Window Variables
.head 3 -  Date/Time: dDat       ! Банковская дата
.head 3 -  Boolean: fIsEdit
.head 3 -  Boolean: fCustActivate
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  Boolean: bVerifyClientParams
.head 3 -  !
.head 3 -  Boolean: isNBU
.head 3 -  Boolean: isCustSign
.head 3 -  Number: isTOBO
.head 3 -  String: sTOBO
.head 3 -  String: sGetName
.head 3 -  Number: nCount
.head 3 -  Number: i
.head 3 -  String: sMsg
.head 3 -  String: sNmkF
.head 3 -  String: sNmkI
.head 3 -  String: sNmkO
.head 3 -  String: sNmk4
.head 3 -  Number: nTerrId
.head 3 -  Number: nCustSignId
.head 3 -  String: sPhoneMob
.head 3 -  Number: nTmp
.head 3 -  Boolean: bPersonSPD
.head 3 -  String: sCustomerFieldCType
.head 3 -  String: sK014Name
.head 3 -  String: sK030Name
.head 3 -  String: sCorpNmk	! corps.nmk varchar2(182)
.head 3 -  ! Для picTabs
.head 3 -  Number: nTabNum
.head 3 -  String: sCustFilterOnTab
.head 3 -  String: sAccFilter
.head 3 -  Number: nTabCount
.head 3 -  Number: nTabCurrent
.head 3 -  Number: nActivTab
.head 3 -  Number: nPrevActivTab
.head 3 -  !
.head 3 -  : cTabCustGeneral
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustNI
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustEN
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustOwn
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustInfo
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustDR
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustRel
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustRisk
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustRept
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustCtg
.head 4 -  Class: cCustTab
.head 3 -  : cTabCustNNCard
.head 4 -  Class: cCustTab
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Window Handle: hWndCustomerFactory
.head 3 -  Window Handle: hWndCust
.head 3 -  !
.head 3 -  Boolean: fDestroy
.head 3 -  Boolean: fParentRefresh
.head 3 -  Number: nAccFlags
.head 3 -  !
.head 3 -  String: sOKPO
.head 3 -  Number: nCountry
.head 3 -  String: sCriteriaCode
.head 3 -  ! NN
.head 3 -  String: sNNNmkF
.head 3 -  String: sNNNmkI 
.head 3 -  String: sNNNmkO
.head 3 -  String: sNNCountry
.head 3 -  !
.head 3 -  String: sReadNmk
.head 3 -  String: sReadNmkk
.head 3 -  String: sReadNmkv
.head 3 -  Date/Time: dBdayByOkpo
.head 3 -  Number: nSexByOkpo
.head 3 -  !
.head 3 -  String: sOldMobPhone
.head 3 -  String: sNewMobPhone
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowSize(hWndForm, 12.5, 6.8)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация переменных
.head 4 -  Set isNBU      = PAR_NBUBANK  = 1
.head 4 -  Set isCustSign = PAR_CUSTSIGN = 1
.head 4 -  Set isTOBO     = PAR_HAVETOBO
.head 4 -  Set dDat       = GetBankDate()
.head 4 -  Set fIsEdit        = FALSE
.head 4 -  Set fDestroy       = FALSE
.head 4 -  Set fParentRefresh = FALSE
.head 4 +  If isTOBO
.head 5 -  Set sTOBO = GetValueStr("SELECT substr(tobopack.GetTOBO,1,30) FROM dual")
.head 4 -  ! Флаг редактируемости
.head 4 -  Set bPossibleToEdit = FALSE
.head 4 -  !
.head 4 -  Set bPersonSPD = IifN(nCType=10,TRUE,FALSE)
.head 4 +  If nCType > 3
.head 5 -  Set nCType = 3
.head 4 -  ! Анализ параметра sCustFilter <CustFilterTab>#<AccFilter>#<AccFilterTab>
.head 4 -  Set sAccFilter = ''
.head 4 -  Set sCustFilterOnTab = sCustFilter
.head 4 -  Set nTmp = SalStrScan(sCustFilter, '#')
.head 4 +  If nTmp != -1
.head 5 -  Set sCustFilterOnTab = Subs(sCustFilter, 1, nTmp)
.head 5 -  Set sAccFilter = Subs(sCustFilter, nTmp+2, Len(sCustFilter)-nTmp-1)
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! 1. Закладки <CustFilterTab>: установка EditMode. От этого зависит 2.INIT
.head 4 -  Set nTabCount   = 8
.head 4 -  Set nTabCurrent = 0
.head 4 -  Call SetCustTabEditMode(TAB_ReadOnly)
.head 4 -  ! Режим "Показывать только Доп. рекв"
.head 4 +  If nCtrlFlags & CVIEW_DROnly
.head 5 -  Set cTabCustDR.EditMode = TAB_Edit
.head 4 -  ! Если фильтр на закладки не задан, даем все для редактирования
.head 4 +  Else If sCustFilterOnTab = ''
.head 5 -  Call SetCustTabEditMode(TAB_Edit)
.head 4 -  ! Иначе разбираем строку фильтра
.head 4 +  Else
.head 5 +  If nCustomerRN = 0
.head 6 -  Set cTabCustGeneral.EditMode = TAB_Edit
.head 6 -  Set cTabCustNI.EditMode      = TAB_Edit
.head 6 -  Set cTabCustEN.EditMode      = TAB_Edit
.head 6 -  Set cTabCustOwn.EditMode     = TAB_Edit
.head 6 -  Set cTabCustInfo.EditMode    = TAB_Edit
.head 6 +  If PAR_ORGTYPE != 'KAZNA'
.head 7 -  Set cTabCustDR.EditMode = TAB_Edit
.head 6 -  Set cTabCustRel.EditMode     = Val(Subs(sCustFilterOnTab,7,1))
.head 6 -  Set cTabCustNNCard.EditMode  = Val(Subs(sCustFilterOnTab,8,1))
.head 5 +  Else
.head 6 -  Set nTabCurrent = -1
.head 6 -  Set cTabCustGeneral.EditMode = Val(Subs(sCustFilterOnTab,1,1))
.head 6 -  Set cTabCustNI.EditMode      = Val(Subs(sCustFilterOnTab,2,1))
.head 6 -  Set cTabCustEN.EditMode      = Val(Subs(sCustFilterOnTab,3,1))
.head 6 -  Set cTabCustOwn.EditMode     = Val(Subs(sCustFilterOnTab,4,1))
.head 6 -  Set cTabCustInfo.EditMode    = Val(Subs(sCustFilterOnTab,5,1))
.head 6 -  Set cTabCustDR.EditMode      = Val(Subs(sCustFilterOnTab,6,1))
.head 6 -  Set cTabCustRel.EditMode     = Val(Subs(sCustFilterOnTab,7,1))
.head 6 -  Set cTabCustNNCard.EditMode  = Val(Subs(sCustFilterOnTab,8,1))
.head 6 -  Set i = 0
.head 6 +  While i < nTabCount
.head 7 +  If Val(Subs(sCustFilterOnTab,i+1,1)) > 0
.head 8 -  ! nTabCurrent - первая закладка
.head 8 -  Set nTabCurrent = IifN(nTabCurrent=-1, i, nTabCurrent)
.head 7 -  Set i = i + 1
.head 5 -  Set cTabCustRisk.EditMode = TAB_Edit
.head 5 -  Set cTabCustRept.EditMode = TAB_Edit
.head 5 -  Set cTabCustCtg.EditMode  = TAB_Edit
.head 4 +  If not PAR_CUSTRISK
.head 5 -  Set cTabCustRisk.EditMode = TAB_Hide
.head 4 +  If not PAR_CUSTREPT
.head 5 -  Set cTabCustRept.EditMode = TAB_Hide
.head 4 +  If not PAR_CUSTCTG
.head 5 -  Set cTabCustCtg.EditMode = TAB_Hide
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! 2. INIT
.head 4 -  Set hWndCustomerFactory = SalCreateWindow(CustomerFactory, hWndForm)
.head 4 -  Set hWndCust = hWndCustomerFactory.CustomerFactory.getCustomerObject(nCType)
.head 4 -  Call hWndCust.AbstractCustomer..constructor(hSql(), nCType, nCustomerRN, bShowKK, bPAR_CUSTCLV)
.head 4 -  ! Call hWndCust.AbstractCustomer..setShowKK(bShowKK)
.head 4 -  ! Call hWndCust.AbstractCustomer..setFlagVisa(bPAR_CUSTCLV)
.head 4 -  Call SalHideWindow(hWndCust)
.head 4 -  ! READ
.head 4 +  If nCustomerRN = 0
.head 5 +  If NOT InitCustomerData()
.head 6 -  ! Не удалось прочитать данные клиента nCustomerRN
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Frm_Customer.cTErrCust') || ' ' || Str(nCustomerRN), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 6 -  Set fDestroy = TRUE
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 +  If nCRezid = NUMBER_Null
.head 6 -  Set nCRezid = 1
.head 5 -  ! Регистрация клиента - Банк - Юридическое лицо - Физическое лицо
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Frm_Customer.cTWndTitleOpen') || ' - ' || 
     IifS(nCType=1,CurrentLangTable.GetAtomTitle('Frm_Customer.cTBanks'), 
     IifS(nCType=2,CurrentLangTable.GetAtomTitle('Frm_Customer.cTCorps'), 
                   CurrentLangTable.GetAtomTitle('Frm_Customer.cTPerson'))))
.head 5 -  Call SalDisableWindow(pbAccounts)
.head 5 -  Call SalDisableWindow(pbClose)
.head 5 -  Call SalDisableWindow(pbPrint)
.head 4 +  Else
.head 5 +  If NOT ReadCustomerData()
.head 6 -  ! Не удалось прочитать данные клиента nCustomerRN
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Frm_Customer.cTErrCust') || ' ' || Str(nCustomerRN), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 6 -  Set fDestroy = TRUE
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 +  If nCRezid = NUMBER_Null
.head 6 -  ! Резидент
.head 6 +  If SalNumberMod(hWndCust.AbstractCustomer..getCodcagent() + 2, 2)
.head 7 -  Set nCRezid = 1
.head 6 +  Else
.head 7 -  Set nCRezid = 2
.head 5 -  ! Просмотр/Редактирование реквизитов клиента nCustomerRN - sNmkk
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Frm_Customer.cTWndTitleEdit') ||  ' ' || 
     SalNumberToStrX(nCustomerRN, 0) || ' - ' || hWndCust.AbstractCustomer..getNmk())
.head 5 -  ! Флаг редактируемости
.head 5 -  Set bPossibleToEdit = not (nCtrlFlags & CVIEW_ReadOnly or nCtrlFlags & CVIEW_Closed)
.head 5 -  ! анализируем bPossibleToEdit для закладок
.head 5 -  Set cTabCustGeneral.EditMode = IifN(bPossibleToEdit, cTabCustGeneral.EditMode, IifN(cTabCustGeneral.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustNI.EditMode      = IifN(bPossibleToEdit, cTabCustNI.EditMode,      IifN(cTabCustNI.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustEN.EditMode      = IifN(bPossibleToEdit, cTabCustEN.EditMode,      IifN(cTabCustEN.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustOwn.EditMode     = IifN(bPossibleToEdit, cTabCustOwn.EditMode,     IifN(cTabCustOwn.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustInfo.EditMode    = IifN(bPossibleToEdit, cTabCustInfo.EditMode,    IifN(cTabCustInfo.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustDR.EditMode      = IifN(bPossibleToEdit, cTabCustDR.EditMode,      IifN(cTabCustDR.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustRel.EditMode     = IifN(bPossibleToEdit, cTabCustRel.EditMode,     IifN(cTabCustRel.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustNNCard.EditMode  = IifN(bPossibleToEdit, cTabCustNNCard.EditMode,  IifN(cTabCustNNCard.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabCustRisk.EditMode    = IifN(bPossibleToEdit, cTabCustRisk.EditMode,    IifN(cTabCustRisk.EditMode=TAB_Hide, TAB_Hide, IifN(bEditFMRisk=TRUE, TAB_Edit, TAB_ReadOnly)))
.head 5 -  Set cTabCustRept.EditMode    = IifN(bPossibleToEdit, cTabCustRept.EditMode,    IifN(cTabCustRept.EditMode=TAB_Hide, TAB_Hide, IifN(bEditFMRisk=TRUE, TAB_Edit, TAB_ReadOnly)))
.head 5 -  Set cTabCustCtg.EditMode     = IifN(bPossibleToEdit, cTabCustCtg.EditMode,     IifN(cTabCustCtg.EditMode=TAB_Hide, TAB_Hide, IifN(bEditFMRisk=TRUE, TAB_Edit, TAB_ReadOnly)))
.head 4 -  !
.head 4 -  Set bVerifyClientParams = not (
    bPAR_CUSTCLV and
    not nCtrlFlags & CVIEW_ApproveKK and
    (nCType=3 and bPersonSPD=TRUE or nCType=2) and
    (nCustomerRN=0 or hWndCust.AbstractCustomer..getDateOn() = DATETIME_Null) )
.head 4 +  If not bVerifyClientParams
.head 5 -  Call SalDisableWindow(pbAccounts)
.head 4 -  !
.head 4 -  ! K014
.head 4 -  ! 1 - ЮО (nCType=2) / Банк (nCType=1)
.head 4 -  ! 2 - СПД (bPersonSPD=TRUE)
.head 4 -  ! 3 - ФО (bPersonSPD=FALSE)
.head 4 -  ! 4 - Банк (nCType=1) - закрыт
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select substr(txt,1,100) into :sK014Name from kl_k014 where k014 = " || Str(IifN(nCType=3,IifN(bPersonSPD=TRUE,2,3),1)) )
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  ! K030 = rezid
.head 4 -  ! 1 - Резидент 
.head 4 -  ! 2 - Нерезидент
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select name into :sK030Name from rezid where rezid = :nCRezid")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! 3. ДоИнициализация закладки доп.рекв., т.к. она зависит от 2.INIT (nCRezid, bPersonSPD)
.head 4 -  Call InitCustTab()
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! Disable/Enable/Hide pb
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 +  If nCType = 1
.head 5 -  Call SalDisableWindow(pb_T8)
.head 4 +  If nCType = 1 or nCType = 3 or cTabCustOwn.EditMode != TAB_Edit or not isCustSign or bNN
.head 5 -  Call SalHideWindow(pbCustSign)
.head 4 +  If bNN
.head 5 -  Call SalHideWindow(pb_T8)
.head 4 +  If nCtrlFlags & CVIEW_ReadOnly 
OR nCtrlFlags & CVIEW_DROnly 
OR nCtrlFlags & CVIEW_Closed
.head 5 -  Call SalDisableWindow(pbClose)
.head 4 +  If nCtrlFlags & CVIEW_Closed 
OR nCtrlFlags & CVIEW_DROnly 
OR NOT (nCtrlFlags & CVIEW_Accounts)
.head 5 -  Call SalDisableWindow(pbAccounts)
.head 4 +  If nCtrlFlags & CVIEW_ApproveKK
.head 5 -  Call SalEnableWindow(pbSave)
.head 5 -  Call SalEnableWindow(pbClose)
.head 4 +  If cTabCustGeneral.EditMode = TAB_Hide
.head 5 -  Call SalDisableWindow(pbClose)
.head 5 -  Call SalDisableWindow(pbAccounts)
.head 5 -  Call SalDisableWindow(pbPrint)
.head 4 +  If GetValueStr("select count(*) from meta_tables where tabname = 'CUSTOMER_DEAL'") = '0'
.head 5 -  Call SalDisableWindow(pbDeals)
.head 4 -  !
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set fCustActivate = FALSE
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Activate
.head 4 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_MenuSelect, 0, 0)
.head 3 +  On UM_Populate
.head 4 +  If wParam = 6
.head 5 -  Call hWndCust.AbstractCustomer..initCustomerElement(nCustomerRN, nCType, bShowKK, bPAR_CUSTCLV)
.head 5 -  Call hWndCust.AbstractCustomer..populateCustomerElement()
.head 5 -  ! Инициализация закладок
.head 5 -  Call picTabs.InitializeFormPages(
     SalNumberToStrX(nCustomerRN,0)|| ';' ||
     SalNumberToStrX(nCType,0)     || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) || ';' ||
     Str(SalWindowHandleToNumber(hWndCust)))
.head 3 +  On SAM_Destroy
.head 4 -  Call SaveInfoToLog('Выход из диалога: Реквизиты Контрагента.')
.head 4 -  Call SalDestroyWindow(hWndCustomerFactory)
.head 4 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_MenuSelect, 0, 0)
.head 4 -  Call SalMapEnterToTab(FALSE)
.head 4 +  If fParentRefresh
.head 5 -  Call SalPostMsg(hWndParent, UM_Populate, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nWW, nWH)
.head 4 +  If nWW >= 12.5
.head 5 +  If nWH < 6.8
.head 6 -  Call SalSetWindowSize(hWndForm, nWW, 6.8)
.head 4 +  Else
.head 5 +  If nWH < 6.8
.head 6 -  Call SalSetWindowSize(hWndForm, 12.5, 6.8)
.head 5 +  Else
.head 6 -  Call SalSetWindowSize(hWndForm, 12.5, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustGeneral
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.838"
.head 4 -  Top:    0.844"
.head 4 -  Width:  11.183"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.452"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Основные реквизиты
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  10.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 7.929"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Дата регистрации:
.head 4 -  Resource Id: 59732
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.0"
.head 5 -  Top:    0.286"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDateOn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  ! Data Field: bgDateOn
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.0"
.head 6 -  Top:    0.286"
.head 6 -  Width:  2.65"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfDateOn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.8"
.head 6 -  Top:    0.2"
.head 6 -  Width:  1.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Дата закрытия:
.head 4 -  Resource Id: 59733
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.0"
.head 5 -  Top:    0.548"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDateOff
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  ! Data Field: bgDateOff
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.0"
.head 6 -  Top:    0.4"
.head 6 -  Width:  2.65"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfDateOff
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.8"
.head 6 -  Top:    0.47"
.head 6 -  Width:  1.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Рег.№:
.head 4 -  Resource Id: 35231
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg1	! bgRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    0.2"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If dfRnk
.head 7 -  Call SalDisableWindow(hWndItem)
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: № дог.
.head 4 -  Resource Id: 44524
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.52"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg2	! bgNd1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNd1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    0.47"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_KillFocus
.head 6 -  Set dfNd1=SalStrUpperX(dfNd1)
.head 3 -  Background Text: Наименование клиента (нац):
.head 4 -  Resource Id: 44515
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.79"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg3	! bgNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    0.74"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpNmk = dfNmk
.head 5 +  On SAM_AnyEdit
.head 6 +  ! If nCType = 3 and not bPersonSPD and NOT hWndParent.Frm_Customer.isNBU
.head 7 -  Set dfNmk = sTmpNmk
.head 6 +  If nCType = 3 and not bPersonSPD
.head 7 -  Set dfNmk = sTmpNmk
.head 6 +  Else
.head 7 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If (nCType != 3 or bPersonSPD) and NOT isNN
.head 7 -  Set dfNmk  = SalStrUpperX(dfNmk)
.head 7 -  Call hWndC.AbstractCustomer..setNmk(dfNmk)
.head 7 +  If dfNmkv = STRING_Null
.head 8 -  Set dfNmkv = dfNmk
.head 7 -  Call SalSendMsg(dfNmkv, SAM_Validate, 0, 0)
.head 7 +  If dfNmkk = STRING_Null
.head 8 -  Set dfNmkk = SalStrUpperX(SalStrMidX(dfNmk, 0, 38))
.head 6 -  Return VALIDATE_Ok
.head 3 +  Picture: pbFio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.2"
.head 5 -  Top:    0.738"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \bars98\RESOURCE\BMP\NEXTREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set bFio = NOT bFio
.head 6 -  Call SalPicSetFile(pbFio, smPic[bFio])
.head 6 -  Call SetField()
.head 6 -  !
.head 6 -  Call SalDisableWindow(bg4)
.head 6 -  !
.head 6 +  If bFio
.head 7 -  Call SalShowWindow(dfFFF)
.head 7 -  Call SalShowWindow(dfIII)
.head 7 -  Call SalShowWindow(dfOOO)
.head 6 +  Else
.head 7 -  Call SalHideWindow(dfFFF)
.head 7 -  Call SalHideWindow(dfIII)
.head 7 -  Call SalHideWindow(dfOOO)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', IifS(bFio, 'Cвернуть реквизиты для ввода',
       'Развернуть реквизиты для ввода'), IifS(bFio, 'Згорнути реквізити для введення',
       'Розгорнути реквізити для введення')))
.head 3 -  !
.head 3 -  Background Text: Фамилия:
.head 4 -  Resource Id: 9177
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.06"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg4	! Fio1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmkF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    0.988"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If not CheckFio(dfNmkF)
.head 7 -  ! Фамилия/Имя-1 нерезидента: содержит недопустимые символы!
.head 7 -  Call SalMessageBox(IifS(nRezid=1, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkF'),
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk1')) || ' ' ||
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrSymb'), CurrentLangTable.GetAtomTitle('cTAt'),
     MB_IconExclamation | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call setNmk()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Имя:
.head 4 -  Resource Id: 9178
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.33"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg5	! Fio2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmkI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    1.238"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If not CheckFio(dfNmkI)
.head 7 -  ! Имя/Имя-2 нерезидента: содержит недопустимые символы!
.head 7 -  Call SalMessageBox(IifS(nRezid=1, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkI'),
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk2')) || ' ' ||
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrSymb'), CurrentLangTable.GetAtomTitle('cTAt'),
     MB_IconExclamation | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call setNmk()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Отчество:
.head 4 -  Resource Id: 9180
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.6"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg6	! Fio3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmkO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    1.488"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If not CheckFio(dfNmkO)
.head 7 -  ! Отчество/Имя-3 нерезидента: содержит недопустимые символы!
.head 7 -  Call SalMessageBox(IifS(nRezid=1, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkO'),
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk3')) || ' ' ||
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrSymb'), CurrentLangTable.GetAtomTitle('cTAt'),
    MB_IconExclamation | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call setNmk()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Имя-4 нерезидента:
.head 4 -  Resource Id: 9179
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.87"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg7	! Fio4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmk4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    1.82"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If not CheckFio(dfNmk4)
.head 7 -  ! Имя-4 нерезидента: содержит недопустимые символы!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk4') || ' ' ||
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrSymb'), CurrentLangTable.GetAtomTitle('cTAt'),
     MB_IconExclamation | MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call setNmk()
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Наименование (межд.):
.head 4 -  Resource Id: 44516
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.14"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg8	! bgNmkv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmkv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    2.09"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_SetFocus
.head 6 +  If NOT isNN
.head 7 +  If SalIsNull(dfNmkv)
.head 8 -  Set dfNmkv = dfNmk
.head 8 -  Call SalSendMsg(dfNmkv, SAM_Validate, 0, 0)
.head 5 +  On SAM_Validate
.head 6 +  If NOT isNN
.head 7 -  Call setEdited()
.head 7 -  Set dfNmkv = SalStrUpperX(dfNmkv)
.head 7 -  Set sTmpNmkv = dfNmkv
.head 7 +  While TRUE
.head 8 -  Call SalStrFirstC(sTmpNmkv, nChrNmkv)
.head 8 +  If nChrNmkv >= 192 and nChrNmkv <= 223 or nChrNmkv = 165
.head 9 -  Call SqlPrepareAndExecute(hSql(), "select substr(f_translate_kmu(:dfNmkv),1,70) into :dfNmkv from dual")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Break
.head 8 +  If sTmpNmkv = STRING_Null
.head 9 -  Break
.head 7 -  Call hWndC.AbstractCustomer..setNmkv(dfNmkv)
.head 7 +  If SalIsNull(dfNmkv)
.head 8 -  Set bNmkvNull = TRUE
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Наименование (краткое):
.head 4 -  Resource Id: 44517
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.41"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg9	! bgNmkk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmkk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    2.36"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_SetFocus
.head 6 +  If NOT isNN
.head 7 +  If SalIsNull(dfNmkk)
.head 8 -  Set dfNmkk = SalStrMidX(dfNmk, 0, 38)
.head 8 -  Call SalSendMsg(dfNmkk, SAM_Validate, 0, 0)
.head 5 +  On SAM_Validate
.head 6 +  If NOT isNN
.head 7 -  Call setEdited()
.head 7 -  Set dfNmkk = SalStrUpperX(dfNmkk)
.head 7 -  Call hWndC.AbstractCustomer..setNmkk(dfNmkk)
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Адрес клиента:
.head 4 -  Resource Id: 44521
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.68"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg10	! bgAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    2.63"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If (nCType = 2 OR nCType = 3) AND NOT hWndParent.Frm_Customer.isNBU
.head 7 -  Set dfAdr = sTmpAdr
.head 6 +  Else
.head 7 -  Call setEdited()
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpAdr = dfAdr
.head 3 +  Picture: pbAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.2"
.head 5 -  Top:    2.63"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\NEXTREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ShowAddress(cAdr1)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Открыть окно ввода реквизитов адреса',
       'Відкрити вікно вводу реквізитів адреси'))
.head 3 -  Background Text: Адрес клиента-2:
.head 4 -  Resource Id: 23885
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.95"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg11
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdr2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    2.9"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If (nCType = 2 OR nCType = 3) AND NOT hWndParent.Frm_Customer.isNBU
.head 7 -  Set dfAdr2 = sTmpAdr
.head 6 +  Else
.head 7 -  Call setEdited()
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpAdr = dfAdr2
.head 3 +  Picture: pbAdr2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.2"
.head 5 -  Top:    2.9"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\NEXTREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ShowAddress(cAdr2)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Открыть окно ввода реквизитов адреса',
       'Відкрити вікно вводу реквізитів адреси'))
.head 3 -  Background Text: Адрес клиента-3:
.head 4 -  Resource Id: 23884
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.22"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg12
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdr3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    3.17"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If (nCType = 2 OR nCType = 3) AND NOT hWndParent.Frm_Customer.isNBU
.head 7 -  Set dfAdr3 = sTmpAdr
.head 6 +  Else
.head 7 -  Call setEdited()
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpAdr = dfAdr3
.head 3 +  Picture: pbAdr3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.2"
.head 5 -  Top:    3.17"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\NEXTREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ShowAddress(cAdr3)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Открыть окно ввода реквизитов адреса',
       'Відкрити вікно вводу реквізитів адреси'))
.head 3 -  !
.head 3 -  Background Text: Тип клиента (K014):
.head 4 -  Resource Id: 17728
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.49"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg13
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK014
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    3.44"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Резидентность (K030):
.head 4 -  Resource Id: 17729
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.76"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg14
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK030
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    3.71"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Background Text: Характеристика клиента:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.798"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgCodcagent
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! cGenComboBox_NumId: cmbCodcagent
.winattr class Combo Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    3.71"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbCodcagent.Init(hWndItem)
.head 7 -  Call cmbCodcagent.Populate(hSql(), 'Codcagent', 'name', 'Codcagent', 'WHERE codcagent IN ' || 
  IifS(nCType=1,'(1,2,9)',
  IifS(nCType=2,'(3,4,7)','(5,6)')) || ' ORDER BY codcagent')
.head 7 -  Call cmbCodcagent.SetSelectById(dfCodcagent)
.head 5 +  ! On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfCodcagent = cmbCodcagent.nCurrentId
.head 6 -  Call hWndC.AbstractCustomer..setCodcagent(dfCodcagent)
.head 6 -  ! резидент
.head 6 +  If SalNumberMod(dfCodcagent+2, 2)
.head 7 -  Set dfCountry = nCountryCode
.head 7 -  Call EnableWindow(cmbCountry, FALSE)
.head 7 -  Set dfOkpo = ''
.head 7 +  If bAdr
.head 8 -  Call SalSetWindowLabelText(bgOkpo, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 7 +  Else 
.head 8 -  Call SalSetWindowLabelText(bgStreet, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 6 -  ! НЕрезидент
.head 6 +  Else 
.head 7 -  Set dfCountry = NUMBER_Null
.head 7 -  Call EnableWindow(cmbCountry, TRUE)
.head 7 -  Set dfOkpo = ''
.head 7 +  If bAdr
.head 8 -  Call SalSetWindowLabelText(bgOkpo, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNRezidCode'))
.head 7 +  Else 
.head 8 -  Call SalSetWindowLabelText(bgStreet, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNRezidCode'))
.head 6 -  Call hWndC.AbstractCustomer..setCountry(dfCountry)
.head 6 -  Call SalSendMsg(cmbCountry, UM_ObjActivate, 0, 0)
.head 3 -  Background Text: Страна клиента (K040):
.head 4 -  Resource Id: 44519
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.03"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg15
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbCountry
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    3.98"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbCountry.Init(hWndItem)
.head 7 -  Set sTmp = ' ORDER BY name '
.head 7 +  If dfCountry = nCountryCode
.head 8 -  Set sTmp = 'WHERE country =:nCountryCode ' || sTmp
.head 7 +  Else
.head 8 -  Set sTmp = 'WHERE country <>:nCountryCode ' || sTmp
.head 7 -  Call cmbCountry.Populate(hSql(), "country", "lpad(country,3,' ') || '  ' || name", "country", sTmp)
.head 7 -  Call cmbCountry.SetSelectById(dfCountry)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfCountry = cmbCountry.nCurrentId
.head 6 -  Call hWndC.AbstractCustomer..setCountry(dfCountry)
.head 6 -  ! резидент
.head 6 +  If dfCountry != nCountryCode AND dfOkpo = '' and SalNumberMod(dfCodcagent+2, 2)
.head 7 -  Set dfOkpo = '000000000'
.head 6 -  ! Адрес
.head 6 +  If nRNK = 0 and nRezid != 1
.head 7 -  Set cAdr1.nCountry = dfCountry
.head 3 -  Background Text: Код в стране регистрации:
.head 4 -  Resource Id: 3885
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.3"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg16
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNRezidCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    4.25"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Тип гос. реестра:
.head 4 -  Resource Id: 44523
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.57"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg17
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    4.52"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbTgr.Init(hWndItem)
.head 7 -  ! tgr=2 для ФЛ (в т.ч. и СПД)
.head 7 -  ! tgr=1,2 для ФЛ-СПД
.head 7 -  ! tgr=1 для ЮЛ
.head 7 -  Call cmbTgr.Populate(hSql(), "tgr", "name", "tgr", 
"where " || IifS(nCType=3,IifS(bPersonSPD, "tgr in (1,2,3)", "tgr in (2,3)"), "tgr in (1,3)") || " order by tgr")
.head 7 -  Call cmbTgr.SetSelectById(dfTgr)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfTgr = cmbTgr.nCurrentId
.head 3 -  Background Text: Идентификационный код:
.head 4 -  Resource Id: 44522
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.84"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg18
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    4.79"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Set dfOkpo = SalStrTrimX(dfOkpo)
.head 6 +  If not SalIsNull(dfOkpo) and bVerifyClientParams
.head 7 +  If not SalIsValidNumber(dfOkpo) 
.head 8 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 8 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'))
.head 7 -  ! резидент
.head 7 +  If (nRezid = 1 or dfCountry = nCountryCrimea or dfCountry = nCountryCrimeaVEZ) and dfTgr != 3
.head 8 -  ! Проверка правильности заполнения
.head 8 +  If not CheckOkpo(nCType, dfOkpo)
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If nRNK = 0 and nCType = 3 and dfOkpo != '0000000000'
.head 9 -  Set hWndParent.Frm_Customer.dBdayByOkpo = SalFmtFormatStrDateTime('31/12/1899', 'dd/MM/yyyy') +
    Val(Subs(dfOkpo, 1, 5))
.head 9 +  If hWndParent.Frm_Customer.dBdayByOkpo > SalDateCurrent()
.head 10 -  Set hWndParent.Frm_Customer.dBdayByOkpo = DATETIME_Null
.head 9 -  Set hWndParent.Frm_Customer.nSexByOkpo  = 2 - SalNumberMod(Val(Subs(dfOkpo, 9, 1)), 2)
.head 8 -  ! Проверка уникальности
.head 8 +  If Left(dfOkpo, 9) != '000000000'
.head 9 -  ! Call Debug("
   SELECT date_off
   FROM   Customer
   INTO   :dDateTmp
   WHERE  okpo=:dfOkpo" || IifS(nCType=3, " and nvl(trim(sed),'00') " || IifS(bPersonSPD=TRUE, "=", "<>") ||
          "'91'", "") || IifS(nRNK=0, "", " and rnk<>:nRNK"))
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   SELECT date_off
   FROM   Customer
   INTO   :dDateTmp
   WHERE  okpo=:dfOkpo" || IifS(nCType=3, " and nvl(trim(sed),'00')" || IifS(bPersonSPD, "=", "<>") ||
          "'91'", "") || IifS(nRNK=0, "", " and rnk<>:nRNK"))
.head 10 +  If SqlFetchNext(hSql(), nFetchRes)
.head 11 +  If dDateTmp = DATETIME_Null
.head 12 -  ! Клиент банка с введенным ОКПО уже зарегистрирован!
.head 12 -  Call MessageAttention(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrOkpo'))
.head 12 +  If nCType = 3 and not bPersonSPD
.head 13 -  Return VALIDATE_Cancel
.head 11 +  Else
.head 12 -  ! Введенное ОКПО зарегистрировано у закрытого клиента!
.head 12 -  Call MessageAttention(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrOkpoDat'))
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Признак инсайдера (K060):
.head 4 -  Resource Id: 44520
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.11"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg19
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbPrinsider
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    5.06"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbPrinsider.Init(hWndItem)
.head 7 +  If isNN
.head 8 +  If nCType = 3
.head 9 -  Call cmbPrinsider.Populate(hSql(), "prinsider", "name", "Prinsider",
     IifS(sWherePrinsider="", "WHERE ", sWherePrinsider || " AND ") ||
     " otm<>2 and (d_close is null or d_close>glb_bankdate) ORDER BY prinsider")
.head 9 +  ! If nRNK = 0 AND dfTobo AND (dfPrinsider = NUMBER_Null OR dfPrinsider = 0)
.head 10 -  Set dfPrinsider = cmbPrinsider.GetKey(0)
.head 9 -  Call cmbPrinsider.SetSelectById(dfPrinsider)
.head 9 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT prinsider,tobo
 INTO   :nTmp,:sTmp
 FROM   prinsider")
.head 9 +  While SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set i = 0
.head 10 +  While i <= cmbPrinsider.nItemNum
.head 11 +  If Str(nTmp) = cmbPrinsider.strList[i,0]
.head 12 -  Set sListPrTobo[i] = sTmp
.head 12 -  Break
.head 11 -  Set i = i + 1
.head 8 +  Else
.head 9 -  Set dfPrinsider = 99
.head 9 -  Set cmbPrinsider = STRING_Null
.head 7 +  Else
.head 8 -  Call cmbPrinsider.Populate(hSql(), 'prinsider', 'name', 'Prinsider',
     'where d_close is null or d_close>glb_bankdate ORDER BY prinsider')
.head 8 -  Call cmbPrinsider.SetSelectById(dfPrinsider)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfPrinsider = cmbPrinsider.nCurrentId
.head 6 +  If isNN
.head 7 +  If nCType = 3
.head 8 +  If sTobo = ''
.head 9 -  Set i = 0
.head 9 +  Loop
.head 10 +  If i >= cmbPrinsider.nItemNum
.head 11 -  Set i = -1
.head 11 -  Break
.head 10 +  If cmbPrinsider.strList[i, 0] = Str(dfPrinsider)
.head 11 -  Set i = i
.head 11 -  Break
.head 10 -  Set i = i + 1
.head 9 -  Set sTmp = sListPrTobo[i]
.head 9 +  If sTmp != ''
.head 10 -  Set dfTobo = sTmp
.head 10 -  Call cmbTobo.SetSelectById(dfTobo)
.head 7 +  Else
.head 8 -  Set dfPrinsider = 99
.head 3 -  Background Text: Электронный код клиента:
.head 4 -  Resource Id: 44981
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    5.38"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg20
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSab
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    5.33"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  !
.head 6 +  If SalIsNull(dfSab)
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 -  ! SAB д.б. не < 4 симв.
.head 6 +  If SalStrLength(dfSab) < 4
.head 7 -  ! Введите правильный электронный код клиента!
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrSab'))
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Вид выписки:
.head 4 -  Resource Id: 44982
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    5.65"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg21
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbStmt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    5.6"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.202"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbStmt.Init(hWndItem)
.head 7 -  Call cmbStmt.Populate(hSql(), 'stmt', 'name', 'stmt', '')
.head 7 -  Call cmbStmt.SetSelectById(dfStmt)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfStmt = cmbStmt.nCurrentId
.head 3 -  Background Text: Код безбаланс. отделения:
.head 4 -  Resource Id: 15560
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    5.92"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg22
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTobo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    5.87"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If isNN
.head 7 +  If SalIsNull(dfTobo)
.head 8 -  Call SalListSetSelect(cmbTobo, -1)
.head 8 -  Call SalSendMsg(dfTobo, SAM_User, 0, 0)
.head 8 -  Return VALIDATE_Ok
.head 7 -  Call cmbTobo.SetSelectById(dfTobo)
.head 7 +  If cmbTobo.strCurrentId
.head 8 -  Call SalSendMsg(dfTobo, SAM_User, 0, 0)
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 +  If SalIsNull(dfTobo)
.head 8 -  Call SalListSetSelect(cmbTobo, -1)
.head 8 -  Return VALIDATE_Ok
.head 7 -  Call cmbTobo.SetSelectById(dfTobo)
.head 7 +  If cmbTobo.strCurrentId
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 5 +  On SAM_User
.head 6 -  ! Перечитываем cmbPrinsider с установленным ТОБО
.head 6 +  If sTobo = ''	! можно менять
.head 7 +  If dfTobo = ''
.head 8 -  Set sWherePrinsider = ""
.head 7 +  Else
.head 8 -  Set sWherePrinsider = "WHERE (nvl(tobo,'0')='0' OR tobo=" || dfTobo || ")"
.head 7 -  Set dfPrinsider = Val(sK060)
.head 7 -  Call SalSendMsg(cmbPrinsider, UM_ObjActivate, 0, 0)
.head 3 -  Background Text: Название безбаланс. отделения:
.head 4 -  Resource Id: 25210
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    6.19"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg23
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTobo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    6.14"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.202"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If isTobo
.head 7 +  If cmbTobo.Init(hWndItem)
.head 8 -  ! если bPossibleToEdit=FALSE, возможно что клиент закрыт и зарегистрирован на закрытое отделение,
! поэтому выбираем из всех отделений (tobo)
.head 8 -  Call cmbTobo.Populate(hSql(), 'tobo', 'name', IifS(bPossibleToEdit, 'v_tobo_open', 'tobo'), sWhereTobo ||
     " ORDER BY tobo")
.head 8 -  Call cmbTobo.SetSelectById(dfTobo)
.head 8 -  ! Если ТОБО не наше и не подчиненное, закрываем для редактирования
.head 8 +  If isTobo = 2 and sTobo != Subs(dfTobo, 1, Len(sTobo))
.head 9 -  Call SalDisableWindow(dfTobo)
.head 9 -  Call SalDisableWindow(cmbTobo)
.head 9 -  Call SqlPrepareAndExecute(hSql(), "select name into :sToboName from tobo where tobo=:dfTobo")
.head 9 +  If SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set cmbTobo = sToboName
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfTobo = cmbTobo.strCurrentId
.head 6 +  If isNN
.head 7 -  Call SalSendMsg(dfTobo, SAM_User, 0, 0)
.head 3 +  Child Table: tblAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    6.5"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOtm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colApply
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выбрать
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 +  If colLock
.head 9 -  Set colApply = not colApply
.head 5 +  Column: colLock
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPopulate
.head 5 -  Window Handle: hColumn
.head 5 -  ! Number: nTmpRnk
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set nNNAccsNum = 0
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"select acctype_code, acctype_name, 
        decode(need_open,'Y',1,0),
        decode(is_locked,'Y',1,0), acc_num
   into :tblAcc.colType, :tblAcc.colName, 
        :tblAcc.colOtm,  :tblAcc.colLock, :tblAcc.colNls
   from v_mvo_reqaccs
  where cust_id " || IifS(nRNK=0, " is null", "=:nRNK") || 
" order by acctype_code", TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 +  On SAM_FetchRowDone
.head 6 -  ! Отметка: надо открыть счет
.head 6 +  If colOtm
.head 7 -  Set colApply = 1
.head 7 -  ! Lock - нельзя менять отметку об открытии
.head 7 +  If colLock and nRNK = 0
.head 8 -  Call SalTblSetRowFlags(tblAcc, lParam, ROW_Edited, TRUE)
.head 6 +  If colNls
.head 7 -  Call XSalTblSetCellBackColor(tblAcc.colName,  SalColorFromRGB(230,255,230))
.head 7 -  Call XSalTblSetCellBackColor(tblAcc.colApply, SalColorFromRGB(230,255,230))
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 5 +  On UM_Update
.head 6 -  Set nNNAccsNum = 0
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If colLock
.head 8 -  Call SalTblSetRowFlags(tblAcc, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 7 +  Else
.head 8 -  Set nmNNAccs[nNNAccsNum,0] = colType
.head 8 -  Set nmNNAccs[nNNAccsNum,1] = colApply
.head 8 -  Set nNNAccsNum = nNNAccsNum + 1
.head 6 -  Return 1
.head 3 +  Data Field: dfFFF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.883"
.head 6 -  Top:    4.107"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.19"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfIII
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.883"
.head 6 -  Top:    4.298"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.19"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfOOO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.883"
.head 6 -  Top:    4.488"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.19"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setTop
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: nNext
.head 4 +  Actions
.head 5 -  Set nmTop[1] = 0.2
.head 5 -  Set nNext = 0.27
.head 5 -  Set i = 2
.head 5 +  While i <= 27
.head 6 -  Set nmTop[i] = nmTop[i-1] + nNext
.head 6 -  Set i = i + 1
.head 3 +  Function: SetField
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalSetWindowLabelText(bg1, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgRnk'))
.head 5 -  Call SalSetWindowLabelText(bg2, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNd1'))
.head 5 -  Call SalSetWindowLabelText(bg3, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk'))
.head 5 -  ! Увеличиваем размер окна, показываем ФИО
.head 5 +  If bFio
.head 6 -  Call SalGetWindowSize(hWndParent, nW, nH)
.head 6 -  Call SalSetWindowSize(hWndParent, nW, 6.8+0.27*IifN(nRezid=1,3,5))
.head 6 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 6 -  !
.head 6 -  Call SalShowWindow(dfNmkF)
.head 6 -  Call SalShowWindow(dfNmkI)
.head 6 -  Call SalShowWindow(dfNmkO)
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkF, 3.8, nmTop[4])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkI, 3.8, nmTop[5])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkO, 3.8, nmTop[6])
.head 6 +  If nRezid = 1
.head 7 -  Call SalSetWindowLabelText(bg4, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkF'))
.head 7 -  Call SalSetWindowLabelText(bg5, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkI'))
.head 7 -  Call SalSetWindowLabelText(bg6, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkO'))
.head 7 -  Call SalHideWindow(dfNmk4)
.head 7 -  Call SalSetWindowLabelText(bg7, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkv'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkv, 3.8, nmTop[7])
.head 7 -  Call SalSetWindowLabelText(bg8, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkk'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkk, 3.8, nmTop[8])
.head 7 -  Call SalSetWindowLabelText(bg9, sAdrName)
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr, 3.8, nmTop[9])
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr, 10.2, nmTop[9])
.head 7 -  !
.head 7 -  Call SalSetWindowLabelText(bg10, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr2'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr2, 3.8, nmTop[10])
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr2, 10.2, nmTop[10])
.head 7 -  Call SalSetWindowLabelText(bg11, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr3'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr3, 3.8, nmTop[11])
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr3, 10.2, nmTop[11])
.head 7 -  !
.head 7 -  Call SalSetWindowLabelText(bg12, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgK014'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfK014, 3.8, nmTop[12])
.head 7 -  Call SalSetWindowLabelText(bg13, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgK030'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfK030, 3.8, nmTop[13])
.head 7 -  Call SalSetWindowLabelText(bg14, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgCountry'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbCountry, 3.8, nmTop[14])
.head 7 -  Call SalSetWindowLabelText(bg15, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgTgr'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTgr, 3.8, nmTop[15])
.head 7 -  Call SalSetWindowLabelText(bg16, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfOkpo, 3.8, nmTop[16])
.head 7 -  Call SalSetWindowLabelText(bg17, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgPrinsider'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbPrinsider, 3.8, nmTop[17])
.head 7 -  Call SalSetWindowLabelText(bg18, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgSab'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfSab, 3.8, nmTop[18])
.head 7 -  Call SalSetWindowLabelText(bg19, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgStmt'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbStmt, 3.8, nmTop[19])
.head 7 +  If isTobo
.head 8 -  Call SalSetWindowLabelText(bg20, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgTobo'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfTobo, 3.8, nmTop[20])
.head 8 -  Call SalSetWindowLabelText(bg21, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgToboName'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTobo, 3.8, nmTop[21])
.head 7 -  Call SalSetWindowLabelText(bg22, '')
.head 7 -  Call SalSetWindowLabelText(bg23, '')
.head 6 +  Else
.head 7 -  Call SalSetWindowLabelText(bg4, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk1'))
.head 7 -  Call SalSetWindowLabelText(bg5, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk2'))
.head 7 -  Call SalSetWindowLabelText(bg6, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk3'))
.head 7 -  Call SalShowWindow(dfNmk4)
.head 7 -  Call SalSetWindowLabelText(bg7, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmk4'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmk4, 3.8, nmTop[7])
.head 7 -  Call SalSetWindowLabelText(bg8, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkv'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkv, 3.8, nmTop[8])
.head 7 -  Call SalSetWindowLabelText(bg9, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkk'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkk, 3.8, nmTop[9])
.head 7 -  Call SalSetWindowLabelText(bg10, sAdrName)
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr, 3.8, nmTop[10])
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr, 10.2, nmTop[10])
.head 7 -  !
.head 7 -  Call SalSetWindowLabelText(bg11, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr2'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr2, 3.8, nmTop[11])
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr2, 10.2, nmTop[11])
.head 7 -  Call SalSetWindowLabelText(bg12, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr3'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr3, 3.8, nmTop[12])
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr3, 10.2, nmTop[12])
.head 7 -  !
.head 7 -  Call SalSetWindowLabelText(bg13, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgK014'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfK014, 3.8, nmTop[13])
.head 7 -  Call SalSetWindowLabelText(bg14, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgK030'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfK030, 3.8, nmTop[14])
.head 7 -  Call SalSetWindowLabelText(bg15, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgCountry'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbCountry, 3.8, nmTop[15])
.head 7 -  Call SalSetWindowLabelText(bg16, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNRezidCode'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNRezidCode, 3.8, nmTop[16])
.head 7 -  Call SalSetWindowLabelText(bg17, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgTgr'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTgr, 3.8, nmTop[17])
.head 7 -  Call SalSetWindowLabelText(bg18, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfOkpo, 3.8, nmTop[18])
.head 7 -  Call SalSetWindowLabelText(bg19, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgPrinsider'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbPrinsider, 3.8, nmTop[19])
.head 7 -  Call SalSetWindowLabelText(bg20, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgSab'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfSab, 3.8, nmTop[20])
.head 7 -  Call SalSetWindowLabelText(bg21, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgStmt'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbStmt, 3.8, nmTop[21])
.head 7 +  If isTobo
.head 8 -  Call SalSetWindowLabelText(bg22, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgTobo'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfTobo, 3.8, nmTop[22])
.head 8 -  Call SalSetWindowLabelText(bg23, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgToboName'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTobo, 3.8, nmTop[23])
.head 5 +  Else
.head 6 -  Call SalGetWindowSize(hWndParent, nW, nH)
.head 6 -  Call SalSetWindowSize(hWndParent, nW, 6.8+0.27)
.head 6 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 6 -  !
.head 6 -  Call SalHideWindow(dfNmkF)
.head 6 -  Call SalHideWindow(dfNmkI)
.head 6 -  Call SalHideWindow(dfNmkO)
.head 6 -  Call SalHideWindow(dfNmk4)
.head 6 -  Call SalSetWindowLabelText(bg4, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkv'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkv, 3.8, nmTop[4])
.head 6 -  Call SalSetWindowLabelText(bg5, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkk'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkk, 3.8, nmTop[5])
.head 6 -  Call SalSetWindowLabelText(bg6, sAdrName)
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr, 3.8, nmTop[6])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr, 10.2, nmTop[6])
.head 6 -  !
.head 6 -  Call SalSetWindowLabelText(bg7, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr2'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr2, 3.8, nmTop[7])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr2, 10.2, nmTop[7])
.head 6 -  Call SalSetWindowLabelText(bg8, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr3'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfAdr3, 3.8, nmTop[8])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.pbAdr3, 10.2, nmTop[8])
.head 6 -  !
.head 6 -  Call SalSetWindowLabelText(bg9, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgK014'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfK014, 3.8, nmTop[9])
.head 6 -  Call SalSetWindowLabelText(bg10, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgK030'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfK030, 3.8, nmTop[10])
.head 6 -  Call SalSetWindowLabelText(bg11, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgCountry'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbCountry, 3.8, nmTop[11])
.head 6 +  If nRezid = 1
.head 7 -  Call SalSetWindowLabelText(bg12, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgTgr'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTgr, 3.8, nmTop[12])
.head 7 -  Call SalSetWindowLabelText(bg13, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfOkpo, 3.8, nmTop[13])
.head 7 -  Call SalSetWindowLabelText(bg14, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgPrinsider'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbPrinsider, 3.8, nmTop[14])
.head 7 -  Call SalSetWindowLabelText(bg15, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgSab'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfSab, 3.8, nmTop[15])
.head 7 -  Call SalSetWindowLabelText(bg16, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgStmt'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbStmt, 3.8, nmTop[16])
.head 7 +  If isTobo
.head 8 -  Call SalSetWindowLabelText(bg17, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgTobo'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfTobo, 3.8, nmTop[17])
.head 8 -  Call SalSetWindowLabelText(bg18, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgToboName'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTobo, 3.8, nmTop[18])
.head 7 -  Call SalSetWindowLabelText(bg19, '')
.head 6 +  Else
.head 7 -  Call SalSetWindowLabelText(bg12, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNRezidCode'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNRezidCode, 3.8, nmTop[12])
.head 7 -  Call SalSetWindowLabelText(bg13, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgTgr'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTgr, 3.8, nmTop[13])
.head 7 -  Call SalSetWindowLabelText(bg14, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfOkpo, 3.8, nmTop[14])
.head 7 -  Call SalSetWindowLabelText(bg15, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgPrinsider'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbPrinsider, 3.8, nmTop[15])
.head 7 -  Call SalSetWindowLabelText(bg16, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgSab'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfSab, 3.8, nmTop[16])
.head 7 -  Call SalSetWindowLabelText(bg17, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgStmt'))
.head 7 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbStmt, 3.8, nmTop[17])
.head 7 +  If isTobo
.head 8 -  Call SalSetWindowLabelText(bg18, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgTobo'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfTobo, 3.8, nmTop[18])
.head 8 -  Call SalSetWindowLabelText(bg19, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgToboName'))
.head 8 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTobo, 3.8, nmTop[19])
.head 6 -  Call SalSetWindowLabelText(bg20, '')
.head 6 -  Call SalSetWindowLabelText(bg21, '')
.head 6 -  Call SalSetWindowLabelText(bg22, '')
.head 6 -  Call SalSetWindowLabelText(bg23, '')
.head 5 -  Call SalInvalidateWindow(hWndForm)
.head 5 -  Return TRUE
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustGeneral.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 3 +  Function: setNmk
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfNmk = SalStrUpperX(Subs(SalStrTrimX(dfNmkF || ' ' || dfNmkI || ' ' || dfNmkO || ' ' || dfNmk4), 1, 70))
.head 5 -  Call hWndC.AbstractCustomer..setNmk(dfNmk)
.head 5 +  If nRNK = 0 or bNmkvNull
.head 6 -  Set dfNmkv = dfNmk
.head 5 -  Call SalSendMsg(dfNmkv, SAM_Validate, 0, 0)
.head 5 +  If nRNK = 0
.head 6 -  Set dfNmkk = SalStrMidX(dfNmk, 0, 38)
.head 5 -  Return TRUE
.head 3 +  Function: getAdr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nAdrType
.head 5 -  : cAdr
.head 6 -  Class: cCustAddress
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAdrCountry
.head 5 -  String: sAdrIndex
.head 5 -  String: sAdrObl
.head 5 -  String: sAdrReg
.head 5 -  String: sAdrCity
.head 5 -  String: sAdrStreet
.head 5 -  Number: nAdrTerritoryId
.head 5 -  String: sAdress
.head 4 +  Actions
.head 5 -  Call hWndC.AbstractCustomer..getCustomerAddress(nAdrType, cAdr)
.head 5 -  Set sAdress = 
  IifS(cAdr.sDomain='',   '', SalStrTrimX(cAdr.sDomain)   || ' ') || 
  IifS(cAdr.sRegion='',   '', SalStrTrimX(cAdr.sRegion)   || ' ') || 
  IifS(cAdr.sLocality='', '', SalStrTrimX(cAdr.sLocality) || ' ') || 
  IifS(cAdr.sAddress='',  '', SalStrTrimX(cAdr.sAddress))
.head 5 +  If Len(sAdress) > 70
.head 6 -  Set sAdress = 
  IifS(cAdr.sDomain='',   '', SalStrTrimX(cAdr.sDomain)   || ' ') || 
  IifS(cAdr.sLocality='', '', SalStrTrimX(cAdr.sLocality) || ' ') || 
  IifS(cAdr.sAddress='',  '', SalStrTrimX(cAdr.sAddress))
.head 6 +  If Len(sAdress) > 70
.head 7 -  Set sAdress = Subs(
  IifS(cAdr.sLocality='', '', SalStrTrimX(cAdr.sLocality) || ' ') || 
  IifS(cAdr.sAddress='',  '', SalStrTrimX(cAdr.sAddress)), 1, 70)
.head 5 -  Return sAdress
.head 3 +  Function: ShowAddress
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : cAdr
.head 6 -  Class: cCustAddress
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sAdress
.head 4 +  Actions
.head 5 -  Set sAdress = IifS(cAdr.nTypeId=1, dfAdr, IifS(cAdr.nTypeId=2, dfAdr2, dfAdr3))
.head 5 +  If SalModalDialog(Dlg_CustAdr, hWndForm, bPossibleToEdit, IifS(cAdr.nTypeId=1, sAdrName, IifS(cAdr.nTypeId=2,
   CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr2'), CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdr3'))),
   cAdr, cAdr1, sAdress)
.head 6 +  If cAdr.nTypeId = 1
.head 7 -  Set dfAdr = sAdress
.head 6 +  Else If cAdr.nTypeId = 2
.head 7 -  Set dfAdr2 = sAdress
.head 6 +  Else If cAdr.nTypeId = 3
.head 7 -  Set dfAdr3 = sAdress
.head 6 -  Call setEdited()
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  Boolean: bVerifyClientParams
.head 3 -  !
.head 3 -  Boolean: isNN
.head 3 -  Number: isTobo
.head 3 -  Boolean: bShowAddress
.head 3 -  Boolean: bShowTerritory
.head 3 -  String: sK060
.head 3 -  Boolean: bFio
.head 3 -  String: smPic[2]
.head 3 -  Number: nmTop[*]
.head 3 -  Number: nNumTop
.head 3 -  Number: nSAB_length
.head 3 -  Boolean: bPersonSPD
.head 3 -  ! Резидентность
.head 3 -  Number: nRezid
.head 3 -  Boolean: bNmkvNull
.head 3 -  ! Adr
.head 3 -  : cAdr1
.head 4 -  Class: cCustAddress
.head 3 -  : cAdr2
.head 4 -  Class: cCustAddress
.head 3 -  : cAdr3
.head 4 -  Class: cCustAddress
.head 3 -  String: sAdrName
.head 3 -  !
.head 3 -  String: sTobo
.head 3 -  String: sToboName
.head 3 -  String: sWhereTobo
.head 3 -  String: sWherePrinsider
.head 3 -  Number: nmNNAccs[*,2]
.head 3 -  Number: nNNAccsNum
.head 3 -  Date/Time: dDateTmp
.head 3 -  Number: nRow
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  String: sTmpNmk
.head 3 -  String: sTmpAdr
.head 3 -  String: sListPrTobo[*]
.head 3 -  Number: i
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 3 -  !
.head 3 -  Number: dfCodcagent
.head 3 -  Number: dfCountry
.head 3 -  Number: dfPrinsider
.head 3 -  Number: dfTgr
.head 3 -  Number: dfStmt
.head 3 -  ! String: dfNRezidCode
.head 3 -  !
.head 3 -  String: sTmpNmkv
.head 3 -  Number: nChrNmkv
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 3 -  Number: nW
.head 3 -  Number: nH
.head 3 -  !
.head 3 -  Number: nLocX
.head 3 -  Number: nLocY
.head 3 -  !
.head 3 -  String: dfIndex
.head 3 -  String: dfObl
.head 3 -  String: dfReg
.head 3 -  String: dfCity
.head 3 -  String: dfStreet
.head 3 -  Number: dfTerritoryId
.head 3 -  !
.head 3 -  ! Number: nX
.head 3 -  ! Number: nY
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustGeneral')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustGeneral.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set bVerifyClientParams = hWndParent.Frm_Customer.bVerifyClientParams
.head 4 -  !
.head 4 -  Set bPersonSPD = hWndParent.Frm_Customer.bPersonSPD
.head 4 -  Set nRezid     = hWndParent.Frm_Customer.nCRezid
.head 4 -  Set dfK014     = hWndParent.Frm_Customer.sK014Name
.head 4 -  Set dfK030     = hWndParent.Frm_Customer.sK030Name
.head 4 -  !
.head 4 +  If PAR_BANKTYPE = 'PRVX' and nCType = 2
.head 5 -  Call SalSetMaxDataLength(dfNmk, 182)
.head 4 +  Else
.head 5 -  Call SalSetMaxDataLength(dfNmk, 70)
.head 4 -  !
.head 4 -  Set isNN   = hWndParent.Frm_Customer.bNN
.head 4 -  Set isTobo = hWndParent.Frm_Customer.isTOBO
.head 4 +  If not SqlPrepareAndExecute(hSql(), 
"select data_length into :nSAB_length
   from all_tab_columns 
  where owner='BARS' and table_name='CUSTOMER' and column_name='SAB'")
or not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set nSAB_length = 4
.head 4 -  Call SalSetMaxDataLength(dfSab, nSAB_length)
.head 4 -  ! Показывать расширенный адрес клиента
.head 4 -  ! Set bShowAddress = hWndC.AbstractCustomer..isShowCustomerAddress()
.head 4 -  ! Возможность заполнять код территории
.head 4 -  Set bShowTerritory = hWndC.AbstractCustomer..isShowCustomerTerritory()
.head 4 -  Set sWhereTobo = ""
.head 4 +  If isTobo
.head 5 -  Set sTobo = hWndParent.Frm_Customer.sTOBO
.head 5 -  Set sTobo = IifS(isNN, IifS(sTobo='0', '', sTobo), sTobo)
.head 5 +  If isTobo = 1 and sTobo != '' and sTobo != '0'
.head 6 -  Call SalDisableWindow(dfTobo)
.head 6 -  Call SalDisableWindow(cmbTobo)
.head 5 +  Else If isTobo = 1 and isNN
.head 6 -  Set sWhereTobo = " WHERE tobo<>'0' "
.head 5 +  Else If isTobo = 2 and sTobo != ''
.head 6 -  Set sWhereTobo = " WHERE tobo like '" || sTobo || "%' "
.head 5 -  Set dfTobo = sTobo
.head 4 +  Else
.head 5 -  Call SalHideWindow(dfTobo)
.head 5 -  Call SalHideWindow(cmbTobo)
.head 5 -  Set dfTobo = ''
.head 4 -  Call setTop()
.head 4 -  Set dfTerritoryId = NUMBER_Null
.head 4 +  If isNN
.head 5 +  If nRNK = 0
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  ! PRINSIDER
.head 6 -  Call SalGetProfileString('RegKl', 'K060', '99', sK060, GetIniFileName())
.head 6 -  !
.head 6 -  Set dfDateOn = hWndParent.Frm_Customer.dDat
.head 6 +  If nRezid = 1
.head 7 -  Set dfCodcagent = IifN(nCType=1,1,IifN(nCType=2,3,5))
.head 7 -  Set dfCountry   = nCountryCode
.head 6 +  Else
.head 7 -  Set dfCodcagent = IifN(nCType=1,2,IifN(nCType=2,4,6))
.head 7 -  Set dfCountry   = NUMBER_Null
.head 6 -  Set dfTgr  = IifN(nCType=3,2,1)
.head 6 -  Set dfStmt = 0
.head 6 -  Set dfPrinsider = Val(sK060)
.head 6 -  Set dfTobo = sTobo
.head 6 -  Call hWndC.AbstractCustomer..setCodcagent(dfCodcagent)
.head 6 -  Call hWndC.AbstractCustomer..setCountry(dfCountry)
.head 5 +  Else
.head 6 +  If nCType = 3
.head 7 -  Set dfNmkF = hWndParent.Frm_Customer.sNmkF
.head 7 -  Set dfNmkI = hWndParent.Frm_Customer.sNmkI
.head 7 -  Set dfNmkO = hWndParent.Frm_Customer.sNmkO
.head 6 +  Else
.head 7 -  Set dfNmk = hWndC.AbstractCustomer..getNmk()
.head 6 -  Set dfDateOn    = hWndC.AbstractCustomer..getDateOn()
.head 6 -  Set dfNd1       = hWndC.AbstractCustomer..getNd()
.head 6 -  Set dfCodcagent = hWndC.AbstractCustomer..getCodcagent()
.head 6 -  Set dfCountry   = hWndC.AbstractCustomer..getCountry()
.head 6 -  Set dfTgr  = hWndC.AbstractCustomer..getTgr()
.head 6 -  Set dfStmt = hWndC.AbstractCustomer..getStmt()
.head 6 -  Set dfOkpo = hWndC.AbstractCustomer..getOkpo()
.head 6 -  Set dfNRezidCode = hWndC.AbstractCustomer..getNRezidCode()
.head 6 -  Set dfAdr  = hWndC.AbstractCustomer..getAdr()
.head 6 -  Set dfIndex  = hWndC.AbstractCustomer..getElementValue('SAZIP')
.head 6 -  Set dfObl    = hWndC.AbstractCustomer..getElementValue('SAOBL')
.head 6 -  Set dfReg    = hWndC.AbstractCustomer..getElementValue('SAREG')
.head 6 -  Set dfCity   = hWndC.AbstractCustomer..getElementValue('SASTL')
.head 6 -  Set dfStreet = hWndC.AbstractCustomer..getElementValue('SAADR')
.head 6 -  Set dfPrinsider = hWndC.AbstractCustomer..getPrinsider()
.head 6 -  Set dfTobo   = hWndC.AbstractCustomer..getTobo()
.head 5 -  Set sWherePrinsider = ""
.head 5 +  If dfTobo != ''
.head 6 -  Set sWherePrinsider = "WHERE (nvl(tobo,'0')='0' OR tobo=" || dfTobo || ")"
.head 5 -  !
.head 5 -  Call SalHideWindow(pbFio)
.head 5 -  Call SalHideWindow(pbAdr)
.head 5 -  Call SalHideWindow(dfDateOn)
.head 5 -  Call SalHideWindow(dfDateOff)
.head 5 -  Call SalHideWindow(dfRnk)
.head 5 -  Call SalHideWindow(dfNmk4)
.head 5 -  Call SalHideWindow(dfNmkv)
.head 5 -  Call SalHideWindow(dfNmkk)
.head 5 -  Call SalHideWindow(dfK014)
.head 5 -  Call SalHideWindow(dfK030)
.head 5 -  ! ND
.head 5 -  Call SalSetWindowLabelText(bg1, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNd1'))
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNd1, 3.8, nmTop[1])
.head 5 -  ! FIO
.head 5 +  If nCType = 3
.head 6 -  Call SalSetWindowLabelText(bg2, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkF'))
.head 6 -  Call SalSetWindowLabelText(bg3, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkI'))
.head 6 -  Call SalSetWindowLabelText(bg4, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkO'))
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkF, 3.8, nmTop[2])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkI, 3.8, nmTop[3])
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfNmkO, 3.8, nmTop[4])
.head 6 -  Call SalHideWindow(dfNmk)
.head 5 +  Else
.head 6 -  Call SalHideWindowAndLabel(bg2)
.head 6 -  Call SalHideWindowAndLabel(bg4)
.head 6 -  Call SalHideWindow(dfNmkF)
.head 6 -  Call SalHideWindow(dfNmkI)
.head 6 -  Call SalHideWindow(dfNmkO)
.head 5 -  ! Adr
.head 5 -  Call SalHideWindow(dfAdr)
.head 5 -  ! Call SalHideWindow(pbTerritoryId)
.head 5 -  ! Call SalHideWindow(dfTerritoryId)
.head 5 -  ! Call SalHideWindow(bgTerritoryId)
.head 5 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.picAdr, 0.08, nmTop[4] + 0.17 + 0.08 )
.head 5 -  ! Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.picAdr, 9.2, 0.27*5+0.02)
.head 5 -  !
.head 5 -  ! Call SalSetWindowLabelText(bg5, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgIndex'))
.head 5 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfIndex, 3.8, nmTop[5])
.head 5 -  ! Call SalSetWindowLabelText(bg6, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgObl'))
.head 5 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfObl, 3.8, nmTop[6])
.head 5 -  ! Call SalSetWindowLabelText(bg7, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgReg'))
.head 5 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfReg, 3.8, nmTop[7])
.head 5 -  ! Call SalSetWindowLabelText(bg8, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgCity'))
.head 5 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfCity, 3.8, nmTop[8])
.head 5 -  ! Call SalSetWindowLabelText(bg9, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgStreet'))
.head 5 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfStreet, 3.8, nmTop[9])
.head 5 -  ! Okpo
.head 5 -  Call SalSetWindowLabelText(bg10, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfOkpo, 3.8, nmTop[10])
.head 5 -  Call SalSetWindowLabelText(bg11, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgPrinsider'))
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbPrinsider, 3.8, nmTop[11])
.head 5 -  Call SalSetWindowLabelText(bg12, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgTobo'))
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.dfTobo, 3.8, nmTop[12])
.head 5 -  Call SalSetWindowLabelText(bg13, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgToboName'))
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.cmbTobo, 3.8, nmTop[13])
.head 5 -  ! Card
.head 5 +  If nCType = 3
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustGeneral.tblAcc,  0.2,  nmTop[14] + 0.05)
.head 5 +  Else
.head 6 -  Call SalHideWindow(tblAcc)
.head 5 -  !
.head 5 -  ! Call SalHideWindowAndLabel(bgCodcagent)
.head 5 -  ! Call SalHideWindow(cmbCodcagent)
.head 5 -  Call SalHideWindowAndLabel(bgDateOn)
.head 5 -  Call SalHideWindowAndLabel(bgDateOff)
.head 5 -  Call SalHideWindowAndLabel(bg14)
.head 5 -  Call SalHideWindowAndLabel(bg15)
.head 5 -  Call SalHideWindowAndLabel(bg16)
.head 5 -  Call SalHideWindowAndLabel(bg17)
.head 5 -  Call SalHideWindowAndLabel(bg18)
.head 5 -  Call SalHideWindowAndLabel(bg19)
.head 5 -  Call SalHideWindowAndLabel(bg20)
.head 5 -  Call SalHideWindowAndLabel(bg21)
.head 5 -  Call SalHideWindowAndLabel(bg22)
.head 5 -  Call SalHideWindowAndLabel(bg23)
.head 5 -  Call SalHideWindow(cmbCountry)
.head 5 -  Call SalHideWindow(dfNRezidCode)
.head 5 -  Call SalHideWindow(cmbTgr)
.head 5 -  Call SalHideWindow(dfSab)
.head 5 -  Call SalHideWindow(cmbStmt)
.head 5 -  Set bFio = FALSE
.head 5 -  Call SalSendMsg(hWndForm, WM_Size, 0, 0)
.head 4 +  Else
.head 5 -  Call SalHideWindow(tblAcc)
.head 5 +  If bPAR_RI
.head 6 -  Call SalDisableWindow(cmbPrinsider)
.head 5 +  If nRNK = 0
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  ! PRINSIDER
.head 6 -  Call SalGetProfileString('RegKl', 'K060', '99', sK060, GetIniFileName())
.head 6 -  !
.head 6 -  Set dfDateOn = hWndParent.Frm_Customer.dDat
.head 6 +  If nRezid = 1
.head 7 -  Set dfCodcagent = IifN(nCType=1,1,IifN(nCType=2,3,5))
.head 7 -  Set dfCountry   = nCountryCode
.head 6 +  Else
.head 7 -  Set dfCodcagent = IifN(nCType=1,2,IifN(nCType=2,4,6))
.head 7 -  Set dfCountry   = NUMBER_Null
.head 6 -  Set dfPrinsider = Val(sK060)
.head 6 -  Set dfTgr  = IifN(nCType=3, 2, 1)
.head 6 -  Set dfStmt = 0
.head 6 -  Set dfTobo = sTobo
.head 6 -  Call hWndC.AbstractCustomer..setCodcagent(dfCodcagent)
.head 6 -  Call hWndC.AbstractCustomer..setCountry(dfCountry)
.head 6 -  Set bFio = TRUE
.head 5 +  Else
.head 6 -  Set dfRnk  = hWndC.AbstractCustomer..getRnk()
.head 6 -  Set dfDateOn  = hWndC.AbstractCustomer..getDateOn()
.head 6 -  Set dfDateOff = hWndC.AbstractCustomer..getDateOff()
.head 6 -  Set dfNd1  = hWndC.AbstractCustomer..getNd()
.head 6 -  Set dfNmk  = hWndC.AbstractCustomer..getNmk()
.head 6 -  Set dfNmkv = hWndC.AbstractCustomer..getNmkv()
.head 6 -  Set dfNmkk = hWndC.AbstractCustomer..getNmkk()
.head 6 -  Set dfAdr  = hWndC.AbstractCustomer..getAdr()
.head 6 -  Set dfCodcagent = hWndC.AbstractCustomer..getCodcagent()
.head 6 -  Set dfCountry   = hWndC.AbstractCustomer..getCountry()
.head 6 -  Set dfPrinsider = hWndC.AbstractCustomer..getPrinsider()
.head 6 -  Set dfTgr  = hWndC.AbstractCustomer..getTgr()
.head 6 -  Set dfOkpo = hWndC.AbstractCustomer..getOkpo()
.head 6 -  Set dfNRezidCode = hWndC.AbstractCustomer..getNRezidCode()
.head 6 -  Set dfSab  = hWndC.AbstractCustomer..getSab()
.head 6 -  Set dfStmt = hWndC.AbstractCustomer..getStmt()
.head 6 -  Set dfTobo = hWndC.AbstractCustomer..getTobo()
.head 6 -  Set bFio = FALSE
.head 5 -  ! ФИО - только для ФЛ-не СПД
.head 5 +  If nCType = 3 and not bPersonSPD
.head 6 -  Set dfNmkF = hWndParent.Frm_Customer.sNmkF
.head 6 -  Set dfNmkI = hWndParent.Frm_Customer.sNmkI
.head 6 -  Set dfNmkO = hWndParent.Frm_Customer.sNmkO
.head 6 -  Set dfNmk4 = hWndParent.Frm_Customer.sNmk4
.head 5 +  Else
.head 6 -  Set bFio = FALSE
.head 6 -  Call SalHideWindow(pbFio)
.head 6 -  Call SalHideWindow(dfNmkF)
.head 6 -  Call SalHideWindow(dfNmkI)
.head 6 -  Call SalHideWindow(dfNmkO)
.head 6 -  Call SalHideWindow(dfNmk4)
.head 5 -  Set bNmkvNull = SalIsNull(dfNmkv)
.head 5 -  ! Резидентность
.head 5 +  If nRezid = 1 or dfCountry = nCountryCrimea or dfCountry = nCountryCrimeaVEZ
.head 6 -  Call SalHideWindow(dfNmk4)
.head 6 -  Call SalHideWindow(dfNRezidCode)
.head 6 -  Set dfNmk4 = ''
.head 6 -  Set dfNRezidCode = ''
.head 5 +  Else
.head 6 -  Call SalDisableWindow(cmbTgr)
.head 6 -  Call SalDisableWindow(dfOkpo)
.head 6 -  Set dfOkpo = '000000000'
.head 5 -  ! Adr
.head 5 +  If hWndParent.Frm_Customer.bPersonSPD
.head 6 -  Set sAdrName = CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdrFLP')
.head 5 +  Else
.head 6 -  Set sAdrName = IifS(nCType=1 or nCType=2, 
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdrUr'), 
     CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgAdrPropiska'))
.head 5 -  ! Adr ВСЕГДА заполняем в customer_address
.head 5 +  If (nCType = 2 OR nCType = 3) AND NOT hWndParent.Frm_Customer.isNBU
.head 6 -  Set dfAdr = getAdr(1, cAdr1)
.head 6 +  If nRNK = 0
.head 7 +  If nRezid = 1
.head 8 -  Set cAdr1.nCountry = nCountryCode
.head 6 +  Else
.head 7 +  If SalIsNull(dfAdr)
.head 8 -  Set dfAdr = hWndC.AbstractCustomer..getAdr()
.head 6 -  Set dfAdr2 = getAdr(2, cAdr2)
.head 6 -  Set dfAdr3 = getAdr(3, cAdr3)
.head 5 +  Else
.head 6 -  Call SalColorSet(dfAdr, COLOR_IndexWindow, COLOR_White)
.head 6 +  If bPossibleToEdit
.head 7 -  Call SalEnableWindow(dfAdr)
.head 6 -  Call SalHideWindow(pbAdr)
.head 6 -  Call SalHideWindow(dfAdr2)
.head 6 -  Call SalHideWindow(pbAdr2)
.head 6 -  Call SalHideWindowAndLabel(bg7)
.head 6 -  Call SalHideWindow(dfAdr3)
.head 6 -  Call SalHideWindow(pbAdr3)
.head 6 -  Call SalHideWindowAndLabel(bg8)
.head 5 -  Set smPic[0] = GetDir() || '\\RESOURCE\\BMP\\NEXTREC.BMP'
.head 5 -  Set smPic[1] = GetDir() || '\\RESOURCE\\BMP\\PREVREC.BMP'
.head 5 -  Call SalPicSetFile(pbFio, smPic[bFio])
.head 5 -  Call SetField()
.head 4 -  !
.head 4 +  If bPossibleToEdit 
.head 5 +  If (dfCountry = nCountryCode AND nRezid = 1)
or (dfCountry = nCountryCrimea)
or (dfCountry = nCountryCrimeaVEZ)
.head 6 -  Call SalDisableWindow(cmbCountry)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 +  If isNN AND nCType = 3
.head 5 -  Call SalSendMsg(hWndForm.Dlg_CustGeneral.tblAcc, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set dfFFF = CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkF')
.head 4 -  Set dfIII = CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkI')
.head 4 -  Set dfOOO = CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgNmkO')
.head 4 -  Call SalSetWindowLoc(dfFFF,  0.183, 1.06)
.head 4 -  Call SalSetWindowLoc(dfIII,  0.183, 1.33)
.head 4 -  Call SalSetWindowLoc(dfOOO,  0.183, 1.6)
.head 4 -  Call SalSetWindowSize(dfFFF, 3.64,  0.167)
.head 4 -  Call SalSetWindowSize(dfIII, 3.55,  0.167)
.head 4 -  Call SalSetWindowSize(dfOOO, 3.64,  0.167)
.head 4 -  Call SalHideWindow(dfFFF)
.head 4 -  Call SalHideWindow(dfIII)
.head 4 -  Call SalHideWindow(dfOOO)
.head 4 -  !
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 4 -  Set hWndParent.Frm_Customer.cTabCustGeneral.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call EnableWindow(dfNd1, FALSE)
.head 4 -  Call EnableWindow(dfNmk, FALSE)
.head 4 -  Call EnableWindow(dfNmkF, FALSE)
.head 4 -  Call EnableWindow(dfNmkI, FALSE)
.head 4 -  Call EnableWindow(dfNmkO, FALSE)
.head 4 -  Call EnableWindow(dfNmk4, FALSE)
.head 4 -  Call EnableWindow(dfNmkv, FALSE)
.head 4 -  Call EnableWindow(dfNmkk, FALSE)
.head 4 -  Call EnableWindow(dfAdr, FALSE)
.head 4 -  Call EnableWindow(dfAdr2, FALSE)
.head 4 -  Call EnableWindow(dfAdr3, FALSE)
.head 4 -  Call EnableWindow(cmbCountry, FALSE)
.head 4 -  Call EnableWindow(cmbPrinsider, FALSE)
.head 4 -  Call EnableWindow(cmbTgr, FALSE)
.head 4 -  Call EnableWindow(dfOkpo, FALSE)
.head 4 -  Call EnableWindow(dfNRezidCode, FALSE)
.head 4 -  Call EnableWindow(dfSab, FALSE)
.head 4 -  Call EnableWindow(cmbStmt, FALSE)
.head 4 -  Call EnableWindow(dfTobo, FALSE)
.head 4 -  Call EnableWindow(cmbTobo, FALSE)
.head 4 -  Call SalSendMsg(tblAcc, SAM_DoInit, 0, 0)
.head 3 +  On UM_Update
.head 4 +  If nCType = 3
.head 5 -  Return SalSendMsg(tblAcc, UM_Update, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_CustGeneral.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustGeneral.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  !
.head 4 -  ! ФИО
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustGeneral.dfNmk, nWW, nWH)
.head 4 +  If nCType = 3 and not bPersonSPD
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.dfNmk, 6.3, nWH)
.head 4 +  Else
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.dfNmk, 6.8, nWH)
.head 4 -  !
.head 4 -  ! Адрес
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustGeneral.dfAdr, nWW, nWH)
.head 4 +  If nCType = 2 OR nCType = 3
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.dfAdr, 6.3, nWH)
.head 4 +  Else
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.dfAdr, 6.8, nWH)
.head 4 -  !
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustGeneral.tblAcc, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustGeneral.tblAcc,
     SalPixelsToFormUnits(hWndForm.Dlg_CustGeneral.tblAcc, nWinWidth, FALSE)-0.5, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustGeneral.tblAcc, nWinHeight, TRUE)-3.9)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustNI
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Реквизиты налогоплательщика
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Check Box: cbUseNi
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Заполнять реквизиты Налогоплательщика
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.2"
.head 5 -  Width:  5.171"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cbUseNi = TRUE AND bPossibleToEdit
.head 7 -  Call EnableWindow(dfRegId, TRUE)
.head 7 -  Call EnableWindow(cmbC_reg, TRUE)
.head 7 -  Call EnableWindow(dfDstId, TRUE)
.head 7 -  Call EnableWindow(cmbC_dst, TRUE)
.head 7 -  Call EnableWindow(dfAdm, TRUE)
.head 7 -  Call EnableWindow(dfRgadm, TRUE)
.head 7 -  Call EnableWindow(dfDateA, TRUE)
.head 7 -  Call EnableWindow(dfRgtax, TRUE)
.head 7 -  Call EnableWindow(dfDateT, TRUE)
.head 7 -  Call EnableWindow(dfNomPDV, TRUE)
.head 7 -  Call EnableWindow(dfTaxf, TRUE)
.head 6 +  Else
.head 7 -  Call EnableWindow(dfRegId, FALSE)
.head 7 -  Call EnableWindow(cmbC_reg, FALSE)
.head 7 -  Call EnableWindow(dfDstId, FALSE)
.head 7 -  Call EnableWindow(cmbC_dst, FALSE)
.head 7 -  Call EnableWindow(dfAdm, FALSE)
.head 7 -  Call EnableWindow(dfRgadm, FALSE)
.head 7 -  Call EnableWindow(dfDateA, FALSE)
.head 7 -  Call EnableWindow(dfRgtax, FALSE)
.head 7 -  Call EnableWindow(dfDateT, FALSE)
.head 7 -  Call EnableWindow(dfNomPDV, FALSE)
.head 7 -  Call EnableWindow(dfTaxf, FALSE)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendMsg(cbUseNi, UM_ObjActivate, 0, 0)
.head 3 -  !
.head 3 -  Background Text: Областная НИ:
.head 4 -  Resource Id: 44916
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.6"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgC_reg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRegId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.512"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfRegId)
.head 7 -  Call SalListSetSelect(cmbC_reg, -1)
.head 7 -  Set dfDstId = NUMBER_Null
.head 7 -  Call SalListSetSelect(cmbC_dst, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbC_reg.SetSelectById(dfRegId)
.head 6 +  If cmbC_reg.nCurrentId
.head 7 -  Call SalSendMsg(cmbC_reg, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Call SalMessageBox('Неизвестный код', 'Ошибка!', MB_Ok | MB_IconStop )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustNI.cTErrKod'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbC_reg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.55"
.head 5 -  Top:    0.512"
.head 5 -  Width:  4.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.738"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbC_reg.Init(hWndItem)
.head 7 -  Call cmbC_reg.Populate(hSql(), 'c_reg', 'name_reg', 'Spr_obl', 'order by name_reg')
.head 7 -  Call cmbC_reg.SetSelectById(dfRegId)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfRegId = cmbC_reg.nCurrentId
.head 6 -  Call SalSendMsg(cmbC_dst, UM_ObjActivate, 0, 0)
.head 6 -  Call SalListSetSelect(cmbC_dst,0)
.head 6 -  Set dfDstId = cmbC_dst.GetKey(SalListQuerySelection(cmbC_dst))
.head 3 -  Background Text: Районная НИ:
.head 4 -  Resource Id: 44917
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.9"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgC_dst
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDstId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.821"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfDstId)
.head 7 -  Call SalListSetSelect(cmbC_dst, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbC_dst.SetSelectById(dfDstId)
.head 6 +  If cmbC_dst.nCurrentId
.head 7 -  Call SalSendMsg(cmbC_dst, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Call SalMessageBox('Неизвестный код', 'Ошибка!', MB_Ok | MB_IconStop )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustNI.cTErrKod'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbC_dst
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.55"
.head 5 -  Top:    0.821"
.head 5 -  Width:  4.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If dfRegId != -1
.head 7 +  If cmbC_dst.Init(hWndItem)
.head 8 -  Call cmbC_dst.Populate(hSql(), 'c_dst', 'name_sti', 'Spr_reg', 'WHERE c_reg=:hWndForm.Dlg_CustNI.dfRegId AND inuse=1 order by name_sti')
.head 8 -  ! Т.к. вместо "ЧЕРНIГIВСЬКА МIЖРАЙОННА ДПI" (t_sti=22)
  выбирается "ЧЕРНIГIВСЬКА МIЖРАЙОННА ДПI (ГОРОДНЯНСЬКЕ ВIД-НЯ)" (t_sti=6),
  т.е. cmbC_dst.SetSelectById(dfDstId) (SalListSelectString) выбирает 
  первую попавшуюся ПОХОЖУЮ строку, 
  делаем SalListSetSelect(cmbC_dst, nIndex) - выбираем значение по ключу,
  а не по наименованию (по ключу ищем номер строки в списке и 
  подставляем его в SalListSetSelect )
.head 8 -  ! Call cmbC_dst.SetSelectById( dfDstId )
.head 8 -  Set i = 0
.head 8 +  Loop
.head 9 +  If i >= cmbC_dst.nItemNum
.head 10 -  Set nIndex = -1
.head 10 -  Break
.head 9 +  If cmbC_dst.strList[i, 0] = SalNumberToStrX(dfDstId, 0)
.head 10 -  Set nIndex = i
.head 10 -  Break
.head 9 -  Set i = i + 1
.head 8 -  Call SalListSetSelect(cmbC_dst, nIndex)
.head 6 +  Else
.head 7 -  Call SalListClear(cmbC_dst)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfDstId = cmbC_dst.nCurrentId
.head 3 -  Background Text: Адм орган регистрации:
.head 4 -  Resource Id: 44921
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.2"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAdm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    1.119"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Номер регистрации в ДПА:
.head 4 -  Resource Id: 36019
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.5"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRgadm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRgadm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    1.4"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Дата рег. в ДПА:
.head 4 -  Resource Id: 44922
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.8"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDateA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    1.7"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfDateA)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Not SalIsValidDateTime(dfDateA)
.head 7 -  ! Return MessageErrorInput( 'Введите правильную дату регистрации клиента в администрации!' )
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustNI.cTErrDateA'))
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Номер регистрации в ДПИ:
.head 4 -  Resource Id: 44919
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.1"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRgtax
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRgtax
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    2.0"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Дата рег. в ДПИ:
.head 4 -  Resource Id: 44920
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.4"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDateT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    2.3"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull( dfDateT )
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Not SalIsValidDateTime( dfDateT )
.head 7 -  ! Return MessageErrorInput( 'Введите правильную дату регистрации клиента в НИ!' )
.head 7 -  Return MessageErrorInput( CurrentLangTable.GetAtomTitle('Dlg_CustNI.cTErrDateT') )
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Дані про платника ПДВ
.head 4 -  Resource Id: 53881
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.7"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPDVInfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: № свидельства плательщика ПДВ:
.head 4 -  Resource Id: 53882
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.0"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNomPDV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNomPDV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 9
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    2.9"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfNomPDV)
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 +  If Not SalIsValidNumber(dfNomPDV)
.head 7 -  ! Введите правильный номер!
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustInfo.cTErrNomPDV'))
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Инд. налоговый номер:
.head 4 -  Resource Id: 44918
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.3"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTaxf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTaxf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    3.2"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfTaxf)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Not SalIsValidNumber(dfTaxf)
.head 7 -  ! Введите правильный налоговый код клиента в НИ!
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustNI.cTErrTaxf'))
.head 6 -  Return VALIDATE_Ok
.head 3 -  ! Background Text: Дата рег. плат-ком ПДВ:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.6"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgTaxd
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Data Field: dfTaxd
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.5"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.end
.head 4 -  Message Actions 
.head 3 -  ! Background Text: Дата выдачи свидетельства:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.9"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgDatPDV
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Data Field: dfDatPDV
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.8"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.end
.head 4 -  Message Actions 
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.155"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    2.78"
.head 5 -  Width:  9.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.429"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustNI.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Number: i
.head 3 -  Number: nIndex
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustNI')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustNI.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 +  If bPAR_CUSTMNI and not ( nCType = 3 and not hWndParent.Frm_Customer.bPersonSPD ) and nCType != 1
.head 5 -  Call hWndC.AbstractCustomer..setUseNI(TRUE)
.head 5 -  Call SalDisableWindow(cbUseNi)
.head 4 -  Set cbUseNi = hWndC.AbstractCustomer..isUseNI()
.head 4 -  Call SalSendMsg(cbUseNi, UM_ObjActivate, 0, 0)
.head 4 -  !
.head 4 +  If nRNK != 0
.head 5 -  Set dfRegId  = hWndC.AbstractCustomer..getCReg()
.head 5 -  Set dfDstId  = hWndC.AbstractCustomer..getCDst()
.head 5 -  Set dfAdm    = hWndC.AbstractCustomer..getAdm()
.head 5 -  Set dfRgadm  = hWndC.AbstractCustomer..getRgAdm()
.head 5 -  Set dfDateA  = hWndC.AbstractCustomer..getDateA()
.head 5 -  Set dfRgtax  = hWndC.AbstractCustomer..getRgTax()
.head 5 -  Set dfDateT  = hWndC.AbstractCustomer..getDateT()
.head 5 -  Set dfNomPDV = hWndC.AbstractCustomer..getNomPDV()
.head 5 -  Set dfTaxf   = hWndC.AbstractCustomer..getTaxf()
.head 5 -  ! Set dfTaxd   = hWndC.AbstractCustomer..getTaxd()
.head 5 -  ! Set dfDatPDV = hWndC.AbstractCustomer..getDatPDV()
.head 4 +  Else
.head 5 -  Set dfRegId = -1
.head 5 -  Set dfDstId = -1
.head 4 -  !
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustNI.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(cbUseNi)
.head 4 -  Call EnableWindow(dfRegId, FALSE)
.head 4 -  Call EnableWindow(cmbC_reg, FALSE)
.head 4 -  Call EnableWindow(dfDstId, FALSE)
.head 4 -  Call EnableWindow(cmbC_dst, FALSE)
.head 4 -  Call EnableWindow(dfAdm, FALSE)
.head 4 -  Call EnableWindow(dfRgadm, FALSE)
.head 4 -  Call EnableWindow(dfDateA, FALSE)
.head 4 -  Call EnableWindow(dfRgtax, FALSE)
.head 4 -  Call EnableWindow(dfDateT, FALSE)
.head 4 -  Call EnableWindow(dfNomPDV, FALSE)
.head 4 -  Call EnableWindow(dfTaxf, FALSE)
.head 4 -  ! Call EnableWindow(dfTaxd, FALSE)
.head 4 -  ! Call EnableWindow(dfDatPDV, FALSE)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNI.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNI.pic2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.pic2, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.pic2, nWinHeight, TRUE)-2.84)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustNI.cmbC_reg, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNI.cmbC_reg,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.cmbC_reg, nWinWidth, FALSE)-4.85, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustNI.cmbC_dst, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNI.cmbC_dst,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.cmbC_dst, nWinWidth, FALSE)-4.85, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustNI.dfAdm, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNI.dfAdm,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.dfAdm, nWinWidth, FALSE)-4.2, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustNI.dfRgadm, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNI.dfRgadm,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNI.dfRgadm, nWinWidth, FALSE)-4.2, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustEN
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Экономические нормативы
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Економические показатели
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Check Box: cbUseEn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Заполнять Экономические нормативы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.2"
.head 5 -  Width:  6.086"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cbUseEn = TRUE and bPossibleToEdit
.head 7 -  Call FieldShow(TRUE)
.head 6 +  Else
.head 7 -  Call FieldShow(FALSE)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendMsg(cbUseEn, UM_ObjActivate, 0, 0)
.head 3 -  !
.head 3 -  Background Text: Инст. сек. экономики (K070):
.head 4 -  Resource Id: 44923
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.55"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIse
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIse
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.5"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Call SalColorSet(dfIse, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfIse)
.head 7 -  Call SalListSetSelect(cmbIse, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbIse.SetSelectById(dfIse)
.head 6 +  If not cmbIse.strCurrentId
.head 7 -  ! Нет такого сектора
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrIse'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipIse)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbIse
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    0.5"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.512"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbIse.Init(hWndItem)
.head 7 -  Call cmbIse.Populate(hSql(), "ise", "ise||' '||name", "ise", 
"where (d_close is null or d_close>=bankdate) and (ise='00000' or ise in (select k070 from kl_k070 where " ||
IifS(bPrRezid=TRUE, IifS(nCType=1 or nCType=2, "k072 not in ('L','N','0')",
               IifS(bPersonSPD=FALSE,"k072 in (" || PAR_CUSTK072 || ")","k072='L'")), "k072='0'") || "))
 order by ise")
.head 7 -  Call cmbIse.SetSelectById(dfIse)
.head 7 +  If NOT cmbIse.strCurrentId
.head 8 -  Call SalColorSet(dfIse, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM ise WHERE ise=:dfIse")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipIse = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfIse = cmbIse.strCurrentId
.head 6 -  Set sToolTipIse = ""
.head 6 -  Call SalColorSet(dfIse, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  Background Text: Форма собственности (K080):
.head 4 -  Resource Id: 58402
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.85"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.8"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Call SalColorSet(dfFs, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfFs)
.head 7 -  Call SalListSetSelect(cmbFs, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbFs.SetSelectById(dfFs)
.head 6 +  If not cmbFs.strCurrentId
.head 7 -  ! Нет такой формы
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrForm'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipFs)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbFs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    0.8"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  Call SalColorSet(dfFs, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If cmbFs.Init(hWndItem)
.head 7 -  Call cmbFs.Populate(hSql(), "fs", "fs||' '||name", "fs", 
"where (d_close is null or d_close>=bankdate) " ||
IifS(nCType=3, IifS(bPrRezid=TRUE, "and fs='10' ", "and fs in ('00', '10') "), " ") || 
"order by fs")
.head 7 -  Call cmbFs.SetSelectById(dfFs)
.head 7 +  If NOT cmbFs.strCurrentId
.head 8 -  Call SalColorSet(dfFs, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM fs WHERE fs=:dfFs")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipFs = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfFs = cmbFs.strCurrentId
.head 6 -  Set sToolTipFs = ""
.head 6 -  Call SalColorSet(dfFs, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  Background Text: Вид эк. деятельности (K110):
.head 4 -  Resource Id: 44926
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.15"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.1"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Call SalColorSet(dfVed, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfVed)
.head 7 -  Call SalListSetSelect(cmbVed, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbVed.SetSelectById(dfVed)
.head 6 +  If not cmbVed.strCurrentId
.head 7 -  ! Нет такого вида
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrVed'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Set dfVed = STRING_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipVed)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbVed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.1"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.893"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbVed.Init(hWndItem)
.head 7 -  Call cmbVed.Populate(hSql(), "ved", "ved||' '||name", "ved", 
"where (d_close is null or d_close>=bankdate) " || 
IifS(nCType!=3 or bPersonSPD, "and ved<>'00000' ", " ") ||
"order by ved")
.head 7 -  Call cmbVed.SetSelectById(dfVed)
.head 7 +  If NOT cmbVed.strCurrentId
.head 8 -  Call SalColorSet(dfVed, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM ved WHERE ved=:dfVed")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipVed = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVed = cmbVed.strCurrentId
.head 6 -  Set sToolTipVed = ""
.head 6 -  Call SalColorSet(dfVed, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  ! Background Text: Отрасль экономики (K090):
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.45"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgOe
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Data Field: dfOe
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.4"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Call SalColorSet(dfOe, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfOe)
.head 7 -  Call SalListSetSelect(cmbOe, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbOe.SetSelectById(dfOe)
.head 6 +  If not cmbOe.strCurrentId
.head 7 -  ! Нет такой отрасли
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrOe'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipOe)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  ! cGenComboBox_StrId: cmbOe
.winattr class Combo Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.4"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.738"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On UM_ObjActivate
.head 6 -  Call SalColorSet(dfOe, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If cmbOe.Init(hWndItem)
.head 7 -  Set sWhereOe = ''
.head 7 +  If dfVed
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT oelist INTO :sOeList FROM ved WHERE ved=:dfVed")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If sOeList
.head 9 +  If -1 = SalStrScan(sOeList, ':')
.head 10 -  Set sWhereOe = ' to_number(oe) in (' || sOeList || ')'
.head 9 +  Else 
.head 10 -  Set nNomS = SalStrTokenize(sOeList, '', ',', msOeList)
.head 10 +  If nNomS
.head 11 -  Set i = 0
.head 11 +  While i < nNomS
.head 12 -  Set nI = SalStrScan(msOeList[i], ':')
.head 12 +  If nI != -1
.head 13 -  Set sWhereOe = sWhereOe || IifS(sWhereOe!='',
' OR (to_number(oe) between ' || Subs(msOeList[i],1,5) || ' and ' || Subs(msOeList[i],nI+2,5)  || ')',
   ' (to_number(oe) between ' || Subs(msOeList[i],1,5) || ' and ' || Subs(msOeList[i],nI+2,5)  || ')')
.head 12 +  Else 
.head 13 -  Set sWhereOe = sWhereOe || IifS(sWhereOe!='',
' OR to_number(oe)='||msOeList[i],
   ' to_number(oe)='||msOeList[i] )
.head 12 -  Set i = i + 1
.head 7 -  Call cmbOe.Populate(hSql(), "Oe", "oe||' '||name", "Oe", 
"where (oe in ('00000', '99999') " || IifS( sWhereOe="", "", " or (" || sWhereOe || ")") || ")
   and (d_close is null or d_close>bankdate)" ||
"order by oe")
.head 7 -  Call cmbOe.SetSelectById(dfOe)
.head 7 +  If NOT cmbOe.strCurrentId
.head 8 -  Call SalColorSet(dfOe, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM oe WHERE oe=:dfOe")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipOe = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfOe = cmbOe.strCurrentId
.head 6 -  Set sToolTipOe = ""
.head 6 -  Call SalColorSet(dfOe, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  Background Text: Форма хозяйствования (K050):
.head 4 -  Resource Id: 36133
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.45"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgK050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.4"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Call FindSed()
.head 6 -  ! Call verifyK050()
.head 6 -  Call SalColorSet(dfK050, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfK050)
.head 7 -  Call SalListSetSelect(cmbK050, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbK050.SetSelectById(dfK050)
.head 6 +  If not cmbK050.strCurrentId
.head 7 -  ! Нет такой формы
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrForm'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop )
.head 7 -  Set dfK050 = STRING_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipSed)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbK050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.4"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbK050.Init(hWndItem)
.head 7 -  Call cmbK050.Populate(hSql(), "k050", "k050||' '||name", "sp_k050", 
"where length(trim(k050))=3 and (d_close is null or d_close>=bankdate) " || 
IifS(nCType!=3 or not bPersonSPD, "and k050<>'" || sK050SPD || "' ", " ") || 
IifS(nCType!=3 or bPersonSPD, "and k050<>'000' ", " ") ||
"order by k050")
.head 7 -  Call cmbK050.SetSelectById(dfK050)
.head 7 +  If NOT cmbK050.strCurrentId
.head 8 -  Call SalColorSet(dfK050, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM sp_k050 WHERE k050=:dfK050")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipK050 = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfK050 = cmbK050.strCurrentId
.head 6 -  Call FindSed()
.head 6 -  ! Call verifyK050()
.head 6 -  Set sToolTipK050 = ""
.head 6 -  Call SalColorSet(dfK050, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  Background Text: Форма хозяйствования (K051):
.head 4 -  Resource Id: 44927
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.7"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Call SalColorSet(dfSed, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfSed)
.head 7 -  Call SalListSetSelect(cmbSed, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbSed.SetSelectById(dfSed)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipSed)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbSed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.7"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbSed.Init(hWndItem)
.head 7 -  Call cmbSed.Populate(hSql(), "rtrim(sed)", "sed||' '||name", "sed", 
"where (d_close is null or d_close>=bankdate) order by sed")
.head 7 -  Call cmbSed.SetSelectById(dfSed)
.head 7 +  If NOT cmbSed.strCurrentId
.head 8 -  Call SalColorSet(dfSed, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM sed WHERE sed=:dfSed")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipSed = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfSed = cmbSed.strCurrentId
.head 6 -  Set sToolTipSed = ""
.head 6 -  Call SalColorSet(dfSed, COLOR_IndexWindowText, COLOR_Black)
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.095"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustEN.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 3 +  Function: setDefEN
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: bFlagValidate
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Только для нового клиента
.head 5 +  If nRNK = 0
.head 6 -  Set dfIse  = '00000'
.head 6 -  Set dfFs   = '00'
.head 6 -  Set dfVed  = '00000'
.head 6 -  Set dfOe   = '00000'
.head 6 -  Set dfK050 = '000'
.head 6 -  Set dfSed  = '00'
.head 6 -  ! Резидент
.head 6 +  If nRezid = 1
.head 7 +  If nCType = 3
.head 8 -  ! справочник kl_k080 (fs) закрыт и не используется
.head 8 -  ! Set dfFs = sK080
.head 8 -  ! ФЛ-неСПД
.head 8 +  If not bPersonSPD
.head 9 -  Set dfIse  = sK070
.head 9 -  Set dfK050 = sK050
.head 8 -  ! ФЛ-СПД
.head 8 +  If bPersonSPD
.head 9 -  Set dfK050 = sK050SPD
.head 8 -  Call FindSed()
.head 7 +  Else If nCType = 2
.head 8 -  Set dfIse  = STRING_Null
.head 8 -  Set dfFs   = STRING_Null
.head 8 -  Set dfVed  = STRING_Null
.head 8 -  Set dfK050 = STRING_Null
.head 8 -  Set dfSed  = STRING_Null
.head 6 +  Else
.head 7 -  Set dfIse  = '20000'
.head 6 +  If not SalIsNull(dfIse)
or not SalIsNull(dfVed)
or not SalIsNull(dfK050)
.head 7 -  Set cbUseEn = TRUE
.head 6 +  If bFlagValidate
.head 7 -  Call SalSendMsg(dfIse,  SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(dfVed,  SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(dfK050, SAM_Validate, 0, 0)
.head 7 -  Call SalSendMsg(dfSed,  SAM_Validate, 0, 0)
.head 5 -  Return TRUE
.head 3 +  Function: FieldShow
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: bShow
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If bShow
.head 6 -  Call SalEnableWindow(dfIse)
.head 6 -  Call SalEnableWindow(cmbIse)
.head 6 -  Call SalEnableWindow(dfVed)
.head 6 -  Call SalEnableWindow(cmbVed)
.head 6 -  Call SalEnableWindow(dfK050)
.head 6 -  Call SalEnableWindow(cmbK050)
.head 6 -  ! Сложности для ФЛ
.head 6 +  If nCType = 3
.head 7 -  ! так было
.head 7 -  ! Для ФЛ-СПД закрываем поле K050 (оно означает СПД-неСПД, его нельзя менять)
.head 7 +  ! If bPersonSPD
.head 8 -  Call SalDisableWindow(dfK050)
.head 8 -  Call SalDisableWindow(cmbK050)
.head 7 -  ! Для ФЛ-не СПД закрываем поле VED (для ФЛ-неСПД оно заполняются)
.head 7 +  ! Else If dfK050 != sK050SPD
.head 8 -  Call SalDisableWindow(dfVed)
.head 8 -  Call SalDisableWindow(cmbVed)
.head 7 -  !
.head 7 -  ! заявка № 14/2-01/5548 від 12.04.2016р (COBUSUPABS-4418)
.head 7 -  ! Для ФЛ закрываем поле K050
.head 7 -  !
.head 7 -  Call SalDisableWindow(dfK050)
.head 7 -  Call SalDisableWindow(cmbK050)
.head 7 +  If dfK050 != sK050SPD
.head 8 -  Call SalDisableWindow(dfVed)
.head 8 -  Call SalDisableWindow(cmbVed)
.head 5 +  Else
.head 6 -  Call SalDisableWindow(dfIse)
.head 6 -  Call SalDisableWindow(cmbIse)
.head 6 -  Call SalDisableWindow(dfVed)
.head 6 -  Call SalDisableWindow(cmbVed)
.head 6 -  Call SalDisableWindow(dfK050)
.head 6 -  Call SalDisableWindow(cmbK050)
.head 3 +  Function: FindSed
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If dfK050
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   select k051
   into   :dfSed
   from   sp_k050
   where  k050=:dfK050") or not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set dfSed = STRING_Null
.head 5 +  Else
.head 6 -  Set dfSed = STRING_Null
.head 5 -  Call SalSendMsg(dfSed, SAM_Validate, 0, 0)
.head 5 -  Return TRUE
.head 3 +  ! Function: verifyK050
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! проверка толька для режима "ФЛ и ФЛ-СПД", 
.head 5 -  ! т.к. только в этом режиме можно поменять признак СПД
.head 5 +  If nCType = 3 and nPersonSPD = 3
.head 6 +  If dfK050 != sK050SPD
.head 7 -  Set dfVed = '00000'
.head 7 -  Call SalDisableWindow(dfVed)
.head 7 -  Call SalDisableWindow(cmbVed)
.head 6 +  Else 
.head 7 -  Call SalEnableWindow(dfVed)
.head 7 -  Call SalEnableWindow(cmbVed)
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  String: sParEN
.head 3 -  Boolean: bPersonSPD
.head 3 -  ! Резидентность
.head 3 -  Number: nRezid
.head 3 -  Number: nCountry
.head 3 -  ! Признак Резидента (резидент/страна=11/страна=900)
.head 3 -  Boolean: bPrRezid
.head 3 -  !
.head 3 -  String: sK070
.head 3 -  String: sK080
.head 3 -  String: sK110
.head 3 -  String: sK050
.head 3 -  String: dfOe
.head 3 -  !
.head 3 -  String: sWhereOe
.head 3 -  String: sOeList
.head 3 -  String: msOeList[*]
.head 3 -  Number: nNomS
.head 3 -  Number: nI
.head 3 -  Number: i
.head 3 -  !
.head 3 -  String: sTmp
.head 3 -  String: sToolTipIse
.head 3 -  String: sToolTipFs
.head 3 -  String: sToolTipVed
.head 3 -  String: sToolTipOe
.head 3 -  String: sToolTipK050
.head 3 -  String: sToolTipSed
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustEN')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustEN.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set sParEN  = GetGlobalOption(IifS(nCType=1, 'EN_B', IifS(nCType=2, 'EN_U', 'EN_F')))
.head 4 +  If sParEN = '1'
.head 5 -  Call hWndC.AbstractCustomer..setUseEN(TRUE)
.head 5 -  Call SalDisableWindow(cbUseEn)
.head 4 -  Set cbUseEn = hWndC.AbstractCustomer..isUseEN()
.head 4 -  !
.head 4 -  Set bPersonSPD = hWndParent.Frm_Customer.bPersonSPD
.head 4 -  Set nRezid     = hWndParent.Frm_Customer.nCRezid
.head 4 -  Set nCountry   = hWndParent.Frm_Customer.nCountry
.head 4 -  !
.head 4 -  Set bPrRezid = nRezid=1 or nCountry=nCountryCrimea or nCountry=nCountryCrimeaVEZ
.head 4 -  !
.head 4 +  If nRNK = 0
.head 5 +  If nCType = 3 and nRezid = 1
.head 6 -  Set sK070 = GetGlobalOption('CUSTK070')
.head 6 -  Set sK080 = GetGlobalOption('CUSTK080')
.head 6 -  Set sK110 = GetGlobalOption('CUSTK110')
.head 6 -  Set sK050 = GetGlobalOption('CUSTK050')
.head 5 -  Call setDefEN(FALSE)
.head 4 +  Else
.head 5 -  Set dfIse  = hWndC.AbstractCustomer..getIse()
.head 5 -  Set dfFs   = hWndC.AbstractCustomer..getFs()
.head 5 -  Set dfVed  = hWndC.AbstractCustomer..getVed()
.head 5 -  Set dfOe   = hWndC.AbstractCustomer..getOe()
.head 5 -  Set dfK050 = hWndC.AbstractCustomer..getK050()
.head 5 -  Set dfSed  = hWndC.AbstractCustomer..getSed()
.head 5 -  !
.head 4 +  If not PAR_EN_FS
.head 5 -  Call SalHideWindow(dfFs)
.head 5 -  Call SalHideWindow(cmbFs)
.head 5 -  Call SalSetWindowLabelText(bgFs, CurrentLangTable.GetAtomTitle('Dlg_CustEN.bgVed'))
.head 5 -  Call SalSetWindowLoc(dfVed, 3.7, 0.8)
.head 5 -  Call SalSetWindowLoc(cmbVed, 4.6, 0.8)
.head 5 -  Call SalSetWindowLabelText(bgVed, CurrentLangTable.GetAtomTitle('Dlg_CustEN.bgK050'))
.head 5 -  Call SalSetWindowLoc(dfK050, 3.7, 1.1)
.head 5 -  Call SalSetWindowLoc(cmbK050, 4.6, 1.1)
.head 5 -  Call SalSetWindowLabelText(bgK050, CurrentLangTable.GetAtomTitle('Dlg_CustEN.bgSed'))
.head 5 -  Call SalSetWindowLoc(dfSed, 3.7, 1.4)
.head 5 -  Call SalSetWindowLoc(cmbSed, 4.6, 1.4)
.head 5 -  Call SalSetWindowLabelText(bgSed, '')
.head 4 -  Call SalDisableWindow(dfSed)
.head 4 -  Call SalDisableWindow(cmbSed)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 +  If nRezid = 2
.head 5 -  Call FieldShow(FALSE)
.head 4 -  !
.head 4 +  If nRNK != 0 and nCType = 3 and not bPersonSPD and (dfVed != '00000' or dfK050 != '000' or dfSed != '00')
.head 5 -  Set dfVed  = '00000'
.head 5 -  Set dfK050 = '000'
.head 5 -  Set dfSed  = '00'
.head 5 -  Call setEdited()
.head 5 -  Call MessageNoWait(IifS(GetLang()='UKR',
     'Змінені значення Економічних нормативів по замовчуванню, для фіксації натисніть "Зберегти".',
     'Изменены значения Экономических нормативов по умолчанию, для фиксации нажмите "Сохранить".'),
     IifS(GetLang()='UKR', 'УВАГА!', 'ВНИМАНИЕ!'), 7, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustEN.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(cbUseEn)
.head 4 -  Call EnableWindow(dfIse, FALSE)
.head 4 -  Call EnableWindow(cmbIse, FALSE)
.head 4 -  Call EnableWindow(dfFs, FALSE)
.head 4 -  Call EnableWindow(cmbFs, FALSE)
.head 4 -  Call EnableWindow(dfVed, FALSE)
.head 4 -  Call EnableWindow(cmbVed, FALSE)
.head 4 -  Call EnableWindow(dfK050, FALSE)
.head 4 -  Call EnableWindow(cmbK050, FALSE)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustEN.pic1, SalPixelsToFormUnits(hWndForm.Dlg_CustEN.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustEN.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustEN.cmbIse, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustEN.cmbIse,
     SalPixelsToFormUnits(hWndForm.Dlg_CustEN.cmbIse, nWinWidth, FALSE)-4.9, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustEN.cmbFs, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustEN.cmbFs,
     SalPixelsToFormUnits(hWndForm.Dlg_CustEN.cmbFs, nWinWidth, FALSE)-4.9, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustEN.cmbVed, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustEN.cmbVed,
     SalPixelsToFormUnits(hWndForm.Dlg_CustEN.cmbVed, nWinWidth, FALSE)-4.9, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustEN.cmbK050, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustEN.cmbK050,
     SalPixelsToFormUnits(hWndForm.Dlg_CustEN.cmbK050, nWinWidth, FALSE)-4.9, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustEN.cmbSed, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustEN.cmbSed,
     SalPixelsToFormUnits(hWndForm.Dlg_CustEN.cmbSed, nWinWidth, FALSE)-4.9, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustBank
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Реквизиты банков
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Рейтинг банка:
.head 4 -  Resource Id: 44929
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRating
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRating
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.2"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Код банка МФО:
.head 4 -  Resource Id: 44930
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.536"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 9
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfMfo)
.head 7 -  Call setEdited()
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 -  Set nRecCount = 0
.head 6 -  Call SqlPrepareAndExecute(hSql(), T('SELECT count(*) FROM Banks INTO :nRecCount WHERE mfo=:dfMfo'))
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nRecCount = 0
.head 7 +  If MessageQuestion(MSG_DOC_IErrorMfoEx ) = IDYES
.head 8 -  Call SalSendMsg(pbBanks, SAM_Click, 0, 0)
.head 8 +  If SalIsNull(dfMfo)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set dfMfo = ''
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Код банка BIC:
.head 4 -  Resource Id: 44931
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.821"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.774"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfBic = SalStrUpperX(dfBic)
.head 6 -  !
.head 6 +  If SalIsNull(dfBic)
.head 7 -  Call setEdited()
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 -  Set nRecCount = 0
.head 6 -  Call SqlPrepareAndExecute(hSql(), T('SELECT count(*) FROM Sw_banks INTO :nRecCount WHERE bic=:dfBic'))
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 +  If nRecCount = 0
.head 7 +  If MessageQuestion(MSG_DOC_IErrorBicEx) = IDYES
.head 8 -  Call SalSendMsg(pbSwBanks, SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Альтернативный BIC-код:
.head 4 -  Resource Id: 39422
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.107"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBicAlt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBicAlt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.06"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Код банка для 1ПБ:
.head 4 -  Resource Id: 44932
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.393"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg1PB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: df1PB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.345"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(df1PB)
.head 7 -  Call setEdited()
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 -  Set nRecCount = 0
.head 6 -  ! Call SqlPrepareAndExecute(hSql(), T('SELECT count(*) FROM bopbank INTO :nRecCount WHERE regnum=:df1PB'))
.head 6 -  ! Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If SqlPrepareAndExecute(hSql(), T('
   SELECT count(*)
   FROM   rcukru
   INTO   :nRecCount
   WHERE  glb<>0 and to_char(glb)=trim(:df1PB)')) and SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If nRecCount = 0
.head 8 -  ! Call SalMessageBox('Неверно указан код банка для 1ПБ.', 'Внимание!', MB_Ok)
.head 8 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustBank.cTErr1PB'))
.head 6 +  Else
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Руководитель:
.head 4 -  Resource Id: 44971
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.679"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRuk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRuk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.631"
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Гл. бухгалтер банка:
.head 4 -  Resource Id: 44973
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.964"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBuh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBuh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.917"
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Телефон руководителя:
.head 4 -  Resource Id: 44974
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.25"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTelR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.202"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Телефон гл. бухгалтера:
.head 4 -  Resource Id: 44972
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.536"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTelB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.488"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.262"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pbBanks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.033"
.head 5 -  Top:    0.488"
.head 5 -  Width:  0.37"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If NOT FunNSIGet('BANKS','',dfMfo, strBankName)
.head 7 -  Set dfMfo = ''
.head 6 -  Call setEdited()
.head 3 +  Picture: pbSwBanks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.033"
.head 5 -  Top:    0.774"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call FunNSIGet('SW_BANKS','',dfBic, strBankName)
.head 6 -  Call setEdited()
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustOwn.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Number: nRecCount
.head 3 -  String: strBankName
.head 3 -  !
.head 3 -  Number: nCodcagent
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustBank')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustOwn.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit 
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set nCodcagent = hWndC.AbstractCustomer..getCodcagent()
.head 4 +  If bPossibleToEdit 
.head 5 -  ! Банк-резидент
.head 5 -  If SalNumberMod(nCodcagent + 2, 2)
.head 5 -  ! Банк-НЕрезидент
.head 5 +  Else
.head 6 -  Call EnableWindow(dfMfo, FALSE)
.head 6 -  Call SalDisableWindow(pbBanks)
.head 4 -  !
.head 4 -  If nRNK = 0
.head 4 +  Else
.head 5 -  Set dfRating = hWndC.AbstractCustomer..getRating()
.head 5 -  Set dfMfo    = hWndC.AbstractCustomer..getMfo()
.head 5 -  Set dfBic    = hWndC.AbstractCustomer..getBic()
.head 5 -  Set dfBicAlt = hWndC.AbstractCustomer..getBicAlt()
.head 5 -  Set df1PB    = Str(hWndC.AbstractCustomer..getKodB())
.head 5 -  Set dfRuk    = hWndC.AbstractCustomer..getRuk()
.head 5 -  Set dfTelR   = hWndC.AbstractCustomer..getTelR()
.head 5 -  Set dfBuh    = hWndC.AbstractCustomer..getBuh()
.head 5 -  Set dfTelB   = hWndC.AbstractCustomer..getTelB()
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(hWndForm, SAM_User, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustOwn.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call EnableWindow(dfRating, FALSE)
.head 4 -  Call EnableWindow(dfMfo, FALSE)
.head 4 -  Call SalDisableWindow(pbBanks)
.head 4 -  Call EnableWindow(dfBic, FALSE)
.head 4 -  Call SalDisableWindow(pbSwBanks)
.head 4 -  Call EnableWindow(dfBicAlt, FALSE)
.head 4 -  Call EnableWindow(df1PB, FALSE)
.head 4 -  Call EnableWindow(dfRuk, FALSE)
.head 4 -  Call EnableWindow(dfTelR, FALSE)
.head 4 -  Call EnableWindow(dfBuh, FALSE)
.head 4 -  Call EnableWindow(dfTelB, FALSE)
.head 3 +  On SAM_User
.head 4 -  Set nCodcagent = hWndC.AbstractCustomer..getCodcagent()
.head 4 -  ! Банк-резидент
.head 4 +  If SalNumberMod(nCodcagent + 2, 2)
.head 5 +  If bPossibleToEdit 
.head 6 -  Call EnableWindow(dfMfo, TRUE)
.head 6 -  Call SalEnableWindow(pbBanks)
.head 6 -  Call SalEnableWindow(df1PB)
.head 4 -  ! Банк-НЕрезидент
.head 4 +  Else
.head 5 -  Call EnableWindow(dfMfo, FALSE)
.head 5 -  Call SalDisableWindow(pbBanks)
.head 5 -  Set df1PB = ''
.head 5 -  Call SalDisableWindow(df1PB)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustBank.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_CustBank.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustBank.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustBank.dfRuk, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustBank.dfRuk,
     SalPixelsToFormUnits(hWndForm.Dlg_CustBank.dfRuk, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustBank.dfBuh, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustBank.dfBuh,
     SalPixelsToFormUnits(hWndForm.Dlg_CustBank.dfBuh, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustCorp
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.367"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.69"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Реквизиты юридических лиц
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Наименование по уставу:
.head 4 -  Resource Id: 44934
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.286"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNmku
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmku
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 250
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.2"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Руководитель:
.head 4 -  Resource Id: 44935
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.583"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRuk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRuk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.5"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Гл. бухгалтер предприятия:
.head 4 -  Resource Id: 44937
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.881"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBuh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBuh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.8"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Телефон руководителя:
.head 4 -  Resource Id: 44936
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.179"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTelR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.1"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Телефон гл. бухгалтера:
.head 4 -  Resource Id: 44938
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.488"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTelB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.4"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Факс:
.head 4 -  Resource Id: 18793
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.786"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelFax
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTelFax
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.7"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Адрес электронной почты:
.head 4 -  Resource Id: 18794
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.083"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgEMail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEMail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.0"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  ! Background Text: Адреса клиента
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.32"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgAddress
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Child Table: tblAddress
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.55"
.head 6 -  Width:  8.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.05"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents 
.head 5 +  Column: colTypeId
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colTypeName
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип адреса
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colCountry
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colCountryName
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Страна
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 +  If colCountryName.Init(hWndItem)
.head 9 -  Call colCountryName.Populate(hSql(), 'country', 'name', 'country', 'order by name')
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 -  Set colCountry = Dlg_CustCorp.tblAddress.colCountryName.GetKey(SalListQuerySelection(colCountryName))
.head 5 +  Column: colZip
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Индекс
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 20
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colDomain
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Область
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 7 +  On SAM_Validate
.head 8 +  If PAR_CUSTADRT and not colTerritoryId
.head 9 -  Set colDomain = STRING_Null
.head 9 -  ! Не заполнен код территории! Выбрать из справочника?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTMsgTerrNotSet') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('cTGetFromNsi') || '?', 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo) = IDYES
.head 10 -  Call SalSendMsg(pbTerritoryId, SAM_Click, 0, 0)
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: colRegion
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Регион
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 7 +  On SAM_Validate
.head 8 +  If PAR_CUSTADRT and not colTerritoryId
.head 9 -  Set colRegion = STRING_Null
.head 9 -  ! Не заполнен код территории! Выбрать из справочника?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTMsgTerrNotSet') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('cTGetFromNsi') || '?', 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo) = IDYES
.head 10 -  Call SalSendMsg(pbTerritoryId, SAM_Click, 0, 0)
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: colLocality
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Населенный пукт
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 7 +  On SAM_Validate
.head 8 +  If PAR_CUSTADRT and not colTerritoryId
.head 9 -  Set colLocality = STRING_Null
.head 9 -  ! Не заполнен код территории! Выбрать из справочника?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTMsgTerrNotSet') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('cTGetFromNsi') || '?', 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo) = IDYES
.head 10 -  Call SalSendMsg(pbTerritoryId, SAM_Click, 0, 0)
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: colAddress
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Адрес (улица, дом, квартира)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colTerritoryId
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код территории
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  Number: nRow
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nRowErr
.head 5 -  String: sPK
.head 5 -  String: sSem
.head 5 -  Number: nTerrId
.head 5 -  String: sObl
.head 5 -  String: sReg
.head 5 -  String: sCity
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"select id, name
   into :tblAddress.colTypeId, :tblAddress.colTypeName
   from customer_address_type
  where id in (2, 3)
  order by id", TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colTypeName)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call hWndC.AbstractCustomer..getCustomerAddress(nRNK, colTypeId,
     colCountry, colZip, colDomain, colRegion, colLocality, colAddress, colTerritoryId)
.head 6 +  If NOT colCountry
.head 7 -  Set colCountry = nCountryCode
.head 6 -  Call colCountryName.SetSelectById(colCountry)
.head 5 +  On SAM_User
.head 6 +  If SalTblAnyRows(hWndForm, 0, 0)
.head 7 -  Set nRow = SalTblQueryContext(hWndForm)
.head 7 +  If FunNSIGetFiltered('TERRITORY', 'CITY', '', sPK, sSem)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"select id, region, district, city 
   into :nTerrId, :sObl, :sReg, :sCity 
   from territory where id=:sPK")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set colTerritoryId = nTerrId
.head 9 -  Set colDomain = sObl
.head 9 -  Set colRegion = sReg
.head 9 -  Set colLocality = sCity
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 -  Call setEdited()
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call hWndC.AbstractCustomer..setCustomerAddress( 
     colTypeId, colCountry, colZip, 
     colDomain, colRegion, colLocality, colAddress, colTerritoryId)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 -  Background Text: Реквизиты в других банках
.head 4 -  Resource Id: 44940
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.32"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.55"
.head 6 -  Width:  8.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.107"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colListIndex
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ListIndex
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Id
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If SalIsNull(colMfo)
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT nb INTO :colBankName FROM banks WHERE mfo=:colMfo")
.head 8 +  If NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Несуществующее МФО!
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrMfo'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  !
.head 8 +  If NOT SalIsNull(colNls)
.head 9 +  If colNls != KeyAccount(colMfo, colNls)
.head 10 -  ! Неверный контрольный разряд счета!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrNls'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colBankName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название банка
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If SalIsNull(colMfo)
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT mfo INTO :colMfo FROM banks WHERE mfo=:colMfo")
.head 8 +  If NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Call SalMessageBox('Несуществующее МФО!', 'Ошибка!', MB_Ok | MB_IconStop )
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrMfo'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  !
.head 8 +  If NOT SalIsNull(colNls)
.head 9 +  If colNls != KeyAccount(colMfo, colNls)
.head 10 -  ! Call SalMessageBox('Неверный контрольный разряд счета!', 'Ошибка!', MB_Ok | MB_IconExclamation)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrNls'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If SalIsNull(colNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If colNls != KeyAccount(colMfo, colNls)
.head 9 -  ! Call SalMessageBox('Неверный контрольный разряд счета!', 'Ошибка!', MB_Ok | MB_IconExclamation)
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrNls'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKvName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If colKvName.Init(hWndItem)
.head 9 -  Call colKvName.Populate(hSql(), "kv", "lcv || ' ' || name", "tabval", 
"where (d_close is null or d_close>=bankdate) order by skv")
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 -  Set colKv = colKvName.GetKey(SalListQuerySelection(colKvName))
.head 8 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  Column: colComm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW56_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SW56_Name
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW56_Adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW56_Code
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Code
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Acc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW59_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW59_Adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW59_Acc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nCtlState
.head 5 -  String: sSW56_Name
.head 5 -  String: sSW56_Adr
.head 5 -  String: sSW56_Code
.head 5 -  String: sSW57_Name
.head 5 -  String: sSW57_Adr
.head 5 -  String: sSW57_Code
.head 5 -  String: sSW57_Acc
.head 5 -  String: sSW59_Name
.head 5 -  String: sSW59_Adr
.head 5 -  String: sSW59_Acc
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set nRow = 0 
.head 6 +  While nRow < hWndC.AbstractCustomer..getCorpAccParNum()
.head 7 -  Call SalTblInsertRow(hWndForm, nRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colListIndex = nRow
.head 7 -  Call hWndC.AbstractCustomer..getCorpAcc(colListIndex, colId, colMfo, colNls, colKv, colComm, colBankName,
     colSW56_Name, colSW56_Adr, colSW56_Code,
     colSW57_Name, colSW57_Adr, colSW57_Code, colSW57_Acc,
     colSW59_Name, colSW59_Adr, colSW59_Acc)
.head 7 -  Call colKvName.SetSelectById(colKv)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 7 +  If colSW56_Name != STRING_Null or colSW56_Adr != STRING_Null or colSW56_Code != STRING_Null
or colSW57_Name != STRING_Null or colSW57_Adr != STRING_Null or colSW57_Code != STRING_Null or colSW57_Acc != STRING_Null
or colSW59_Name != STRING_Null or colSW59_Adr != STRING_Null or colSW59_Acc  != STRING_Null
.head 8 -  Call XSalTblSetRowBackColor(hWndForm, nRow, SalColorFromRGB(230, 255, 255))
.head 7 -  Set nRow = nRow + 1
.head 6 +  If nRow > 0
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 +  If PAR_BANKTYPE = 'PRVX'
.head 7 +  If colKv = GetBaseVal()
.head 8 -  Call SalDisableWindow(pbSWReceiver)
.head 7 +  Else
.head 8 -  Call SalEnableWindow(pbSWReceiver)
.head 5 +  On UM_Insert
.head 6 -  Call setEdited()
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, nRow + 1)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRow, colMfo, 0, 1)
.head 5 +  On UM_Delete
.head 6 -  Call setEdited()
.head 6 +  If NOT SalTblSetFlagsAnyRows(hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted)
.head 7 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0)
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited | ROW_New | ROW_MarkDeleted, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
.head 8 +  If colId != NUMBER_Null
.head 9 -  Call hWndC.AbstractCustomer..deleteCorpAcc(colId)
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 8 -  Set nRow = nRow - 1
.head 7 +  Else
.head 8 -  Call hWndC.AbstractCustomer..setCorpAcc(colListIndex, colId, colMfo, colNls, colKv, colComm,
     colSW56_Name, colSW56_Adr, colSW56_Code,
     colSW57_Name, colSW57_Adr, colSW57_Code, colSW57_Acc,
     colSW59_Name, colSW59_Adr, colSW59_Acc)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On SAM_User
.head 6 +  If SalTblAnyRows(hWndForm, 0, 0)
.head 7 -  Set nRow = SalTblQueryContext(hWndForm)
.head 7 -  Set sSW56_Name = colSW56_Name
.head 7 -  Set sSW56_Adr  = colSW56_Adr
.head 7 -  Set sSW56_Code = colSW56_Code
.head 7 -  Set sSW57_Name = colSW57_Name
.head 7 -  Set sSW57_Adr  = colSW57_Adr
.head 7 -  Set sSW57_Code = colSW57_Code
.head 7 -  Set sSW57_Acc  = colSW57_Acc
.head 7 -  Set sSW59_Name = colSW59_Name
.head 7 -  Set sSW59_Adr  = colSW59_Adr
.head 7 -  Set sSW59_Acc  = colSW59_Acc
.head 7 +  If sSW59_Name = ''
.head 8 -  Set sSW59_Name = sNmkM
.head 7 +  If sSW59_Adr = ''
.head 8 -  Set sSW59_Adr = sAdrM
.head 7 +  If SalModalDialog(DlgSWReceiver, hWndForm, bPossibleToEdit,
   colMfo, colBankName, colNls, colKvName,
   sSW56_Name, sSW56_Adr, sSW56_Code,
   sSW57_Name, sSW57_Adr, sSW57_Code, sSW57_Acc,
   sSW59_Name, sSW59_Adr, sSW59_Acc)
.head 8 +  If bPossibleToEdit
.head 9 -  Call setEdited()
.head 9 -  Set colSW56_Name = sSW56_Name
.head 9 -  Set colSW56_Adr  = sSW56_Adr
.head 9 -  Set colSW56_Code = sSW56_Code
.head 9 -  Set colSW57_Name = sSW57_Name
.head 9 -  Set colSW57_Adr  = sSW57_Adr
.head 9 -  Set colSW57_Code = sSW57_Code
.head 9 -  Set colSW57_Acc  = sSW57_Acc
.head 9 -  Set colSW59_Name = sSW59_Name
.head 9 -  Set colSW59_Adr  = sSW59_Adr
.head 9 -  Set colSW59_Acc  = sSW59_Acc
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 +  If colSW56_Name != STRING_Null or colSW56_Adr != STRING_Null or colSW56_Code != STRING_Null
or colSW57_Name != STRING_Null or colSW57_Adr != STRING_Null or colSW57_Code != STRING_Null or colSW57_Acc != STRING_Null
or colSW59_Name != STRING_Null or colSW59_Adr != STRING_Null or colSW59_Acc  != STRING_Null
.head 10 -  Call XSalTblSetRowBackColor(hWndForm, nRow, SalColorFromRGB(230, 255, 255))
.head 9 +  Else
.head 10 -  Call XSalTblSetRowBackColor(hWndForm, nRow, COLOR_White)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.06"
.head 5 -  Width:  8.917"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    2.4"
.head 5 -  Width:  8.917"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pbIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.433"
.head 5 -  Top:    2.55"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Добавить запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipIns'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAcc, UM_Insert, 0, 0)
.head 3 +  Picture: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.45"
.head 5 -  Top:    2.9"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Удалить запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipDel'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAcc, UM_Delete, 0, 0)
.head 3 +  Picture: pbSWReceiver
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.45"
.head 5 -  Top:    3.3"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\A_FINS.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Реквизиты получателя SWIFT-сообщения
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cBTipSWReceiver'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAcc, SAM_User, 0, 0)
.head 3 +  ! Picture: pbTerritoryId
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.433"
.head 5 -  Top:    2.548"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAddress, SAM_User, 0, 0)
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustOwn.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Boolean: isNN
.head 3 -  ! Boolean: bShowAddress
.head 3 -  ! Boolean: bShowTerritory
.head 3 -  String: sNmkM
.head 3 -  String: sAdrM
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustCorp')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustOwn.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set isNN = hWndParent.Frm_Customer.bNN
.head 4 -  ! Показывать расширенные адреса клиента
.head 4 -  ! Set bShowAddress = hWndC.AbstractCustomer..isShowCustomerAddress() and not isNN
.head 4 +  ! If NOT bShowAddress
.head 5 -  Call SalHideWindow(tblAddress)
.head 5 -  Call SalHideWindow(pbTerritoryId)
.head 5 -  Call SalSetWindowLabelText(bgMain, '')
.head 5 -  Call SalHideWindowAndLabel(bgMain)
.head 5 -  Call SalSetWindowLabelText(bgAddress, CurrentLangTable.GetAtomTitle('Dlg_CustCorp.bgMain'))
.head 4 +  ! Else
.head 5 -  ! Возможность заполнять адрес по справочнику территорий (показать кнопку)
.head 5 -  Set bShowTerritory = hWndC.AbstractCustomer..isShowCustomerTerritory()
.head 5 +  If bShowTerritory
.head 6 -  ! Заполнять адрес ТОЛЬКО по справочнику территорий
.head 6 +  If PAR_CUSTADRT = 1
.head 7 -  Call SalDisableWindow(tblAddress.colCountryName)
.head 5 +  Else 
.head 6 -  Call SalHideWindow(tblAddress.colTerritoryId)
.head 5 -  ! Устанавливаем размер окна 
.head 5 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 5 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.pic2, nWW, nWH)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.pic2, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pic2, nWinWidth, FALSE)-0.17, nWH)
.head 5 +  If bShowTerritory
.head 6 -  !
.head 6 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.tblAddress, nWW, nWH)
.head 6 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAddress,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAddress, nWinWidth, FALSE)-1, nWH)
.head 6 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbTerritoryId, nWW, nWH)
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbTerritoryId, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbTerritoryId, nWinWidth, FALSE)-0.7, nWH)
.head 5 +  Else 
.head 6 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.tblAddress, nWW, nWH)
.head 6 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAddress,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAddress, nWinWidth, FALSE)-0.5, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.tblAcc, 0.2, 3.95)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAcc,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAcc, nWinWidth, FALSE)-1, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAcc, nWinHeight, TRUE)-4.1)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbIns, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbIns, nWinWidth, FALSE)-0.7, 3.95)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbDel, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbDel, nWinWidth, FALSE)-0.7, 4.3)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbSWReceiver, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbSWReceiver, nWinWidth, FALSE)-0.7, 4.65)
.head 4 -  !
.head 4 -  If nRNK = 0
.head 4 +  Else
.head 5 -  Set dfNmku = hWndC.AbstractCustomer..getNmku()
.head 5 -  Set dfRuk  = hWndC.AbstractCustomer..getRuk()
.head 5 -  Set dfTelR = hWndC.AbstractCustomer..getTelR()
.head 5 -  Set dfBuh  = hWndC.AbstractCustomer..getBuh()
.head 5 -  Set dfTelB = hWndC.AbstractCustomer..getTelB()
.head 5 -  Set dfTelFax = hWndC.AbstractCustomer..getTelFax()
.head 5 -  Set dfEMail  = hWndC.AbstractCustomer..getEMail()
.head 5 -  Call SalSendMsg(tblAcc, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 +  ! If bShowAddress
.head 5 -  Call SalSendMsg(tblAddress, UM_Populate, 0, 0)
.head 4 -  Call SalSendMsg(hWndForm, WM_Size, 0, 0)
.head 4 -  !
.head 4 +  If not PAR_BANKTYPE = 'PRVX'
.head 5 -  Call SalHideWindow(pbSWReceiver)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustOwn.hWnd = hWndForm
.head 3 +  On UM_Update
.head 4 -  ! CustomerAddress
.head 4 +  ! If hWndC.AbstractCustomer..isShowCustomerAddress()
.head 5 -  Call SalSendMsg(hWndForm.Dlg_CustCorp.tblAddress, UM_Update, 0, 0)
.head 4 -  ! CorpsAcc
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustCorp.tblAcc, UM_Update, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call EnableWindow(dfNmku, FALSE)
.head 4 -  Call EnableWindow(dfRuk,  FALSE)
.head 4 -  Call EnableWindow(dfTelR, FALSE)
.head 4 -  Call EnableWindow(dfBuh,  FALSE)
.head 4 -  Call EnableWindow(dfTelB, FALSE)
.head 4 -  Call EnableWindow(dfTelFax, FALSE)
.head 4 -  Call EnableWindow(dfEMail, FALSE)
.head 4 -  ! Call SalSendMsg(tblAddress, SAM_DoInit, 0, 0)
.head 4 -  Call SalSendMsg(tblAcc, SAM_DoInit, 0, 0)
.head 4 -  ! Call SalDisableWindow(pbTerritoryId)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbDel)
.head 3 +  On SAM_User
.head 4 +  If PAR_BANKTYPE = 'PRVX'
.head 5 -  Set sNmkM = hWndC.AbstractCustomer..getNmkv()
.head 5 +  If sNmkM = ''
.head 6 -  Set sNmkM = hWndC.AbstractCustomer..getNmkk()
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select substr(f_translate_kmu(:sNmkM),1,38) into :sNmkM from dual")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set sAdrM = hWndC.AbstractCustomer..getAdr()
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select substr(f_translate_kmu(:sAdrM),1,70) into :sAdrM from dual")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.dfNmku, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.dfNmku,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.dfNmku, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.dfRuk, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.dfRuk,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.dfRuk, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.dfBuh, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.dfBuh,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.dfBuh, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.dfEMail, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.dfEMail,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.dfEMail, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  !
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.pic2, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.pic2, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pic2, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pic2, nWinHeight, TRUE)-2.48)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.tblAcc, nWW, nWH)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.tblAcc, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.tblAcc, nWW, 2.6)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAcc,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAcc, nWinWidth, FALSE)-1, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAcc, nWinHeight, TRUE)-2.75)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbIns, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbIns, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbIns, nWinWidth, FALSE)-0.7, 2.6)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbDel, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbDel, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbDel, nWinWidth, FALSE)-0.7, 2.95)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbSWReceiver, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbSWReceiver, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbSWReceiver, nWinWidth, FALSE)-0.7, 3.3)
.head 4 -  ! If NOT bShowAddress
.head 4 +  ! Else
.head 5 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.pic2, nWW, nWH)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.pic2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pic2, nWinWidth, FALSE)-0.17, 1.4)
.head 5 +  If bShowTerritory
.head 6 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.tblAddress, nWW, nWH)
.head 6 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAddress,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAddress, nWinWidth, FALSE)-1, nWH)
.head 6 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbTerritoryId, nWW, nWH)
.head 6 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbTerritoryId, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbTerritoryId, nWinWidth, FALSE)-0.7, nWH)
.head 5 +  Else 
.head 6 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.tblAddress, nWW, nWH)
.head 6 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAddress,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAddress, nWinWidth, FALSE)-0.5, nWH)
.head 5 -  Call SalGetWindowSize(hWndForm.Dlg_CustCorp.tblAcc, nWW, nWH)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustCorp.tblAcc,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAcc, nWinWidth, FALSE)-1, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.tblAcc, nWinHeight, TRUE)-4.1)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbIns, nWW, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbIns, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbIns, nWinWidth, FALSE)-0.7, nWH)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbDel, nWW, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbDel, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbDel, nWinWidth, FALSE)-0.7, nWH)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_CustCorp.pbSWReceiver, nWW, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustCorp.pbSWReceiver, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustCorp.pbSWReceiver, nWinWidth, FALSE)-0.7, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustPerson
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.9"
.head 4 -  Top:    1.323"
.head 4 -  Width:  11.817"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.071"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Реквизиты физических лиц
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Check Box: cbAnonymous
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Заполнять персональные реквизиты
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.2"
.head 5 -  Width:  5.343"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cbAnonymous AND bPossibleToEdit
.head 7 -  Call EnableWindow(cmbPassp, TRUE)
.head 7 -  Call EnableWindow(dfSer, TRUE)
.head 7 -  Call EnableWindow(dfActualDate, TRUE)
.head 7 -  Call EnableWindow(dfEddrId, TRUE)
.head 7 -  Call EnableWindow(dfNumDoc, TRUE)
.head 7 -  Call EnableWindow(dfOrgan, TRUE)
.head 7 -  Call EnableWindow(dfPdate, TRUE)
.head 7 -  Call EnableWindow(dfBday, TRUE)
.head 7 -  Call EnableWindow(dfBplace, TRUE)
.head 7 -  Call EnableWindow(cmbSex, TRUE)
.head 7 -  Call EnableWindow(dfKodm, TRUE)
.head 7 -  Call EnableWindow(dfTelm, TRUE)
.head 7 -  Call EnableWindow(dfKodd, TRUE)
.head 7 -  Call EnableWindow(dfTeld, TRUE)
.head 7 -  Call EnableWindow(dfTelw, TRUE)
.head 7 -  Call SalEnableWindow(pbOrgan)
.head 7 -  Call SalEnableWindow(pbOrganKoatuu)
.head 7 -  Call SalColorSet(dfKodm, COLOR_IndexWindow, SalColorFromRGB(230, 255, 255))
.head 7 -  Call SalColorSet(dfKodd, COLOR_IndexWindow, SalColorFromRGB(230, 255, 255))
.head 6 +  Else
.head 7 -  Call EnableWindow(cmbPassp, FALSE)
.head 7 -  Call EnableWindow(dfSer, FALSE)
.head 7 -  Call EnableWindow(dfActualDate, FALSE)
.head 7 -  Call EnableWindow(dfEddrId, FALSE)
.head 7 -  Call EnableWindow(dfNumDoc, FALSE)
.head 7 -  Call EnableWindow(dfOrgan, FALSE)
.head 7 -  Call EnableWindow(dfPdate, FALSE)
.head 7 -  Call EnableWindow(dfBday, FALSE)
.head 7 -  Call EnableWindow(dfBplace, FALSE)
.head 7 -  Call EnableWindow(cmbSex, FALSE)
.head 7 -  Call EnableWindow(dfKodm, FALSE)
.head 7 -  Call EnableWindow(dfTelm, FALSE)
.head 7 -  Call EnableWindow(dfKodd, FALSE)
.head 7 -  Call EnableWindow(dfTeld, FALSE)
.head 7 -  Call EnableWindow(dfTelw, FALSE)
.head 7 -  Call SalDisableWindow(pbOrgan)
.head 7 -  Call SalDisableWindow(pbOrganKoatuu)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendMsg(cbAnonymous, UM_ObjActivate, 0, 0)
.head 3 -  !
.head 3 -  Background Text: Вид документа:
.head 4 -  Resource Id: 44947
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.536"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPassp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbPassp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    0.488"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.286"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbPassp.Init(hWndItem)
.head 7 -  Call cmbPassp.Populate(hSql(), 'passp', 'name', 'passp', 'order by decode(sign(passp),-1,1000+passp,passp)')
.head 7 -  Call cmbPassp.SetSelectById(dfDocId)
.head 5 +  On SAM_Click
.head 6 -  Set nTmp = dfDocId
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfDocId = cmbPassp.nCurrentId
.head 6 +  If dfDocId != nTmp
.head 7 -  Set dfPdate = DATETIME_Null
.head 7 -  Set dfOrgan = STRING_Null
.head 7 -  Set dfNumDoc = STRING_Null
.head 7 -  Set dfActualDate = DATETIME_Null
.head 7 -  Set dfEddrId = STRING_Null
.head 7 -  Set dfSer = STRING_Null
.head 6 -  !
.head 6 +  If dfDocId != 7
.head 7 -  ! HIDE новые поля и SHOW прежние
.head 7 -  Call SalHideWindowAndLabel(bgEddrId)
.head 7 -  Call SalHideWindowAndLabel(dfEddrId)
.head 7 -  Call SalHideWindowAndLabel(bgNumDocID)
.head 7 -  Call SalHideWindowAndLabel(bgOrganID)
.head 7 -  Call SalHideWindowAndLabel(bgPdateID)
.head 7 -  Call SalHideWindowAndLabel(bgActualDate)
.head 7 -  Call SalHideWindowAndLabel(dfActualDate)
.head 7 -  Call SalShowWindowAndLabel(bgSer)
.head 7 -  Call SalShowWindowAndLabel(dfSer)
.head 7 -  Call SalShowWindowAndLabel(bgNumDoc)
.head 7 -  Call SalShowWindowAndLabel(bgOrgan)
.head 7 -  Call SalShowWindowAndLabel(bgPdate)
.head 7 -  Call SalHideWindowAndLabel(pbOrganKoatuu)
.head 7 -  Call SalShowWindowAndLabel(pbOrgan)
.head 7 -  !
.head 7 +  If not CheckPasspSer(dfDocId, dfSer)
.head 8 -  Set dfSer = STRING_Null
.head 8 -  Call SalSetFocus(dfSer)
.head 7 +  Else If not CheckPasspNum(dfDocId, dfNumDoc, dfNumDoc)
.head 8 -  ! Set dfNumDoc = STRING_Null
.head 8 -  Call SalSetFocus(dfNumDoc)
.head 7 +  Else
.head 8 +  If not checkPassp() and Dlg_CustGeneral.dfOkpo = '0000000000'
.head 9 -  Call SalSetFieldEdit(dfNumDoc, TRUE)
.head 9 -  Call SalSetFocus(dfNumDoc)
.head 7 -  !
.head 7 -  Call SalColorSet(Dlg_CustPerson, COLOR_IndexWindow, 0x70000000)
.head 7 -  Call SalColorSet(pic1, COLOR_IndexWindow, 0x70000000)
.head 6 +  Else
.head 7 -  ! HIDE прежние поля и SHOW новые
.head 7 -  Call SalShowWindowAndLabel(bgEddrId)
.head 7 -  Call SalShowWindowAndLabel(dfEddrId)
.head 7 -  Call SalShowWindowAndLabel(bgNumDocID)
.head 7 -  Call SalShowWindowAndLabel(bgOrganID)
.head 7 -  Call SalShowWindowAndLabel(bgPdateID)
.head 7 -  Call SalShowWindowAndLabel(bgActualDate)
.head 7 -  Call SalShowWindowAndLabel(dfActualDate)
.head 7 -  Call SalHideWindowAndLabel(bgSer)
.head 7 -  Call SalHideWindowAndLabel(dfSer)
.head 7 -  Call SalHideWindowAndLabel(bgNumDoc)
.head 7 -  Call SalHideWindowAndLabel(bgOrgan)
.head 7 -  Call SalHideWindowAndLabel(bgPdate)
.head 7 -  Call SalShowWindowAndLabel(pbOrganKoatuu)
.head 7 -  Call SalHideWindowAndLabel(pbOrgan)
.head 7 -  !
.head 7 -  Call SalColorSet(Dlg_CustPerson, COLOR_IndexWindow, COLOR_Sky)
.head 7 -  Call SalColorSet(pic1, COLOR_IndexWindow, COLOR_Sky)
.head 3 -  !
.head 3 -  Background Text: Серия:
.head 4 -  Resource Id: 44948
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.81"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.762"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If not CheckPasspSer(dfDocId, dfSer)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  ! Call checkPassp()
.head 6 +  If not checkPassp() and Dlg_CustGeneral.dfOkpo = '0000000000'
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Уникальный номер записи в ЕГДР: ! 4.095
.head 4 -  Resource Id: 17356
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.81"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgEddrId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEddrId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    5.012"
.head 6 -  Width:  2.033"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If Str(Val(VisStrSubstitute(dfEddrId, '-', ''))) != VisStrSubstitute(dfEddrId, '-', '') or
   At(',', dfEddrId)+At('.', dfEddrId) > 0
.head 7 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка в номере записи! ', 'Помилка в номері запису!'),
     IifS(GetLang()='RUS', 'ВНИМАНИЕ!', 'УВАГА!'), 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Номер:
.head 4 -  Resource Id: 44949
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.083"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNumDoc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Номер паспорта-ID-карты:
.head 4 -  Resource Id: 17354
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.083"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNumDocID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNumDoc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    1.024"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If dfDocId = 7
.head 7 +  If Len(dfNumDoc) < 1 or Len(dfNumDoc) > 9
.head 8 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка в номере документа! ', 'Помилка в номері документу!'),
     IifS(GetLang()='RUS', 'ВНИМАНИЕ!', 'УВАГА!'), 7, 1)
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If not CheckPasspNum(dfDocId, dfNumDoc, dfNumDoc)
.head 8 -  Return VALIDATE_Cancel
.head 7 -  ! Call checkPassp()
.head 7 +  If not checkPassp() and Dlg_CustGeneral.dfOkpo = '0000000000'
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Кем выдан:
.head 4 -  Resource Id: 44950
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.345"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOrgan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Орган, который выдал:
.head 4 -  Resource Id: 17357
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.345"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOrganID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOrgan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    1.298"
.head 6 -  Width:  5.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If dfDocId = 7 and dfOrgan != STRING_Null
.head 7 +  If Len(dfOrgan) != 4 or not SalStrIsValidNumber(dfOrgan) or At(',', dfOrgan)+At('.', dfOrgan) > 0 or Len(
   GetValueStr("
   SELECT REGION
   FROM   KOATUU_REGION_CODE
   WHERE  CODE=" || Left(dfOrgan, 2))) = 0
.head 8 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка в коде органа! ', 'Помилка в коді органу!'),
     IifS(GetLang()='RUS', 'ВНИМАНИЕ!', 'УВАГА!'), 7, 1)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Call SaveInfoToLog('dfDocId = ' || Str(dfDocId))
.head 6 -  ! Call SaveInfoToLog('nTmp = '    || Str(nTmp))
.head 6 -  ! Call SaveInfoToLog('dfOrgan = ' || dfOrgan)
.head 6 +  If dfDocId = 7 and dfOrgan != STRING_Null and Len(dfOrgan) > 1 and SalStrIsValidNumber(dfOrgan)
.head 7 -  ! Call SaveInfoToLog('KOATUU_REGION_CODE')
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Maize)
.head 7 -  Call XSalTooltipShow(hWndItem, GetValueStr("
     SELECT REGION
     FROM   KOATUU_REGION_CODE
     WHERE  CODE=" || Left(dfOrgan, 2)))
.head 7 -  ! Call SalMessageBeep(MB_Ok)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 6 +  Else
.head 7 -  Set sTemp = ''
.head 3 -  !
.head 3 -  Background Text: Когда выдан:
.head 4 -  Resource Id: 44951
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.619"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Дата выдачи:
.head 4 -  Resource Id: 17358
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.619"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPdateID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    1.571"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If not bTmpP
.head 7 -  Set dTmpP = dfPdate
.head 6 -  Set bTmpP = TRUE
.head 6 -  Set bAnyP = FALSE
.head 6 -  ! Call Debug(SalFmtFormatDateTime(dfPdate, 'DD/MM/YYYY'))
.head 5 +  On SAM_KillFocus
.head 6 -  Set bTmpP = FALSE
.head 5 +  On SAM_AnyEdit
.head 6 -  ! Call setEdited()
.head 6 -  Set bAnyP = TRUE
.head 5 +  On SAM_Validate
.head 6 -  Set bTmpP = FALSE
.head 6 +  If dfPdate
.head 7 -  Set d121 = SalStrToDate(GetValueStr("
    SELECT to_char(ADD_MONTHS(to_date('" ||
    SalFmtFormatDateTime(dfPdate, 'dd/MM/yyyy') || "','DD/MM/YYYY'), 121),'YYYY-MM-DD')
    FROM   DUAL"))
.head 7 -  Set dBeginVida = IifD(dfBday != DATETIME_Null, IifD(dfDocId = 7, SalStrToDate(GetValueStr("
    SELECT to_char(ADD_MONTHS(to_date('" ||
           SalFmtFormatDateTime(dfBday, 'dd/MM/yyyy') || "','DD/MM/YYYY'), 14*12),'YYYY-MM-DD')
    FROM   DUAL")), IifD(dfDocId = 1, SalStrToDate(GetValueStr("
    SELECT to_char(ADD_MONTHS(to_date('" ||
           SalFmtFormatDateTime(dfBday, 'dd/MM/yyyy') || "','DD/MM/YYYY'), 16*12),'YYYY-MM-DD')
    FROM   DUAL")), dfBday)), DATETIME_Null) 
.head 6 +  If not SalFmtIsValidField(dfPdate) or (dfPdate and dfPdate > dCurr) or
   (dfPdate and dfBday and dfPdate < dBeginVida) or
   (dfDocId = 7 and dfPdate and dfActualDate and (dfActualDate < dfPdate or dfActualDate >= d121))
.head 7 -  Call MessageNoWait(IifS(GetLang()='RUS',
     'Ошибка в дате выдачи или несоответствие в датах или неверный формат даты!',
     'Помилка в даті видачі або невідповідність в датах або невірний формат дати!'), IifS(GetLang()='RUS',
     'ВНИМАНИЕ!', 'УВАГА!'), 37, 1)
.head 7 -  ! Call Debug('dfPdate = ' || SalFmtFormatDateTime(dfPdate, 'DD/MM/YYYY'))
.head 7 -  ! Call Debug('dTmp = ' || SalFmtFormatDateTime(dTmp, 'DD/MM/YYYY'))
.head 7 -  Set dfPdate = dTmpP
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If bAnyP
.head 7 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Действителен до:
.head 4 -  Resource Id: 17355
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.85"
.head 5 -  Top:    1.619"
.head 5 -  Width:  2.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgActualDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfActualDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.983"
.head 6 -  Top:    1.571"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If not bTmpA
.head 7 -  Set dTmpA = dfActualDate
.head 6 -  Set bTmpA = TRUE
.head 6 -  Set bAnyA = FALSE
.head 5 +  On SAM_KillFocus
.head 6 -  Set bTmpA = FALSE
.head 5 +  On SAM_AnyEdit
.head 6 -  ! Call setEdited()
.head 6 -  Set bAnyA = TRUE
.head 5 +  On SAM_Validate
.head 6 -  Set bTmpA = FALSE
.head 6 +  If dfPdate
.head 7 -  Set d121 = SalStrToDate(GetValueStr("
    SELECT to_char(ADD_MONTHS(to_date('" ||
    SalFmtFormatDateTime(dfPdate, 'dd/MM/yyyy') || "','DD/MM/YYYY'), 121),'YYYY-MM-DD')
    FROM   DUAL"))
.head 6 +  If not SalFmtIsValidField(dfActualDate) or (dfActualDate and dfActualDate < dCurr) or
   (dfActualDate and dfBday and dfActualDate < dfBday) or
   (dfPdate and dfActualDate and (dfActualDate < dfPdate or dfActualDate >= d121))  
.head 7 -  Call MessageNoWait(IifS(GetLang()='RUS',
     'Ошибка в дате действия или несоответствие в датах или неверный формат даты!',
     'Помилка в даті дії або невідповідність в датах або невірний формат дати!'), IifS(GetLang()='RUS',
     'ВНИМАНИЕ!', 'УВАГА!'), 37, 1)
.head 7 -  Set dfActualDate = dTmpA
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If bAnyA
.head 7 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Дата рождения:
.head 4 -  Resource Id: 44952
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.893"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBday
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBday
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    1.833"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If not bTmpB
.head 7 -  Set dTmpB = dfBday
.head 6 -  Set bTmpB = TRUE
.head 6 -  Set bAnyB = FALSE
.head 5 +  On SAM_KillFocus
.head 6 -  Set bTmpB = FALSE
.head 5 +  On SAM_AnyEdit
.head 6 -  ! Call setEdited()
.head 6 -  Set bAnyB = TRUE
.head 5 +  On SAM_Validate
.head 6 -  Set bTmpB = FALSE
.head 6 -  Set dBeginVida = IifD(dfBday != DATETIME_Null, IifD(dfDocId = 7, SalStrToDate(GetValueStr("
    SELECT to_char(ADD_MONTHS(to_date('" ||
           SalFmtFormatDateTime(dfBday, 'dd/MM/yyyy') || "','DD/MM/YYYY'), 14*12),'YYYY-MM-DD')
    FROM   DUAL")), IifD(dfDocId = 1, SalStrToDate(GetValueStr("
    SELECT to_char(ADD_MONTHS(to_date('" ||
           SalFmtFormatDateTime(dfBday, 'dd/MM/yyyy') || "','DD/MM/YYYY'), 16*12),'YYYY-MM-DD')
    FROM   DUAL")), dfBday)), DATETIME_Null)
.head 6 -  ! If not SalFmtIsValidField(dfBday) or (dfBday and dfBday > dCurr) or (dfPdate and dfBday and dfPdate < dfBday) or
   (dfDocId = 7 and dfActualDate and dfBday and dfActualDate < dfBday)
.head 6 +  If not SalFmtIsValidField(dfBday) or (dfBday and dfBday > dCurr) or (dfPdate and dfBday and dfPdate < dBeginVida) or
   (dfDocId = 7 and dfActualDate and dfBday and dfActualDate < dfBday)
.head 7 -  Call MessageNoWait(IifS(GetLang()='RUS',
     'Ошибка в дате рождения или несоответствие в датах или неверный формат даты!',
     'Помилка в даті народження або невідповідність в датах або невірний формат дати!'), IifS(GetLang()='RUS',
     'ВНИМАНИЕ!', 'УВАГА!'), 7, 1)
.head 7 -  Set dfBday = dTmpB
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If bAnyB
.head 7 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Место рождения:
.head 4 -  Resource Id: 44953
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.155"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBplace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBplace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    2.107"
.head 6 -  Width:  5.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  !
.head 3 -  Background Text: Пол:
.head 4 -  Resource Id: 44954
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.429"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    2.381"
.head 5 -  Width:  1.833"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbSex.Init(hWndItem)
.head 7 -  ! Call cmbSex.Add(0, 'Неопределен')
.head 7 -  ! Call cmbSex.Add(1, 'Мужской')
.head 7 -  ! Call cmbSex.Add(2, 'Женский')
.head 7 -  ! Call SalListClear(hWndItem)
.head 7 -  ! Call cmbSex.Add(0, CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTN'))
.head 7 -  ! Call cmbSex.Add(1, CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTM'))
.head 7 -  ! Call cmbSex.Add(2, CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTG'))
.head 7 -  Call cmbSex.Populate(hSql(), 'id', 'name', 'sex', 'order by id')
.head 7 -  Call cmbSex.SetSelectById(dfSex)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Call setEdited()
.head 6 -  Set dfSex = cmbSex.GetCurrentKey()
.head 3 -  !
.head 3 -  Background Text: Моб. телефон:
.head 4 -  Resource Id: 47086
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.702"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: +380
.head 4 -  Resource Id: 47087
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    2.702"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKodm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKodm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.833"
.head 6 -  Top:    2.643"
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On VTM_LeftDoubleClick
.head 6 +  If FunNSIGet('phone_mob_code', 'name', sPK, sSem)
.head 7 -  Set dfKodm = sPK
.head 7 +  If not checkPhoneM(1)
.head 8 -  Set dfKodm = ''
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(dfKodm)
.head 7 +  If not checkPhoneM(1)
.head 8 -  Set dfKodm = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfTelm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.833"
.head 6 -  Top:    2.643"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If bPAR_PHCODE
.head 7 +  If not SalIsNull(dfTelm) and SalGetMaxDataLength(dfTelm) = 7
.head 8 +  If not checkPhoneM(2)
.head 9 -  Set dfTelm = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Check Box: cbNoTelm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відсутній мобільний телефон
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    2.643"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 +  If cbNoTelm
.head 7 -  Call VisMessageSetBkgdColor(COLOR_LightGray)
.head 7 -  Set hBtns[0] = hBtnYes
.head 7 -  Set hBtns[1] = hBtnNo
.head 7 -  Set nChoose = VisMessageBox("Я, " || sUserFio || ", " || PutCrLf() ||
    "підтверджую відсутність мобільного телефону у клієнта станом на " ||
    SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy') || ". " || PutCrLf() ||
    "Не заперечую проти перевірки Банком достовірності наданої мною інформації. " || PutCrLf() ||
    "Мені відомо, що подання недостовірної інформації тягне за собою відповідальність " || PutCrLf() ||
    "(дисциплінарні стягнення та інше) згідно з чинним законодавством України.", 'Повідомлення', MBF_IconAsterisk,
    hBtns, 2)
.head 7 +  If nChoose = 1
.head 8 -  Set cbNoTelm = FALSE
.head 3 -  !
.head 3 -  Background Text: Дом. телефон:
.head 4 -  Resource Id: 44955
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.964"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTeld
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: +380
.head 4 -  Resource Id: 47088
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    2.964"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKodd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKodd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.833"
.head 6 -  Top:    2.917"
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On VTM_LeftDoubleClick
.head 6 +  If FunNSIGetAltPK('phone_city_code', 'city_code', 'city_name', sPK, sSem)
.head 7 -  Set dfKodd = sPK
.head 7 +  If not checkPhoneD(1)
.head 8 -  Set dfKodd = ''
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(dfKodd)
.head 7 +  If not checkPhoneD(1)
.head 8 -  Set dfKodd = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfTeld
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.833"
.head 6 -  Top:    2.917"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If bPAR_PHCODE
.head 7 +  If not SalIsNull(dfTeld) and SalGetMaxDataLength(dfTeld) = 7
.head 8 +  If not checkPhoneD(2)
.head 9 -  Set dfTeld = ''
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Раб. телефон:
.head 4 -  Resource Id: 44956
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    3.238"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelw
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTelw
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    3.19"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  !
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  11.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.524"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pbOrgan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.35"
.head 5 -  Top:    1.238"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\FILTER.BMP
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  ! If not SalSendMsg(dfBday, SAM_Validate, 0, 0)
.head 7 -  Set dfBday = DATETIME_Null
.head 6 +  ! If not SalSendMsg(dfPdate, SAM_Validate, 0, 0)
.head 7 -  Set dfPdate = DATETIME_Null
.head 6 +  If FunNSIGetFiltered('organdok', 'name', '', sPK, sSem)
.head 7 -  Set dfOrgan = sSem
.head 7 -  Call setEdited()
.head 3 +  Picture: pbOrganKoatuu
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.35"
.head 5 -  Top:    5.012"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\FILTER.BMP
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  ! If not SalSendMsg(dfBday, SAM_Validate, 0, 0)
.head 7 -  Set dfBday = DATETIME_Null
.head 6 +  ! If not SalSendMsg(dfPdate, SAM_Validate, 0, 0)
.head 7 -  Set dfPdate = DATETIME_Null
.head 6 +  ! If not SalSendMsg(dfActualDate, SAM_Validate, 0, 0)
.head 7 -  Set dfActualDate = DATETIME_Null
.head 6 -  Set sTemp = dfOrgan
.head 6 -  Set dfOrgan = ''
.head 6 +  If FunNSIGetFiltered('koatuu_region_code', 'region', '', sPK, sSem)
.head 7 -  Set dfOrgan = sPK ! sSem
.head 7 -  Call setEdited()
.head 7 -  Call SalSetFocus(dfOrgan)
.head 7 -  Call SalPostMsg(dfOrgan, VTM_KeyDown, VK_End, 0)
.head 6 +  Else
.head 7 -  Set dfOrgan = sTemp 
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustOwn.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 3 +  Function: checkPassp
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sMsg
.head 5 -  Number: nRnk
.head 5 -  String: sNmk
.head 5 -  String: sTobo
.head 4 +  Actions
.head 5 -  ! Проверка уникальности
.head 5 +  If dfDocId != NUMBER_Null and not SalIsNull(dfSer) and not SalIsNull(dfNumDoc)
.head 6 -  ! Проверяем открытых клиентов
.head 6 -  Set sMsg = ''
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   select c.rnk,c.nmk,c.tobo
   into   :nRnk,:sNmk,:sTobo
   from   customer c, person p
   where  c.rnk=p.rnk and passp=:dfDocId and p.ser=:dfSer and p.numdoc=:dfNumDoc and c.date_off is null and
          c.sed=" || IifS(bPersonSPD, "'91'", "c.sed") || IifS(nRNK=0, "", " and c.rnk<>:nRNK"))
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set sMsg = Subs(IifS(sMsg='', '', sMsg || PutCrLf()) || sTobo || ' ' || Str(nRnk) || ' ' || sNmk, 1, 254)
.head 6 +  If sMsg
.head 7 -  ! Уже зарегистрирован клиент с введенными паспортными данными!
.head 7 -  Call MessageAttention(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTMsgPassp') || PutCrLf() || sMsg)
.head 7 -  Return FALSE
.head 6 -  ! Проверяем закрытых клиентов
.head 6 +  Else
.head 7 -  Set sMsg = ''
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   select c.rnk,c.nmk,c.tobo
   into   :nRnk,:sNmk,:sTobo
   from   customer c, person p
   where  c.rnk=p.rnk and passp=:dfDocId and p.ser=:dfSer and p.numdoc=:dfNumDoc and c.date_off is not null and
          c.sed=" || IifS(bPersonSPD, "'91'", "c.sed") || IifS(nRNK=0, "", " and c.rnk<>:nRNK"))
.head 8 +  While SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sMsg = Subs(IifS(sMsg='', '', sMsg || PutCrLf()) || sTobo || ' ' || Str(nRnk) || ' ' || sNmk, 1, 254)
.head 7 +  If sMsg
.head 8 -  ! Существует закрытый клиент с введенными паспортными данными!
.head 8 -  Call MessageAttention(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTMsgPasspClose') || PutCrLf() || sMsg)
.head 5 -  Return TRUE
.head 3 +  Function: checkPhoneM
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: iRnk
.head 5 -  String: iMPNo
.head 5 -  String: iBranch
.head 5 -  String: sText
.head 5 -  Number: res
.head 4 +  Actions
.head 5 -  ! dfKodm
.head 5 +  If nPar = 1 and dfKodm != STRING_Null
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select 1 into :i from phone_mob_code where code = :dfKodm")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Неверный код! Выбрать из справочника?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneCode'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo) = IDNO
.head 8 -  Return FALSE
.head 7 +  If not FunNSIGet('phone_mob_code', 'name', sPK, sSem)
.head 8 -  Return FALSE
.head 7 -  Set dfKodm = sPK
.head 5 -  ! dfTelm
.head 5 +  Else If dfTelm != STRING_Null
.head 6 +  If dfKodm != '' and Len(dfKodm || dfTelm) != 9
.head 7 -  ! Номер телефона должен содержать 9 цифр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneLen'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Set dfTelm = ''
.head 7 -  Return FALSE
.head 6 +  If not SalIsValidNumber(dfTelm)
.head 7 -  ! Номер телефона должен содержать 9 цифр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneLen'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Set dfTelm = ''
.head 7 -  Return FALSE
.head 6 +  If Subs(dfTelm, 1, 1) = Subs(dfTelm, 2, 1) and Subs(dfTelm, 1, 1) = Subs(dfTelm, 3, 1) and
   Subs(dfTelm, 1, 1) = Subs(dfTelm, 4, 1) and Subs(dfTelm, 1, 1) = Subs(dfTelm, 5, 1) and
   Subs(dfTelm, 1, 1) = Subs(dfTelm, 6, 1) and Subs(dfTelm, 1, 1) = Subs(dfTelm, 7, 1)
.head 7 -  ! Номер телефона должен содержать 9 цифр!
.head 7 -  ! Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneLen'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  ! Set dfTelm = ''
.head 7 -  ! Return FALSE
.head 7 -  Call VisMessageSetBkgdColor(COLOR_LightGray)
.head 7 -  Set hBtns[0] = hBtnYes
.head 7 -  Set hBtns[1] = hBtnNo
.head 7 -  Set nChoose = VisMessageBox("Я, " || sUserFio || ", " || PutCrLf() ||
"підтверджую наявність номеру мобільного телефону у клієнта, " || PutCrLf() ||
"що складається з однакових цифр. " || PutCrLf() ||
"Не заперечую проти перевірки Банком достовірності наданої мною інформації. " || PutCrLf() ||
"Мені відомо, що подання недостовірної інформації тягне за собою відповідальність " || PutCrLf() ||
"(дисциплінарні стягнення та інше) згідно з чинним законодавством України.", 
'Повідомлення', MBF_IconAsterisk, hBtns, 2)
.head 7 +  If nChoose = 0
.head 8 -  Set sText = STRING_Null
.head 8 -  Call SqlPrepareAndExecute(hSql(),
"select c.rnk, substr(trim(w.value),1,100), c.branch into :iRnk, :iMPNo, :iBranch
   from customer c, customerw w
  where c.rnk = w.rnk
    and trim(w.tag) = 'MPNO'
    and w.value like '%' || :dfKodm || :dfTelm || '%'
    and c.date_off is null
    and c.rnk <> :nRNK")
.head 8 +  While SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sText = sText || PutCrLf() || 'РНК ' || Str(iRnk) || ' (тел. ' || iMPNo || ' відділення ' || iBranch || ')'
.head 8 +  If sText != STRING_Null
.head 9 -  Call SalMessageBox('Такий номер зареєстрований у наступних клієнтів, перевірте інформацію:' || sText,
     'Повідомлення', MB_IconAsterisk | MB_Ok)
.head 7 +  Else If nChoose = 1
.head 8 -  Set dfTelm = ''
.head 5 -  Return TRUE
.head 3 +  Function: checkPhoneD
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 4 +  Actions
.head 5 -  ! dfKodd
.head 5 +  If nPar = 1 and dfKodd != STRING_Null
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select 1 into :i from phone_city_code where city_code = :dfKodd")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Неверный код! Выбрать из справочника?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneCode'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo) = IDNO
.head 8 -  Return FALSE
.head 7 +  If not FunNSIGetAltPK('phone_city_code', 'city_code', 'city_name', sPK, sSem)
.head 8 -  Return FALSE
.head 7 -  Set dfKodd = sPK
.head 5 -  !
.head 5 +  Else If dfTeld != ''
.head 6 +  If dfKodd != '' and Len(dfKodd || dfTeld) != 9
.head 7 -  ! Номер телефона должен содержать 9 цифр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneLen'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Set dfTeld = ''
.head 7 -  Return FALSE
.head 6 +  If not SalIsValidNumber(dfTeld)
.head 7 -  ! Номер телефона должен содержать 9 цифр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneLen'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Set dfTeld = ''
.head 7 -  Return FALSE
.head 6 +  If Subs(dfTeld, 1, 1) = Subs(dfTeld, 2, 1) and Subs(dfTeld, 1, 1) = Subs(dfTeld, 3, 1) and
   Subs(dfTeld, 1, 1) = Subs(dfTeld, 4, 1) and Subs(dfTeld, 1, 1) = Subs(dfTeld, 5, 1) and
   Subs(dfTeld, 1, 1) = Subs(dfTeld, 6, 1) and Subs(dfTeld, 1, 1) = Subs(dfTeld, 7, 1)
.head 7 -  ! Номер телефона должен содержать 9 цифр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustPerson.cTErrPhoneLen'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Set dfTeld = ''
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Boolean: isNN
.head 3 -  Number: dfDocId
.head 3 -  Number: dfSex
.head 3 -  Boolean: bPersonSPD
.head 3 -  !
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 3 -  !
.head 3 -  String: sUserFio
.head 3 -  Number: hBtnYes
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  Number: nChoose
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 3 -  !
.head 3 -  String: sTemp
.head 3 -  Number: nTmp
.head 3 -  Date/Time: dCurr
.head 3 -  Date/Time: d121
.head 3 -  Number: res
.head 3 -  Date/Time: dBeginVida
.head 3 -  Date/Time: dTmpB
.head 3 -  Boolean: bTmpB
.head 3 -  Date/Time: dTmpA
.head 3 -  Boolean: bTmpA
.head 3 -  Date/Time: dTmpP
.head 3 -  Boolean: bTmpP
.head 3 -  Boolean: bAnyP
.head 3 -  Boolean: bAnyA
.head 3 -  Boolean: bAnyB
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustPerson')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set dCurr = SalStrToDate(GetValueStr("
    SELECT to_char(trunc(sysdate),'YYYY-MM-DD')
    FROM   DUAL"))
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustOwn.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set bPersonSPD = hWndParent.Frm_Customer.bPersonSPD
.head 4 -  !
.head 4 -  Set isNN = hWndParent.Frm_Customer.bNN
.head 4 -  !
.head 4 -  Call SalSetMaxDataLength(dfTeld, 20)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(dfEddrId, 3.983, 0.762)
.head 4 -  Call SalSetWindowLoc(pbOrganKoatuu, 9.35, 1.238)
.head 4 -  !
.head 4 +  If nRNK = 0
.head 5 -  Set dfDocId = NUMBER_Null
.head 5 -  Set dfSex   = NUMBER_Null
.head 4 +  Else
.head 5 -  Set dfSer    = hWndC.AbstractCustomer..getSer()
.head 5 -  Set dfNumDoc = hWndC.AbstractCustomer..getNumDoc()
.head 5 -  Set dfOrgan  = hWndC.AbstractCustomer..getOrgan()
.head 5 -  Set dfPdate  = hWndC.AbstractCustomer..getPDate()
.head 5 -  Set dfBday   = hWndC.AbstractCustomer..getBDay()
.head 5 -  Set dfBplace = hWndC.AbstractCustomer..getBPlace()
.head 5 -  Set dfTelm   = hWndParent.Frm_Customer.sPhoneMob
.head 5 -  Set dfTeld   = hWndC.AbstractCustomer..getTelD()
.head 5 -  Set dfTelw   = hWndC.AbstractCustomer..getTelW()
.head 5 -  Set dfDocId  = hWndC.AbstractCustomer..getPassp()
.head 5 -  !
.head 5 -  Set dfActualDate = hWndC.AbstractCustomer..getActualDate()
.head 5 -  Set dfEddrId     = hWndC.AbstractCustomer..getEddrId()
.head 5 -  !
.head 5 +  If dfDocId != 7
.head 6 -  ! HIDE новые поля и SHOW прежние
.head 6 -  Call SalHideWindowAndLabel(bgEddrId)
.head 6 -  Call SalHideWindowAndLabel(dfEddrId)
.head 6 -  Call SalHideWindowAndLabel(bgNumDocID)
.head 6 -  Call SalHideWindowAndLabel(bgOrganID)
.head 6 -  Call SalHideWindowAndLabel(bgPdateID)
.head 6 -  Call SalHideWindowAndLabel(bgActualDate)
.head 6 -  Call SalHideWindowAndLabel(dfActualDate)
.head 6 -  Call SalShowWindowAndLabel(bgSer)
.head 6 -  Call SalShowWindowAndLabel(dfSer)
.head 6 -  Call SalShowWindowAndLabel(bgNumDoc)
.head 6 -  Call SalShowWindowAndLabel(bgOrgan)
.head 6 -  Call SalShowWindowAndLabel(bgPdate)
.head 6 -  Call SalHideWindowAndLabel(pbOrganKoatuu)
.head 6 -  Call SalShowWindowAndLabel(pbOrgan)
.head 6 -  !
.head 6 -  Call SalColorSet(Dlg_CustPerson, COLOR_IndexWindow, 0x70000000)
.head 6 -  Call SalColorSet(pic1, COLOR_IndexWindow, 0x70000000)
.head 5 +  Else
.head 6 -  ! Call SalSetWindowLoc(bgEddrId, 0.25, 0.81)
.head 6 -  ! Call SalSetWindowLoc(dfEddrId, 3.983, 0.762)
.head 6 -  ! Call SalSetWindowLoc(bgOrganID, 0.25, 1.345)
.head 6 -  ! Call SalSetWindowLoc(bgPdateID, 0.25, 1.619)
.head 6 -  ! Call SalSetWindowLoc(bgNumDocID, 0.25, 1.083)
.head 6 -  ! Call SalSetWindowLoc(pbOrganKoatuu, 9.35, 1.238)
.head 6 -  ! HIDE прежние поля и SHOW новые
.head 6 -  Call SalShowWindowAndLabel(bgEddrId)
.head 6 -  Call SalShowWindowAndLabel(dfEddrId)
.head 6 -  Call SalShowWindowAndLabel(bgNumDocID)
.head 6 -  Call SalShowWindowAndLabel(bgOrganID)
.head 6 -  Call SalShowWindowAndLabel(bgPdateID)
.head 6 -  Call SalShowWindowAndLabel(bgActualDate)
.head 6 -  Call SalShowWindowAndLabel(dfActualDate)
.head 6 -  Call SalHideWindowAndLabel(bgSer)
.head 6 -  Call SalHideWindowAndLabel(dfSer)
.head 6 -  Call SalHideWindowAndLabel(bgNumDoc)
.head 6 -  Call SalHideWindowAndLabel(bgOrgan)
.head 6 -  Call SalHideWindowAndLabel(bgPdate)
.head 6 -  Call SalShowWindowAndLabel(pbOrganKoatuu)
.head 6 -  Call SalHideWindowAndLabel(pbOrgan)
.head 6 -  !
.head 6 -  Call SalColorSet(Dlg_CustPerson, COLOR_IndexWindow, COLOR_Sky)
.head 6 -  Call SalColorSet(pic1, COLOR_IndexWindow, COLOR_Sky)
.head 5 -  !
.head 5 -  Set dfSex    = IifN(hWndC.AbstractCustomer..getSex()=STRING_Null,NUMBER_Null,Val(hWndC.AbstractCustomer..getSex()))
.head 5 -  Set hWndParent.Frm_Customer.sOldMobPhone = dfTelm
.head 4 -  ! Закрываем возможность выбора кодов моб.оператора/города
.head 4 -  ! - для нового клиента, если не установлен параметр
.head 4 -  ! - для существующего клиента, если телефон заполнен, чтоб не разбирать на составные номер телефона
.head 4 -  ! Eсли установлен параметр, структурированный телефон заполняется для 
.head 4 -  ! - нового клиента
.head 4 -  ! - существующего клиента, если у него не заполнен мобильный или домашний телефон
.head 4 +  If bPAR_PHCODE
.head 5 +  If nRNK and not SalIsNull(dfTelm)
.head 6 -  Call SalHideWindowAndLabel(bgKodm)
.head 6 -  Call SalHideWindowAndLabel(dfKodm)
.head 6 -  Call SalSetWindowLoc(dfTelm, 3.983, 2.643) ! было 3.3, 2.66
.head 6 -  Call SalSetMaxDataLength(dfTelm, 20)
.head 5 +  Else
.head 6 -  Call SalSetMaxDataLength(dfTelm, 7)
.head 5 +  If nRNK and not SalIsNull(dfTeld)
.head 6 -  Call SalHideWindowAndLabel(bgKodd)
.head 6 -  Call SalHideWindowAndLabel(dfKodd)
.head 6 -  Call SalSetWindowLoc(dfTeld, 3.983, 2.917) ! было 3.3, 2.93
.head 6 -  Call SalSetMaxDataLength(dfTeld, 20)
.head 5 +  Else
.head 6 -  Call SalSetMaxDataLength(dfTeld, 7)
.head 5 -  Set hBtnYes = VisMessageLoadButton('Так, підтверджую', 0)
.head 5 -  Set hBtnNo  = VisMessageLoadButton('Ні, не підтверджую', 1)
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select fio into :sUserFio from staff$base where id = user_id")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set cbNoTelm = FALSE
.head 4 +  Else
.head 5 -  Call SalHideWindowAndLabel(bgKodm)
.head 5 -  Call SalHideWindowAndLabel(dfKodm)
.head 5 -  Call SalSetWindowLoc(dfTelm, 3.983, 2.643) ! было 3.3, 2.66
.head 5 -  Call SalSetMaxDataLength(dfTelm, 20)
.head 5 -  Call SalHideWindow(cbNoTelm)
.head 5 -  Call SalHideWindowAndLabel(bgKodd)
.head 5 -  Call SalHideWindowAndLabel(dfKodd)
.head 5 -  Call SalSetWindowLoc(dfTeld, 3.983, 2.917) ! было 3.3, 2.93
.head 5 -  Call SalSetMaxDataLength(dfTeld, 20)
.head 4 -  !
.head 4 +  If isNN or bPAR_CUSTMPSP
.head 5 -  Call hWndC.AbstractCustomer..setUsePerson(TRUE)
.head 5 -  Call SalDisableWindow(cbAnonymous)
.head 4 -  Set cbAnonymous = hWndC.AbstractCustomer..isUsePerson()
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustOwn.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(cbAnonymous)
.head 4 -  Call EnableWindow(cmbSex,       FALSE)
.head 4 -  Call EnableWindow(cmbPassp,     FALSE)
.head 4 -  Call EnableWindow(dfSer,        FALSE)
.head 4 -  Call EnableWindow(dfNumDoc,     FALSE)
.head 4 -  Call EnableWindow(dfPdate,      FALSE)
.head 4 -  Call EnableWindow(dfActualDate, FALSE)
.head 4 -  Call EnableWindow(dfEddrId,     FALSE)
.head 4 -  Call EnableWindow(dfOrgan,      FALSE)
.head 4 -  Call EnableWindow(dfBday,       FALSE)
.head 4 -  Call EnableWindow(dfBplace,     FALSE)
.head 4 -  Call EnableWindow(dfKodm,       FALSE)
.head 4 -  Call EnableWindow(dfTelm,       FALSE)
.head 4 -  Call EnableWindow(dfKodd,       FALSE)
.head 4 -  Call EnableWindow(dfTeld,       FALSE)
.head 4 -  Call EnableWindow(dfTelw,       FALSE)
.head 4 -  Call SalDisableWindow(pbOrgan)
.head 4 -  Call SalDisableWindow(pbOrganKoatuu)
.head 4 -  Call SalDisableWindow(cbNoTelm)
.head 4 -  !
.head 4 -  Call EnableWindow(dfActualDate, FALSE)
.head 4 -  Call EnableWindow(dfEddrId,     FALSE)
.head 3 +  On SAM_User
.head 4 +  If dfBday = DATETIME_Null and hWndParent.Frm_Customer.dBdayByOkpo != DATETIME_Null
.head 5 -  Set dfBday = hWndParent.Frm_Customer.dBdayByOkpo
.head 5 -  Set cbAnonymous = TRUE
.head 5 -  Call SalSendMsg(cbAnonymous, SAM_Click, 0, 0)
.head 4 +  If (dfSex = NUMBER_Null or dfSex = 0) and hWndParent.Frm_Customer.nSexByOkpo != NUMBER_Null
.head 5 -  Set dfSex = hWndParent.Frm_Customer.nSexByOkpo
.head 5 -  Call cmbSex.SetSelectById(dfSex)
.head 5 -  Set cbAnonymous = TRUE
.head 5 -  Call SalSendMsg(cbAnonymous, SAM_Click, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustPerson.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_CustPerson.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_CustPerson.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  ! Call SalGetWindowSize(hWndForm.Dlg_CustPerson.dfOrgan, nWW, nWH)
.head 4 -  ! Call SalSetWindowSize(hWndForm.Dlg_CustPerson.dfOrgan,
     SalPixelsToFormUnits(hWndForm.Dlg_CustPerson.dfOrgan, nWinWidth, FALSE)-4.1, nWH)
.head 4 -  ! Call SalGetWindowLoc(hWndForm.Dlg_CustPerson.pbOrgan, nWW, nWH)
.head 4 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustPerson.pbOrgan, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustPerson.pbOrgan, nWinWidth, FALSE)-0.7, nWH)
.head 4 -  ! Call SalGetWindowLoc(hWndForm.Dlg_CustPerson.pbOrganKoatuu, nWW, nWH)
.head 4 -  ! Call SalSetWindowLoc(hWndForm.Dlg_CustPerson.pbOrganKoatuu, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustPerson.pbOrganKoatuu, nWinWidth, FALSE)-0.7, nWH)
.head 4 -  ! Call SalGetWindowSize(hWndForm.Dlg_CustPerson.dfBplace, nWW, nWH)
.head 4 -  ! Call SalSetWindowSize(hWndForm.Dlg_CustPerson.dfBplace,
     SalPixelsToFormUnits(hWndForm.Dlg_CustPerson.dfBplace, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On SAM_Destroy
.head 4 +  If bPAR_PHCODE
.head 5 -  Call VisMessageFreeButton(hBtnYes)
.head 5 -  Call VisMessageFreeButton(hBtnNo)
.head 1 +  Dialog Box: Dlg_CustDR
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.233"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Доп. реквизиты клиента
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblDR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    0.45"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 300
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colDR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реквизит
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNDR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 500
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colVal
.head 8 +  If not colNotToEdit
.head 9 +  If not colHist
.head 10 -  ! F6 - для редактирования
.head 10 -  Set dfF4 = 'F6 - ' || CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTF6')
.head 10 +  If colNsiTabName != ''
.head 11 -  ! F4 - для вызова справочника
.head 11 -  Set dfF4 = dfF4 || ' F4 - ' || CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTF4')
.head 9 +  Else
.head 10 -  ! Левый клик на заголовке строки - для редактирования
.head 10 -  Set dfF4 = CurrentLangTable.GetAtomTitle('cTLeftHeaderClickForEdit')
.head 8 +  Else
.head 9 -  ! высветить значение по ключу
.head 9 +  If colNsiTabName != '' and Len(colVal) > 0
.head 10 -  ! Set dfF4 = 'Двойной клик - посмотреть значение по ключу'
.head 10 -  Set dfF4 = CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTВDoubNoEdit')
.head 7 +  On SAM_Click
.head 8 +  If Len(colVal) > 0
.head 9 -  ! Call Debug(colDR)
.head 9 +  If colNsiTabName != ''
.head 10 -  Set sSema = ''
.head 10 +  If SqlPrepareAndExecute(hSqlAux3(), "
   SELECT c.colname
   INTO   :sMetaKey
   FROM   meta_columns c, meta_tables t
   where  t.tabname=:colNsiTabName and c.tabid=t.tabid and c.SHOWRETVAL=1 and rownum<2") and
   SqlFetchNext(hSqlAux3(), nFetchRes)
.head 11 -  ! Call Debug('sMetaKey = ' || sMetaKey)
.head 11 +  If SqlPrepareAndExecute(hSqlAux3(), "
   SELECT c.colname
   INTO   :sMetaSem
   FROM   meta_columns c, meta_tables t
   where  t.tabname=:colNsiTabName and c.tabid=t.tabid and c.INSTNSSEMANTIC=1 and rownum<2") and
   SqlFetchNext(hSqlAux3(), nFetchRes)
.head 12 -  ! Call Debug('sMetaSem = ' || sMetaSem)
.head 12 +  If Len(sMetaKey)*Len(sMetaSem) > 0
.head 13 -  ! Call Debug("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  " || sMetaKey || "='" || colVal || "'")
.head 13 +  ! If colType = 'N' or colType = 'E'
.head 14 -  ! Call Debug('colType = N')
.head 14 -  Set sSema = GetValueStr("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  " || sMetaKey || "=" || colVal)
.head 13 +  ! Else
.head 14 -  ! Call Debug('colType != N')
.head 14 -  Set sSema = GetValueStr("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  " || sMetaKey || "='" || colVal || "'")
.head 13 -  Set sSema = GetValueStr("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  to_char(" || sMetaKey || ")='" || colVal || "'")
.head 13 +  If Len(sSema) = 0
.head 14 -  ! Set sSema = 'Значение отсутствует в справочнике'
.head 14 -  ! Set sSema = 'Значення відсутнє в довіднику'
.head 14 -  Set sSema = CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTValueAbsents')
.head 10 +  If Len(sSema) > 0
.head 11 -  Call XSalTooltipShow(hWndForm, sSema)
.head 7 +  On SAM_DoubleClick
.head 8 +  If bPossibleToEdit and not colNotToEdit and not colHist
.head 9 -  Set nRow = SalTblQueryContext(hWndForm)
.head 9 +  If colNsiTabName != ''
.head 10 +  If FunNSIGet(colNsiTabName, '', sTmp1, sTmp2)
.head 11 -  ! Set tblDR.colVal = sTmp1
.head 11 -  Set colVal = sTmp1
.head 11 -  ! Call Debug('sTmp2 = ' || sTmp2)
.head 11 -  Call setEdited()
.head 11 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 -  Call SalSetFocus(hWndForm)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 9 -  Call SalTblSetFocusCell(hWndForm, nRow, colVal, 0, 0)
.head 8 +  Else
.head 9 +  If Len(colVal) > 0
.head 10 -  ! Call Debug(colDR)
.head 10 +  If colNsiTabName != ''
.head 11 -  Set sSema = ''
.head 11 +  If SqlPrepareAndExecute(hSqlAux3(), "
   SELECT c.colname
   INTO   :sMetaKey
   FROM   meta_columns c, meta_tables t
   where  t.tabname=:colNsiTabName and c.tabid=t.tabid and c.SHOWRETVAL=1 and rownum<2") and
   SqlFetchNext(hSqlAux3(), nFetchRes)
.head 12 -  ! Call Debug('sMetaKey = ' || sMetaKey)
.head 12 +  If SqlPrepareAndExecute(hSqlAux3(), "
   SELECT c.colname
   INTO   :sMetaSem
   FROM   meta_columns c, meta_tables t
   where  t.tabname=:colNsiTabName and c.tabid=t.tabid and c.INSTNSSEMANTIC=1 and rownum<2") and
   SqlFetchNext(hSqlAux3(), nFetchRes)
.head 13 -  ! Call Debug('sMetaSem = ' || sMetaSem)
.head 13 +  If Len(sMetaKey)*Len(sMetaSem) > 0
.head 14 -  ! Call Debug("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  " || sMetaKey || "='" || colVal || "'")
.head 14 +  ! If colType = 'N' or colType = 'E'
.head 15 -  ! Call Debug('colType = N')
.head 15 -  Set sSema = GetValueStr("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  " || sMetaKey || "=" || colVal)
.head 14 +  ! Else
.head 15 -  ! Call Debug('colType != N')
.head 15 -  Set sSema = GetValueStr("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  " || sMetaKey || "='" || colVal || "'")
.head 14 -  Set sSema = GetValueStr("
    SELECT " || sMetaSem || "
    FROM   " || colNsiTabName || "
    WHERE  to_char(" || sMetaKey || ")='" || colVal || "'")
.head 14 +  If Len(sSema) = 0
.head 15 -  ! Set sSema = 'Значение отсутствует в справочнике'
.head 15 -  ! Set sSema = 'Значення відсутнє в довіднику'
.head 15 -  Set sSema = CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTValueAbsents')
.head 11 +  If Len(sSema) > 0
.head 12 -  Call XSalTooltipShow(hWndForm, sSema)
.head 7 +  On SAM_AnyEdit
.head 8 +  If colNotToEdit or colHist
.head 9 -  Set colVal = sTmp
.head 9 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If colNotToEdit
.head 9 -  Return VALIDATE_Ok
.head 8 +  If not SalIsNull(colVal)
.head 9 +  If colType = 'N' AND NOT SalIsValidNumber(colVal)
.head 10 -  ! colNDR : должно быть число!
.head 10 -  Call SalMessageBox(colNDR || ' : ' || PutCrLf() || CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrNumber'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 9 +  Else If colType = 'D' AND NOT SalIsValidDateTime(colVal)
.head 10 -  ! colNDR : должна быть дата!
.head 10 -  Call SalMessageBox(colNDR || ' : ' || PutCrLf() || CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrData'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 9 -  ! Проверка введенного значения на вхождение в указанный справочник
.head 9 +  If colNsiTabName and colNsiColCheck
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(), "
     select count(*)
     into   :nCount
     from   " || colNsiTabName  || "
     where  " || colNsiColCheck || "=:colVal")
.head 10 +  If SqlFetchNext(hSqlAux(), nFetchRes) and not nCount
.head 11 -  ! Неверное значение реквизита! Выбирите значение из справочника!
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrValOnNsi') || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrValOnNsi_'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 11 -  Set colVal = ''
.head 11 -  Return VALIDATE_Cancel
.head 8 -  Set colVal250 = Subs(colVal, 1, 250)
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If bPossibleToEdit and not colNotToEdit and not colHist
.head 9 +  If wParam = VK_F4
.head 10 -  Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
.head 9 +  If wParam = VK_F6
.head 10 -  Set lsTmp = colVal
.head 10 -  ! Редактирование реквизита
.head 10 -  Set lsTmp = ShowMemoEditor(CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTMemoEditor'), 1, 500, lsTmp)
.head 10 +  If colVal != lsTmp
.head 11 -  Set colVal = lsTmp
.head 11 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 11 -  Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
.head 7 +  On SAM_KillFocus
.head 8 -  Set dfF4 = ''
.head 5 +  Column: colValOld
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 500
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiTabName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 60
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVal250
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOpt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNotToEdit
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiColCheck
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSqlVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHist
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colParId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: getSqlVal
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sSql
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nTmp
.head 6 +  Actions
.head 7 -  ! Для получения значений приявязаных к типу или номеру клиента,
.head 7 -  ! в селекте вожножно использование след. макросов:
.head 7 -  ! :CUSTTYPE - тип клиента (значения 1,2,3)
.head 7 -  ! :SPD      – признак ФО-СПД (значения 1 (СПД), 0 (не СПД))
.head 7 -  ! :REZID    – резидентность (значения 1 (резидент), 2 (нерезидент))
.head 7 -  ! :RNK      - РНК клиента (значения целые числа)
.head 7 -  ! значение подставляется простой заменой текста
.head 7 -  Set nTmp = SalStrScan(sSql, ':CUSTTYPE')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sSql = SalStrReplaceX(sSql, nTmp, 9, Str(nCType))
.head 8 -  Set nTmp = SalStrScan(sSql, ':CUSTTYPE')
.head 7 -  Set nTmp = SalStrScan(sSql, ':SPD')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sSql = SalStrReplaceX(sSql, nTmp, 4, Str(bPersonSPD))
.head 8 -  Set nTmp = SalStrScan(sSql, ':SPD')
.head 7 -  Set nTmp = SalStrScan(sSql, ':REZID')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sSql = SalStrReplaceX(sSql, nTmp, 6, Str(nRezid))
.head 8 -  Set nTmp = SalStrScan(sSql, ':REZID')
.head 7 -  Set nTmp = SalStrScan(sSql, ':RNK')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sSql = SalStrReplaceX(sSql, nTmp, 4, Str(nRNK))
.head 8 -  Set nTmp = SalStrScan(sSql, ':RNK')
.head 7 -  Call SqlPrepareAndExecute(hSqlAux(), sSql || " into :sTmp1")
.head 7 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return sTmp1
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nRowErr
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  String: sTmp
.head 5 -  String: sTmp1
.head 5 -  String: sTmp2
.head 5 -  Number: nCount
.head 5 -  !
.head 5 -  Boolean: bTmp
.head 5 -  Long String: lsTmp
.head 5 -  !
.head 5 -  : cPar
.head 6 -  Class: cParHist
.head 5 -  String: sVal
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), "
     select tag,name,tabname,upper(type),case when " || sCustomerFieldCType || "=2 then 1 else 0 end,
            not_to_edit,hist,parid, " || IifS(bCheckDR=TRUE, "tabcolumn_check", "null") || "," ||
            IifS(bSetDefaultDR=TRUE, "sqlval", "null") || "
     into   :hWndForm.tblDR.colDR,:hWndForm.tblDR.colNDR,:hWndForm.tblDR.colNsiTabName,
            :hWndForm.tblDR.colType,:hWndForm.tblDR.colOpt,:hWndForm.tblDR.colNotToEdit,
            :hWndForm.tblDR.colHist,:hWndForm.tblDR.colParId,:hWndForm.tblDR.colNsiColCheck,
            :hWndForm.tblDR.colSqlVal
     from   customer_field
     where  " || sCustomerFieldCType || ">0" || IifS(nCustDRTab=1, "", " and code=:sCode") || "
     order by " || sCustomerFieldCType || " desc,name", TBL_FillAll)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set colVal = hWndC.AbstractCustomer..getElementValue(colDR)
.head 6 -  Set colValOld = colVal
.head 6 +  If hWndC.AbstractCustomer..getElementEditFlag(colDR)
.head 7 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 6 +  If bPossibleToEdit
.head 7 +  If not colVal and colSqlVal
.head 8 -  Set colVal = getSqlVal(colSqlVal)
.head 8 -  Call setEdited()
.head 8 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 7 +  If colOpt
.head 8 -  Call SalTblSetCellTextColor(colNDR, COLOR_DarkRed, FALSE)
.head 8 -  Call SalTblSetCellTextColor(colVal, COLOR_DarkRed, FALSE)
.head 7 +  If colNotToEdit
.head 8 -  Call XSalTblSetCellBackColor(colNDR, COLOR_LightGray)
.head 8 -  Call XSalTblSetCellBackColor(colVal, COLOR_LightGray)
.head 8 -  Call SalTblSetCellTextColor(colNDR, COLOR_DarkGray, FALSE)
.head 8 -  Call SalTblSetCellTextColor(colVal, COLOR_DarkGray, FALSE)
.head 7 +  Else If colNsiTabName and not colHist
.head 8 -  Call XSalTblSetCellBackColor(colVal, SalColorFromRGB(230, 255, 255))
.head 6 +  If colHist
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
.head 6 -  Set colVal250 = Subs(colVal, 1, 250)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  ! Не сортируется по colVal, т.к. colVal LongString, поэтому сортируем по colVal250
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colVal), COL_GetID)
.head 7 -  Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(colVal250), COL_GetID))
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F6
.head 7 +  If not bPossibleToEdit or colNotToEdit
.head 8 -  Set lsTmp = colVal
.head 8 -  ! Call SalModalDialog(dlg_MemoEditor, hWndForm, 'Просмотр реквизита', 0, bTmp, lsTmp)
.head 8 -  Call ShowMemoEditor('Просмотр реквизита', 0, 500, lsTmp)
.head 5 +  On UM_BeforeClose
.head 6 -  ! Проверка на обязательное заполнение
.head 6 +  If cbDROpt
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If colOpt AND colVal = ''
.head 9 -  ! Не заполнен реквизит <tblSP.colSem>
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrRekv') || ' <' || tblDR.colNDR || '>',
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 9 -  Set nRowErr = nRow
.head 9 -  Return 2
.head 6 -  Return 1
.head 5 +  On UM_Clear
.head 6 -  Call SalSetFocus(hWndForm)
.head 6 -  Call SalTblSetFocusRow(hWndForm, nRowErr)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRowErr, colVal, 0, 0)
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If colVal != colValOld and not colNotToEdit
.head 8 -  Call hWndC.AbstractCustomer..setElementValue(colDR, colVal)
.head 8 -  Call SaveInfoToLog('CUSTOMER. Изменение доп.реквизитов клиента  РНК ' || Str(hWndC.AbstractCustomer..getRnk()) ||
     ': <' || colDR || '>: "' || colValOld || '" => "' || colVal || '"')
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  ! On SAM_RowHeaderClick
.head 6 +  If colOpt
.head 7 -  ! 'Обязательный реквизит'
.head 7 -  Call XSalTooltipSetColors(COLOR_DarkRed, COLOR_LightGray)
.head 7 -  Call XSalTooltipShow(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTOpt'))
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_LightGray)
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If colHist
.head 7 -  Set cPar.nND             = nRNK
.head 7 -  Set cPar.nParId          = colParId
.head 7 -  Set cPar.sParSemantic    = colNDR
.head 7 -  Set cPar.sTabName        = 'customerpv'
.head 7 -  Set cPar.sKeyName        = 'rnk'
.head 7 -  Set cPar.sValName        = 'val'
.head 7 -  Set cPar.sType           = colType
.head 7 -  Set cPar.sNsiTabName     = colNsiTabName
.head 7 -  Set cPar.sNsiPkName      = ''
.head 7 -  Set cPar.sNsiSqlWhere    = ''
.head 7 -  Set cPar.sNsiColumnCheck = colNsiColCheck
.head 7 -  Set sVal = colVal
.head 7 -  Call SalModalDialog(dlgParHist, hWndForm, cPar, bPossibleToEdit, sVal)
.head 7 -  Set colVal = sVal
.head 7 -  Call hWndC.AbstractCustomer..setElementValue(colDR, colVal)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 +  Data Field: dfF4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.012"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbDROpt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Проверять заполнение обязательных реквизитов
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.1"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nCustDRTab = 1
.head 6 -  Set hWndParent.Frm_Customer.cTabCustDR.isEdited = TRUE
.head 6 -  Call hWndParent.Frm_Customer.setEdited()
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_CustDRTab.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  String: sCustomerFieldCType
.head 3 -  Boolean: bCheckDR
.head 3 -  Boolean: bSetDefaultDR
.head 3 -  Boolean: bPersonSPD
.head 3 -  Number: nRezid
.head 3 -  !
.head 3 -  String: sCode
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 3 -  Number: nTblX0
.head 3 -  Number: nTblY0
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeight
.head 3 -  Number: nColWidth
.head 3 -  !
.head 3 -  String: sSema
.head 3 -  String: sMetaKey
.head 3 -  String: sMetaSem
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustDR')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 +  If nCustDRTab = 1
.head 5 -  Set nFlagEdit = hWndParent.Frm_Customer.cTabCustDR.EditMode
.head 4 +  Else
.head 5 -  Set nFlagEdit = hWndParent.Dlg_CustDRTab.nFlagEdit
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 +  If nCustDRTab = 1
.head 5 -  Set sCustomerFieldCType = hWndParent.Frm_Customer.sCustomerFieldCType
.head 5 -  Set bPersonSPD          = hWndParent.Frm_Customer.bPersonSPD
.head 5 -  Set nRezid              = hWndParent.Frm_Customer.nCRezid
.head 4 +  Else
.head 5 -  Set sCustomerFieldCType = hWndParent.Dlg_CustDRTab.sCustomerFieldCType
.head 5 -  Set bPersonSPD          = hWndParent.Dlg_CustDRTab.bPersonSPD
.head 5 -  Set nRezid              = hWndParent.Dlg_CustDRTab.nRezid
.head 4 -  Set bCheckDR              = hWndC.AbstractCustomer..isCheckElementOnNsi()
.head 4 -  Set bSetDefaultDR         = hWndC.AbstractCustomer..isSetElementDefaultValue()
.head 4 -  Set cbDROpt               = TRUE
.head 4 +  If bPAR_CUSTMDR
.head 5 -  Call SalDisableWindow(cbDROpt)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 +  If nCustDRTab = 1
.head 5 -  Call SalSendMsg(hWndForm.Dlg_CustDR.tblDR, UM_Populate, 0, 0)
.head 5 -  Set hWndParent.Frm_Customer.cTabCustDR.hWnd = hWndForm
.head 4 -  !
.head 4 -  Call SalSendMsg(hWndForm, WM_Size, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Set sCode = hWndParent.Dlg_CustDRTab.sCode
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustDR.tblDR, UM_Populate, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(cbDROpt)
.head 4 -  Call SalSendMsg(tblDR, SAM_DoInit, 0, 0)
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg(tblDR, UM_Update, 0, 0)
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка на обязательное заполнение
.head 4 -  Return SalSendMsg(tblDR, UM_BeforeClose, 0, 0)
.head 3 +  On UM_Clear
.head 4 -  Call SalSendMsg(tblDR, UM_Clear, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustDR.tblDR, SalPixelsToFormUnits(hWndForm.Dlg_CustDR.tblDR, nWinWidth, FALSE)-0.2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustDR.tblDR, nWinHeight, TRUE)-0.75)
.head 4 -  Call GetClientRect(hWndForm.Dlg_CustDR.tblDR, nTblX0, nTblY0, nTblWidth, nTblHeight)
.head 4 -  Call SalTblSetColumnWidth(hWndForm.Dlg_CustDR.tblDR.colVal, SalPixelsToFormUnits(hWndForm.Dlg_CustDR.tblDR,
     nTblWidth, FALSE)-4.7)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustDR.dfF4, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustDR.dfF4, SalPixelsToFormUnits(hWndForm.Dlg_CustDR.dfF4, nWinWidth, FALSE), nWH)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_CustDR.dfF4, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustDR.dfF4, nWW, SalPixelsToFormUnits(hWndForm.Dlg_CustDR.dfF4, nWinHeight, TRUE)-0.23)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Form Window: Dlg_CustDRTab
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.183"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.869"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 6162426F74746F6D 4D617267696E0002 0030000054616250
0040: 616765436F756E74 0002003100005461 624C6162656C7300 07004C6162656C30
0060: 00005461624E616D 65730006004E616D 6530000054616252 696768744D617267
0080: 696E000200300000 5461624472617753 74796C65000B0057 696E39355374796C
00A0: 650000546162466F 726D506167657300 0100000054616254 6F704D617267696E
00C0: 0002003000000000 0000000000000000 0000000000000000 0000
.enddata
.data CLASSPROPSSIZE
0000: DA00
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  !
.head 6 -  Set nTabNum = 0
.head 6 -  Set i = 0
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute(hSql(),
"select unique f.code, s.name, s.ord
   into :sCode, :sCodeName, :nOrd
   from customer_field f, customer_field_codes s
  where f.code = s.code and " || sCustomerFieldCType || " > 0
  order by s.ord")
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set cTabDR[i].Label = sCodeName
.head 7 -  Set cTabDR[i].Name = sCode
.head 7 -  Set cTabDR[i].DlgName = 'Dlg_CustDR'
.head 7 -  Set cTabDR[i].EditMode = 2
.head 7 -  Call createTab(cTabDR[i], FALSE)
.head 7 -  Set i = i + 1
.head 6 -  ! Удаляем последнюю пустую закладку
.head 6 -  Call picTabs.Delete(nTabNum, TRUE)
.head 6 -  ! Инициализация закладок
.head 6 -  Call picTabs.InitializeFormPages(
     SalNumberToStrX(nRNK,0)   || ';' ||
     SalNumberToStrX(nCType,0) || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) || ';' ||
     Str(SalWindowHandleToNumber(hWndC)))
.head 6 -  ! Показываем первую закладку
.head 6 -  Call picTabs.BringToTop(0, TRUE)
.head 6 -  Set nPrevActivTab = 0
.head 5 +  On TABSM_TabActivateStart
.head 6 -  Call SalSendMsg(picTabs.Items[nPrevActivTab].m_hWndPage, UM_Update, 0, 0)
.head 6 -  Call GetName(wParam, sTabName)
.head 6 -  Set nTab = GetTop()
.head 6 -  Set sCode = cTabDR[nTab].Name
.head 6 -  Call SalSendMsg(picTabs.Items[nTab].m_hWndPage, UM_Insert, 0, 0)
.head 6 -  Set nPrevActivTab = nTab
.head 2 +  Functions
.head 3 +  Function: createTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : Tab
.head 6 -  Class: cCustTab
.head 5 -  Boolean: bDisableTab	! Насильно закрыть закладку для редактирования (напр., при рег. нового клиента)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call picTabs.Insert(nTabNum,TRUE)
.head 5 -  Call picTabs.SetLabel(nTabNum, Tab.Label, TRUE)
.head 5 -  Call picTabs.SetName(nTabNum, Tab.Name)
.head 5 +  If bDisableTab
.head 6 -  Call picTabs.Enable(nTabNum, FALSE)
.head 5 +  ! Else
.head 6 +  If Tab.EditMode != TAB_Hide and Tab.DlgName
.head 7 -  Call picTabs.AddPage(Tab.Name, Tab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(Tab.EditMode=TAB_Hide, FALSE, TRUE))
.head 5 +  Else
.head 6 +  If nFlagEdit != TAB_Hide and Tab.DlgName
.head 7 -  Call picTabs.AddPage(Tab.Name, Tab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(nFlagEdit=TAB_Hide, FALSE, TRUE))
.head 5 -  Call picTabs.CreatePage(Tab.Name)
.head 5 -  Set Tab.TabNum = nTabNum
.head 5 -  Set nTabNum = nTabNum + 1
.head 5 -  Return TRUE
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustDR.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  String: sCustomerFieldCType
.head 3 -  Boolean: bCheckDR
.head 3 -  Boolean: bSetDefaultDR
.head 3 -  Boolean: bPersonSPD
.head 3 -  Number: nRezid
.head 3 -  !
.head 3 -  : cTabDR[*]
.head 4 -  Class: cCustTab
.head 3 -  Number: nTabNum
.head 3 -  Number: nTab
.head 3 -  String: sTabName
.head 3 -  String: sCode
.head 3 -  String: sCodeName
.head 3 -  Number: nOrd
.head 3 -  Number: i
.head 3 -  Number: nPrevActivTab
.head 3 -  !
.head 3 -  Number: nRet
.head 3 -  Number: nErrTab
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustDR')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustDR.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 -  Set sCustomerFieldCType = hWndParent.Frm_Customer.sCustomerFieldCType
.head 4 -  Set bPersonSPD = hWndParent.Frm_Customer.bPersonSPD
.head 4 -  Set nRezid     = hWndParent.Frm_Customer.nCRezid
.head 4 -  !
.head 4 +  ! If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  Call SalSendMsg(picTabs, UM_ObjActivate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustDR.hWnd = hWndForm
.head 3 +  On UM_Update
.head 4 -  Set i = 0
.head 4 +  While i < nTabNum
.head 5 -  Call SalSendMsg(picTabs.Items[i].m_hWndPage, UM_Update, 0, 0)
.head 5 -  Set i = i + 1
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка на обязательное заполнение
.head 4 -  Set i = 0
.head 4 +  While i < nTabNum
.head 5 -  Call picTabs.BringToTop(i, TRUE)
.head 5 -  Set nRet = SalSendMsg(picTabs.Items[i].m_hWndPage, UM_BeforeClose, 0, 0)
.head 5 +  If nRet = 2
.head 6 -  Set nErrTab = picTabs.GetTop()
.head 6 -  Break
.head 5 -  Set i = i + 1
.head 4 -  Return nRet
.head 3 +  On UM_Clear
.head 4 -  Call SalSendMsg(picTabs.Items[nErrTab].m_hWndPage, UM_Clear, 0, 0)
.head 1 +  Dialog Box: Dlg_CustInfo
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.6"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Дополнительная информация о клиенте банка
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Менеджер клиента:
.head 4 -  Resource Id: 2819
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.286"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIsp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIsp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.2"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfIsp)
.head 7 -  Call SalListSetSelect(cmbIsp, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbIsp.SetSelectById(dfIsp)
.head 6 +  If cmbIsp.nCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Call SalMessageBox( 'Нет исполнителя с таким номером', 'Ошибка!', MB_Ok | MB_IconStop )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrIsp'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbIsp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.65"
.head 5 -  Top:    0.202"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbIsp.Init(hWndItem)
.head 7 -  Call cmbIsp.Populate(hSql(), 'id', 'fio', 'Staff', 'WHERE type=1 ORDER BY fio' )
.head 7 -  Call cmbIsp.SetSelectById(dfIsp)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfIsp = cmbIsp.nCurrentId
.head 3 -  Background Text: Примечание:
.head 4 -  Resource Id: 43012
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.548"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNotes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNotes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 140
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.47"
.head 6 -  Width:  4.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Класс заемщика:
.head 4 -  Resource Id: 43014
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.821"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIndicate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIndicate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.74"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbCrisk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.65"
.head 5 -  Top:    0.74"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.119"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If Init(hWndItem)
.head 7 -  Call Populate(hSql(), 'FIN', 'NAME', 'FIN_STAN', 'where custtype=' || Str(nCType))
.head 7 -  Call Add(0, '')
.head 7 -  Call SetSelectById(dfCriskId)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, wParam, lParam)
.head 6 -  Set dfCriskId = cmbCrisk.GetCurrentKey()
.head 6 -  !
.head 6 -  Call setEdited()
.head 6 -  Call SetColorIndicateRisk(dfCriskId)
.head 6 +  If dfCriskId = 0
.head 7 -  Set dfCriskId = NUMBER_Null
.head 3 -  Background Text: Альтернативный адрес:
.head 4 -  Resource Id: 43017
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.095"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAdr_alt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdr_alt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.917"
.head 6 -  Top:    1.01"
.head 6 -  Width:  4.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Лимит на активные операции:
.head 4 -  Resource Id: 7608
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.369"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLim
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLim
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 16
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    1.28"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Лимит кассы:
.head 4 -  Resource Id: 43016
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.631"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLim_kass
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLim_kass
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    1.55"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: № дог. за сопровождение :
.head 4 -  Resource Id: 43018
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.905"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNom_dog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNom_dog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    1.82"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  ! Background Text: № в реестре плательщиков ПДВ :
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.179"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgNomPDV
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Data Field: dfNomPDV
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 9
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    2.09"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfNomPDV)
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 +  If Not SalIsValidNumber(dfNomPDV)
.head 7 -  ! Return MessageErrorInput( 'Введите правильный номер!' )
.head 7 -  Return MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_CustInfo.cTErrNomPDV'))
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Рег.№ холдинга:
.head 4 -  Resource Id: 21173
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.179"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRnkP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRnkP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    2.09"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Примечание для службы безопасности:
.head 4 -  Resource Id: 21174
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.45"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNotesec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlNotesec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 256
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.7"
.head 6 -  Width:  8.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.95"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  8.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.131"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Реквизиты в других банках
.head 4 -  Resource Id: 11050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.0"
.head 6 -  Width:  8.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colListIndex
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ListIndex
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Id
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If SalIsNull(colMfo)
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT nb INTO :colBankName FROM banks WHERE mfo=:colMfo")
.head 8 +  If NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Несуществующее МФО!
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrMfo'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  !
.head 8 +  If NOT SalIsNull(colNls)
.head 9 +  If colNls != KeyAccount(colMfo, colNls)
.head 10 -  ! Неверный контрольный разряд счета!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrNls'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colBankName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название банка
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If SalIsNull(colMfo)
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT mfo INTO :colMfo FROM banks WHERE mfo=:colMfo")
.head 8 +  If NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Несуществующее МФО!
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrMfo'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  !
.head 8 +  If NOT SalIsNull(colNls)
.head 9 +  If colNls != KeyAccount(colMfo, colNls)
.head 10 -  ! Неверный контрольный разряд счета!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrNls'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If SalIsNull(colNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If colNls != KeyAccount(colMfo, colNls)
.head 9 -  ! Call SalMessageBox('Неверный контрольный разряд счета!', 'Ошибка!', MB_Ok | MB_IconExclamation)
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cTErrNls'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKvName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If colKvName.Init(hWndItem)
.head 9 -  Call colKvName.Populate(hSql(), "kv", "lcv || ' ' || name", "tabval", 
"where (d_close is null or d_close>=bankdate) order by skv")
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 -  Set colKv = colKvName.GetKey(SalListQuerySelection(colKvName))
.head 8 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  Column: colComm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW56_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SW56_Name
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW56_Adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW56_Code
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Code
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW57_Acc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW59_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW59_Adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 5 +  Column: colSW59_Acc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nCtlState
.head 5 -  String: sSW56_Name
.head 5 -  String: sSW56_Adr
.head 5 -  String: sSW56_Code
.head 5 -  String: sSW57_Name
.head 5 -  String: sSW57_Adr
.head 5 -  String: sSW57_Code
.head 5 -  String: sSW57_Acc
.head 5 -  String: sSW59_Name
.head 5 -  String: sSW59_Adr
.head 5 -  String: sSW59_Acc
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set nRow = 0 
.head 6 +  While nRow < hWndC.AbstractCustomer..getCorpAccParNum()
.head 7 -  Call SalTblInsertRow(hWndForm, nRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colListIndex = nRow
.head 7 -  Call hWndC.AbstractCustomer..getCorpAcc(colListIndex, colId, colMfo, colNls, colKv, colComm, colBankName,
     colSW56_Name, colSW56_Adr, colSW56_Code,
     colSW57_Name, colSW57_Adr, colSW57_Code, colSW57_Acc,
     colSW59_Name, colSW59_Adr, colSW59_Acc)
.head 7 -  Call colKvName.SetSelectById(colKv)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 7 +  If colSW56_Name != STRING_Null or colSW56_Adr != STRING_Null or colSW56_Code != STRING_Null
or colSW57_Name != STRING_Null or colSW57_Adr != STRING_Null or colSW57_Code != STRING_Null or colSW57_Acc != STRING_Null
or colSW59_Name != STRING_Null or colSW59_Adr != STRING_Null or colSW59_Acc  != STRING_Null
.head 8 -  Call XSalTblSetRowBackColor(hWndForm, nRow, SalColorFromRGB(230, 255, 255))
.head 7 -  Set nRow = nRow + 1
.head 6 +  If nRow > 0
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 +  If PAR_BANKTYPE = 'PRVX'
.head 7 +  If colKv = GetBaseVal()
.head 8 -  Call SalDisableWindow(pbSWReceiver)
.head 7 +  Else
.head 8 -  Call SalEnableWindow(pbSWReceiver)
.head 5 +  On UM_Insert
.head 6 -  Call setEdited()
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, nRow + 1)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRow, colMfo, 0, 1)
.head 5 +  On UM_Delete
.head 6 -  Call setEdited()
.head 6 +  If NOT SalTblSetFlagsAnyRows(hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted)
.head 7 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0)
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited | ROW_New | ROW_MarkDeleted, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
.head 8 +  If colId != NUMBER_Null
.head 9 -  Call hWndC.AbstractCustomer..deleteCorpAcc(colId)
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 8 -  Set nRow = nRow - 1
.head 7 +  Else
.head 8 -  Call hWndC.AbstractCustomer..setCorpAcc(colListIndex, colId, colMfo, colNls, colKv, colComm,
     colSW56_Name, colSW56_Adr, colSW56_Code,
     colSW57_Name, colSW57_Adr, colSW57_Code, colSW57_Acc,
     colSW59_Name, colSW59_Adr, colSW59_Acc)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On SAM_User
.head 6 +  If SalTblAnyRows(hWndForm, 0, 0)
.head 7 -  Set nRow = SalTblQueryContext(hWndForm)
.head 7 -  Set sSW56_Name = colSW56_Name
.head 7 -  Set sSW56_Adr  = colSW56_Adr
.head 7 -  Set sSW56_Code = colSW56_Code
.head 7 -  Set sSW57_Name = colSW57_Name
.head 7 -  Set sSW57_Adr  = colSW57_Adr
.head 7 -  Set sSW57_Code = colSW57_Code
.head 7 -  Set sSW57_Acc  = colSW57_Acc
.head 7 -  Set sSW59_Name = colSW59_Name
.head 7 -  Set sSW59_Adr  = colSW59_Adr
.head 7 -  Set sSW59_Acc  = colSW59_Acc
.head 7 +  If sSW59_Name = ''
.head 8 -  Set sSW59_Name = sNmkM
.head 7 +  If sSW59_Adr = ''
.head 8 -  Set sSW59_Adr = sAdrM
.head 7 +  If SalModalDialog(DlgSWReceiver, hWndForm, bPossibleToEdit,
   colMfo, colBankName, colNls, colKvName,
   sSW56_Name, sSW56_Adr, sSW56_Code,
   sSW57_Name, sSW57_Adr, sSW57_Code, sSW57_Acc,
   sSW59_Name, sSW59_Adr, sSW59_Acc)
.head 8 +  If bPossibleToEdit
.head 9 -  Call setEdited()
.head 9 -  Set colSW56_Name = sSW56_Name
.head 9 -  Set colSW56_Adr  = sSW56_Adr
.head 9 -  Set colSW56_Code = sSW56_Code
.head 9 -  Set colSW57_Name = sSW57_Name
.head 9 -  Set colSW57_Adr  = sSW57_Adr
.head 9 -  Set colSW57_Code = sSW57_Code
.head 9 -  Set colSW57_Acc  = sSW57_Acc
.head 9 -  Set colSW59_Name = sSW59_Name
.head 9 -  Set colSW59_Adr  = sSW59_Adr
.head 9 -  Set colSW59_Acc  = sSW59_Acc
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 +  If colSW56_Name != STRING_Null or colSW56_Adr != STRING_Null or colSW56_Code != STRING_Null
or colSW57_Name != STRING_Null or colSW57_Adr != STRING_Null or colSW57_Code != STRING_Null or colSW57_Acc != STRING_Null
or colSW59_Name != STRING_Null or colSW59_Adr != STRING_Null or colSW59_Acc  != STRING_Null
.head 10 -  Call XSalTblSetRowBackColor(hWndForm, nRow, SalColorFromRGB(230, 255, 255))
.head 9 +  Else
.head 10 -  Call XSalTblSetRowBackColor(hWndForm, nRow, COLOR_White)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 +  Picture: pbIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.4"
.head 5 -  Top:    4.0"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Добавить запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipIns'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAcc, UM_Insert, 0, 0)
.head 3 +  Picture: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.4"
.head 5 -  Top:    4.35"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Удалить запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipDel'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAcc, UM_Delete, 0, 0)
.head 3 +  Picture: pbSWReceiver
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.4"
.head 5 -  Top:    4.7"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\A_FINS.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Реквизиты получателя SWIFT-сообщения
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustCorp.cBTipSWReceiver'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblAcc, SAM_User, 0, 0)
.head 2 +  Functions
.head 3 +  Function: SetColorIndicateRisk
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: RiskCode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case RiskCode
.head 6 +  Case 0
.head 7 -  Call SalColorSet(dfIndicate, COLOR_IndexWindow, COLOR_Gray)
.head 7 -  Break
.head 6 +  Case 1
.head 7 -  Call SalColorSet(dfIndicate, COLOR_IndexWindow, COLOR_Green)
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Call SalColorSet(dfIndicate, COLOR_IndexWindow, COLOR_DarkGreen)
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Call SalColorSet(dfIndicate, COLOR_IndexWindow, COLOR_Yellow)
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Call SalColorSet(dfIndicate, COLOR_IndexWindow, COLOR_DarkRed)
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SalColorSet(dfIndicate, COLOR_IndexWindow, COLOR_Red)
.head 7 -  Break
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustInfo.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  Boolean: bPersonSPD
.head 3 -  !
.head 3 -  Number: dfCriskId
.head 3 -  Number: i
.head 3 -  String: sNmkM
.head 3 -  String: sAdrM
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustInfo')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustInfo.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set bPersonSPD = hWndParent.Frm_Customer.bPersonSPD
.head 4 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD and nRNK != 0
.head 5 -  Call SalShowWindowAndLabel(bgMain)
.head 5 -  Call SalShowWindowAndLabel(tblAcc)
.head 5 -  Call SalShowWindowAndLabel(pbIns)
.head 5 -  Call SalShowWindowAndLabel(pbDel)
.head 5 -  Call SalShowWindowAndLabel(pbSWReceiver)
.head 4 +  Else
.head 5 -  Call SalHideWindowAndLabel(bgMain)
.head 5 -  Call SalHideWindow(tblAcc)
.head 5 -  Call SalHideWindow(pbIns)
.head 5 -  Call SalHideWindow(pbDel)
.head 5 -  Call SalHideWindow(pbSWReceiver)
.head 4 -  Call SalSendMsg(hWndForm, WM_Size, 0, 0)
.head 4 -  !
.head 4 +  If nRNK = 0
.head 5 +  If nCType = 3
.head 6 -  Set dfCriskId  = 1
.head 4 +  Else
.head 5 -  Set dfIsp      = hWndC.AbstractCustomer..getIsp()
.head 5 -  Set dfNotes    = hWndC.AbstractCustomer..getNotes()
.head 5 -  Set dfCriskId  = hWndC.AbstractCustomer..getCRisk()
.head 5 -  Set dfAdr_alt  = hWndC.AbstractCustomer..getAdrAlt()
.head 5 -  Set dfLim      = hWndC.AbstractCustomer..getLim()
.head 5 -  Set dfNom_dog  = hWndC.AbstractCustomer..getNomDog()
.head 5 -  Set dfLim_kass = hWndC.AbstractCustomer..getLimKass()
.head 5 -  ! Set dfNomPDV   = hWndC.AbstractCustomer..getNomPDV()
.head 5 -  Set dfRnkP     = hWndC.AbstractCustomer..getRnkP()
.head 5 -  Set mlNotesec  = hWndC.AbstractCustomer..getNotesec()
.head 5 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD
.head 6 -  Call SalSendMsg(tblAcc, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Call SetColorIndicateRisk(dfCriskId)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustInfo.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call EnableWindow(dfIsp, FALSE)
.head 4 -  Call EnableWindow(cmbIsp, FALSE)
.head 4 -  Call EnableWindow(dfNotes, FALSE)
.head 4 -  Call EnableWindow(dfIndicate, FALSE)
.head 4 -  Call EnableWindow(cmbCrisk, FALSE)
.head 4 -  Call EnableWindow(dfAdr_alt, FALSE)
.head 4 -  Call EnableWindow(dfLim, FALSE)
.head 4 -  Call EnableWindow(dfNom_dog, FALSE)
.head 4 -  Call EnableWindow(dfLim_kass, FALSE)
.head 4 -  ! Call EnableWindow(dfNomPDV, FALSE)
.head 4 -  Call EnableWindow(dfRnkP, FALSE)
.head 4 -  Call EnableWindow(mlNotesec, FALSE)
.head 4 -  Call SalSendMsg(tblAcc, SAM_DoInit, 0, 0)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbDel)
.head 3 +  On SAM_User
.head 4 +  If PAR_BANKTYPE = 'PRVX'
.head 5 -  Set sNmkM = hWndC.AbstractCustomer..getNmkv()
.head 5 +  If sNmkM = ''
.head 6 -  Set sNmkM = hWndC.AbstractCustomer..getNmkk()
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select substr(f_translate_kmu(:sNmkM),1,38) into :sNmkM from dual")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set sAdrM = hWndC.AbstractCustomer..getAdr()
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select substr(f_translate_kmu(:sAdrM),1,70) into :sAdrM from dual")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On UM_Update
.head 4 -  ! CorpsAcc
.head 4 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD
.head 5 -  Call SalSendMsg(hWndForm.Dlg_CustInfo.tblAcc, UM_Update, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustInfo.pic1, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.pic1, nWinWidth, FALSE)-0.17, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustInfo.cmbIsp, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.cmbIsp,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.cmbIsp, nWinWidth, FALSE)-4.95, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustInfo.dfNotes, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.dfNotes,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.dfNotes, nWinWidth, FALSE)-4.2, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustInfo.cmbCrisk, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.cmbCrisk,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.cmbCrisk, nWinWidth, FALSE)-4.95, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustInfo.dfAdr_alt, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.dfAdr_alt,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.dfAdr_alt, nWinWidth, FALSE)-4.2, nWH)
.head 4 -  !
.head 4 +  If PAR_BANKTYPE = 'PRVX' and bPersonSPD
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.mlNotesec,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.mlNotesec, nWinWidth, FALSE)-0.5, 0.95)
.head 5 -  Call SalGetWindowSize(hWndForm.Dlg_CustInfo.tblAcc, nWW, nWH)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.tblAcc,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.tblAcc, nWinWidth, FALSE)-1, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.tblAcc, nWinHeight, TRUE)-4.15)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_CustInfo.pbIns, nWW, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustInfo.pbIns, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.pbIns, nWinWidth, FALSE)-0.7, nWH)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_CustInfo.pbDel, nWW, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustInfo.pbDel, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.pbDel, nWinWidth, FALSE)-0.7, nWH)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_CustInfo.pbSWReceiver, nWW, nWH)
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_CustInfo.pbSWReceiver, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.pbSWReceiver, nWinWidth, FALSE)-0.7, nWH)
.head 4 +  Else
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_CustInfo.mlNotesec,
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.mlNotesec, nWinWidth, FALSE)-0.5, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustInfo.mlNotesec, nWinHeight, TRUE)-2.9)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustRel
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  14.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pbIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Добавить запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipIns'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblCustomerRel, UM_Insert, 0, 0)
.head 3 +  Picture: pbUpd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Редактировать запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipUpd'))
.head 5 +  On SAM_Click
.head 6 +  If tblCustomerRel.colIntExt = 0
.head 7 -  Call tblCustomerRel.editCustomerRel()
.head 3 +  Picture: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.0"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Удалить запись
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipDel'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblCustomerRel, UM_Delete, 0, 0)
.head 3 +  ! Picture: pbNsi
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.983"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\BOOK.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать значение из сравочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipNsi'))
.head 5 +  On SAM_Click
.head 6 +  If hCurrColumn
.head 7 -  Call SalSendMsg(hCurrColumn, SAM_DoubleClick, 0, 0)
.head 3 +  Picture: pbEditSign
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.017"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\EDIT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Подписи и печати
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipCustSign'))
.head 5 +  On SAM_Click
.head 6 +  If hCurrWndRel.Dlg_CustRel.tblRelDetails.colSignPrivs
.head 7 -  Set nSignId = hCurrWndRel.Dlg_CustRel.tblRelDetails.colSignId
.head 7 +  If SalModalDialog(dlgEditCustSign, hWndForm, bPossibleToEdit, nSignId)
.head 8 -  Set hCurrWndRel.Dlg_CustRel.tblRelDetails.colSignId = nSignId
.head 8 -  Call SalTblSetRowFlags(hCurrWndRel.Dlg_CustRel.tblRelDetails, SalTblQueryContext(hCurrWndRel.Dlg_CustRel.tblRelDetails), ROW_Edited, TRUE)
.head 8 -  Call hCurrWndRel.Dlg_CustRel.tblRelDetails.setRelValue()
.head 8 -  Call setEdited()
.head 3 +  Picture: picShowRel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.567"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\CHILDS.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Связи клиента
.head 6 -  ! Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Frm_Customer.cBTipCustSign'))
.head 6 -  Return XSalTooltipSetText(lParam, 'Связи клиента')
.head 5 +  On SAM_Click
.head 6 -  Call ShowCustomers(100, nRNK)
.head 3 +  Child Table: tblCustomerRel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    0.45"
.head 6 -  Width:  13.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.1"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 300
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colListIndex
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIntExt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: IntExt
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRelRnk	! ID/RNK связанного лица
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: РНК/Ид.
связанного
лица
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: colName		! S Наименование участника или ФИО
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование ЮЛ
или ФИО ФЛ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCustType	! N Признак (1-ЮЛ, 2-ФЛ)
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
(1-ЮЛ, 
 2-ФЛ)
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOkpo		! S Код
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCountry	! N Код страны
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
страны
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRegion	! S Код региона
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
региона
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVed		! S Код вида эконом. деят-ти (K110)
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код вида
эконом. деят-ти
(K110)
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSed		! S Код орг.-правовой формы хозяйствования (K051)
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код орг.-правовой
формы хоз-ния
(K051)
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIse		! S Код инст. сектора экономики (K070)
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код инст. сектора
экономики
(K070)
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAdr		! S Адрес
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Адрес
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTel		! S Телефон
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Телефон
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEMail	! S Адрес эл. почты
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Адрес
эл. почты
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDocType	! N Тип документа
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
документа
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDocTypeName	! Тип документа
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
документа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If colDocTypeName.Init(hWndItem)
.head 9 -  Call colDocTypeName.Populate(hSql(), 'PASSP', 'NAME', 'PASSP', 'ORDER BY passp')
.head 5 +  Column: colDocSerial	! S Серия документа
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Серия
документа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDocNumber	! S Номер документа
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
документа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 22
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDocDate	! D Дата выдачи документа
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата выдачи
документа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDocIssuer	! S Место выдачи документа
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Место выдачи
документа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBirthDay	! D Дата рождения
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
рождения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBirthPlace	! S Место рождения
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Место
рождения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSex		! S Пол
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSexName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_StrId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пол
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If colSexName.Init(hWndItem)
.head 9 -  Call colSexName.Populate(hSql(), 'id', 'name', 'sex', 'order by id')
.head 5 +  Column: colNotes	! S Примечание
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Примечание
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 80
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: setCustomerExtern
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sFs = '00'
.head 7 -  Call hWndC.AbstractCustomer..setCustomerRel(colListIndex, colRelRnk, colIntExt, colName,
     colDocType, colDocSerial, colDocNumber, colDocDate, colDocIssuer, colBirthDay, colBirthPlace,
     colSex, colAdr, colTel, colEMail, colCustType, colOkpo, colCountry, colRegion, 
     sFs, colVed, colSed, colIse, colNotes)
.head 7 -  Call setCustomerRelEditedFlag()
.head 7 -  Return TRUE
.head 5 +  Function: setCustomerRelEditedFlag
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 7 -  Call hWndC.AbstractCustomer..editCustomerRel(colListIndex)
.head 5 -  !
.head 5 +  Function: getCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : cCRel
.head 8 -  Class: cCustRel
.head 7 -  Number: nRelRnk
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select rnk, intext, custtype, nmk, okpo, adr, country, region,
        ved, sed, ise, 
        doc_type, doc_serial, doc_number, doc_date, doc_issuer,
        birthday, birthplace, sex, tel, email, notes
   into :cCRel.nRelRnk, :cCRel.nIntExt, :cCRel.nCusttype, :cCRel.sName, :cCRel.sOkpo, :cCRel.sAdr, :cCRel.nCountry, :cCRel.sRegion, 
        :cCRel.sVed, :cCRel.sSed, :cCRel.sIse,
        :cCRel.nDocType, :cCRel.sDocSerial, :cCRel.sDocNumber, :cCRel.dDocDate, :cCRel.sDocIssuer,
        :cCRel.dBirthday, :cCRel.sBirthplace, :cCRel.sSex, :cCRel.sTel, :cCRel.sEMail, :cCRel.sNotes
   from v_customerrel_list
  where rnk = :nRelRnk")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return TRUE
.head 5 +  Function: setCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : cCRel
.head 8 -  Class: cCustRel
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRetRow
.head 6 +  Actions
.head 7 -  Set colRelRnk     = cCRel.nRelRnk
.head 7 -  Set colIntExt     = cCRel.nIntExt
.head 7 -  Set colName       = cCRel.sName
.head 7 -  Set colDocType    = cCRel.nDocType
.head 7 -  Set colDocSerial  = cCRel.sDocSerial
.head 7 -  Set colDocNumber  = cCRel.sDocNumber
.head 7 -  Set colDocDate    = cCRel.dDocDate
.head 7 -  Set colDocIssuer  = cCRel.sDocIssuer
.head 7 -  Set colBirthDay   = cCRel.dBirthday
.head 7 -  Set colBirthPlace = cCRel.sBirthplace
.head 7 -  Set colSex        = cCRel.sSex
.head 7 -  Set colAdr        = cCRel.sAdr
.head 7 -  Set colTel        = cCRel.sTel
.head 7 -  Set colEMail      = cCRel.sEMail
.head 7 -  Set colCustType   = cCRel.nCusttype
.head 7 -  Set colOkpo       = cCRel.sOkpo
.head 7 -  Set colCountry    = cCRel.nCountry
.head 7 -  Set colRegion     = cCRel.sRegion
.head 7 -  Set colVed        = cCRel.sVed
.head 7 -  Set colSed        = cCRel.sSed
.head 7 -  Set colIse        = cCRel.sIse
.head 7 -  Set colNotes      = cCRel.sNotes
.head 7 +  If colIntExt = 0
.head 8 -  Call SalTblSetCellTextColor(colRelRnk, COLOR_DarkRed, TRUE)
.head 8 -  Call SalTblSetCellTextColor(colName, COLOR_DarkRed, TRUE)
.head 7 -  Return TRUE
.head 5 +  Function: setCustomerRelNull
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : cCRel
.head 8 -  Class: cCustRel
.head 7 -  Number: nCType
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set cCRel.nCusttype   = nCType
.head 7 -  Set cCRel.nRelRnk     = NUMBER_Null
.head 7 -  Set cCRel.nIntExt     = 0
.head 7 -  Set cCRel.sName       = STRING_Null
.head 7 -  Set cCRel.nDocType    = NUMBER_Null
.head 7 -  Set cCRel.sDocSerial  = STRING_Null
.head 7 -  Set cCRel.sDocNumber  = STRING_Null
.head 7 -  Set cCRel.dDocDate    = DATETIME_Null
.head 7 -  Set cCRel.sDocIssuer  = STRING_Null
.head 7 -  Set cCRel.dBirthday   = DATETIME_Null
.head 7 -  Set cCRel.sBirthplace = STRING_Null
.head 7 -  Set cCRel.sSex        = STRING_Null
.head 7 -  Set cCRel.sAdr        = STRING_Null
.head 7 -  Set cCRel.sTel        = STRING_Null
.head 7 -  Set cCRel.sEMail      = STRING_Null
.head 7 -  Set cCRel.sOkpo       = STRING_Null
.head 7 -  Set cCRel.nCountry    = NUMBER_Null
.head 7 -  Set cCRel.sRegion     = STRING_Null
.head 7 -  Set cCRel.sFs         = STRING_Null
.head 7 -  Set cCRel.sVed        = STRING_Null
.head 7 -  Set cCRel.sSed        = STRING_Null
.head 7 -  Set cCRel.sIse        = STRING_Null
.head 7 -  Set cCRel.sNotes      = STRING_Null
.head 7 -  Return TRUE
.head 5 +  Function: insCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nNewRow
.head 7 -  Number: nIndex
.head 7 -  : cCRel
.head 8 -  Class: cCustRel
.head 7 -  Boolean: bNew
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRetRow
.head 6 +  Actions
.head 7 -  Set nRetRow = SalTblInsertRow(hWndForm, nNewRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRetRow)
.head 7 -  ! начальная установка наименований по Id
.head 7 -  Call SalListSetSelect(colSexName, -1)
.head 7 -  Call SalListSetSelect(colDocTypeName, -1)
.head 7 -  Set colListIndex  = nIndex
.head 7 -  Call setCustomerRel(cCRel)
.head 7 +  If bNew
.head 8 -  Call setCustomerExtern()
.head 8 -  Call setEdited()
.head 7 -  Call colSexName.SetSelectById(colSex)
.head 7 -  Call colDocTypeName.SetSelectById(colDocType)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRetRow, ROW_New, bNew)
.head 7 -  Return nRetRow
.head 5 +  Function: editCustomerRel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  : cCRel
.head 8 -  Class: cCustRel
.head 6 +  Actions
.head 7 -  Set cCRel.nCusttype   = colCustType
.head 7 -  Set cCRel.nRelRnk     = colRelRnk
.head 7 -  Set cCRel.nIntExt     = colIntExt
.head 7 -  Set cCRel.sName       = colName
.head 7 -  Set cCRel.nDocType    = colDocType
.head 7 -  Set cCRel.sDocSerial  = colDocSerial
.head 7 -  Set cCRel.sDocNumber  = colDocNumber
.head 7 -  Set cCRel.dDocDate    = colDocDate
.head 7 -  Set cCRel.sDocIssuer  = colDocIssuer
.head 7 -  Set cCRel.dBirthday   = colBirthDay
.head 7 -  Set cCRel.sBirthplace = colBirthPlace
.head 7 -  Set cCRel.sSex        = colSex
.head 7 -  Set cCRel.sAdr        = colAdr
.head 7 -  Set cCRel.sTel        = colTel
.head 7 -  Set cCRel.sEMail      = colEMail
.head 7 -  Set cCRel.sOkpo       = colOkpo
.head 7 -  Set cCRel.nCountry    = colCountry
.head 7 -  Set cCRel.sRegion     = colRegion
.head 7 -  Set cCRel.sFs         = STRING_Null
.head 7 -  Set cCRel.sVed        = colVed
.head 7 -  Set cCRel.sSed        = colSed
.head 7 -  Set cCRel.sIse        = colIse
.head 7 -  Set cCRel.sNotes      = colNotes
.head 7 +  If not SalModalDialog(Dlg_CustRelExtern, hWndForm, cCRel)
.head 8 -  Return FALSE
.head 7 -  Call setCustomerRel(cCRel)
.head 7 -  Call setCustomerExtern()
.head 7 -  Call setEdited()
.head 7 -  Return TRUE
.head 5 +  Function: delCustomerRel
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call hWndC.AbstractCustomer..deleteCustomerRel(colListIndex)
.head 4 +  Window Variables
.head 5 -  : cCustomerRel
.head 6 -  Class: cCustRel
.head 5 -  Number: i
.head 5 -  Number: nRow
.head 5 -  Number: nRowErr
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nCheckCustomerRel
.head 5 -  Number: nCheckRelId
.head 5 -  String: sCheckPar
.head 5 -  String: sCheckParName
.head 5 -  Window Handle: hCheckWndCol
.head 5 -  Boolean: bTblCustomerRel
.head 5 -  Number: nCurrFocusRow
.head 5 -  String: sFs
.head 5 -  Number: nChooseCusttype
.head 5 -  Number: nChooseRnk
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Call SalTblSetLockedColumns(hWndForm, 6)
.head 6 -  Set nOrderBy = 1
.head 6 -  Set nCustomerRelIndex = NUMBER_Null
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set i = 0
.head 6 +  While i < hWndC.AbstractCustomer..getCustomerRelParNum()
.head 7 -  Call hWndC.AbstractCustomer..getCustomerRel(i, cCustomerRel.nRelRnk, cCustomerRel.nIntExt, 
     cCustomerRel.sName, cCustomerRel.nDocType, cCustomerRel.sDocSerial, cCustomerRel.sDocNumber, cCustomerRel.dDocDate, cCustomerRel.sDocIssuer,
     cCustomerRel.dBirthday, cCustomerRel.sBirthplace, cCustomerRel.sSex, cCustomerRel.sAdr, cCustomerRel.sTel, cCustomerRel.sEMail, 
     cCustomerRel.nCusttype, cCustomerRel.sOkpo, cCustomerRel.nCountry, cCustomerRel.sRegion, 
     sFs, cCustomerRel.sVed, cCustomerRel.sSed, cCustomerRel.sIse, cCustomerRel.sNotes)
.head 7 -  Set nRow = insCustomerRel(i, i, cCustomerRel, FALSE)
.head 7 -  Set i = i + 1
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 6 +  If i > 0
.head 7 -  Call SalEnableWindow(hCurrWndRel.Dlg_CustRel.tblRelations)
.head 7 -  Call SalSetFocus(hWndForm)
.head 7 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set nCurrFocusRow = SalTblQueryContext(hWndForm)
.head 6 -  Set nCustomerRelIndex = colListIndex
.head 6 -  Set nCustomerRelType  = colCustType
.head 6 -  Set bRowDeleted = SalTblQueryRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_MarkDeleted)
.head 6 -  Call SalSendMsg(hCurrWndRel.Dlg_CustRel.tblRelations, UM_Populate, 0, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 5 +  On UM_Insert
.head 6 +  If SalModalDialog(Dlg_ChooseCustRel, hWndForm, nChooseCusttype, nChooseRnk)
.head 7 -  ! выбрали связ. лицо - читаем его данные
.head 7 +  If nChooseRnk
.head 8 -  Call getCustomerRel(cCustomerRel, nChooseRnk)
.head 7 -  ! иначе заводим новое связ. лицо
.head 7 +  Else
.head 8 -  Call setCustomerRelNull(cCustomerRel, nChooseCusttype)
.head 8 +  If not SalModalDialog(Dlg_CustRelExtern, hWndForm, cCustomerRel)
.head 9 -  Return FALSE
.head 7 -  Set nRow = insCustomerRel(TBL_MaxRow, NUMBER_Null, cCustomerRel, TRUE)
.head 7 -  Call SalSetFocus(hWndForm)
.head 7 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call delCustomerRel()
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 8 -  Set nRow = nRow - 1
.head 7 +  Else
.head 8 -  Set colListIndex = NUMBER_Null
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, TRUE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, FALSE)
.head 6 -  !
.head 6 +  If SalTblAnyRows(hWndForm, 0, 0)
.head 7 -  Call setEdited()
.head 7 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 7 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 6 +  Else
.head 7 -  Set nCustomerRelIndex = NUMBER_Null
.head 6 -  !
.head 6 -  Call SalSendMsg(hCurrWndRel.Dlg_CustRel.tblRelations, UM_Populate, 0, 0)
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited | ROW_New | ROW_MarkDeleted, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, FALSE)
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 8 -  Set nRow = nRow - 1
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited | ROW_New, FALSE)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 5 +  On UM_BeforeClose
.head 6 -  Set sCheckParName = ''
.head 6 +  If hWndC.AbstractCustomer..checkRel(nCheckCustomerRel, nCheckRelId, sCheckPar) and sCheckPar
.head 7 -  Set bTblCustomerRel = FALSE
.head 7 +  If sCheckPar = REL_RELATIONS
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = REL_RELATIONS
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colRelRnk
.head 7 +  Else If sCheckPar = REL_CUSTTYPE
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colCustType')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colCustType
.head 7 +  Else If sCheckPar = REL_OKPO
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colOkpo')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colOkpo
.head 7 +  Else If sCheckPar = REL_COUNTRY
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colCountry')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colCountry
.head 7 +  Else If sCheckPar = REL_REGION
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colRegion')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colRegion
.head 7 +  Else If sCheckPar = REL_VED
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colVed')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colVed
.head 7 +  Else If sCheckPar = REL_SED
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colSed')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colSed
.head 7 +  Else If sCheckPar = REL_ISE
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colIse')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colIse
.head 7 +  Else If sCheckPar = REL_DOCTYPE
.head 8 -  Set bTblCustomerRel = TRUE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colDocTypeName')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblCustomerRel.colDocTypeName
.head 7 +  Else If sCheckPar = TRUSTEE_TYPEID
.head 8 -  Set bTblCustomerRel = FALSE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colTypeName')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblRelDetails.colTypeName
.head 7 +  Else If sCheckPar = TRUSTEE_DOCUMENTTYPEID
.head 8 -  Set bTblCustomerRel = FALSE
.head 8 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colDocTypeName')
.head 8 -  Set hCheckWndCol  = hCurrWndRel.Dlg_CustRel.tblRelDetails.colDocTypeName
.head 7 +  If sCheckParName
.head 8 -  ! Не указан тип связи для связанного лица!
  Не заполнен реквизит <sCheckParName>
.head 8 -  Call SalMessageBox(IifS(sCheckParName = REL_RELATIONS, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.cTMsgRelNotSet'), 
     CurrentLangTable.GetAtomTitle('cTErrRekv') || ' <' || VisStrSubstitute(sCheckParName, PutCrLf(), ' ') || '>'), 
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 -  Return 2
.head 6 -  Return 1
.head 5 +  On UM_Clear
.head 6 -  Call SalTblClearSelection(hWndForm)
.head 6 -  Call SalSetFocus(hWndForm)
.head 6 -  Set nRowErr = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRowErr, 0, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRowErr)
.head 7 +  If colListIndex = nCheckCustomerRel
.head 8 -  Call SalTblSetFocusRow(hWndForm, nRowErr)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRowErr, ROW_Selected, TRUE)
.head 8 -  Break
.head 6 -  !
.head 6 +  If bTblCustomerRel 
.head 7 +  If hCheckWndCol
.head 8 -  Call SalTblSetFocusCell(hWndForm, nRowErr, hCheckWndCol, 0, 0)
.head 6 +  Else
.head 7 -  Call SalTblClearSelection(hCurrWndRel.Dlg_CustRel.tblRelations)
.head 7 -  Call SalSetFocus(hCurrWndRel.Dlg_CustRel.tblRelations)
.head 7 -  Set nRowErr = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hCurrWndRel.Dlg_CustRel.tblRelations, nRowErr, 0, 0)
.head 8 -  Call SalTblSetContext(hCurrWndRel.Dlg_CustRel.tblRelations, nRowErr)
.head 8 +  If hCurrWndRel.Dlg_CustRel.tblRelations.colRelId = nCheckRelId
.head 9 -  Call SalSetFocus(hCurrWndRel.Dlg_CustRel.tblRelations)
.head 9 -  Call SalTblSetFocusRow(hCurrWndRel.Dlg_CustRel.tblRelations, nRowErr)
.head 9 -  Call SalTblSetRowFlags(hCurrWndRel.Dlg_CustRel.tblRelations, nRowErr, ROW_Selected, TRUE)
.head 9 -  Call SalSendMsg(hCurrWndRel.Dlg_CustRel.tblRelations, SAM_TblDoDetails, 0, 0)
.head 9 -  !
.head 9 -  Call SalSetFocus(hCurrWndRel.Dlg_CustRel.tblRelDetails)
.head 9 -  Call SalTblSetFocusRow(hCurrWndRel.Dlg_CustRel.tblRelDetails, 0)
.head 9 -  Call SalTblSetFocusCell(hCurrWndRel.Dlg_CustRel.tblRelDetails, 0, hCheckWndCol, 0, 0)
.head 9 -  Break
.head 3 +  Child Table: tblRelations
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    3.012"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.2"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colListIndex
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRelId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRelName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
связанности
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRelFlag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Привязать
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 -  ! Если можно редактировать и есть неудаленные строки в связанных лицах
.head 8 +  If bPossibleToEdit and not bRowDeleted
.head 9 -  Call hCurrWndRel.Dlg_CustRel.tblCustomerRel.setCustomerRelEditedFlag()
.head 9 +  If nCustomerRelIndex != NUMBER_Null
.head 10 -  Call setEdited()
.head 10 -  Set colRelFlag = not colRelFlag
.head 10 +  If colRelFlag
.head 11 -  Call hWndC.AbstractCustomer..addRel(colListIndex, nCustomerRelIndex, colRelId)
.head 10 +  Else
.head 11 -  Call hWndC.AbstractCustomer..deleteRel(colListIndex)
.head 10 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 10 -  Call setRelDetails()
.head 5 +  Column: colRelFVaga
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: f_vaga
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: setRelDetails
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! Код связанности
.head 7 -  Set nRelId    = colRelId
.head 7 -  ! Признак: установлена связанность
.head 7 -  Set bRelFlag  = colRelFlag
.head 7 -  ! Признак: заполнять Удельный вес
.head 7 -  Set bRelFVaga = colRelFVaga
.head 7 -  ! Население детальной таблицы
.head 7 -  Call SalSendMsg(hCurrWndRel.Dlg_CustRel.tblRelDetails, UM_Populate, 0, 0)
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nRow
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"select id, name, nvl(f_vaga,0)
   into :hWndForm.tblRelations.colRelId, 
        :hWndForm.tblRelations.colRelName, 
        :hWndForm.tblRelations.colRelFVaga
   from v_cust_rel 
  where " || sCustomerFieldCType || " = 1
    and nvl(type,:nCustomerRelType) = :nCustomerRelType
  order by sort, name", TBL_FillAll)
.head 6 -  ! Выставляем флаг связанности
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, 0 ,0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If nCustomerRelIndex != NUMBER_Null
.head 8 -  Set colListIndex = hWndC.AbstractCustomer..getRelation(nCustomerRelIndex, colRelId)
.head 8 +  If colListIndex != NUMBER_Null
.head 9 -  Set colRelFlag = TRUE
.head 8 +  Else
.head 9 -  Set colRelFlag = FALSE
.head 7 +  Else
.head 8 -  Set colRelFlag = FALSE
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, FALSE)
.head 6 -  ! Сортировка: связанные вверху
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(colRelFlag), TBL_SortDecreasing)
.head 6 -  Call SalSetFocus(hWndForm)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 6 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call setRelDetails()
.head 6 +  If colRelId = 20 and hWndParent.Frm_Customer.isCustSign
.head 7 -  Call SalShowWindow(pbEditSign)
.head 6 +  Else
.head 7 -  Call SalHideWindow(pbEditSign)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 5 +  On SAM_KillFocus
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 +  Child Table: tblRelDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.317"
.head 6 -  Top:    3.0"
.head 6 -  Width:  9.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colVaga1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Удельный вес
прямого
участия
в уставном фонде
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 7
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If colVaga1 > 100
.head 9 -  ! Значение не должно превышать 100
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustRel.cTMsgVaga100'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set colVaga1 = colVaga1 - SalNumberMod(colVaga1,1) +
    Val(Subs(Str(SalNumberMod(colVaga1,1)*SalNumberPower(10,4)),1,4))/SalNumberPower(10,4)
.head 8 -  Call setRelValue()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colVaga2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Удельный вес
опосредствованного
участия
в уставном фонде
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 7
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If colVaga2 > 100
.head 9 -  ! Значение не должно превышать 100
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustRel.cTMsgVaga100'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set colVaga2 = colVaga2 - SalNumberMod(colVaga2,1) +
    Val(Subs(Str(SalNumberMod(colVaga2,1)*SalNumberPower(10,4)),1,4))/SalNumberPower(10,4)
.head 8 -  Call setRelValue()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colTypeId	! Ид. типа довереного лица
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTypeName	! тип довереного лица
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
довереного
лица
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If colTypeName.Init(hWndItem)
.head 9 -  Call colTypeName.Populate(hSql(), 'id', 'name', 'trustee_type', 'order by id')
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 -  Set colTypeId = colTypeName.GetKey(SalListQuerySelection(colTypeName))
.head 8 -  Call setRelValue()
.head 5 +  Column: colPosition	! Должность
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Должность
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colPosition_r	! Должность в род. падеже
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Должность
в род. падеже
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colDocTypeId	! Ид. типа документа, на основании которого ФЛ является довереным лицом
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип документа
доверенного лица
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDocTypeName	! тип документа, на основании которого ФЛ является довереным лицом
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
документа
доверенного
лица
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If colDocTypeName.Init(hWndItem)
.head 9 -  Call colDocTypeName.Populate(hSql(), 'id', 'name', 'trustee_document_type', 'order by id')
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 -  Set colDocTypeId = colDocTypeName.GetKey(SalListQuerySelection(colDocTypeName))
.head 8 -  Call setRelValue()
.head 5 +  Column: colDocument	! Документ доверенности
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Документ
доверенности
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colTRegnum	! Номер регистрации доверенности
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
регистрации
доверенности
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colTRegdat	! Дата регистрации доверенности
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
регистрации
доверенности
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colBDate	! Дата начала действия доверенности
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
начала
действия
доверенности
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colEDate	! Дата окончания действия доверенности
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
окончания
действия
доверенности
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colNName	! ФИО нотариуса
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ФИО
нотариуса
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colNRegion	! Нотариальный округ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Нотариальный
округ
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 5 +  Column: colSignPrivs	! Есть ли у доверенного лица право подписи (0/1)
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Право
подписи
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 +  ! If not colSignPrivs
.head 9 -  Set colSignId = NUMBER_Null
.head 8 -  Call setRelValue()
.head 5 +  Column: colSignId	! Ид. графического представления подписи доверенного лица
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLastName	! S Фамилия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фамилия
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colFirstName	! S Имя
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colMiddleName	! S Отчество
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отчество
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colNameR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ФИО
в род. падеже
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Call setRelValue()
.head 4 +  Functions
.head 5 +  Function: setRelValue
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call hCurrWndRel.Dlg_CustRel.tblCustomerRel.setCustomerRelEditedFlag()
.head 7 -  Call hWndC.AbstractCustomer..setRelValue(nCustomerRelIndex, nRelId, colVaga1, colVaga2, 
     colTypeId, colPosition, colPosition_r, colFirstName, colMiddleName, colLastName, 
     colDocTypeId, colDocument, colTRegnum, colTRegdat, colBDate, colEDate, 
     colNName, colNRegion, colSignPrivs, colSignId, colNameR)
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Call SalTblInsertRow(hWndForm, 0)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  ! Окрываем/закрываем поля, даты начала/оконч. действия доверенности/полномочий показываем всегда
.head 6 -  ! Доверенные лица
.head 6 +  If nRelId = 20
.head 7 -  Call SalTblSetColumnTitle(tblRelDetails.colBDate, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colBDate'))
.head 7 -  Call SalTblSetColumnTitle(tblRelDetails.colEDate, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colEDate'))
.head 7 -  Call SalHideWindow(colVaga1)
.head 7 -  Call SalHideWindow(colVaga2)
.head 7 -  Call SalShowWindow(colTypeName)
.head 7 -  Call SalShowWindow(colPosition)
.head 7 -  Call SalShowWindow(colPosition_r)
.head 7 -  Call SalShowWindow(colLastName)
.head 7 -  Call SalShowWindow(colFirstName)
.head 7 -  Call SalShowWindow(colMiddleName)
.head 7 -  Call SalShowWindow(colDocTypeName)
.head 7 -  Call SalShowWindow(colDocument)
.head 7 -  Call SalShowWindow(colTRegnum)
.head 7 -  Call SalShowWindow(colTRegdat)
.head 7 -  Call SalShowWindow(colNName)
.head 7 -  Call SalShowWindow(colNRegion)
.head 7 -  Call SalShowWindow(colSignPrivs)
.head 7 -  Call SalShowWindow(colNameR)
.head 6 -  ! Остальные
.head 6 +  Else
.head 7 -  Call SalTblSetColumnTitle(tblRelDetails.colBDate, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colRelBDate'))
.head 7 -  Call SalTblSetColumnTitle(tblRelDetails.colEDate, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colRelEDate'))
.head 7 -  ! Удельный вес
.head 7 +  If bRelFVaga
.head 8 -  Call SalShowWindow(colVaga1)
.head 8 -  Call SalShowWindow(colVaga2)
.head 7 +  Else
.head 8 -  Call SalHideWindow(colVaga1)
.head 8 -  Call SalHideWindow(colVaga2)
.head 7 -  Call SalHideWindow(colTypeName)
.head 7 -  Call SalHideWindow(colPosition)
.head 7 -  Call SalHideWindow(colPosition_r)
.head 7 -  Call SalHideWindow(colLastName)
.head 7 -  Call SalHideWindow(colFirstName)
.head 7 -  Call SalHideWindow(colMiddleName)
.head 7 -  Call SalHideWindow(colDocTypeName)
.head 7 -  Call SalHideWindow(colDocument)
.head 7 -  Call SalHideWindow(colTRegnum)
.head 7 -  Call SalHideWindow(colTRegdat)
.head 7 -  Call SalHideWindow(colNName)
.head 7 -  Call SalHideWindow(colNRegion)
.head 7 -  Call SalHideWindow(colSignPrivs)
.head 7 -  Call SalHideWindow(colNameR)
.head 6 -  !
.head 6 +  If bRelFlag
.head 7 +  If bPossibleToEdit
.head 8 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 8 +  While hColumn != hWndNULL
.head 9 -  Call SalEnableWindow(hColumn)
.head 9 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 7 +  If nRelId = 20
.head 8 -  ! начальная установка наименований по Id
.head 8 -  Call SalListSetSelect(colTypeName, -1)
.head 8 -  Call SalListSetSelect(colDocTypeName, -1)
.head 7 -  ! Читаем параметры связ. лица
.head 7 -  Call hWndC.AbstractCustomer..getRelValue(nCustomerRelIndex, nRelId, colVaga1, colVaga2, 
     colTypeId, colPosition, colPosition_r, colFirstName, colMiddleName, colLastName, 
     colDocTypeId, colDocument, colTRegnum, colTRegdat, colBDate, colEDate,
     colNName, colNRegion, colSignPrivs, colSignId, colNameR)
.head 7 +  If nRelId = 20
.head 8 -  ! установка наименований по Id
.head 8 -  Call colTypeName.SetSelectById(colTypeId)
.head 8 -  Call colDocTypeName.SetSelectById(colDocTypeId)
.head 6 +  Else
.head 7 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 6 -  !
.head 6 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustRel.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  String: sCustomerFieldCType	! фильтр по типу клиента
.head 3 -  !
.head 3 -  Window Handle: hCurrWndRel
.head 3 -  Window Handle: hCurrColumn
.head 3 -  !
.head 3 -  Number: nCustomerRelIndex	! Id в списке связ. лиц
.head 3 -  Number: nCustomerRelType	! Тип связанного лица
.head 3 -  Number: nRelId		! Код связанности
.head 3 -  Boolean: bRelFlag	! Признак: установлена связанность
.head 3 -  Boolean: bRelFVaga	! Признак: заполнять Удельный вес
.head 3 -  Boolean: bRowDeleted
.head 3 -  ! Number: nNsiColor
.head 3 -  Number: nSignId
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustRel')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustRel.tblCustomerRel.colDocTypeName, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colDocTypeName'))
.head 4 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustRel.tblCustomerRel.colSexName, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblCustomerRel.colSexName'))
.head 4 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustRel.tblRelDetails.colTypeName, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colTypeName'))
.head 4 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustRel.tblRelDetails.colDocTypeName, 
     CurrentLangTable.GetAtomTitle('Dlg_CustRel.tblRelDetails.colDocTypeName'))
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit  = hWndParent.Frm_Customer.cTabCustRel.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set sCustomerFieldCType = hWndParent.Frm_Customer.sCustomerFieldCType
.head 4 -  Set hCurrWndRel = hWndForm
.head 4 -  ! Set nNsiColor   = SalColorFromRGB(230, 255, 255)
.head 4 -  !
.head 4 -  ! Call SalDisableWindow(pbNsi)
.head 4 -  ! Call SalHideWindow(pbNsiRel)
.head 4 -  If PAR_BANKTYPE = 'SBER' and PAR_HAVETOBO != 2
.head 4 +  Else
.head 5 -  Call SalHideWindow(picShowRel)
.head 4 -  !
.head 4 -  Set hWndObject=SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  If nRNK = 0
.head 4 +  Else
.head 5 -  Call SalSendMsg(hWndForm.Dlg_CustRel.tblCustomerRel, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Call SalSendMsg(hWndForm, WM_Size, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustRel.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  ! Call SalDisableWindow(pbIns)
.head 4 -  ! Call SalDisableWindow(pbUpd)
.head 4 -  ! Call SalDisableWindow(pbDel)
.head 4 -  Call SalHideWindow(pbIns)
.head 4 -  Call SalHideWindow(pbUpd)
.head 4 -  Call SalHideWindow(pbDel)
.head 4 -  ! Call SalDisableWindow(pbNsi)
.head 4 -  ! Call SalDisableWindow(pbNsiRel)
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustRel.tblCustomerRel, SAM_DoInit, 0, 0)
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustRel.tblRelations,   SAM_DoInit, 0, 0)
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustRel.tblRelDetails,  SAM_DoInit, 0, 0)
.head 3 +  On UM_BeforeClose
.head 4 -  Return SalSendMsg(hWndForm.Dlg_CustRel.tblCustomerRel, UM_BeforeClose, 0, 0)
.head 3 +  On UM_Clear
.head 4 -  Return SalSendMsg(hWndForm.Dlg_CustRel.tblCustomerRel, UM_Clear, 0, 0)
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustRel.tblCustomerRel, UM_Update, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  ! tblCustomerRel
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustRel.tblCustomerRel,
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblCustomerRel, nWinWidth, FALSE)-0.2, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblCustomerRel, nWinHeight, TRUE)/2)
.head 4 -  ! tblRelations
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustRel.tblRelations, 0.08, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelations, nWinHeight, TRUE)/2+0.5)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustRel.tblRelations, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelations, nWinWidth, FALSE)/2-0.2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelations, nWinHeight, TRUE)/2-0.6)
.head 4 -  ! tblRelations.colRelName
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_CustRel.tblRelations, nWW, nWH)
.head 4 -  Call SalTblSetColumnWidth(hWndForm.Dlg_CustRel.tblRelations.colRelName, nWW-1.6)
.head 4 -  ! tblRelDetails
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustRel.tblRelDetails, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelDetails, nWinWidth, FALSE)/2, 
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelDetails, nWinHeight, TRUE)/2+0.5)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustRel.tblRelDetails,
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelDetails, nWinWidth, FALSE)/2-0.2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustRel.tblRelDetails, nWinHeight, TRUE)/2-0.6)
.head 4 -  !
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_CustRelExtern
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Редактирование параметров связанного лица
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.1"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ! Picture: pic1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 6.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.end
.head 4 -  Message Actions 
.head 3 -  Frame
.head 4 -  Resource Id: 60902
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 6.6"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Наименование связ.лица
.head 4 -  Resource Id: 60882
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ОКПО
.head 4 -  Resource Id: 60883
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.55"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.5"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Страна
.head 4 -  Resource Id: 60884
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.85"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCountry
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfCountry
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.8"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call cmbCountry.SetSelectById(dfCountry)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Combo Box: cmbCountry
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    0.81"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.905"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbCountry.Init(hWndItem)
.head 7 -  Call cmbCountry.Populate(hSql(), "country", "lpad(country,3,' ') || '  ' || name", "country", "order by name")
.head 7 -  Call cmbCountry.SetSelectById(cCustomerRel.nCountry)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfCountry = cmbCountry.nCurrentId
.head 3 -  Background Text: Регион
.head 4 -  Resource Id: 60885
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.15"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgReg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfReg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.1"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call cmbReg.SetSelectById(dfReg)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Combo Box: cmbReg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.1"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.595"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbReg.Init(hWndItem)
.head 7 -  Call cmbReg.Populate(hSql(), 'c_reg', 'name_reg', 'Spr_obl', 'order by name_reg')
.head 7 -  Call cmbReg.SetSelectById(cCustomerRel.sRegion)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfReg = cmbReg.strCurrentId
.head 3 -  Background Text: Адрес
.head 4 -  Resource Id: 60889
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.45"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.4"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Телефон
.head 4 -  Resource Id: 60888
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.7"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес эл.почты
.head 4 -  Resource Id: 60887
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.05"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgEMail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEMail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    2.0"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Frame
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    2.25"
.head 5 -  Width:  9.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.94"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Вид эк. деятельности (K110)
.head 4 -  Resource Id: 60890
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.35"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    2.3"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalColorSet(dfVed, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfVed)
.head 7 -  Call SalListSetSelect(cmbVed, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbVed.SetSelectById(dfVed)
.head 6 +  If not cmbVed.strCurrentId
.head 7 -  ! Нет такого вида
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrVed'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipVed)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbVed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    2.3"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.286"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbVed.Init(hWndItem)
.head 7 -  Call cmbVed.Populate(hSql(), "ved", "ved||' '||name", "ved", 
"where (d_close is null or d_close>=bankdate) order by ved")
.head 7 -  Call cmbVed.SetSelectById(dfVed)
.head 7 +  If NOT cmbVed.strCurrentId
.head 8 -  Call SalColorSet(dfVed, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM ved WHERE ved=:dfVed")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipVed = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVed = cmbVed.strCurrentId
.head 6 -  Set sToolTipVed = ""
.head 6 -  Call SalColorSet(dfVed, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  Background Text: Форма хозяйствования (K051)
.head 4 -  Resource Id: 60891
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.65"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    2.6"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalColorSet(dfSed, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfSed)
.head 7 -  Call SalListSetSelect(cmbSed, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbSed.SetSelectById(dfSed)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipSed)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbSed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    2.6"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.976"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbSed.Init(hWndItem)
.head 7 -  Call cmbSed.Populate(hSql(), "rtrim(sed)", "sed||' '||name", "sed", 
"where (d_close is null or d_close>=bankdate) order by sed")
.head 7 -  Call cmbSed.SetSelectById(dfSed)
.head 7 +  If NOT cmbSed.strCurrentId
.head 8 -  Call SalColorSet(dfSed, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM sed WHERE sed=:dfSed")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipSed = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfSed = cmbSed.strCurrentId
.head 6 -  Set sToolTipSed = ""
.head 6 -  Call SalColorSet(dfSed, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  Background Text: Инст. сек. экономики (K070)
.head 4 -  Resource Id: 60886
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.95"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIse
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIse
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    2.9"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalColorSet(dfIse, COLOR_IndexWindowText, COLOR_Black)
.head 6 +  If SalIsNull(dfIse)
.head 7 -  Call SalListSetSelect(cmbIse, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbIse.SetSelectById(dfIse)
.head 6 +  If not cmbIse.strCurrentId
.head 7 -  ! Нет такого сектора
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustEN.cTErrIse'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  Call XSalTooltipSetColors(COLOR_Red, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sToolTipIse)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  Combo Box: cmbIse
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    2.9"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.667"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbIse.Init(hWndItem)
.head 7 -  Call cmbIse.Populate(hSql(), "ise", "ise||' '||name", "ise", 
"where (d_close is null or d_close>=bankdate) order by ise")
.head 7 -  Call cmbIse.SetSelectById(dfIse)
.head 7 +  If NOT cmbIse.strCurrentId
.head 8 -  Call SalColorSet(dfIse, COLOR_IndexWindowText, COLOR_Red)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT name INTO :sTmp FROM ise WHERE ise=:dfIse")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sToolTipIse = sTmp
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfIse = cmbIse.strCurrentId
.head 6 -  Set sToolTipIse = ""
.head 6 -  Call SalColorSet(dfIse, COLOR_IndexWindowText, COLOR_Black)
.head 3 -  ! Frame
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    5.57"
.head 5 -  Width:  9.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.68"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Документ
.head 4 -  Resource Id: 60892
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.25"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDoc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbDoc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.7"
.head 5 -  Top:    3.2"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbDoc.Init(hWndItem)
.head 7 -  Call cmbDoc.Populate(hSql(), 'passp', 'name', 'passp', '')
.head 7 -  Call cmbDoc.SetSelectById(cCustomerRel.nDocType)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set cCustomerRel.nDocType = cmbDoc.nCurrentId
.head 6 +  If not CheckPasspSer(cCustomerRel.nDocType, dfDocSer)
.head 7 -  Set dfDocSer = STRING_Null
.head 7 -  Call SalSetFocus(dfDocSer)
.head 6 +  Else If not CheckPasspNum(cCustomerRel.nDocType, dfDocNum, dfDocNum)
.head 7 -  Set dfDocNum = STRING_Null
.head 7 -  Call SalSetFocus(dfDocNum)
.head 3 -  Background Text: Серия документа
.head 4 -  Resource Id: 60900
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.55"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocSer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocSer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    3.5"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Номер документа
.head 4 -  Resource Id: 60899
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.85"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocNum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocNum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    3.8"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата выдачи документа
.head 4 -  Resource Id: 60898
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.15"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    4.1"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Орган выдачи документа
.head 4 -  Resource Id: 60897
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.45"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDocIssue
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocIssue
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    4.4"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата рождения
.head 4 -  Resource Id: 60896
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.75"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBDay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBDay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    4.7"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Место рождения
.head 4 -  Resource Id: 60895
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    5.05"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBPlace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBPlace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    5.0"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Пол
.head 4 -  Resource Id: 60894
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    5.35"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.7"
.head 5 -  Top:    5.3"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbSex.Init(hWndItem)
.head 7 -  Call cmbSex.Populate(hSql(), 'id', 'name', 'sex', 'order by id')
.head 7 -  Call cmbSex.SetSelectById(cCustomerRel.sSex)
.head 7 +  If cCustomerRel.nCusttype = 1
.head 8 -  Call cmbSex.SetSelectById('0')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set cCustomerRel.sSex = cmbSex.GetCurrentKey()
.head 3 -  Background Text: Примечание
.head 4 -  Resource Id: 60893
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    5.65"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgComm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfComm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 80
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    5.6"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 38554
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    5.9"
.head 5 -  Width:  9.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   6.1"
.head 5 -  Top:    6.1"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If check()
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.4"
.head 5 -  Top:    6.1"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 +  Functions
.head 3 +  Function: check
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCheckParName
.head 4 +  Actions
.head 5 +  If SalIsNull(dfNmk)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgNmk')
.head 6 -  Call SalSetFocus(dfNmk)
.head 5 +  Else If SalIsNull(dfOkpo)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgOkpo')
.head 6 -  Call SalSetFocus(dfOkpo)
.head 5 +  Else If SalIsNull(dfCountry)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgCountry')
.head 6 -  Call SalSetFocus(dfCountry)
.head 5 +  Else If SalIsNull(dfReg)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgReg')
.head 6 -  Call SalSetFocus(dfReg)
.head 5 +  Else If SalIsNull(dfVed)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgVed')
.head 6 -  Call SalSetFocus(dfVed)
.head 5 +  Else If SalIsNull(dfSed)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgSed')
.head 6 -  Call SalSetFocus(dfSed)
.head 5 +  Else If SalIsNull(dfIse)
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgIse')
.head 6 -  Call SalSetFocus(dfIse)
.head 5 +  Else If cCustomerRel.nCusttype = 2 and cmbDoc.nCurrentId = NUMBER_Null
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgDoc')
.head 6 -  Call SalSetFocus(cmbDoc)
.head 5 +  Else If cCustomerRel.nCusttype = 2 and cmbSex.strCurrentId = STRING_Null
.head 6 -  Set sCheckParName = CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.bgSex')
.head 6 -  Call SalSetFocus(cmbSex)
.head 5 +  If sCheckParName
.head 6 -  ! Не заполнен реквизит <sCheckParName>
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrCustRekv') || ' <' || sCheckParName || '>', 
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Set cCustomerRel.sName       = dfNmk
.head 5 -  Set cCustomerRel.nDocType    = cmbDoc.nCurrentId
.head 5 -  Set cCustomerRel.sDocSerial  = dfDocSer
.head 5 -  Set cCustomerRel.sDocNumber  = dfDocNum
.head 5 -  Set cCustomerRel.dDocDate    = dfDocDate
.head 5 -  Set cCustomerRel.sDocIssuer  = dfDocIssue
.head 5 -  Set cCustomerRel.dBirthday   = dfBDay
.head 5 -  Set cCustomerRel.sBirthplace = dfBPlace
.head 5 -  Set cCustomerRel.sSex        = cmbSex.GetCurrentKey()
.head 5 -  Set cCustomerRel.sAdr        = dfAdr
.head 5 -  Set cCustomerRel.sTel        = dfTel
.head 5 -  Set cCustomerRel.sEMail      = dfEMail
.head 5 -  Set cCustomerRel.sOkpo       = dfOkpo
.head 5 -  Set cCustomerRel.nCountry    = dfCountry
.head 5 -  Set cCustomerRel.sRegion     = dfReg
.head 5 -  Set cCustomerRel.sVed        = dfVed
.head 5 -  Set cCustomerRel.sSed        = dfSed
.head 5 -  Set cCustomerRel.sIse        = dfIse
.head 5 -  Set cCustomerRel.sNotes      = dfComm
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  : cCustomerRel
.head 4 -  Class: cCustRel
.head 2 +  Window Variables
.head 3 -  String: sToolTipVed
.head 3 -  String: sToolTipSed
.head 3 -  String: sToolTipIse
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_CustRelExtern.cTWndTitle'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set dfNmk      = cCustomerRel.sName
.head 4 -  Set dfOkpo     = cCustomerRel.sOkpo
.head 4 -  Set dfCountry  = cCustomerRel.nCountry
.head 4 -  Set dfReg      = cCustomerRel.sRegion
.head 4 -  Set dfAdr      = cCustomerRel.sAdr
.head 4 -  Set dfTel      = cCustomerRel.sTel
.head 4 -  Set dfEMail    = cCustomerRel.sEMail
.head 4 -  Set dfVed      = cCustomerRel.sVed
.head 4 -  Set dfSed      = cCustomerRel.sSed
.head 4 -  Set dfIse      = cCustomerRel.sIse
.head 4 -  Set dfComm     = cCustomerRel.sNotes
.head 4 -  Set dfDocSer   = cCustomerRel.sDocSerial
.head 4 -  Set dfDocNum   = cCustomerRel.sDocNumber
.head 4 -  Set dfDocDate  = cCustomerRel.dDocDate
.head 4 -  Set dfDocIssue = cCustomerRel.sDocIssuer
.head 4 -  Set dfBDay     = cCustomerRel.dBirthday
.head 4 -  Set dfBPlace   = cCustomerRel.sBirthplace
.head 4 +  If cCustomerRel.nCusttype = 1
.head 5 -  Call SalDisableWindow(cmbDoc)
.head 5 -  Call SalDisableWindow(dfDocSer)
.head 5 -  Call SalDisableWindow(dfDocNum)
.head 5 -  Call SalDisableWindow(dfDocDate)
.head 5 -  Call SalDisableWindow(dfDocIssue)
.head 5 -  Call SalDisableWindow(dfBDay)
.head 5 -  Call SalDisableWindow(dfBPlace)
.head 5 -  Call SalDisableWindow(cmbSex)
.head 4 -  Call SalSetFocus(dfNmk)
.head 1 -  ! ------!
.head 1 -  ! Счета !
.head 1 -  ! ------!
.head 1 +  Table Window: tbl_AccountsList
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Счета Банка
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.02"
.head 4 -  Top:    0.517"
.head 4 -  Width:  17.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.719"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: 1
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 5000
.head 3 -  Discardable? No
.head 2 -  Description: Многорежимный реестр счетов
.head 2 +  Named Menus
.head 3 +  Menu: menuAccounts
.head 4 -  Resource Id: 16401
.head 4 -  Title: Счета
.head 4 -  Description: Подменю счетов
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Popup Menu: &Таблица
.head 5 -  Resource Id: 16402
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: &Фильтр...
.head 6 -  Resource Id: 16403
.head 6 -  Keyboard Accelerator: Ctrl+S
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg( pbFilter, SAM_Click, 0, 0 )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Печать...
.head 6 -  Resource Id: 16404
.head 6 -  Keyboard Accelerator: Ctrl+P
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: FALSE
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg( hWndForm, UM_Print, 0, 0 )
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: Вы&брать значение из справочника
.head 6 -  Resource Id: 16405
.head 6 -  Keyboard Accelerator: F6
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: fNSIEdit
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg( pbGetValueFromNSI, SAM_Click, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Сохранить изменения
.head 6 -  Resource Id: 16406
.head 6 -  Keyboard Accelerator: F2
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: NOT (nCtrlFlags & AVIEW_ReadOnly)
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg( pbUpdateAttribute, SAM_Click, 0, 0 )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Пе&речитать
.head 6 -  Resource Id: 16407
.head 6 -  Keyboard Accelerator: Ctrl+R
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: Показать и&тоги по валютам
.head 6 -  Resource Id: 16408
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: nCtrlFlags & AVIEW_Financial
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg( pbCcySummary, SAM_Click, 0, 0 )
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: В&ыход
.head 6 -  Resource Id: 16409
.head 6 -  Keyboard Accelerator: F10
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 6 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Popup Menu: &Вид
.head 5 -  Resource Id: 16410
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: &Финансовые показатели
.head 6 -  Resource Id: 16411
.head 6 -  Keyboard Accelerator: Shift+F1
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: nCtrlFlags & AVIEW_Financial
.head 7 -  Checked when: cTblOptions.bFinance
.head 6 +  Menu Actions
.head 7 -  Set cTblOptions.bFinance = NOT cTblOptions.bFinance
.head 7 -  ! Set obFinancial = NOT obFinancial
.head 7 -  Call ShowColumnByOptions(  )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Лимиты
.head 6 -  Resource Id: 16412
.head 6 -  Keyboard Accelerator: Shift+F2
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: nCtrlFlags & AVIEW_Limit
.head 7 -  Checked when: cTblOptions.bLimits
.head 6 +  Menu Actions
.head 7 -  Set cTblOptions.bLimits = NOT cTblOptions.bLimits
.head 7 -  ! Set obLimits = NOT obLimits
.head 7 -  Call ShowColumnByOptions(  )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Спе&цпараметры
.head 6 -  Resource Id: 16413
.head 6 -  Keyboard Accelerator: Shift+F3
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: nCtrlFlags & AVIEW_Special
.head 7 -  Checked when: cTblOptions.bSpecial
.head 6 +  Menu Actions
.head 7 -  Set cTblOptions.bSpecial = NOT cTblOptions.bSpecial
.head 7 -  ! Set obSpecial = NOT obSpecial
.head 7 -  Call ShowColumnByOptions(  )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Связанные счета
.head 6 -  Resource Id: 16414
.head 6 -  Keyboard Accelerator: Shift+F4
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when: nCtrlFlags & AVIEW_Linked
.head 7 -  Checked when: cTblOptions.bLinkAcc
.head 6 +  Menu Actions
.head 7 -  Set cTblOptions.bLinkAcc = NOT cTblOptions.bLinkAcc
.head 7 -  ! Set obLinks = NOT obLinks
.head 7 -  Call ShowColumnByOptions(  )
.head 6 -  Menu Item Name:
.head 5 +  ! Menu Item: Информация о &доступе
.head 6 -  Keyboard Accelerator: Shift+F5
.head 6 -  Status Text: 
.head 6 +  Menu Settings 
.head 7 -  Enabled when: (nCtrlFlags & AVIEW_Access AND nAccType != AVIEW_USER)
.head 7 -  Checked when: fAccess
.head 6 +  Menu Actions 
.head 7 -  Set fAccess = NOT fAccess
.head 7 -  Set obAccess = NOT obAccess
.head 7 -  Call CastControlFlags(  )
.head 6 -  Menu Item Name: 
.head 5 +  Menu Item: &Блокировки
.head 6 -  Resource Id: 16416
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 -  Menu Actions
.head 6 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Открыть счет...
.head 5 -  Resource Id: 16417
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & AVIEW_ExistOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbOpenAccount, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Атрибуты счета...
.head 5 -  Resource Id: 16418
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbEditAccount, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Закрыть счет
.head 5 -  Resource Id: 16419
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & AVIEW_ExistOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbCloseAccount, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Реанимировать счет
.head 5 -  Resource Id: 16420
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & AVIEW_ExistOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbResurectAccount, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Перерегистрировать счет
.head 5 -  Resource Id: 50773
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: NOT (nCtrlFlags & AVIEW_ExistOnly)
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbDeregAccount, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Документы по счету ВНУТРЕННИЕ и НАЧ.МЕЖБАНК
.head 5 -  Resource Id: 16421
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbOutboundDocs, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Документы по счету &ОТВ.МЕЖБАНК
.head 5 -  Resource Id: 16422
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbInboundDocs, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Документы по технологическому счету...
.head 5 -  Resource Id: 16423
.head 5 -  Keyboard Accelerator: Ctrl+O
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: nAccType = AVIEW_TECH
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( pbDocProcessingAcc, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Дви&жения по счету
.head 5 -  Resource Id: 16424
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbTurnForAccounts, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &История счета
.head 5 -  Resource Id: 16425
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(pbAccHistory, SAM_Click, 0, 0)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  Line
.head 5 -  Resource Id: 16426
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  11.05"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  11.05"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbOpenAccount	! Открыть счет
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Открыть счет
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipOpenAccount')
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen()
.head 8 +  If OperWithAccountNN(nAccType, 0, nRnkPar, nChildAccessType, hWndForm, sFilterOnTab, bNN)
.head 9 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 7 +  Else
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  ! Банковский День ЗАКРЫТ!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTBankDayClose'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 4 +  Pushbutton: pbEditAccount	! Просмотр/редактирование атрибутов счета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр/редактирование атрибутов счета
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipEditAccount')
.head 6 +  ! On SAM_Click
.head 7 +  If colACC
.head 8 -  ! только %%
.head 8 +  If sFilterOnTab = '0000100' OR sFilterOnTab = '0000200'
.head 9 -  Call SetProcParN(colACC, IifN(Subs(sFilterOnTab,5,1)='1', ACCESS_READONLY, nCtrlFlags), '', '')
.head 8 +  Else 
.head 9 +  If OperWithAccountNN(nAccType, colACC, nRnkPar, nChildAccessType, hWndForm, sFilterOnTab, bNN)
.head 10 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 6 +  On SAM_Click
.head 7 +  If colACC
.head 8 -  ! только %%
.head 8 +  ! If sFilterOnTab = '0000100' OR sFilterOnTab = '0000200'
.head 9 -  Call SetProcParN(colACC, IifN(Subs(sFilterOnTab,5,1)='1', ACCESS_READONLY, nCtrlFlags), '', '')
.head 8 -  ! Else
.head 8 +  If OperWithAccountNN(nAccType, colACC, nRnkPar, nChildAccessType, hWndForm, sFilterOnTab, bNN)
.head 9 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbCloseAccount	! Закрыть счет
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Закрыть счет
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipCloseAccount')
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen() !! CloseAccount
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblFetchRow(hWndForm, nRow)
.head 9 -  Call CloseAccount(colACC)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbResurectAccount	! "Реанимировать" счет
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.367"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chekin.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Реанимировать" счет
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipResurectAccount')
.head 6 +  On SAM_Click
.head 7 -  ! Вы уверены, что хотите ВОССТАНОВИТЬ отмеченные счета?
  Эта операция применима только для счетов закрытых ТЕКУЩЕЙ банковской датой.
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgResurect1') || PutCrLf() ||
   IifS(bNBUBank=TRUE,'',CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgResurect2')),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Set nRow = TBL_MinRow
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 9 -  Call SalTblFetchRow(hWndForm, nRow)
.head 9 -  Set nDlgRet = IDYES
.head 9 -  ! K014 - Тип клієнта: 1-ЮО, 2-ФО-СПД, 3-ФО, 4-Банк, 5-Наш Банк
.head 9 +  If NOT SqlPrepareAndExecute(hSql(), 
"SELECT c.rnk, c.nmk, c.date_off,
        decode(c.okpo,f_ourokpo,5,decode(c.custtype,1,4,2,1,decode(nvl(trim(c.sed),'00'),'91',2,3)))
   INTO :nRNK, :sNMK, :dDAT, :nK014
   FROM customer c, cust_acc b 
  WHERE c.rnk=b.rnk AND b.acc=:colACC") 
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Break
.head 9 +  If dDAT != DATETIME_Null
.head 10 -  ! Счет colNLS (colKV) не может быть восстановлен, так как закрыт контрагент nRNK sNMK
.head 10 -  Set nDlgRet = SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' ' || 
    colNLS || ' (' || SalNumberToStrX(colKV, 0) || ') ' || 
    CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotResurect')  || ' ' ||
    CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotResurect1') || Str(nRNK) || ' ' || sNMK,
    CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_OkCancel)
.head 10 -  Break
.head 9 +  If bNBUBank or bKazna
.head 10 +  If SalIsNull(colDAZS) OR colDAZS > GetBankDate()
.head 11 -  Call SalMessageBeep(MB_IconStop)
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  ! Счет colNLS (colKV) не может быть восстановлен, так как не был закрыт вообще или дата закрытия больше текущей.
.head 11 -  Set nDlgRet = SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' ' || 
    colNLS || ' (' || SalNumberToStrX(colKV, 0) || ') ' || 
    CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotResurect') || ' ' ||
    CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotResurect2'), 
    CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_OkCancel)
.head 11 +  If nDlgRet = IDCANCEL
.head 12 -  Break
.head 11 -  Call SalWaitCursor(TRUE)
.head 9 +  Else
.head 10 +  If SalIsNull(colDAZS) OR colDAZS != GetBankDate()
.head 11 -  Call SalMessageBeep(MB_IconStop)
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  ! Счет colNLS (colKV) не может быть восстановлен, так как не был закрыт вообще или закрыт не сегодня.
.head 11 -  Set nDlgRet = SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' ' || 
    colNLS || ' (' || SalNumberToStrX(colKV, 0) || ') ' || 
    CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotResurect') || ' ' ||
    CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotResurect3'),
    CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_OkCancel)
.head 11 +  If nDlgRet = IDCANCEL
.head 12 -  Break
.head 11 -  Call SalWaitCursor(TRUE)
.head 9 +  If nDlgRet = IDYES
.head 10 +  If bPAR_ACCRESERVE and Subs(colNLS, 1, 1) = '2' and (nK014 = 1 or nK014 = 2)  
.head 11 -  Call SqlPrepareAndExecute(hSql(),  "select substr(value,1,254) into :l_reserved from accountsw where acc = :colACC and tag = 'RESERVED'")
.head 11 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 11 +  If l_reserved = '1'
.head 12 -  Call SalMessageBox("Рахунок " || colNLS || "(" || colISO || ") зарезервовано, неможливо реанімувати", CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 12 -  Break
.head 10 +  If ResurectAccounts(colACC)
.head 11 -  ! Восстановлен счет colNLS (colKV) [Пользователь GetUserId()/GetUserLoginName()]
.head 11 -  Call SaveInfoToLog( 'ACCOUNTS. ' || CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccResurect') || ' ' || 
     colNLS || ' (' || SalNumberToStrX(colKV, 0) || ')' || ' [' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgUser') || ' ' || Str(GetUserId()) || '/' || GetUserLoginName() || ']' )
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDeregAccount	! Перерегистрировать счет на другого клиента
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.8"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BACK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перерегистрировать счет на другого клиента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipDeregAccount')
.head 6 +  On SAM_Click
.head 7 -  ! Вы уверены, что хотите ПЕРЕРЕГИСТРИРОВАТЬ отмеченные счета на другого контрагента?
  Эта операция применима только для счетов, открытых ТЕКУЩЕЙ банковской датой.
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgDereg1') || PutCrLf() ||
   CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgDereg2'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
.head 8 +  If FunNSIGetFiltered('CUSTOMER', '', 'date_off is null AND rnk<>'||Str(nRNK), s1, s2)
.head 9 -  Set nRow = TBL_MinRow
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 10 -  Call SalTblFetchRow(hWndForm, nRow)
.head 10 +  If colDAOS = GetBankDate()
.head 11 +  If DeregAccounts(Val(s1), colACC)
.head 12 -  ! Перерегистрирован счет colNLS (colKV), РНК nAccKey на клиента s1 sNMK [Пользователь GetUserId()/GetUserLoginName()]
.head 12 -  Call SaveInfoToLog( 'ACCOUNTS. ' ||
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccDereg1') || ' ' || colNLS || ' (' || SalNumberToStrX(colKV, 0) || '), ' || 
     CurrentLangTable.GetAtomTitle('cTMsgRnk') || ' ' || Str(nRnkPar) || ', ' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccDereg2') || ' ' || s1 || ' [' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgUser') || ' ' || Str(GetUserId()) || '/' || GetUserLoginName() || ']' )
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbRePopulate	! Перечитать таблицу
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.333"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перечитать таблицу
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipPopulate')
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbGetValueFromNSI	! Выбрать значение из справочника
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.767"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выбрать значение из справочника
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipGetValueFromNSI')
.head 6 +  On UM_ObjActivate
.head 7 -  Call SalEnableWindow(hWndItem)
.head 7 -  Set hWndNeedNSI = SalNumberToWindowHandle(wParam)
.head 7 -  Set fNSIEdit = TRUE
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndNeedNSI, UM_Populate, 0, 0)
.head 6 +  On UM_ObjDeactivate
.head 7 +  If SalNumberToWindowHandle(wParam) != hWndItem
.head 8 -  Call SalDisableWindow(hWndItem)
.head 8 -  Set fNSIEdit = FALSE
.head 4 +  Pushbutton: pbUpdateAttribute	! Сохранить изменения
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить изменения
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipUpdateAttribute')
.head 6 +  On SAM_Click
.head 7 -  Call ApplyEdits()
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbFilter		! Установить фильтр просмотра
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.733"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Установить фильтр просмотра
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipFilter')
.head 6 +  On SAM_Click
.head 7 +  If SetQueryDFilterEx(AccF)
.head 8 -  Call SalPostMsg(hWndForm,  UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDocProcessingAcc	! Показать подокументный состав процессингового счета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docs.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать подокументный состав процессингового счета
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipDocProcessingAcc')
.head 7 +  If nAccType !=  AVIEW_TECH
.head 8 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_Click
.head 7 -  Call Sel000(hWndMDI, 9, colACC, "", "")
.head 4 +  Pushbutton: pbPrint		! Печать
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.167"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 -  Call SalPostMsg(hWndForm, UM_Print, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 16427
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  8.4"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  8.4"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbOutboundDocs	! Документы по счету ОТВЕТНЫЙ СЭП
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.167"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Документы по счету ОТВЕТНЫЙ СЭП
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipOutboundDocs')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Set sTmp= "a.ref in
(SELECT ref
 FROM opldok
 WHERE tt in ('R01','D01') and
       acc="||Str(colACC)||" AND
       fdat= "||DateInQuery( GetBankDateEx())||"
 )"
.head 8 -  ! Межбанковские поступления за GetBankDate()
.head 8 -  Call DocViewList( hWndMDI,  sTmp,
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTDocMB') || ' ' ||
     SalFmtFormatDateTime( GetBankDate(), ddMMyyyy( ) ))
.head 4 +  Pushbutton: pbInboundDocs	! Документы по счету ВНУТРЕННИЕ и НАЧАЛЬНЫЙ МЕЖБАНК
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Документы по счету ВНУТРЕННИЕ и НАЧАЛЬНЫЙ МЕЖБАНК
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipInboundDocs')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Set sTmp= "a.ref in
(SELECT ref
 FROM opldok
 WHERE tt not in ('R01','D01') and
       acc="||Str(colACC)||" AND
       fdat= "||DateInQuery( GetBankDateEx())||"
 )"
.head 8 -  ! Документы Внутр. и Нач.Межбанковские colNLS за GetBankDate()
.head 8 -  Call DocViewListInt(hWndMDI, sTmp,
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTDocInt') || " " || colNLS || " " || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTOn') || " " || SalFmtFormatDateTime(GetBankDate(), "dd/MM/yyyy"))
.head 4 +  Pushbutton: pbTurnAll		! Обороты за период дат
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.15"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CALS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Обороты за период дат
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipTurnAll')
.head 6 +  On SAM_Click
.head 7 +  If SalModalDialog(dlg_SetDat,hWndForm,dDat1,dDat2)
.head 8 -  ! Инициализация строки населения
.head 8 -  Call PrepareSelectString()
.head 8 +  If dDat1 = dBDate AND dDat2 = dBDate
.head 9 -  Call SalSetWindowText(hWndForm, sTitle)
.head 9 -  Call SalTblSetColumnTitle(colIS,    sTitleIS)
.head 9 -  Call SalTblSetColumnTitle(colISq,   sTitleISq)
.head 9 -  Call SalTblSetColumnTitle(colIS_D,  sTitleIS_D)
.head 9 -  Call SalTblSetColumnTitle(colIS_Dq, sTitleIS_Dq)
.head 9 -  Call SalTblSetColumnTitle(colIS_K,  sTitleIS_K)
.head 9 -  Call SalTblSetColumnTitle(colIS_Kq, sTitleIS_Kq)
.head 9 -  Call SalTblSetColumnTitle(colOSTC,    sTitleOSTC)
.head 9 -  Call SalTblSetColumnTitle(colOSTCq,   sTitleOSTCq)
.head 9 -  Call SalTblSetColumnTitle(colOSTC_D,  sTitleOSTC_D)
.head 9 -  Call SalTblSetColumnTitle(colOSTC_Dq, sTitleOSTC_Dq)
.head 9 -  Call SalTblSetColumnTitle(colOSTC_K,  sTitleOSTC_K)
.head 9 -  Call SalTblSetColumnTitle(colOSTC_Kq, sTitleOSTC_Kq)
.head 8 +  Else
.head 9 -  Call SalSetWindowText(hWndForm, sTitle || ' [' || 
     SalFmtFormatDateTime(dDat1, 'dd/MM/yyyy') || ' - ' || 
     SalFmtFormatDateTime(dDat2, 'dd/MM/yyyy') || ']')
.head 9 -  Set sTmp = SalFmtFormatDateTime(dDat1, 'dd/MM/yyyy')
.head 9 -  Call SalTblSetColumnTitle(colIS,    sTitleIS    || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colISq,   sTitleISq   || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colIS_D,  sTitleIS_D  || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colIS_Dq, sTitleIS_Dq || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colIS_K,  sTitleIS_K  || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colIS_Kq, sTitleIS_Kq || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Set sTmp = SalFmtFormatDateTime(dDat2, 'dd/MM/yyyy')
.head 9 -  Call SalTblSetColumnTitle(colOSTC,    sTitleOSTC    || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colOSTCq,   sTitleOSTCq   || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colOSTC_D,  sTitleOSTC_D  || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colOSTC_Dq, sTitleOSTC_Dq || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colOSTC_K,  sTitleOSTC_K  || PutCrLf() || '(' || sTmp || ')')
.head 9 -  Call SalTblSetColumnTitle(colOSTC_Kq, sTitleOSTC_Kq || PutCrLf() || '(' || sTmp || ')')
.head 8 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbTurnForAccounts	! Обороты по счету
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_turn.bmp
.head 5 -  Picture Transparent Color: Dark Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Обороты по счету
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipTurnForAccounts')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call ShowTurnForAccount(colACC, GetBankDateEx())
.head 4 +  Pushbutton: pbAccHistory	! История счета...
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.017"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Books.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! История счета...
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipAccHistory')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 +  If colACC
.head 9 -  Call Show_Sal_Day_P(colACC, STRING_Null, NUMBER_Null, IifD(dDat1=dBDate,DATETIME_Null,dDat1), dDat2)
.head 8 +  Else
.head 9 -  Call Show_Sal_DayHist(colACC , colNLS, colKV)  ! (Mik-hist)
.head 4 +  Pushbutton: pb_Mode_Int
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_PROC.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Моделирование начисленных % по АКТ (ид=0)'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 +  If colACC
.head 9 -  Call SalCreateWindow(HLP, hWndMDI, colACC)
.head 4 +  Pushbutton: pbAccParHistory	! История изменения параметров счета...
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOKS1.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! История изменения параметров счета...
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipAccParHistory')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 +  If colACC
.head 9 -  Call ShowParHistory(hWndMDI, 1, colACC, '', '')
.head 4 +  Pushbutton: pbLinkedAccounts	! Показать связанные счета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.323"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Linked.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Показать связанные счета
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipLinkedAccounts')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call ShowLNKAccounts(colACC)
.head 4 +  Pushbutton: pbCcySummary	! Итоги по валютам...
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.917"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Summ.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Итоги по валютам...
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipCcySummary')
.head 6 +  On SAM_Click
.head 7 +  If IsWindow(hWndCcy)
.head 8 -  Call SalDestroyWindow(hWndCcy)
.head 7 -  Set hWndCcy = SalCreateWindow(tbl_CcySummarise, hWndMDI, nAccType, 
    sAccMFilter || IifS(DopFiltr != '', ' AND ' || DopFiltr, '') || IifS(sAccClsFilter != '', sAccClsFilter, ''), 
    AccF, dDat1, dDat2)
.head 4 -  Line
.head 5 -  Resource Id: 16428
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  9.883"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  9.883"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit		! Завершить работу
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.983"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Завершить работу
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbF5		! По DoubleClick - показать карточку счета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! По DoubleClick - показать карточку счета
.head 7 +  If SalIsWindowEnabled(pbEditAccount)
.head 8 -  Call SalPostMsg(pbEditAccount, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbF6		! По DoubleClick - показать историю счета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.35"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F6
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! По DoubleClick - показать историю счета
.head 7 +  If SalIsWindowEnabled(pbAccHistory)
.head 8 -  Call SalPostMsg(pbAccHistory, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbSort		! Сортировать счета без учета КР
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.35"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.443"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Sort.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сортировать счета без учета КР
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipSort')
.head 7 -  Set bOrd = TRUE
.head 6 +  On SAM_Click
.head 7 -  Set sAccOrd = ' ORDER BY substr(a.nls,1,4)||substr(a.nls,6,length(a.nls)-5) '
.head 7 +  If NOT bOrd
.head 8 -  Set sAccOrd = sAccOrd || ' desc '
.head 7 -  Set bOrd = NOT bOrd
.head 7 -  Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 -  ! Background Text: Счетов всего
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.583"
.head 6 -  Top:    0.167"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.end
.head 4 +  Data Field: bgAccCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfAccCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.15"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'All Acc (Счетов всего)')
.head 4 +  Pushbutton: pbCustCard	! Карточка клиента ! Кнопку показываем только для Сбербанка
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CUSTPERS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Карточка клиента'
.head 7 -  ! Карточку клиента показываем только для Сбербанк-мультимфо или если установлен флаг
.head 7 +  If PAR_BANKTYPE = 'SBER' and bACC_OB22
or nCtrlFlags & AVIEW_CustCard
.head 8 -  Call SalGetWindowLoc(pbExit, nX1, nY1)
.head 8 -  Call SalGetWindowLoc(pbCustCard, nX2, nY2)
.head 8 -  Call SalSetWindowLoc(pbExit, nX2, nY2)
.head 8 -  Call SalSetWindowLoc(pbCustCard, nX1, nY1)
.head 7 +  Else
.head 8 -  Call SalHideWindow(pbCustCard)
.head 6 +  On SAM_Click
.head 7 +  If colACC
.head 8 +  If SqlPrepareAndExecute(hSql(),
"select canilookclient(:colRNK) into :nFlag
   from dual")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If nFlag=0
.head 9 -  Call SalMessageBox('Вам заборонено переглядати картку даного клієнта RNK=' || Str(colRNK) || '!', 'Увага!', MB_IconStop | MB_Ok)
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql(),
"select c.rnk, c.custtype into :nRnk, :nCusttype
   from customer c, accounts a
  where a.acc = :colACC and a.rnk = c.rnk")
.head 9 +  If SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Select Case nCusttype
.head 11 +  Case 1
.head 12 -  Call EditCustBanksEx(nRnk, IifN(nCtrlFlags & AVIEW_ReadOnly, CVIEW_ReadOnly | AVIEW_ReadOnly,  AVIEW_ReadOnly), hWndForm, 0, '', 0)
.head 12 -  Break
.head 11 +  Case 2
.head 12 -  Call EditCustCorpsEx(nRnk, IifN(nCtrlFlags & AVIEW_ReadOnly, CVIEW_ReadOnly | AVIEW_ReadOnly,  AVIEW_ReadOnly), hWndForm, 0, '', FALSE)
.head 12 -  Break
.head 11 +  Case 3
.head 12 -  Call EditCustPersonEx(nRnk, IifN(nCtrlFlags & AVIEW_ReadOnly, CVIEW_ReadOnly | AVIEW_ReadOnly,  AVIEW_ReadOnly), hWndForm, 0, '', FALSE)
.head 12 -  Break
.head 11 +  Default
.head 12 -  Break
.head 4 +  Pushbutton: pbSearchNls	! F3 - Вызвать фильтр по счету
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CUSTPERS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalModalDialog(dlgFindNls, hWndForm, sFindNls)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set nFocusRow = SalTblQueryContext(hWndForm)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nFocusRow, ROW_Selected, FALSE)
.head 8 -  Set nFindNlsRow = -1
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 9 -  Call SalTblSetContext(hWndForm, nRow)
.head 9 +  If colNLS = sFindNls
.head 10 -  Set nFindNlsRow = nRow
.head 10 -  Break
.head 8 +  If nFindNlsRow >= 0
.head 9 -  Call SalTblSetFocusRow(hWndForm, nFindNlsRow)
.head 9 -  Call SalTblSetContext(hWndForm, nFindNlsRow)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nFindNlsRow, ROW_Selected, TRUE)
.head 8 +  Else
.head 9 -  Call SalTblSetContext(hWndForm, nFocusRow)
.head 8 -  Call SalWaitCursor(FALSE)
.head 2 +  Contents
.head 3 -  ! в f-столбцах суммы с правильным количеством знаков после запятой
 (по ним сортируются строковые столбцы)
.head 3 -  ! основные атрибуты счета, которые присутсвуют всегда
.head 3 +  Column: colACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Внутренний
   номер
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код безбал.
отделения
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranchTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
подразделения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Account
number
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If GetAccountStructure( nTmp,nTmp,nTmp,nTmp ) ! Прижимать влево или вправо
.head 7 -  Call SalTblSetColumnFlags( hWndItem, COL_RightJustify, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpNls = colNLS
.head 5 +  On SAM_AnyEdit
.head 6 -  Set colNLS = sTmpNls
.head 6 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 3 +  Column: colNLSALT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Alternative
account
number
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 9
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CCy
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Curr
ency
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Account title
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCUSTNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Customer
Name
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! финансовые показатели счета
.head 3 +  Column: colISf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance

.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
(Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_Df
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
D
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_Dqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
D (Eqv)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
D
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_Dq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
D (Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_Kf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
K
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_Kqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
K (Eqv)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
K
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIS_Kq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Starting
balance
K (Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOSf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Debet
payments
amount
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.511"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOSqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Debet
payments
amount
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.511"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Debet
payments
amount
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOSq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Debet
payments
amount
(Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOSf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Credit
payments
amount
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.511"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOSqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Credit
payments
amount
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.511"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Credit
payments
amount
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOSq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Credit
payments
amount
(Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.489"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.489"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
(Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_Df
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
D
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_Dqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
D (Eqv
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
D
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_Dq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
D (Eqv
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_Kf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
K
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_Kqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
K (Eqv
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
K
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTC_Kq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cleared
balance
K (Eqv
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTBf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTBqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTBq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
(Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_Df
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
D
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_Dqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
D (Eqv
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
D
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_Dq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
D (Eqv
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_Kf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
K
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_Kqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
K (Eqv
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
K
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTB_Kq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Booked
balance
K (Eqv
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTFf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTFqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTFq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
(Eqv))
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_Df
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
D
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_Dqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
D (Eqv)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
D
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_Dq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
D (Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_Kf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
K
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_Kqf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
K (Eqv)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
K
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTF_Kq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Future
balance
K (Eqv)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Decimal
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAPP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Last
payment
date
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! проценты
.head 3 +  Column: colRATf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Interest
Rate
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 4 -  ! List Values 
.head 4 -  ! Message Actions 
.head 3 +  Column: colRAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Interest
Rate
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Unformatted
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Muturity
Date
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! лимиты счета
.head 3 +  Column: colLIMf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Overdraft
limit
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLIM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Overdraft
limit
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  ! Set colLIMc = SalStrToNumber( colLIM  ) * SalNumberPower( 10, colDig ) 
.head 6 -  Set colLIMf = SalStrToNumber(colLIM)
.head 6 -  Set colLIM  = Dig4(colLIMf*SalNumberPower(10,colDig)/100, colDig, nMaxDig )
.head 3 -  !
.head 3 +  Column: colNBS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Memo
group
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Act
Pas
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTIP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Type
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.686"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! связанные счета
.head 3 +  Column: colACCC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Внутренний
номер св-го счета
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Consolidation
account
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If MyValue != STRING_Null
.head 7 +  If colKVC != NUMBER_Null 
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"SELECT acc INTO :colACCC FROM accounts 
  WHERE nls=:colNLSC and kv=:colKVC") 
or NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBeep(MB_IconStop)
.head 9 -  ! Счет № colNLSC(colISOC) не открыт!
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' № ' || colNLSC || '('|| colISOC || ') ' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotOpen') || '!', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop|MB_Ok)
.head 9 -  Set colACCC = NUMBER_Null
.head 9 -  Set colNLSC = STRING_Null
.head 9 -  Set colNMSC = STRING_Null
.head 9 -  Set colKVC  = NUMBER_Null
.head 9 -  Set colISOC = STRING_Null
.head 9 -  Return VALIDATE_Cancel
.head 7 +  If NOT SqlPrepareAndExecute(hSql(), 
"SELECT a.acc, a.nms, a.kv, t.lcv 
   INTO :colACCC, :colNMSC, :colKVC, :colISOC 
   FROM accounts a, tabval t 
  WHERE a.nls = :colNLSC AND a.kv=:colKV AND a.kv=t.kv")
.head 8 -  Set colACCC = NUMBER_Null
.head 8 -  Set colNMSC = STRING_Null
.head 8 -  Set colKVC  = NUMBER_Null
.head 8 -  Set colISOC = STRING_Null
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  Set colACCC = NUMBER_Null
.head 7 -  Set colNMSC = STRING_Null
.head 7 -  Set colKVC  = NUMBER_Null
.head 7 -  Set colISOC = STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colKVC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: валюта консолид.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISOC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.
конс.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If MyValue != STRING_Null
.head 7 +  If NOT SqlPrepareAndExecute(hSql(), "SELECT kv INTO :colKVC FROM tabval t WHERE lcv=:colISOC") 
or NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  ! Счет № colNLSC(colISOC) не открыт!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' № ' || colNLSC || '('|| colISOC || ') ' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotOpen') || '!', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop|MB_Ok)
.head 8 -  Set colACCC = NUMBER_Null
.head 8 -  Set colNMSC = STRING_Null
.head 8 -  Set colKVC  = NUMBER_Null
.head 8 -  Set colISOC = STRING_Null
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If colNLSC != STRING_Null
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"SELECT acc, nms INTO :colACCC, :colNMSC 
   FROM accounts 
  WHERE nls = :colNLSC AND kv=:colKVC " ) 
or NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalMessageBeep ( MB_IconStop )
.head 9 -  ! Счет № colNLSC(colISOC) не открыт!
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' № ' || colNLSC || '('|| colISOC || ') ' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccNotOpen') || '!', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop|MB_Ok)
.head 9 -  Set colACCC = NUMBER_Null
.head 9 -  Set colNMSC = STRING_Null
.head 9 -  Set colKVC  = NUMBER_Null
.head 9 -  Set colISOC = STRING_Null
.head 9 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set colACCC = NUMBER_Null
.head 7 -  Set colNMSC = STRING_Null
.head 7 -  Set colKVC  = NUMBER_Null
.head 7 -  Set colISOC = STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colNMSC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Consolidation account
title
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! спецпараметры, дата погашения, вид счета
.head 3 +  Column: colVID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sort of
account
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOB22
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОБ22
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colR011
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: R011
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colR013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: R013
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S080
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS180
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S180
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS190
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S190
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS200
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S200
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS230
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S230
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS240
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S240
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS260
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S260
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS270
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S270
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! организация доступа к счету, блокировки
.head 3 +  Column: colOWN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Teller
ID
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 5
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.771"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmpIsp = colOWN
.head 6 -  Set nWndNeedNSI = SalWindowHandleToNumber( colOWN )
.head 6 -  Call SalPostMsg(pbGetValueFromNSI, UM_ObjActivate, nWndNeedNSI, 0)
.head 5 +  On UM_Populate
.head 6 +  If FunNSIGetFiltered('STAFF', 'FIO', 'type=1', strKeyVal, strSemVal)
.head 7 -  Set colOWN = SalStrToNumber(strKeyVal)
.head 7 -  Set colONAME = strSemVal
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Set colOWN=nTmpIsp
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SalIsValidNumber(hWndItem)
.head 7 -  Set colOWN=nTmpIsp
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SqlPrepareAndExecute(hSql(), '
  SELECT fio INTO :colONAME FROM staff WHERE id=:colOWN and type=1') 
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Call SalMessageBox( 'Пользователь с ID='||Str(colOWN)||' не является ответ.исполнителем!', 'Ошибка!', MB_OK )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgUser') || ' ID='||Str(colOWN)||' ' || 
  CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgUserIsp') || '!', 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK )
.head 7 -  Set colOWN=NUMBER_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalPostMsg( pbGetValueFromNSI, UM_ObjDeactivate, wParam, 0)
.head 3 +  Column: colONAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Teller Name
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBDCODE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
блок
Деб
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBLKD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Blocking Level
(Debet)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.986"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate(hWndItem, hSql(), 'SELECT name FROM rang')
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute(hSql(), 'SELECT rang FROM rang INTO :colBDCODE WHERE name = :colBLKD')
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Column: colBKCODE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
блок.
Кр.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBLKK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Blocking Level
(Credit)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.071"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate(hWndItem, hSql(), 'SELECT name FROM rang')
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute(hSql(), 'SELECT rang FROM rang INTO :colBKCODE WHERE name = :colBLKK')
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Column: colDAOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Opened
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAZS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Closed
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.086"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РНК
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЕДРПОУ
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: colDig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: dig
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAccCount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SetOstColor
.head 4 -  Description: Покрасить поле остатка в нужный цвет
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOS
.head 5 -  Window Handle: hCol
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 +  If nOS < 0
.head 6 -  Set nInd = COLOR_Red
.head 5 +  Else If nOS > 0
.head 6 -  Set nInd = COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nInd = COLOR_Black
.head 5 -  Call SalTblSetCellTextColor(hCol, nInd, FALSE)
.head 3 +  Function: SetOstDKColor
.head 4 -  Description: Покрасить поле остатка в нужный цвет
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOst
.head 5 -  Window Handle: hCol
.head 5 -  Number: nDK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 +  If nOst < 0 and nDK = 0
.head 6 -  Set nInd = COLOR_Red
.head 5 +  Else If nOst > 0 and nDK = 1
.head 6 -  Set nInd = COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nInd = COLOR_Black
.head 5 -  Call SalTblSetCellTextColor(hCol, nInd, FALSE)
.head 3 -  !
.head 3 +  Function: ResurectAccounts
.head 4 -  Description: Восстановить в правах только что закрытый счет
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call WaitCursorOn()
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), "UPDATE accounts SET dazs=NULL WHERE acc=:nAcc AND dazs IS NOT NULL")
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call WaitCursorOff()
.head 6 -  Return FALSE
.head 5 -  Call SqlCommitEx(hSql(), "Восстановлен счет " || colNLS || "(" || Str(colKV) || ")")
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 3 +  Function: DeregAccounts
.head 4 -  Description: Перерегистрировать счет на другого клиента
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  Number: nAcc
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call WaitCursorOn()
.head 5 +  If NOT SqlPLSQLCommand(hSql(), "accreg.changeAccountOwner(nAcc,nAccOwner,nRnk)")
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call WaitCursorOff()
.head 6 -  Return FALSE
.head 5 +  If SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccDereg1') || ' ' || colNLS || ' (' || SalNumberToStrX(colKV, 0) || '), ' || 
  CurrentLangTable.GetAtomTitle('cTMsgRnk') || ' ' || Str(nRnkPar) || ', ' ||
  CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccDereg2') || ' ' || s1 || '.')
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccDereg1') || ' ' || colNLS || ' (' || SalNumberToStrX(colKV, 0) || '), ' || 
  CurrentLangTable.GetAtomTitle('cTMsgRnk') || ' ' || Str(nRnkPar) || ', ' ||
  CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTMsgAccDereg2') || ' ' || s1 || '.', 
CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 3 +  Function: ApplyEdits
.head 4 -  Description: Сохранить изменения атрибутов в БД
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strUpdate
.head 4 +  Actions
.head 5 -  Set strUpdate = "isp  = :colOWN"
.head 5 +  If cTblOptions.bBlocked
.head 6 -  Set strUpdate = "blkd = :colBDCODE, blkk = :colBKCODE"
.head 5 +  If cTblOptions.bLimits
.head 6 +  If strUpdate != ''
.head 7 -  Set strUpdate = strUpdate || ","
.head 6 -  Set strUpdate = strUpdate || "lim = :colLIMf * power(10,:colDig)"
.head 5 +  If cTblOptions.bLinkAcc
.head 6 +  If strUpdate != ''
.head 7 -  Set strUpdate = strUpdate || ","
.head 6 -  Set strUpdate = strUpdate || "accc = :colACCC"
.head 5 +  If cTblOptions.bSpecial
.head 6 +  If strUpdate != ''
.head 7 -  Set strUpdate = strUpdate || ","
.head 6 -  Set strUpdate = strUpdate || "mdate = :colMDAT"
.head 5 +  If strUpdate != ''
.head 6 -  Set strUpdate = "UPDATE Accounts SET " || strUpdate || " WHERE acc = :colACC"
.head 6 +  If SqlPrepareAndExecute( hSql(), strUpdate )
.head 7 +  If SalTblDoUpdates(hWndForm, hSql(), (NOT cTblOptions.bSpecial))
.head 8 -  ! Изменение реквизитов для счетов...
.head 8 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTAccUpdate'))
.head 5 -  !
.head 5 +  If cTblOptions.bSpecial
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If SqlPrepareAndExecute(hSql(), 'SELECT count(*) INTO :nTmp FROM Specparam WHERE acc=:colACC')
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  !
.head 8 +  If nTmp
.head 9 -  Set strUpdate = 
"UPDATE Specparam 
 SET r011 = :colR011,
     r013 = :colR013,
     s080 = :colS080,
     s180 = :colS180,
     s190 = :colS190,
     s200 = :colS200,
     s230 = :colS230,
     s240 = :colS240,
     s260 = :colS260,
     s270 = :colS270
 WHERE acc = :colACC"
.head 8 +  Else
.head 9 -  Set strUpdate = 
"INSERT INTO Specparam(acc, r011, r013, s080, s180, s190, s200, s230, s240, s260, s270)
 VALUES(:colACC, :colR011, :colR013, :colS080, :colS180, :colS190, :colS200, :colS230, :colS240, :colS260, :colS270)"
.head 8 -  !
.head 8 +  If SqlPrepareAndExecute(hSql(), strUpdate)
.head 9 -  ! Изменение спецпараметров для счета colNLS (colISO)
.head 9 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTSpecUpdate') || " " || colNLS || "(" || colISO || ")" )
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: Fun_SumCol
.head 4 -  Description: Сумирует SELECTED колонку
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 5 -  String: strTitle
.head 5 -  String: strSuma
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Number: nW
.head 5 -  Number: nH
.head 4 +  Actions
.head 5 -  Call GetWindowRect( hWndForm, nX, nY, nW, nH )
.head 5 -  Call SalTblObjectsFromPoint( hWndForm, wParam-nX, lParam-nY, nH, hWndCol, nH )
.head 5 -  Set strTitle=PadR(' ',100  )
.head 5 -  Call SalTblGetColumnTitle ( hWndCol, strTitle, 100 )
.head 5 +  If SalIsValidNumber( hWndCol )
.head 6 -  Set nH=SalTblColumnSum( hWndForm, SalTblQueryColumnID( hWndCol ), ROW_Selected, 0 )
.head 6 +  If nH
.head 7 -  Set strTitle=SalStrTrimX(strTitle)
.head 7 -  Set strSuma=SalStrTrimX(SalFmtFormatNumber ( nH, 'Default' ))
.head 7 -  Set nH = SalNumberMax( SalStrLength( strTitle ), SalStrLength( strSuma ) )
.head 7 -  Call XSalTooltipSetColors( COLOR_Black, COLOR_Yellow )
.head 7 -  Call XSalTooltipShow( hWndForm, strTitle ||PutLf()||PadL(strSuma,nH))
.head 7 -  Call XSalTooltipSetColors( COLOR_Black, COLOR_White )
.head 3 -  !
.head 3 +  Function: PrepareSelectString
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sAccFields  = ''
.head 5 -  Set sAccBinds   = ''
.head 5 -  Set sAccTables  = ''
.head 5 -  Set sAccWhere   = ''
.head 5 -  Set sAccMFilter = ''
.head 5 -  !
.head 5 +  If nAccType = AVIEW_HIST
.head 6 -  Set sAccFields  = ' a.nls, a.nbs, a.kv, t.lcv, a.nms, a.pap, a.tip, a.isp, f.fio, a.daos, a.dazs, a.rnk, c.okpo, t.dig'
.head 6 -  Set sAccBinds   = ' :colNLS, :colNBS, :colKV, :colISO, :colNMS, :nPap, :colTIP, :colOWN, :colONAME, :colDAOS, :colDAZS, :colRNK, :colOKPO, :colDig'
.head 5 +  Else
.head 6 -  Set sAccFields  = 'a.acc, a.nls, a.nbs, a.kv, t.lcv, a.nms, a.nlsalt, a.pap, a.tip, a.isp, f.fio, a.daos, a.dazs, a.rnk, c.okpo, t.dig'
.head 6 -  Set sAccBinds   = ':colACC, :colNLS, :colNBS, :colKV, :colISO, :colNMS, :colNLSALT, :nPap, :colTIP, :colOWN, :colONAME, :colDAOS, :colDAZS, :colRNK, :colOKPO, :colDig'
.head 6 -  !
.head 6 -  Set sAccFields = sAccFields || ', a.blkd, a.blkk'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colBDCODE, :colBKCODE'
.head 6 -  Set nHaveTobo = GetGlobalOptionEx('HAVETOBO')
.head 6 +  If nHaveTobo > 0
.head 7 -  Set sAccFields = sAccFields || ', a.tobo'
.head 7 -  Set sAccBinds  = sAccBinds  || ', :colTOBO'
.head 7 -  Call SalShowWindow(colTOBO)
.head 5 -  !
.head 5 +  If nAccType = AVIEW_HIST
.head 6 -  Set sAccTables = sAccTables || 'a_hist a, Tabval t, Staff f, customer c'
.head 5 +  Else If nAccType = AVIEW_USER 
     OR nAccType = AVIEW_CUST AND GetGlobalOptionEx('ACC_USER') = 1 
     OR nAccType = AVIEW_CUST AND nCtrlFlags & AVIEW_Saldo
.head 6 -  Set sAccTables = sAccTables || 'Saldo a, Tabval t, Staff f, customer c'
.head 5 +  Else
.head 6 -  Set sAccTables = sAccTables || 'Accounts a, Tabval t, Staff f, customer c'
.head 5 -  Set sAccWhere = 'c.rnk=a.rnk AND t.kv=a.kv AND a.isp=f.id (+) ' || IifS(DopFiltr='', '', ' AND ' || DopFiltr)
.head 5 -  !
.head 5 +  If nCtrlFlags & AVIEW_Financial
.head 6 -  ! Берем из accounts
.head 6 +  If dDat1 = dGlobalBankDate and dDat1 = dDat2
.head 7 +  If cTblOptions.bSumEqv
.head 8 -  Set sAccFields = sAccFields || ', 
gl.p_icurval(a.kv, (a.ostc
+decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.dos,0)
-decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.kos,0)), :dDat1)/power(10,:nBaseValDig), 
gl.p_icurval(a.kv, decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.dos,0), :dDat1)/power(10,:nBaseValDig), 
gl.p_icurval(a.kv, decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.kos,0), :dDat1)/power(10,:nBaseValDig), 
gl.p_icurval(a.kv, a.ostc, :dDat1)/power(10,:nBaseValDig), 
gl.p_icurval(a.kv, a.ostb, :dDat1)/power(10,:nBaseValDig), 
gl.p_icurval(a.kv, (a.ostc+a.ostf), :dDat1)/power(10,:nBaseValDig)'
.head 8 -  Set sAccBinds  = sAccBinds  || ', :colISqf, :colDOSqf, :colKOSqf, :colOSTCqf, :colOSTBqf, :colOSTFqf'
.head 7 -  Set sAccFields = sAccFields || ', 
(a.ostc
+decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.dos,0)
-decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.kos,0))/power(10,t.dig), 
decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.dos,0)/power(10,t.dig), 
decode(greatest(a.dapp,nvl(a.dapp,a.dappq)),:dDat1,a.kos,0)/power(10,t.dig), 
a.ostc/power(10,t.dig), 
a.ostb/power(10,t.dig), 
(a.ostc+a.ostf)/power(10,t.dig), 
a.dapp'
.head 6 -  ! Берем из saldoa, чтобы показывать остатки на банк. дату
.head 6 +  Else
.head 7 +  If cTblOptions.bSumEqv
.head 8 -  Set sAccFields = sAccFields || ', 
gl.p_icurval(a.kv, (fost_h(a.acc,:dDat1)+fdos(a.acc,:dDat1,:dDat1)-fkos(a.acc,:dDat1,:dDat1)), :dDat1)/power(10,:nBaseValDig) isq, 
(select nvl(sum(gl.p_icurval(a.kv,dos,fdat)),0) from saldoa where acc=a.acc and fdat between :dDat1 and :dDat2)/power(10,:nBaseValDig) dosq,
(select nvl(sum(gl.p_icurval(a.kv,kos,fdat)),0) from saldoa where acc=a.acc and fdat between :dDat1 and :dDat2)/power(10,:nBaseValDig) kosq,
gl.p_icurval(a.kv, fost_h(a.acc,:dDat2), :dDat2)/power(10,:nBaseValDig) ostcq, 
gl.p_icurval(a.kv, a.ostb, :dDat2)/power(10,:nBaseValDig) ostbq, 
gl.p_icurval(a.kv, (a.ostc+a.ostf), :dDat2)/power(10,:nBaseValDig) ostfq'
.head 8 -  Set sAccBinds  = sAccBinds  || ', :colISqf, :colDOSqf, :colKOSqf, :colOSTCqf, :colOSTBqf, :colOSTFqf'
.head 7 -  Set sAccFields = sAccFields || ', 
(fost_h(a.acc,:dDat1)+fdos(a.acc,:dDat1,:dDat1)-fkos(a.acc,:dDat1,:dDat1))/power(10,t.dig), 
fdos(a.acc,:dDat1,:dDat2)/power(10,t.dig), 
fkos(a.acc,:dDat1,:dDat2)/power(10,t.dig), 
fost_h(a.acc,:dDat2)/power(10,t.dig), 
a.ostb/power(10,t.dig), 
(a.ostc+a.ostf)/power(10,t.dig), 
a.dapp'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colISf, :colDOSf, :colKOSf, :colOSTCf, :colOSTBf, :colOSTFf, :colDAPP'
.head 5 +  If nCtrlFlags & AVIEW_Interest OR nCtrlFlags & AVIEW_Special
.head 6 -  Set sAccFields = sAccFields || ', acrn.fproc(a.acc),a.mdate'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colRATf, :colMDAT'
.head 5 +  If nCtrlFlags & AVIEW_Limit
.head 6 -  Set sAccFields = sAccFields || ', a.lim/power(10,t.dig)'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colLIMf'
.head 5 +  If nCtrlFlags & AVIEW_Linked
.head 6 -  Set sAccFields = sAccFields || ', a.accc, l.nls, l.nms, l.kv, tt.lcv'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colACCC, :colNLSC, :colNMSC, :colKVC, :colISOC'
.head 6 -  Set sAccTables = sAccTables || ', Accounts l, tabval tt'
.head 6 -  Set sAccWhere  = sAccWhere  || ' AND a.accc=l.acc (+) and l.kv=tt.kv(+)'
.head 5 +  If nCtrlFlags & AVIEW_Blocked
.head 6 -  Set sAccFields = sAccFields || ', bd.name, bk.name'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colBLKD, :colBLKK'
.head 6 -  Set sAccTables = sAccTables || ', Rang bk, Rang bd'
.head 6 -  Set sAccWhere  = sAccWhere  || ' AND a.blkd=bd.rang (+) AND a.blkk=bk.rang (+)'
.head 5 +  If nCtrlFlags & AVIEW_Special
.head 6 -  Set sAccFields = sAccFields || ', a.vid, s.r011,s.r013,s.s080,s.s180,s.s190,s.s200,s.s230,s.s240,s.s260,s.s270'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colVID, :colR011, :colR013, :colS080, :colS180, :colS190, :colS200, :colS230, :colS240, :colS260, :colS270'
.head 6 -  Set sAccTables = sAccTables || ', Specparam s'
.head 6 -  Set sAccWhere  = sAccWhere  || ' AND a.acc=s.acc (+)'
.head 5 +  If bACC_OB22
.head 6 -  Set sAccFields = sAccFields || ', a.ob22'
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colOB22'
.head 6 -  ! Set sAccTables = sAccTables || ', Specparam_int si'
.head 6 -  ! Set sAccWhere  = sAccWhere  || ' AND a.acc=si.acc (+)'
.head 5 +  If bACC_BTIP
.head 6 -  Set sAccFields = sAccFields || ", substr(trim(bp.val),1,3)"
.head 6 -  Set sAccBinds  = sAccBinds  || ', :colBranchTip'
.head 6 -  Set sAccTables = sAccTables || ', branch_parameters bp'
.head 6 -  Set sAccWhere  = sAccWhere  || " AND a.branch=bp.branch (+) and bp.tag(+)='TIP'"
.head 5 -  !
.head 5 +  Select Case nAccType
.head 6 +  Case AVIEW_CUST
.head 7 -  ! Показываем счета холдинга
.head 7 +  If nCtrlFlags & CVIEW_Holding
.head 8 -  Set sAccMFilter = sAccMFilter || ' AND a.acc IN ( 
  SELECT b.acc FROM cust_acc b, customer c 
  WHERE c.rnk=b.rnk and (c.rnkp=' || sAccKey || ' or c.rnk='||sAccKey ||' ))'
.head 7 +  Else
.head 8 -  Set sAccMFilter = sAccMFilter || ' AND a.rnk = ' || sAccKey
.head 7 -  Break
.head 6 +  Case AVIEW_TECH
.head 7 -  Set sAccMFilter = sAccMFilter ||
" AND a.tip in ('N99','L99','N00','T00','T0D','TNB','TND','TUR','TUD','L00','N77','902','90D')" ||
" AND a.acc IN (SELECT acc FROM Bank_acc WHERE mfo"
.head 7 -  !
.head 7 +  If nMfoPar != 0
.head 8 -  Set sAccMFilter = sAccMFilter || ' LIKE ' || sAccKey || ')'
.head 7 +  Else ! Так Будет теперь
.head 8 -  Set sAccMFilter = sAccMFilter || ' in (select mfo from lkl_rrp))'
.head 7 -  Break
.head 6 +  Case AVIEW_TAX
.head 7 -  Set sAccFields = sAccFields || ', cu.nmk'
.head 7 -  Set sAccBinds  = sAccBinds  || ', :colCUSTNAME'
.head 7 -  Set sAccTables = sAccTables || ', Customer cu, Cust_Acc ca'
.head 7 -  Set sAccWhere  = sAccWhere  || ' AND ca.acc=a.acc AND ca.rnk=cu.rnk'
.head 7 -  !
.head 7 -  Set sAccMFilter = sAccMFilter || ' AND nls IN (SELECT nls FROM nal_dec WHERE nls IS NOT NULL) '
.head 7 -  Break
.head 6 +  Case AVIEW_LINKED
.head 7 -  Set sAccMFilter = sAccMFilter || ' AND a.accc = ' || sAccKey || ' '
.head 7 -  Break
.head 6 +  Case AVIEW_USER
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 5 -  !
.head 5 -  Set sAccOrd = ' ORDER BY a.nls '
.head 3 +  Function: ShowColumnByOptions
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If cTblOptions.bFinance
.head 6 +  If cTblOptions.bOstDK
.head 7 +  If cTblOptions.bSumEqv
.head 8 -  ! Показываем DOS, KOS в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOS)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOS)
.head 8 -  ! Показываем DOS, KOS в экв.
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 8 -  ! Прячем OST в номинале
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF)
.head 8 -  ! Прячем OST в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 8 -  ! Показываем OST ДК в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS_K)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC_K)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB_K)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF_K)
.head 8 -  ! Показываем OST ДК в экв.
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS_Dq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS_Kq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC_Dq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC_Kq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB_Dq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB_Kq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF_Dq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF_Kq)
.head 7 +  Else
.head 8 -  ! Показываем DOS, KOS в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOS)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOS)
.head 8 -  ! Прячем DOS, KOS в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 8 -  ! Прячем OST в номинале
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF)
.head 8 -  ! Прячем OST в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 8 -  ! Показываем OST ДК в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS_K)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC_K)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB_K)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF_D)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF_K)
.head 8 -  ! Прячем OST ДК в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Kq)
.head 6 +  Else
.head 7 +  If cTblOptions.bSumEqv
.head 8 -  ! Показываем DOS, KOS в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOS)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOS)
.head 8 -  ! Показываем DOS, KOS в экв.
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 8 -  ! Показываем OST в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF)
.head 8 -  ! Показываем OST в экв.
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colISq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 8 -  ! Прячем OST ДК в номинале
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_K)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_K)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_K)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_K)
.head 8 -  ! Прячем OST ДК в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Kq)
.head 7 +  Else
.head 8 -  ! Показываем DOS, KOS в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOS)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOS)
.head 8 -  ! Прячем DOS, KOS в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 8 -  ! Показываем OST в номинале
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colIS)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTC)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTB)
.head 8 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTF)
.head 8 -  ! Прячем OST в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 8 -  ! Прячем OST ДК в номинале
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_K)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_K)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_K)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_D)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_K)
.head 8 -  ! Прячем OST ДК в экв.
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Kq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Dq)
.head 8 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Kq)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDAPP)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDOS)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colKOS)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_D)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_K)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_D)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_K)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_D)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_K)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_D)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_K)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Dq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colIS_Kq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Dq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTC_Kq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Dq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTB_Kq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Dq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTF_Kq)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDAPP)
.head 5 -  !
.head 5 +  If cTblOptions.bInterests
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colRAT)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colRAT)
.head 5 +  If cTblOptions.bInterests | cTblOptions.bSpecial
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colMDAT)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colMDAT)
.head 5 -  !
.head 5 +  If cTblOptions.bLimits
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colLIM)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colLIM)
.head 5 -  !
.head 5 +  If cTblOptions.bLinkAcc
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colNLSC)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colNMSC)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colISOC)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colNLSC)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colNMSC)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISOC)
.head 5 -  !
.head 5 +  If cTblOptions.bSpecial
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colVID)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colR011)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colR013)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS080)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS180)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS190)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS200)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS230)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS240)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS260)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colS270)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colVID)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colR011)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colR013)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS080)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS180)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS190)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS200)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS230)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS240)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS260)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colS270)
.head 5 -  !
.head 5 +  If cTblOptions.bBlocked
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colBLKD)
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colBLKK)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colBLKD)
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colBLKK)
.head 5 -  !
.head 5 +  If cTblOptions.bClosed
.head 6 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDAZS)
.head 5 +  Else
.head 6 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDAZS)
.head 3 +  Function: CheckFilterSet
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If PAR_ACCFLTR
.head 6 +  If (nAccType = AVIEW_USER or nAccType = AVIEW_ALL)
and AccF.GetFilterWhereClause(dDat1, dDat2, FALSE) = ''
and DopFiltr = ''
.head 7 -  Call SalTblReset(hWndForm)
.head 7 -  ! Не задан фильтр!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgFilterNotSet'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: GetUserBranch
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sBranch
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
select BRANCH
  from STAFF$BASE
  into :sBranch
 where id = bars.user_id()" ) And SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return sBranch
.head 5 +  Else
.head 6 -  Return STRING_Null
.head 2 +  Window Parameters
.head 3 -  Number: nAccKey      ! Ключ пренадлежности счета (МФО/№ Исполнитель/№ Клиента)
.head 3 -  Number: nAccType     ! Тип счетов для просмотра
.head 3 -  Number: nCtrlFlags   ! Управляющие флаги
.head 3 -  String: sDopFiltr    ! предустановленный фильтр
<AccFilter>#<AccFilterTab>
.head 3 -  Boolean: bNN		! TRUE - признак НБУ МВО
.head 2 +  Window Variables
.head 3 -  : AccF	! Фильтр для счетов
.head 4 -  Class: cGenFilterAcc
.head 3 -  !
.head 3 -  String: DopFiltr        ! предустановленный фильтр
.head 3 -  : AccQ	! Запрос на население таблицы
.head 4 -  Class: cGenQueryAcc
.head 3 -  : AccC	! Коннект к БД
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  String: sAccSQL		! Строка запроса основной
.head 3 -  String: sAccFields	! Поля запроса
.head 3 -  String: sAccTables	! Таблицы запроса
.head 3 -  String: sAccBinds	! Бинды запроса
.head 3 -  String: sAccWhere	! Условие запроса
.head 3 -  String: sAccMFilter	! Строка условия WHERE+
.head 3 -  String: sAccClsFilter	! Строка условия "закрытые скрыть" 
.head 3 -  String: sAccKey         ! Значение ключа выборки счетов (rnk,mfo,userid,accc)
.head 3 -  String: sAccOrd		! ORDER BY
.head 3 -  String: sNewWhere
.head 3 -  String: sNewFrom
.head 3 -  !
.head 3 -  : cTblOptions	! Флаги состояния View
.head 4 -  Class: cAccListOptions
.head 3 -  Boolean: fCloseAcc	! показывать/нет закрытые счета (из PARAMS)
.head 3 -  !
.head 3 -  Boolean: bNBUBank
.head 3 -  Boolean: bKazna
.head 3 -  Boolean: bACC_OB22
.head 3 -  Boolean: bACC_BTIP
.head 3 -  Number: nHaveTobo
.head 3 -  Number: nBaseVal
.head 3 -  Number: nBaseValDig
.head 3 -  !
.head 3 -  Number: nPap		! код признака счета
.head 3 -  !
.head 3 -  Number: nRow		! номер строки
.head 3 -  Number: nFocusRow
.head 3 -  Window Handle: hFocusColumn
.head 3 -  !
.head 3 -  Boolean: fNSIEdit		! флаг возможности работать с НСИ
.head 3 -  Window Handle: hWndNeedNSI	! хендл окна требующего НСИ
.head 3 -  Number: nWndNeedNSI		! преобразованый хендл ..==..
.head 3 -  !
.head 3 -  String: strKeyVal
.head 3 -  String: strSemVal
.head 3 -  !
.head 3 -  Number: nRnkPar
.head 3 -  Number: nAccPar
.head 3 -  Number: nUserPar
.head 3 -  Number: nMfoPar
.head 3 -  !
.head 3 -  Number: nDlgRet
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  Number: nTmpIsp
.head 3 -  Number: nChildAccessType
.head 3 -  String: sFindNls
.head 3 -  Number: nFindNlsRow
.head 3 -  !
.head 3 -  : cMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  !
.head 3 -  Window Handle: hTitle
.head 3 -  Number: nAccOwner
.head 3 -  String: strName
.head 3 -  String: strND
.head 3 -  Date/Time: dDateOff
.head 3 -  !
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Window Handle: hColumn
.head 3 -  !
.head 3 -  Number: nMaxDig
.head 3 -  String: sKodArest
.head 3 -  Boolean: bArest
.head 3 -  Date/Time: dBDate
.head 3 -  Number: nColor
.head 3 -  String: sTooltipTxt
.head 3 -  !
.head 3 -  Number: nAccShow  !  параметр из params 
                  ! =0(или нету)=>при DoubleClick на форме счетов вызывается 
          !                 история счета
          ! =1  =>  вызывается карточка счета

.head 3 -  Boolean: bOrd
.head 3 -  Number: nRNK
.head 3 -  String: sNMK
.head 3 -  Date/Time: dDAT
.head 3 -  Number: nK014
.head 3 -  String: l_reserved
.head 3 -  String: sTmpNls
.head 3 -  String: sTitle
.head 3 -  String: sTitleIS
.head 3 -  String: sTitleISq
.head 3 -  String: sTitleIS_D
.head 3 -  String: sTitleIS_Dq
.head 3 -  String: sTitleIS_K
.head 3 -  String: sTitleIS_Kq
.head 3 -  String: sTitleOSTC
.head 3 -  String: sTitleOSTCq
.head 3 -  String: sTitleOSTC_D
.head 3 -  String: sTitleOSTC_Dq
.head 3 -  String: sTitleOSTC_K
.head 3 -  String: sTitleOSTC_Kq
.head 3 -  Date/Time: dDat1
.head 3 -  Date/Time: dDat2
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  Window Handle: hWndCcy
.head 3 -  Number: nScan
.head 3 -  String: sFilterOnTab
.head 3 -  !
.head 3 -  Window Handle: hWndToolBar
.head 3 -  Window Handle: hWndObject
.head 3 -  !
.head 3 -  Number: nX1
.head 3 -  Number: nY1
.head 3 -  Number: nX2
.head 3 -  Number: nY2
.head 3 -  Number: nRnk
.head 3 -  Number: nCusttype
.head 3 -  Number: hBitmap
.head 3 -  Number: nFlag
.head 3 -  Number: nRowItog
.head 3 -  ! Экв.
.head 3 -  Number: nIS_Dq
.head 3 -  Number: nIS_Kq
.head 3 -  Number: nDOSq
.head 3 -  Number: nKOSq
.head 3 -  Number: nOSTC_Dq
.head 3 -  Number: nOSTC_Kq
.head 3 -  Number: nOSTB_Dq
.head 3 -  Number: nOSTB_Kq
.head 3 -  Number: nOSTF_Dq
.head 3 -  Number: nOSTF_Kq
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set DopFiltr = sDopFiltr
.head 4 -  ! --- Костиль для Ощада (виключення доступу до рахунків "малого барсу" в ГОУ)
.head 4 +  If ( GetBankMfo() = '300465' AND GetUserBranch() != '/300465/000041/' )
.head 5 -  Set DopFiltr = DopFiltr || IifS( SalStrLength( DopFiltr )=0, "", " and " ) || "a.branch <> '/300465/000041/'" 
.head 4 -  ! ---
.head 4 -  Call XConnectGetParams(AccC)
.head 4 +  If NOT AccC.Connect()
.head 5 -  Return FALSE
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Set nLastSortRow = -1
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  ! Счета
.head 4 -  Call cMenu.Init(hWndForm, 'menuAccounts', CurrentLangTable.GetAtomTitle('tbl_AccountsList.menuAccounts.cTMenuAcc'))
.head 4 -  !
.head 4 -  ! Add for multilanguage support
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalTblSetColumnTitle(colISf, CurrentLangTable.GetAtomTitle('tbl_AccountsList.colIS'))
.head 4 -  Call SalTblSetColumnTitle(colOSTCf, CurrentLangTable.GetAtomTitle('tbl_AccountsList.colOSTC'))
.head 4 -  Call SalTblSetColumnTitle(colOSTBf, CurrentLangTable.GetAtomTitle('tbl_AccountsList.colOSTB'))
.head 4 -  Call SalTblSetColumnTitle(colOSTFf, CurrentLangTable.GetAtomTitle('tbl_AccountsList.colOSTF'))
.head 4 -  !
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  !
.head 4 -  Set hBitmap = XSalBitmapFromResource('bmpAccListOptions')
.head 4 -  !
.head 4 -  Set fNSIEdit = FALSE
.head 4 -  Call SalDisableWindow(pbGetValueFromNSI)
.head 4 -  !
.head 4 -  Set nBaseVal  = GetBaseVal()
.head 4 -  Set bACC_OB22 = GetGlobalOption('ACC_OB22') = '1'
.head 4 -  Set bACC_BTIP = GetGlobalOption('ACC_BTIP') = '1'
.head 4 -  Set fCloseAcc = GetGlobalOption('CLOSEACC') = '1'
.head 4 -  Set nAccShow  = GetGlobalOptionEx('ACCSHOW')
.head 4 -  Set bNBUBank  = PAR_NBUBANK = 1
.head 4 -  Set bKazna    = PAR_ORGTYPE = 'KAZNA'
.head 4 -  !
.head 4 -  Set dBDate = GetBankDate()
.head 4 -  Set dDat1  = dBDate
.head 4 -  Set dDat2  = dBDate
.head 4 -  !
.head 4 -  Set nScan = SalStrScan(DopFiltr, '#')
.head 4 -  ! --Subs( DopFiltr || SalStrRepeatX('2',7), nScan+2, 7) 
.head 4 -  Set sFilterOnTab = IifS(nScan=-1, SalStrRepeatX('2',7),
    IifS(Len(Subs(DopFiltr,nScan+2,Len(DopFiltr)-nScan+2))=0, 
         SalStrRepeatX('2',7),
         Subs(DopFiltr || SalStrRepeatX('0',7), nScan+2, 7)))
.head 4 -  Set DopFiltr = Subs(DopFiltr, 1, IifN(nScan=-1,Len(DopFiltr),nScan) )
.head 4 -  !
.head 4 -  ! Колонки в зав-ти от пар-ров
.head 4 +  If not bACC_OB22
.head 5 -  Call SalHideWindow(colOB22)
.head 4 +  If not bACC_BTIP
.head 5 -  Call SalHideWindow(colBranchTip)
.head 4 +  If nAccType != AVIEW_HIST
.head 5 -  Set nHaveTobo = GetGlobalOptionEx('HAVETOBO')
.head 5 +  If nHaveTobo > 0
.head 6 -  Call SalShowWindow(colTOBO)
.head 4 -  ! Кнопки
.head 4 -  Call SalDisableWindow(pbDeregAccount)
.head 4 -  Call SalDisableWindow(pbTurnAll)
.head 4 -  Call SalDisableWindow(pbCcySummary)
.head 4 -  ! Колонки
.head 4 -  Call cTblOptions.Init()
.head 4 -  Set bArest = FALSE
.head 4 -  ! Кнопки и колонки в зав-ти от пар-ров
.head 4 +  If nCtrlFlags & AVIEW_Financial
.head 5 -  Set cTblOptions.bFinance = TRUE
.head 5 -  Call SalEnableWindow(pbTurnAll)
.head 5 -  Call SalEnableWindow(pbCcySummary)
.head 4 +  If nCtrlFlags & AVIEW_Interest OR nCtrlFlags & AVIEW_Special
.head 5 -  Set cTblOptions.bInterests = TRUE
.head 5 -  Call SalEnableWindow(pbUpdateAttribute)
.head 4 +  If nCtrlFlags & AVIEW_Limit
.head 5 -  Set cTblOptions.bLimits = TRUE
.head 5 -  Call SalEnableWindow(pbUpdateAttribute)
.head 4 +  If nCtrlFlags & AVIEW_Linked
.head 5 -  Set cTblOptions.bLinkAcc = TRUE
.head 5 -  Call SalEnableWindow(pbUpdateAttribute)
.head 4 +  If nCtrlFlags & AVIEW_Blocked
.head 5 -  Set cTblOptions.bBlocked = TRUE
.head 5 -  Call SalEnableWindow(pbUpdateAttribute)
.head 5 -  !
.head 5 -  Set sKodArest = GetGlobalOption('KODAREST')
.head 5 +  If sKodArest
.head 6 -  Set bArest = TRUE
.head 4 +  If nCtrlFlags & AVIEW_Special
.head 5 -  Set cTblOptions.bSpecial = TRUE
.head 5 -  Call SalEnableWindow(pbUpdateAttribute)
.head 4 -  Set cTblOptions.bClosed = NOT (nCtrlFlags & AVIEW_ExistOnly)
.head 4 -  ! Показываем колонки в зав-ти от пар-ров
.head 4 -  Call ShowColumnByOptions()
.head 4 -  !
.head 4 -  Set sAccKey  = SalNumberToStrX(nAccKey,0)
.head 4 -  Set nRnkPar  = 0
.head 4 -  Set nAccPar  = 0
.head 4 -  Set nUserPar = 0
.head 4 -  Set nMfoPar  = 0
.head 4 +  Select Case nAccType
.head 5 +  Case AVIEW_CUST
.head 6 -  Set nRnkPar   = nAccKey
.head 6 -  Set nAccOwner = nRnkPar
.head 6 -  Call SalEnableWindow(pbDeregAccount)
.head 6 -  Call SqlPrepareAndExecute(AccC.hSql(), 'SELECT nmk, nd, date_off INTO :strName, :strND, :dDateOff FROM customer WHERE rnk = :nRnkPar')
.head 6 -  Call SqlFetchNext(AccC.hSql(), nFetchRes)
.head 6 -  ! Счета Контрагента (РНК sAccKey, НД strND). strName
.head 6 -  Call SalSetWindowText(hWndForm,
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTWndTitleCust')    || ' (' || 
     CurrentLangTable.GetAtomTitle('cTMsgRnk') || ' '  || sAccKey || ', '  || 
     CurrentLangTable.GetAtomTitle('cTMsgNd')  || ' '  || strND   || '). ' || strName )
.head 6 -  Break
.head 5 +  Case AVIEW_TECH
.head 6 -  Set nMfoPar = nAccKey
.head 6 -  ! Технологические Счета
.head 6 -  Set strName = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTWndTitleTech') || '. '
.head 6 +  If nMfoPar != 0
.head 7 -  Set strName = strName || 'МФО ' || sAccKey
.head 6 -  Call SalSetWindowText(hWndForm, strName)
.head 6 -  Break
.head 5 +  Case AVIEW_TAX
.head 6 -  ! Счета налогового учета.
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTWndTitleTax') || '.')
.head 6 -  Call SalShowWindow(colCUSTNAME)
.head 6 -  Break
.head 5 +  Case AVIEW_LINKED
.head 6 -  Set nAccPar = nAccKey
.head 6 -  Call SqlPrepareAndExecute(AccC.hSql(), 'SELECT nls INTO :strName FROM accounts WHERE acc = :nAccPar')
.head 6 -  Call SqlFetchNext(AccC.hSql(), nFetchRes)
.head 6 -  ! Счета, связанные со счетом strName
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTWndTitleLinked') || ' ' || strName || '.')
.head 6 -  Break
.head 5 +  Case AVIEW_USER
.head 6 -  Set nUserPar = nAccKey
.head 6 -  Call SqlPrepareAndExecute(AccC.hSql(), 'SELECT fio INTO :strName FROM staff WHERE logname=USER')
.head 6 -  Call SqlFetchNext(AccC.hSql(), nFetchRes)
.head 6 -  ! Счета Пользователя. strName
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTWndTitleUser') || '. ' || strName)
.head 6 -  Break
.head 5 +  Default
.head 6 -  ! Счета банка
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTWndTitleAccounts'))
.head 6 -  Break
.head 4 -  !
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 7)
.head 4 -  !
.head 4 -  ! Need to Remove in future
.head 4 -  Set nChildAccessType = ACCESS_FULL
.head 4 -  ! Закрываем кнопки в зав-ти от пара-ров 
.head 4 +  If nCtrlFlags & AVIEW_ReadOnly       ! Только для чтения
.head 5 -  ! Need to remove in future
.head 5 -  Set nChildAccessType = ACCESS_READONLY
.head 5 -  !
.head 5 -  Call SalDisableWindow(pbOpenAccount)
.head 5 -  Call SalDisableWindow(pbCloseAccount)
.head 5 -  Call SalDisableWindow(pbUpdateAttribute)
.head 5 -  Call SalDisableWindow(pbResurectAccount)
.head 5 -  Call SalDisableWindow(pbDeregAccount)
.head 5 -  Call SalDisableWindow(hWndForm.tbl_AccountsList.colMDAT)
.head 5 -  Call SalDisableWindow(hWndForm.tbl_AccountsList.colOWN)
.head 4 +  If nCtrlFlags & AVIEW_NoClose
.head 5 -  Call SalDisableWindow(pbCloseAccount)
.head 5 -  Call SalDisableWindow(pbResurectAccount)
.head 5 -  Call SalDisableWindow(pbDeregAccount)
.head 4 +  If nCtrlFlags & AVIEW_NoOpen
.head 5 -  Call SalDisableWindow(pbOpenAccount)
.head 4 +  If nCtrlFlags & AVIEW_NoUpdate
.head 5 -  Set nChildAccessType = ACCESS_READONLY
.head 5 -  Call SalDisableWindow(pbUpdateAttribute)
.head 4 +  If nCtrlFlags & AVIEW_NoEdit
.head 5 -  Call SalDisableWindow(pbEditAccount)
.head 4 +  If nCtrlFlags & AVIEW_NoHistory
.head 5 -  Call SalDisableWindow(pbAccHistory)
.head 4 +  If nCtrlFlags & AVIEW_NoTurns
.head 5 -  Call SalDisableWindow(tbl_AccTurn4Day)
.head 4 +  If nCtrlFlags & AVIEW_ExistOnly
.head 5 -  Call SalDisableWindow(pbResurectAccount)
.head 4 +  If nCtrlFlags & AVIEW_SPOnly
.head 5 -  Set nChildAccessType = AVIEW_SPOnly
.head 5 -  !
.head 5 -  Call SalDisableWindow(pbOpenAccount)
.head 5 -  Call SalDisableWindow(pbCloseAccount)
.head 5 -  Call SalDisableWindow(pbResurectAccount)
.head 4 +  If dDateOff != DATETIME_Null
.head 5 -  Set nChildAccessType = ACCESS_READONLY
.head 5 -  Call SalDisableWindow(pbOpenAccount)
.head 4 -  ! Инициализация строки населения
.head 4 -  Call PrepareSelectString()
.head 4 -  ! Инициализация фильтра
.head 4 +  If nAccType = AVIEW_USER OR
  (nAccType = AVIEW_CUST AND GetGlobalOptionEx('ACC_USER') = 1)
.head 5 -  Call AccF.Init('Saldo', 'a')
.head 4 +  Else
.head 5 -  Call AccF.Init('Accounts', 'a')
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig = 4
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select dig into :nBaseValDig from tabval where kv=:nBaseVal")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If nBaseValDig = 0
.head 5 -  Set nBaseValDig = 2
.head 4 -  Call SalGetWindowText(hWndForm, sTitle, 200)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalTblGetColumnTitle(colIS,    sTitleIS, 200)
.head 4 -  Call SalTblGetColumnTitle(colISq,   sTitleISq, 200)
.head 4 -  Call SalTblGetColumnTitle(colIS_D,  sTitleIS_D, 200)
.head 4 -  Call SalTblGetColumnTitle(colIS_Dq, sTitleIS_Dq, 200)
.head 4 -  Call SalTblGetColumnTitle(colIS_K,  sTitleIS_K, 200)
.head 4 -  Call SalTblGetColumnTitle(colIS_Kq, sTitleIS_Kq, 200)
.head 4 -  Call SalTblGetColumnTitle(colOSTC,    sTitleOSTC, 200)
.head 4 -  Call SalTblGetColumnTitle(colOSTCq,   sTitleOSTCq, 200)
.head 4 -  Call SalTblGetColumnTitle(colOSTC_D,  sTitleOSTC_D, 200)
.head 4 -  Call SalTblGetColumnTitle(colOSTC_Dq, sTitleOSTC_Dq, 200)
.head 4 -  Call SalTblGetColumnTitle(colOSTC_K,  sTitleOSTC_K, 200)
.head 4 -  Call SalTblGetColumnTitle(colOSTC_Kq, sTitleOSTC_Kq, 200)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  !
.head 4 +  If SetQueryDFilterEx(AccF)
.head 5 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Else
.head 5 -  Call SalPostMsg(pbExit, SAM_Click, 0, 0)
.head 3 +  On SAM_Activate
.head 4 -  Call cMenu.Enable(wParam)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If CheckFilterSet()
.head 5 -  Set nIS_Dq = 0
.head 5 -  Set nIS_Kq = 0
.head 5 -  Set nDOSq  = 0
.head 5 -  Set nKOSq  = 0
.head 5 -  Set nOSTC_Dq = 0
.head 5 -  Set nOSTC_Kq = 0
.head 5 -  Set nOSTB_Dq = 0
.head 5 -  Set nOSTB_Kq = 0
.head 5 -  Set nOSTF_Dq = 0
.head 5 -  Set nOSTF_Kq = 0
.head 5 +  If (nCtrlFlags & AVIEW_ExistOnly AND NOT fCloseAcc) OR NOT cTblOptions.bClosed
.head 6 -  Set sAccClsFilter = ' AND a.dazs IS NULL '
.head 5 +  Else
.head 6 -  Set sAccClsFilter = ''
.head 5 -  Set sNewWhere = AccF.GetFilterWhereClause(dDat1, dDat2, FILTER_Complex)
.head 5 -  Set sNewFrom = AccF.GetFilterFromClause(FILTER_Complex)
.head 5 -  ! Set sAccSQL = 'SELECT ' || sAccFields || ', 1 ' ||
              ' INTO '  || sAccBinds  || ', :colAccCount' ||
              ' FROM '  || sAccTables ||
              ' WHERE ' || sAccWhere
.head 5 -  Set sAccSQL = 'SELECT ' || sAccFields || ', 1 ' ||
              ' INTO '  || sAccBinds  || ', :colAccCount' ||
              ' FROM '  || sAccTables || IifS(sNewFrom='', '', ', ' || sNewFrom) || 
              ' WHERE ' || sAccWhere  || IifS(sNewWhere='', '', ' and ' || sNewWhere)
.head 5 +  If sAccMFilter != ''
.head 6 -  Set sAccSQL = sAccSQL || ' ' || sAccMFilter
.head 5 +  If sAccClsFilter != ''
.head 6 -  Set sAccSQL = sAccSQL || ' ' || sAccClsFilter
.head 5 -  Set sAccSQL = sAccSQL || sAccOrd
.head 5 -  ! Call AccQ.Init(sAccSQL)
.head 5 -  ! Set sAccSQL = AccQ.GetFullSQLString(AccF, dDat1, dDat2)
.head 5 -  Call SalTblQueryFocus(hWndForm, nFocusRow, hFocusColumn)
.head 5 -  Call SalTblPopulate(hWndForm, hSqlAux(), sAccSQL, TBL_FillNormal)
.head 5 -  !
.head 5 +  If cTblOptions.bSumEqv
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 6 -  Set nRowItog = SalTblInsertRow(hWndForm, TBL_MinSplitRow)
.head 6 -  Call SalTblFetchRow(hWndForm, nRowItog)
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRowItog)
.head 6 -  ! Эквиваленты
.head 6 -  Set colISqf    = nIS_Dq + nIS_Kq
.head 6 -  Set colISq     = SalNumberAbs(nIS_Dq+nIS_Kq)
.head 6 -  Set colIS_Dqf  = nIS_Dq
.head 6 -  Set colIS_Dq   = SalNumberAbs(nIS_Dq)
.head 6 -  Set colIS_Kqf  = nIS_Kq
.head 6 -  Set colIS_Kq   = SalNumberAbs(nIS_Kq)
.head 6 -  Set colDOSqf   = nDOSq
.head 6 -  Set colDOSq    = SalNumberAbs(nDOSq)
.head 6 -  Set colKOSqf   = nKOSq
.head 6 -  Set colKOSq    = SalNumberAbs(nKOSq)
.head 6 -  Set colOSTCqf  = nOSTC_Dq + nOSTC_Kq
.head 6 -  Set colOSTCq   = SalNumberAbs(nOSTC_Dq+nOSTC_Kq)
.head 6 -  Set colOSTC_Dqf= nOSTC_Dq
.head 6 -  Set colOSTC_Dq = SalNumberAbs(nOSTC_Dq)
.head 6 -  Set colOSTC_Kqf= nOSTC_Kq
.head 6 -  Set colOSTC_Kq = SalNumberAbs(nOSTC_Kq)
.head 6 -  Set colOSTBqf  = nOSTB_Dq + nOSTB_Kq
.head 6 -  Set colOSTBq   = SalNumberAbs(nOSTB_Dq+nOSTB_Kq)
.head 6 -  Set colOSTB_Dqf= nOSTB_Dq
.head 6 -  Set colOSTB_Dq = SalNumberAbs(nOSTB_Dq)
.head 6 -  Set colOSTB_Kqf= nOSTB_Kq
.head 6 -  Set colOSTB_Kq = SalNumberAbs(nOSTB_Kq)
.head 6 -  Set colOSTFqf  = nOSTF_Dq + nOSTF_Kq
.head 6 -  Set colOSTFq   = SalNumberAbs(nOSTF_Dq+nOSTF_Kq)
.head 6 -  Set colOSTF_Dqf= nOSTF_Dq
.head 6 -  Set colOSTF_Dq = SalNumberAbs(nOSTF_Dq)
.head 6 -  Set colOSTF_Kqf= nOSTF_Kq
.head 6 -  Set colOSTF_Kq = SalNumberAbs(nOSTF_Kq)
.head 6 -  ! Раскраска остатков
.head 6 -  Call SetOstColor(nIS_Dq+nIS_Kq,     SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISqf),   COL_GetID))
.head 6 -  Call SetOstColor(nIS_Dq+nIS_Kq,     SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISq),    COL_GetID))
.head 6 -  Call SetOstColor(nOSTC_Dq+nOSTC_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCqf), COL_GetID))
.head 6 -  Call SetOstColor(nOSTC_Dq+nOSTC_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCq),  COL_GetID))
.head 6 -  Call SetOstColor(nOSTB_Dq+nOSTB_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTBqf), COL_GetID))
.head 6 -  Call SetOstColor(nOSTB_Dq+nOSTB_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTBq),  COL_GetID))
.head 6 -  Call SetOstColor(nOSTF_Dq+nOSTF_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTFqf), COL_GetID))
.head 6 -  Call SetOstColor(nOSTF_Dq+nOSTF_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTFq),  COL_GetID))
.head 6 -  Call SetOstDKColor(nIS_Dq,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Dqf),  COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nIS_Dq,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Dq),   COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nIS_Kq,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Kqf),  COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nIS_Kq,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Kq),   COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nOSTC_Dq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Dqf),COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nOSTC_Dq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Dq), COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nOSTC_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Kqf),COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nOSTC_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Kq), COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nOSTB_Dq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Dqf),COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nOSTB_Dq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Dq), COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nOSTB_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Kqf),COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nOSTB_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Kq), COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nOSTF_Dq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Dqf),COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nOSTF_Dq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Dq), COL_GetID), 0)
.head 6 -  Call SetOstDKColor(nOSTF_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Kqf),COL_GetID), 1)
.head 6 -  Call SetOstDKColor(nOSTF_Kq, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Kq), COL_GetID), 1)
.head 5 +  Else
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 5 -  !
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalTblSetFocusRow(hWndForm, nFocusRow)
.head 5 -  Call SalTblSetContext(hWndForm, nFocusRow)
.head 5 -  Set dfAccCount = SalTblColumnSum(hWndForm, SalTblQueryColumnID(colAccCount), 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! форматирование числа в строку с валютными характеристиками
.head 4 -  ! Df и Kf переводим в Abs, потому что в заголовках стоит ДЕБЕТ/КРЕДИТ, '-' не нужен
.head 4 -  Set colIS      = Dig4(SalNumberAbs(colISf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colIS_Df   = Abs(IifN(colISf<0, colISf, 0))
.head 4 -  Set colIS_D    = IifS(colISf<0, colIS, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colIS_Kf   = Abs(IifN(colISf>0, colISf, 0))
.head 4 -  Set colIS_K    = IifS(colISf>0, colIS, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colDOS     = Dig4(colDOSf*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colKOS     = Dig4(colKOSf*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colOSTC    = Dig4(SalNumberAbs(colOSTCf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colOSTC_Df = Abs(IifN(colOSTCf<0, colOSTCf, 0))
.head 4 -  Set colOSTC_D  = IifS(colOSTCf<0, colOSTC, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colOSTC_Kf = Abs(IifN(colOSTCf>0, colOSTCf, 0))
.head 4 -  Set colOSTC_K  = IifS(colOSTCf>0, colOSTC, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colOSTB    = Dig4(SalNumberAbs(colOSTBf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colOSTB_Df = Abs(IifN(colOSTBf<0, colOSTBf, 0))
.head 4 -  Set colOSTB_D  = IifS(colOSTBf<0, colOSTB, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colOSTB_Kf = Abs(IifN(colOSTBf>0, colOSTBf, 0))
.head 4 -  Set colOSTB_K  = IifS(colOSTBf>0, colOSTB, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colOSTF    = Dig4(SalNumberAbs(colOSTFf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colOSTF_Df = Abs(IifN(colOSTFf<0, colOSTFf, 0))
.head 4 -  Set colOSTF_D  = IifS(colOSTFf<0, colOSTF, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colOSTF_Kf = Abs(IifN(colOSTFf>0, colOSTFf, 0))
.head 4 -  Set colOSTF_K  = IifS(colOSTFf>0, colOSTF, Dig4(0, colDig, nMaxDig))
.head 4 -  Set colLIM     = Dig4(colLIMf*SalNumberPower(10,colDig)/100, 2, 2)
.head 4 -  Set colRAT     = SalNumberToStrX(colRATf, 4)
.head 4 -  ! Раскраска остатков
.head 4 -  Call SetOstColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS),    COL_GetID))
.head 4 -  Call SetOstColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISf),   COL_GetID))
.head 4 -  Call SetOstColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISq),    COL_GetID))
.head 4 -  Call SetOstColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISqf),   COL_GetID))
.head 4 -  Call SetOstColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC),  COL_GetID))
.head 4 -  Call SetOstColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCf), COL_GetID))
.head 4 -  Call SetOstColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCq),  COL_GetID))
.head 4 -  Call SetOstColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCqf), COL_GetID))
.head 4 -  Call SetOstColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB),  COL_GetID))
.head 4 -  Call SetOstColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTBf), COL_GetID))
.head 4 -  Call SetOstColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTBq),  COL_GetID))
.head 4 -  Call SetOstColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTBqf), COL_GetID))
.head 4 -  Call SetOstColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF),  COL_GetID))
.head 4 -  Call SetOstColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTFf), COL_GetID))
.head 4 -  Call SetOstColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTFq),  COL_GetID))
.head 4 -  Call SetOstColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTFqf), COL_GetID))
.head 4 -  ! Раскраска остатков ДК
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Df),   COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_D),    COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Dqf),   COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Dq),    COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Kf),   COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_K),    COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Kqf),   COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Kq),    COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Df), COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_D),  COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Dqf), COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Dq),  COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Kf), COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_K),  COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Kqf), COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Kq),  COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Df), COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_D),  COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Dqf), COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Dq),  COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Kf), COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_K),  COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Kqf), COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Kq),  COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Df), COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_D),  COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Dqf), COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Dq),  COL_GetID), 0)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Kf), COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_K),  COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Kqf), COL_GetID), 1)
.head 4 -  Call SetOstDKColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Kq),  COL_GetID), 1)
.head 4 -  ! Красим строки
.head 4 +  If colBDCODE OR colBKCODE	! Счет блокирован
.head 5 +  If bArest AND ( 
 ( colBDCODE = Val(sKodArest) and colBDCODE >= colBKCODE ) OR 
 ( colBKCODE = Val(sKodArest) and colBKCODE >= colBDCODE ) )
.head 6 -  Call SalTblSetCellTextColor(colNLS, COLOR_Marigold, TRUE)
.head 6 -  Call SalTblSetCellTextColor(colKV,  COLOR_Marigold, TRUE)
.head 6 -  Call SalTblSetCellTextColor(colISO, COLOR_Marigold, TRUE)
.head 6 -  Call SalTblSetCellTextColor(colNMS, COLOR_Marigold, TRUE)
.head 5 +  Else
.head 6 -  Call SalTblSetCellTextColor(colNLS, COLOR_Purple, TRUE)
.head 6 -  Call SalTblSetCellTextColor(colKV,  COLOR_Purple, TRUE)
.head 6 -  Call SalTblSetCellTextColor(colISO, COLOR_Purple, TRUE)
.head 6 -  Call SalTblSetCellTextColor(colNMS, COLOR_Purple, TRUE)
.head 4 +  If NOT SalIsNull(colDAZS)	! Счет закрыт
.head 5 -  Call SetTblRowColor(hWndForm, COLOR_Periwinkle)
.head 4 -  !
.head 4 +  Select Case nPap
.head 5 +  Case 1
.head 6 -  ! A
.head 6 -  Set colPAP = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTPap1')
.head 6 -  Break
.head 5 +  Case 2
.head 6 -  ! П
.head 6 -  Set colPAP = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTPap2')
.head 6 -  Break
.head 5 +  Case 3
.head 6 -  ! А/П
.head 6 -  Set colPAP = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTPap3')
.head 6 -  Break
.head 5 +  Default
.head 6 -  Break
.head 4 -  !
.head 4 -  ! Эквиваленты
.head 4 +  If cTblOptions.bSumEqv
.head 5 -  ! форматирование числа в строку
.head 5 -  Set colISq     = SalNumberAbs(colISqf)
.head 5 -  Set colIS_Dq   = IifN(colISqf<0, colISq, 0)
.head 5 -  Set colIS_Kq   = IifN(colISqf>0, colISq, 0)
.head 5 -  Set colDOSq    = colDOSqf
.head 5 -  Set colKOSq    = colKOSqf
.head 5 -  Set colOSTCq   = SalNumberAbs(colOSTCqf)
.head 5 -  Set colOSTC_Dq = IifN(colOSTCqf<0, colOSTCq, 0)
.head 5 -  Set colOSTC_Kq = IifN(colOSTCqf>0, colOSTCq, 0)
.head 5 -  Set colOSTBq   = SalNumberAbs(colOSTBqf)
.head 5 -  Set colOSTB_Dq = IifN(colOSTBqf<0, colOSTBq, 0)
.head 5 -  Set colOSTB_Kq = IifN(colOSTBqf>0, colOSTBq, 0)
.head 5 -  Set colOSTFq   = SalNumberAbs(colOSTFqf)
.head 5 -  Set colOSTF_Dq = IifN(colOSTFqf<0, colOSTFq, 0)
.head 5 -  Set colOSTF_Kq = IifN(colOSTFqf>0, colOSTFq, 0)
.head 5 -  ! Раскраска остатков
.head 5 -  Call SetOstColor(colISf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISq),   COL_GetID))
.head 5 -  Call SetOstColor(colOSTCf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCq), COL_GetID))
.head 5 -  Call SetOstColor(colOSTBf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTBq), COL_GetID))
.head 5 -  Call SetOstColor(colOSTFf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTFq), COL_GetID))
.head 5 -  Call SetOstDKColor(colISqf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Dq),   COL_GetID), 0)
.head 5 -  Call SetOstDKColor(colISqf,   SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colIS_Kq),   COL_GetID), 1)
.head 5 -  Call SetOstDKColor(colOSTCqf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Dq), COL_GetID), 0)
.head 5 -  Call SetOstDKColor(colOSTCqf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTC_Kq), COL_GetID), 1)
.head 5 -  Call SetOstDKColor(colOSTBqf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Dq), COL_GetID), 0)
.head 5 -  Call SetOstDKColor(colOSTBqf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTB_Kq), COL_GetID), 1)
.head 5 -  Call SetOstDKColor(colOSTFqf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Dq), COL_GetID), 0)
.head 5 -  Call SetOstDKColor(colOSTFqf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTF_Kq), COL_GetID), 1)
.head 5 -  ! Суммирование экв.
.head 5 -  Set nIS_Dq = nIS_Dq + IifN(colISqf<0, colISqf, 0)
.head 5 -  Set nIS_Kq = nIS_Kq + IifN(colISqf>0, colISqf, 0)
.head 5 -  Set nDOSq  = nDOSq + colDOSqf
.head 5 -  Set nKOSq  = nKOSq + colKOSqf
.head 5 -  Set nOSTC_Dq = nOSTC_Dq + IifN(colOSTCqf<0, colOSTCqf, 0)
.head 5 -  Set nOSTC_Kq = nOSTC_Kq + IifN(colOSTCqf>0, colOSTCqf, 0)
.head 5 -  Set nOSTB_Dq = nOSTB_Dq + IifN(colOSTBqf<0, colOSTBqf, 0)
.head 5 -  Set nOSTB_Kq = nOSTB_Kq + IifN(colOSTBqf>0, colOSTBqf, 0)
.head 5 -  Set nOSTF_Dq = nOSTF_Dq + IifN(colOSTFqf<0, colOSTFqf, 0)
.head 5 -  Set nOSTF_Kq = nOSTF_Kq + IifN(colOSTFqf>0, colOSTFqf, 0)
.head 3 +  On SAM_DoubleClick
.head 4 -  ! По DoubleClick - показать карточку счета
.head 4 +  If nAccShow
.head 5 +  If SalIsWindowEnabled(pbEditAccount)
.head 6 -  Call SalPostMsg(pbEditAccount, SAM_Click, 0, 0)
.head 4 -  ! По DoubleClick - показать историю счета
.head 4 +  Else
.head 5 +  If SalIsWindowEnabled(pbAccHistory)
.head 6 -  Call SalPostMsg(pbAccHistory, SAM_Click, 0, 0)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor ( TRUE )
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 -  ! сортировка строковых столбцов по числовым
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colIS ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colISf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colDOS ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colDOSf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colKOS ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colKOSf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colOSTC ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colOSTCf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colOSTB ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colOSTBf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colOSTF ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colOSTFf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colRAT ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colRATf ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colLIM ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( hWndForm, SalTblQueryColumnPos( colLIMf ), COL_GetID ))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  ! Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nSortOrder )
.head 4 -  Call SalSendMsg (hWndForm, SAM_RowSetContext, 0, 0 )
.head 4 -  Call SalWaitCursor ( FALSE )
.head 3 +  On SAM_RowHeaderClick
.head 4 -  Set sTooltipTxt = ''
.head 4 +  If colBDCODE OR colBKCODE        ! Счет блокирован
.head 5 +  If bArest AND ( 
 ( colBDCODE = Val(sKodArest) and colBDCODE >= colBKCODE ) OR 
 ( colBKCODE = Val(sKodArest) and colBKCODE >= colBDCODE ) )
.head 6 -  Set nColor = COLOR_Marigold
.head 6 -  ! Set sTooltipTxt = 'Арестован'
.head 6 -  Set sTooltipTxt = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTAccArest')
.head 5 +  Else
.head 6 -  Set nColor = COLOR_Purple
.head 6 -  ! Set sTooltipTxt = 'Блокирован'
.head 6 -  Set sTooltipTxt = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTAccBlock')
.head 4 +  If NOT SalIsNull( colDAZS )      ! Счет закрыт
.head 5 -  Set nColor = COLOR_DarkBlue
.head 5 -  ! Set sTooltipTxt = 'Закрыт'
.head 5 -  Set sTooltipTxt = CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTAccClose')
.head 4 -  Call XSalTooltipSetColors(nColor, COLOR_White)
.head 4 -  Call XSalTooltipShow(hWndForm, sTooltipTxt)
.head 4 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call cMenu.ShowMenu(wParam, lParam)
.head 3 +  On UM_Print
.head 4 -  ! Для печати остатков Д/К открываем колонки с настоящей суммой (с -/+)
.head 4 +  If cTblOptions.bFinance
.head 5 +  If not cTblOptions.bOstDK
.head 6 -  Call SalShowWindow(colISf)
.head 6 -  Call SalShowWindow(colDOSf)
.head 6 -  Call SalShowWindow(colKOSf)
.head 6 -  Call SalShowWindow(colOSTCf)
.head 6 -  Call SalShowWindow(colOSTBf)
.head 6 -  Call SalShowWindow(colOSTFf)
.head 6 -  !
.head 6 -  Call SalHideWindow(colIS)
.head 6 -  Call SalHideWindow(colDOS)
.head 6 -  Call SalHideWindow(colKOS)
.head 6 -  Call SalHideWindow(colOSTC)
.head 6 -  Call SalHideWindow(colOSTB)
.head 6 -  Call SalHideWindow(colOSTF)
.head 6 -  !
.head 6 -  Call SalTblGetColumnTitle(colIS,   sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colISf,  sTmp)
.head 6 -  Call SalTblGetColumnTitle(colDOS,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colDOSf, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colKOS,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colKOSf, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTC, sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTCf,sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTB, sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTBf,sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTF, sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTFf,sTmp)
.head 6 -  !
.head 6 -  Call SalTblQueryColumnWidth(colIS, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colISf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colDOS, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colDOSf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colKOS, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colKOSf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTC, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTCf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTB, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTBf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTF, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTFf,  nTmp)
.head 6 +  If cTblOptions.bSumEqv
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colISqf)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOSqf)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOSqf)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTCqf)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTBqf)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTFqf)
.head 7 -  !
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISq)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 7 -  !
.head 7 -  Call SalTblGetColumnTitle(colISq,    sTmp, 100)
.head 7 -  Call SalTblSetColumnTitle(colISqf,   sTmp)
.head 7 -  Call SalTblGetColumnTitle(colDOSq,   sTmp, 100)
.head 7 -  Call SalTblSetColumnTitle(colDOSqf,  sTmp)
.head 7 -  Call SalTblGetColumnTitle(colKOSq,   sTmp, 100)
.head 7 -  Call SalTblSetColumnTitle(colKOSqf,  sTmp)
.head 7 -  Call SalTblGetColumnTitle(colOSTCq,  sTmp, 100)
.head 7 -  Call SalTblSetColumnTitle(colOSTCqf, sTmp)
.head 7 -  Call SalTblGetColumnTitle(colOSTBq,  sTmp, 100)
.head 7 -  Call SalTblSetColumnTitle(colOSTBqf, sTmp)
.head 7 -  Call SalTblGetColumnTitle(colOSTFq,  sTmp, 100)
.head 7 -  Call SalTblSetColumnTitle(colOSTFqf, sTmp)
.head 7 -  !
.head 7 -  Call SalTblQueryColumnWidth(colISq,   nTmp)
.head 7 -  Call SalTblSetColumnWidth(colISqf,    nTmp)
.head 7 -  Call SalTblQueryColumnWidth(colDOSq,  nTmp)
.head 7 -  Call SalTblSetColumnWidth(colDOSqf,   nTmp)
.head 7 -  Call SalTblQueryColumnWidth(colKOSq,  nTmp)
.head 7 -  Call SalTblSetColumnWidth(colKOSqf,   nTmp)
.head 7 -  Call SalTblQueryColumnWidth(colOSTCq, nTmp)
.head 7 -  Call SalTblSetColumnWidth(colOSTCqf,  nTmp)
.head 7 -  Call SalTblQueryColumnWidth(colOSTBq, nTmp)
.head 7 -  Call SalTblSetColumnWidth(colOSTBqf,  nTmp)
.head 7 -  Call SalTblQueryColumnWidth(colOSTFq, nTmp)
.head 7 -  Call SalTblSetColumnWidth(colOSTFqf,  nTmp)
.head 5 +  Else
.head 6 -  Call SalShowWindow(colIS_Df)
.head 6 -  Call SalShowWindow(colIS_Kf)
.head 6 -  Call SalShowWindow(colDOSf)
.head 6 -  Call SalShowWindow(colKOSf)
.head 6 -  Call SalShowWindow(colOSTC_Df)
.head 6 -  Call SalShowWindow(colOSTC_Kf)
.head 6 -  Call SalShowWindow(colOSTB_Df)
.head 6 -  Call SalShowWindow(colOSTB_Kf)
.head 6 -  Call SalShowWindow(colOSTF_Df)
.head 6 -  Call SalShowWindow(colOSTF_Kf)
.head 6 -  Call SalHideWindow(colIS_D)
.head 6 -  Call SalHideWindow(colIS_K)
.head 6 -  Call SalHideWindow(colDOS)
.head 6 -  Call SalHideWindow(colKOS)
.head 6 -  Call SalHideWindow(colOSTC_D)
.head 6 -  Call SalHideWindow(colOSTC_K)
.head 6 -  Call SalHideWindow(colOSTB_D)
.head 6 -  Call SalHideWindow(colOSTB_K)
.head 6 -  Call SalHideWindow(colOSTF_D)
.head 6 -  Call SalHideWindow(colOSTF_K)
.head 6 -  !
.head 6 -  Call SalTblGetColumnTitle(colIS_D,    sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colIS_Df,   sTmp)
.head 6 -  Call SalTblGetColumnTitle(colIS_K,    sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colIS_Kf,   sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTC_D,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTC_Df, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTC_K,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTC_Kf, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTB_D,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTB_Df, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTB_K,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTB_Kf, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTF_D,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTF_Df, sTmp)
.head 6 -  Call SalTblGetColumnTitle(colOSTF_K,  sTmp, 100)
.head 6 -  Call SalTblSetColumnTitle(colOSTF_Kf, sTmp)
.head 6 -  !
.head 6 -  Call SalTblQueryColumnWidth(colIS_D, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colIS_Df,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colIS_K, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colIS_Kf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTC_D, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTC_Df,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTC_K, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTC_Kf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTB_D, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTB_Df,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTB_K, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTB_Kf,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTF_D, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTF_Df,  nTmp)
.head 6 -  Call SalTblQueryColumnWidth(colOSTF_K, nTmp)
.head 6 -  Call SalTblSetColumnWidth(colOSTF_Kf,  nTmp)
.head 4 -  ! Список лицевых счетов клиентов банка
.head 4 -  Call TablePrint(hWndForm, SalFmtFormatDateTime( GetBankDate(), 'dd/MM/yyyy' ) || ': ' || 
     CurrentLangTable.GetAtomTitle('tbl_AccountsList.cTAccList'),
     GetPrnDir() || '\\Accounts.lst', '')
.head 4 +  If cTblOptions.bFinance
.head 5 +  If not cTblOptions.bOstDK
.head 6 -  Call SalHideWindow(colISf)
.head 6 -  Call SalHideWindow(colDOSf)
.head 6 -  Call SalHideWindow(colKOSf)
.head 6 -  Call SalHideWindow(colOSTCf)
.head 6 -  Call SalHideWindow(colOSTBf)
.head 6 -  Call SalHideWindow(colOSTFf)
.head 6 -  Call SalShowWindow(colIS)
.head 6 -  Call SalShowWindow(colDOS)
.head 6 -  Call SalShowWindow(colKOS)
.head 6 -  Call SalShowWindow(colOSTC)
.head 6 -  Call SalShowWindow(colOSTB)
.head 6 -  Call SalShowWindow(colOSTF)
.head 6 +  If cTblOptions.bSumEqv
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colISqf)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colDOSqf)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colKOSqf)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTCqf)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTBqf)
.head 7 -  Call SalHideWindow(hWndForm.tbl_AccountsList.colOSTFqf)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colISq)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colDOSq)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colKOSq)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTCq)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTBq)
.head 7 -  Call SalShowWindow(hWndForm.tbl_AccountsList.colOSTFq)
.head 5 +  Else
.head 6 -  Call SalHideWindow(colIS_Df)
.head 6 -  Call SalHideWindow(colIS_Kf)
.head 6 -  Call SalHideWindow(colDOSf)
.head 6 -  Call SalHideWindow(colKOSf)
.head 6 -  Call SalHideWindow(colOSTC_Df)
.head 6 -  Call SalHideWindow(colOSTC_Kf)
.head 6 -  Call SalHideWindow(colOSTB_Df)
.head 6 -  Call SalHideWindow(colOSTB_Kf)
.head 6 -  Call SalHideWindow(colOSTF_Df)
.head 6 -  Call SalHideWindow(colOSTF_Kf)
.head 6 -  Call SalShowWindow(colIS_D)
.head 6 -  Call SalShowWindow(colIS_K)
.head 6 -  Call SalShowWindow(colDOS)
.head 6 -  Call SalShowWindow(colKOS)
.head 6 -  Call SalShowWindow(colOSTC_D)
.head 6 -  Call SalShowWindow(colOSTC_K)
.head 6 -  Call SalShowWindow(colOSTB_D)
.head 6 -  Call SalShowWindow(colOSTB_K)
.head 6 -  Call SalShowWindow(colOSTF_D)
.head 6 -  Call SalShowWindow(colOSTF_K)
.head 3 +  On SAM_ContextMenu
.head 4 -  Call Fun_SumCol()
.head 3 +  On SAM_SetFocus
.head 4 -  ! F5-Просмотр/редактирование атрибутов счета, F6-История счета
.head 4 -  Call SalStatusSetText(hWndForm, 
  'F5-' || CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipEditAccount') || 
', F6-' || CurrentLangTable.GetAtomTitle('tbl_AccountsList.cBTipAccHistory'))
.head 3 +  On SAM_KillFocus
.head 4 -  Call SalStatusSetText(hWndForm, '')
.head 3 +  On SAM_Destroy
.head 4 -  Call SaveInfoToLog('Выход из диалога: Счета.')
.head 4 +  If AccC.IsConnected()
.head 5 -  Call AccC.Disconnect()
.head 4 -  Call cMenu.Kill()
.head 4 -  Call SalSetFocus(SalParentWindow( hWndForm))
.head 4 -  Call SalStatusSetText(hWndForm, '')
.head 4 -  ! Deactivation of function's role
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' ShowUserAccounts(hWndMDI ')
.head 4 -  Call XSalBitmapClose(hBitmap)
.head 3 +  On SAM_CornerClick
.head 4 +  If SalModalDialog(dlgAccListOptions, hWndForm, nCtrlFlags, cTblOptions, fCloseAcc)
.head 5 -  Call PrepareSelectString()
.head 5 -  Call ShowColumnByOptions()
.head 5 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On WM_Paint
.head 4 -  Call XSalBitmapDraw(hWndForm, hBitmap, 0, 0, 18, 18, FALSE)
.head 1 +  Table Window: tbl_CcySummarise
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 50
.head 3 -  Discardable? Class Default
.head 2 -  Description: Показать итоги по валютам в розрезе типов счетов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62738
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62739
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62740
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCcy
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Входящий
остаток
ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISDf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Входящий
остаток
ДЕБЕТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Входящий
остаток
КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISKf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Входящий
остаток
КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOSf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Дебет
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOSf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Кредит
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий
остаток
ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCDf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий
остаток
ДЕБЕТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий
остаток
КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCKf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий
остаток
КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISDQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ISDQ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISKQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ISKQ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOSQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DOSQ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOSQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KOSQ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCDQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: OSTCDQ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOSTCKQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: OSTCKQ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! Sum(ost*rat)
.head 3 +  Column: colSumOstRat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sum(Ost*Rat)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! Sum(ostq*rat)
.head 3 +  Column: colSumOstqRat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sum(Ostq*Rat)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! Sum(ost*rat)/Sum(ost) и Sum(ostq*rat)/Sum(ostq)
.head 3 +  Column: colRAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Средневзвешенная
ставка
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SetOSColorRow
.head 4 -  Description: Покрасить поле остатка в нужный цвет
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOS
.head 5 -  Window Handle: hCol
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 +  If nOS < 0
.head 6 -  Set nInd = COLOR_Red
.head 5 +  Else If nOS > 0
.head 6 -  Set nInd = COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nInd = COLOR_Black
.head 5 -  Call SalTblSetCellTextColor(hCol, nInd, FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nAccType
.head 3 -  String: sAccMFilter
.head 3 -  : cAccF
.head 4 -  Class: cGenFilterAcc
.head 3 -  Date/Time: dDat1
.head 3 -  Date/Time: dDat2
.head 2 +  Window Variables
.head 3 -  Boolean: bFEqv
.head 3 -  Date/Time: dBD
.head 3 -  String: sDatBCcy
.head 3 -  Number: nBaseVal
.head 3 -  Number: nBaseValDig
.head 3 -  String: strBVal
.head 3 -  String: strCcySql
.head 3 -  String: strCcyFrom
.head 3 -  String: strCcyWhere
.head 3 -  String: strCcyGroupBy
.head 3 -  !
.head 3 -  String: strWhereAccF
.head 3 -  String: strFromAccF
.head 3 -  String: strFromAdd
.head 3 -  !
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Window Handle: hColumn
.head 3 -  !
.head 3 -  Number: nSISD
.head 3 -  Number: nSISK
.head 3 -  Number: nSDOS
.head 3 -  Number: nSKOS
.head 3 -  Number: nSOSTCD
.head 3 -  Number: nSOSTCK
.head 3 -  Number: nSumISD
.head 3 -  Number: nSumISK
.head 3 -  Number: nSumDOS
.head 3 -  Number: nSumKOS
.head 3 -  Number: nSumOSTCD
.head 3 -  Number: nSumOSTCK
.head 3 -  Number: nSumOstqRat
.head 3 -  Number: nRat
.head 3 -  !
.head 3 -  Number: nMaxDig
.head 3 -  Number: nKv
.head 3 -  Number: nKvIns
.head 3 -  String: sLcv
.head 3 -  Number: nRow
.head 3 -  Number: nTblRow
.head 3 -  Number: nCount
.head 3 -  Number: nCountKv
.head 3 -  Number: i
.head 3 -  Number: nKvI
.head 3 -  Number: nmKvOst[*,9]
.head 3 -  String: smKv[*]
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_CcySummarise.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 1)
.head 4 -  Set nLastSortRow = -1
.head 4 -  !
.head 4 +  If GetGlobalOption('EQV')='YES'
.head 5 -  Set bFEqv = TRUE
.head 4 -  !
.head 4 -  Set sDatBCcy = GetBankDateEx()
.head 4 -  Set dBD = GetBankDate()
.head 4 -  Set strFromAccF  = cAccF.GetFilterFromClause(FALSE)
.head 4 -  Set strWhereAccF = cAccF.GetFilterWhereClause(dDat1, dDat2, FALSE)
.head 4 +  If nAccType = AVIEW_USER
.head 5 -  Set strFromAdd = ' saldo a '
.head 4 +  Else
.head 5 -  Set strFromAdd = ' accounts a '
.head 4 -  Set nBaseVal = GetBaseVal()
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select dig into :nBaseValDig from tabval where kv=:nBaseVal")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If nBaseValDig = 0
.head 5 -  Set nBaseValDig = 2
.head 4 +  !
.head 5 -  ! Set strFrom = ' tabval t, ' || 
'(SELECT a.kv,
         sum(decode(sign(decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos)), 1,0,decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos))) isdf,
         sum(decode(sign(decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos)),-1,0,decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos))) iskf ' || 
         IifS(bFEqv, ',
         sum(decode(sign(decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq)), 1,0,decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq))) isdq,
         sum(decode(sign(decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq)),-1,0,decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq))) iskq ', '') ||
'  FROM saldoa s, ' || strFromAdd || '
  WHERE s.acc = a.acc AND 
       (a.acc,s.fdat) = (SELECT acc, max(fdat) 
           FROM saldoa 
           WHERE acc=a.acc AND fdat<=:dDat1 
           GROUP BY acc ) ' || sAccMFilter || IifS(strAddWhere='','',' AND ' || strAddWhere) || '
  GROUP BY a.kv) c,
 (SELECT a.kv,
         sum(decode(sign(s.ostf - s.dos + s.kos), 1,0,s.ostf - s.dos + s.kos)) ostcd,
         sum(decode(sign(s.ostf - s.dos + s.kos),-1,0,s.ostf - s.dos + s.kos)) ostck,
         sum((s.ostf - s.dos + s.kos)*acrn.fprocn(a.acc,null,s.fdat)) rat ' || 
         IifS(bFEqv, ',
         sum(decode(sign(s.ostq - s.dosq + s.kosq), 1,0,s.ostq - s.dosq + s.kosq)) ostcdq,
         sum(decode(sign(s.ostq - s.dosq + s.kosq),-1,0,s.ostq - s.dosq + s.kosq)) ostckq,
         sum((s.ostq - s.dosq + s.kosq)*acrn.fprocn(a.acc,null,s.fdat)) ratq ', '') || 
' FROM saldoa s, ' || strFromAdd || '
  WHERE s.acc = a.acc AND 
       (a.acc,s.fdat) = (SELECT acc, max(fdat) 
           FROM saldoa 
           WHERE acc=a.acc AND fdat<=:dDat2 
           GROUP BY acc ) ' || sAccMFilter || IifS(strAddWhere='','',' AND ' || strAddWhere) || '
  GROUP BY a.kv) d, 
 (SELECT a.kv, 
         sum(decode(s.fdat, B.fdat, s.dos, 0)) dos, 
         sum(decode(s.fdat, B.fdat, s.kos, 0)) kos ' || 
         IifS(bFEqv, ',
         sum(decode(s.fdat, B.fdat, s.dosq, 0)) dosq, 
         sum(decode(s.fdat, B.fdat, s.kosq, 0)) kosq ', '') ||
' FROM ' || strFromAdd || ', saldoa s, fdat B 
  WHERE a.acc=s.acc AND 
       (a.acc,s.fdat) = (SELECT c.acc, max(c.fdat) 
           FROM saldoa c 
           WHERE a.acc=c.acc AND c.fdat<= B.fdat 
           GROUP BY c.acc) AND 
        b.fdat>=:dDat1 AND b.fdat<=:dDat2 ' || sAccMFilter || IifS(strAddWhere='','',' AND ' || strAddWhere) || ' 
  GROUP BY a.kv) b '
.head 4 -  Set strCcySql =
'SELECT t.kv, t.lcv, t.dig, decode(t.kv, :nBaseVal, 0, 1), 
        nvl(c.isdf,0)/power(10,t.dig) isdf, 
        nvl(c.iskf,0)/power(10,t.dig) iskf, 
        nvl(b.dos,0)/power(10,t.dig) dos, 
        nvl(b.kos,0)/power(10,t.dig) kos, 
        d.ostcd/power(10,t.dig) ostcd, 
        d.ostck/power(10,t.dig) ostck, 
        d.rat/power(10,t.dig) rat, 
        nvl(c.isdq,0)/power(10,:nBaseValDig) isdq, 
        nvl(c.iskq,0)/power(10,:nBaseValDig) iskq, 
        nvl(b.dosq,0)/power(10,:nBaseValDig) dosq, 
        nvl(b.kosq,0)/power(10,:nBaseValDig) kosq, 
        d.ostcdq/power(10,:nBaseValDig) ostcdq, 
        d.ostckq/power(10,:nBaseValDig) ostckq, 
        d.ratq/100 ratq '
.head 4 -  Set strCcyFrom = 
'  FROM tabval t, ' || 

'(' || T('SELECT a.kv,
        sum(decode(sign(decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos)), 1,0,decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos))) isdf,
        sum(decode(sign(decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos)),-1,0,decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos))) iskf, ' || 
        IifS(bFEqv, '
        sum(decode(sign(decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq)), 1,0,decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq))) isdq,
        sum(decode(sign(decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq)),-1,0,decode(s.fdat, :dDat1, s.ostq, s.ostq - s.dosq + s.kosq))) iskq ', '
        sum(decode(sign(decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos)), 1,0,decode(s.fdat, :dDat1, 
          gl.p_icurval(a.kv, s.ostf, :dDat1), 
          gl.p_icurval(a.kv, (s.ostf - s.dos + s.kos), :dDat1)))) isdq,
        sum(decode(sign(decode(s.fdat, :dDat1, s.ostf, s.ostf - s.dos + s.kos)),-1,0,decode(s.fdat, :dDat1, 
          gl.p_icurval(a.kv, s.ostf, :dDat1), 
          gl.p_icurval(a.kv, (s.ostf - s.dos + s.kos), :dDat1)))) iskq') ||  
'  FROM saldoa s, ' || strFromAdd || IifS(strFromAccF='', '', ', ' || strFromAccF) || '
  WHERE s.acc = a.acc AND 
       (a.acc,s.fdat) = (SELECT acc, max(fdat) 
           FROM saldoa 
           WHERE acc=a.acc AND fdat<=:dDat1 
           GROUP BY acc ) ' || sAccMFilter || IifS(strWhereAccF='','',' AND ' || strWhereAccF) || '
  GROUP BY a.kv') || ') c, ' || 

'(' || T('SELECT a.kv,
        sum(decode(sign(s.ostf - s.dos + s.kos), 1,0,s.ostf - s.dos + s.kos)) ostcd,
        sum(decode(sign(s.ostf - s.dos + s.kos),-1,0,s.ostf - s.dos + s.kos)) ostck,
        sum((s.ostf - s.dos + s.kos)*acrn.fprocn(a.acc,null,s.fdat)) rat, ' || 
        IifS(bFEqv, '
        sum(decode(sign(s.ostq - s.dosq + s.kosq), 1,0,s.ostq - s.dosq + s.kosq)) ostcdq,
        sum(decode(sign(s.ostq - s.dosq + s.kosq),-1,0,s.ostq - s.dosq + s.kosq)) ostckq,
        sum((s.ostq - s.dosq + s.kosq)*acrn.fprocn(a.acc,null,s.fdat)) ratq ', '
        sum(decode(sign(s.ostf - s.dos + s.kos), 1,0,
          gl.p_icurval(a.kv, s.ostf - s.dos + s.kos, :dDat2))) ostcdq,
        sum(decode(sign(s.ostf - s.dos + s.kos),-1,0,
          gl.p_icurval(a.kv, s.ostf - s.dos + s.kos,:dDat2))) ostckq,
        sum((gl.p_icurval(a.kv, s.ostf - s.dos + s.kos,s.fdat))*acrn.fprocn(a.acc,null,s.fdat)) ratq') || 
'  FROM saldoa s, ' || strFromAdd || IifS(strFromAccF='', '', ', ' || strFromAccF) || '
  WHERE s.acc = a.acc AND 
       (a.acc,s.fdat) = (SELECT acc, max(fdat) 
           FROM saldoa 
           WHERE acc=a.acc AND fdat<=:dDat2 
           GROUP BY acc ) ' || sAccMFilter || IifS(strWhereAccF='', '', ' AND ' || strWhereAccF) || '
  GROUP BY a.kv') || ') d, ' || 

'(' || T('SELECT a.kv, 
        sum(decode(s.fdat, B.fdat, s.dos, 0)) dos, 
        sum(decode(s.fdat, B.fdat, s.kos, 0)) kos, ' || 
        IifS(bFEqv, '
        sum(decode(s.fdat, B.fdat, s.dosq, 0)) dosq, 
        sum(decode(s.fdat, B.fdat, s.kosq, 0)) kosq ', '
        sum(decode(s.fdat, B.fdat, gl.p_icurval(a.kv, s.dos,s.fdat), 0)) dosq, 
        sum(decode(s.fdat, B.fdat, gl.p_icurval(a.kv, s.kos,s.fdat), 0)) kosq') ||
'  FROM ' || strFromAdd || ', saldoa s, fdat B ' || IifS(strFromAccF='', '', ', ' || strFromAccF) || '
  WHERE a.acc=s.acc AND 
       (a.acc,s.fdat) = (SELECT c.acc, max(c.fdat) 
           FROM saldoa c 
           WHERE a.acc=c.acc AND c.fdat<= B.fdat 
           GROUP BY c.acc) AND 
        b.fdat>=:dDat1 AND b.fdat<=:dDat2 ' || sAccMFilter || IifS(strWhereAccF='','',' AND ' || strWhereAccF) || ' 
  GROUP BY a.kv') || ') b '
.head 4 -  Set strCcyWhere = ' WHERE t.kv=c.kv(+) AND t.kv=d.kv AND t.kv=b.kv(+) '
.head 4 -  Set strCcySql = strCcySql || '
 INTO :tbl_CcySummarise.colKV,     :tbl_CcySummarise.colCcy,    :tbl_CcySummarise.colDig,  :tbl_CcySummarise.strBVal,  
      :tbl_CcySummarise.colISDf,   :tbl_CcySummarise.colISKf,   :tbl_CcySummarise.colDOSf, :tbl_CcySummarise.colKOSf,   
      :tbl_CcySummarise.colOSTCDf, :tbl_CcySummarise.colOSTCKf, :tbl_CcySummarise.colSumOstRat, 
      :tbl_CcySummarise.colISDQ,   :tbl_CcySummarise.colISKQ,   :tbl_CcySummarise.colDOSQ, :tbl_CcySummarise.colKOSQ, 
      :tbl_CcySummarise.colOSTCDQ, :tbl_CcySummarise.colOSTCKQ, :tbl_CcySummarise.colSumOstqRat ' || 
strCcyFrom || strCcyWhere || ' ORDER BY 2, 1 '
.head 4 -  !
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig = 4
.head 4 -  !
.head 4 -  Call SalTblGetColumnTitle(colISD,  sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colISDf, sTmp)
.head 4 -  Call SalTblGetColumnTitle(colISK, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colISKf,sTmp)
.head 4 -  Call SalTblGetColumnTitle(colDOS, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colDOSf,sTmp)
.head 4 -  Call SalTblGetColumnTitle(colKOS, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colKOSf, sTmp)
.head 4 -  Call SalTblGetColumnTitle(colOSTCD, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colOSTCDf, sTmp)
.head 4 -  Call SalTblGetColumnTitle(colOSTCK, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colOSTCKf, sTmp)
.head 4 -  !
.head 4 -  Set tbl_CcySummarise.nFlags = GT_ReadOnly
.head 4 -  Set tbl_CcySummarise.strPrintFileName = 'CCYSUM.TBL'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  ! == Обнуление итогов перед населением таблицы
.head 4 -  Set nSumISD = 0
.head 4 -  Set nSumISK = 0
.head 4 -  Set nSumDOS = 0
.head 4 -  Set nSumKOS = 0
.head 4 -  Set nSumOSTCD = 0
.head 4 -  Set nSumOSTCK = 0
.head 4 -  Set nSumOstqRat = 0
.head 4 -  ! == Население таблицы
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(), strCcySql, TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 4 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow( hWndForm, TBL_MinSplitRow ))
.head 4 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 4 -  ! Экв.
.head 4 -  Set colCcy = CurrentLangTable.GetAtomTitle('tbl_CcySummarise.cTEqv')
.head 4 -  Set colISD = Dig4(SalNumberAbs(nSumISD), 2, nMaxDig)
.head 4 -  Set colISK = Dig4(SalNumberAbs(nSumISK), 2, nMaxDig)
.head 4 -  Set colDOS = Dig4(SalNumberAbs(nSumDOS), 2, nMaxDig)
.head 4 -  Set colKOS = Dig4(SalNumberAbs(nSumKOS), 2, nMaxDig)
.head 4 -  Set colOSTCD = Dig4(SalNumberAbs(nSumOSTCD), 2, nMaxDig)
.head 4 -  Set colOSTCK = Dig4(SalNumberAbs(nSumOSTCK), 2, nMaxDig)
.head 4 +  If nSumOSTCD + nSumOSTCK = 0
.head 5 -  Set nRat = 0
.head 4 +  Else
.head 5 -  Set nRat = nSumOstqRat / (nSumOSTCD + nSumOSTCK)
.head 4 -  Set colRAT = SalNumberToStrX(Abs(nRat), 4)
.head 4 -  ! числовые колонки для печати таблицы
.head 4 -  Set colISDf = Abs(nSumISD)
.head 4 -  Set colISKf = Abs(nSumISK)
.head 4 -  Set colDOSf = Abs(nSumDOS)
.head 4 -  Set colKOSf = Abs(nSumKOS)
.head 4 -  Set colOSTCDf = Abs(nSumOSTCD)
.head 4 -  Set colOSTCKf = Abs(nSumOSTCK)
.head 4 -  ! == Красим итоги
.head 4 -  Call SetOSColorRow(nSumISD, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISD), COL_GetID))
.head 4 -  Call SetOSColorRow(nSumISK, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISK), COL_GetID))
.head 4 -  Call SetOSColorRow(nSumOSTCD, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCD), COL_GetID))
.head 4 -  Call SetOSColorRow(nSumOSTCK, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCK), COL_GetID))
.head 4 -  !
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call SetOSColorRow(colISDf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISD), COL_GetID))
.head 4 -  Call SetOSColorRow(colISKf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colISK), COL_GetID))
.head 4 -  Call SetOSColorRow(colOSTCDf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCD), COL_GetID))
.head 4 -  Call SetOSColorRow(colOSTCKf, SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colOSTCK), COL_GetID))
.head 4 -  !
.head 4 -  Set nSumISD = nSumISD + colISDQ
.head 4 -  Set nSumISK = nSumISK + colISKQ
.head 4 -  Set nSumDOS = nSumDOS + colDOSQ
.head 4 -  Set nSumKOS = nSumKOS + colKOSQ
.head 4 -  Set nSumOSTCD = nSumOSTCD + colOSTCDQ
.head 4 -  Set nSumOSTCK = nSumOSTCK + colOSTCKQ
.head 4 -  Set nSumOstqRat = nSumOstqRat + colSumOstqRat
.head 4 -  ! проверка на 3 знака
.head 4 -  Set colISD  = Dig4(SalNumberAbs(colISDf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colISK  = Dig4(SalNumberAbs(colISKf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colDOS  = Dig4(colDOSf*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colKOS  = Dig4(colKOSf*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colOSTCD= Dig4(SalNumberAbs(colOSTCDf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 -  Set colOSTCK= Dig4(SalNumberAbs(colOSTCKf)*SalNumberPower(10,colDig)/100, colDig, nMaxDig)
.head 4 +  If colOSTCDf + colOSTCKf = 0
.head 5 -  Set nRat = 0
.head 4 +  Else
.head 5 -  Set nRat = colSumOstRat / (colOSTCDf + colOSTCKf)
.head 4 -  Set colRAT = SalNumberToStrX(nRat, 4)
.head 4 -  ! числовые колонки для печати таблицы
.head 4 -  Set colISDf  = Abs(colISDf)
.head 4 -  Set colISKf  = Abs(colISKf)
.head 4 -  Set colDOSf  = Abs(colDOSf)
.head 4 -  Set colKOSf  = Abs(colKOSf)
.head 4 -  Set colOSTCDf= Abs(colOSTCDf)
.head 4 -  Set colOSTCKf= Abs(colOSTCKf)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 -  ! сортировка строковых столбцов по числовым
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnID(colISD), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnPos(colISDf), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnID(colISK), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnPos(colISKf), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnID(colDOS), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnPos(colDOSf), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnID(colKOS), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnPos(colKOSf), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnID(colOSTCD), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnPos(colOSTCDf), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnID(colOSTCK), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_CcySummarise, SalTblQueryColumnPos(colOSTCKf), COL_GetID))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 4 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
.head 4 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_Print
.head 4 -  ! Для печати открываем колонки с настоящей суммой (с -/+)
.head 4 -  Call SalShowWindow(colISDf)
.head 4 -  Call SalShowWindow(colISKf)
.head 4 -  Call SalShowWindow(colDOSf)
.head 4 -  Call SalShowWindow(colKOSf)
.head 4 -  Call SalShowWindow(colOSTCDf)
.head 4 -  Call SalShowWindow(colOSTCKf)
.head 4 -  Call SalHideWindow(colISD)
.head 4 -  Call SalHideWindow(colISK)
.head 4 -  Call SalHideWindow(colDOS)
.head 4 -  Call SalHideWindow(colKOS)
.head 4 -  Call SalHideWindow(colOSTCD)
.head 4 -  Call SalHideWindow(colOSTCK)
.head 4 -  Call SalTblQueryColumnWidth(colISD,  nTmp)
.head 4 -  Call SalTblSetColumnWidth(colISDf,   nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colISK, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colISKf,  nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colDOS, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colDOSf,  nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colKOS, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colKOSf,  nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colOSTCD, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colOSTCDf,  nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colOSTCK, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colOSTCKf,  nTmp)
.head 4 -  ! Печать таблицы
.head 4 -  Call SalSendClassMessage(UM_Print, 0, 0)
.head 4 -  ! Прячем числовые колонки, открываем строковые
.head 4 -  Call SalHideWindow(colISDf)
.head 4 -  Call SalHideWindow(colISKf)
.head 4 -  Call SalHideWindow(colDOSf)
.head 4 -  Call SalHideWindow(colKOSf)
.head 4 -  Call SalHideWindow(colOSTCDf)
.head 4 -  Call SalHideWindow(colOSTCKf)
.head 4 -  Call SalShowWindow(colISD)
.head 4 -  Call SalShowWindow(colISK)
.head 4 -  Call SalShowWindow(colDOS)
.head 4 -  Call SalShowWindow(colKOS)
.head 4 -  Call SalShowWindow(colOSTCD)
.head 4 -  Call SalShowWindow(colOSTCK)
.head 1 +  Table Window: tbl_Acc_Sal_Day
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 3000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Просмотр сальдовки по счету за предыдущие банковские дни
.head 2 +  Named Menus
.head 3 +  Menu: menuSaldo
.head 4 -  Resource Id: 44011
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Popup Menu: За вы&браный Банковский День
.head 5 -  Resource Id: 44012
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Документы по счету В&НУТРЕННИЕ и НАЧ.МЕЖБАНК...
.head 6 -  Resource Id: 44013
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Set ss = " a.ref in 
( SELECT distinct ref 
    FROM opldok
   WHERE tt NOT IN ('R01','D01')
     AND acc  = " || Str(nAcc) || "
     AND fdat = to_date('" || SalFmtFormatDateTime(colFdat, 'dd.MM.yyyy') || "', 'dd.MM.yyyy'))"
.head 8 -  Call DocViewListInt(hWndMDI, ss, "Документы Внутр. и Нач.Межбанковские " || strNls || "/" || strISOCur || " за " || SalFmtFormatDateTime(colFdat,"dd/MM/yyyy"))
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Документы по счету &ОТВ.МЕЖБАНК...
.head 6 -  Resource Id: 44014
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Set ss = " a.ref in
( SELECT distinct ref
    FROM opldok
   WHERE tt IN ('R01','D01')
     AND acc  = " || Str(nAcc) || "
     AND fdat = to_date('" || SalFmtFormatDateTime(colFdat, 'dd.MM.yyyy') || "', 'dd.MM.yyyy'))"
.head 8 -  Call DocViewList(hWndMDI, ss, "Межбанковские поступления за " || SalFmtFormatDateTime(colFdat,ddMMyyyy()))
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: В&ЫПИСКА по счету...
.head 6 -  Resource Id: 44015
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 +  If nAcc
.head 9 -  Call ShowTurnForAccount(nAcc, SalFmtFormatDateTime(colFdat, 'MM/dd/yyyy'))
.head 8 +  Else
.head 9 -  Call ShowTurnForAccountHist(nAcc, sNls, nKv, SalFmtFormatDateTime(colFdat, 'MM/dd/yyyy'))  ! (Mik-Hist)
.head 6 -  Menu Item Name:
.head 4 +  Popup Menu: За &ВСЕ Банковские Дни
.head 5 -  Resource Id: 44016
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Документы по счету В&НУТРЕННИЕ и НАЧ.МЕЖБАНК...
.head 6 -  Resource Id: 44017
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss = " a.ref in
(SELECT distinct ref
   FROM opldok
  WHERE tt NOT IN ('R01','D01')
    AND acc = " || Str(nAcc) || ")"
.head 7 -  Call DocViewListInt(hWndMDI, ss, "Документы Внутр. и Нач.Межбанковские " || strNls || "/" || strISOCur ||" за ВСЕ дни")
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Документы по счету &ОТВ.МЕЖБАНК...
.head 6 -  Resource Id: 44018
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss = " a.ref in
(SELECT distinct ref
   FROM opldok
  WHERE tt IN ('R01','D01')
    AND acc= " || Str(nAcc) || ")"
.head 7 -  Call DocViewList(hWndMDI, ss, "Межбанковские поступления за ВСЕ дни")
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: В&ЫПИСКА по счету...
.head 6 -  Resource Id: 44019
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call ShowTurnForAccount(nAcc, STRING_Null)
.head 6 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 44020
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.067"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, SAM_User,0,0 )
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 44021
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.95"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  5.95"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 44022
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.05"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  5.05"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 44023
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.617"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  4.617"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dat11
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.543"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If sIsUseHist = '1' AND dat11 < dtAccountsArcDate
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.dat1InArchiv')||
                   SalFmtFormatDateTime (dtAccountsArcDate,'dd/MM/yyyy'),
                   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation| MB_Ok)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Return VALIDATE_Ok
.head 4 -  Background Text: C:
.head 5 -  Resource Id: 44024
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.125"
.head 6 -  Width:  0.371"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgFrom
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dat22
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.55"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: По:
.head 5 -  Resource Id: 44025
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.986"
.head 6 -  Top:    0.125"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgTo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: _
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFdat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
движения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.271"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVx
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залишок
Вхiдний
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVxN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDeN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSKr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSKrN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIsx
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залишок
Вихiдний
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIsxN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залишок
Вхiдний (екв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Дебет (екв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSKQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Кредит (екв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIsQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залишок
Вихiдний (екв.)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: SVB  !! сумма вх бан
.head 5 -  Number: SVBQ  !! сумма вх бан (экв)
.head 5 -  Number: SVK  !! сумма вх кал
.head 5 -  Number: SVKQ  !! сумма вх кал (экв)
.head 5 -  Number: SIB  !! сумма исх бан
.head 5 -  Number: SIBQ  !! сумма исх бан (экв)
.head 5 -  Number: SIK  !! сумма исх кал
.head 5 -  Number: SIKQ  !! сумма исх кал (экв)
.head 5 -  Number: SOD  !! сумма об Д
.head 5 -  Number: SODQ  !! сумма об Д (экв)
.head 5 -  Number: SOK  !! сумма об К
.head 5 -  Number: SOKQ  !! сумма об К (экв)
.head 5 -  Number: KB   !! дней бан
.head 5 -  Number: KK   !! дней кал
.head 5 -  Number: SV  !! вх 
.head 5 -  Number: SVQ  !! вх (экв)
.head 5 -  Number: SI  !! исх 
.head 5 -  Number: SIQ  !! исх (экв)
.head 5 -  Number: OD  !!  об Д
.head 5 -  Number: ODQ  !!  об Д (экв)
.head 5 -  Number: OK  !!  об К
.head 5 -  Number: OKQ  !!  об К (экв)
.head 5 -  Number: i
.head 5 -  Date/Time: KDAT
.head 5 -  Date/Time: BDAT
.head 5 -  String: sdat11
.head 5 -  String: sdat22
.head 5 -  String: sStr
.head 4 +  Actions
.head 5 -  Set SVB  = 0
.head 5 -  Set SVBQ = 0
.head 5 -  Set SVK  = 0
.head 5 -  Set SVKQ = 0
.head 5 -  Set SIB  = 0
.head 5 -  Set SIBQ = 0
.head 5 -  Set SIK  = 0
.head 5 -  Set SIKQ = 0
.head 5 -  Set SOD  = 0
.head 5 -  Set SODQ = 0
.head 5 -  Set SOK  = 0
.head 5 -  Set SOKQ = 0
.head 5 -  Set KB = 0
.head 5 -  Set KK = 0
.head 5 -  Set ODQ  = 0
.head 5 -  Set OKQ = 0
.head 5 -  ! Set sdat11 = SalFmtFormatDateTime ( dat11, 'MM-dd-yyyy')
.head 5 -  ! Set sdat22 = SalFmtFormatDateTime ( dat22, 'MM-dd-yyyy')
.head 5 -  Call SalTblReset(hWndForm)
.head 5 -  ! проверка на 3 знака
.head 5 +  If nAcc
.head 6 +  If bFEqv
.head 7 -  Set sStr = " 
 SELECT B.FDAT,K.FDAT,
        decode(s.fdat,K.fdat,s.ostf,s.ostf-s.dos+s.kos)/100,
        decode(s.fdat,K.fdat,s.ostq,s.ostq-s.dosq+s.kosq)/100,
        decode(s.fdat,K.fdat,s.dos,0)/100, decode(s.fdat,K.fdat,s.dosq,0)/100,
        decode(s.fdat,K.fdat,s.kos,0)/100, decode(s.fdat,K.fdat,s.kosq,0)/100,
        (s.ostf-s.dos+s.kos)/100, (s.ostq-s.dosq+s.kosq)/100
 INTO :KDAT, :BDAT, :SV, :SVQ, :OD, :ODQ, :OK, :OKQ, :SI, :SIQ
 FROM saldoa s, fdat B,
     (select TO_DATE(:dat11) + (num - 1) FDAT 
      from conductor 
      where  num <= :dat22 - :dat11 + 1) K
 WHERE s.acc=:nAcc AND K.fdat=B.fdat(+) AND (s.acc,s.fdat) =
   (SELECT c.acc,max(c.fdat)  FROM saldoa c
    WHERE s.acc=c.acc AND c.fdat<=K.fdat 
    GROUP BY c.acc)
 ORDER BY 2 DESC"
.head 6 +  Else
.head 7 -  Set sStr = " 
 SELECT B.FDAT,K.FDAT,
        decode(s.fdat,K.fdat,s.ostf,s.ostf-s.dos+s.kos)/100, 
        decode(s.fdat,K.fdat,s.dos,0)/100, 
        decode(s.fdat,K.fdat,s.kos,0)/100, 
        (s.ostf-s.dos+s.kos)/100
 INTO :KDAT, :BDAT, :SV, :OD, :OK, :SI
 FROM saldoa s, fdat B,
   (select TO_DATE(:dat11) + (num - 1) FDAT 
      from conductor 
      where  num <= :dat22 - :dat11 + 1) K
 WHERE s.acc=:nAcc AND K.fdat=B.fdat(+) AND (s.acc,s.fdat) =
   (SELECT c.acc,max(c.fdat)  FROM saldoa c
    WHERE s.acc=c.acc AND c.fdat<=K.fdat 
    GROUP BY c.acc)
 ORDER BY 2 DESC"
.head 5 +  Else ! Hist
.head 6 -  Set sStr = " 
 SELECT S.FDAT,K.FDAT,
        decode(s.fdat,K.fdat,s.ost, s.ost -s.dos +s.kos) /100,
        decode(s.fdat,K.fdat,s.ostq,s.ostq-s.dosq+s.kosq)/100,
        decode(s.fdat,K.fdat,s.dos,0)/100, decode(s.fdat,K.fdat,s.dosq,0)/100,
        decode(s.fdat,K.fdat,s.kos,0)/100, decode(s.fdat,K.fdat,s.kosq,0)/100,
        (s.ost-s.dos+s.kos)/100, (s.ostq-s.dosq+s.kosq)/100
  INTO :KDAT, :BDAT, :SV, :SVQ, :OD, :ODQ, :OK, :OKQ, :SI, :SIQ
  FROM b_hist s, 
   (select TO_DATE(:dat11) + (num - 1) FDAT 
      from conductor 
      where  num <= :dat22 - :dat11 + 1) K
 WHERE s.nls=:sNls and s.kv=:nKv AND (s.nls,s.kv,s.fdat) =
   (SELECT c.nls,c.kv,max(c.fdat)  FROM b_hist c
     WHERE s.nls=c.nls AND s.kv=c.kv AND c.fdat<=K.fdat 
     GROUP BY c.nls,c.kv)
 ORDER BY 2 DESC"
.head 5 +  ! If bFEqv
.head 6 -                Set sStr = " 
 SELECT B.FDAT,K.FDAT,
        s.ostf/100, s.ostq/100,
        decode(s.fdat,K.fdat,s.dos,0)/100, decode(s.fdat,K.fdat,s.dosq,0)/100,
        decode(s.fdat,K.fdat,s.kos,0)/100, decode(s.fdat,K.fdat,s.kosq,0)/100,
        (s.ostf-s.dos+s.kos)/100, (s.ostq-s.dosq+s.kosq)/100
 INTO :KDAT, :BDAT, :SV, :SVQ, :OD, :ODQ, :OK, :OKQ, :SI, :SIQ
 FROM saldoa s, fdat B,
   (select  :sdat11  -1 + rownum FDAT 
    from banks 
    where   :sdat11  -1 + rownum <=  :sdat22   ) K
 WHERE s.acc=:nAcc AND K.fdat=B.fdat(+) AND (s.acc,s.fdat) =
   (SELECT c.acc,max(c.fdat)  FROM saldoa c
    WHERE s.acc=c.acc AND c.fdat<=K.fdat 
    GROUP BY c.acc)
 ORDER BY 2 DESC"
.head 5 +  ! Else
.head 6 -                Set sStr = " 
 SELECT B.FDAT,K.FDAT,
        s.ostf/100, 
        decode(s.fdat,K.fdat,s.dos,0)/100, 
        decode(s.fdat,K.fdat,s.kos,0)/100, 
        (s.ostf-s.dos+s.kos)/100
 INTO :KDAT, :BDAT, :SV, :OD, :OK, :SI
 FROM saldoa s, fdat B,
   (select  :sdat11  -1 + rownum FDAT 
    from banks 
    where   :sdat11  -1 + rownum <=  :sdat22   ) K
 WHERE s.acc=:nAcc AND K.fdat=B.fdat(+) AND (s.acc,s.fdat) =
   (SELECT c.acc,max(c.fdat)  FROM saldoa c
    WHERE s.acc=c.acc AND c.fdat<=K.fdat 
    GROUP BY c.acc)
 ORDER BY 2 DESC"
.head 5 +  If SqlPrepareAndExecute(hSql(), sStr)
.head 6 +  While SqlFetchNext(  hSql(), nFetchRes )
.head 7 -  Set KK = KK + 1
.head 7 -  Set SVK  = SVK  + SV
.head 7 -  Set SVKQ = SVKQ + SVQ
.head 7 -  Set SIK  = SIK  + SI
.head 7 -  Set SIKQ = SIKQ + SIQ
.head 7 +  If KDAT = BDAT
.head 8 -  Set KB = KB + 1
.head 8 -  Set SVB  = SVB  + SV
.head 8 -  Set SVBQ = SVBQ + SVQ
.head 8 -  Set SIB  = SIB  + SI
.head 8 -  Set SIBQ = SIBQ + SIQ
.head 8 +  If OD != 0 or OK != 0 or ODQ != 0 or OKQ != 0
.head 9 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow))
.head 9 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 9 -  Set SOD  = SOD  + OD
.head 9 -  Set SODQ = SODQ + ODQ
.head 9 -  Set SOK  = SOK  + OK
.head 9 -  Set SOKQ = SOKQ + OKQ
.head 9 -  Set colFdat= BDAT
.head 9 -  Set colSDeN = OD
.head 9 -  Set colSDQ  = ODQ
.head 9 -  Set colSKrN = OK
.head 9 -  Set colSKQ  = OKQ
.head 9 -  Set colIsxN = SI
.head 9 -  Set colIsQ  = SIQ
.head 9 -  Set colVxN  = SV
.head 9 -  Set colVQ   = SVQ
.head 9 -  ! проверка на 3 знака
.head 9 -  Set colVx  = Dig4(SalNumberAbs(colVxN), nDig, nDig)
.head 9 -  Set colSDe = Dig4(colSDeN, nDig, nDig)
.head 9 -  Set colSKr = Dig4(colSKrN, nDig, nDig)
.head 9 -  Set colIsx = Dig4(SalNumberAbs(colIsxN), nDig, nDig)
.head 9 -  !
.head 9 -  Call sColor()
.head 6 -  ! Итог
.head 6 -  Call SalTblDefineSplitWindow (hWndForm, 3, TRUE)
.head 6 -  Call sINS()
.head 6 -  ! Итог
.head 6 -  Set colS = CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.cTItog')
.head 6 -  Set colSDeN = SOD
.head 6 -  Set colSDQ  = SODQ
.head 6 -  Set colSKrN = SOK
.head 6 -  Set colSKQ  = SOKQ
.head 6 -  Set colVxN  = SV
.head 6 -  Set colVQ   = SVQ
.head 6 -  Set colIsxN = SV  - SOD  + SOK
.head 6 -  Set colIsQ  = SVQ - SODQ + SOKQ
.head 6 -  ! проверка на 3 знака
.head 6 -  Set colVx  = Dig4(SalNumberAbs(colVxN), nDig, nDig)
.head 6 -  Set colSDe = Dig4(colSDeN, nDig, nDig)
.head 6 -  Set colSKr = Dig4(colSKrN, nDig, nDig)
.head 6 -  Set colIsx = Dig4(SalNumberAbs(colIsxN), nDig, nDig)
.head 6 -  !
.head 6 -  Call sColor()
.head 6 -  ! Ср-Календ
.head 6 +  If KK > 0
.head 7 -  Call sINS()
.head 7 -  ! Ср-Календ/Str(KK)
.head 7 -  Set colS = CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.cTSrKalend') || '/'||Str(KK)
.head 7 -  Set colSDeN = SalNumberRound(SOD  / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colSDQ  = SalNumberRound(SODQ / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colSKrN = SalNumberRound(SOK  / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colSKQ  = SalNumberRound(SOKQ / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colIsxN = SalNumberRound(SIK  / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colIsQ  = SalNumberRound(SIKQ / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colVxN  = SalNumberRound(SVK  / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  Set colVQ   = SalNumberRound(SVKQ / KK * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 7 -  ! проверка на 3 знака
.head 7 -  Set colVx  = Dig4(SalNumberAbs(colVxN), nDig, nDig)
.head 7 -  Set colSDe = Dig4(colSDeN, nDig, nDig)
.head 7 -  Set colSKr = Dig4(colSKrN, nDig, nDig)
.head 7 -  Set colIsx = Dig4(SalNumberAbs(colIsxN), nDig, nDig)
.head 7 -  !
.head 7 -  Call sColor()
.head 7 -  ! Ср-Банк
.head 7 +  If KB>0
.head 8 -  Call sINS()
.head 8 -  ! Ср-Банк/Str(KB)
.head 8 -  Set colS = CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.cTSrBank') || '/'||Str(KB)
.head 8 -  Set colSDeN = SalNumberRound(SOD  / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colSDQ  = SalNumberRound(SODQ / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colSKrN = SalNumberRound(SOK  / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colSKQ  = SalNumberRound(SOKQ / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colIsxN = SalNumberRound(SIB  / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colIsQ  = SalNumberRound(SIBQ / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colVxN  = SalNumberRound(SVB  / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  Set colVQ   = SalNumberRound(SVBQ / KB * SalNumberPower(10,nDig)) / SalNumberPower(10,nDig)
.head 8 -  ! проверка на 3 знака
.head 8 -  Set colVx  = Dig4(SalNumberAbs(colVxN), nDig, nDig)
.head 8 -  Set colSDe = Dig4(colSDeN, nDig, nDig)
.head 8 -  Set colSKr = Dig4(colSKrN, nDig, nDig)
.head 8 -  Set colIsx = Dig4(SalNumberAbs(colIsxN), nDig, nDig)
.head 8 -  !
.head 8 -  Call sColor()
.head 3 +  Function: sColor
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblSetCellTextColor(colVx,  IifN(colVxN<0,COLOR_Red,IifN(colVxN>0,COLOR_DarkBlue,COLOR_Black)),FALSE )
.head 5 -  Call SalTblSetCellTextColor(colVxN, IifN(colVxN<0,COLOR_Red,IifN(colVxN>0,COLOR_DarkBlue,COLOR_Black)),FALSE )
.head 5 -  Call SalTblSetCellTextColor(colIsx, IifN(colIsxN<0,COLOR_Red,IifN(colIsxN>0,COLOR_DarkBlue,COLOR_Black)),FALSE )
.head 5 -  Call SalTblSetCellTextColor(colIsxN,IifN(colIsxN<0,COLOR_Red,IifN(colIsxN>0,COLOR_DarkBlue,COLOR_Black)),FALSE )
.head 5 -  !
.head 5 -  Call SalTblSetCellTextColor(colVQ, IifN(colVQ<0,COLOR_Red,IifN(colVQ>0,COLOR_DarkBlue,COLOR_Black)),FALSE )
.head 5 -  Call SalTblSetCellTextColor(colIsQ,IifN(colIsQ<0,COLOR_Red,IifN(colIsQ>0,COLOR_DarkBlue,COLOR_Black)),FALSE )
.head 5 -  ! Set colVxN  = SalNumberAbs(colVxN)
.head 5 -  ! Set colIsxN = SalNumberAbs(colIsxN)
.head 5 -  Set colVQ  = SalNumberAbs(colVQ)
.head 5 -  Set colIsQ = SalNumberAbs(colIsQ)
.head 3 +  Function: sINS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MinRow )
.head 5 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE )
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 2 +  Window Parameters
.head 3 -  Number: nAcc
.head 3 -  String: sNls
.head 3 -  Number: nKv
.head 3 -  Date/Time: Pdat11
.head 3 -  Date/Time: Pdat22
.head 2 +  Window Variables
.head 3 -  String: strISOCur
.head 3 -  String: strNls
.head 3 -  String: titl
.head 3 -  String: strKv
.head 3 -  String: ss
.head 3 -  Number: n0
.head 3 -  Number: n1
.head 3 -  Number: n2
.head 3 -  Number: n3
.head 3 -  Number: n4
.head 3 -  Number: n5
.head 3 -  Number: n6
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  : cSMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  Number: nDig
.head 3 -  Boolean: bFEqv
.head 3 -  Boolean: bOk
.head 3 -  String: sIsUseHist        ! Используется или нет архивирование счетов
.head 3 -  Date/Time: dtAccountsArcDate ! последняя дата архивирования счетов
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! История
.head 4 -  Call cSMenu.Init(hWndForm, 'menuSaldo', CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.cTHistory'))
.head 4 -  Set bOk = FALSE
.head 4 +  If nAcc
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, t.lcv, a.kv, t.dig
   INTO :strNls,:strISOCur,:strKv, :nDig
   FROM accounts a,tabval t
  WHERE a.kv=t.kv AND a.acc=:nAcc")
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set bOk=TRUE
.head 4 +  Else !  HIST
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, t.lcv, a.kv, t.dig
   INTO :strNls, :strISOCur, :strKv, :nDig
   FROM a_hist a,tabval t
  WHERE a.kv=t.kv AND a.nls=:sNls AND a.kv=:nKv ")
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set bOk=TRUE
.head 4 -  ! История счета N strNls (strISOCur)
.head 4 -  Set titl = CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.cTWndTitle') || ' N ' || strNls || ' (' || strISOCur || ')'
.head 4 -  Call SalSetWindowText(hWndForm, titl)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set tbl_Acc_Sal_Day.strPrintFileName = Subs(strNls,1,8)||'.hst'
.head 4 -  !
.head 4 +  If Pdat11 = DATETIME_Null
.head 5 -  Set dat11 = GetBankDate()-30
.head 5 -  Set dat22 = GetBankDate()
.head 4 +  Else
.head 5 -  Set dat11 = Pdat11
.head 5 -  Set dat22 = Pdat22
.head 4 -  ! Показывать или не показывать эквиваленты по валюте
.head 4 +  If not(GetGlobalOption('EQV')='YES') OR strISOCur = 'UAH'
.head 5 -  Set bFEqv = FALSE
.head 5 -  Call SalHideWindow(colVQ)
.head 5 -  Call SalHideWindow(colSDQ)
.head 5 -  Call SalHideWindow(colSKQ)
.head 5 -  Call SalHideWindow(colIsQ)
.head 4 +  Else
.head 5 -  Set bFEqv = TRUE
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 +  If bOk
.head 5 -  Call SalSendMsg(hWndForm, SAM_User, 0, 0)
.head 4 -  !
.head 4 -  ! Используется ли архивация данных 
.head 4 -  Set sIsUseHist = GetGlobalOption('USEHIST')
.head 4 +  If sIsUseHist = '1'
.head 5 +  If SqlPrepareAndExecute(hSql(),
"select bars_arc.get_last_archived(mod_code) 
   into :dtAccountsArcDate 
   from v_arc_modules
  where globalmod_code = 'ACC' ")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set sIsUseHist = '0'
.head 5 +  Else
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.cTHistory'),
                   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation| MB_Ok)
.head 4 -  !
.head 4 -  Call SalTblGetColumnTitle(colVx,  sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colVxN, sTmp)
.head 4 -  Call SalTblGetColumnTitle(colSDe, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colSDeN,sTmp)
.head 4 -  Call SalTblGetColumnTitle(colSKr, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colSKrN,sTmp)
.head 4 -  Call SalTblGetColumnTitle(colIsx, sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colIsxN, sTmp)
.head 4 -  Call SalFmtSetPicture(colVxN,  '# ##0' || Subs(Str(1.1),2,1) || SalStrRepeatX('0', nDig))
.head 4 -  Call SalFmtSetPicture(colSDeN, '# ##0' || Subs(Str(1.1),2,1) || SalStrRepeatX('0', nDig))
.head 4 -  Call SalFmtSetPicture(colSKrN, '# ##0' || Subs(Str(1.1),2,1) || SalStrRepeatX('0', nDig))
.head 4 -  Call SalFmtSetPicture(colIsxN, '# ##0' || Subs(Str(1.1),2,1) || SalStrRepeatX('0', nDig))
.head 3 +  On SAM_Activate
.head 4 -  Call cSMenu.Enable(wParam)
.head 3 +  On SAM_User
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  ! История счета N strNls (strISOCur) с dat11 по dat22
.head 4 -  Call SalSetWindowText(hWndForm, titl || ' ' || 
     CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.bgFrom') || ' ' || SalFmtFormatDateTime(dat11, 'dd/MM/yyyy') || ' ' || 
     CurrentLangTable.GetAtomTitle('tbl_Acc_Sal_Day.bgTo')   || ' ' || SalFmtFormatDateTime(dat22, 'dd/MM/yyyy'))
.head 4 -  Call NASELENIE()
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_DoubleClick
.head 4 -  ! Call ShowTurnForAccount( nAcc, SalFmtFormatDateTime ( colFdat,'MM/dd/yyyy'))
.head 4 +  If nAcc
.head 5 -  Call ShowTurnForAccount(nAcc, SalFmtFormatDateTime(colFdat,'MM/dd/yyyy'))
.head 4 +  Else
.head 5 -  Call ShowTurnForAccountHist(nAcc, sNls, nKv, SalFmtFormatDateTime(colFdat,'MM/dd/yyyy'))  ! (Mik-Hist)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call cSMenu.ShowMenu(wParam, lParam)
.head 3 +  On UM_Print
.head 4 -  ! Для печати открываем колонки с настоящей суммой (с -/+)
.head 4 -  Call SalShowWindow(colVxN)
.head 4 -  Call SalShowWindow(colSDeN)
.head 4 -  Call SalShowWindow(colSKrN)
.head 4 -  Call SalShowWindow(colIsxN)
.head 4 -  Call SalHideWindow(colVx)
.head 4 -  Call SalHideWindow(colSDe)
.head 4 -  Call SalHideWindow(colSKr)
.head 4 -  Call SalHideWindow(colIsx)
.head 4 -  Call SalTblQueryColumnWidth(colVx,  nTmp)
.head 4 -  Call SalTblSetColumnWidth(colVxN,   nTmp+0.05)
.head 4 -  Call SalTblQueryColumnWidth(colSDe, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colSDeN,  nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colSKr, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colSKrN,  nTmp)
.head 4 -  Call SalTblQueryColumnWidth(colIsx, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colIsxN,  nTmp+0.05)
.head 4 -  ! Печать таблицы
.head 4 -  Call SalSendClassMessage(UM_Print, 0, 0)
.head 4 -  ! Прячем числовые колонки, открываем строковые
.head 4 -  Call SalHideWindow(colVxN)
.head 4 -  Call SalHideWindow(colSDeN)
.head 4 -  Call SalHideWindow(colSKrN)
.head 4 -  Call SalHideWindow(colIsxN)
.head 4 -  Call SalShowWindow(colVx)
.head 4 -  Call SalShowWindow(colSDe)
.head 4 -  Call SalShowWindow(colSKr)
.head 4 -  Call SalShowWindow(colIsx)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 4 -  Call cSMenu.Kill()
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 +  Table Window: tbl_AccTurn4Day
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 64000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Просмотр лицевого по счету за банковский день
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.617"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 44026
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.217"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  7.217"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 44027
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.033"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  5.033"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 44028
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  8.217"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  8.217"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Picture: picLegend
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.048"
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.345"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  File Name: \Bars98\RESOURCE\BMP\LEGEND.BMP
.head 5 -  Storage: Internal
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Fit: Scale
.head 5 -  Scaling
.head 6 -  Width:  100
.head 6 -  Height:  100
.head 5 -  Corners: Square
.head 5 -  Border Style: No Border
.head 5 -  Border Thickness: 1
.head 5 -  Tile To Parent? No
.head 5 -  Border Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Return XSalTooltipSetText( lParam, 'Легенда...' )
.head 7 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cBTipLegend') )
.head 6 +  On SAM_Click
.head 7 +  If hWinLegend 
.head 8 -  Call SalDestroyWindow( hWinLegend )
.head 8 -  Set hWinLegend = hWndNULL
.head 7 +  Else
.head 8 -  Set hWinLegend = SalCreateWindowEx( win_StmtLegend, hWndForm, 0, 0, 2.5, 0.87, CREATE_AsChild | CREATE_Border)
.head 4 -  Line
.head 5 -  Resource Id: 44029
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.533"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  0.533"
.head 6 -  End Y:  0.607"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfDate1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.65"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.274"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDate2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.117"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.274"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Option Button: obHide
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docs01.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 +  If bShowBookedRecord
.head 8 -  ! Set strButtonTip = 'Спрятать плановые обороты'
.head 8 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cBTipHide') )
.head 7 +  Else
.head 8 -  ! Set strButtonTip = 'Показать плановые обороты'
.head 8 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cBTipShow') )
.head 6 +  On SAM_Click
.head 7 -  Set bShowBookedRecord = NOT MyValue
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 2 +  Contents
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Оп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 9
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRef
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 9
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSDeN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSKr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSKrN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSQDe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Дебет (екв)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSQKr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороти
Кредит (екв)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Комментарий
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sos
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVdat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валютирования
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TXT
.head 5 -  String: TT
.head 5 -  Number: Ref
.head 5 -  Number: nSos
.head 5 -  Date/Time: Vdat
.head 5 -  String: sSql
.head 5 -  String: sSql2
.head 5 -  Number: nParentAcc
.head 5 -  String: sStrPopulate
.head 5 -  Number: nSd
.head 5 -  Number: nSQd
.head 5 -  Number: nSk
.head 5 -  Number: nSQk
.head 4 +  Actions
.head 5 -  Set nParentAcc = 0
.head 5 -  ! Проверка: счет родительский?
.head 5 +  If nAcc
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select count(*) into :nParentAcc from accounts where accc = :nAcc")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  !
.head 5 -  ! Фактические платежи
.head 5 -  Set nSos = 0
.head 5 +  If nAcc
.head 6 +  If bAccTurnK
.head 7 -  Set sSql =
"SELECT o.tt, o.ref, o.s, o.sq, o.dk, " ||
        IifS(bAccTurnN=TRUE, "p.nazn", "decode(o.tt,p.tt,NVL(p.nazn,o.txt),o.txt)") || ", o.fdat
   INTO :TT, :Ref, :nS, :nSQ, :nDk, :TXT, :Vdat
   FROM opldok o, oper p
  WHERE acc=:nAcc AND o.ref=p.ref AND o.sos=5 AND o.fdat BETWEEN :dfDate1 AND :dfDate2
  ORDER BY " || sOrderBy
.head 6 +  Else
.head 7 -  Set sSql=
"SELECT o.tt, o.ref, o.s, o.sq, o.dk, " ||
        IifS(bAccTurnN=TRUE, "p.nazn", "decode(o.tt,p.tt,NVL(p.nazn,o.txt),o.txt)") || ", o.fdat 
   INTO :TT, :Ref, :nS, :nSQ, :nDk, :TXT, :Vdat 
   FROM (SELECT o.REF, o.TT, o.DK, o.ACC, o.FDAT, o.S, o.SQ, o.TXT, o.STMT, o.SOS 
           FROM opldok o, accounts a 
          WHERE o.acc=a.acc AND o.acc=:nAcc AND o.sos=5
            AND o.fdat BETWEEN :dfDate1 AND :dfDate2 " || IifS(nParentAcc=0, "", "
          union all 
         SELECT o.REF, o.TT, o.DK, a.ACCC, o.FDAT, o.S, o.SQ, o.TXT, o.STMT, o.SOS 
           FROM opldok o, accounts a 
          WHERE o.acc=a.acc AND a.accc is not null AND a.accc=:nAcc AND o.sos=5
            AND o.fdat BETWEEN :dfDate1 AND :dfDate2") || "
        ) o, oper p 
  WHERE o.ref=p.ref AND o.fdat BETWEEN :dfDate1 AND :dfDate2 
  ORDER BY " || sOrderBy
.head 5 +  Else
.head 6 -  Set sSql=
"SELECT o.tt,o.ref,o.s,o.sq,DECODE(o.nlsa,:sNls,0,1) dk,
        decode(o.tt,p.tt,p.nazn,(SELECT name from tts where tt=o.tt)),o.fdat 
    INTO :TT,:Ref,:nS,:nSQ,:nDk,:TXT,:Vdat
    FROM t_hist o,d_hist p 
  WHERE (o.nlsa=:sNls OR o.nlsb=:sNls) AND o.kv=980 AND o.ref=p.ref AND o.fdat BETWEEN :dfDate1 AND :dfDate2 
  ORDER BY " || sOrderBy
.head 5 +  If SqlPrepareAndExecute(hSql(), sSql)
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow))
.head 7 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 -  Set colTT   = TT
.head 7 -  Set colTXT  = TXT
.head 7 -  Set colRef  = Ref
.head 7 -  Set colVdat = Vdat
.head 7 -  Set nSos = nSos + 1
.head 7 +  If nDk = 0
.head 8 -  Set colSDeN = nS/100
.head 8 -  Set colSQDe = nSQ/100
.head 8 -  Set colSDe  = Dig4(colSDeN, nDig, nDig)
.head 7 +  Else
.head 8 -  Set colSKrN = nS/100
.head 8 -  Set colSQKr = nSQ/100
.head 8 -  Set colSKr  = Dig4(colSKrN, nDig, nDig)
.head 5 -  ! Плановые и форвардные 
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 5 +  If NOT obHide
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, SalNumberMax(17 - nSos, 3), TRUE)
.head 6 +  If bAccTurnK
.head 7 -  Set sSql2 =
"SELECT /*+ ORDERED INDEX(o XAK_REF_OPLDOK) */
        '?'||o.tt, o.ref, o.s, o.sq, o.dk," ||
        IifS(bAccTurnN=TRUE, "p.nazn", "decode(o.tt,p.tt,NVL(p.nazn,o.txt),o.txt)") || ", o.fdat, o.sos
   INTO :TT, :Ref, :nS, :nSQ, :nDk, :TXT, :Vdat, :nSos
   FROM ref_que q, opldok o, oper p
  WHERE o.acc = :nAcc
    AND o.ref = p.ref
    AND o.ref = q.ref
 ORDER BY " || sOrderBy
.head 6 +  Else
.head 7 -  Set sSql2 = 
"SELECT '?'||o.tt, o.ref, o.s, o.sq, o.dk, " ||
        IifS(bAccTurnN=TRUE, "p.nazn", "decode(o.tt,p.tt,NVL(p.nazn,o.txt),o.txt)") || ", o.fdat, o.sos 
   INTO :TT, :Ref, :nS, :nSQ, :nDk, :TXT, :Vdat, :nSos 
   FROM oper p,
        (SELECT " || IifS(nParentAcc=0, "", "/*+ ORDERED INDEX(o XAK_REF_OPLDOK)*/") || "
                o.REF, o.TT, o.DK, o.ACC, o.FDAT, o.S, o.SQ, o.TXT, o.STMT, o.SOS
           FROM ref_que q, opldok o, accounts a
          WHERE q.ref=o.ref AND o.acc=a.acc AND o.acc=:nAcc" || IifS(nParentAcc=0, "", "
          union all
         SELECT /*+ ORDERED INDEX(o XAK_REF_OPLDOK)*/
                o.REF, o.TT, o.DK, a.ACCC, o.FDAT, o.S, o.SQ, o.TXT, o.STMT, o.SOS
           FROM ref_que q, opldok o, accounts a
          WHERE q.ref=o.ref AND o.acc=a.acc AND a.accc is not null AND a.accc=:nAcc") || "
        ) o 
  WHERE o.ref = p.ref
  ORDER BY " || sOrderBy
.head 6 +  If SqlPrepareAndExecute(hSql(), sSql2)
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 8 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 8 -  Set colTT   = TT
.head 8 -  Set colTXT  = TXT
.head 8 -  Set colRef  = Ref
.head 8 -  Set colVdat = Vdat
.head 8 +  If nDk = 0
.head 9 -  Set colSDeN = nS/100
.head 9 -  Set colSQDe = nSQ/100
.head 9 -  Set colSDe  = Dig4(colSDeN, nDig, nDig)
.head 8 +  Else
.head 9 -  Set colSKrN = nS/100
.head 9 -  Set colSQKr = nSQ/100
.head 9 -  Set colSKr  = Dig4(colSKrN, nDig, nDig)
.head 8 +  If nSos = 3
.head 9 -  Call SetTblRowColor(hWndForm, COLOR_Blue)
.head 8 +  Else If nSos = 1
.head 9 -  Call SetTblRowColor(hWndForm, COLOR_DarkGreen)
.head 2 +  Window Parameters
.head 3 -  Number: nAcc
.head 3 -  String: sNls
.head 3 -  Number: nKv
.head 3 -  String: sDat   !! MM-dd-yyyy
.head 2 +  Window Variables
.head 3 -  Number: nStart
.head 3 -  String: strTxt
.head 3 -  Boolean: bAccTurnK	! Показывать выписку по счету по OPLDOK
.head 3 -  Boolean: bAccTurnN	! В выписке по счету в поле "Комментарий" всегда показываеть назначение платежа
.head 3 -  !
.head 3 -  String: strISOCur
.head 3 -  String: strNls
.head 3 -  String: strKv
.head 3 -  Number: nS
.head 3 -  Number: nSQ
.head 3 -  Number: nDk
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  Number: nSumDos
.head 3 -  Number: nSumKos
.head 3 -  Number: nClearOstf
.head 3 -  !
.head 3 -  String: strTitleDate
.head 3 -  !
.head 3 -  String: strMonth[12]
.head 3 -  String: strWeekDays[7]
.head 3 -  !
.head 3 -  Number: nDig
.head 3 -  Boolean: bFEqv
.head 3 -  Number: nOstQI
.head 3 -  Number: nOstQO
.head 3 -  Number: nObD
.head 3 -  Number: nObK
.head 3 -  String: sOrderBy
.head 3 -  Number: nOrderBy
.head 3 -  Number: nLastSortRow
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 3 -  Window Handle: hColumn
.head 3 -  Window Handle: hWinLegend
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 +  If nAcc
.head 5 -  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, t.lcv, a.kv, t.dig
   INTO :strNls, :strISOCur, :strKv, :nDig
   FROM accounts a,tabval t
  WHERE a.kv=t.kv and a.acc=:nAcc")
and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else !  HIST
.head 5 -  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, t.lcv, a.kv, t.dig
   INTO :strNls,:strISOCur,:strKv, :nDig
   FROM a_hist a,tabval t
  WHERE a.kv=t.kv AND a.nls=:sNls AND a.kv=:nKv ")
and SqlFetchNext(hSql(), nFetchRes)
.head 4 -  ! Выписка по счету N strNls (strISOCur)
.head 4 -  Call SalSetWindowText(hWndForm, 
     CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cTWndTitle') || ' N ' || strNls || ' (' || strISOCur || ') ' )
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SuppressLastColLine, TRUE)
.head 4 -  Call GetMonthArray(strMonth)
.head 4 -  Call GetWeekDayArray(strWeekDays)
.head 4 -  !
.head 4 +  If sDat
.head 5 -  Set dfDate1 = SalFmtFormatStrDateTime(sDat, 'MM/dd/yyyy')
.head 4 +  Else
.head 5 -  Set dfDate1 = GetBankDate()
.head 4 -  Set dfDate2 = dfDate1
.head 4 -  !
.head 4 -  Set bAccTurnK = GetGlobalOption('ACCTURNK') = '1'
.head 4 -  Set bAccTurnN = GetGlobalOption('ACCTURNN') = '1'
.head 4 -  Set obHide = NOT bShowBookedRecord
.head 4 -  !
.head 4 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Set nLastSortRow = SalWindowHandleToNumber(tbl_AccTurn4Day.colVdat)
.head 4 -  Set nOrderBy = 1
.head 4 -  Set sOrderBy = " o.dk, o.fdat, o.s"
.head 4 -  !
.head 4 -  ! Показывать или не показывать эквиваленты по валюте
.head 4 +  If not (GetGlobalOption('EQV') = 'YES') OR strISOCur = 'UAH'
.head 5 -  Set bFEqv = FALSE
.head 5 -  Call SalHideWindow(colSQDe)
.head 5 -  Call SalHideWindow(colSQKr)
.head 4 +  Else
.head 5 -  Set bFEqv = TRUE
.head 4 -  Call SalTblGetColumnTitle(colSDe,  sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colSDeN, sTmp)
.head 4 -  Call SalTblGetColumnTitle(colSKr,  sTmp, 100)
.head 4 -  Call SalTblSetColumnTitle(colSKrN, sTmp)
.head 4 -  Call SalFmtSetPicture(colSDeN, '# ##0' || Subs(Str(1.1),2,1) || SalStrRepeatX('0', nDig))
.head 4 -  Call SalFmtSetPicture(colSKrN, '# ##0' || Subs(Str(1.1),2,1) || SalStrRepeatX('0', nDig))
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblReset(hWndForm)
.head 4 -  !
.head 4 +  If bFEqv
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT ostq+dosq-kosq INTO :nOstQI FROM salq
 WHERE acc=:nAcc AND fdat=(select max(fdat) from fdat where fdat<=:dfDate1)" )
.head 6 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set nOstQI = 0
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT sum(dosq), sum(kosq) INTO :nObD, :nObK FROM salq
 WHERE acc=:nAcc AND fdat>=:dfDate1 AND fdat<=:dfDate2" )
.head 6 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set nObD = 0
.head 7 -  Set nObK = 0
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT ostq INTO :nOstQO FROM salq
 WHERE acc=:nAcc AND fdat=(select max(fdat) from fdat where fdat<=:dfDate2)" )
.head 6 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set nOstQO = 0
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), 
"SELECT fost_h(:nAcc,:dfDate1) + fdos(:nAcc,:dfDate1,:dfDate1) - fkos(:nAcc,:dfDate1,:dfDate1),
        fdos(:nAcc,:dfDate1,:dfDate2), fkos(:nAcc,:dfDate1,:dfDate2), fost_h(:nAcc,:dfDate2) 
   INTO :nS, :nSumDos, :nSumKos, :nDk 
   FROM dual")
.head 5 +  If SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  ! Входящее сальдо
.head 6 -  Set colTXT = CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cTVx')
.head 6 -  Set colVdat = dfDate1
.head 6 +  If nS > 0
.head 7 -  Set colSKrN = nS/100
.head 7 -  Set colSQKr = Abs(nOstQI)/100
.head 7 -  Set colSKr  = Dig4(colSKrN, nDig, nDig)
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_DarkBlue)
.head 6 +  Else
.head 7 -  Set colSDeN = nS/100
.head 7 -  Set colSQDe = Abs(nOstQI)/100
.head 7 -  Set colSDe  = Dig4(Abs(colSDeN), nDig, nDig)
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_DarkRed)
.head 6 -  !
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  ! Сумма фактических оборотов
.head 6 -  Set colTXT = CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cTFact')
.head 6 -  Set colSDeN = nSumDos/100
.head 6 -  Set colSQDe = nObD/100
.head 6 -  Set colSKrN = nSumKos/100
.head 6 -  Set colSQKr = nObK/100
.head 6 -  ! проверка на 3 знака
.head 6 -  Set colSDe = Dig4(colSDeN, nDig, nDig)
.head 6 -  Set colSKr = Dig4(colSKrN, nDig, nDig)
.head 6 -  !
.head 6 -  Set nStart = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblFetchRow(hWndForm, nStart)
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  ! Исходящее сальдо
.head 6 -  Set colTXT = CurrentLangTable.GetAtomTitle('tbl_AccTurn4Day.cTIsx')
.head 6 -  Set colVdat = dfDate2
.head 6 +  If nDk > 0
.head 7 -  Set colSKrN = nDk/100 
.head 7 -  Set colSQKr = Abs(nOstQO)/100
.head 7 -  Set colSKr  = Dig4(colSKrN, nDig, nDig)
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_DarkBlue)
.head 6 +  Else
.head 7 -  Set colSDeN = nDk/100
.head 7 -  Set colSQDe = Abs(nOstQO)/100
.head 7 -  Set colSDe  = Dig4(Abs(colSDeN), nDig, nDig)
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_DarkRed)
.head 6 -  !
.head 6 -  Call NASELENIE()
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalTblSetFocusRow(hWndForm, nStart)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_DoubleClick
.head 4 +  If colRef > 0
.head 5 -  Call DocViewContentsEx(hWndForm,tbl_AccTurn4Day.colRef)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor ( TRUE )
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nOrderBy = 1
.head 4 +  Else
.head 5 -  Set nOrderBy = 1-nOrderBy
.head 4 -  ! tt,ref,s,sq,dk,txt,fdat
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( colTT ), COL_GetID )
.head 5 -  ! Set sOrderBy = " o.tt"|| IifS(nOrderBy=0," desc","") ||",o.dk,o.fdat,o.s"
.head 5 -  Set sOrderBy = " 1"|| IifS(nOrderBy=0," desc","") ||",5,7,3"
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colRef ),  COL_GetID )
.head 5 -  ! Set sOrderBy = " o.ref"|| IifS(nOrderBy=0," desc","")
.head 5 -  Set sOrderBy = " 2"|| IifS(nOrderBy=0," desc","")
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colSDe ), COL_GetID )
.head 5 -  ! Set sOrderBy = " o.dk,o.s"|| IifS(nOrderBy=0," desc","") ||",o.fdat"
.head 5 -  Set sOrderBy = " 5,3"|| IifS(nOrderBy=0," desc","") ||",7"
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colSKr ), COL_GetID )
.head 5 -  ! Set sOrderBy = " o.dk,o.s"|| IifS(nOrderBy=0," desc","") ||",o.fdat"
.head 5 -  Set sOrderBy = " 5,3"|| IifS(nOrderBy=0," desc","") ||",7"
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colSQDe ), COL_GetID )
.head 5 -  ! Set sOrderBy = " o.dk,o.sq"|| IifS(nOrderBy=0," desc","") ||",o.fdat"
.head 5 -  Set sOrderBy = " 5,4"|| IifS(nOrderBy=0," desc","") ||",7"
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colSQKr ), COL_GetID )
.head 5 -  ! Set sOrderBy = " o.dk,o.sq"|| IifS(nOrderBy=0," desc","") ||",o.fdat"
.head 5 -  Set sOrderBy = " 5,4"|| IifS(nOrderBy=0," desc","") ||",7"
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colTXT  ), COL_GetID )
.head 5 -  ! Set sOrderBy = " 6"|| IifS(nOrderBy=0," desc","") ||",o.dk,o.fdat,o.s"
.head 5 -  Set sOrderBy = " 6"|| IifS(nOrderBy=0," desc","") ||",5,7,3"
.head 4 +  Else If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( hWndForm, SalTblQueryColumnID( tbl_AccTurn4Day.colVdat ), COL_GetID )
.head 5 -  ! Set sOrderBy = " o.fdat"|| IifS(nOrderBy=0," desc","") ||",o.dk,o.s"
.head 5 -  Set sOrderBy = " 7"|| IifS(nOrderBy=0," desc","") ||",5,3"
.head 4 +  Else
.head 5 -  ! Set sOrderBy = " o.dk,o.fdat,o.s"
.head 5 -  Set sOrderBy = " 5,7,3"
.head 4 -  !
.head 4 -  ! Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle( wParam ), COL_Selected, FALSE )
.head 4 -  ! Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nSortOrder )
.head 4 -  Call SalSendMsg (hWndForm, UM_Populate, 0, 0 )
.head 4 -  Call SalWaitCursor ( FALSE )
.head 3 +  On UM_Print
.head 4 -  ! Для печати открываем колонки с настоящей суммой (с -/+)
.head 4 -  Call SalShowWindow(colSDeN)
.head 4 -  Call SalShowWindow(colSKrN)
.head 4 -  Call SalHideWindow(colSDe)
.head 4 -  Call SalHideWindow(colSKr)
.head 4 -  Call SalTblQueryColumnWidth(colSDe, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colSDeN,  nTmp+0.05)
.head 4 -  Call SalTblQueryColumnWidth(colSKr, nTmp)
.head 4 -  Call SalTblSetColumnWidth(colSKrN,  nTmp+0.05)
.head 4 -  ! Печать таблицы
.head 4 -  ! Call SalSendClassMessage(UM_Print, 0, 0)
.head 4 -  Call TablePrint(hWndForm, strNls, GetPrnDir() || '\\' || Subs(strNls,1,8) || '.' || strISOCur, '')
.head 4 -  ! Прячем числовые колонки, открываем строковые
.head 4 -  Call SalHideWindow(colSDeN)
.head 4 -  Call SalHideWindow(colSKrN)
.head 4 -  Call SalShowWindow(colSDe)
.head 4 -  Call SalShowWindow(colSKr)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 +  Form Window: win_StmtLegend
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? No
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  2.483"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.321"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Arial Cyr
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: White
.head 2 -  Description: Разъяснет раскраску выписки
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Сальдо: Дебет
.head 4 -  Resource Id: 49262
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.01"
.head 5 -  Top:    0.01"
.head 5 -  Width:  2.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.17"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: White
.head 3 +  Data Field: bgD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Сальдо: Кредит
.head 4 -  Resource Id: 49263
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.01"
.head 5 -  Top:    0.18"
.head 5 -  Width:  2.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.17"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: White
.head 3 +  Data Field: bgK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Обороты: Фактические
.head 4 -  Resource Id: 49264
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.01"
.head 5 -  Top:    0.35"
.head 5 -  Width:  2.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: White
.head 3 +  Data Field: bgC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Обороты: Плановые
.head 4 -  Resource Id: 49265
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.01"
.head 5 -  Top:    0.51"
.head 5 -  Width:  2.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: White
.head 3 +  Data Field: bgB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Обороты: Форвардные
.head 4 -  Resource Id: 49266
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.01"
.head 5 -  Top:    0.68"
.head 5 -  Width:  2.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: White
.head 3 +  Data Field: bgF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowLoc( hWndForm, 0, 0 )
.head 1 -  ! Карточка счета
.head 1 +  Form Window: Frm_Account
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Открытие/Обновление лицевых счетов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.5"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.45"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nAcc = 0
.head 8 +  If cbOnAllValuts
.head 9 -  ! Открыть по валютам
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipOpenKv')
.head 8 +  Else
.head 9 -  ! Открыть счет
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipOpen')
.head 7 +  Else
.head 8 +  If cbOnAllValuts
.head 9 -  ! Открыть по валютам
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipOpenKv')
.head 8 +  Else
.head 9 -  ! Сохранить
.head 9 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipSave')
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen()
.head 8 +  If SaveAccountData()
.head 9 -  Set fParentRefresh = TRUE
.head 9 -  Set fIsEdit = FALSE
.head 9 -  Set bProf = FALSE
.head 9 -  Call SalEnableWindow(cbOnAllValuts)
.head 9 -  Call SalDisableWindow(hWndItem)
.head 9 -  Call SalDisableWindow(pbProf)
.head 9 +  If cTabAccRights.EditMode = TAB_Edit
.head 10 -  Call SalSendMsg(cTabAccRights.hWnd, UM_Populate, 0, 0)
.head 9 +  If cTabAccSob.EditMode = TAB_Edit
.head 10 -  Call SalSendMsg(cTabAccSob.hWnd.Dlg_AccSob.tblAccSob, UM_Populate, 0, 0)
.head 7 +  Else
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  ! Банковский День ЗАКРЫТ!
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('cTBankDayClose'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok )
.head 4 +  Pushbutton: pbClose
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Закрыть счет
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipClose')
.head 6 +  On SAM_Click
.head 7 +  If IsBankDayOpen()
.head 8 +  If CloseAccount(nAcc)
.head 9 -  Set fParentRefresh = TRUE
.head 8 -  Call WaitCursorOff()
.head 8 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать справки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 -  Call PrintAccountData()
.head 4 -  Line
.head 5 -  Resource Id: 18014
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.617"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  1.617"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.75"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipExit')
.head 6 +  On SAM_Click
.head 7 +  If fIsEdit
.head 8 -  ! В карточке есть несохраненные данные! Игнорировать изменения и выйти?
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgNotSaveData') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('cTMsgIgnoreAndExit'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  Call SalDestroyWindow(hWndForm)
.head 7 +  Else
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Line
.head 5 -  Resource Id: 18015
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.3"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  2.3"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 18016
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.167"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  5.167"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Solid
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbProf
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выбрать профиль
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Frm_Account.cBTipProf')
.head 6 +  On SAM_Click
.head 7 -  Set sNBS = cAccount.getNbs()
.head 7 +  If sNBS != ''
.head 8 +  If SalModalDialog(Dlg_GetProf, hWndForm, sNBS, nNbsProf)
.head 9 -  Call SetAccountParamsFromProf()
.head 9 -  Set bProf = TRUE
.head 6 +  On SAM_User
.head 7 -  ! кнопку открываем только при открытии нового счета, 
  если доступны закладки "Осн, фин, дост.", "Спецпараметры" и "%%"
.head 7 +  If bNbsProf AND nAcc = 0 
AND cTabAccGeneral.EditMode != TAB_Hide AND cTabAccSP.EditMode != TAB_Hide AND cTabAccAcrn.EditMode != TAB_Hide
.head 8 -  Call SalEnableWindow(pbProf)
.head 4 +  Check Box: cbOnAllValuts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: По валютам
.head 5 -  Window Location and Size
.head 6 -  Left:   3.117"
.head 6 -  Top:    0.107"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlg_ListValuts, hWndForm)
.head 7 +  If nCountKv = 0
.head 8 -  Set cbOnAllValuts = FALSE
.head 8 -  Call SalEnableWindow(cbOnAllValuts)
.head 7 +  Else
.head 8 -  Call IsEdited()
.head 8 -  Set cbOnAllValuts = TRUE
.head 8 +  If nAcc = 0
.head 9 -  Set cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv = Str(nCodVal[0])
.head 9 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv, SAM_User, 0, 0)
.head 8 -  Call SalDisableWindow(cbOnAllValuts)
.head 8 -  Call SalSendMsg(pbSave, SAM_Create, 0, 0)
.head 4 -  Background Text: Клиент
.head 5 -  Resource Id: 18017
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.3"
.head 6 -  Top:    0.15"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgClient
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000100
0020: 0000546162426F74 746F6D4D61726769 6E00020030000054 616250616765436F
0040: 756E740002003100 005461624C616265 6C73000100000054 61624E616D657300
0060: 0100000054616252 696768744D617267 696E000200300000 5461624472617753
0080: 74796C65000B0057 696E39355374796C 650000546162466F 726D506167657300
00A0: 0100000054616254 6F704D617267696E 0002003000005461 624F7269656E7461
00C0: 74696F6E00010000 0000000000000000 0000000000000000 00000000000000
.enddata
.data CLASSPROPSSIZE
0000: DF00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 +  If fDestroy
.head 7 -  Return FALSE
.head 6 -  Set nTabNum = 0
.head 6 -  ! Основные
.head 6 -  Call createTab(cTabAccGeneral, FALSE)
.head 6 -  ! Финансовые
.head 6 -  Call createTab(cTabAccFinancial, FALSE)
.head 6 -  ! Права доступа
.head 6 -  Call createTab(cTabAccRights, FALSE)
.head 6 -  ! Спецпараметры
.head 6 -  Call createTab(cTabAccSP, IifN(nAcc=0, TRUE, FALSE))
.head 6 -  ! Проценты
.head 6 -  Call createTab(cTabAccAcrn, IifN(nAcc=0, TRUE, FALSE))
.head 6 -  ! Тарифы
.head 6 -  Call createTab(cTabAccRates, IifN(nAcc=0, TRUE, FALSE))
.head 6 -  ! График событий
.head 6 -  Call createTab(cTabAccSob, IifN(nAcc=0, TRUE, FALSE))
.head 6 +  If bNN
.head 7 -  ! Схемы лимитов
.head 7 -  Call createTab(cTabAccNNLimit, IifN(nAcc=0, TRUE, FALSE))
.head 6 -  ! Удаляем последнюю пустую закладку
.head 6 -  Call picTabs.Delete(nTabNum, TRUE)
.head 6 -  ! Инициализация закладок
.head 6 -  Call picTabs.InitializeFormPages(
     SalNumberToStrX(nAcc,0) || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) )
.head 6 -  ! Показываем первую закладку
.head 6 -  Call GetName(nTabCurrent, sGetName)
.head 6 -  ! %%-первые
.head 6 +  ! If sGetName = 'AccAcrn'
.head 7 +  If cTabAccRates.EditMode != TAB_Hide
.head 8 -  Set nTabCurrent = cTabAccRates.TabNum
.head 7 +  Else If cTabAccSob.EditMode != TAB_Hide
.head 8 -  Set nTabCurrent = cTabAccSob.TabNum
.head 6 -  Call picTabs.BringToTop(nTabCurrent,TRUE)
.head 6 -  !
.head 6 -  Set fAccActivate = TRUE
.head 5 +  On TABSM_TabActivateStart
.head 6 +  If fAccActivate
.head 7 -  Call GetName(wParam, sGetName)
.head 7 +  If sGetName = 'AccFinancial'
.head 8 -  Call SalSendMsg(cTabAccFinancial.hWnd, SAM_User, 0, 0)
.head 7 +  If sGetName = 'AccSP'
.head 8 -  Call SalSendMsg(cTabAccSP.hWnd, SAM_User, 0, 0)
.head 7 -  Call GetLabel(wParam, sGetName)
.head 7 -  Call SaveInfoToLog("ACCOUNTS [" || sNls ||"]. Активирована закладка '" || sGetName || "'")
.head 6 -  Set nPrevActivTab = picTabs.GetTop()
.head 2 +  Functions
.head 3 +  Function: createTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : AccTab
.head 6 -  Class: cAccTab
.head 5 -  Boolean: bDisableTab	! Насильно закрыть закладку для редактирования (напр., при рег. нового клиента)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call picTabs.Insert(nTabNum,TRUE)
.head 5 -  Call picTabs.SetLabel(nTabNum, AccTab.Label, TRUE)
.head 5 -  Call picTabs.SetName(nTabNum, AccTab.Name)
.head 5 +  If bDisableTab
.head 6 -  Call picTabs.Enable(nTabNum, FALSE)
.head 5 +  Else
.head 6 +  If AccTab.EditMode != TAB_Hide and AccTab.DlgName
.head 7 -  Call picTabs.AddPage(AccTab.Name, AccTab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(AccTab.EditMode=TAB_Hide, FALSE, TRUE))
.head 5 -  Call picTabs.CreatePage(AccTab.Name)
.head 5 -  Set AccTab.TabNum = nTabNum
.head 5 -  Set nTabNum = nTabNum + 1
.head 5 -  Return TRUE
.head 3 +  Function: linkTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : AccTab
.head 6 -  Class: cAccTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If AccTab.DlgName
.head 6 -  Call picTabs.AddPage(AccTab.Name, AccTab.DlgName, hWndNULL)
.head 5 -  Return TRUE
.head 3 +  Function: InitAccTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Label
.head 5 -  Set cTabAccGeneral.Label   = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccGeneral') || ' '
.head 5 -  Set cTabAccFinancial.Label = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccFinancial') || ' '
.head 5 -  Set cTabAccRights.Label    = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccRights') || ' '
.head 5 -  Set cTabAccSP.Label        = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccSP') || ' '
.head 5 -  Set cTabAccAcrn.Label      = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccAcrn') || ' '
.head 5 -  Set cTabAccRates.Label     = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccRates') || ' '
.head 5 -  Set cTabAccSob.Label       = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccSob') || ' '
.head 5 -  Set cTabAccNNLimit.Label   = ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTabAccNNLimit') || ' '
.head 5 -  ! Name
.head 5 -  Set cTabAccGeneral.Name   = 'AccGeneral'
.head 5 -  Set cTabAccFinancial.Name = 'AccFinancial'
.head 5 -  Set cTabAccRights.Name    = 'AccRights'
.head 5 -  Set cTabAccSP.Name        = 'AccSP'
.head 5 -  Set cTabAccAcrn.Name      = 'AccAcrn'
.head 5 -  Set cTabAccRates.Name     = 'AccRates'
.head 5 -  Set cTabAccSob.Name       = 'AccSob'
.head 5 -  Set cTabAccNNLimit.Name   = 'AccNNLimit'
.head 5 -  ! DlgName
.head 5 -  Set cTabAccGeneral.DlgName   = 'Dlg_AccGeneral'
.head 5 -  Set cTabAccFinancial.DlgName = 'Dlg_AccFinancial'
.head 5 -  Set cTabAccRights.DlgName    = 'Dlg_AccRights'
.head 5 -  Set cTabAccSP.DlgName        = 'Dlg_AccSPTab'
.head 5 -  Set cTabAccAcrn.DlgName      = 'Dlg_AccAcrn'
.head 5 -  Set cTabAccRates.DlgName     = 'Dlg_AccRates'
.head 5 -  Set cTabAccSob.DlgName       = 'Dlg_AccSob'
.head 5 -  Set cTabAccNNLimit.DlgName   = 'Dlg_AccNNLimit'
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: SetAccTabEditMode
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nSetValue
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set cTabAccGeneral.EditMode   = nSetValue
.head 5 -  Set cTabAccFinancial.EditMode = nSetValue
.head 5 -  Set cTabAccRights.EditMode    = nSetValue
.head 5 -  Set cTabAccSP.EditMode        = nSetValue
.head 5 -  Set cTabAccAcrn.EditMode      = nSetValue
.head 5 -  Set cTabAccRates.EditMode     = nSetValue
.head 5 -  Set cTabAccSob.EditMode       = nSetValue
.head 5 -  Set cTabAccNNLimit.EditMode   = nSetValue
.head 5 -  Return TRUE
.head 3 +  Function: ReadAccountData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  Return FALSE
.head 5 -  ! General + Financial + Nbs for Special
.head 5 +  If cTabAccGeneral.EditMode   != TAB_Hide 
or cTabAccFinancial.EditMode != TAB_Hide 
or cTabAccSP.EditMode        != TAB_Hide 
or cTabAccAcrn.EditMode      != TAB_Hide
.head 6 +  If NOT cAccount.populateAccountAttribute()
.head 7 -  Return FALSE
.head 5 -  ! Rights
.head 5 +  If cTabAccRights.EditMode != TAB_Hide
.head 6 +  If NOT cAccount.populateAccRights()
.head 7 -  Return FALSE
.head 5 -  ! Special
.head 5 +  If cTabAccSP.EditMode != TAB_Hide
.head 6 +  If NOT cAccount.populateAccSParams()
.head 7 -  Return FALSE
.head 5 -  ! Acrn
.head 5 +  If cTabAccAcrn.EditMode != TAB_Hide
.head 6 +  If NOT cAccount.populateAccAcrn()
.head 7 -  Return FALSE
.head 5 -  ! Rates
.head 5 +  If cTabAccRates.EditMode != TAB_Hide
.head 6 +  If NOT cAccount.populateAccRates()
.head 7 -  Return FALSE
.head 5 -  ! Sob
.head 5 +  If cTabAccSob.EditMode != TAB_Hide
.head 6 +  If NOT cAccount.populateAccSob()
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: CheckAccountData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErr
.head 5 -  String: sErrPar
.head 5 -  String: sNlsTmp
.head 5 -  Number: nKvTmp
.head 5 -  Number: nRnkTmp
.head 5 -  String: sNmkTmp
.head 5 -  Number: nRow
.head 5 -  String: sMsg
.head 4 +  Actions
.head 5 -  Set sErr = ''
.head 5 -  Call cAccount.setRnk(nRnk)
.head 5 +  If nAcc = 0
.head 6 -  Set sNlsTmp = cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNls
.head 6 -  Set nKvTmp  = cTabAccGeneral.hWnd.Dlg_AccGeneral.dfKv
.head 6 +  If SqlPrepareAndExecute(hSql(),
"SELECT c.rnk, c.nmk INTO :nRnkTmp, :sNmkTmp 
   FROM accounts a, customer c 
  WHERE a.nls=:sNlsTmp AND a.kv=:nKvTmp AND a.rnk=c.rnk") 
AND SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Счет sNlsTmp ( hWndAccGeneral.Dlg_AccGeneral.dfLcv ) уже зарегистрирован за клиентом sNmkTmp (РНК nRnkTmp).
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTMsgAcc') || ' ' || 
     sNlsTmp || ' (' || cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv || ') ' || 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgAccReg') || ' ' || PutCrLf() || 
     sNmkTmp || ' (' || CurrentLangTable.GetAtomTitle('cTMsgRnk') || ' ' || Str(nRnkTmp) || ').', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 7 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 7 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNls)
.head 7 -  Return FALSE
.head 6 -  Call cAccount.setNls(sNlsTmp)
.head 6 -  Call cAccount.setKv(nKvTmp)
.head 5 -  ! General
.head 5 +  If cTabAccGeneral.EditMode = TAB_Edit or nAcc = 0
.head 6 -  Call cAccount.setNlsAlt(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNlsAlt)
.head 6 -  Call cAccount.setNbs(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNbs)
.head 6 -  Call cAccount.setNms(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNms)
.head 6 -  Call cAccount.setPap(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfPap)
.head 6 -  Call cAccount.setTip(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfTip)
.head 6 -  Call cAccount.setVid(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfVid)
.head 6 -  Call cAccount.setPos(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfPos)
.head 6 -  Call cAccount.setIsp(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfIspCode)
.head 6 -  Call cAccount.setProcMfo(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfMfo)
.head 6 -  Call cAccount.setTobo(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfTobo)
.head 5 -  ! Financial
.head 5 +  If cTabAccFinancial.EditMode = TAB_Edit or nAcc = 0
.head 6 -  Call cAccount.setOstx(cTabAccFinancial.hWnd.Dlg_AccFinancial.nOstx)
.head 6 -  Call cAccount.setLim(cTabAccFinancial.hWnd.Dlg_AccFinancial.nLim)
.head 6 -  Call cAccount.setBlkd(cTabAccFinancial.hWnd.Dlg_AccFinancial.dfVidBlkD)
.head 6 -  Call cAccount.setBlkk(cTabAccFinancial.hWnd.Dlg_AccFinancial.dfVidBlkK)
.head 5 -  ! Rights
.head 5 +  If cTabAccRights.EditMode = TAB_Edit or nAcc = 0
.head 6 -  Call SalSendMsg(cTabAccRights.hWnd, UM_Update, 0, 0)
.head 6 -  Call cAccount.setGrp(cTabAccRights.hWnd.Dlg_AccRights.nGrp)
.head 5 -  ! Special
.head 5 +  If cTabAccSP.EditMode = TAB_Edit and nAcc != 0
.head 6 -  ! SP (для nPar=0 / nPar=3) - если появятся еще какие-то nPar, нужно куда-то сдвинуть
.head 6 +  If 2 = SalSendMsg(cTabAccSP.hWnd, UM_BeforeClose, 0, 0)
.head 7 -  Call picTabs.BringToTop(cTabAccSP.TabNum, TRUE)
.head 7 -  Call SalSendMsg(cTabAccSP.hWnd, UM_Clear, 0, 0)
.head 7 -  Return FALSE
.head 6 -  Call SalSendMsg(cTabAccSP.hWnd, UM_Update, 0, 0)
.head 5 -  ! Acrn
.head 5 +  If cTabAccAcrn.EditMode = TAB_Edit and nAcc != 0
.head 6 +  If 2 = SalSendMsg(cTabAccAcrn.hWnd, UM_BeforeClose, 0, 0)
.head 7 -  Call picTabs.BringToTop(cTabAccAcrn.TabNum, TRUE)
.head 7 -  Return FALSE
.head 6 -  Call SalSendMsg(cTabAccAcrn.hWnd, UM_Update, 0, 0)
.head 5 -  ! Rates
.head 5 +  If cTabAccRates.EditMode = TAB_Edit and nAcc != 0
.head 6 -  Call SalSendMsg(cTabAccRates.hWnd, UM_Update, 0, 0)
.head 5 -  ! Sob
.head 5 +  If cTabAccSob.EditMode = TAB_Edit and nAcc != 0
.head 6 -  Call SalSendMsg(cTabAccSob.hWnd, UM_Update, 0, 0)
.head 5 -  ! Проверка на обязательное заполнение реквизитов 'Основные' и 'Права доступа'
.head 5 +  If cTabAccGeneral.EditMode = TAB_Edit or cTabAccRights.EditMode = TAB_Edit or nAcc = 0
.head 6 -  Set sErr = cAccount.getErrAccountData(sErrPar)
.head 6 +  If sErr
.head 7 -  ! sErr, Ошибка заполнения реквизитов
.head 7 -  Call SalMessageBox(sErr, CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 7 +  If sErrPar = 'NBS'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNbs)
.head 7 +  If sErrPar = 'NLS'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNls)
.head 7 +  If sErrPar = 'KV'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv)
.head 7 +  If sErrPar = 'NMS'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNms)
.head 7 +  If sErrPar = 'TIP'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbTip)
.head 7 +  If sErrPar = 'VID'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbVid)
.head 7 +  If sErrPar = 'ISP'
.head 8 -  Call picTabs.BringToTop(cTabAccGeneral.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfIspCode)
.head 7 +  If sErrPar = 'GRP'
.head 8 -  Call picTabs.BringToTop(cTabAccRights.TabNum, TRUE)
.head 8 -  Call SalSetFocus(cTabAccRights.hWnd.Dlg_AccRights.pbAdd)
.head 7 -  Return FALSE
.head 5 -  ! Проверка на обязательное заполнение полей в карточке клиента ЮЛ/ФЛ-СПД при открытии счетов 2 кл.
.head 5 +  If nAcc = 0 and bPAR_ACCRESERVE and
   Subs(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNls, 1, 1) = '2' and (nK014 = 1 or nK014 = 2) 
.head 6 +  If not SqlPLSQLCommand(hSql(), "kl.check_attr_foropenacc(nRnk, sMsg)")
.head 7 -  Return FALSE
.head 6 +  If sMsg
.head 7 -  Call VisMessageSetBkgdColor(COLOR_LightGray)
.head 7 -  Set hBtns[0] = hBtnShowCustomerCard
.head 7 -  Set hBtns[1] = hBtnReserveAcc
.head 7 -  Set hBtns[2] = hBtnExit
.head 7 -  Set nChoose = VisMessageBox(sMsg, 'Повідомлення', MBF_IconQuestion, hBtns, 3)
.head 7 +  If nChoose = 0
.head 8 +  If nK014 = 1
.head 9 -  Call EditCustCorpsEx(nRnk, AVIEW_ReadOnly, hWndForm, 0, '', FALSE)
.head 8 +  Else If nK014 = 2
.head 9 -  Call EditCustPersonEx(nRnk, AVIEW_ReadOnly, hWndForm, 0, '', FALSE)
.head 8 -  ! Call SalDestroyWindow(hWndForm)
.head 8 -  Return FALSE
.head 7 +  Else If nChoose = 1
.head 8 +  If NOT cAccount.reserveAccountAttribute()
.head 9 -  Return FALSE 
.head 8 -  Call SalMessageBox("Рахунок " || cAccount.getNls() || " (" || sLcv || ") зарезервовано", "Повідомлення", MB_IconAsterisk | MB_Ok)
.head 8 -  Call SqlCommitEx(hSql(), "Зарезервовано рахунок " || cAccount.getNls() || " (" || sLcv || ")")
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: IsEdited
.head 4 -  Description: Высталяет признак наличия изменений
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nAccessMode != ACCESS_READONLY
.head 6 +  If NOT fIsEdit
.head 7 -  Set fIsEdit = TRUE
.head 7 -  Call SalEnableWindow(pbSave)
.head 3 +  Function: SetAccountParamsFromProf
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sProfTag
.head 5 -  String: sProfVal
.head 5 -  Long String: sProfSql
.head 5 -  String: sValue
.head 5 -  Number: nNumGrp
.head 5 -  String: smGrp[*]
.head 5 -  Number: i
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSqlAux2(), 
"SELECT tag, val, sql_text 
 INTO :sProfTag, :sProfVal, :sProfSql 
 FROM v_nbs_prof 
 WHERE nbs=:sNBS AND np=:nNbsProf AND pr=1")
.head 5 +  While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 6 -  Set sValue = ''
.head 6 +  If sProfVal != ''
.head 7 -  Set sValue = sProfVal
.head 6 +  Else If sProfSql
.head 7 +  If NOT SqlPrepareAndExecute(hSqlAux3(), sProfSql || " INTO :sValue") 
OR NOT SqlFetchNext(hSqlAux3(), nFetchRes)
.head 8 -  Set sValue = ''
.head 6 +  If sValue != ''
.head 7 +  If SalStrUpperX(sProfTag) = 'KV'
.head 8 -  Set cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv = sValue
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv, SAM_Validate, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'ISP'
.head 8 -  Set cTabAccGeneral.hWnd.Dlg_AccGeneral.dfIspCode = Val(sProfVal)
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfIspCode, SAM_Validate, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'PAP'
.head 8 -  Call cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbPap.SetSelectById( Val(sProfVal) )
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbPap, SAM_Click, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'TIP'
.head 8 -  Call cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbTip.SetSelectById(sProfVal)
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbTip, SAM_Click, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'POS'
.head 8 -  Call cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbPos.SetSelectById( Val(sProfVal) )
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbPos, SAM_Click, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'VID'
.head 8 -  Call cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbVid.SetSelectById( Val(sProfVal) )
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbVid, SAM_Click, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'MFO'
.head 8 -  Set cTabAccGeneral.hWnd.Dlg_AccGeneral.dfMfo = Val(sProfVal)
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfMfo, SAM_Validate, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'TOBO'
.head 8 -  Set cTabAccGeneral.hWnd.Dlg_AccGeneral.dfTobo = sProfVal
.head 8 -  Call SalSendMsg(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfTobo, SAM_Validate, 0, 0)
.head 7 +  Else If SalStrUpperX(sProfTag) = 'GRP'
.head 8 -  Set nNumGrp = SalStrTokenize(sProfVal, '', ',', smGrp)
.head 8 -  Set i = 0
.head 8 +  While i < nNumGrp
.head 9 -  Call SalSendMsg(cTabAccRights.hWnd.Dlg_AccRights.pbAdd, SAM_User, Val(smGrp[i]), 0)
.head 9 -  Set i = i + 1
.head 5 -  Return TRUE
.head 3 +  Function: SetAccountSpecParamsFromProf
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If bProf
.head 6 +  If NOT cAccount.setSParamsProfData(nNbsProf)
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Call SalSendMsg(cTabAccSP.hWnd, UM_Populate, 0, 0)
.head 5 -  Return TRUE
.head 3 +  Function: SetAccountPercentsFromProf
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If bProf
.head 6 +  If NOT cAccount.setIntProfData(nNbsProf)
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hSql())
.head 5 -  Return TRUE
.head 3 +  Function: SaveAccountData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCheckMsg
.head 5 -  Number: nCheckFlag
.head 5 -  Number: nIterator
.head 4 +  Actions
.head 5 -  ! Открыть ВНЕСИСТЕМНЫЙ лицевой счет: cAccount.getNls() валюта: sLcv ?,
          ВНЕСИСТЕМНЫЕ лицевые счета: cAccount.getNls() по выбранным валютам?
  Сохранить изменения в реквизитах лицевого счета cAccount.getNls() (sLcv) ?
.head 5 +  If MessageQuestion(IifS(nAcc=0 OR cbOnAllValuts=TRUE, 
   CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpen') || 
      IifS(cbOnAllValuts=FALSE,
           IifS(cAccount.getNbs()='',
                ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenV'),
                '') || ' ' || 
              CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenLS') || ': ' || cAccount.getNls() || ' ' || 
              CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenKv') || ': ' || sLcv || ' ?',
           IifS(cAccount.getNbs()='',
                ' ' || CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenV2'),
                '') || ' ' || 
              CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenLS2')|| ': ' || cAccount.getNls() || ' ' || 
              CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenKv2')|| '?' ),  
   CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgSave') || ' ' || cAccount.getNls() || '(' || sLcv || ') ?' )) = IDNO
.head 6 -  Return FALSE
.head 5 +  If NOT CheckAccountData()
.head 6 -  Return FALSE
.head 5 -  ! Открытие
.head 5 +  If nAcc = 0 or cbOnAllValuts
.head 6 -  Set i = 0
.head 6 +  If NOT cbOnAllValuts
.head 7 -  Set nCountKv = 1
.head 6 +  While TRUE
.head 7 +  If nCountKv = 0    ! все открыли и выходим
.head 8 -  ! Открыт лицевой счет: cAccount.getNls() (sLcv), 
  Открыты лицевые счета: cAccount.getNls(), 
  Сохранение изменений в счете: cAccount.getNls() (sLcv)
.head 8 +  If SqlCommitEx(hSql(), IifS(nAcc=0, IifS(cbOnAllValuts=FALSE,
   CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenOK') || ': ' || cAccount.getNls() || ' (' || sLcv || ')', 
   CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenOK2')|| ': ' || cAccount.getNls()), 
   CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgSaveOK') || ': ' || cAccount.getNls() || ' (' || sLcv || ')' ))
.head 9 -  ! If nAcc = 0 OR cbOnAllValuts
.head 9 +  If nAcc = 0
.head 10 -  Set nAcc = cAccount.getAcc()
.head 10 -  Set sNls = cAccount.getNls()
.head 10 -  ! Перечитываем данные счета, т.к. после открытия что-то могло поменяться по триггерам (например, блокировка)
.head 10 -  Call cAccount.initAccount(hSql(), nAcc)
.head 10 -  Call ReadAccountData()
.head 10 -  ! SParams
.head 10 +  If cTabAccSP.EditMode != TAB_Hide
.head 11 -  Call linkTab(cTabAccSP)
.head 11 -  Call picTabs.Enable(cTabAccSP.TabNum,TRUE)
.head 10 -  ! %%
.head 10 +  If cTabAccAcrn.EditMode != TAB_Hide
.head 11 -  Call linkTab(cTabAccAcrn)
.head 11 -  Call picTabs.Enable(cTabAccAcrn.TabNum,TRUE)
.head 10 -  ! Tarif
.head 10 +  If cTabAccRates.EditMode != TAB_Hide
.head 11 -  Call linkTab(cTabAccRates)
.head 11 -  Call picTabs.Enable(cTabAccRates.TabNum,TRUE)
.head 10 -  ! Sob
.head 10 +  If cTabAccSob.EditMode != TAB_Hide
.head 11 -  Call linkTab(cTabAccSob)
.head 11 -  Call picTabs.Enable(cTabAccSob.TabNum,TRUE)
.head 10 -  ! NNLimit
.head 10 +  If bNN and cTabAccNNLimit.EditMode != TAB_Hide and cAccount.getTip() = 'LOD'
.head 11 -  Call linkTab(cTabAccNNLimit)
.head 11 -  Call picTabs.Enable(cTabAccNNLimit.TabNum,TRUE)
.head 10 -  !
.head 10 -  Call picTabs.InitializeFormPages( 
     SalNumberToStrX(nAcc,0) || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) )
.head 10 -  Set nActivTab = picTabs.GetTop()
.head 10 +  If cTabAccSP.EditMode    != TAB_Hide
.head 11 -  Call picTabs.BringToTop(cTabAccSP.TabNum, TRUE)
.head 11 +  If NOT cAccount.populateAccSParams()
.head 12 -  Call Debug('Error SP')
.head 11 +  If NOT SetAccountSpecParamsFromProf()
.head 12 -  Call Debug('Error SP Prof')
.head 11 +  If NOT SaveAccountSpecParamsOnOpen()
.head 12 -  Call Debug('Error save SP')
.head 10 +  If cTabAccAcrn.EditMode  != TAB_Hide
.head 11 -  Call picTabs.BringToTop(cTabAccAcrn.TabNum,TRUE)
.head 11 +  If NOT cAccount.populateAccAcrn()
.head 12 -  Call Debug('Error Acrn')
.head 11 +  If NOT SetAccountPercentsFromProf()
.head 12 -  Call Debug('Error Percents Prof')
.head 10 +  If cTabAccRates.EditMode != TAB_Hide
.head 11 -  Call picTabs.BringToTop(cTabAccRates.TabNum,TRUE)
.head 11 +  If NOT cAccount.populateAccRates()
.head 12 -  Call Debug('Error Rates')
.head 10 +  If cTabAccSob.EditMode   != TAB_Hide
.head 11 -  Call picTabs.BringToTop(cTabAccSob.TabNum,TRUE)
.head 11 +  If NOT cAccount.populateAccSob()
.head 12 -  Call Debug('Error Sob')
.head 10 -  Call picTabs.BringToTop(nActivTab,TRUE)
.head 9 +  Else
.head 10 -  Call cAccount.setAcc(nAcc)
.head 10 -  Call cAccount.setKv(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfKv)
.head 9 -  ! Открыт лицевой счет: cAccount.getNls() (sLcv)
  Открыты лицевые счета: cAccount.getNls()
.head 9 -  Call MessageInfo(IifS(cbOnAllValuts=FALSE,
     CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenOK') || ': ' || cAccount.getNls() || ' (' || sLcv || ')',
     CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgOpenOK2')|| ': ' || cAccount.getNls() ))
.head 9 -  Set cbOnAllValuts = FALSE
.head 9 -  Call SalEnableWindow(cbOnAllValuts)
.head 9 -  Call SalEnableWindow(pbPrint)
.head 9 -  Call SalEnableWindow(pbClose)
.head 9 -  Call SalDisableWindow(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfNls)
.head 9 -  Call SalDisableWindow(cTabAccGeneral.hWnd.Dlg_AccGeneral.dfLcv)
.head 9 -  Call SalDisableWindow(cTabAccGeneral.hWnd.Dlg_AccGeneral.cmbValuta)
.head 9 -  Call SalSendMsg(pbSave, SAM_Create, 0, 0)
.head 9 -  ! Проверка на заполнение обязательных спецпараметров после регистрации (нужно указать пользователю)
.head 9 +  If 2 = SalSendMsg(cTabAccSP.hWnd, UM_BeforeClose, 0, 0)
.head 10 -  Call picTabs.BringToTop(cTabAccSP.TabNum, TRUE)
.head 10 -  Call SalSendMsg(cTabAccSP.hWnd, UM_Clear, 0, 0)
.head 9 -  Return TRUE
.head 7 +  Else
.head 8 +  If cbOnAllValuts
.head 9 -  Call cAccount.setAcc(0)
.head 9 -  Call cAccount.setKv(nCodVal[i])
.head 9 -  ! Переприсваиваем спецпараметры
.head 9 -  Set nIterator = 0
.head 9 +  While nIterator < cAccount.SPList.nParNum
.head 10 +  If cAccount.SPList.List[nIterator].strValue != STRING_Null
.head 11 -  Set cAccount.SPList.List[nIterator].fUpdate = TRUE
.head 10 -  Set nIterator = nIterator + 1
.head 9 -  Set i = i + 1
.head 8 -  ! General + Financial
.head 8 +  If cTabAccGeneral.EditMode != TAB_Hide OR cTabAccFinancial.EditMode != TAB_Hide
.head 9 +  If NOT cAccount.registerAccountAttribute()
.head 10 -  Break
.head 9 -  Set sCheckMsg = STRING_Null
.head 9 -  ! sCheckMsg - сообщение об ошибке
  nCheckFlag=0 - предупреждение (счет открываем)
  nCheckFlag=1 - ошибка (счет НЕ открываем)
.head 9 +  If not cAccount.checkAccountAttribute(sCheckMsg, nCheckFlag)
.head 10 -  Break
.head 9 +  If sCheckMsg
.head 10 +  If nCheckFlag = 0
.head 11 -  ! Продолжить регистрацию счета?
.head 11 +  If SalMessageBox(sCheckMsg || PutCrLf() || CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgDone'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconExclamation) = IDNO
.head 12 -  Break
.head 10 +  Else If nCheckFlag = 1
.head 11 -  Call SalMessageBox(sCheckMsg, CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconStop)
.head 11 -  Break
.head 8 -  ! Rights
.head 8 +  If cTabAccRights.EditMode != TAB_Hide
.head 9 +  If NOT cAccount.registerAccountRights()
.head 10 -  Break
.head 8 -  ! Special
.head 8 +  If cTabAccSP.EditMode != TAB_Hide
.head 9 +  If cbOnAllValuts
.head 10 +  If NOT cAccount.saveAccSParams()
.head 11 -  Break
.head 9 +  Else
.head 10 +  If NOT cAccount.initAccountSParams()
.head 11 -  Break
.head 8 -  ! Acrn
.head 8 +  If cTabAccAcrn.EditMode != TAB_Hide
.head 9 +  If NOT cAccount.initAccountAcrn()
.head 10 -  Break
.head 8 -  ! Rates
.head 8 +  If cTabAccRates.EditMode != TAB_Hide
.head 9 +  If NOT cAccount.initAccountRates()
.head 10 -  Break
.head 8 -  ! Sob
.head 8 +  If cTabAccSob.EditMode != TAB_Hide
.head 9 +  If NOT cAccount.initAccountSob()
.head 10 -  Break
.head 8 -  Set nCountKv = nCountKv - 1
.head 5 -  ! Обновление по закладкам
.head 5 +  Else
.head 6 +  While TRUE
.head 7 -  ! General + Financial
.head 7 +  If cTabAccGeneral.EditMode   = TAB_Edit
or cTabAccFinancial.EditMode = TAB_Edit
.head 8 +  If NOT cAccount.saveAccountAttribute()
.head 9 -  Break
.head 7 -  ! Rights
.head 7 +  If cTabAccRights.EditMode = TAB_Edit
.head 8 +  If NOT cAccount.saveAccRights()
.head 9 -  Break
.head 7 -  ! Special
.head 7 +  If cTabAccSP.EditMode = TAB_Edit
.head 8 +  If NOT cAccount.saveAccSParams()
.head 9 -  Break
.head 7 -  ! Acrn
.head 7 +  If cTabAccAcrn.EditMode = TAB_Edit
.head 8 +  If NOT cAccount.saveAccAcrn()
.head 9 -  Break
.head 7 -  ! Rates
.head 7 +  If cTabAccRates.EditMode = TAB_Edit
.head 8 +  If NOT cAccount.saveAccRates()
.head 9 -  Break
.head 7 -  ! Sob
.head 7 +  If cTabAccSob.EditMode = TAB_Edit
.head 8 +  If NOT cAccount.saveAccSob()
.head 9 -  Break
.head 7 -  ! NNLimit - для сохранения
.head 7 +  If bNN and cTabAccNNLimit.EditMode = TAB_Edit and cTabAccNNLimit.hWnd
.head 8 +  If not SaveNNLimit()
.head 9 -  Break
.head 7 -  ! NNLimit - для инициализации, если поменялся тип счета
.head 7 +  Else If bNN and not cTabAccNNLimit.hWnd and cAccount.getTip() = 'LOD'
.head 8 -  Call linkTab(cTabAccNNLimit)
.head 8 -  Set cTabAccNNLimit.EditMode = TAB_Edit
.head 7 -  ! Сохранены изменения в реквизитах лицевого счета: cAccount.getNls() (sLcv)
.head 7 +  If SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgSaveOK') || ': ' || cAccount.getNls() || ' (' || sLcv || ')')
.head 8 -  Call MessageInfo(CurrentLangTable.GetAtomTitle('Frm_Account.cTMsgSaveOK') || ': ' || cAccount.getNls() || ' (' || sLcv || ')')
.head 8 -  ! Acrn (заново населяем, т.к. Acrn - это отдельное окно)
.head 8 -  Call cAccount.populateAccAcrn()
.head 8 -  ! Перечитываем тарифы
.head 8 -  Call cAccount.populateAccRates()
.head 8 -  ! Инициализация после сохранения
.head 8 -  Call picTabs.InitializeFormPages( 
     SalNumberToStrX(nAcc,0) || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) )
.head 8 -  ! NNLimit
.head 8 +  If bNN
.head 9 +  If cAccount.getTip() = 'LOD'
.head 10 -  Call picTabs.Enable(cTabAccNNLimit.TabNum, TRUE)
.head 9 +  Else
.head 10 -  Call picTabs.Enable(cTabAccNNLimit.TabNum, FALSE)
.head 8 -  Return TRUE
.head 7 -  Break
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Set fIsEdit = FALSE
.head 5 -  ! Ошибка открытия лицевого счета: 
  Ошибка обновления лицевого счета: cAccount.getNls() ( sLcv )
.head 5 -  Call MessageError(IifS(nAcc=0, 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTErrOpen') || ': ', 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTErrEdit') || ': ') || cAccount.getNls() || ' (' || sLcv || ')')
.head 5 -  Return FALSE
.head 3 +  Function: SaveAccountSpecParamsOnOpen
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalSendMsg(cTabAccSP.hWnd, SAM_User, 0, 0)
.head 5 -  Call SalSendMsg(cTabAccSP.hWnd, UM_Update, 0, 0)
.head 5 +  If NOT cAccount.saveAccSParams()
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hSql())
.head 5 -  Return TRUE
.head 3 +  Function: SaveNNLimit
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not cTabAccNNLimit.hWnd.Dlg_AccNNLimit.cLimitList.Save()
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: PrintAccountData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTemplateId
.head 5 -  Long String: sDoc
.head 5 -  : cCnc
.head 6 -  Class: cABSConnect
.head 5 -  : cCnc2
.head 6 -  Class: cABSConnect
.head 4 +  Actions
.head 5 +  If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
" ID LIKE 'ACC%' ", sTemplateId )
.head 6 -  Return 0
.head 5 +  If sTemplateId
.head 6 -  Call XConnectGetParams( cCnc )
.head 6 +  If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
.head 7 -  Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nAcc, 0)
.head 7 +  If sDoc
.head 8 -  Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
.head 7 -  Call cCnc.Disconnect()
.head 7 -  Call cCnc2.Disconnect()
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nAcc
.head 3 -  Number: nRnk
.head 3 -  Number: nAccessMode	! ACCESS_READONLY or ACCESS_FULL
.head 3 -  Window Handle: hWndParent
.head 3 -  ! Number: nPar
.head 3 -  String: sFilterOnTab ! ''-все на редактирование, если nAccessMode<>ReadOnly
.head 3 -  Boolean: bNN
.head 2 +  Window Variables
.head 3 -  : cAccount
.head 4 -  Class: AbstractAccount
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  Boolean: bPossibleToEditProc	! Карточку %% можно редактировать для закрытого счета
.head 3 -  String: sNmk 		! Наименование клиента
.head 3 -  Number: nK014		! Тип клиента
.head 3 -  Date/Time: dBDat	! Банковская дата
.head 3 -  Boolean: fIsEdit	! Признак редактирования реквизитов
.head 3 -  Number: nCountKv
.head 3 -  Number: nCodVal[512]
.head 3 -  Number: isTOBO
.head 3 -  String: sTOBO
.head 3 -  ! Для picTabs
.head 3 -  Number: nTabNum
.head 3 -  Boolean: fAccActivate 
.head 3 -  String: sGetName
.head 3 -  Number: nIndex
.head 3 -  Number: nTabCount
.head 3 -  Number: nTabCurrent
.head 3 -  Number: nActivTab
.head 3 -  Number: nPrevActivTab
.head 3 -  Number: i
.head 3 -  : cTabAccGeneral
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccFinancial
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccRights
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccSP
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccAcrn
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccRates
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccSob
.head 4 -  Class: cAccTab
.head 3 -  : cTabAccNNLimit
.head 4 -  Class: cAccTab
.head 3 -  ! Пар-ры счета
.head 3 -  String: sNls
.head 3 -  String: sLcv
.head 3 -  Number: nDig
.head 3 -  Number: nDig980
.head 3 -  String: sNbs
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  !
.head 3 -  Boolean: fDestroy
.head 3 -  Boolean: fParentRefresh
.head 3 -  Number: nNbsProf
.head 3 -  String: sNBS
.head 3 -  Boolean: bProf
.head 3 -  !
.head 3 -  Number: hBtnShowCustomerCard
.head 3 -  Number: hBtnReserveAcc
.head 3 -  Number: hBtnExit
.head 3 -  Number: hBtns[*]
.head 3 -  Number: nChoose
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowSize(hWndForm, 10.7, 6.5)
.head 4 -  ! Call SalSetWindowSize(hWndForm, 10.5, 5.8)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация переменных
.head 4 -  Set sNbs = ''
.head 4 +  If nAcc
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select nbs into :sNbs from accounts where acc=:nAcc")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If nRnk = 0
.head 5 +  If nAcc != 0
.head 6 -  Call SqlPrepareAndExecute(hSql(), "select rnk into :nRnk from accounts where acc=:nAcc")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nRnk = 0
.head 6 -  Call SalMessageBeep(MB_IconStop)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  ! Не определен Контрагент - владелец счета!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Frm_Account.cTErrOwner'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! K014 - Тип клієнта: 1-ЮО, 2-ФО-СПД, 3-ФО, 4-Банк, 5-Наш Банк
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select nmk, decode(okpo,f_ourokpo,5,decode(custtype,1,4,2,1,decode(nvl(trim(sed),'00'),'91',2,3))) into :sNmk, :nK014 from customer where rnk=:nRnk")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call SalSetWindowLabelText(bgClient, '№' || Str(nRnk) || ' ' || sNmk)
.head 4 -  Set dBDat  = GetBankDate()
.head 4 -  Set isTOBO = PAR_HAVETOBO
.head 4 -  Set bProf          = FALSE
.head 4 -  Set fDestroy       = FALSE
.head 4 -  Set fParentRefresh = FALSE
.head 4 +  If isTOBO
.head 5 -  Set sTOBO = GetValueStr("SELECT substr(tobopack.GetTOBO,1,30) FROM dual")
.head 4 -  ! Флаг редактируемости
.head 4 -  Set bPossibleToEdit = FALSE
.head 4 -  ! Кнопки
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 -  Call SalDisableWindow(pbProf)
.head 4 +  If not bNbsProf
.head 5 -  Call SalHideWindow(pbProf)
.head 4 -  !
.head 4 -  ! Закладки
.head 4 -  Set nTabCount   = 7
.head 4 -  Set nTabCurrent = 0
.head 4 -  Call InitAccTab()
.head 4 -  Call SetAccTabEditMode(TAB_ReadOnly)
.head 4 -  ! Если фильтр на закладки не задан, даем все для редактирования
.head 4 +  If sFilterOnTab = ''
.head 5 -  Call SetAccTabEditMode(TAB_Edit)
.head 4 -  ! Иначе разбираем строку фильтра
.head 4 +  Else
.head 5 +  If nAcc = 0
.head 6 -  Set cTabAccGeneral.EditMode   = TAB_Edit
.head 6 -  Set cTabAccFinancial.EditMode = TAB_Edit
.head 6 -  Set cTabAccRights.EditMode    = TAB_Edit
.head 6 -  Set cTabAccSP.EditMode        = Val(Subs(sFilterOnTab,4,1))
.head 6 -  Set cTabAccAcrn.EditMode      = Val(Subs(sFilterOnTab,5,1))
.head 6 -  Set cTabAccRates.EditMode     = Val(Subs(sFilterOnTab,6,1))
.head 6 -  Set cTabAccSob.EditMode       = Val(Subs(sFilterOnTab,7,1))
.head 6 -  Set cTabAccNNLimit.EditMode   = IifN(bNN, TAB_Edit, TAB_Hide)
.head 5 +  Else
.head 6 -  Set nTabCurrent = -1
.head 6 -  ! читаем заданный фильтр
.head 6 -  Set cTabAccGeneral.EditMode   = Val(Subs(sFilterOnTab,1,1))
.head 6 -  Set cTabAccFinancial.EditMode = Val(Subs(sFilterOnTab,2,1))
.head 6 -  Set cTabAccRights.EditMode    = Val(Subs(sFilterOnTab,3,1))
.head 6 -  Set cTabAccSP.EditMode        = Val(Subs(sFilterOnTab,4,1))
.head 6 -  Set cTabAccAcrn.EditMode      = Val(Subs(sFilterOnTab,5,1))
.head 6 -  Set cTabAccRates.EditMode     = Val(Subs(sFilterOnTab,6,1))
.head 6 -  Set cTabAccSob.EditMode       = Val(Subs(sFilterOnTab,7,1))
.head 6 -  Set cTabAccNNLimit.EditMode   = IifN(bNN, TAB_Edit, TAB_Hide)
.head 6 -  ! выставляем первую закладку
.head 6 -  Set i = 0
.head 6 +  While i < nTabCount
.head 7 +  If Val(Subs(sFilterOnTab,i+1,1)) > 0
.head 8 -  ! nTabCurrent - первая закладка
.head 8 -  Set nTabCurrent = IifN(nTabCurrent=-1, i, nTabCurrent)
.head 7 -  Set i = i + 1
.head 4 -  !
.head 4 -  ! INIT
.head 4 -  Call cAccount.initAccount(hSql(), nAcc)
.head 4 -  ! READ
.head 4 +  If nAcc = 0  ! открытие счета, иначе обновление реквизитов счета
.head 5 -  ! Открытие ЛС контрагента банка: Рег.N nRnk: sNmk
.head 5 -  Call SalSetWindowText(hWndForm, 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTWndTitleOpen') || '. ' ||
     CurrentLangTable.GetAtomTitle('Frm_Account.cTWndTitleKlient') || Str(nRnk) || ' ' || sNmk)
.head 5 -  ! Флаг редактируемости
.head 5 -  Set bPossibleToEdit = TRUE
.head 5 -  Set bPossibleToEditProc = TRUE
.head 5 -  !
.head 5 -  Call SalDisableWindow(pbClose)
.head 5 -  Call SalDisableWindow(pbPrint)
.head 5 -  Call SalDisableWindow(cbOnAllValuts)
.head 4 +  Else
.head 5 -  Call SalHideWindow(pbProf)
.head 5 +  If NOT ReadAccountData()
.head 6 -  ! Не удалось прочитать данные счета
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Frm_Account.cTErrAcc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconStop)
.head 6 -  Set fDestroy = TRUE
.head 6 -  Return SalDestroyWindow(hWndForm)
.head 5 -  Set sNls = cAccount.getNls()
.head 5 -  Call SalSetFocus(pbExit)
.head 5 -  ! Флаг редактируемости
.head 5 -  Set bPossibleToEdit = not (nAccessMode = ACCESS_READONLY or cAccount.getDazs() != DATETIME_Null)
.head 5 -  Set bPossibleToEditProc = not (nAccessMode = ACCESS_READONLY)
.head 5 -  ! Редактирование
.head 5 +  If bPossibleToEdit 
.head 6 -  ! Обновление реквизитов ЛС контрагента банка: Рег.№ nRnk sNmk
.head 6 -  Call SalSetWindowText(hWndForm, 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTWndTitleEdit')   || sNls || '. ' || 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTWndTitleKlient') || Str(nRnk)  || ' ' || sNmk)
.head 5 -  ! Просмотр
.head 5 +  Else
.head 6 -  ! Просмотр реквизитов ЛС контрагента банка: Рег.№ nRnk sNmk
.head 6 -  Call SalSetWindowText(hWndForm, 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTWndTitleView')   || sNls || '. ' || 
     CurrentLangTable.GetAtomTitle('Frm_Account.cTWndTitleKlient') || Str(nRnk)  || ' ' || sNmk )
.head 6 -  Call SalDisableWindow(pbClose)
.head 6 -  Call SalDisableWindow(cbOnAllValuts)
.head 5 -  ! анализируем bPossibleToEdit для закладок
.head 5 -  Set cTabAccGeneral.EditMode   = IifN(bPossibleToEdit, cTabAccGeneral.EditMode,   IifN(cTabAccGeneral.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccFinancial.EditMode = IifN(bPossibleToEdit, cTabAccFinancial.EditMode, IifN(cTabAccFinancial.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccRights.EditMode    = IifN(bPossibleToEdit, cTabAccRights.EditMode,    IifN(cTabAccRights.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccSP.EditMode        = IifN(bPossibleToEdit, cTabAccSP.EditMode,        IifN(cTabAccSP.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccAcrn.EditMode      = IifN(bPossibleToEditProc, cTabAccAcrn.EditMode,  IifN(cTabAccAcrn.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccRates.EditMode     = IifN(bPossibleToEdit, cTabAccRates.EditMode,     IifN(cTabAccRates.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccSob.EditMode       = IifN(bPossibleToEdit, cTabAccSob.EditMode,       IifN(cTabAccSob.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 5 -  Set cTabAccNNLimit.EditMode   = IifN(bPossibleToEdit, cTabAccNNLimit.EditMode,   IifN(cTabAccNNLimit.EditMode=TAB_Hide, TAB_Hide, TAB_ReadOnly))
.head 4 -  !
.head 4 -  ! Если недоступна закладка "Основные", закрываем "Открыть по валютам"
.head 4 +  If cTabAccGeneral.EditMode != TAB_Edit
.head 5 -  Call SalDisableWindow(cbOnAllValuts)
.head 4 -  ! Для NN - закладка "Схемы лимитов" открыта только для счетов LOD
.head 4 +  If bNN and nAcc and cAccount.getTip() != 'LOD'
.head 5 -  Set cTabAccNNLimit.EditMode = TAB_Hide
.head 4 -  !
.head 4 -  ! Доп. переменные
.head 4 -  Call SqlPrepareAndExecute(hSql(), "SELECT lcv INTO :sLcv FROM tabval WHERE kv=" || Str(cAccount.getKv()))
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call SqlPrepareAndExecute(hSql(), "SELECT dig INTO :nDig980 FROM tabval WHERE kv=" || Str(GetBaseVal()))
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  !
.head 4 +  If bPAR_ACCRESERVE
.head 5 -  Set hBtnShowCustomerCard = VisMessageLoadButton('Заповнити поля', 0)
.head 5 -  Set hBtnReserveAcc = VisMessageLoadButton('Зарезервувати рахунок', 1)
.head 5 -  Set hBtnExit = VisMessageLoadButton('Вийти', 2)
.head 4 -  !
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Activate
.head 4 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_MenuSelect, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nWW, nWH)
.head 4 +  If nWW >= 10.7
.head 5 +  If nWH < 6.5
.head 6 -  Call SalSetWindowSize(hWndForm, nWW, 6.5)
.head 4 +  Else
.head 5 +  If nWH < 6.5
.head 6 -  Call SalSetWindowSize(hWndForm, 10.7, 6.5)
.head 5 +  Else
.head 6 -  Call SalSetWindowSize(hWndForm, 10.7, nWH)
.head 4 +  ! If nWW >= 10.5
.head 5 +  If nWH < 5.8
.head 6 -  Call SalSetWindowSize(hWndForm, nWW, 5.8)
.head 4 +  ! Else
.head 5 +  If nWH < 5.8
.head 6 -  Call SalSetWindowSize(hWndForm, 10.5, 5.8)
.head 5 +  Else 
.head 6 -  Call SalSetWindowSize(hWndForm, 10.5, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On SAM_Destroy
.head 4 -  Call SaveInfoToLog('Выход из диалога: Реквизиты Счета.')
.head 4 +  If bPAR_ACCRESERVE
.head 5 -  Call VisMessageFreeButton(hBtnShowCustomerCard)
.head 5 -  Call VisMessageFreeButton(hBtnReserveAcc)
.head 5 -  Call VisMessageFreeButton(hBtnExit)
.head 4 -  Call SalSendMsg(SalParentWindow(hWndForm), UM_MenuSelect, 0, 0)
.head 4 -  Call SalMapEnterToTab(FALSE)
.head 4 +  If fParentRefresh
.head 5 -  Call SalPostMsg(hWndParent, UM_Populate, 0, 0)
.head 1 +  Dialog Box: Dlg_AccGeneral
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.233"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Дата открытия:
.head 4 -  Resource Id: 2758
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.286"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDateOn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateOn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.2"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: 99/99/9999
.head 4 -  Message Actions
.head 3 -  Background Text: Дата закрытия:
.head 4 -  Resource Id: 2759
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.548"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDateOff
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateOff
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.47"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: 99/99/9999
.head 4 -  Message Actions
.head 3 -  Background Text: Балансовый счет (R020):
.head 4 -  Resource Id: 2760
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.821"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNbs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.74"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If SalIsNull(dfNbs)
.head 7 -  Set dfNameNbs = ''
.head 6 +  Else
.head 7 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 +  If SalIsNull(dfNbs)
.head 7 -  Call hWndParent.Frm_Account.cAccount.setNbs(dfNbs)
.head 7 -  Set dfNameNbs = STRING_Null
.head 7 -  Set dfOB22 = STRING_Null
.head 7 -  Set dfNameOB22 = STRING_Null
.head 7 -  Set dfNls = STRING_Null
.head 7 +  If nAcc = 0
.head 8 -  Set dfTip = 'ODB'
.head 8 -  Call SalSendMsg(cmbTip, UM_ObjActivate, 0, 0)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If SalStrLength(dfNbs) < 4
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 6 +  If not SalIsNull(dfNbs) AND nAcc = 0
.head 7 -  Call SalSendMsg(hWndParent.Frm_Account.pbProf, SAM_User, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_User
.head 6 +  If not SalIsNull(dfNbs)
.head 7 -  ! d_close > bankdate исправлено на d_close >= bankdate
.head 7 -  ! для БС проставлена дата закрытия 24/01/2012,
.head 7 -  ! до конца 24/01/2012 этот счет еще рабочий и нужно давать его откыть
.head 7 -  ! (в плане счетов НБУ две записи: одни БС закрыватся 24.01.2012, а другие БС открываются 25.01.2012,
.head 7 -  ! т.е. 24.01.2012 старые счета еще можно открывать)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT name, xar, pap 
   INTO :dfNameNbs, :nXar, :nPapPs 
   FROM Ps 
  WHERE nbs=:dfNbs AND (d_close is null or d_close >= bankdate)")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SqlPrepareAndExecute(hSql(), "select nbs into :sTmp from nbs_k014 where k014 = :nK014 and :dfNbs like trim(nbs)||'%'")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nAcc = 0
.head 10 -  Call cmbPap.SetSelectById(nPapPs)
.head 9 -  Call SalSendMsg(dfXar, UM_Choose, 0, 0)
.head 9 +  If dfTip != '' AND hWndParent.Frm_Account.nRnk != NUMBER_Null AND hWndParent.Frm_Account.nAcc = 0
.head 10 -  Call SalEnableWindow(pbAccountMask)
.head 10 -  ! Перевірка наявності ОБ22 в довіднику для вибраного R020
.head 10 -  Call f_chk_ob22()
.head 8 +  Else
.head 9 -  ! dfNbs - Недопустимый балансовый счет для типа клиента
.head 9 -  Call SalMessageBox(dfNbs || ' - '|| CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrNbsK014'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation)
.head 9 +  If nAcc = 0
.head 10 -  Set dfNbs = STRING_Null
.head 10 -  Set dfNameNbs = STRING_Null
.head 10 -  Set dfOB22 = STRING_Null
.head 10 -  Set dfNameOB22 = STRING_Null
.head 10 -  Set dfNls = STRING_Null
.head 7 +  Else
.head 8 -  ! dfNbs - Нет такого балансового счета или балансовый счет закрыт
.head 8 -  Call SalMessageBox(dfNbs || ' - '|| CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrNbs'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation)
.head 8 +  If nAcc = 0
.head 9 -  Set dfNbs = STRING_Null
.head 9 -  Set dfNameNbs = STRING_Null
.head 9 -  Set dfOB22 = STRING_Null
.head 9 -  Set dfNameOB22 = STRING_Null
.head 9 -  Set dfNls = STRING_Null
.head 9 +  If not GetGlobalOptionEx('NBS_NULL')
.head 10 -  Set dfNls = STRING_Null
.head 6 -  Call hWndParent.Frm_Account.cAccount.setNbs(dfNbs)
.head 6 +  If SalIsNull(dfNbs)
.head 7 -  Call SalSendMsg(cmbTip, UM_ObjActivate, 0, 0)
.head 7 -  Set dfOB22 = STRING_Null
.head 7 -  Set dfNls = STRING_Null
.head 6 +  If nAcc = 0 and (dfTip = '' or dfTip = 'ODB')
.head 7 -  Set dfTip = 'ODB'
.head 7 -  Call SalSendMsg(cmbTip, UM_ObjActivate, 0, 0)
.head 3 +  Data Field: dfNameNbs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 150
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.74"
.head 6 -  Width:  3.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Праметр (OB22):
.head 4 -  Resource Id: 28972
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.12"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOB22
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.04"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On UM_ObjActivate
.head 6 +  If SalIsNull(dfOB22)
.head 7 -  Set dfNameOB22 = ''
.head 6 +  Else 
.head 7 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 +  If SalIsNull(dfOB22)
.head 7 -  Call hWndParent.Frm_Account.cAccount.setOB22(dfOB22)
.head 7 -  Set dfNameOB22 = ''
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 +  If SalStrLength(dfOB22) < 2
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 6 +  If not SalIsNull(dfOB22) AND nAcc = 0
.head 7 -  Call SalSendMsg(hWndParent.Frm_Account.pbProf, SAM_User, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_User
.head 6 +  If not SalIsNull(dfOB22)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select NAME
   into :dfNameOB22
   from V_SB_OB22 
  where R020 = :dfNbs 
    and OB22 = :dfOB22
    and lnnvl( OPN_DT >  gl.bd() ) 
    and lnnvl( CLS_DT <= gl.bd() )")
.head 7 +  If Not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! dfOB22 - Нет такого OB22 или OB22 закрыт
.head 8 -  Call SalMessageBox(dfOB22 || ' - '|| CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrOB22'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation)
.head 8 +  If nAcc = 0
.head 9 -  Set dfNameOB22 = STRING_Null
.head 9 -  Set dfOB22 = STRING_Null
.head 6 -  Call hWndParent.Frm_Account.cAccount.setOB22(dfOB22)
.head 6 +  If SalIsNull(dfOB22)
.head 7 -  Set dfNameOB22 = STRING_Null
.head 3 +  Data Field: dfNameOB22
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 150
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.4"
.head 6 -  Top:    1.04"
.head 6 -  Width:  3.65"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: № счета:
.head 4 -  Resource Id: 2761
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.429"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    1.345"
.head 6 -  Width:  4.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalStrTrim(dfNls, dfNls)
.head 6 +  If SalIsNull(dfNls)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SalStrLength(dfNls) < 5
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If Not SalIsValidNumber(dfNls)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set dfNls=KeyAccount(GetBankMfo(), dfNls)
.head 6 +  If GetAccountStructure(nTmp, nBPos, nBLen, nTmp)
.head 7 -  Set dfNbs = SalStrLeftX(SalStrRightX(SalStrRepeatX('0',nBLen )||dfNls,nBPos),nBLen)
.head 7 +  If SalStrLength(dfNls) < nBPos
.head 8 -  Set dfNls = dfNbs || SalStrRightX(dfNls,nBPos-nBLen)
.head 6 +  Else
.head 7 -  Set dfNbs = SalStrMidX(dfNls, nBPos-1, nBLen)
.head 6 -  Call hWndParent.Frm_Account.cAccount.setNls(dfNls)
.head 6 +  If SalSendMsg(dfNbs, SAM_Validate, 0, 0)
.head 7 -  Call cmbPap.SetSelectById(nPapPs)
.head 7 -  Call SalSendMsg(cmbPap, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Альтернативный №:
.head 4 -  Resource Id: 2762
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.702"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNlsAlt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsAlt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 24
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.619"
.head 6 -  Width:  4.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 -  Background Text: Наименование:
.head 4 -  Resource Id: 2763
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.964"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.881"
.head 6 -  Width:  4.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 -  Background Text: Валюта (R030):
.head 4 -  Resource Id: 2764
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.238"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgValuta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLcv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.155"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_User
.head 6 +  If SalIsValidInteger(hWndItem)
.head 7 -  Set sTmp = 'kv'
.head 6 +  Else
.head 7 -  Set sTmp = 'lcv'
.head 7 -  Set dfLcv = SalStrUpperX(dfLcv)
.head 6 -  Call SqlPrepareAndExecute(hSql(),
"SELECT kv,lcv,dig INTO :dfKv, :dfLcv, :nKvDig 
 FROM tabval WHERE " || sTmp || "=:dfLcv AND (d_close is null OR d_close>=bankdate)")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set dfKv  = 0
.head 7 -  Set dfLcv = ''
.head 7 -  Set nKvDig= 2
.head 6 -  Set hWndParent.Frm_Account.sLcv = dfLcv
.head 6 -  Set hWndParent.Frm_Account.nDig = nKvDig
.head 6 -  Call cmbValuta.SetSelectById(dfKv)
.head 3 +  Combo Box: cmbValuta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.05"
.head 5 -  Top:    2.155"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbValuta.Init(hWndItem)
.head 7 -  Call cmbValuta.Populate(hSql(), 'kv', 'name', 'tabval', 
'WHERE (d_close is null or d_close>=bankdate) ORDER by skv')
.head 7 -  !
.head 7 -  Call SalListClear(cmbValuta)
.head 7 -  Set i = 0
.head 7 +  While i < cmbValuta.nItemNum
.head 8 -  Set cmbValuta.strList[i, 1] = Right(SalStrRepeatX(' ', nLenKv) || cmbValuta.strList[i, 0], nLenKv ) || '  ' || cmbValuta.strList[i, 1]
.head 8 -  Call SalListAdd(cmbValuta, cmbValuta.strList[i, 1])
.head 8 -  Set i=i+1
.head 7 -  !
.head 7 -  Call cmbValuta.SetSelectById(dfKv)
.head 7 -  Set dfLcv = SalNumberToStrX(cmbValuta.nCurrentId,0)
.head 7 -  Call SalSendMsg(dfLcv, SAM_User, 0, 0)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  !
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfLcv = SalNumberToStrX(cmbValuta.nCurrentId,0)
.head 6 -  Call SalSendMsg(dfLcv, SAM_Validate, 0, 0)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SqlPrepareAndExecute(hSql(), T('SELECT nls FROM Saldo WHERE nls=:dfNls AND kv=:dfKv'))
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Лицевой счет с таким номером и валютой уже существует!
.head 7 -  Call MessageErrorInput(CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrNls'))
.head 7 -  Call SalSetFocus(dfNls)
.head 3 -  Background Text: Исполнитель:
.head 4 -  Resource Id: 2765
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.512"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIspCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.429"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 +  If SalIsNull(dfIspCode)
.head 7 -  Call SalListSetSelect(cmbUser, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbUser.SetSelectById(dfIspCode)
.head 6 +  If cmbUser.nCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Нет исполнителя с таким номером
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrIsp'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    2.429"
.head 5 -  Width:  3.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbUser.Init(hWndItem)
.head 7 -  Call cmbUser.Populate(hSql(), 'id', 'fio', 'Staff', 'WHERE type=1 and active=1 ORDER BY fio')
.head 7 -  Call cmbUser.SetSelectById(dfIspCode)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfIspCode = cmbUser.nCurrentId
.head 3 -  Background Text: А/П/АП (T020):
.head 4 -  Resource Id: 2766
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.774"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPap
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbPap
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    2.702"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbPap.Init(hWndItem)
.head 7 -  Call cmbPap.Populate(hSql(), 'pap', 'name', 'pap', '')
.head 7 -  Call cmbPap.SetSelectById(dfPap)
.head 7 +  If dfNbs and nPapPs != dfPap
.head 8 -  ! Признак АКТ-ПАС не отвечает плану счетов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrPap'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconHand)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfPap = cmbPap.nCurrentId
.head 6 -  Call hWndParent.Frm_Account.cAccount.setPap(dfPap)
.head 6 +  If dfNbs and nPapPs != dfPap
.head 7 -  ! Признак АКТ-ПАС не отвечает плану счетов
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.cTErrPap'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconHand)
.head 3 +  Data Field: dfXar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.3"
.head 6 -  Top:    2.69"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On UM_Choose
.head 6 -  Call SqlPrepareAndExecute(hSql(), T('SELECT name FROM Xar INTO :dfXar WHERE xar=:nXar'))
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 -  Background Text: Тип счета:
.head 4 -  Resource Id: 2768
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.048"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.964"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.067"
.head 5 -  Top:    2.964"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbTip.Init(hWndItem)
.head 7 -  Call cmbTip.Populate(hSql(), 'tip', 'name', 'v_nbs_tips', "where nbs " || IifS(dfNbs='', "is null", "='" || dfNbs || "'") || " order by ord")
.head 7 -  Call cmbTip.SetSelectById(dfTip)
.head 7 +  If dfNbs != '' AND hWndParent.Frm_Account.nRnk != NUMBER_Null AND hWndParent.Frm_Account.nAcc = 0
.head 8 -  Call SalEnableWindow(pbAccountMask)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfTip = cmbTip.strCurrentId
.head 6 +  If dfNbs != '' AND hWndParent.Frm_Account.nRnk != NUMBER_Null AND hWndParent.Frm_Account.nAcc = 0
.head 7 -  Call SalEnableWindow(pbAccountMask)
.head 3 -  Background Text: Признак счета:
.head 4 -  Resource Id: 2769
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.321"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbPos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    3.238"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbPos.Init(hWndItem)
.head 7 -  Call cmbPos.Populate(hSql(), 'pos', 'name', 'pos', 'ORDER BY pos')
.head 7 +  If dfPos != -1
.head 8 -  Call cmbPos.SetSelectById(dfPos)
.head 7 +  Else
.head 8 -  Call SalListSetSelect(cmbPos, 0)
.head 8 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 8 -  Set dfPos = cmbPos.nCurrentId
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfPos = cmbPos.nCurrentId
.head 3 -  Background Text: Вид счета (НИ):
.head 4 -  Resource Id: 2770
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.583"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    3.5"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbVid.Init(hWndItem)
.head 7 -  Call cmbVid.Populate(hSql(), 'vid', 'Name', 'vids', '')
.head 7 -  Call cmbVid.SetSelectById(dfVid)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVid = cmbVid.nCurrentId
.head 3 -  Background Text: МФО для процессинг.счета:
.head 4 -  Resource Id: 14681
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.857"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.774"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 +  If SalIsNull(dfMfo)
.head 7 -  Call SalListSetSelect(cmbMfo, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbMfo.SetSelectById(dfMfo)
.head 6 +  If cmbMfo.nCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.35"
.head 5 -  Top:    3.774"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.964"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbMfo.Init(hWndItem)
.head 7 -  Call cmbMfo.Populate(hSql(), "mfo", "nb", "banks", 
"WHERE (kodn is not null OR mfop=f_ourmfo AND mfou=f_ourmfo) AND (blk=0 OR blk=9 OR blk is null)
 ORDER BY 1")
.head 7 -  Call cmbMfo.SetSelectById(dfMfo)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfMfo = cmbMfo.nCurrentId
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.55"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pbAccountPlan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    0.738"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dfNbs = ShowRefPsEx(nK014)
.head 6 +  If SalSendMsg(dfNbs, SAM_Validate, 0, 0)
.head 7 -  Call f_chk_ob22()
.head 3 +  Picture: pbAccountOB22
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    1.05"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If Not SalIsNull( dfNbs )
.head 7 -  Call FunNSIGetFiltered( "V_SB_OB22", "OB22", 
"lnnvl( OPN_DT > gl.bd() ) and lnnvl( CLS_DT <= gl.bd() ) and R020 = "||dfNbs||" ORDER BY OB22" , sTmp, dfOB22 )
.head 7 +  If SalSendMsg( dfOB22, SAM_Validate, 0, 0 )
.head 8 -  Call SalSetFocus(dfNls)
.head 3 +  Picture: pbAccountMask
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    1.345"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SqlPrepareAndExecute(hSql(),
"SELECT substr(f_newnls2(null,:dfTip,:dfNbs,:nAccRnk,null),1,15)
      , substr(f_newnms (null,:dfTip,:dfNbs,:nAccRnk,null),1,70)
   INTO :sNlsTmp, :sNmsTmp
   FROM dual
") AND SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set dfNls = IifS(sNlsTmp!='', sNlsTmp, dfNls)
.head 7 -  Set dfNms = IifS(sNmsTmp!='', sNmsTmp, dfNms)
.head 7 +  If SalSendMsg(dfNls, SAM_Validate, 0, 0)
.head 8 -  Call SalSetFocus(dfNlsAlt)
.head 6 +  Else
.head 7 -  Set dfNls = ''
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Рассчитать № счета по маске
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.pbAccountMask'))
.head 3 -  Background Text: Код безбаланс. отделения:
.head 4 -  Resource Id: 63515
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.131"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTobo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTobo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    4.048"
.head 6 -  Width:  4.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 +  If SalIsNull(dfTobo)
.head 7 -  Call SalListSetSelect(cmbTobo, -1)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Call cmbTobo.SetSelectById(dfTobo)
.head 6 +  If cmbTobo.strCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Название безбал. отделения:
.head 4 -  Resource Id: 25211
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.381"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgToboName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTobo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    4.31"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.667"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If isTobo
.head 7 +  If cmbTobo.Init(hWndItem)
.head 8 -  ! если bPossibleToEdit=FALSE, возможно что счет закрыт и зарегистрирован на закрытое отделение, поэтому выбираем из всех отделений (tobo)
.head 8 -  Call cmbTobo.Populate(hSql(), 'tobo', 'name', IifS(bPossibleToEdit=TRUE, 'v_tobo_open', 'tobo'), sWhereTobo || " ORDER BY tobo")
.head 8 -  Call cmbTobo.SetSelectById(dfTobo)
.head 8 -  ! Если ТОБО не наше и не подчиненное, закрываем для редактирования
.head 8 +  If isTobo = 2 and sTobo != Subs(dfTobo, 1, Len(sTobo))
.head 9 -  Call SalDisableWindow(dfTobo)
.head 9 -  Call SalDisableWindow(cmbTobo)
.head 9 -  Call SqlPrepareAndExecute(hSql(), "select name into :sToboName from tobo where tobo=:dfTobo")
.head 9 +  If SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set cmbTobo = sToboName
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfTobo = cmbTobo.strCurrentId
.head 2 +  Functions
.head 3 +  Function: f_chk_ob22
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute( hSql(),
"select OB22
   from BARS.SB_OB22
  where lnnvl( D_OPEN > gl.bd() )
    and lnnvl( D_CLOSE <= gl.bd() )
    and R020 = :dfNbs" )
.head 5 +  If SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalEnableWindow( pbAccountOB22 )
.head 6 -  Call SalEnableWindow( dfOB22 )
.head 6 -  Call SalSetFocus( dfOB22 )
.head 5 +  Else
.head 6 -  Call SalDisableWindow( pbAccountOB22 )
.head 6 -  Call SalDisableWindow( dfOB22 )
.head 6 -  Call SalSetFocus( dfNls )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  Number: nK014
.head 3 -  !
.head 3 -  Number: nAccRnk
.head 3 -  !
.head 3 -  Number: isTobo
.head 3 -  String: sTobo
.head 3 -  String: sToboName
.head 3 -  String: sWhereTobo
.head 3 -  Number: i
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 3 -  String: sNlsTmp
.head 3 -  String: sNmsTmp
.head 3 -  Number: nBPos   ! позиция балансового счета
.head 3 -  Number: nBLen   ! длина балансового счета
.head 3 -  Number: nPapPs  ! признак АП из плана счетов
.head 3 -  Number: nXar
.head 3 -  Number: dfKv    ! цифровой код валюты (вместо datafielda) (MIK)
.head 3 -  Number: dfPap
.head 3 -  Number: dfPos
.head 3 -  Number: dfVid
.head 3 -  Number: nKvDig
.head 3 -  Number: nLenKv
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccGeneral')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc        = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccGeneral.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  Set nK014 = hWndParent.Frm_Account.nK014
.head 4 -  !
.head 4 -  Call SalDisableWindow(pbAccountMask)
.head 4 -  Call SalEnableWindow(dfNbs)
.head 4 -  Set nAccRnk = hWndParent.Frm_Account.nRnk
.head 4 -  Set isTobo = hWndParent.Frm_Account.isTOBO
.head 4 -  Set sWhereTobo = ""
.head 4 +  If isTobo 
.head 5 -  Set sTobo = hWndParent.Frm_Account.sTOBO
.head 5 +  If isTobo = 1 and sTobo != '' and sTobo != '0'
.head 6 -  Call SalDisableWindow(dfTobo)
.head 6 -  Call SalDisableWindow(cmbTobo)
.head 5 +  Else If isTobo = 2 and sTobo != ''
.head 6 -  Set sWhereTobo = " WHERE tobo like '" || sTobo || "%' "
.head 5 -  Set dfTobo = sTobo
.head 4 +  Else
.head 5 -  Call SalSetWindowLabelText(bgTobo, '')
.head 5 -  Call SalHideWindow(dfTobo)
.head 5 -  Call SalSetWindowLabelText(bgToboName, '')
.head 5 -  Call SalHideWindow(cmbTobo)
.head 5 -  Set dfTobo = ''
.head 4 -  !
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select max(length(to_char(kv))) into :nLenKv from tabval")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call SalSetMaxDataLength(dfLcv, nLenKv)
.head 4 +  If nLenKv > 3
.head 5 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.dfLcv, nWW, nWH)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.dfLcv, 1.4, nWH)
.head 5 -  Call SalGetWindowLoc(hWndForm.Dlg_AccGeneral.cmbValuta, nWW, nWH )
.head 5 -  Call SalSetWindowLoc(hWndForm.Dlg_AccGeneral.cmbValuta, 4.7, nWH )
.head 5 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.cmbValuta, nWW, nWH)
.head 5 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.cmbValuta, 3.35, nWH)
.head 4 -  !
.head 4 +  If nAcc = 0
.head 5 -  ! Умолчательные пар-ры
.head 5 -  Set dfNls = ''
.head 5 -  Set dfOB22 = ''
.head 5 -  Set dfPap = 0
.head 5 -  Set dfDateOn = hWndParent.Frm_Account.dBDat
.head 5 -  Set dfDateOff = DATETIME_Null
.head 5 -  Set dfKv  = GetBaseVal()
.head 5 -  Set dfTip = 'ODB'
.head 5 -  Set dfPos = -1
.head 5 -  Set dfVid = 0
.head 5 -  ! прячем МФО для процессингового счета
.head 5 -  Call SalDisableWindow(dfMfo)
.head 5 -  Call SalDisableWindow(cmbMfo)
.head 4 +  Else
.head 5 -  Set dfDateOn  = hWndParent.Frm_Account.cAccount.getDaos()
.head 5 -  Set dfDateOff = hWndParent.Frm_Account.cAccount.getDazs()
.head 5 -  Set dfNbs     = hWndParent.Frm_Account.cAccount.getNbs()
.head 5 -  Set dfOB22    = hWndParent.Frm_Account.cAccount.getOB22()
.head 5 -  Set dfNls     = hWndParent.Frm_Account.cAccount.getNls()
.head 5 -  Set dfNlsAlt  = hWndParent.Frm_Account.cAccount.getNlsAlt()
.head 5 -  Set dfNms     = hWndParent.Frm_Account.cAccount.getNms()
.head 5 -  Set dfKv      = hWndParent.Frm_Account.cAccount.getKv()
.head 5 -  Set dfPap     = hWndParent.Frm_Account.cAccount.getPap()
.head 5 -  Set dfTip     = hWndParent.Frm_Account.cAccount.getTip()
.head 5 -  Set dfVid     = hWndParent.Frm_Account.cAccount.getVid()
.head 5 -  Set dfPos     = hWndParent.Frm_Account.cAccount.getPos()
.head 5 -  Set dfIspCode = hWndParent.Frm_Account.cAccount.getIsp()
.head 5 -  Set dfMfo     = hWndParent.Frm_Account.cAccount.getProcMfo()
.head 5 -  Set dfTobo    = hWndParent.Frm_Account.cAccount.getTobo()
.head 5 -  ! прячем МФО для процессингового счета
.head 5 +  If SalIsNull(dfMfo)
.head 6 -  Call SalDisableWindow(dfMfo)
.head 6 -  Call SalDisableWindow(cmbMfo)
.head 5 -  Call SalDisableWindow(dfNbs)
.head 5 -  Call SalDisableWindow(dfOB22)
.head 5 -  Call SalDisableWindow(cmbValuta)
.head 5 -  Call SalDisableWindow(dfLcv)
.head 5 +  If bPossibleToEdit
.head 6 +  If hWndParent.Frm_Account.nMode != AVIEW_TECH
.head 7 -  Call SalDisableWindow(pbAccountPlan)
.head 7 -  Call SalDisableWindow(dfNameNbs)
.head 7 -  Call SalDisableWindow(dfNls)
.head 7 -  Call SalDisableWindow(pbAccountOB22)
.head 7 -  Call SalDisableWindow(dfNameOB22)
.head 7 -  Call SalDisableWindow(dfOB22)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccGeneral.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(pbAccountPlan)
.head 4 -  Call SalDisableWindow(dfNbs)
.head 4 -  Call SalDisableWindow(pbAccountOB22)
.head 4 -  Call SalDisableWindow(dfOB22)
.head 4 -  Call SalDisableWindow(dfNls)
.head 4 -  Call SalDisableWindow(dfNlsAlt)
.head 4 -  Call SalDisableWindow(dfNms)
.head 4 -  Call SalDisableWindow(dfLcv)
.head 4 -  Call SalDisableWindow(cmbValuta)
.head 4 -  Call SalDisableWindow(dfIspCode)
.head 4 -  Call SalDisableWindow(cmbUser)
.head 4 -  Call SalDisableWindow(cmbPap)
.head 4 -  Call SalDisableWindow(cmbTip)
.head 4 -  Call SalDisableWindow(cmbPos)
.head 4 -  Call SalDisableWindow(cmbVid)
.head 4 -  Call SalDisableWindow(dfMfo)
.head 4 -  Call SalDisableWindow(cmbMfo)
.head 4 -  Call SalDisableWindow(dfTobo)
.head 4 -  Call SalDisableWindow(cmbTobo)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.dfNameNbs, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.dfNameNbs,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.dfNameNbs, nWinWidth, FALSE)-5, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.dfNameOB22, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.dfNameOB22,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.dfNameOB22, nWinWidth, FALSE)-4.7, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.dfNms, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.dfNms,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.dfNms, nWinWidth, FALSE)-3.6, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.dfXar, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.dfXar,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.dfXar, nWinWidth, FALSE)-6.6, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.cmbMfo, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccGeneral.cmbMfo,
     SalPixelsToFormUnits(hWndForm.Dlg_AccGeneral.cmbMfo, nWinWidth, FALSE)-5.65, nWH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccGeneral.cmbTobo, nWW, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_AccSP
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Специальные параметры
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.5"
.head 4 -  Top:    0.5"
.head 4 -  Width:  9.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.714"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.5"
.head 6 -  Width:  8.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colSem
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование спецпараметра
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZsp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colZsp
.head 8 +  If bPossibleToEdit
.head 9 +  If not colHist
.head 10 -  ! F6 - для редактирования
.head 10 -  Set dfF4 = 'F6 - ' || CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTF6')
.head 10 +  If colNsiTabName != ''
.head 11 -  ! F4 - для вызова справочника
.head 11 -  Set dfF4 = dfF4 || ' F4 - ' || CurrentLangTable.GetAtomTitle('Dlg_AccSP.cTF4')
.head 9 +  Else
.head 10 -  ! Левый клик на заголовке строки - для редактирования
.head 10 -  Set dfF4 = CurrentLangTable.GetAtomTitle('cTLeftHeaderClickForEdit')
.head 7 +  On SAM_AnyEdit
.head 8 +  If colHist
.head 9 -  Set colZsp = sTmp
.head 9 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If bPossibleToEdit and not colHist
.head 9 -  Call setEdited()
.head 9 +  If not SalIsNull(colZsp)
.head 10 +  If colType = 'N' AND NOT SalIsValidNumber(colZsp)
.head 11 -  ! colSem : должно быть число!
.head 11 -  Call SalMessageBox(colSem || ' : ' || PutCrLf() || CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrNumber'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 11 -  Return VALIDATE_Cancel
.head 10 +  Else If colType = 'D'
.head 11 +  If NOT SalIsValidDateTime(colZsp)
.head 12 -  ! colSem : должна быть дата!
.head 12 -  Call SalMessageBox(colSem || ' : ' || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrData'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 12 -  Return VALIDATE_Cancel
.head 11 +  Else
.head 12 -  Set colZsp = SalFmtFormatDateTime(SalStrToDate(colZsp), 'dd/MM/yyyy')
.head 10 -  ! Проверка Max кол-ва символов
.head 10 +  If not SalIsNull(colMaxChar)
.head 11 +  If Len(colZsp) > colMaxChar
.head 12 -  Call SalMessageBox(colSem || ' : ' || PutCrLf() ||
     'Перевищено максимальну довжину значення спецпараметру!', CurrentLangTable.GetAtomTitle('cTAt'),
     MB_Ok | MB_IconExclamation)
.head 12 -  Return VALIDATE_Cancel
.head 10 -  ! Проверка введенного значения на вхождение в указанный справочник
.head 10 +  If colNsiTabName and colNsiColCheck
.head 11 -  Set sNsiFilter = getNsiFilter(colNsiSqlWhere)
.head 11 -  Call SqlPrepareAndExecute(hSqlAux(), "
     select count(*)
     into   :nCount
     from   " || colNsiTabName || "
     where  replace(to_char(" || colNsiColCheck || "),',','.')=replace('" || SalStrTrimX(colZsp) ||
            "',',','.')" || IifS(sNsiFilter!=STRING_Null, " and (" || sNsiFilter || ")", ""))
.head 11 +  If SqlFetchNext(hSqlAux(), nFetchRes) and not nCount
.head 12 -  ! Неверное значение реквизита! Выберите значение из справочника!
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrValOnNsi') || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrValOnNsi_'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 12 -  Set colZsp = ''
.head 12 -  Return VALIDATE_Cancel
.head 9 -  Set colZspSort = Subs(colZsp, 1, 250)
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If bPossibleToEdit and not colHist
.head 9 +  If wParam = VK_F4
.head 10 -  Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
.head 9 +  If wParam = VK_F6
.head 10 -  Set lsTmp = colZsp
.head 10 -  ! Редактирование реквизита
.head 10 -  Set lsTmp = ShowMemoEditor(CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTMemoEditor'), 1, 2000, lsTmp)
.head 10 +  If colZsp != lsTmp
.head 11 -  Set colZsp = lsTmp
.head 11 -  Set colZspSort = Subs(colZsp, 1, 250)
.head 11 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 11 -  Call setEdited()
.head 7 +  On SAM_DoubleClick
.head 8 +  If bPossibleToEdit and not colHist
.head 9 -  Set nRow = SalTblQueryContext(hWndForm)
.head 9 +  If colNsiTabName != ''
.head 10 -  Set sNsiFilter = getNsiFilter(colNsiSqlWhere)
.head 10 +  If colPkn = ''
.head 11 +  If FunNSIGetFiltered(colNsiTabName, '', sNsiFilter, s1, s2)
.head 12 -  Set tblSP.colZsp = s1
.head 12 -  Call setEdited()
.head 12 -  Call SalTblSetRowFlags(tblSP, nRow, ROW_Edited, TRUE)
.head 10 +  Else
.head 11 +  If FunNSIGetFilteredAltPK(colNsiTabName, colPkn, '', sNsiFilter, s1, s2)
.head 12 -  Set tblSP.colZsp = s1
.head 12 -  Call setEdited()
.head 12 -  Call SalTblSetRowFlags(tblSP, nRow, ROW_Edited, TRUE)
.head 9 -  Set colZspSort = Subs(colZsp, 1, 250)
.head 9 -  Call SalSetFocus(hWndForm)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 9 -  Call SalTblSetFocusCell(hWndForm, nRow, colZsp, 0, 0)
.head 7 +  On SAM_KillFocus
.head 8 -  Set sTmp = ''
.head 8 -  Set dfF4 = ''
.head 5 +  Column: colNsp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTabName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMaxChar
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiTabName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPkn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOldValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OldValue
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiSqlWhere
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOpt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак обязат. заполнения
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSqlVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: sql-выраж.для умолч.знач.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSpId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SpId
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNsiColCheck
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZspSort
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 250
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHist
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: getNsiFilter
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sStrFilter
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nTmp
.head 6 +  Actions
.head 7 -  Set nTmp = SalStrScan(sStrFilter, ':NBS')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sStrFilter = SalStrReplaceX(sStrFilter, nTmp, 4, "'"||sAccNbs||"'")
.head 8 -  Set nTmp = SalStrScan(sStrFilter, ':NBS')
.head 7 -  Set nTmp = SalStrScan(sStrFilter, ':NLS')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sStrFilter = SalStrReplaceX(sStrFilter, nTmp, 4, "'"||sAccNls||"'")
.head 8 -  Set nTmp = SalStrScan(sStrFilter, ':NLS')
.head 7 -  Set nTmp = SalStrScan(sStrFilter, ':ACC')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sStrFilter = SalStrReplaceX(sStrFilter, nTmp, 4, Str(nAcc))
.head 8 -  Set nTmp = SalStrScan(sStrFilter, ':ACC')
.head 7 -  Set nTmp = SalStrScan(sStrFilter, ':RNK')
.head 7 +  Loop
.head 8 +  If nTmp = -1
.head 9 -  Break
.head 8 -  Set sStrFilter = SalStrReplaceX(sStrFilter, nTmp, 4, Str(nRnk))
.head 8 -  Set nTmp = SalStrScan(sStrFilter, ':RNK')
.head 7 -  Return sStrFilter
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Number: i
.head 5 -  Number: nRow
.head 5 -  String: sTmp
.head 5 -  Long String: lsTmp
.head 5 -  String: sVal
.head 5 -  Number: nCount
.head 5 -  String: sNsiFilter
.head 5 -  !
.head 5 -  : cPar
.head 6 -  Class: cParHist
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), "
     select sp_id, sp_name, sp_semantic, sp_tabname, sp_type, sp_maxchar, sp_nsiname, sp_pkname, sp_nsisqlwhere,
            nvl(sp_opt,0), sp_defsqlval, sp_check, sp_hist
     into   :colSpId, :colNsp, :colSem, :colTabName, :colType, :colMaxChar, :colNsiTabName, :colPkn, :colNsiSqlWhere,
            :colOpt, :colSqlVal, :colNsiColCheck, :colHist
     from   v_ps_sparam
     where  nbs " || IifS(sAccNbs=STRING_Null,
            IifS(Subs(sAccNls,1,1)='0', "is null", "=substr(:sAccNls,1,4)"), "=:sAccNbs") || " and code=:sCode
     order by nvl(sp_opt,0) desc, sp_semantic", TBL_FillAll)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set colZsp      = hWndParent.Dlg_AccSPTab.getSParamsValueBySpId(colSpId)
.head 6 -  Set colOldValue = colZsp
.head 6 -  Set colZspSort  = Subs(colZsp, 1, 250)
.head 6 +  If bPossibleToEdit
.head 7 +  If colOpt = '1'
.head 8 -  Call SalTblSetCellTextColor(colSem, COLOR_DarkRed, FALSE)
.head 8 -  Call SalTblSetCellTextColor(colZsp, COLOR_DarkRed, FALSE)
.head 7 +  If colNsiTabName and not colHist
.head 8 -  Call XSalTblSetCellBackColor(colZsp, SalColorFromRGB(230, 255, 255))
.head 6 +  If colHist
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
.head 5 +  On UM_Update
.head 6 -  ! Сохраняем значения
.head 6 -  ! 1 - по валютам (сохраняем все заполненные спецпараметры)
.head 6 +  If wParam = 1
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If colZsp
.head 9 -  Call hWndParent.Dlg_AccSPTab.setSParamsValue(colSpId, colNsp, colZsp)
.head 6 +  Else
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call hWndParent.Dlg_AccSPTab.setSParamsValue(colSpId, colNsp, colZsp)
.head 8 +  If colZsp != colOldValue
.head 9 -  Call SaveInfoToLog('ACCOUNTS. Изменение спецпараметров счета ' || sAccNls || '(' || Str(nAccKv) || ')' || ': <'
     || colSem || '><' || colNsp || '>: "' || colOldValue || '" => "' || colZsp || '"')
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On SAM_User
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If colZsp = '' AND colSqlVal != ''
.head 8 +  If SqlPrepareAndExecute(hSql(), colSqlVal || " INTO :sVal") AND
   SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set colZsp = sVal
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 -  Call setEdited()
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 +  If SalTblQueryColumnID(hColumn) = SalTblQueryColumnID(colZsp)
.head 7 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(colZspSort), nOrderBy)
.head 7 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 +  Else
.head 7 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 7 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If colHist
.head 7 -  Set cPar.nND             = nAcc
.head 7 -  Set cPar.nParId          = colSpId
.head 7 -  Set cPar.sParSemantic    = colSem
.head 7 -  Set cPar.sTabName        = colTabName
.head 7 -  Set cPar.sKeyName        = 'acc'
.head 7 -  Set cPar.sValName        = colNsp
.head 7 -  Set cPar.sType           = colType
.head 7 -  Set cPar.sNsiTabName     = colNsiTabName
.head 7 -  Set cPar.sNsiPkName      = colPkn
.head 7 -  Set cPar.sNsiSqlWhere    = colNsiSqlWhere
.head 7 -  Set cPar.sNsiColumnCheck = colNsiColCheck
.head 7 -  Set sVal = colZsp
.head 7 -  Call SalModalDialog(dlgParHist, hWndForm, cPar, bPossibleToEdit, sVal)
.head 7 -  Set colZsp = sVal
.head 7 -  Call hWndParent.Dlg_AccSPTab.setSParamsValue(colSpId, colNsp, colZsp)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 +  Data Field: dfF4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.012"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbSPOpt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Проверять заполнение обязательных спецпараметров
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.15"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Dlg_AccSPTab.setEdited()
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  String: sCode
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  Number: nRowErr
.head 3 -  String: sAccNbs
.head 3 -  String: sAccNls
.head 3 -  Number: nAccKv
.head 3 -  Number: nRnk
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeigh
.head 3 -  Number: nTblX0
.head 3 -  Number: nTblY0
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeigh
.head 3 -  String: s1
.head 3 -  String: s2
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccSP')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit = hWndParent.Dlg_AccSPTab.nFlagEdit
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set sAccNbs = hWndParent.Dlg_AccSPTab.sAccNbs
.head 4 -  Set sAccNls = hWndParent.Dlg_AccSPTab.getNls()
.head 4 -  Set nAccKv  = hWndParent.Dlg_AccSPTab.getKv()
.head 4 -  Set nRnk = hWndParent.Dlg_AccSPTab.nRnk
.head 4 -  Set cbSPOpt = TRUE
.head 4 +  If bPAR_ACCMSP
.head 5 -  Call SalDisableWindow(cbSPOpt)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 3 +  On UM_Insert
.head 4 -  Set sCode = hWndParent.Dlg_AccSPTab.sCode
.head 4 -  Call SalSendMsg(hWndForm.Dlg_AccSP.tblSP, UM_Populate, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(cbSPOpt)
.head 4 -  Call SalSendMsg(tblSP, SAM_DoInit, 0, 0)
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg(tblSP, UM_Update, wParam, lParam)
.head 3 +  On SAM_User
.head 4 -  Call SalSendMsg(tblSP, SAM_User, wParam, lParam)
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка на обязательное заполнение
.head 4 +  If cbSPOpt
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tblSP, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(tblSP, nRow)
.head 6 +  If tblSP.colOpt = '1' AND tblSP.colZsp = ''
.head 7 -  ! Не заполнен реквизит <tblSP.colSem>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrRekv') || ' <' || tblSP.colSem || '>', 
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 7 -  Set nRowErr = nRow
.head 7 -  Return 2
.head 3 +  On UM_Clear
.head 4 -  Call SalSetFocus(tblSP)
.head 4 -  Call SalTblSetFocusRow(tblSP, nRowErr)
.head 4 -  Call SalTblSetFocusCell(tblSP, nRowErr, tblSP.colZsp, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccSP.tblSP, SalPixelsToFormUnits(hWndForm.Dlg_AccSP.tblSP, nWinWidth, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_AccSP.tblSP, nWinHeigh, TRUE)-0.75)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccSP.dfF4, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccSP.dfF4, SalPixelsToFormUnits(hWndForm.Dlg_AccSP.dfF4, nWinWidth, FALSE), nWH)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_AccSP.dfF4, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_AccSP.dfF4, nWW, SalPixelsToFormUnits(hWndForm.Dlg_AccSP.dfF4, nWinHeigh, TRUE)-0.23)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Form Window: Dlg_AccSPTab
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.183"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.869"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 6162426F74746F6D 4D617267696E0002 0030000054616250
0040: 616765436F756E74 0002003100005461 624C6162656C7300 07004C6162656C30
0060: 00005461624E616D 65730006004E616D 6530000054616252 696768744D617267
0080: 696E000200300000 5461624472617753 74796C65000B0057 696E39355374796C
00A0: 650000546162466F 726D506167657300 0100000054616254 6F704D617267696E
00C0: 0002003000000000 0000000000000000 0000000000000000 0000
.enddata
.data CLASSPROPSSIZE
0000: DA00
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  !
.head 6 -  Set nTabNum = 0
.head 6 -  Set i = 0
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute(hSql(),
"select unique code, code_name, code_ord
   into :sCode, :sCodeName, :sCodeOrd
   from v_ps_sparam
  where nbs " || IifS(sAccNbs=STRING_Null,"is null","= :sAccNbs") || "
  order by code_ord")
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set cTabSP[i].Label = sCodeName
.head 7 -  Set cTabSP[i].Name = sCode
.head 7 -  Set cTabSP[i].DlgName = 'Dlg_AccSP'
.head 7 -  Set cTabSP[i].EditMode = 2
.head 7 -  Call createTab(cTabSP[i], FALSE)
.head 7 -  Set i = i + 1
.head 6 -  ! Удаляем последнюю пустую закладку
.head 6 -  Call picTabs.Delete(nTabNum, TRUE)
.head 6 -  ! Инициализация закладок
.head 6 -  Call picTabs.InitializeFormPages(
     SalNumberToStrX(nAcc,0) || ';' ||
     Str(SalWindowHandleToNumber(hWndForm)) )
.head 6 -  ! Показываем первую закладку
.head 6 -  Call picTabs.BringToTop(0, TRUE)
.head 6 -  Set nPrevActivTab = 0
.head 5 +  On TABSM_TabActivateStart
.head 6 -  Call SalSendMsg(picTabs.Items[nPrevActivTab].m_hWndPage, UM_Update, 0, 0)
.head 6 -  Call GetName(wParam, sTabName)
.head 6 -  Set nTab = GetTop()
.head 6 -  Set sCode = cTabSP[nTab].Name
.head 6 -  Call SalSendMsg(picTabs.Items[nTab].m_hWndPage, UM_Insert, 0, 0)
.head 6 -  Set nPrevActivTab = nTab
.head 2 +  Functions
.head 3 +  Function: createTab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  : Tab
.head 6 -  Class: cAccTab
.head 5 -  Boolean: bDisableTab	! Насильно закрыть закладку для редактирования (напр., при рег. нового счета)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call picTabs.Insert(nTabNum,TRUE)
.head 5 -  Call picTabs.SetLabel(nTabNum, Tab.Label, TRUE)
.head 5 -  Call picTabs.SetName(nTabNum, Tab.Name)
.head 5 +  If bDisableTab
.head 6 -  Call picTabs.Enable(nTabNum, FALSE)
.head 5 +  ! Else
.head 6 +  If Tab.EditMode != TAB_Hide and Tab.DlgName
.head 7 -  Call picTabs.AddPage(Tab.Name, Tab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(Tab.EditMode=TAB_Hide, FALSE, TRUE))
.head 5 +  Else
.head 6 +  If nFlagEdit != TAB_Hide and Tab.DlgName
.head 7 -  Call picTabs.AddPage(Tab.Name, Tab.DlgName, hWndNULL)
.head 6 -  Call picTabs.Enable(nTabNum, IifN(nFlagEdit=TAB_Hide, FALSE, TRUE))
.head 5 -  Call picTabs.CreatePage(Tab.Name)
.head 5 -  Set Tab.TabNum = nTabNum
.head 5 -  Set nTabNum = nTabNum + 1
.head 5 -  Return TRUE
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 +  Function: getSParamsParNum
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getSParamsParNum()
.head 3 +  Function: getSParamCode
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getSParamCode(nIndex)
.head 3 +  Function: getSParamsValueBySpId
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nSpId
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sRet
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getSParamsValueBySpId(nSpId)
.head 3 +  Function: setSParamsValue
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nSpId
.head 5 -  String: sNsp
.head 5 -  String: sZsp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.setSParamsValue(nSpId, sNsp, sZsp)
.head 3 +  Function: getNls
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getNls()
.head 3 +  Function: getNbs
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getNbs()
.head 3 +  Function: getKv
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getKv()
.head 3 +  Function: populateAccSParams
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.populateAccSParams()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  !
.head 3 -  : cTabSP[*]
.head 4 -  Class: cAccTab
.head 3 -  Number: nTabNum
.head 3 -  Number: nTab
.head 3 -  String: sTabName
.head 3 -  String: sCode
.head 3 -  String: sCodeName
.head 3 -  String: sCodeOrd
.head 3 -  Number: i
.head 3 -  Number: nPrevActivTab
.head 3 -  !
.head 3 -  Number: nRet
.head 3 -  Number: nErrTab
.head 3 -  !
.head 3 -  String: sAccNbs
.head 3 -  Number: nRnk
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccSPTab')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccSP.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 -  !
.head 4 -  Set sAccNbs = hWndParent.Frm_Account.cAccount.getNbs()
.head 4 -  Set nRnk = hWndParent.Frm_Account.nRnk
.head 4 -  !
.head 4 -  Call SalSendMsg(picTabs, UM_ObjActivate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccSP.hWnd = hWndForm
.head 3 +  On SAM_User
.head 4 -  ! Заполнение умолчательными значениями
.head 4 -  Set i = 0
.head 4 +  While i < nTabNum
.head 5 -  Call picTabs.BringToTop(i, TRUE)
.head 5 -  Set nRet = SalSendMsg(picTabs.Items[i].m_hWndPage, SAM_User, 0, 0)
.head 5 -  Set i = i + 1
.head 4 -  Call picTabs.BringToTop(0, TRUE)
.head 4 -  Return nRet
.head 3 +  On UM_Update
.head 4 -  Set i = 0
.head 4 +  While i < nTabNum
.head 5 -  Call SalSendMsg(picTabs.Items[i].m_hWndPage, UM_Update, 0, 0)
.head 5 -  Set i = i + 1
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка на обязательное заполнение
.head 4 -  Set i = 0
.head 4 +  While i < nTabNum
.head 5 -  Call picTabs.BringToTop(i, TRUE)
.head 5 -  Set nRet = SalSendMsg(picTabs.Items[i].m_hWndPage, UM_BeforeClose, 0, 0)
.head 5 +  If nRet = 2
.head 6 -  Set nErrTab = picTabs.GetTop()
.head 6 -  Break
.head 5 -  Set i = i + 1
.head 4 -  Return nRet
.head 3 +  On UM_Clear
.head 4 -  Call SalSendMsg(picTabs.Items[nErrTab].m_hWndPage, UM_Clear, 0, 0)
.head 1 +  Dialog Box: Dlg_AccRights
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.233"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.429"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Установка прав доступа к счетам
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  11.717"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Выбранные группы
.head 4 -  Resource Id: 49602
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.2"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAccGrp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblGrp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.45"
.head 6 -  Width:  3.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.655"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № группы
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 +  If nAcc
.head 7 -  Call SalTblPopulate(hWndForm, hSql(), 
"SELECT g.id, g.name 
   INTO :colId, :colName
   FROM groups_acc g, table(sec.getAgrp(:nAcc)) b 
  WHERE g.id=b.column_value 
  ORDER BY g.id", TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tblGrp, hWndNULL)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 -  Background Text: Доступные группы
.head 4 -  Resource Id: 49603
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.15"
.head 5 -  Top:    0.2"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAllGrp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfGrpAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.15"
.head 6 -  Top:    0.202"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! 'Доступные группы'
.head 6 -  Set dfGrpAll = CurrentLangTable.GetAtomTitle('Dlg_AccRights.bgAllGrp')
.head 6 -  Call SalShowWindow(dfGrpAll)
.head 6 -  Call SalHideWindowAndLabel(bgAllGrp)
.head 3 +  Child Table: tblGrpAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.317"
.head 6 -  Top:    0.45"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.643"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № группы
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"SELECT g.id, g.name 
   INTO :colId, :colName
   FROM v_groups_acc g " || IifS(nAcc=0, "", "
  WHERE g.id not in (select b.column_value from table(sec.getAgrp(:nAcc)) b)") || "
  ORDER BY g.id", TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(tblGrpAll, hWndNULL)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Picture: pbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.183"
.head 5 -  Top:    0.714"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.35"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\UNDO.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Добавить счет в выбранные группы
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccRights.pbAdd'))
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblGrpAll, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(tblGrpAll, nRow)
.head 7 -  Set nRowNew = SalTblInsertRow(tblGrp, TBL_MaxRow)
.head 7 -  Call SalTblSetRowFlags(tblGrp, nRowNew, ROW_New,
     NOT (SalTblQueryRowFlags(tblGrpAll, nRow, ROW_New)))
.head 7 -  Set tblGrp.colId = tblGrpAll.colId
.head 7 -  Set tblGrp.colName = tblGrpAll.colName
.head 7 -  Call SalTblDeleteRow(tblGrpAll, nRow, TBL_NoAdjust)
.head 7 -  Set nRow = nRow - 1
.head 6 -  Call VisTblAutoSizeColumn(tblGrp, hWndNULL)
.head 5 +  On SAM_User
.head 6 -  ! Предназначено для выбора группы из профиля
.head 6 +  If wParam
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tblGrpAll, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(tblGrpAll, nRow)
.head 8 +  If tblGrpAll.colId = wParam
.head 9 -  Call SalTblSetRowFlags(tblGrpAll, nRow, ROW_Selected, TRUE)
.head 9 -  Call SalSendMsg(pbAdd, SAM_Click, 0, 0)
.head 9 -  Break
.head 3 +  Picture: pbDrop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.117"
.head 5 -  Top:    1.536"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.35"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\UNDO1.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Удалить счет из выбранных групп
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccRights.pbDrop'))
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblGrp, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(tblGrp, nRow)
.head 7 -  Set nRowNew = SalTblInsertRow(tblGrpAll, TBL_MaxRow)
.head 7 -  Call SalTblSetRowFlags(tblGrpAll, nRowNew, ROW_New,
     NOT (SalTblQueryRowFlags(tblGrp, nRow, ROW_New)) )
.head 7 -  Set tblGrpAll.colId = tblGrp.colId
.head 7 -  Set tblGrpAll.colName = tblGrp.colName
.head 7 -  Call SalTblDeleteRow(tblGrp, nRow, TBL_NoAdjust)
.head 7 -  Set nRow = nRow - 1
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Number: nGrp
.head 3 -  Number: nId
.head 3 -  String: sName
.head 3 -  Number: nIndex
.head 3 -  Number: nRow
.head 3 -  Number: nRowNew
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccRights')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccRights.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 +  If nAcc = 0
.head 5 -  Set nGrp = NUMBER_Null
.head 4 +  Else
.head 5 -  Set nGrp = hWndParent.Frm_Account.cAccount.getGrp()
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(tblGrp, UM_Populate, 0, 0)
.head 4 -  Call SalSendMsg(tblGrpAll, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccRights.hWnd = hWndForm
.head 3 +  On UM_Update
.head 4 -  Set nRow = TBL_MinRow
.head 4 -  Set nGrp = NUMBER_Null
.head 4 +  While SalTblFindNextRow(tblGrp, nRow, 0, 0)
.head 5 -  Call SalTblSetContext(tblGrp, nRow)
.head 5 -  Set nGrp = tblGrp.colId
.head 5 +  If SalTblQueryRowFlags(tblGrp, nRow, ROW_New)
.head 6 -  Call hWndParent.Frm_Account.cAccount.addAccRights(tblGrp.colId,  tblGrp.colName)
.head 6 -  Call SaveInfoToLog('ACCOUNTS. Добавление счета ' || hWndParent.Frm_Account.cAccount.getNls() || '(' ||
  Str(hWndParent.Frm_Account.cAccount.getKv()) || ')' || ') в группу ' ||
  Str(tblGrp.colId) || '<' || tblGrp.colName || '>')
.head 6 -  Call SalTblSetRowFlags(tblGrp, nRow, ROW_New, FALSE)
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(tblGrpAll, nRow, ROW_New, 0)
.head 5 -  Call SalTblSetContext(tblGrpAll, nRow)
.head 5 -  Call hWndParent.Frm_Account.cAccount.dropAccRights(tblGrpAll.colId)
.head 5 -  Call SaveInfoToLog('ACCOUNTS. Удаление счета ' || hWndParent.Frm_Account.cAccount.getNls() || '(' ||
  Str(hWndParent.Frm_Account.cAccount.getKv()) || ')' || ') из группы ' ||
  Str(tblGrpAll.colId) || '<' || tblGrpAll.colName || '>')
.head 5 -  Call SalTblSetRowFlags(tblGrpAll, nRow, ROW_New, FALSE)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(pbAdd)
.head 4 -  Call SalDisableWindow(pbDrop)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccRights.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  !
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccRights.tblGrp,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.tblGrp, nWinWidth, FALSE)/2 - 0.75,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.tblGrp, nWinHeight, TRUE) - 0.6)
.head 4 -  !
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_AccRights.dfGrpAll, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_AccRights.dfGrpAll,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.dfGrpAll, nWinWidth, FALSE)/2 + 0.5, nWH)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_AccRights.tblGrpAll, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_AccRights.tblGrpAll,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.tblGrpAll, nWinWidth, FALSE)/2 + 0.5, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccRights.tblGrpAll,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.tblGrpAll, nWinWidth, FALSE)/2 - 0.75,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.tblGrpAll, nWinHeight, TRUE) - 0.6)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_AccRights.pbAdd,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.pbAdd, nWinWidth, FALSE)/2 - 0.25,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.pbAdd, nWinHeight, TRUE)/2 - 0.3)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_AccRights.pbDrop,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.pbDrop, nWinWidth, FALSE)/2 - 0.25,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRights.pbDrop, nWinHeight, TRUE)/2 + 0.1)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_AccSob
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.548"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pbIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.067"
.head 5 -  Top:    0.036"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Добавить запись'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipIns'))
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendMsg(tblAccSob, UM_Insert, 0, 0)
.head 3 +  Picture: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    0.036"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Удалить запись'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipDel'))
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendMsg(tblAccSob, UM_Delete, 0, 0)
.head 3 +  Child Table: tblAccSob
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.4"
.head 6 -  Width:  8.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.048"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
п/п
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
события
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 8 +  If colDAT < dBankDate
.head 9 -  ! Call SalMessageBox( 'Дата должна быть не меньше банковской!', 'Ошибка!', MB_IconExclamation|MB_Ok  )
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_AccSob.cTErrDAT'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation|MB_Ok)
.head 9 -  Set colDAT = dBankDate
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: colISP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид.
исп.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ФИО
исполнителя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTXT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Текст
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 4000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 5 +  Column: colTXT250
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Текст
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4000
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nRow
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set nRow = 0
.head 6 +  While nRow < hWndParent.Frm_Account.cAccount.getSobParNum()
.head 7 -  Call SalTblInsertRow(hWndForm, nRow)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 7 -  Call hWndParent.Frm_Account.cAccount.getSobValue(nRow,
  colID, colISP, colFIO, colDAT, colTXT)
.head 7 -  Set colTXT250 = colTXT
.head 7 -  Set nRow = nRow + 1
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colDAT < dBankDate
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray) ! серый
.head 6 +  Else If colDAT = dBankDate
.head 7 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightAqua)  ! голубой
.head 6 -  Set colTXT250 = Subs(colTXT,1,250)
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 +  If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
  not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 7 +  Else
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 5 +  On UM_Insert
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRow, colDAT, 0, 1)
.head 6 -  Set colDAT = dBankDate
.head 6 -  Set colISP = nUserId
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted) 
OR tblAccSob.colDAT = DATETIME_Null AND tblAccSob.colTXT = STRING_Null
.head 8 -  Call hWndParent.Frm_Account.cAccount.setSobValue(colID, NUMBER_Null, DATETIME_Null, STRING_Null)
.head 7 +  Else
.head 8 -  Call hWndParent.Frm_Account.cAccount.setSobValue(colID, colISP, colDAT, colTXT)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited | ROW_New | ROW_MarkDeleted, FALSE)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(colTXT), COL_GetID)
.head 7 -  Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(colTXT250), COL_GetID))
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Number: nUserId
.head 3 -  Date/Time: dBankDate
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 3 -  Number: nTblX0
.head 3 -  Number: nTblY0
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeight
.head 3 -  Number: nColWidth
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccSob')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccSob.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set dBankDate = hWndParent.Frm_Account.dBDat
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(tblAccSob, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccSob.hWnd = hWndForm
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg(tblAccSob, UM_Update, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalSendMsg(tblAccSob, SAM_DoInit, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccSob.tblAccSob,
     SalPixelsToFormUnits(hWndForm.Dlg_AccSob.tblAccSob, nWinWidth, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_AccSob.tblAccSob, nWinHeight, TRUE)-0.43)
.head 4 -  Call GetClientRect(hWndForm.Dlg_AccSob.tblAccSob, nTblX0, nTblY0, nTblWidth, nTblHeight)
.head 4 -  Call SalTblSetColumnWidth(hWndForm.Dlg_AccSob.tblAccSob.colTXT, 
     IifN(nColWidth<SalPixelsToFormUnits(hWndForm.Dlg_AccSob.tblAccSob, nTblWidth, FALSE)-5.1, 
          SalPixelsToFormUnits(hWndForm.Dlg_AccSob.tblAccSob, nTblWidth, FALSE)-5.1, 
          nColWidth))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_AccFinancial
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.881"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Лимит овердрафта:
.head 4 -  Resource Id: 47097
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.286"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  ! Data Field: dfLimitSign
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.2"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfLimitOs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If bPossibleToEdit
.head 7 +  If hWndParent.Frm_Account.cAccount.getPap() = ACTIV 
OR hWndParent.Frm_Account.cAccount.getPap() = PASSIV
.head 8 -  Call SalEnableWindow(hWndItem)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(hWndItem)
.head 5 +  On SAM_Validate
.head 6 +  If dfLimitOs = ''
.head 7 -  Set dfLimitOs = '0'
.head 6 +  If NOT SalIsValidNumber(dfLimitOs)
.head 7 -  Set dfLimitOs = '0'
.head 6 +  If Val(dfLimitOs) < 0
.head 7 -  Set dfLimitOs = SalStrRightX(dfLimitOs, SalStrLength(dfLimitOs)-1)
.head 6 +  If hWndParent.Frm_Account.nDig != 0
.head 7 -  Set dfLimitOs = Dig4( SalStrToNumber(dfLimitOs)*SalNumberPower(10,hWndParent.Frm_Account.nDig )/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig )
.head 6 -  ! nLimitOs в коп. и со знаком
.head 6 -  Set nLim = Abs(SalStrToNumber(dfLimitOs)*SalNumberPower(10,hWndParent.Frm_Account.nDig))
.head 6 -  Set dfLimitMinus = ''
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_AnyEdit
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 +  Data Field: dfMaxLimitOvr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.8"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Неснижаемый остаток:
.head 4 -  Resource Id: 60604
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.548"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLimitMinus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLimitMinus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.488"
.head 6 -  Width:  3.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If bPossibleToEdit
.head 7 +  If hWndParent.Frm_Account.cAccount.getPap() = ACTIV 
OR hWndParent.Frm_Account.cAccount.getPap() = PASSIV
.head 8 -  Call SalEnableWindow(hWndItem)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(hWndItem)
.head 5 +  On SAM_Validate
.head 6 +  If dfLimitMinus = ''
.head 7 -  Set dfLimitMinus = '0'
.head 6 +  If NOT SalIsValidNumber(dfLimitMinus)
.head 7 -  Set dfLimitMinus = '0'
.head 6 +  If Val(dfLimitMinus) < 0
.head 7 -  Set dfLimitMinus = Str(Abs(Val(dfLimitMinus)))
.head 6 +  If hWndParent.Frm_Account.nDig != 0
.head 7 -  Set dfLimitMinus = Dig4( SalStrToNumber(dfLimitMinus)*SalNumberPower(10,hWndParent.Frm_Account.nDig )/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig )
.head 6 -  ! dfLimitMinus в коп. и со знаком
.head 6 -  Set nLim = -Abs(SalStrToNumber(dfLimitMinus)*SalNumberPower(10,hWndParent.Frm_Account.nDig))
.head 6 -  Set dfLimitOs = ''
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_AnyEdit
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 -  Background Text: Max остаток на счете:
.head 4 -  Resource Id: 47098
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.821"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMaxLim
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMaxLimSign
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.738"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMaxLimOs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    0.738"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMaxLimOs = ''
.head 7 -  Set dfMaxLimSign = ''
.head 7 -  Set nOstx = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SalIsValidNumber(dfMaxLimOs)
.head 7 -  Set dfMaxLimOs = ''
.head 7 -  Set dfMaxLimSign = ''
.head 7 -  Set nOstx = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Val(dfMaxLimOs) < 0
.head 7 -  Set dfMaxLimSign = '-'
.head 7 -  Set dfMaxLimOs = SalStrRightX(dfMaxLimOs, SalStrLength( dfMaxLimOs )-1)
.head 6 +  Else If Val(dfMaxLimOs) > 0
.head 7 -  Set dfMaxLimSign = '+'
.head 6 +  Else
.head 7 -  Set dfMaxLimSign = ''
.head 6 +  If hWndParent.Frm_Account.nDig != 0
.head 7 -  Set dfMaxLimOs = Dig4( SalStrToNumber(dfMaxLimOs)*SalNumberPower(10,hWndParent.Frm_Account.nDig)/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig)
.head 6 -  ! Сразу переводим nMaxLimOs в коп. и со знаком
.head 6 -  Set nOstx = SalStrToNumber(dfMaxLimOs)*SalNumberPower(10,hWndParent.Frm_Account.nDig)
.head 6 +  If dfMaxLimSign = '-'
.head 7 -  Set nOstx = nOstx*-1
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_AnyEdit
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 -  Background Text: Дата последней операции:
.head 4 -  Resource Id: 47095
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.095"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDapp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDapp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.012"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: 99/99/9999
.head 4 -  Message Actions
.head 3 -  Background Text: Блокировка по Дебету:
.head 4 -  Resource Id: 10133
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.369"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVidBlkD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVidBlkD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    1.286"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbVidBlkD.Init(hWndItem)
.head 7 -  Call cmbVidBlkD.Populate(hSql(), 'rang', 'Name', 'rang', '')
.head 7 -  Call cmbVidBlkD.SetSelectById(dfVidBlkD)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVidBlkD = cmbVidBlkD.nCurrentId
.head 3 -  Background Text: Блокировка по Кредиту:
.head 4 -  Resource Id: 10134
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.631"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVidBlkK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVidBlkK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    1.55"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbVidBlkK.Init(hWndItem)
.head 7 -  Call cmbVidBlkK.Populate(hSql(), 'rang', 'Name', 'rang', '')
.head 7 -  Call cmbVidBlkK.SetSelectById(dfVidBlkK)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVidBlkK = cmbVidBlkK.nCurrentId
.head 3 -  Background Text: в Номинале
.head 4 -  Resource Id: 47096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.88"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Обороты:
.head 4 -  Resource Id: 47091
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.202"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Д
.head 4 -  Resource Id: 47092
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    2.202"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    2.119"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: К
.head 4 -  Resource Id: 47093
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    2.476"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    2.393"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Остаток:
.head 4 -  Resource Id: 47094
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.738"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOst
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSignIv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.655"
.head 6 -  Width:  0.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfOstc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    2.66"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: в Эквиваленте
.head 4 -  Resource Id: 10135
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.95"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: cTEqv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Обороты:
.head 4 -  Resource Id: 10138
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.25"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgObq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Д
.head 4 -  Resource Id: 10139
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    3.25"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDosq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    3.167"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: К
.head 4 -  Resource Id: 10136
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    3.524"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKosq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    3.44"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Остаток:
.head 4 -  Resource Id: 10137
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.798"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOstq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSignIvQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.714"
.head 6 -  Width:  0.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfOstq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    3.71"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    1.97"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Number: nOstc
.head 3 -  Number: nDos
.head 3 -  Number: nKos
.head 3 -  Number: nOstq
.head 3 -  Number: nDosq
.head 3 -  Number: nKosq
.head 3 -  Number: nLim
.head 3 -  Number: nOstx
.head 3 -  Number: dfVidBlkD
.head 3 -  Number: dfVidBlkK
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccFinancial')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccFinancial.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Call SalSetWindowLabelText(bgVidBlkD, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgVidBlkD'))
.head 4 -  Call SalSetWindowLabelText(bgVidBlkK, CurrentLangTable.GetAtomTitle('Dlg_AccGeneral.bgVidBlkK'))
.head 4 -  ! Обороты:
.head 4 -  Call SalSetWindowLabelText(bgObq, CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgOb'))
.head 4 -  ! Д
.head 4 -  Call SalSetWindowLabelText(bgDq, CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgD'))
.head 4 -  ! К
.head 4 -  Call SalSetWindowLabelText(bgKq, CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgK'))
.head 4 -  ! Остаток:
.head 4 -  Call SalSetWindowLabelText(bgOstq, CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgOst'))
.head 4 -  ! Пока прячем поле "Расчет лимита овердрафта" - работает по параметру в params для каких-то счетов
.head 4 -  Call SalHideWindow(dfMaxLimitOvr)
.head 4 +  If GetGlobalOption('EQV') != 'YES'
.head 5 -  Call SalHideWindow(dfDosq)
.head 5 -  Call SalHideWindow(dfKosq)
.head 5 -  Call SalHideWindow(dfOstq)
.head 5 -  Call SalHideWindow(dfSignIvQ)
.head 5 -  Call SalHideWindowAndLabel(cTEqv)
.head 5 -  Call SalHideWindowAndLabel(bgObq)
.head 5 -  Call SalHideWindowAndLabel(bgDq)
.head 5 -  Call SalHideWindowAndLabel(bgKq)
.head 5 -  Call SalHideWindowAndLabel(bgOstq)
.head 4 -  !
.head 4 +  If nAcc = 0
.head 5 -  Set dfLimitOs = '0'
.head 5 -  Set dfLimitMinus = ''
.head 5 -  Set nLim = NUMBER_Null
.head 5 -  Set nOstx = NUMBER_Null
.head 5 -  Set dfVidBlkD = 0
.head 5 -  Set dfVidBlkK = 0
.head 4 +  Else
.head 5 -  Set dfDapp = hWndParent.Frm_Account.cAccount.getDapp()
.head 5 -  Set dfVidBlkD = hWndParent.Frm_Account.cAccount.getBlkd()
.head 5 -  Set dfVidBlkK = hWndParent.Frm_Account.cAccount.getBlkk()
.head 5 -  Set nOstc  = hWndParent.Frm_Account.cAccount.getOstc()
.head 5 -  Set nDos   = hWndParent.Frm_Account.cAccount.getDos()
.head 5 -  Set nKos   = hWndParent.Frm_Account.cAccount.getKos()
.head 5 -  Set nOstq  = hWndParent.Frm_Account.cAccount.getOstq()
.head 5 -  Set nDosq  = hWndParent.Frm_Account.cAccount.getDosq()
.head 5 -  Set nKosq  = hWndParent.Frm_Account.cAccount.getKosq()
.head 5 -  Set nLim   = hWndParent.Frm_Account.cAccount.getLim()
.head 5 -  Set nOstx  = hWndParent.Frm_Account.cAccount.getOstx()
.head 5 -  ! проверка на 3 знака
.head 5 -  Set dfOstc = Dig4(Abs(nOstc)/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig )
.head 5 -  Set dfDos  = Dig4(Abs(nDos)/100,  hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig )
.head 5 -  Set dfKos  = Dig4(Abs(nKos)/100,  hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig )
.head 5 -  Set dfOstq = Dig4(Abs(nOstq)/100, hWndParent.Frm_Account.nDig980, hWndParent.Frm_Account.nDig980 )
.head 5 -  Set dfDosq  = Dig4(Abs(nDosq)/100,  hWndParent.Frm_Account.nDig980, hWndParent.Frm_Account.nDig980 )
.head 5 -  Set dfKosq  = Dig4(Abs(nKosq)/100,  hWndParent.Frm_Account.nDig980, hWndParent.Frm_Account.nDig980 )
.head 5 -  ! Лимиты
.head 5 +  If nLim != NUMBER_Null
.head 6 +  If nLim > 0
.head 7 -  Set dfLimitOs = Dig4(Abs(nLim)/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig)
.head 7 -  Set dfLimitMinus = ''
.head 6 +  Else If nLim < 0
.head 7 -  Set dfLimitMinus = Dig4(Abs(nLim)/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig)
.head 7 -  Set dfLimitOs = ''
.head 5 +  If nOstx != NUMBER_Null
.head 6 +  If nOstx > 0
.head 7 -  Set dfMaxLimSign='+'
.head 6 +  Else If nOstx < 0
.head 7 -  Set dfMaxLimSign='-'
.head 6 -  Set dfMaxLimOs = Dig4(nOstx/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig )
.head 5 -  ! Знак остатков
.head 5 +  If nOstc > 0
.head 6 -  ! Set dfSignIv='К'
.head 6 -  Set dfSignIv  = CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgK')
.head 6 -  Set dfSignIvQ = CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgK')
.head 5 +  Else If nOstc < 0
.head 6 -  ! Set dfSignIv='Д'
.head 6 -  Set dfSignIv  = CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgD')
.head 6 -  Set dfSignIvQ = CurrentLangTable.GetAtomTitle('Dlg_AccFinancial.bgD')
.head 5 -  ! Красим поля остатков в нужные цвета
.head 5 +  If hWndParent.Frm_Account.cAccount.getPap() = ACTIV AND nOstc > 0
.head 6 -  Call SalColorSet(dfOstc, COLOR_IndexWindowText, COLOR_Red)
.head 6 -  Call SalColorSet(dfOstq, COLOR_IndexWindowText, COLOR_Red)
.head 5 +  Else If hWndParent.Frm_Account.cAccount.getPap() = PASSIV AND nOstc < 0
.head 6 -  Call SalColorSet(dfOstc, COLOR_IndexWindowText, COLOR_Red)
.head 6 -  Call SalColorSet(dfOstq, COLOR_IndexWindowText, COLOR_Red)
.head 5 -  ! Для А-П счетов лимиты не выставляются
.head 5 +  If hWndParent.Frm_Account.cAccount.getPap() = ACTIVPASSIV
.head 6 -  Call SalDisableWindow(dfLimitOs)
.head 6 -  Call SalDisableWindow(dfLimitMinus)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccFinancial.hWnd = hWndForm
.head 3 +  On SAM_User
.head 4 -  Call SalSendMsg(dfLimitOs, UM_ObjActivate, 0, 0)
.head 4 -  Call SalSendMsg(dfLimitMinus, UM_ObjActivate, 0, 0)
.head 4 -  ! проверка на 3 знака
.head 4 +  If dfLimitOs
.head 5 -  Set nLim = Abs(SalStrToNumber(dfLimitOs)*SalNumberPower(10,hWndParent.Frm_Account.nDig))
.head 5 -  Set dfLimitOs = Dig4(nLim/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig)
.head 4 +  If dfLimitMinus
.head 5 -  Set nLim = -Abs(SalStrToNumber(dfLimitMinus)*SalNumberPower(10,hWndParent.Frm_Account.nDig))
.head 5 -  Set dfLimitMinus = Dig4(Abs(nLim)/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig)
.head 4 +  If dfMaxLimOs
.head 5 -  ! Сразу переводим nMaxLimOs в коп. и со знаком
.head 5 -  Set nOstx = SalStrToNumber(dfMaxLimOs)*SalNumberPower(10,hWndParent.Frm_Account.nDig)
.head 5 +  If dfMaxLimSign = '-'
.head 6 -  Set nOstx = nOstx*-1
.head 5 -  Set dfMaxLimOs = Dig4(Abs(nOstx)/100, hWndParent.Frm_Account.nDig, hWndParent.Frm_Account.nDig)
.head 4 +  Else
.head 5 -  Set nOstx = NUMBER_Null
.head 4 -  ! Pap
.head 4 +  If bPossibleToEdit
.head 5 +  If hWndParent.Frm_Account.cAccount.getPap() = ACTIVPASSIV
.head 6 -  Call SalDisableWindow(dfLimitOs)
.head 6 -  Call SalDisableWindow(dfLimitMinus)
.head 5 +  Else
.head 6 -  Call SalEnableWindow(dfLimitOs)
.head 6 -  Call SalEnableWindow(dfLimitMinus)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(dfLimitOs)
.head 4 -  Call SalDisableWindow(dfLimitMinus)
.head 4 -  Call SalDisableWindow(dfMaxLimOs)
.head 4 -  Call SalDisableWindow(cmbVidBlkD)
.head 4 -  Call SalDisableWindow(cmbVidBlkK)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccFinancial.pic1,
     SalPixelsToFormUnits(hWndForm.Dlg_AccFinancial.pic1, nWinWidth, FALSE)-0.17,
     SalPixelsToFormUnits(hWndForm.Dlg_AccFinancial.pic1, nWinHeight, TRUE)-0.12)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccFinancial.pic2, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccFinancial.pic2,
     SalPixelsToFormUnits(hWndForm.Dlg_AccFinancial.pic2, nWinWidth, FALSE)-0.17, nWH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_AccRates
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.429"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblRates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  9.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.048"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 -  ! Атрибуты тарифов
.head 5 +  Column: colKod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
тарифа-комиссии
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! Базовая валюта тарифа
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colKv
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCur
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Базовая
Вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! Собственные значения тарифов на обслуживание данного счета
.head 5 +  Column: colRate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тариф
в "коп"
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 +  If colRate = NUMBER_Null
.head 9 -  Set colRate = colRateD
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colCom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Комиссия
(%)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 +  If colCom = NUMBER_Null
.head 9 -  Set colCom = colComD
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colMin
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Минимум
в "коп"
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colKvMin
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
MIN
суммы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colMax
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Максимум
в "коп"
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colKvMax
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
MAX
суммы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colBDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата начала
действия тарифа
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 +  Column: colEDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата окончания
действия тарифа
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 +  On SAM_Validate
.head 8 -  Call SetRowColor()
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(tblRates, VTM_KeyDown, wParam, lParam)
.head 5 -  ! Значения тарифов по умолчанию
.head 5 +  Column: colRateD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colRateD
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colComD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colComD
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMinD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colMinD
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKvMinD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colKvMinD
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMaxD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colMaxD
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKvMaxD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: colKvMaxD
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: SetRowColor
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If not IsIndividualTarif()
.head 8 -  Call SetTblRowColor(hWndForm, SalColorFromRGB(90, 90, 90))
.head 7 +  Else
.head 8 -  Call SetTblRowColor(hWndForm, COLOR_Black)
.head 5 +  Function: IsIndividualTarif
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If colRate   = colRateD 
and colCom   = colComD 
and colMin   = colMinD
and colKvMin = colKvMinD
and colMax   = colMaxD 
and colKvMax = colKvMaxD
and colBDate = DATETIME_Null 
and colEDate = DATETIME_Null
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nColor
.head 5 -  String: sTooltipTxt
.head 5 -  Number: nRow
.head 5 -  Number: nTarifSchemeId
.head 5 -  String: sTarifSchemeName
.head 5 -  Number: nTarifSchemeFlagEdit
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"select t.id, t.name, t.flag_edit
   into :nTarifSchemeId, :sTarifSchemeName, :nTarifSchemeFlagEdit
   from tarif_scheme t, accountsw w
  where w.acc = :nAcc and w.tag = 'SHTAR'
    and trim(w.value) = to_char(t.id)")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalTblSetColumnTitle(colName, 
     CurrentLangTable.GetAtomTitle('Dlg_AccRates.tblRates.colName') || 
     IifS(sTarifSchemeName='', '', PutCrLf() || '(' || sTarifSchemeName || ')'))
.head 7 -  ! если указана схема тарифов и запрещено устанавливать инд.тарифы для схемы тарифов,
.head 7 -  ! закрываем таблицу для редактирования
.head 7 +  If nTarifSchemeFlagEdit=0
.head 8 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 6 +  Else
.head 7 -  Set nTarifSchemeId = 0
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(),
"SELECT a.kod, a.name, a.kv, b.lcv, 
        a.tar, a.pr, a.smin, a.kv_smin, a.smax , a.kv_smax
   INTO :tblRates.colKod,   :tblRates.colName, :tblRates.colKv, :tblRates.colCur,
        :tblRates.colRateD, :tblRates.colComD, :tblRates.colMinD, :tblRates.colKvMinD, :tblRates.colMaxD, :tblRates.colKvMaxD
   FROM v_sh_tarif a, tabval b
  WHERE a.kv = b.kv
    and a.id = :nTarifSchemeId
  ORDER BY a.name", TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 6 -  ! Установка фокуса
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 6 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call hWndParent.Frm_Account.cAccount.getRatesValue(
     colKod, colRate, colCom, colMin, colKvMin, colMax, colKvMax, colBDate, colEDate)
.head 6 -  Call SetRowColor()
.head 5 +  On SAM_TblDoDetails
.head 6 +  If bPossibleToEdit
.head 7 +  If colRate = colRateD AND colCom   = colComD   AND 
   colMin  = colMinD  AND colKvMin = colKvMinD AND 
   colMax  = colMaxD  AND colKvMax = colKvMax
.head 8 -  Set dfF4 = ''
.head 7 +  Else
.head 8 -  ! F4 - Установить значения по умолчанию
.head 8 -  Set dfF4 = 'F4 - ' || CurrentLangTable.GetAtomTitle('Dlg_AccRates.cTF4')
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If 
    colRate = colRateD 
AND colCom  = colComD 
AND (   colMin = colMinD     AND colMax = colMaxD 
     OR colMin = NUMBER_Null AND colMax = NUMBER_Null )
AND (   colKvMin = colKvMinD
     or colKvMin = colKv       and colKvMinD = NUMBER_Null
     or colKvMin = NUMBER_Null and colKvMinD = colKv )
AND (   colKvMax = colKvMaxD
     or colKvMax = colKv       and colKvMaxD = NUMBER_Null
     or colKvMax = NUMBER_Null and colKvMaxD = colKv )
.head 8 -  Call hWndParent.Frm_Account.cAccount.delRatesValue(colKod)
.head 7 +  Else
.head 8 -  Call hWndParent.Frm_Account.cAccount.setRatesValue(
     colKod, colRate, colCom, colMin, colKvMin, colMax, colKvMax, colBDate, colEDate)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F4
.head 7 -  ! ???
.head 7 +  If bPossibleToEdit
.head 8 +  If SalTblQueryContext(hWndForm) >= 0
.head 9 +  If NOT (colRate = colRateD AND colCom = colComD AND 
        colMin  = colMinD  AND colKvMin = colKvMinD AND
        colMax  = colMaxD  and colKvMax = colKvMaxD)
.head 10 -  Set colRate  = colRateD
.head 10 -  Set colCom   = colComD
.head 10 -  Set colMin   = colMinD
.head 10 -  Set colKvMin = colKvMinD
.head 10 -  Set colMax   = colMaxD
.head 10 -  Set colKvMax = colKvMaxD
.head 10 -  Set colBDate = DATETIME_Null
.head 10 -  Set colEDate = DATETIME_Null
.head 10 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 10 -  Call hWndParent.Frm_Account.IsEdited()
.head 10 -  Call SetRowColor()
.head 5 +  On SAM_KillFocus
.head 6 -  Set dfF4 = ''
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If IsIndividualTarif()
.head 7 -  Set nColor = COLOR_Black
.head 7 -  ! 'Индивидуальный тариф'
.head 7 -  Set sTooltipTxt = CurrentLangTable.GetAtomTitle('Dlg_AccRates.cTIndividualRate')
.head 6 +  Else
.head 7 -  Set nColor = SalColorFromRGB(90, 90, 90)
.head 7 -  ! 'Общий тариф'
.head 7 -  Set sTooltipTxt = CurrentLangTable.GetAtomTitle('Dlg_AccRates.cTGeneralRate')
.head 6 -  Call XSalTooltipSetColors(nColor, COLOR_White)
.head 6 -  Call XSalTooltipShow(hWndForm, sTooltipTxt)
.head 6 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Data Field: dfF4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.012"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Number: nTar
.head 3 -  Number: nPr
.head 3 -  Number: nSMin
.head 3 -  Number: nSMax
.head 3 -  Date/Time: dBDate
.head 3 -  Date/Time: dEDate
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccRates')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccRates.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(tblRates, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccRates.hWnd = hWndForm
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg(tblRates, UM_Update, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalSendMsg(tblRates, SAM_DoInit, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccRates.tblRates,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRates.tblRates, nWinWidth, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_AccRates.tblRates, nWinHeight, TRUE)-0.25)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_AccRates.dfF4, nWW, nWH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccRates.dfF4,
     SalPixelsToFormUnits(hWndForm.Dlg_AccRates.dfF4, nWinWidth, FALSE),nWH)
.head 4 -  Call SalGetWindowLoc(hWndForm.Dlg_AccRates.dfF4, nWW, nWH)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_AccRates.dfF4, nWW, 
     SalPixelsToFormUnits(hWndForm.Dlg_AccRates.dfF4, nWinHeight, TRUE)-0.23)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 -  !
.head 1 +  Dialog Box: dlg_RefPsEx
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник План счетов ( новый )
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  8.567"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.429"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник План счетов
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblPs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.088"
.head 6 -  Top:    0.042"
.head 6 -  Width:  8.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 16384
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colNBS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Бал
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAME_NBS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование балансового счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 140
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colXAR_NBS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Хар-
ка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colORDER_BY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: RID
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: RID
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nOrderBy
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set nOrderBy = 1
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblPopulate(hWndForm, hSql(),T(
"SELECT unique trim(p.nbs), p.name, p.xar
   INTO :colNBS, :colNAME_NBS, :colXAR_NBS
   FROM PS p, nbs_k014 n
  WHERE length(trim(p.nbs)) = :nCount 
    AND trim(p.nbs) BETWEEN '"||sA||"' AND '"||sB||"' 
    AND (p.d_close is null or p.d_close >= bankdate)
    and (trim(p.nbs) like trim(n.nbs)||'%' or trim(n.nbs) like trim(p.nbs)||'%')
    and n.k014 = :nK014
  ORDER BY 1"), TBL_FillNormal)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalDisableWindow(pbSave)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Set sA = tblPs.colNBS
.head 6 -  Call SalEnableWindow(pbSave)
.head 6 -  Call SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 5 +  On WM_LbuttonDblClick
.head 6 -  Call SalSendMsg(hWndForm, SAM_RowHeaderDoubleClick, 0, 0)
.head 5 +  On WM_LbuttonUp
.head 6 -  Call SalEnableWindow(pbSave)
.head 5 +  On WM_KeyUp
.head 6 -  Set sA = tblPs.colNBS
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Frame
.head 4 -  Resource Id: 17455
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.452"
.head 5 -  Width:  8.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.619"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   6.667"
.head 5 -  Top:    4.536"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sNbs = STRING_Null
.head 6 -  Call SalEndDialog(dlg_RefPsEx, FALSE)
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   5.1"
.head 5 -  Top:    4.536"
.head 5 -  Width:  1.543"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sA = tblPs.colNBS
.head 6 -  Set nCount = nCount+1
.head 6 +  If nCount = 2
.head 7 -  ! Set strName='Разделы...'
.head 7 -  Set strName = CurrentLangTable.GetAtomTitle('dlg_RefPsEx.cTWndTitle2')
.head 6 +  If nCount = 3
.head 7 -  ! Set strName='Группы...'
.head 7 -  Set strName = CurrentLangTable.GetAtomTitle('dlg_RefPsEx.cTWndTitle3')
.head 6 +  If nCount = 4
.head 7 -  ! Set strName='Балансовые счета...'
.head 7 -  Set strName = CurrentLangTable.GetAtomTitle('dlg_RefPsEx.cTWndTitle4')
.head 6 -  Call SalSetWindowText(dlg_RefPsEx, strName)
.head 6 -  !
.head 6 +  If nCount > nBLen
.head 7 -  Set sNbs = tblPs.colNBS
.head 7 -  Return SalEndDialog(dlg_RefPsEx, TRUE)
.head 6 -  !
.head 6 -  Set sB = sA || '9'
.head 6 -  Set sA = sA || '0'
.head 6 -  !
.head 6 -  Return SalSendMsg(tblPs, SAM_Create, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nK014
.head 3 -  Receive String: sNbs
.head 2 +  Window Variables
.head 3 -  String: strSql
.head 3 -  String: strCondition
.head 3 -  String: strName
.head 3 -  !
.head 3 -  String: sA
.head 3 -  String: sB
.head 3 -  !
.head 3 -  Number: nCount
.head 3 -  Number: nTmp
.head 3 -  Number: nBLen
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call SalSetWindowText( dlg_RefPsEx, 'Классы...' )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_RefPsEx.cTWndTitle1'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  Call SalTblSetTableFlags(tblPs, TBL_Flag_SelectableCols, TRUE)
.head 4 -  !
.head 4 -  Call GetAccountStructure(nTmp, nTmp, nBLen, nTmp)
.head 4 -  Set sA = '0'
.head 4 -  Set sB = '9'
.head 4 -  Set nCount = 1
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_ListValuts
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Список валют
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  7.75"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.552"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список валют
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblListValut
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.024"
.head 6 -  Width:  7.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.476"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 4096
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colPR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: In Use
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.511"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLCV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ISO
code
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Currency Name
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), T( 
"select kv, lcv, trim(name), 0
   into :hWndForm.tblListValut.colKV, :hWndForm.tblListValut.colLCV, 
        :hWndForm.tblListValut.colNAME, :hWndForm.tblListValut.colPR
   from Tabval
  where (d_close is null or d_close >= bankdate)
  order by skv"), TBL_FillAll)
.head 6 -  !
.head 6 -  Call SalTblSetRow(tblListValut, 1)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 -  !
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.45"
.head 5 -  Top:    3.643"
.head 5 -  Width:  1.543"
.head 5 -  Width Editable? Yes
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  Set i = 0
.head 6 -  Set hWndParent.Frm_Account.nCountKv = 0
.head 6 +  While SalTblFindNextRow(tblListValut, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(tblListValut, nRow)
.head 7 +  If tblListValut.colPR
.head 8 -  Set hWndParent.Frm_Account.nCodVal[i] = tblListValut.colKV
.head 8 -  Set i = i + 1
.head 6 -  Set hWndParent.Frm_Account.nCountKv = i
.head 6 -  Call SalEndDialog(dlg_ListValuts, TRUE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   6.0"
.head 5 -  Top:    3.643"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set hWndParent.Frm_Account.nCountKv = 0
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 56258
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.56"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.615"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  Number: nRow
.head 3 -  Number: i
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set hWndParent = SalParentWindow(hWndForm)
.head 1 +  Dialog Box: dlg_SetDat
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: С
.head 4 -  Resource Id: 7605
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    0.405"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDat1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.85"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfDat1)
.head 7 -  Set dfDat1 = GetBankDate()
.head 3 -  Background Text: По
.head 4 -  Resource Id: 7606
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.5"
.head 5 -  Top:    0.405"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDat2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.133"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfDat2)
.head 7 -  Set dfDat2 = GetBankDate()
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    1.048"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dDat1 = dfDat1
.head 6 -  Set dDat2 = dfDat2
.head 6 -  Call SaveInfoToLog('ACCOUNTS. Установлен период дат ' || 
  SalFmtFormatDateTime(dfDat1, 'dd/MM/yyyy') || '-' || 
  SalFmtFormatDateTime(dfDat2, 'dd/MM/yyyy'))
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    1.048"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SaveInfoToLog('ACCOUNTS. Установлен период дат ' || 
  SalFmtFormatDateTime(dfDat1, 'dd/MM/yyyy') || '-' || 
  SalFmtFormatDateTime(dfDat2, 'dd/MM/yyyy'))
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 7603
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 7604
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.917"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Date/Time: dDat1
.head 3 -  Receive Date/Time: dDat2
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Укажите даты...')
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetDat.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set dfDat1 = dDat1
.head 4 -  Set dfDat2 = dDat2
.head 1 +  Dialog Box: Dlg_GetProf
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61486
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.95"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Просмотреть значения рофиля'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('Dlg_GetProf.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm.Dlg_GetProf.tblProf, ROW_Selected, 0)
.head 8 +  If SalModalDialog(Dlg_ShowProf, hWndMDI, sNbs, hWndForm.Dlg_GetProf.tblProf.colNp, hWndForm.Dlg_GetProf.tblProf.colName)
.head 9 -  Call SalSendMsg(hWndForm, SAM_DoubleClick, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61487
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  3.967"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  3.967"
.head 6 -  End Y:  0.012"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.1"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61488
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblProf
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colNp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
п/п
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
профиля
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sNbs
.head 3 -  Receive Number: nNP
.head 2 +  Window Variables
.head 3 -  String: sRet1
.head 3 -  String: sRet2
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_GetProf.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set hWndForm.Dlg_GetProf.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.Dlg_GetProf.strSqlPopulate = 
"SELECT np, name 
   INTO :hWndForm.tblProf.colNp, :hWndForm.tblProf.colName 
   FROM nbs_profnam 
  WHERE nbs=:hWndForm.Dlg_GetProf.sNbs 
  ORDER BY np"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_DoubleClick
.head 4 -  Set nNP = hWndForm.Dlg_GetProf.tblProf.colNp
.head 4 -  Call SalEndDialog(hWndForm, TRUE)
.head 1 +  Dialog Box: Dlg_ShowProf
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Значения профиля
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32535
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32536
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32537
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblProfVal
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSqlText
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Long String
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: sVal
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colVal = '' AND colSqlText != ''
.head 7 -  Call SqlPrepareAndExecute(hSql(), colSqlText || " INTO :sVal")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set colVal = sVal
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sNbs
.head 3 -  Number: nNp
.head 3 -  String: sName
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_ShowProf.cTWndTitle') || " '" || sName || "'")
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set hWndForm. Dlg_ShowProf.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.Dlg_ShowProf.strSqlPopulate = 
"SELECT name, val, sql_text 
 INTO :hWndForm.tblProfVal.colName, :hWndForm.tblProfVal.colVal, 
      :hWndForm.tblProfVal.colSqlText 
 FROM v_nbs_prof 
 WHERE nbs='" || hWndForm.Dlg_ShowProf.sNbs || "' AND np=" || Str(hWndForm.Dlg_ShowProf.nNp) || "
   AND val is not null 
 ORDER BY name"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Dialog Box: dlgEditCustSign
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Образец подписи
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picSign
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  7.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.36"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Size for Best Fit
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbEditSign
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.58"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not editSign()
.head 7 -  Call Debug('NOT EDIT')
.head 3 +  Pushbutton: pbDelSign
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.5"
.head 5 -  Top:    4.58"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call setEdit()
.head 6 -  Set nId = NUMBER_Null
.head 6 -  Set sFullName = ''
.head 6 -  Call SalPicSetFile(picSign, '')
.head 6 -  Call SalDisableWindow(pbDelSign)
.head 3 -  Frame
.head 4 -  Resource Id: 45605
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    4.46"
.head 5 -  Width:  7.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.15"
.head 5 -  Top:    4.58"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If saveSign()
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.45"
.head 5 -  Top:    4.58"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If bEdit
.head 7 -  ! Данные были изменены! Сохранить изменения?
.head 7 +  If IDYES = SalMessageBox(CurrentLangTable.GetAtomTitle('dlgEditCustSign.cTMsgEdit1') || PutCrLf() || 
   CurrentLangTable.GetAtomTitle('dlgEditCustSign.cTMsgEdit2'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_YesNo)
.head 8 -  Return SalSendMsg(pbSave, SAM_Click, 0, 0)
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 +  Functions
.head 3 +  Function: setEdit
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bEdit = TRUE
.head 5 -  Call SalEnableWindow(pbSave)
.head 3 +  Function: readSign
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If NOT PutBlobToFile(
  hSql(),
  sSignFileName,
  'customer_bin_data',
  'id',
  'bin_data',
  nId,
  '',
  '')
.head 6 -  Call VisFileDelete(sSignFileName)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Return FALSE
.head 5 -  Call SalPicSetFile(picSign, sSignFileName)
.head 5 -  Call VisFileDelete(sSignFileName)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: editSign
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalDlgOpenFile(hWndForm, 'Выберите файл', strFilters, 2, nIndex, strFile, sFullName)
.head 6 +  If VisFileGetSize(sFullName) > 500000
.head 7 -  ! Call SalMessageBox("Размер файла превышает допустимый (500000 bytes)!", "Внимание!", MB_Ok)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgEditCustSign.cTMsgSize') || " (500000 bytes)!", 
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Return TRUE
.head 6 -  Call setEdit()
.head 6 -  Call SalEnableWindow(pbDelSign)
.head 6 -  ! Показываем картинку
.head 6 -  Call SalPicSetFile(picSign, sFullName)
.head 5 -  Return TRUE
.head 3 +  Function: saveSign
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sFullName = ''
.head 6 -  Return TRUE
.head 5 +  If NOT FILE_CopyOK = SalFileCopy(sFullName, sSignFileName, TRUE)
.head 6 -  Call Debug('Error copy file')
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  ! Update
.head 5 +  If nId
.head 6 +  If not PutFileToBlob(
  hSql(),
  sSignFileName,
  'customer_bin_data',
  'id',
  'bin_data',
  nId,
  '',
  '',
  0)
.head 7 -  Call VisFileDelete(sSignFileName)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Return FALSE
.head 5 -  ! Insert
.head 5 +  Else
.head 6 +  If not SqlPrepareAndExecute(hSql(),
"SELECT S_CUSTOMER_BIN_DATA.nextval into :nId from dual")
OR not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call Debug('Error sequence')
.head 7 -  Return FALSE
.head 6 +  If not PutFileToBlob(
  hSql(),
  sSignFileName,
  'customer_bin_data',
  'id',
  'bin_data',
  nId,
  '',
  '',
  1)
.head 7 -  Call VisFileDelete(sSignFileName)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Return FALSE
.head 5 -  Call VisFileDelete(sSignFileName)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Receive Number: nId
.head 2 +  Window Variables
.head 3 -  Boolean: bEdit
.head 3 -  File Handle: hFile
.head 3 -  String: strFilters[2]
.head 3 -  Number: nIndex
.head 3 -  String: strFile
.head 3 -  String: sFullName
.head 3 -  String: sSignFileName
.head 3 -  Long String: lsSign
.head 3 -  Number: nBytesRead
.head 3 -  Number: nBufferSize
.head 3 -  Number: nLen
.head 3 -  Number: i
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Образец подписи/печати')
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgEditCustSign.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If nMode = 0
.head 5 -  Call SalDisableWindow(pbEditSign)
.head 4 -  Call SalDisableWindow(pbDelSign)
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 -  Set strFilters[0] = '(*.jpg)'
.head 4 -  Set strFilters[1] = '*.jpg'
.head 4 -  Set sFullName     = ''
.head 4 -  Set sSignFileName = GetPrnDir() || '\\custsign.jpg'
.head 4 +  If nId
.head 5 -  Call readSign()
.head 5 -  Call SalEnableWindow(pbDelSign)
.head 4 -  Call SalSetFocus(pbClose)
.head 1 +  Table Window: tbl_ParHistory
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.55"
.head 4 -  Top:    0.458"
.head 4 -  Width:  13.3"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 3000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.367"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17742
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  10.333"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  10.333"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.817"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.8"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17743
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  10.333"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  10.333"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.467"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17744
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.083"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  4.083"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Data Field: dat11
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.543"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: C:
.head 5 -  Resource Id: 44008
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.125"
.head 6 -  Width:  0.371"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgFrom
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dat22
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.543"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: По:
.head 5 -  Resource Id: 44009
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.986"
.head 6 -  Top:    0.125"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgTo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Combo Box: cmb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.233"
.head 6 -  Top:    0.083"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.345"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb1.Init(hWndItem)
.head 7 -  Call cmb1.Populate(hSql(), "distinct TABID", "SEMANTIC", "META_TABLES", 
" WHERE tabid in (SELECT tabid FROM acc_par WHERE pr=" || Str(nMode) || ") ORDER BY semantic " )
.head 7 -  Call cmb1.Add(0, 'Все')
.head 7 -  Call cmb1.SetSelectById(0)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 +  If cmb1.GetCurrentKey() = 0
.head 8 -  Call SalDisableWindow(cmb2)
.head 7 +  Else
.head 8 -  Call SalEnableWindow(cmb2)
.head 7 -  Call SalSendMsg(cmb2, SAM_User, 0, 0)
.head 4 +  Combo Box: cmb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.083"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.655"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb2.Init(hWndItem)
.head 7 -  Call cmb2.Add(0, 'Все')
.head 7 -  Call cmb2.SetSelectById(0)
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_User
.head 7 -  Call SalListClear(hWndItem)
.head 7 -  Call cmb2.Init(hWndItem)
.head 7 -  Call cmb2.Add(0, 'Все')
.head 7 +  If cmb1.GetCurrentKey() != 0
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT colid, semantic INTO :nTmp1, :sTmp2 
 FROM meta_columns 
 WHERE tabid=" || Str(cmb1.GetCurrentKey()) || " 
   AND colid in (select colid from acc_par where tabid=" || Str(cmb1.GetCurrentKey()) || ") 
 ORDER BY semantic ")
.head 8 +  While SqlFetchNext(hSql(), nFetchRes)
.head 9 +  While TRUE
.head 10 -  Set nTmp = SalStrScan(sTmp2, '~')
.head 10 +  If nTmp = -1
.head 11 -  Break
.head 10 -  Set sTmp2 = SalStrReplaceX(sTmp2, nTmp, 1, ' ')
.head 9 -  Call cmb2.Add(nTmp1, sTmp2)
.head 7 -  Call cmb2.SetSelectById(0)
.head 2 +  Contents
.head 3 +  Column: colTabName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TabName
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTabSemantic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TabSemantic
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colColSemantic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Параметр
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colValOld
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Старое
значение
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colValNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Новое
значение
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChgDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
изменения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: DateTime
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIdUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Внес
изменения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFioUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО
пользователя
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode	! 1- nPar=Acc, 2- nPar=Rnk
.head 3 -  Number: nPar
.head 3 -  String: sNls
.head 3 -  Number: nKv
.head 3 -  Date/Time: Pdat11
.head 3 -  Date/Time: Pdat22
.head 3 -  String: sTitle
.head 3 -  String: sFilter
.head 2 +  Window Variables
.head 3 -  String: sStr
.head 3 -  String: strISOCur
.head 3 -  String: strNls
.head 3 -  String: strKv
.head 3 -  Number: nRnk
.head 3 -  String: sNd
.head 3 -  String: sNmk
.head 3 -  !
.head 3 -  Number: nColor
.head 3 -  !
.head 3 -  String: sTmp1
.head 3 -  Number: nTmp1
.head 3 -  String: sTmp2
.head 3 -  Number: nTmp
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 +  If nMode = 1
.head 5 -  If SqlPrepareAndExecute(hSql(), 
"SELECT a.nls, t.lcv, a.kv 
 INTO :strNls, :strISOCur, :strKv 
 FROM accounts a, tabval t
 WHERE a.kv=t.kv AND a.acc=:nPar")
and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! 'История изменения параметров счета N '||strNls||' ('||strISOCur||')'
.head 5 -  Call SalSetWindowText(hWndForm, 
  CurrentLangTable.GetAtomTitle('tbl_ParHistory.cTWndTitleAcc') || ' N ' || strNls || ' (' || strISOCur || ')' || ' ' ||
  CurrentLangTable.GetAtomTitle('tbl_ParHistory.bgTo') || ' ' || SalFmtFormatDateTime(GetBankDate(),'dd/MM/yyyy'))
.head 5 -  Set tbl_ParHistory.strPrintFileName = 'AccPar.hst'
.head 4 +  Else If nMode = 2
.head 5 -  If SqlPrepareAndExecute(hSql(), 
"SELECT rnk, nmk, nd 
 INTO :nRnk, :sNmk, :sNd 
 FROM customer 
 WHERE rnk=:nPar")
and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! 'История изменения параметров клиента (РНК ' || Str(nRnk) || ', НД ' || sND || '). ' || sNmk
.head 5 -  Call SalSetWindowText(hWndForm, 
  CurrentLangTable.GetAtomTitle('tbl_ParHistory.cTWndTitleRnk') || ' (' || 
  CurrentLangTable.GetAtomTitle('cTMsgRnk') || ' ' || Str(nRnk) || ', ' || 
  CurrentLangTable.GetAtomTitle('cTMsgNd')  || ' ' || sNd || '). ' || sNmk || ' ' ||
  CurrentLangTable.GetAtomTitle('tbl_ParHistory.bgTo') || ' ' || SalFmtFormatDateTime(GetBankDate(),'dd/MM/yyyy'))
.head 5 -  Set tbl_ParHistory.strPrintFileName = 'RnkPar.hst'
.head 4 +  Else
.head 5 +  If sTitle != ''
.head 6 -  Call SalSetWindowText(hWndForm, sTitle || ' ' ||
  CurrentLangTable.GetAtomTitle('tbl_ParHistory.bgTo') || ' ' || SalFmtFormatDateTime(GetBankDate(),'dd/MM/yyyy'))
.head 5 -  Set tbl_ParHistory.strPrintFileName = 'ParHist.hst'
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 +  If Pdat11 = DATETIME_Null
.head 5 -  Set dat11 = GetBankDate()-30
.head 5 -  Set dat22 = GetBankDate()
.head 4 +  Else
.head 5 -  Set dat11 = Pdat11
.head 5 -  Set dat22 = Pdat22
.head 4 -  Set sStr = 
"SELECT upper(t.tabname), t.semantic, TMP_ACCHIST.parname, 
        TMP_ACCHIST.valold, TMP_ACCHIST.valnew, TMP_ACCHIST.dat, TMP_ACCHIST.isp, s.fio
 INTO :hWndForm.tbl_ParHistory.colTabName, :hWndForm.tbl_ParHistory.colTabSemantic, :hWndForm.tbl_ParHistory.colColSemantic, 
      :hWndForm.tbl_ParHistory.colValOld,  :hWndForm.tbl_ParHistory.colValNew, 
      :hWndForm.tbl_ParHistory.colChgDate, :hWndForm.tbl_ParHistory.colIdUser, 
      :hWndForm.tbl_ParHistory.colFioUser
 FROM meta_tables t, meta_columns c, TMP_ACCHIST, staff$base s 
 WHERE TMP_ACCHIST.iduser=user_id " || IifS(nPar=0, "", " AND TMP_ACCHIST.acc=:hWndForm.tbl_ParHistory.nPar ") || "
   AND TMP_ACCHIST.tabid=t.tabid AND t.tabid=c.tabid 
   AND TMP_ACCHIST.colid=c.colid AND TMP_ACCHIST.isp=s.logname "
.head 4 -  Set hWndForm.tbl_ParHistory.strSqlPopulate = sStr
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If NOT SqlPLSQLCommand(hSql(), "p_acchist(nMode,nPar,dat11,dat22)")
.head 5 -  Call Debug('ERROR!!!')
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Return TRUE
.head 4 -  Call SqlCommit(hSql())
.head 4 -  Set strSqlPopulate = sStr || 
IifS(cmb1.GetCurrentKey()=0, "", " AND t.tabid="||Str(cmb1.GetCurrentKey())) || 
IifS(cmb2.GetCurrentKey()=0, "", " AND c.colid="||Str(cmb2.GetCurrentKey())) || 
" ORDER BY TMP_ACCHIST.idupd desc, TMP_ACCHIST.dat desc, t.tabid"
.head 4 -  Call ReInitQueryString()
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If colTabName = 'ACCOUNTS'
.head 5 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkBlue)
.head 4 +  Else If colTabName = 'SPECPARAM'
.head 5 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkGreen)
.head 4 +  Else If colTabName = 'CUSTOMER'
.head 5 -  Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkBlue)
.head 4 +  While TRUE
.head 5 -  Set nTmp = SalStrScan(colColSemantic, '~')
.head 5 +  If nTmp = -1
.head 6 -  Break
.head 5 -  Set colColSemantic = SalStrReplaceX(colColSemantic, nTmp, 1, ' ')
.head 3 +  On SAM_RowHeaderClick
.head 4 +  If colTabName = 'ACCOUNTS'
.head 5 -  Set nColor = COLOR_DarkBlue
.head 4 +  Else If colTabName = 'SPECPARAM'
.head 5 -  Set nColor = COLOR_DarkGreen
.head 4 +  Else If colTabName = 'CUSTOMER'
.head 5 -  Set nColor = COLOR_DarkBlue
.head 4 -  Call XSalTooltipSetColors(nColor, COLOR_White)
.head 4 -  Call XSalTooltipShow(hWndForm, colTabSemantic)
.head 4 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 +  Dialog Box: dlg_CustPrnt
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.55"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.15"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Выберите дату
.head 4 -  Resource Id: 36569
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.05"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCalendar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Custom Control: cCalendar
.data CLASSPROPSSIZE
0000: 4200
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCalendarDropDown
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.3"
.head 6 -  Width:  3.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call GetMonthArray(strMonth)
.head 6 -  Call GetWeekDayArray(strWeekDays)
.head 6 -  Call cCalendar.SetMonthText(strMonth)
.head 6 -  Call cCalendar.SetWeekDayText(strWeekDays)
.head 6 -  ! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarFrom - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday, SEQ_Unset,  COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call cCalendar.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset, SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute(hSql(), T("select fdat into :dDat from fdat"))
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call cCalendar.SpecialDate(SPECIAL_OneTime, dDat, DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.3"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    2.452"
.head 5 -  Width:  1.217"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalGetWindowText(cCalendar, sDat, 10)
.head 6 -  Set nDay   = SalDateDay(SalStrToDate(sDat))
.head 6 -  Set nMonth = SalDateMonth(SalStrToDate(sDat))
.head 6 -  Set nYear  = SalDateYear(SalStrToDate(sDat))
.head 6 -  Set sDat   = IifS(nDay>9, SalNumberToStrX(nDay, 0), "0" || SalNumberToStrX(nDay,0)) || '/' ||
    IifS(nMonth>9, SalNumberToStrX(nMonth, 0), '0' || SalNumberToStrX(nMonth, 0)) || '/' || 
    SalNumberToStrX(nYear, 0)
.head 6 -  Set dDatPrnt = SalStrToDate(sDat)
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    2.45"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Date/Time: dDatPrnt
.head 2 +  Window Variables
.head 3 -  String: strMonth[12]
.head 3 -  String: strWeekDays[7]
.head 3 -  Date/Time: dDat
.head 3 -  Number: nDay
.head 3 -  Number: nMonth
.head 3 -  Number: nYear
.head 3 -  String: sDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Печать...
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_CustPrnt.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSetWindowText(cCalendar, SalFmtFormatDateTime(dDatPrnt, 'dd/MM/yyyy'))
.head 1 -  ! NN - НБУ
.head 1 +  Dialog Box: Dlg_KeyPhrase
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Вопрос/Ответ для постановки карты в стоп-лист
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.65"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Вопрос:
.head 4 -  Resource Id: 29163
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.202"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgQuestion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfQuestion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.45"
.head 6 -  Width:  7.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Ответ:
.head 4 -  Resource Id: 29164
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.9"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAnswer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAnswer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.15"
.head 6 -  Width:  7.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  7.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.6"
.head 5 -  Width:  7.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.0"
.head 5 -  Top:    1.714"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sQuestion = dfQuestion
.head 6 -  Set sAnswer   = dfAnswer
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.5"
.head 5 -  Top:    1.714"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: bEdit
.head 3 -  Receive String: sQuestion
.head 3 -  Receive String: sAnswer
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Ключевая фраза для постановки карты в стоп-лист
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_KeyPhrase.cTWndTitle'))
.head 4 -  !
.head 4 -  Set dfQuestion = IifS(sQuestion='', 'Ключевая фраза', sQuestion)
.head 4 -  Set dfAnswer   = sAnswer
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 +  If not bEdit
.head 5 -  Call SalDisableWindow(dfQuestion)
.head 5 -  Call SalDisableWindow(dfAnswer)
.head 4 +  Else
.head 5 -  Call SalSetFocus(dfAnswer)
.head 1 +  Dialog Box: Dlg_CustNNCard
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pbAddCard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Добавить карту
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cBTipAddCard'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblCard, UM_Insert, 0, 0)
.head 3 +  Picture: pbChangeCard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\RELATION.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Сменить карту
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cBTipChangeCard'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblCard, SAM_User, 0, 0)
.head 3 +  Picture: pbEditCard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.983"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Редактировать карту
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cBTipEditCard'))
.head 5 +  On SAM_Click
.head 6 +  If SalTblAnyRows(tblCard, ROW_Selected, 0)
.head 7 -  Call SalSendMsg(tblCard, SAM_DoubleClick, 0, SalTblQueryContext(tblCard))
.head 3 +  Picture: pbRefreshCard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.433"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\REFRESH.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set bCardArch = not bCardArch
.head 6 +  If bCardArch
.head 7 -  Call SalDisableWindow(pbAddCard)
.head 7 -  Call SalDisableWindow(pbChangeCard)
.head 7 -  Call SalDisableWindow(pbEditCard)
.head 6 +  Else If bPossibleToEdit
.head 7 -  Call SalEnableWindow(pbAddCard)
.head 7 -  Call SalEnableWindow(pbChangeCard)
.head 7 -  Call SalEnableWindow(pbEditCard)
.head 6 -  Call SalSendMsg(tblCard, UM_Populate, 0, 0)
.head 6 -  ! Карты/Карты (архив);Инструменты/Инструменты (архив)
.head 6 -  Call SalSetWindowText(cHSpl,
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTCard') || 
     IifS(bCardArch=TRUE, " (" || CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTArc') || ")", "" ) || ";" ||
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTTool') || 
     IifS(bCardArch=TRUE, " (" || CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTArc') || ")", "" ))
.head 5 +  On SAM_TooltipSetText
.head 6 +  If bCardArch
.head 7 -  ! Карты
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTCard'))
.head 6 +  Else
.head 7 -  ! Карты (архив)
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTCard') || " (" ||
       CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTArc') || ")")
.head 3 +  Child Table: tblCard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    0.571"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colCardTypeId	! N тип
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCardTypeName	! S тип
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colID		! N Ид. Карты
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид.
Карты
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colACS_ID	! N Ид. в АКС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид.
в АКС
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPOOL_NO	! № пула
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
пула
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colISSUER_DATE	! D Дата старта карты
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
старта карты
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEXPIRE_DATE	! D Дата окончания
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
окончания
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTATUS	! S Статус для АКС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Статус
для АКС
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTOP_STATUS	! N Статус постановки карты в STOP лист
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Статус постановки карты
в STOP лист
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colComment	! S Коментарий
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Коментарий
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colClosed	! S Closed
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Закрытая
карточка
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colChgType	! S Тип изменения
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
изменения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colChgDate	! D Дата изменения
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
изменения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: DateTime
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colQuestion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 200
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAnswer
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 200
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: sync
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : cardFrom
.head 8 -  Class: cNNCard
.head 7 -  : cardTo
.head 8 -  Class: cNNCard
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Set cardTo.nCardId       = cardFrom.nCardId
.head 7 -  Set cardTo.nCardAcsId    = cardFrom.nCardAcsId
.head 7 -  Set cardTo.nCardPoolNo   = cardFrom.nCardPoolNo
.head 7 -  Set cardTo.dCardIssuer   = cardFrom.dCardIssuer
.head 7 -  Set cardTo.dCardExpered  = cardFrom.dCardExpered
.head 7 -  Set cardTo.nCardTypeId   = cardFrom.nCardTypeId
.head 7 -  Set cardTo.sCardTypeName = cardFrom.sCardTypeName
.head 7 -  Set cardTo.sCardComment  = cardFrom.sCardComment
.head 7 -  Set cardTo.sCardQuestion = cardFrom.sCardQuestion
.head 7 -  Set cardTo.sCardAnswer   = cardFrom.sCardAnswer
.head 7 -  Set i = 0
.head 7 +  While i < cardFrom.nToolsListNum
.head 8 -  Set cardTo.ToolsList[i].nToolId       = cardFrom.ToolsList[i].nToolId
.head 8 -  Set cardTo.ToolsList[i].nToolAcsId    = cardFrom.ToolsList[i].nToolAcsId
.head 8 -  Set cardTo.ToolsList[i].nToolTypeId   = cardFrom.ToolsList[i].nToolTypeId
.head 8 -  Set cardTo.ToolsList[i].sToolTypeName = cardFrom.ToolsList[i].sToolTypeName
.head 8 -  Set cardTo.ToolsList[i].dToolEnter    = cardFrom.ToolsList[i].dToolEnter
.head 8 -  Set cardTo.ToolsList[i].dToolExpire   = cardFrom.ToolsList[i].dToolExpire
.head 8 -  Set cardTo.ToolsList[i].nLoadAccId    = cardFrom.ToolsList[i].nLoadAccId
.head 8 -  Set cardTo.ToolsList[i].sLoadAccNls   = cardFrom.ToolsList[i].sLoadAccNls
.head 8 -  Set cardTo.ToolsList[i].sLoadAccNms   = cardFrom.ToolsList[i].sLoadAccNms
.head 8 -  Set cardTo.ToolsList[i].nLimitId      = cardFrom.ToolsList[i].nLimitId
.head 8 -  Set cardTo.ToolsList[i].sLimitNum    = cardFrom.ToolsList[i].sLimitNum
.head 8 -  Set cardTo.ToolsList[i].sLimitName   = cardFrom.ToolsList[i].sLimitName
.head 8 -  Set cardTo.ToolsList[i].sToolAccNls   = cardFrom.ToolsList[i].sToolAccNls
.head 8 -  Set cardTo.ToolsList[i].sToolAccNms   = cardFrom.ToolsList[i].sToolAccNms
.head 8 -  Set i = i + 1
.head 7 -  Set cardTo.nToolsListNum = cardFrom.nToolsListNum
.head 7 -  Return TRUE
.head 5 +  Function: populateCard
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Call SalTblReset(hWndForm)
.head 7 -  Set i = 0
.head 7 +  While i < cCardList.nListNum
.head 8 -  ! Call Debug('i=>'||Str(i)||'
bCardArch=>' || Str(bCardArch) || '
nCardId=>' || Str(cCardList.CardList[i].nCardId) || '
sClosed=>' || cCardList.CardList[i].sClosed || '
bInserted=>' || Str(cCardList.CardList[i].bInserted) || '
bDeleted=>' || Str(cCardList.CardList[i].bDeleted))
.head 8 +  If ( bCardArch or not bCardArch and cCardList.CardList[i].sClosed = 'N' )
and not ( cCardList.CardList[i].bInserted and cCardList.CardList[i].bDeleted )
.head 9 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 9 -  Set colCardTypeName = cCardList.CardList[i].sCardTypeName
.head 9 -  Set colID          = cCardList.CardList[i].nCardId
.head 9 -  Set colACS_ID      = cCardList.CardList[i].nCardAcsId
.head 9 -  Set colPOOL_NO     = cCardList.CardList[i].nCardPoolNo
.head 9 -  Set colISSUER_DATE = cCardList.CardList[i].dCardIssuer
.head 9 -  Set colEXPIRE_DATE = cCardList.CardList[i].dCardExpered
.head 9 -  Set colSTATUS      = cCardList.CardList[i].sCardStatus
.head 9 -  Set colSTOP_STATUS = cCardList.CardList[i].sCardStopStatus
.head 9 -  Set colComment     = cCardList.CardList[i].sCardComment
.head 9 -  Set colClosed      = cCardList.CardList[i].sClosed
.head 9 -  Set colChgType     = cCardList.CardList[i].sChgType
.head 9 -  Set colChgDate     = cCardList.CardList[i].dChgDate
.head 9 -  Set colQuestion    = cCardList.CardList[i].sCardQuestion
.head 9 -  Set colAnswer      = cCardList.CardList[i].sCardAnswer
.head 9 +  If cCardList.CardList[i].bInserted
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, TRUE)
.head 9 +  Else If cCardList.CardList[i].bDeleted
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, TRUE)
.head 9 +  Else If cCardList.CardList[i].bChanged
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 +  If colClosed = 'Y'
.head 10 -  Call VisTblSetRowColor(hWndForm, nRow, COLOR_DarkRed)
.head 8 -  Set i = i + 1
.head 7 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 7 -  ! Установка фокуса
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 7 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 7 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: i
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  : cCard
.head 6 -  Class: cNNCard
.head 5 -  Number: nCardIdNew
.head 5 -  Number: nCardAcsId
.head 5 -  Number: nCardPoolNo
.head 5 -  Date/Time: dCardIssuer
.head 5 -  Date/Time: dCardExpered
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 6 -  Call cCardList.Init(nRNK)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Call cCardList.SetCardArc(bCardArch)
.head 6 -  Call cCardList.Populate()
.head 6 +  If bCardArch
.head 7 -  Call SalShowWindow(colClosed)
.head 7 -  Call SalShowWindow(colChgType)
.head 7 -  Call SalShowWindow(colChgDate)
.head 6 +  Else
.head 7 -  Call SalHideWindow(colClosed)
.head 7 -  Call SalHideWindow(colChgType)
.head 7 -  Call SalHideWindow(colChgDate)
.head 6 -  !
.head 6 -  Call populateCard()
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set nCardId = colID
.head 6 -  Set nCardIndex = cCardList.GetIndexByCardId(nCardId)
.head 6 -  ! Кнопки
.head 6 +  If bPossibleToEdit and not bCardArch
.head 7 -  ! Кнопка "Сменить карту" - закрываем для новой карты
.head 7 +  If not SalTblQueryRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_New)
.head 8 -  Call SalEnableWindow(pbChangeCard)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(pbChangeCard)
.head 6 -  ! Население инструментов для выбранной карты
.head 6 -  Call SalSendMsg(tblTool, UM_Populate, 0, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  ! Установка фокуса
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 6 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 -  ! Добавить карту
.head 5 +  On UM_Insert
.head 6 +  If SalModalDialog(Dlg_CustNNCardAdd, hWndMDI, TRUE, TRUE, nRNK, sTobo, sCustBranch, cCard, IifN(cCardList.nListNum=0,1,2))
.head 7 -  Call setEdited()
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colID           = cCard.nCardId
.head 7 -  Set colACS_ID       = cCard.nCardAcsId
.head 7 -  Set colPOOL_NO      = cCard.nCardPoolNo
.head 7 -  Set colISSUER_DATE  = cCard.dCardIssuer
.head 7 -  Set colEXPIRE_DATE  = cCard.dCardExpered
.head 7 -  Set colCardTypeId   = cCard.nCardTypeId
.head 7 -  Set colCardTypeName = cCard.sCardTypeName
.head 7 -  Set colComment      = cCard.sCardComment
.head 7 -  Set colQuestion     = cCard.sCardQuestion
.head 7 -  Set colAnswer       = cCard.sCardAnswer
.head 7 -  Call cCardList.AddCard(colID, colCardTypeId, colCardTypeName,
     colACS_ID, colPOOL_NO, colISSUER_DATE, colEXPIRE_DATE,
     colComment, colQuestion, colAnswer)
.head 7 -  Set i = 0
.head 7 +  While i < cCard.nToolsListNum
.head 8 -  Call cCardList.AddCardTool(colID, cCard.ToolsList[i].nToolId, cCard.ToolsList[i].nToolAcsId, 
     cCard.ToolsList[i].nToolTypeId, cCard.ToolsList[i].sToolTypeName, cCard.ToolsList[i].dToolEnter, cCard.ToolsList[i].dToolExpire,
     cCard.ToolsList[i].nLoadAccId, cCard.ToolsList[i].sLoadAccNls, cCard.ToolsList[i].sLoadAccNms, 
     cCard.ToolsList[i].nLimitId, cCard.ToolsList[i].sLimitNum, cCard.ToolsList[i].sLimitName, 
     cCard.ToolsList[i].sToolAccNls, cCard.ToolsList[i].sToolAccNms)
.head 8 -  Set i = i + 1
.head 7 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 7 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 5 -  ! Закрыть карту
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 +  If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 8 -  Call setEdited()
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 8 -  Call cCardList.SetCardDeleteFlag(colID, SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 7 +  Else
.head 8 -  Call cCardList.SetCardDeleteFlag(colID, TRUE)
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 5 -  ! Редактировать карту
.head 5 +  On SAM_DoubleClick
.head 6 +  If colID
.head 7 -  Call sync(cCardList.CardList[nCardIndex], cCard)
.head 7 +  If SalModalDialog(Dlg_CustNNCardAdd, hWndMDI, FALSE, bPossibleToEdit, nRNK, sTobo, sCustBranch, cCard, 0)
.head 8 -  Call setEdited()
.head 8 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 8 +  If colComment != cCard.sCardComment
.head 9 -  Set colComment = cCard.sCardComment
.head 9 -  Call cCardList.ChangeComment(colID, colComment)
.head 8 +  If colQuestion != cCard.sCardQuestion 
or colAnswer   != cCard.sCardAnswer
.head 9 -  Set colQuestion = cCard.sCardQuestion
.head 9 -  Set colAnswer   = cCard.sCardAnswer
.head 9 -  Call cCardList.ChangeKeyPhrase(colID, colQuestion, colAnswer)
.head 8 -  Set i = 0
.head 8 +  While i < cCard.nToolsListNum
.head 9 +  If cCard.ToolsList[i].nLimitId   != cCardList.CardList[nCardIndex].ToolsList[i].nLimitId
or cCard.ToolsList[i].nLoadAccId != cCardList.CardList[nCardIndex].ToolsList[i].nLoadAccId
.head 10 -  Call cCardList.ChangeCardTool(nCardId, i,
     cCard.ToolsList[i].nLimitId, cCard.ToolsList[i].sLimitNum, cCard.ToolsList[i].sLimitName,
     cCard.ToolsList[i].nLoadAccId, cCard.ToolsList[i].sLoadAccNls, cCard.ToolsList[i].sLoadAccNms)
.head 9 -  Set i = i + 1
.head 8 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 8 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 5 -  ! Сменить карту
.head 5 +  On SAM_User
.head 6 +  If colID
.head 7 +  If FunNSIGetFiltered('v_nncard_free', 'card_id', 'branch=' || IifS(sTobo='', sCustBranch, sTobo), sPK, sSem)
.head 8 -  Call setEdited()
.head 8 +  If sPK != ''
.head 9 -  Set nCardIdNew = Val(sPK)
.head 9 -  Call SqlPrepareAndExecute(hSql(), 
"select card_acsid, card_poolno, card_issued, card_expired
   into :nCardAcsId, :nCardPoolNo, :dCardIssuer, :dCardExpered
   from v_nncard_free
  where card_id = :nCardIdNew")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call cCardList.ChangeCard(colID, nCardIdNew, nCardAcsId, nCardPoolNo, dCardIssuer, dCardExpered)
.head 8 -  ! Call SalSendMsg(hWndForm, UM_Populate, 0, SalTblQueryContext(hWndForm))
.head 8 -  Call populateCard()
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 3 +  Child Table: tblTool
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    2.452"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colTOOL_ID		! N Ид. инструмента АБС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. инструмента
АБС
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTOOL_ACS_ID		! N Ид. инструмента в АКС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. инструмента в
АКС
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTOOL_TYPE_ID		! N Ид. типа инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. типа
инструмента
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTOOL_TYPE_NAME	! S Тип инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colENTER_DATE		! D Дата начала действия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата начала
действия
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEXPIRE_DATE		! D Дата окончания действия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата окончания
действия
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLOAD_ACC		! N Ид. счета загрузки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
загрузки
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLOAD_NLS		! S Счет загрузки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
загрузки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLOAD_NMS		! S Наименование счета загрузки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета загрузки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLIM_ID		! N Ид. схемы лимита
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. схемы
лимитов
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLIM_NUM		! S Схема лимита
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
схемы лимитов
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLIM_NAME		! S Схема лимита
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
схемы лимитов
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colINS_NLS		! S Счет инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colINS_NMS		! S Наименование счета инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colChgType		! S Тип изменения
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
изменения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colChgDate		! D Дата изменения
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
изменения
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: DateTime
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: i
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 +  If bCardArch
.head 7 -  Call SalShowWindow(colChgType)
.head 7 -  Call SalShowWindow(colChgDate)
.head 6 +  Else
.head 7 -  Call SalHideWindow(colChgType)
.head 7 -  Call SalHideWindow(colChgDate)
.head 6 +  If nCardIndex != -1
.head 7 -  Set i = 0
.head 7 +  While i < cCardList.CardList[nCardIndex].nToolsListNum
.head 8 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 8 -  Set colTOOL_ID        = cCardList.CardList[nCardIndex].ToolsList[i].nToolId
.head 8 -  Set colTOOL_ACS_ID    = cCardList.CardList[nCardIndex].ToolsList[i].nToolAcsId
.head 8 -  Set colTOOL_TYPE_ID   = cCardList.CardList[nCardIndex].ToolsList[i].nToolTypeId
.head 8 -  Set colTOOL_TYPE_NAME = cCardList.CardList[nCardIndex].ToolsList[i].sToolTypeName
.head 8 -  Set colENTER_DATE     = cCardList.CardList[nCardIndex].ToolsList[i].dToolEnter
.head 8 -  Set colEXPIRE_DATE    = cCardList.CardList[nCardIndex].ToolsList[i].dToolExpire
.head 8 -  Set colLOAD_ACC       = cCardList.CardList[nCardIndex].ToolsList[i].nLoadAccId
.head 8 -  Set colLOAD_NLS       = cCardList.CardList[nCardIndex].ToolsList[i].sLoadAccNls
.head 8 -  Set colLOAD_NMS       = cCardList.CardList[nCardIndex].ToolsList[i].sLoadAccNms
.head 8 -  Set colLIM_ID         = cCardList.CardList[nCardIndex].ToolsList[i].nLimitId
.head 8 -  Set colLIM_NUM        = cCardList.CardList[nCardIndex].ToolsList[i].sLimitNum
.head 8 -  Set colLIM_NAME       = cCardList.CardList[nCardIndex].ToolsList[i].sLimitName
.head 8 -  Set colINS_NLS        = cCardList.CardList[nCardIndex].ToolsList[i].sToolAccNls
.head 8 -  Set colINS_NMS        = cCardList.CardList[nCardIndex].ToolsList[i].sToolAccNms
.head 8 -  Set colChgType        = cCardList.CardList[nCardIndex].ToolsList[i].sChgType
.head 8 -  Set colChgDate        = cCardList.CardList[nCardIndex].ToolsList[i].dChgDate
.head 8 -  Set i = i + 1
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 3 +  Custom Control: cHSpl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.45"
.head 6 -  Width:  8.217"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.69"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set hWndParent.Frm_Customer.cTabCustNNCard.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  String: sTobo		! ТОБО пользователя
.head 3 -  Boolean: bCardArch
.head 3 -  : cCardList
.head 4 -  Class: cNNCardList
.head 3 -  Number: nCardId
.head 3 -  Number: nCardIndex
.head 3 -  String: sCustBranch	! Branch клиента
.head 3 -  !
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustNNCard')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Customer.cTabCustNNCard.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set sTobo = hWndParent.Frm_Customer.sTOBO
.head 4 -  Set sTobo = IifS(sTobo='0', '', sTobo)
.head 4 -  Set bCardArch = FALSE
.head 4 -  Set sCustBranch = hWndC.AbstractCustomer..getTobo()
.head 4 -  !
.head 4 -  Call cHSpl.setStyle(XSalSplitter_NotResizable, TRUE)
.head 4 -  Call cHSpl.setBarSize(5)
.head 4 -  Call cHSpl.setBarPosition(500)
.head 4 -  Call cHSpl.setTopFrame(tblCard)
.head 4 -  Call cHSpl.setBottomFrame(tblTool)
.head 4 -  ! Карты/Инструменты
.head 4 -  Call SalSetWindowText(cHSpl,
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTCard') || ";" ||
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCard.cTTool') )
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(tblCard, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Customer.cTabCustNNCard.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(pbAddCard)
.head 4 -  Call SalDisableWindow(pbChangeCard)
.head 4 -  Call SalSendMsg(tblCard, SAM_DoInit, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_CustNNCard.cHSpl, 0.08, 0.45)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustNNCard.cHSpl,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNNCard.cHSpl, nWinWidth, FALSE)-0.2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustNNCard.cHSpl, nWinHeight, TRUE)-0.55)
.head 1 +  Dialog Box: Dlg_CustNNCardAdd
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Новая карта
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 46981
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Ид.карты
.head 4 -  Resource Id: 46982
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCardId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfCardId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.75"
.head 5 -  Top:    0.131"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGetFiltered('v_nncard_free', 'card_id', 'branch=' || IifS(sParTobo='', sCustBranch, sParTobo), sPK, sSem)
.head 7 -  Call SalEnableWindow(pbSave)
.head 7 +  If sPK != ''
.head 8 -  Set dfCardId = Val(sPK)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"select card_acsid, card_poolno, card_issued, card_expired
   into :nCardAcsId, :nCardPoolNo, :dCardIssuer, :dCardExpered
   from v_nncard_free
  where card_id = :dfCardId")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalSendMsg(tblTool, UM_Populate, 0, 0)
.head 3 -  Background Text: Тип карты
.head 4 -  Resource Id: 46983
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.55"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCardTypeId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfCardTypeId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.717"
.head 6 -  Top:    0.5"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfCardTypeName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    0.5"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  ! ctb_pbFilter: pbCardType
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.3"
.head 5 -  Top:    0.512"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGetFilteredAltPK('v_customer_nncardtypes', 'cardtype_id', 'cardtype_name', '', sPK, sSem)
.head 7 -  Call SalEnableWindow(pbSave)
.head 7 +  If sPK != ''
.head 8 +  If not SalTblAnyRows(tblTool, 0, 0) and Val(sPK) != 1
.head 9 -  Call SalMessageBox("Заборонено видавати додаткову карту клієнту який немає основної картки !",
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 9 -  Set dfCardTypeId   = NUMBER_Null
.head 9 -  Set dfCardTypeName = STRING_Null
.head 8 +  Else 
.head 9 -  Set dfCardTypeId   = Val(sPK)
.head 9 -  Set dfCardTypeName = sSem
.head 7 +  Else 
.head 8 -  Set dfCardTypeId   = NUMBER_Null
.head 8 -  Set dfCardTypeName = STRING_Null
.head 3 -  Background Text: Коментарий
.head 4 -  Resource Id: 46984
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.85"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgComment
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfComment
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    0.8"
.head 6 -  Width:  4.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Ключевая фраза
.head 4 -  Resource Id: 46985
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.15"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKeyPhrase
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbKeyPhrase
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.7"
.head 5 -  Top:    1.1"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Ключевая фраза
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_CustNNCardAdd.bgKeyPhrase'))
.head 5 +  On SAM_Click
.head 6 +  If SalModalDialog(Dlg_KeyPhrase, hWndForm, bEdit, sQuestion, sAnswer)
.head 7 -  Call SalEnableWindow(pbSave)
.head 3 +  Pushbutton: pbEditTool
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.8"
.head 5 -  Top:    1.5"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblTool, SAM_DoubleClick, 0, SalTblQueryContext(tblTool))
.head 3 +  Child Table: tblTool
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.5"
.head 6 -  Width:  8.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.2"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTOOL_ID		! N Ид. инструмента АБС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. инструмента
АБС
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTOOL_ACS_ID		! N Ид. инструмента в АКС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. инструмента в
АКС
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTOOL_TYPE_ID		! N Ид. типа инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTOOL_TYPE_NAME	! S Тип инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colENTER_DATE		! D Дата начала действия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата начала
действия
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEXPIRE_DATE		! D Дата окончания действия
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата окончания
действия
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLOAD_ACC	
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLOAD_NLS		! S Счет загрузки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
загрузки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLOAD_NMS		! S Наименование счета загрузки
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета загрузки
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLIM_ID		! N Ид. схемы лимитов
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид. схемы
лимитов
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLIM_NUM		! S Номер схемы лимитов
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
схемы лимитов
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLIM_NAME		! S Наименование схемы лимитов
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
схемы лимитов
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colINS_NLS		! S Счет инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colINS_NMS		! S Наименование счета инструмента
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета инструмента
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: checkTools
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  String: sTitle
.head 6 +  Actions
.head 7 -  Set cCard.nToolsListNum = 0
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If SalIsNull(colLIM_ID)
.head 9 -  Call SalTblGetColumnTitle(colLIM_NAME, sTitle, 254)
.head 9 -  ! Не заполнен реквизит <>
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || sTitle || '>', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 9 -  Call SalSetFocus(hWndForm)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 9 -  Call SalTblSetFocusCell(hWndForm, nRow, colLIM_ID, 0, 0)
.head 9 -  Return FALSE
.head 8 +  If SalIsNull(colLOAD_NLS)
.head 9 -  Call SalTblGetColumnTitle(colLOAD_NLS, sTitle, 254)
.head 9 -  ! Не заполнен реквизит <>
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || sTitle || '>', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 9 -  Call SalSetFocus(hWndForm)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 9 -  Call SalTblSetFocusCell(hWndForm, nRow, colLOAD_NLS, 0, 0)
.head 9 -  Return FALSE
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].nToolId       = colTOOL_ID
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].nToolAcsId    = colTOOL_ACS_ID
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].nToolTypeId   = colTOOL_TYPE_ID
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sToolTypeName = colTOOL_TYPE_NAME
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].dToolEnter    = colENTER_DATE
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].dToolExpire   = colEXPIRE_DATE
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].nLimitId      = colLIM_ID
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sLimitNum     = colLIM_NUM
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sLimitName    = colLIM_NAME
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].nLoadAccId    = colLOAD_ACC
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sLoadAccNls   = colLOAD_NLS
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sLoadAccNms   = colLOAD_NMS
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sToolAccNls   = colINS_NLS
.head 8 -  Set cCard.ToolsList[cCard.nToolsListNum].sToolAccNms   = colINS_NMS
.head 8 -  Set cCard.nToolsListNum = cCard.nToolsListNum + 1
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: i
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 +  If bNew
.head 7 -  Call SalTblPopulate(hWndForm, hSql(),
"select tool_id, tool_acsid, tooltype_name,
        tool_enter, tool_expire, 
        loadacc_id, loadacc_num, loadacc_name, 
        lim_id, lim_num, lim_name,
        toolacc_num, toolacc_name
   into :colTOOL_ID, :colTOOL_ACS_ID, :colTOOL_TYPE_NAME, 
        :colENTER_DATE, :colEXPIRE_DATE, 
        :colLOAD_ACC, :colLOAD_NLS, :colLOAD_NMS, 
        :colLIM_ID, :colLIM_NUM, :colLIM_NAME, 
        :colINS_NLS, :colINS_NMS
   from v_customer_nncardtools
  where card_id = :dfCardId
  order by card_id, tool_id", TBL_FillAll)
.head 6 +  Else
.head 7 -  Set i = 0
.head 7 +  While i < cCard.nToolsListNum
.head 8 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 8 -  Set colTOOL_ID        = cCard.ToolsList[i].nToolId
.head 8 -  Set colTOOL_ACS_ID    = cCard.ToolsList[i].nToolAcsId
.head 8 -  Set colTOOL_TYPE_ID   = cCard.ToolsList[i].nToolTypeId
.head 8 -  Set colTOOL_TYPE_NAME = cCard.ToolsList[i].sToolTypeName
.head 8 -  Set colENTER_DATE     = cCard.ToolsList[i].dToolEnter
.head 8 -  Set colEXPIRE_DATE    = cCard.ToolsList[i].dToolExpire
.head 8 -  Set colLOAD_ACC       = cCard.ToolsList[i].nLoadAccId
.head 8 -  Set colLOAD_NLS       = cCard.ToolsList[i].sLoadAccNls
.head 8 -  Set colLOAD_NMS       = cCard.ToolsList[i].sLoadAccNms
.head 8 -  Set colLIM_ID         = cCard.ToolsList[i].nLimitId
.head 8 -  Set colLIM_NUM        = cCard.ToolsList[i].sLimitNum
.head 8 -  Set colLIM_NAME       = cCard.ToolsList[i].sLimitName
.head 8 -  Set colINS_NLS        = cCard.ToolsList[i].sToolAccNls
.head 8 -  Set colINS_NMS        = cCard.ToolsList[i].sToolAccNms
.head 8 -  Set i = i + 1
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 5 +  On SAM_DoubleClick
.head 6 +  If bEdit and colTOOL_ID
.head 7 -  Set nLoadAcc   = colLOAD_ACC
.head 7 -  Set sLoadNls   = colLOAD_NLS
.head 7 -  Set sLoadNms   = colLOAD_NMS
.head 7 -  Set nLimitId   = colLIM_ID
.head 7 -  Set sLimitNum  = colLIM_NUM
.head 7 -  Set sLimitName = colLIM_NAME
.head 7 +  If SalModalDialog(Dlg_CustNNCardEditTool, hWndMDI, nRnk, nLoadAcc, sLoadNls, sLoadNms, nLimitId, sLimitNum, sLimitName)
.head 8 -  Set colLOAD_ACC = nLoadAcc
.head 8 -  Set colLOAD_NLS = sLoadNls
.head 8 -  Set colLOAD_NMS = sLoadNms
.head 8 -  Set colLIM_ID   = nLimitId
.head 8 -  Set colLIM_NUM  = sLimitNum
.head 8 -  Set colLIM_NAME = sLimitName
.head 8 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 8 -  Call SalEnableWindow(pbSave)
.head 3 -  Frame
.head 4 -  Resource Id: 46192
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    3.9"
.head 5 -  Width:  9.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.5"
.head 5 -  Top:    4.025"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull(dfCardId)
.head 7 -  ! Не заполнен реквизит <Ид.карты>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCardAdd.bgCardId') || '>', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Call SalSetFocus(pbCard)
.head 7 -  Return FALSE
.head 6 +  If SalIsNull(dfCardTypeId)
.head 7 -  ! Не заполнен реквизит <Тип карты>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCardAdd.bgCardTypeId') || '>',
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  ! Call SalSetFocus(pbCardType)
.head 7 -  Return FALSE
.head 6 +  If sQuestion = STRING_Null or sAnswer = STRING_Null
.head 7 -  ! Не заполнен реквизит <Ключевая фраза>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrCustRekv') || '<' || 
     CurrentLangTable.GetAtomTitle('Dlg_CustNNCardAdd.bgKeyPhrase') || '>', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 7 -  Call SalSetFocus(pbKeyPhrase)
.head 7 -  Return FALSE
.head 6 +  If not tblTool.checkTools()
.head 7 -  Return FALSE
.head 6 +  If bNew
.head 7 -  Set cCard.nCardId       = dfCardId
.head 7 -  Set cCard.nCardAcsId    = nCardAcsId
.head 7 -  Set cCard.nCardPoolNo   = nCardPoolNo
.head 7 -  Set cCard.dCardIssuer   = dCardIssuer
.head 7 -  Set cCard.dCardExpered  = dCardExpered
.head 7 -  Set cCard.nCardTypeId   = dfCardTypeId
.head 7 -  Set cCard.sCardTypeName = dfCardTypeName
.head 6 -  Set cCard.sCardComment  = dfComment
.head 6 -  Set cCard.sCardQuestion = sQuestion
.head 6 -  Set cCard.sCardAnswer   = sAnswer
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.05"
.head 5 -  Top:    4.025"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: bNew	! Новая карта
.head 3 -  Boolean: bEdit	! 1-редактировать старую карту, 0-просмотр
.head 3 -  Number: nRnk
.head 3 -  String: sParTobo
.head 3 -  String: sCustBranch
.head 3 -  : cCard
.head 4 -  Class: cNNCard
.head 3 -  Number: nCardTypeId	! Для новой карты: 1-основная, 2-дополнительная
.head 2 +  Window Variables
.head 3 -  Number: nCardAcsId
.head 3 -  Number: nCardPoolNo
.head 3 -  Date/Time: dCardIssuer
.head 3 -  Date/Time: dCardExpered
.head 3 -  String: sQuestion
.head 3 -  String: sAnswer
.head 3 -  Number: nLoadAcc
.head 3 -  String: sLoadNls
.head 3 -  String: sLoadNms
.head 3 -  Number: nLimitId
.head 3 -  String: sLimitNum
.head 3 -  String: sLimitName
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_CustNNCardAdd.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 +  If bNew
.head 5 -  Call SqlPrepareAndExecute(hSql(),
"select cardtype_id, cardtype_name
   into :dfCardTypeId, :dfCardTypeName
   from v_customer_nncardtypes
  where cardtype_id = :nCardTypeId")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set dfCardId       = cCard.nCardId
.head 5 -  Set dfCardTypeId   = cCard.nCardTypeId
.head 5 -  Set dfCardTypeName = cCard.sCardTypeName
.head 5 -  Set dfComment      = cCard.sCardComment
.head 5 -  Set sQuestion      = cCard.sCardQuestion
.head 5 -  Set sAnswer        = cCard.sCardAnswer
.head 5 -  Call SalSendMsg(tblTool, UM_Populate, 0, 0)
.head 5 -  Call SalHideWindow(pbCard)
.head 5 -  ! Call SalHideWindow(pbCardType)
.head 5 +  If not bEdit
.head 6 -  Call SalDisableWindow(dfComment)
.head 6 -  Call SalHideWindow(pbEditTool)
.head 1 +  Dialog Box: Dlg_CustNNCardEditTool
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Инструмент
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   4.95"
.head 4 -  Top:    4.625"
.head 4 -  Width:  9.4"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 48656
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Счет загрузки
.head 4 -  Resource Id: 48657
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLoadAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLoadNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLoadNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.55"
.head 6 -  Top:    0.2"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.6"
.head 5 -  Top:    0.131"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGetFiltered('v_customer_loadaccs', 'acc_id', 'cust_id=' || Str(nRnk), sPK, sSem)
.head 7 +  If sPK != ''
.head 8 -  Set nLoadAcc = Val(sPK)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"select acc_num, acc_name into :dfLoadNls, :dfLoadNms
   from v_customer_loadaccs
  where acc_id = :nLoadAcc")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set sLoadNls = dfLoadNls
.head 8 -  Set sLoadNms = dfLoadNms
.head 8 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Схема лимита
.head 4 -  Resource Id: 48658
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.55"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLimitId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.717"
.head 6 -  Top:    0.5"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLimitName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.55"
.head 6 -  Top:    0.5"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.6"
.head 5 -  Top:    0.512"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  If not nLoadAcc
.head 7 -  ! Не указан счет загрузки!
.head 7 -  Return SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustNNCardEditTool.cTMsgLoadAcc'), 
       CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 6 +  If FunNSIGetFilteredAltPK('v_customer_loadacclimits', 'lim_id', 'lim_name', 'acc_id=' || Str(nLoadAcc), sPK, sSem)
.head 7 +  If sPK != ''
.head 8 -  Set dfLimitId   = Val(sPK)
.head 8 -  Set dfLimitName = sSem
.head 8 -  Set nLimitId    = dfLimitId
.head 8 -  Set sLimitName  = dfLimitName
.head 8 -  Call SalEnableWindow(pbSave)
.head 3 -  Frame
.head 4 -  Resource Id: 48661
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.95"
.head 5 -  Width:  9.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.5"
.head 5 -  Top:    1.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.833"
.head 5 -  Top:    1.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nRnk
.head 3 -  Receive Number: nLoadAcc
.head 3 -  Receive String: sLoadNls
.head 3 -  Receive String: sLoadNms
.head 3 -  Receive Number: nLimitId
.head 3 -  Receive String: sLimitNum
.head 3 -  Receive String: sLimitName
.head 2 +  Window Variables
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_CustNNCardEditTool.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 -  Set dfLoadNls = sLoadNls
.head 4 -  Set dfLoadNms = sLoadNms
.head 4 -  Set dfLimitId = nLimitId
.head 4 -  Set dfLimitName = sLimitName
.head 1 +  Dialog Box: Dlg_AccNNLimit
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.4"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pbAddLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Добавить лимит
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccNNLimit.cBTipAddLimit'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblLimit, UM_Insert, 0, 0)
.head 3 +  Picture: pbDelLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Удалить лимит
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccNNLimit.cBTipDelLimit'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblLimit, UM_Delete, 0, 0)
.head 3 +  Picture: pbChangeLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.1"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Изменить лимит
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccNNLimit.cBTipChangeLimit'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblLimit, SAM_DoubleClick, 0, SalTblQueryContext(tblLimit))
.head 3 +  Picture: pbRefresh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.7"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\REFRESH.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Перечитать данные
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cBTipRefresh'))
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblLimit, UM_Populate, 0, 0)
.head 3 +  Picture: pbPosUp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.283"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\PUT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Переместить вверх
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccNNLimit.cBTipPosUp'))
.head 5 +  On SAM_Click
.head 6 -  Call tblLimit.changePos(TRUE)
.head 3 +  Picture: pbPosDown
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.733"
.head 5 -  Top:    0.06"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\PUTD.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Переместить вниз
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_AccNNLimit.cBTipPosDown'))
.head 5 +  On SAM_Click
.head 6 -  Call tblLimit.changePos(FALSE)
.head 3 +  Child Table: tblLimit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    0.45"
.head 6 -  Width:  8.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colListId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimId	! N Ід. ліміту
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ід.
ліміту
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimNum	! S Номер лимита
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
лимита 
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimValue	! N Сума ліміту
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума ліміту
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimValueAcs	! N Сума ліміту в АКС
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума ліміту
в АКС
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimFixBal	! N Остатот фикс. Суммы
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остатот
фикс. Суммы
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimStatus	! S Состояние
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Состояние
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimError	! S Ошибка
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ошибка
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimDeleted	! N Признак удаленного лимита
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
удаленного
лимита
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLimPos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: LimPos
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: changePos
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bUp
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nCurrRow
.head 7 -  Number: nUpId
.head 7 -  Number: nDownId
.head 7 -  Number: nUpLimPos
.head 7 -  Number: nDownLimPos
.head 6 +  Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Set nCurrRow = SalTblQueryContext(hWndForm)
.head 8 +  If bUp and nCurrRow != 0
.head 9 -  Set nUpId     = colListId
.head 9 -  Set nUpLimPos = colLimPos
.head 9 -  !
.head 9 -  Call SalTblSetContext(hWndForm, nCurrRow-1)
.head 9 -  Set nDownId     = colListId
.head 9 -  Set nDownLimPos = colLimPos
.head 9 -  !
.head 9 -  Call cLimitList.changeLimPos(nUpId, nDownLimPos)
.head 9 -  Call cLimitList.changeLimPos(nDownId, nUpLimPos)
.head 9 -  !
.head 9 -  Call moveRowUp(nCurrRow, nUpId, nDownId)
.head 9 -  Call SalTblSetContext(hWndForm, nCurrRow-1)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nCurrRow-1)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nCurrRow-1, ROW_Selected, TRUE)
.head 8 +  Else If not bUp and nCurrRow != nMaxRow
.head 9 -  Set nDownId     = colListId
.head 9 -  Set nDownLimPos = colLimPos
.head 9 -  !
.head 9 -  Call SalTblSetContext(hWndForm, nCurrRow+1)
.head 9 -  Set nUpId     = colListId
.head 9 -  Set nUpLimPos = colLimPos
.head 9 -  !
.head 9 -  Call cLimitList.changeLimPos(nDownId, nUpLimPos)
.head 9 -  Call cLimitList.changeLimPos(nUpId, nDownLimPos)
.head 9 -  !
.head 9 -  Call moveRowUp(nCurrRow+1, nUpId, nDownId)
.head 9 -  Call SalTblSetContext(hWndForm, nCurrRow+1)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nCurrRow+1)
.head 9 -  Call SalTblSetRowFlags(hWndForm, nCurrRow+1, ROW_Selected, TRUE)
.head 7 -  Return TRUE
.head 5 +  Function: moveRowUp
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nRowUp
.head 7 -  Number: nIdUp
.head 7 -  Number: nIdDown
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nCurrRow
.head 7 -  Number: nUpRowFlags
.head 7 -  Number: nDownRowFlags
.head 6 +  Actions
.head 7 -  Call hWndParent.Frm_Account.IsEdited()
.head 7 -  ! запоминаем флаги
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRowUp, ROW_Edited)
.head 8 -  Set nUpRowFlags = ROW_Edited
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRowUp, ROW_MarkDeleted)
.head 8 -  Set nUpRowFlags = nUpRowFlags | ROW_MarkDeleted
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRowUp-1, ROW_Edited)
.head 8 -  Set nDownRowFlags = ROW_Edited
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRowUp-1, ROW_MarkDeleted)
.head 8 -  Set nDownRowFlags = nDownRowFlags | ROW_MarkDeleted
.head 7 -  ! нижняя строка
.head 7 -  Call SalTblSetContext(hWndForm, nRowUp)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRowUp, ROW_Edited | ROW_MarkDeleted, FALSE)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRowUp, nDownRowFlags, TRUE)
.head 7 -  Set colListId = nIdDown
.head 7 -  Call cLimitList.getLimitByIndex(colListId, colLimId, colLimNum,
     colLimValue, colLimValueAcs, colLimFixBal, colLimStatus, colLimError, 
     colLimDeleted, colLimPos)
.head 7 -  Call VisTblSetRowColor(hWndForm, nRowUp, IifN(SalTblQueryRowFlags(hWndForm, nRowUp, ROW_MarkDeleted) or colLimDeleted, COLOR_DarkRed, COLOR_Black))
.head 7 -  ! верхняя строка
.head 7 -  Call SalTblSetContext(hWndForm, nRowUp-1)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRowUp-1, ROW_Edited | ROW_MarkDeleted, FALSE)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRowUp-1, nUpRowFlags, TRUE)
.head 7 -  Set colListId = nIdUp
.head 7 -  Call cLimitList.getLimitByIndex(colListId, colLimId, colLimNum,
     colLimValue, colLimValueAcs, colLimFixBal, colLimStatus, colLimError, 
     colLimDeleted, colLimPos)
.head 7 -  Call VisTblSetRowColor(hWndForm, nRowUp-1, IifN(SalTblQueryRowFlags(hWndForm, nRowUp-1, ROW_MarkDeleted) or colLimDeleted, COLOR_DarkRed, COLOR_Black))
.head 7 -  !
.head 7 -  Set i = TBL_MinRow 
.head 7 +  While SalTblFindNextRow(hWndForm, i, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, i)
.head 8 -  Call SalTblSetRowFlags(hWndForm, i, ROW_Selected, FALSE)
.head 8 +  If colListId = nIdUp or colListId = nIdDown
.head 9 -  Call SalTblSetRowFlags(hWndForm, i, ROW_Edited, TRUE)
.head 7 -  Return TRUE
.head 5 +  Function: sync
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  : limitFrom
.head 8 -  Class: cNNLimit
.head 7 -  : limitTo
.head 8 -  Class: cNNLimit
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set limitTo.nLimId       = limitFrom.nLimId
.head 7 -  Set limitTo.sLimNum      = limitFrom.sLimNum
.head 7 -  Set limitTo.nLimValue    = limitFrom.nLimValue
.head 7 -  Set limitTo.nLimValueAcs = limitFrom.nLimValueAcs
.head 7 -  Set limitTo.nLimFixBal   = limitFrom.nLimFixBal
.head 7 -  Set limitTo.sLimStatus   = limitFrom.sLimStatus
.head 7 -  Set limitTo.sLimError    = limitFrom.sLimError
.head 7 -  Set limitTo.bLimDeleted  = limitFrom.bLimDeleted
.head 7 -  Set limitTo.nLimPos      = limitFrom.nLimPos
.head 7 -  Set limitTo.sLimIsFix    = limitFrom.sLimIsFix
.head 7 -  Set limitTo.nLimFixAmnt  = limitFrom.nLimFixAmnt
.head 7 -  Set limitTo.nLimFixDays  = limitFrom.nLimFixDays
.head 7 -  Set limitTo.nLimMinBal   = limitFrom.nLimMinBal
.head 7 -  Set limitTo.nLimMaxBal   = limitFrom.nLimMaxBal
.head 7 -  Set limitTo.nLimPrcBal   = limitFrom.nLimPrcBal
.head 7 -  Return TRUE
.head 5 +  Function: addNewLimit
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  : cLimit
.head 8 -  Class: cNNLimit
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sLimIsFix
.head 7 -  Number: nLimFixAmnt
.head 7 -  Number: nLimFixDays
.head 7 -  Number: nLimMinBal
.head 7 -  Number: nLimMaxBal
.head 7 -  Number: nLimPrcBal
.head 7 -  !
.head 7 -  Number: nLimIdOut
.head 7 -  Number: nIndexOut
.head 6 +  Actions
.head 7 -  Set sLimIsFix   = cLimit.sLimIsFix
.head 7 -  Set nLimFixAmnt = cLimit.nLimFixAmnt
.head 7 -  Set nLimFixDays = cLimit.nLimFixDays
.head 7 -  Set nLimMinBal  = cLimit.nLimMinBal
.head 7 -  Set nLimMaxBal  = cLimit.nLimMaxBal
.head 7 -  Set nLimPrcBal  = cLimit.nLimPrcBal
.head 7 +  If not cLimitList.SaveNewLimit(nLimIdOut, sLimIsFix, nLimFixAmnt, nLimFixDays, nLimMinBal, nLimMaxBal, nLimPrcBal, nIndexOut)
.head 8 -  Return FALSE
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colListId = nIndexOut
.head 7 -  Call cLimitList.getLimitByIndex(colListId, colLimId, colLimNum,
     colLimValue, colLimValueAcs, colLimFixBal, colLimStatus, colLimError, 
     colLimDeleted, colLimPos)
.head 7 -  Set i = TBL_MinRow 
.head 7 +  While SalTblFindNextRow(hWndForm, i, 0, 0)
.head 8 -  Call SalTblSetRowFlags(hWndForm, i, ROW_Selected, FALSE)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New | ROW_Edited | ROW_MarkDeleted, FALSE)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, TRUE)
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nMaxRow
.head 5 -  Number: i
.head 5 -  !
.head 5 -  : cLimit
.head 6 -  Class: cNNLimit
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Call cLimitList.Init(nAcc)
.head 6 -  Call cLimitList.Populate()
.head 6 -  Set i = 0
.head 6 +  While i < cLimitList.nListNum
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 7 -  Set colListId = i
.head 7 -  Call cLimitList.getLimitByIndex(colListId, colLimId, colLimNum,
     colLimValue, colLimValueAcs, colLimFixBal, colLimStatus, colLimError, 
     colLimDeleted, colLimPos)
.head 7 +  If colLimDeleted
.head 8 -  Call VisTblSetRowColor(hWndForm, nRow, COLOR_DarkRed)
.head 7 -  Set i = i + 1
.head 6 -  Set nMaxRow = i - 1
.head 6 -  ! Установка фокуса
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 6 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 -  ! Кнопки
.head 6 +  If bPossibleToEdit
.head 7 -  Call SalEnableWindow(pbDelLimit)
.head 7 -  Call SalEnableWindow(pbPosUp)
.head 7 -  Call SalEnableWindow(pbPosDown)
.head 7 -  ! Кнопки вверх-вниз
.head 7 +  If SalTblQueryContext(hWndForm) = 0
.head 8 -  Call SalDisableWindow(pbPosUp)
.head 7 +  If SalTblQueryContext(hWndForm) = nMaxRow
.head 8 -  Call SalDisableWindow(pbPosDown)
.head 7 +  If nMaxRow = 0
.head 8 -  Call SalDisableWindow(pbPosUp)
.head 8 -  Call SalDisableWindow(pbPosDown)
.head 7 -  ! Кнопка "Удалить"
.head 7 +  If colLimDeleted
.head 8 -  Call SalDisableWindow(pbDelLimit)
.head 5 -  ! Добавить лимит
.head 5 +  On UM_Insert
.head 6 +  If SalModalDialog(Dlg_AccNNLimitAdd, hWndMDI, TRUE, TRUE, nAcc, cLimit)
.head 7 +  If not addNewLimit(cLimit)
.head 8 -  Return FALSE
.head 7 -  Set nMaxRow = nMaxRow + 1
.head 5 -  ! Удалить лимит
.head 5 +  On UM_Delete
.head 6 -  Call hWndParent.Frm_Account.IsEdited()
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 +  If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 8 -  Call cLimitList.setLimitDeleteFlag(colLimId, SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 8 -  Call VisTblSetRowColor(hWndForm, nRow, IifN(SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted), COLOR_DarkRed, COLOR_Black))
.head 7 +  Else
.head 8 -  Call cLimitList.setLimitDeleteFlag(colLimId, TRUE)
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 8 -  Set nMaxRow = nMaxRow - 1
.head 5 -  ! Редактировать лимит
.head 5 +  On SAM_DoubleClick
.head 6 +  If colLimId
.head 7 -  Call sync(cLimitList.LimitList[lParam], cLimit)
.head 7 +  If SalModalDialog(Dlg_AccNNLimitAdd, hWndMDI, FALSE, IifN(bPossibleToEdit, TRUE, FALSE), nAcc, cLimit)
.head 8 -  Call hWndParent.Frm_Account.IsEdited()
.head 8 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 8 -  Call cLimitList.changeLimit(colListId, cLimit.sLimIsFix, cLimit.nLimFixAmnt, cLimit.nLimFixDays, 
     cLimit.nLimMinBal, cLimit.nLimMaxBal, cLimit.nLimPrcBal)
.head 8 -  Call SalTblSetFocusRow(hWndForm, lParam)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  : cLimitList
.head 4 -  Class: cNNLimitList
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccNNLimit')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccNNLimit.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(tblLimit, UM_Populate, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent.Frm_Account.cTabAccNNLimit.hWnd = hWndForm
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow(pbAddLimit)
.head 4 -  Call SalDisableWindow(pbDelLimit)
.head 4 -  Call SalDisableWindow(pbPosUp)
.head 4 -  Call SalDisableWindow(pbPosDown)
.head 4 -  ! Call SalSendMsg(tblLimit, SAM_DoInit, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_AccNNLimit.tblLimit,
     SalPixelsToFormUnits(hWndForm.Dlg_AccNNLimit.tblLimit, nWinWidth, FALSE)-0.2,
     SalPixelsToFormUnits(hWndForm.Dlg_AccNNLimit.tblLimit, nWinHeight, TRUE)-0.51)
.head 1 +  Dialog Box: Dlg_AccNNLimitAdd
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.55"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.75"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 16888
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.6"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbIsFix
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Признак фиксированной суммы лимита 
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  4.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call DisableOnFix()
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Фиксированная сумма
.head 4 -  Resource Id: 16893
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.7"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFixAmnt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFixAmnt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 22
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.65"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Период фикс. cуммы 
.head 4 -  Resource Id: 16894
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.0"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFixDays
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFixDays
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.95"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Неснижаемый остаток
.head 4 -  Resource Id: 16895
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.4"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMinBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMinBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 22
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.35"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Макс. cумма лимита
.head 4 -  Resource Id: 16890
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.7"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMaxBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMaxBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 22
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.65"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Background Text: Процент дост. Остатка
.head 4 -  Resource Id: 16891
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.0"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPrcBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPrcBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.95"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 -  Frame
.head 4 -  Resource Id: 16889
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    2.7"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.5"
.head 5 -  Top:    2.8"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set cLimit.sLimIsFix   = IifS(cbIsFix=TRUE, 'Y', 'N')
.head 6 -  Set cLimit.nLimFixAmnt = dfFixAmnt
.head 6 -  Set cLimit.nLimFixDays = dfFixDays
.head 6 -  Set cLimit.nLimMinBal  = dfMinBal
.head 6 -  Set cLimit.nLimMaxBal  = dfMaxBal
.head 6 -  Set cLimit.nLimPrcBal  = dfPrcBal
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.9"
.head 5 -  Top:    2.8"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 16896
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.55"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: DisableOnFix
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If cbIsFix
.head 6 -  Call SalEnableWindow(dfFixAmnt)
.head 6 -  Call SalEnableWindow(dfFixDays)
.head 6 -  Call SalDisableWindow(dfMinBal)
.head 6 -  Call SalDisableWindow(dfMaxBal)
.head 6 -  Call SalDisableWindow(dfPrcBal)
.head 6 -  Set dfMinBal = NUMBER_Null
.head 6 -  Set dfMaxBal = NUMBER_Null
.head 6 -  Set dfPrcBal = NUMBER_Null
.head 5 +  Else
.head 6 -  Call SalDisableWindow(dfFixAmnt)
.head 6 -  Call SalDisableWindow(dfFixDays)
.head 6 -  Call SalEnableWindow(dfMinBal)
.head 6 -  Call SalEnableWindow(dfMaxBal)
.head 6 -  Call SalEnableWindow(dfPrcBal)
.head 6 -  Set dfFixAmnt = NUMBER_Null
.head 6 -  Set dfFixDays = NUMBER_Null
.head 5 +  If sLIMINUSE
.head 6 +  If SalStrScan(sLIMINUSE, 'FIX') = -1
.head 7 -  Call SalDisableWindow(dfFixAmnt)
.head 7 +  If dfFixAmnt = NUMBER_Null and dfFixDays = NUMBER_Null 
.head 8 -  Call SalDisableWindow(cbIsFix)
.head 8 -  Call SalDisableWindow(dfFixDays)
.head 6 +  If SalStrScan(sLIMINUSE, 'MIN') = -1
.head 7 -  Call SalDisableWindow(dfMinBal)
.head 6 +  If SalStrScan(sLIMINUSE, 'MAX') = -1
.head 7 -  Call SalDisableWindow(dfMaxBal)
.head 6 +  If SalStrScan(sLIMINUSE, 'PRC') = -1
.head 7 -  Call SalDisableWindow(dfPrcBal)
.head 2 +  Window Parameters
.head 3 -  Boolean: bNew	! Новый лимит
.head 3 -  Boolean: bEdit	! 1-редактировать старый лимит, 0-просмотр
.head 3 -  Number: nAcc
.head 3 -  : cLimit
.head 4 -  Class: cNNLimit
.head 2 +  Window Variables
.head 3 -  String: sLIMINUSE
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Добавление/Изменение лимита
.head 4 -  Call SalSetWindowText(hWndForm, IifS(bNew, CurrentLangTable.GetAtomTitle('Dlg_AccNNLimitAdd.cTWndTitleAdd'),
     CurrentLangTable.GetAtomTitle('Dlg_AccNNLimitAdd.cTWndTitleChange')))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set sLIMINUSE = GetGlobalOption('LIMINUSE')
.head 4 +  If sLIMINUSE
.head 5 +  If SalStrScan(sLIMINUSE, 'FIX') = -1
.head 6 -  Call SalDisableWindow(dfFixAmnt)
.head 5 +  If SalStrScan(sLIMINUSE, 'MIN') = -1
.head 6 -  Call SalDisableWindow(dfMinBal)
.head 5 +  If SalStrScan(sLIMINUSE, 'MAX') = -1
.head 6 -  Call SalDisableWindow(dfMaxBal)
.head 5 +  If SalStrScan(sLIMINUSE, 'PRC') = -1
.head 6 -  Call SalDisableWindow(dfPrcBal)
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 +  If bNew
.head 5 -  Set cbIsFix = FALSE
.head 5 +  If SalStrScan(sLIMINUSE, 'FIX') = -1
.head 6 -  Call SalDisableWindow(cbIsFix)
.head 6 -  Call SalDisableWindow(dfFixAmnt)
.head 6 -  Call SalDisableWindow(dfFixDays)
.head 4 +  Else
.head 5 -  Set cbIsFix   = IifN(cLimit.sLimIsFix='Y', 1, 0)
.head 5 -  Set dfFixAmnt = cLimit.nLimFixAmnt
.head 5 -  Set dfFixDays = cLimit.nLimFixDays
.head 5 -  Set dfMinBal  = cLimit.nLimMinBal
.head 5 -  Set dfMaxBal  = cLimit.nLimMaxBal
.head 5 -  Set dfPrcBal  = cLimit.nLimPrcBal
.head 5 +  If SalStrScan(sLIMINUSE, 'FIX') = -1
and dfFixAmnt = NUMBER_Null and dfFixDays = NUMBER_Null 
.head 6 -  Call SalDisableWindow(cbIsFix)
.head 6 -  Call SalDisableWindow(dfFixAmnt)
.head 6 -  Call SalDisableWindow(dfFixDays)
.head 4 +  If bEdit
.head 5 -  Call DisableOnFix()
.head 4 +  Else
.head 5 -  Call SalDisableWindow(cbIsFix)
.head 5 -  Call SalDisableWindow(dfFixAmnt)
.head 5 -  Call SalDisableWindow(dfFixDays)
.head 5 -  Call SalDisableWindow(dfMinBal)
.head 5 -  Call SalDisableWindow(dfMaxBal)
.head 5 -  Call SalDisableWindow(dfPrcBal)
.head 1 +  Dialog Box: dlgAccListOptions
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры просмотра
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.7"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.1"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.1"
.head 5 -  Width:  6.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.9"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Check Box: cbFinancial
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать финансовые атрибуты
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.2"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 6 +  If not cbFinancial
.head 7 -  Set cbOstDK  = FALSE
.head 7 -  Set cbSumEqv = FALSE
.head 3 +  Check Box: cbOstDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать остатки двумя колонками (Д/К)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.5"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 6 +  If cbOstDK
.head 7 -  Set cbFinancial = TRUE
.head 3 +  Check Box: cbSumEqv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать эквиваленты
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.8"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 6 +  If cbSumEqv
.head 7 -  Set cbFinancial = TRUE
.head 3 +  Check Box: cbInterests
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать %% ставки
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.1"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 3 +  Check Box: cbLimits
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать информацию о лимитах
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.4"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 3 +  Check Box: cbSpecial
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать спецпараметры счетов
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.7"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 3 +  Check Box: cbLinks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать связанные счета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.0"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 3 +  Check Box: cbBlock
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показыфвать информацию по блокировкам счетов
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.3"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 3 +  Check Box: cbClosed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать закрытые счета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.6"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(pbOk)
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.05"
.head 5 -  Width:  6.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   3.7"
.head 5 -  Top:    3.15"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set cTblOptions.bFinance   = cbFinancial
.head 6 -  Set cTblOptions.bOstDK     = cbOstDK
.head 6 -  Set cTblOptions.bSumEqv    = cbSumEqv
.head 6 -  Set cTblOptions.bInterests = cbInterests
.head 6 -  Set cTblOptions.bLimits    = cbLimits
.head 6 -  Set cTblOptions.bSpecial   = cbSpecial
.head 6 -  Set cTblOptions.bLinkAcc   = cbLinks
.head 6 -  Set cTblOptions.bBlocked   = cbBlock
.head 6 -  Set cTblOptions.bClosed    = cbClosed
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.0"
.head 5 -  Top:    3.15"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nCtrlFlags
.head 3 -  : cTblOptions
.head 4 -  Class: cAccListOptions
.head 3 -  Boolean: fCloseAcc
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgAccListOptions.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalDisableWindow(cbFinancial)
.head 4 -  Call SalDisableWindow(cbOstDK)
.head 4 -  Call SalDisableWindow(cbSumEqv)
.head 4 -  Call SalDisableWindow(cbInterests)
.head 4 -  Call SalDisableWindow(cbLimits)
.head 4 -  Call SalDisableWindow(cbSpecial)
.head 4 -  Call SalDisableWindow(cbLinks)
.head 4 -  Call SalDisableWindow(cbBlock)
.head 4 -  Call SalDisableWindow(cbClosed)
.head 4 -  Set cbFinancial = FALSE
.head 4 -  Set cbOstDK     = FALSE
.head 4 -  Set cbSumEqv    = FALSE
.head 4 -  Set cbInterests = FALSE
.head 4 -  Set cbLimits    = FALSE
.head 4 -  Set cbSpecial   = FALSE
.head 4 -  Set cbLinks     = FALSE
.head 4 -  Set cbBlock     = FALSE
.head 4 -  Set cbClosed    = FALSE
.head 4 +  If nCtrlFlags & AVIEW_Financial
.head 5 -  Set cbFinancial = cTblOptions.bFinance
.head 5 -  Set cbOstDK     = cTblOptions.bOstDK
.head 5 -  Set cbSumEqv    = cTblOptions.bSumEqv
.head 5 -  Call SalEnableWindow(cbFinancial)
.head 5 -  Call SalEnableWindow(cbOstDK)
.head 5 -  Call SalEnableWindow(cbSumEqv)
.head 4 +  If nCtrlFlags & AVIEW_Interest OR nCtrlFlags & AVIEW_Special
.head 5 -  Set cbInterests = cTblOptions.bInterests
.head 5 -  Call SalEnableWindow(cbInterests)
.head 4 +  If nCtrlFlags & AVIEW_Limit
.head 5 -  Set cbLimits = cTblOptions.bLimits
.head 5 -  Call SalEnableWindow(cbLimits)
.head 4 +  If nCtrlFlags & AVIEW_Special
.head 5 -  Set cbSpecial = cTblOptions.bSpecial
.head 5 -  Call SalEnableWindow(cbSpecial)
.head 4 +  If nCtrlFlags & AVIEW_Linked
.head 5 -  Set cbLinks = cTblOptions.bLinkAcc
.head 5 -  Call SalEnableWindow(cbLinks)
.head 4 +  If nCtrlFlags & AVIEW_Blocked
.head 5 -  Set cbBlock = cTblOptions.bBlocked
.head 5 -  Call SalEnableWindow(cbBlock)
.head 4 +  If not (nCtrlFlags & AVIEW_ExistOnly AND NOT fCloseAcc)
.head 5 -  Set cbClosed = cTblOptions.bClosed
.head 5 -  Call SalEnableWindow(cbClosed)
.head 4 -  Call SalDisableWindow(pbOk)
.head 4 -  Call SalSetFocus(pbCancel)
.head 1 +  Form Window: frmRelations
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр связей клиентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  15.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.0"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.4"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  Background Text: РНК
.head 5 -  Resource Id: 43474
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.15"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfRnk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.1"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_KeyDown
.head 7 +  Select Case wParam
.head 8 +  Case VK_Enter
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 +  Default
.head 9 -  Break
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Обновить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmRelTree.cBTipRefresh')
.head 7 -  Set strTip = 'Обновить'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(cRel, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.033"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Фильтр
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmRelTree.cBTipFilter')
.head 7 -  Set strTip = 'Фильтр'
.head 6 -  On SAM_Click
.head 4 -  Line
.head 5 -  Resource Id: 43472
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.567"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  3.567"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbExpand
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Раскрыть дерево
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frmRelTree.cBTipExpand')
.head 7 -  Set strTip = 'Раскрыть дерево'
.head 6 +  ! On SAM_Click
.head 7 -  Set i = 0
.head 7 +  While i <= nListNum
.head 8 -  Set nFlags = VisListGetFlags(cRel, i)
.head 8 +  If (nFlags & ITEM_IsParent) and Not (nFlags & ITEM_IsExpanded)
.head 9 -  Call cRel.Expand(i)
.head 8 -  Set i = i + 1
.head 6 +  On SAM_Click
.head 7 -  Set sCurrRel = smRel[nCurrRelId]
.head 7 -  Set i = 0
.head 7 +  While i <= nRelNum
.head 8 +  If Subs(smRel[i],1,Len(sCurrRel)) = sCurrRel
.head 9 -  Set nListCurrFlag = VisListGetFlags(cRel, i)
.head 9 +  If (nListCurrFlag & ITEM_IsParent) and Not (nListCurrFlag & ITEM_IsExpanded)
.head 10 -  Call cRel.Expand(i)
.head 8 -  Set i = i + 1
.head 4 -  Line
.head 5 -  Resource Id: 43473
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.2"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  4.2"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Custom Control: cMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cHSpl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cHSpl2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  List Box: cRel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cOutlineListBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Default
.head 5 -  Top:    Default
.head 5 -  Width:  11.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 7.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cRel.SetStyle(LBS_ShowHorzScrollBar | LBS_ShowSelectTextPicture | LBS_VisExtensions | LBS_Explorer | LBS_FmtMixedcase )
.head 6 -  ! Call SalSendMsg(hWndItem, UM_Populate, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call populateRel()
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set nCurrRelId = nValue
.head 6 -  Set nCurrRelRnk = nmRel[nCurrRelId]
.head 6 -  Call SalSetWindowText(cHSpl1, "Связанные лица " || sText || ";Типы связанностей" )
.head 6 -  Call SalSendMsg(tblRelPersons, UM_Populate, 0, 0)
.head 5 +  On VTM_OutlineCornerClick
.head 6 -  Set nListCurrFlag = cRel.GetItemFlags(cRel.GetItemHandle(wParam))
.head 6 +  If (nListCurrFlag & ITEM_IsParent)
.head 7 +  If (nListCurrFlag & ITEM_IsExpanded)
.head 8 -  Call cRel.Collapse(wParam)
.head 7 +  Else
.head 8 -  Call cRel.Expand(wParam)
.head 5 +  On VTM_KeyDown
.head 6 -  Set nListCurrFlag = cRel.GetItemFlags(cRel.GetItemHandle(VisListGetFocusIndex(hWndItem)))
.head 6 +  Select Case wParam
.head 7 +  Case VK_Left
.head 8 +  If nListCurrFlag & ITEM_CanCollapse
.head 9 -  Call cRel.Collapse(VisListGetFocusIndex(hWndItem))
.head 8 -  Break
.head 7 +  Case VK_Right
.head 8 +  If nListCurrFlag & ITEM_CanExpand
.head 9 -  Call cRel.Expand(VisListGetFocusIndex(hWndItem))
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SalSendClassMessage(VTM_KeyDown, wParam, lParam)
.head 8 -  Break
.head 5 +  On SAM_Destroy
.head 6 -  Call cRel.FreeDescendents(hItemRoot)
.head 5 +  On SAM_DragDrop
.head 6 -  Return FALSE
.head 3 +  Child Table: tblRelPersons
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.25"
.head 6 -  Top:    0.155"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.345"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colRelRnk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: РНК
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRelIntExt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование/ФИО
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCType
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(),
"select unique rel_rnk, rel_intext, name, decode(custtype,3,'ФЛ','ЮЛ')
   into :colRelRnk, :colRelIntExt, :colName, :colCType
   from v_customer_rel 
  where rnk=:nCurrRelRnk
  order by name, rel_rnk", TBL_FillAll)
.head 6 -  Call SalSetFocus(hWndForm)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 5 +  On SAM_RowSetContext
.head 6 -  Set nCurrRelChild = colRelRnk
.head 6 -  Call SalSetWindowText(cHSpl1, "Связанные лица " || cRel.sText || ";Типы связанностей " || colName)
.head 6 -  Call SalSendMsg(tblRelations, UM_Populate, 0, 0)
.head 3 +  Child Table: tblRelations
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.233"
.head 6 -  Top:    2.226"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.357"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ид.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип связанности
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SuppressLastColLine, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(),
"select v.rel_id, r.relatedness
   into :colId, :colName
   from v_customer_rel v, cust_rel r
  where v.rel_id = r.id
    and v.rnk = :nCurrRelRnk
    and v.rel_rnk = :nCurrRelChild", TBL_FillAll)
.head 2 +  Functions
.head 3 +  Function: initColor
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nmColor[0] = COLOR_Blue
.head 5 -  Set nmColor[1] = COLOR_Marigold
.head 5 -  Set nmColor[2] = COLOR_DarkGreen
.head 5 -  Set nmColor[3] = COLOR_Periwinkle
.head 5 -  Set nmColor[4] = COLOR_Magenta
.head 5 -  Set nmColor[5] = COLOR_Teal
.head 5 -  Set nmColor[6] = COLOR_Salmon
.head 5 -  Set nmColor[7] = COLOR_DarkRed
.head 5 -  Set nmColor[8] = COLOR_Green
.head 5 -  Set nmColor[9] = COLOR_Red
.head 5 -  Set nColorNum = 10
.head 5 -  Return TRUE
.head 3 +  Function: SetRel
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nIndex
.head 5 -  Number: nRelRnk
.head 5 -  String: sRel
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nmRel[nIndex] = nRelRnk
.head 5 -  Set smRel[nIndex] = sRel || '/'
.head 5 -  Return TRUE
.head 3 +  Function: populateRel
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIterator
.head 5 -  Number: hItemLevel0
.head 5 -  !
.head 5 -  Number: nRnk
.head 5 -  String: sNmk
.head 5 -  Number: nCType
.head 5 -  Number: nRel
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call cRel.FreeDescendents(hItemRoot)
.head 5 -  Set hItemRoot = cRel.GetRoot()
.head 5 +  If hItemRoot
.head 6 -  Set nRelNum = 0
.head 6 -  Set nIterator = 0
.head 6 -  ! 1-й уровень
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"select rnk, nmk, custtype into :nRnk, :sNmk, :nCType
   from ( select rnk, nmk, custtype from customer
          union all
          select id, name, 3 from customer_extern )
  where rnk = :dfRnk")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set hItemLevel0 = cRel.LoadChild(hItemRoot, hPicLevel0, hPicLevel0, 
    IifS(nCType=3, "ФЛ ", "ЮЛ ") || sNmk || ' / ' || Str(nRnk), nIterator, 0)
.head 7 -  Call SetRel(nIterator, nRnk, Str(nRnk))
.head 7 -  Set nIterator = nIterator + 1
.head 7 +  If hItemLevel0
.head 8 +  If SqlPLSQLCommand(hSql(), "p_cust_rel(nRnk,10)")
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Set i = 0
.head 9 -  Call SqlPrepareAndExecute(hSql(), 
"select rel_rnk into :nRel from (select rel_rnk, count(*) from tmp_cust_rel group by rel_rnk having count(*) > 1)")
.head 9 +  While SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set nmRelDubl[i] = nRel
.head 10 -  Set i = i + 1
.head 9 -  Set nRelDublNum = i
.head 9 -  Call populateRel2(nRnk, Str(nRnk), 1, hItemLevel0, nIterator)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 7 -  Call SalSetWindowText(hWndForm, 'Просмотр связей клиента ' || Str(nRnk) || ' ' || sNmk)
.head 7 -  !
.head 7 -  Call cRel.ShowOutline(1)
.head 7 -  Call VisListSetFocusIndex(cRel, 0)
.head 7 -  Call SalSendMsg(cRel, SAM_Click, 0, 0)
.head 6 -  ! Красим дубли
.head 6 -  Set i = nRelNum
.head 6 +  While i <= nRelNum
.head 7 -  Set j = 0
.head 7 +  While j <= nRelDublNum
.head 8 +  If cRel.GetItemValue(cRel.GetItemHandle(i)) = nmRelDubl[j]
.head 9 -  Call cRel.SetItemColor(cRel.GetItemHandle(i), IifN(j<nColorNum, nmColor[j], nColorNum))
.head 9 -  Break
.head 8 -  Set j = j + 1
.head 7 -  Set i = i + 1
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: populateRel2
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  String: sRel
.head 5 -  Number: nLevel
.head 5 -  Number: hParentLevel
.head 5 -  Receive Number: nIterator
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  : cCnc
.head 6 -  Class: cABSConnect
.head 5 -  String: sPopulate
.head 5 -  Number: hItemLevel1
.head 5 -  Number: nZnak
.head 5 -  Number: nRelRnk
.head 5 -  String: sRelNmk
.head 5 -  Number: nCType
.head 5 -  Number: hPic
.head 4 +  Actions
.head 5 -  Call XConnectGetParams(cCnc)
.head 5 +  If NOT cCnc.Connect()
.head 6 -  Return FALSE
.head 5 -  Call SqlPrepareAndExecute(cCnc.hSql(), 
"select t.znak, t.rel_rnk, c.nmk, c.custtype
   into :nZnak, :nRelRnk, :sRelNmk, :nCType
   from tmp_cust_rel t, (select rnk, nmk, 1 intext, custtype from customer union all select id, name, 0, 3 from customer_extern) c
  where t.rel_rnk = c.rnk
    and npp = :nLevel and t.id_parent=:nRnk and t.rel_intext = c.intext
  order by t.ncp, t.znak desc, c.nmk")
.head 5 +  While SqlFetchNext(cCnc.hSql(), nFetchRes)
.head 6 -  Set hPic = IifN(nZnak=1,hPicLevel2,hPicLevel1)
.head 6 -  Set hItemLevel1 = cRel.LoadChild(hParentLevel, hPic, hPic, 
    IifS(nCType=3, "ФЛ ", "ЮЛ ") || sRelNmk || ' / ' || Str(nRelRnk), nIterator, 0)
.head 6 -  Set j = 0
.head 6 +  While j <= nRelDublNum
.head 7 +  If nmRelDubl[j] = nRelRnk
.head 8 -  Call cRel.SetItemColor(hItemLevel1, IifN(j<nColorNum, nmColor[j], nColorNum))
.head 8 -  Break
.head 7 -  Set j = j + 1
.head 6 -  Call SetRel(nIterator, nRelRnk, sRel || '/' || Str(nRelRnk))
.head 6 -  Set nIterator = nIterator + 1
.head 6 -  Call populateRel2(nRelRnk, sRel || '/' || Str(nRelRnk), nLevel+1, hItemLevel1, nIterator)
.head 5 -  Set nRelNum = nIterator
.head 5 -  Call cCnc.Disconnect()
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  Number: hItemRoot
.head 3 -  Number: hPicLevel0
.head 3 -  Number: hPicLevel1
.head 3 -  Number: hPicLevel2
.head 3 -  !
.head 3 -  Number: hCurrentRel
.head 3 -  Number: nCurrentRel
.head 3 -  String: sCurrentRel
.head 3 -  !
.head 3 -  Number: i
.head 3 -  Number: nRelNum
.head 3 -  Number: nmRel[*]
.head 3 -  String: smRel[*]
.head 3 -  Number: nCurrRelRnk
.head 3 -  Number: nCurrRelId
.head 3 -  String: sCurrRel
.head 3 -  Number: nCurrRelChild
.head 3 -  Number: nListCurrFlag
.head 3 -  !
.head 3 -  Number: j
.head 3 -  Number: nRelDublNum
.head 3 -  Number: nmRelDubl[*]
.head 3 -  !
.head 3 -  Number: n
.head 3 -  Number: nColorNum
.head 3 -  Number: nmColor[*]
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Редактирование иерархии подразделений
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Просмотр связей клиентов')
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  !
.head 4 +  If nPar
.head 5 -  Set dfRnk = nPar
.head 5 -  Call SalDisableWindow(dfRnk)
.head 5 -  Call SalDisableWindow(pbFilter)
.head 4 -  ! Call cHSpl.setStyle(XSalSplitter_NotResizable, TRUE)
.head 4 -  Call cMain.setBarSize(5)
.head 4 -  Call cMain.setBarPosition(500)
.head 4 -  Call cMain.setLeftFrame(cRel)
.head 4 -  Call cMain.setRightFrame(cHSpl1)
.head 4 -  !
.head 4 -  Call cHSpl1.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
.head 4 -  Call cHSpl1.setBarSize(5)
.head 4 -  Call cHSpl1.setBarPosition(300)
.head 4 -  Call cHSpl1.setTopFrame(tblRelPersons)
.head 4 -  Call cHSpl1.setBottomFrame(cHSpl2)
.head 4 -  Call SalSetWindowText(cHSpl1, "Связанные лица;Типы связанностей" )
.head 4 -  !
.head 4 -  Call cHSpl2.setStyle(XSalSplitter_NotResizable, TRUE)
.head 4 -  Call cHSpl2.setBarPosition(400)
.head 4 -  Call cHSpl2.setTopFrame(tblRelations)
.head 4 -  !
.head 4 -  Set hPicLevel0 = VisPicLoad(PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'PIC_Level0', '' )
.head 4 -  Set hPicLevel1 = VisPicLoad(PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'PIC_Level1', '' )
.head 4 -  Set hPicLevel2 = VisPicLoad(PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'PIC_Level2', '' )
.head 4 -  !
.head 4 -  Call initColor()
.head 4 +  If nPar
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Else
.head 5 -  Call SalSetFocus(dfRnk)
.head 3 +  On SAM_Destroy
.head 4 -  Call VisPicFree(hPicLevel0)
.head 4 -  Call VisPicFree(hPicLevel1)
.head 4 -  Call VisPicFree(hPicLevel2)
.head 1 +  Dialog Box: DlgSWReceiver
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.85"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 10154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.05"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Банк
.head 4 -  Resource Id: 10155
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.15"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBank
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBank
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    0.15"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет
.head 4 -  Resource Id: 10156
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.45"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    0.45"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 10138
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.8"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.95"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Банк-посредник
.head 4 -  Resource Id: 10139
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.75"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Название
.head 4 -  Resource Id: 10140
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.05"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW56_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    1.0"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес
.head 4 -  Resource Id: 10141
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.35"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW56_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    1.3"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: SWIFT-код
.head 4 -  Resource Id: 10142
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.65"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56_Code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW56_Code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    1.6"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 10143
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.0"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.55"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Банк-Бенефициар
.head 4 -  Resource Id: 10144
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.95"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Название
.head 4 -  Resource Id: 10145
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.25"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    2.2"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес
.head 4 -  Resource Id: 10148
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.55"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    2.5"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: SWIFT-код
.head 4 -  Resource Id: 10147
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.85"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    2.8"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет в банке-посреднике
.head 4 -  Resource Id: 10146
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.15"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    3.1"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Бенефициар
.head 4 -  Resource Id: 10149
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.45"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Название
.head 4 -  Resource Id: 10150
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.75"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW59_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    3.7"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес
.head 4 -  Resource Id: 10152
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.05"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW59_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    4.0"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет
.head 4 -  Resource Id: 3005
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.35"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW59_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    4.3"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 3006
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    4.8"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    4.9"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sSW56_Name = dfSW56_Name
.head 6 -  Set sSW56_Adr  = dfSW56_Adr
.head 6 -  Set sSW56_Code = dfSW56_Code
.head 6 -  Set sSW57_Name = dfSW57_Name
.head 6 -  Set sSW57_Adr  = dfSW57_Adr
.head 6 -  Set sSW57_Code = dfSW57_Code
.head 6 -  Set sSW57_Acc  = dfSW57_Acc
.head 6 -  Set sSW59_Name = dfSW59_Name
.head 6 -  Set sSW59_Adr  = dfSW59_Adr
.head 6 -  Set sSW59_Acc  = dfSW59_Acc
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.45"
.head 5 -  Top:    4.9"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  String: sMfo
.head 3 -  String: sNb
.head 3 -  String: sNls
.head 3 -  String: sKv
.head 3 -  Receive String: sSW56_Name
.head 3 -  Receive String: sSW56_Adr
.head 3 -  Receive String: sSW56_Code
.head 3 -  Receive String: sSW57_Name
.head 3 -  Receive String: sSW57_Adr
.head 3 -  Receive String: sSW57_Code
.head 3 -  Receive String: sSW57_Acc
.head 3 -  Receive String: sSW59_Name
.head 3 -  Receive String: sSW59_Adr
.head 3 -  Receive String: sSW59_Acc
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DlgSWReceiver.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalDisableWindow(dfSW56_Name)
.head 5 -  Call SalDisableWindow(dfSW56_Adr)
.head 5 -  Call SalDisableWindow(dfSW56_Code)
.head 5 -  Call SalDisableWindow(dfSW57_Name)
.head 5 -  Call SalDisableWindow(dfSW57_Adr)
.head 5 -  Call SalDisableWindow(dfSW57_Code)
.head 5 -  Call SalDisableWindow(dfSW57_Acc)
.head 5 -  Call SalDisableWindow(dfSW59_Name)
.head 5 -  Call SalDisableWindow(dfSW59_Adr)
.head 5 -  Call SalDisableWindow(dfSW59_Acc)
.head 5 -  Call SalDisableWindow(pbSave)
.head 4 -  Set dfBank = sMfo || ' ' || sNb
.head 4 -  Set dfAcc  = sNls || ' ' || sKv
.head 4 -  Set dfSW56_Name = sSW56_Name
.head 4 -  Set dfSW56_Adr  = sSW56_Adr
.head 4 -  Set dfSW56_Code = sSW56_Code
.head 4 -  Set dfSW57_Name = sSW57_Name
.head 4 -  Set dfSW57_Adr  = sSW57_Adr
.head 4 -  Set dfSW57_Code = sSW57_Code
.head 4 -  Set dfSW57_Acc  = sSW57_Acc
.head 4 -  Set dfSW59_Name = sSW59_Name
.head 4 -  Set dfSW59_Adr  = sSW59_Adr
.head 4 -  Set dfSW59_Acc  = sSW59_Acc
.head 1 +  Dialog Box: dlgFindNls
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Поиск счета
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  2.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 0.65"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.35"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Default
.head 5 -  Top:    Default
.head 5 -  Width:  Default
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull(dfNls)
.head 7 -  Call SalEndDialog(hWndForm, FALSE)
.head 6 +  Else
.head 7 -  Set sNls = dfNls
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Default
.head 5 -  Top:    Default
.head 5 -  Width:  Default
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sNls
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgFindNls.cTWndTitle'))
.head 4 -  Call SalSetFocus(dfNls)
.head 1 +  Dialog Box: Dlg_AccAcrn
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.25"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.619"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Custom Control: cSpl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Frm_Account.IsEdited()
.head 3 +  Function: getAcrnAccn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Receive Number: nMetr
.head 5 -  Receive Number: nBaseM
.head 5 -  Receive Number: nBaseY
.head 5 -  Receive Number: nFreq
.head 5 -  Receive Date/Time: dStpDat
.head 5 -  Receive Date/Time: dAcrDat
.head 5 -  Receive Date/Time: dAplDat
.head 5 -  Receive String: sTt
.head 5 -  Receive Number: nAcrA
.head 5 -  Receive Number: nAcrB
.head 5 -  Receive String: sTtB
.head 5 -  Receive Number: nKvB
.head 5 -  Receive String: sNlsB
.head 5 -  Receive String: sNamB
.head 5 -  Receive String: sMfo
.head 5 -  Receive String: sOkpo
.head 5 -  Receive String: sNazn
.head 5 -  Receive Number: nIo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 3 +  Function: setAcrnAccn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nMetr
.head 5 -  Number: nBaseM
.head 5 -  Number: nBaseY
.head 5 -  Number: nFreq
.head 5 -  Date/Time: dStpDat
.head 5 -  Date/Time: dAcrDat
.head 5 -  Date/Time: dAplDat
.head 5 -  String: sTt
.head 5 -  Number: nAcrA
.head 5 -  Number: nAcrB
.head 5 -  String: sTtB
.head 5 -  Number: nKvB
.head 5 -  String: sNlsB
.head 5 -  String: sNamB
.head 5 -  String: sMfo
.head 5 -  String: sOkpo
.head 5 -  String: sNazn
.head 5 -  Number: nIo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Frm_Account.cAccount.setAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 3 +  Function: getAcrnParNumRatn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.Frm_Account.cAccount.getAcrnParNumRatn(nId)
.head 3 +  Function: getAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 5 -  Receive Date/Time: dBDat
.head 5 -  Receive Number: nIr
.head 5 -  Receive Number: nBr
.head 5 -  Receive Number: nOp
.head 5 -  Receive Boolean: bIns
.head 5 -  Receive Boolean: bUpd
.head 5 -  Receive Boolean: bDel
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Frm_Account.cAccount.getAcrnRatn(nId, nRatnIndex, dBDat, nIr, nBr, nOp, bIns, bUpd, bDel)
.head 3 +  Function: addAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Date/Time: dBDat
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 5 -  Receive Number: nRatnIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Frm_Account.cAccount.addAcrnRatn(nId, dBDat, nIr, nBr, nOp, nRatnIndex)
.head 3 +  Function: setAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 5 -  ! Date/Time: dBDat
.head 5 -  Date/Time: dBDatNew
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call hWndParent.Frm_Account.cAccount.setAcrnRatn(nId, dBDat, dBDatNew, nIr, nBr, nOp)
.head 5 -  Call hWndParent.Frm_Account.cAccount.setAcrnRatn(nId, nRatnIndex, dBDatNew, nIr, nBr, nOp)
.head 3 +  Function: dropAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call hWndParent.Frm_Account.cAccount.dropAcrnRatn(nId, nRatnIndex)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAcc
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[2]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  !
.head 3 -  Window Handle: hWndAcrn
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('AccProc')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set nAcc       = SalStrToNumber(InParam[0])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[1]))
.head 4 -  !
.head 4 -  Set nFlagEdit       = hWndParent.Frm_Account.cTabAccAcrn.EditMode
.head 4 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 4 +  If not bPossibleToEdit
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  If nAcc = 0
.head 4 -  Else
.head 4 -  !
.head 4 +  If not hWndParent.Frm_Account.cTabAccAcrn.hWnd
.head 5 -  Call cSpl.setBarSize(5)
.head 5 -  Set hWndAcrn = SalCreateWindowEx(frm_ProcAccounts, hWndForm, 0,0,0,0, CREATE_AsChild,
nAcc, IifN(bPossibleToEdit=TRUE,ACCESS_FULL,ACCESS_READONLY), '', '', '', '', 'FRM', hWndForm)
.head 5 -  Call cSpl.setTopFrame(hWndAcrn)
.head 5 -  Call cSpl.setBarPosition(1000)
.head 5 -  !
.head 5 -  Set hWndParent.Frm_Account.cTabAccAcrn.hWnd = hWndForm
.head 4 +  Else
.head 5 -  Call SalSendMsg(hWndAcrn, UM_Populate, 0, 0)
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка
.head 4 -  Return SalSendMsg(hWndAcrn, UM_BeforeClose, 0, 0)
.head 4 +  ! If cbSPOpt
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tblSP, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(tblSP, nRow)
.head 6 +  If tblSP.colOpt = '1' AND tblSP.colZsp = ''
.head 7 -  ! Не заполнен реквизит <tblSP.colSem>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrRekv') || ' <' || tblSP.colSem || '>', 
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 7 -  Set nRowErr = nRow
.head 7 -  Return 2
.head 3 +  On UM_Update
.head 4 -  Call SalSendMsg(hWndAcrn, UM_Update, 0, 0)
.head 1 +  Form Window: frm_ProcAccounts
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.5"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Line
.head 4 -  Resource Id: 16805
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.05"
.head 5 -  End X:  9.967"
.head 5 -  End Y:  0.05"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Тип % картки
.head 4 -  Resource Id: 16832
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    0.18"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgGroups
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbGroups
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    0.13"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.964"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(hWndForm, UM_Update, 0, 0)
.head 6 -  !
.head 6 -  Set nId = cmbGroups.GetKey(SalListQuerySelection(hWndItem))
.head 6 +  If (nId = 2 or nId = 3) and nAccess != ACCESS_READONLY
.head 7 -  Call SalEnableWindow(pb_Copy)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pb_Copy)
.head 6 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  Pushbutton: pb_Copy
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.45"
.head 5 -  Top:    0.1"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Copy.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Перенести параметры из основной карточки
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cBTipCopy')
.head 5 +  On SAM_Click
.head 6 -  Call getAcrnAccnParam(nId-2, nMetr, nBaseM, nBaseY, nFreq, dfStpDat, dfAcrDat, dfAplDat, 
     dfTT1, nAcrA, dfNlsA, dfKvA, nAcrB, dfNlsB, dfKvB, dfTT2, dfKvC, dfNlsC, dfNamC, dfMFO, dfOkpo, dfNazn, nIo)
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 16804
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.45"
.head 5 -  End X:  10.0"
.head 5 -  End Y:  0.45"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Дати
.head 4 -  Resource Id: 16806
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.4"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDaty
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Нарахування
.head 4 -  Resource Id: 16807
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.6"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNachisleni
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAcrDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    0.55"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Виплати
.head 4 -  Resource Id: 16808
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.87"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVyplaty
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAplDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    0.82"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Закінчення
.head 4 -  Resource Id: 16809
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.14"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPrekrasch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfStpDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    1.09"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Параметри нарахування
.head 4 -  Resource Id: 16810
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    0.4"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAcrnParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Метод нарахування
.head 4 -  Resource Id: 16811
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    0.6"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMetodN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbMetr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    0.55"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.274"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbMetr.Init(hWndItem)
.head 7 -  Call cmbMetr.Populate(hSql(), 'metr', 'name', 'int_metr', 'order by metr')
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set nMetr = cmbMetr.nCurrentId
.head 3 -  Background Text: Базовий рік
.head 4 -  Resource Id: 16812
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    0.87"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBaseGN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbBaseY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    0.82"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.964"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbBaseY.Init(hWndItem)
.head 7 -  Call cmbBaseY.Populate(hSql(), 'basey', 'name', 'basey', 'ORDER by basey')
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set nBaseY = cmbBaseY.nCurrentId
.head 6 +  If nBaseY = 2
.head 7 -  Set nBaseM = 1
.head 6 +  Else
.head 7 -  Set nBaseM = 0
.head 3 -  ! Background Text: Періодичність
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.798"
.head 5 -  Width:  3.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgPeriodN
.head 4 -    Message Actions
.head 3 +  Combo Box: cmbFreq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.75"
.head 5 -  Top:    0.75"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.274"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbFreq.Init( hWndItem )
.head 7 -  Call cmbFreq.Populate( hSql(), 'freq', 'name', 'freq', 'ORDER by freq' )
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set nFreq=cmbFreq.nCurrentId
.head 3 -  Background Text: Залишок
.head 4 -  Resource Id: 16813
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    1.14"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOstatN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbOstat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    1.09"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbOstat.Init(hWndItem)
.head 7 -  Call cmbOstat.Populate(hSql(), 'io', 'name', 'int_ion', 'ORDER by io')
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set nIo = cmbOstat.nCurrentId
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 16814
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  1.46"
.head 5 -  End X:  10.0"
.head 5 -  End Y:  1.46"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Операція нарахування %%
.head 4 -  Resource Id: 16815
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.41"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNachN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Тип
.head 4 -  Resource Id: 16816
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.61"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    1.81"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfTT1)
.head 7 -  Set dfTT1 = sPTt
.head 7 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Вал
.head 4 -  Resource Id: 16817
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.0"
.head 5 -  Top:    2.28"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgValN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    1.81"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfKvA)
.head 7 -  Set dfKvA = nKv
.head 7 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Рах нар %%
.head 4 -  Resource Id: 16818
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.9"
.head 5 -  Top:    1.61"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNlsN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA !! Счет А (нач%)
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    1.81"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfNlsA)
.head 7 -  Set dfKvA = NUMBER_Null
.head 7 -  Set nAcrA = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNlsA = KeyAccount(GetBankMfo(), dfNlsA)
.head 6 +  If IfAccExists(STRING_Null, dfNlsA, dfKvA, nAcrA)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_OkClearFlag
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfKvA)
.head 7 -  Set dfKvA = nKv
.head 7 -  Call setEdited()
.head 6 +  If sNlsSN0 = STRING_Null and nId < 2
.head 7 +  If SalIsNull(dfNlsA) and sPNbsn != ''
.head 8 -  Set dfNlsA = KeyAccount(GetBankMfo(), sPNbsn || '0' || Subs(sNls,6,9) )
.head 8 -  Call setEdited()
.head 6 +  Else
.head 7 -  Set dfNlsA = IifS (nId < 2, sNlsSN0 , sNlsSN2)
.head 7 -  Call setEdited()
.head 3 -  Background Text: Вал
.head 4 -  Resource Id: 16819
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    1.61"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgValN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.3"
.head 6 -  Top:    1.81"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfKvB)
.head 7 +  If Subs(dfNlsA,1,1) != '8'
.head 8 -  Set dfKvB = GetBaseVal()
.head 7 +  Else
.head 8 -  Set dfKvB = dfKvA
.head 7 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: КонтрРахунок
.head 4 -  Resource Id: 16820
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.2"
.head 5 -  Top:    1.61"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNlsN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB !! Счет Б (дох-расх)
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.2"
.head 6 -  Top:    1.81"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfNlsB)
.head 7 -  Set dfKvB = NUMBER_Null
.head 7 -  Set nAcrB = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNlsB = KeyAccount(GetBankMfo(), dfNlsB)
.head 6 +  If IfAccExists(STRING_Null, dfNlsB, dfKvB, nAcrB)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_OkClearFlag
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfKvB)
.head 7 +  If Subs(dfNlsA,1,1) != '8'
.head 8 -  Set dfKvB = GetBaseVal()
.head 7 +  Else
.head 8 -  Set dfKvB = dfKvA
.head 7 -  Call setEdited()
.head 6 +  If SalIsNull(dfNlsB)
.head 7 +  If sNlsSD0 = STRING_Null and nId < 2
.head 8 -  ! Переезжаем в функцию F_PROC_DR
.head 8 +  If SqlPrepareAndExecute(hSqlAux2(),
 "SELECT f_proc_dr(:frm_ProcAccounts.nAcc, 4, 0, '' ) INTO :nAcrB FROM dual")
.head 9 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 8 +  If nAcrB
.head 9 +  If SqlPrepareAndExecute(hSql(), "SELECT nls, kv INTO :dfNlsB, :dfKvB FROM accounts WHERE acc=:nAcrB")
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If SalIsNull(dfKvB)
.head 9 -  Set dfKvB = GetBaseVal()
.head 7 +  Else
.head 8 -  Set dfNlsB = IifS(nId < 2, sNlsSD0 , sNlsSD2)
.head 7 -  Call setEdited()
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 16821
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  2.13"
.head 5 -  End X:  10.0"
.head 5 -  End Y:  2.13"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Операція виплати %%
.head 4 -  Resource Id: 16822
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.08"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVyplN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Тип
.head 4 -  Resource Id: 16823
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.28"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    2.48"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfTT2)
.head 7 -  Set dfTT2 = 'PS1'
.head 7 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Вал
.head 4 -  Resource Id: 16824
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.0"
.head 5 -  Top:    1.61"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKvC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    2.48"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfKvC)
.head 7 +  If SalIsNull(dfKvA)
.head 8 -  Set dfKvC = GetBaseVal()
.head 7 +  Else
.head 8 -  Set dfKvC = dfKvA
.head 7 -  Call setEdited()
.head 3 -  Background Text: Рахунок виплати
.head 4 -  Resource Id: 16825
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.9"
.head 5 -  Top:    2.28"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNlsC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsC !! Счет C (получатель %)
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    2.48"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Set dfNlsC = SalStrTrimX(dfNlsC)
.head 6 +  If SalIsNull(dfNlsC)  ! не задали ничего
.head 7 -  Set dfMFO = ''
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SalIsNull(dfMFO)   ! по умолчанию наше МФО
.head 7 -  Set dfMFO = GetBankMfo()
.head 6 +  If dfNlsC != KeyAccount(dfMFO,dfNlsC) ! проверка КР
.head 7 -  ! Конр.разряд
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTErrKR') ||
     ': ' || CurrentLangTable.GetAtomTitle('frm_ProcAccounts.bgNlsC'),
     CurrentLangTable.GetAtomTitle('cTErr'), 0 )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If dfMFO = GetBankMfo()   ! Если наше МФО, то проверка на наличие счета ( и его авто-открытие)
.head 7 +  If not SalIsNull(dfKvC)
.head 8 -  If IfAccExists(dfNamC, dfNlsC, dfKvC, nTmp)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Призначення платежу
.head 4 -  Resource Id: 16829
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.8"
.head 5 -  Top:    2.28"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNazn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNazn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    2.48"
.head 6 -  Width:  6.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 +  Check Box: cbBank
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок в інш.банку
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.95"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call setBank()
.head 3 -  Background Text: МФО
.head 4 -  Resource Id: 16826
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    2.75"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMfoC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    2.95"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 +  If SalIsNull(dfMFO)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If IfMfoExists(dfMFO)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: ЗКПО
.head 4 -  Resource Id: 16827
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.4"
.head 5 -  Top:    2.75"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOkpoC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.4"
.head 6 -  Top:    2.95"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Назва рахунку
.head 4 -  Resource Id: 16828
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    2.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNamC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.3"
.head 6 -  Top:    2.95"
.head 6 -  Width:  3.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call setEdited()
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 16830
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  3.27"
.head 5 -  End X:  10.0"
.head 5 -  End Y:  3.27"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: %% ставки
.head 4 -  Resource Id: 16831
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.22"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    3.45"
.head 6 -  Width:  9.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: dIntDat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 +  If not SalIsValidDateTime(dIntDat)
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If SalIsNull(dIntDat)
.head 9 -  Call SalTblSetRowFlags(tbl, SalTblQueryContext(tbl), ROW_MarkDeleted, TRUE)
.head 8 +  Else
.head 9 -  Call SalTblSetRowFlags(tbl, SalTblQueryContext(tbl), ROW_MarkDeleted, FALSE)
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: dIntDatEta
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Validate
.head 8 +  If SalIsNull(dIntDat)
.head 9 -  Call SalTblSetRowFlags(tbl, SalTblQueryContext(tbl), ROW_MarkDeleted,
     TRUE)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If not SalIsValidDateTime(dIntDat)
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else 
.head 9 -  Call SalTblSetRowFlags(tbl, SalTblQueryContext(tbl), ROW_MarkDeleted,
     FALSE)
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: nIr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ставка
індивідуальна
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: sOp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фор-
мула
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text:
.head 7 -  Text: +
.head 7 -  Text: -
.head 7 -  Text: *
.head 7 -  Text: /
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Set nOp = SalListQuerySelection(hWndItem)
.head 5 +  Column: sBr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Базова ставка
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If sBr.Init(hWndItem)
.head 9 -  Call sBr.Populate(hSql(), "br_id", "name", "brates", "order by name")
.head 7 +  On SAM_AnyEdit
.head 8 -  Call setEdited()
.head 8 -  Set nBr = sBr.GetKey(SalListQuerySelection(sBr))
.head 5 +  Column: nBr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N
Баз
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nOp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
Оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nRowid
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Rowid
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIndex
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: GetFirstEditableColumn
.head 6 -  Description: Получить первую редактируюмую колонку
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTbl
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nCol
.head 7 -  Window Handle: hWndCol
.head 6 +  Actions
.head 7 -  Set nCol=1
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetPos )
.head 8 +  If hWndCol=hWndNULL
.head 9 -  Break
.head 8 +  If SalTblQueryColumnFlags(hWndCol, COL_Editable ) AND
SalIsWindowVisible( hWndCol )
.head 9 -  Break
.head 8 -  Set nCol=nCol+1
.head 7 -  Return hWndCol
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Boolean: bIns
.head 5 -  Boolean: bUpd
.head 5 -  Boolean: bDel
.head 5 -  Window Handle: hCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Set nRow = 0
.head 6 +  While nRow < l_getAcrnParNumRatn(nId)
.head 7 -  Call SalTblInsertRow(hWndForm, nRow)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 7 -  Call getAcrnRatnParam(nId, nRow, dIntDat, nIr, nBr, nOp, bIns, bUpd, bDel)
.head 7 -  Set dIntDatEta = dIntDat
.head 7 -  Call SalListSetSelect(sOp, nOp)
.head 7 -  Call sBr.SetSelectById(nBr)
.head 7 +  If bDel
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, TRUE)
.head 7 +  Else If bIns
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, TRUE)
.head 7 +  Else If bUpd
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 7 -  Set colIndex = nRow
.head 7 -  Set nRow = nRow + 1
.head 5 +  On UM_Insert
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Set hCol = GetFirstEditableColumn(hWndForm)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
.head 6 -  !
.head 6 -  Set tbl.dIntDat = GetBankDate()
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 +  If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, 
not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
.head 7 +  Else
.head 8 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted) and colIndex != NUMBER_Null
.head 8 -  Call l_dropAcrnRatn(nId, colIndex)
.head 7 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_New) and colIndex = NUMBER_Null
.head 8 -  Call l_addAcrnRatn(nId, dIntDat, nIr, nBr, nOp, colIndex)
.head 7 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
.head 8 -  Call l_setAcrnRatn(nId, colIndex, dIntDat, nIr, nBr, nOp)
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited | ROW_New | ROW_MarkDeleted, FALSE)
.head 3 +  Picture: pbIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.467"
.head 5 -  Top:    3.452"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cBTipIns'))
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendMsg(tbl, UM_Insert, 0, 0)
.head 3 +  Picture: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.467"
.head 5 -  Top:    3.786"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cBTipDel'))
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendMsg(tbl, UM_Delete, 0, 0)
.head 2 +  Functions
.head 3 +  Function: IfAccExists
.head 4 -  Description: Check to see if input account in GL
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNmsN
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  Receive Number: nAccN
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nR1 !! Рег № осн счета
.head 5 -  Number: nI1 !! исполнитель осн счета
.head 5 -  String: sN1  !! NLS осн счета
.head 5 -  String: sNMS !! NMS осн счета
.head 5 -  String: sNmsN_ !! NMS открываемого  счета
.head 5 -  Number: nGrp !! Grp осн счета
.head 5 -  String: sBranch
.head 4 +  Actions
.head 5 -  Set nAccN = NUMBER_Null
.head 5 -  ! если нет этого счета
.head 5 +  If SqlPrepareAndExecute(hSql(), "SELECT acc INTO :nAccN FROM accounts WHERE kv=:nKv AND nls=:sNls" )
and not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! согласны на авто-открытие
.head 6 -  ! Счет sNls/nKv не открыт. Открыть ?
.head 6 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTMess11')||' '||sNls||'/'||Str(nKv)||' '||
   CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTMess12')||PutCrLf()||' '||
   CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTMess13'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconHand) = IDYES
.head 7 -  ! осн счет найден
.head 7 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.rnk, a.isp, a.nms, a.grp, branch
   INTO :nR1, :nI1, :sNMS, :nGrp, :sBranch
   FROM accounts a
  WHERE a.acc=:nAcc ")
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! наименование открываемоно счета
.head 8 -  ! Нар.%% sNMS
.head 8 -  Set sNmsN_ = IifS ( sNmsN=STRING_Null, CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTMess2')||" "||SalStrTrimX(sNMS),  SalStrTrimX(sNmsN) )
.head 8 +  If Op_Reg( 99,0,0,nGrp,nTmp,nR1,sNls,nKv, Subs(sNmsN_,1,38), 'ODB', nI1, nAccN ) and
   SqlPLSQLCommand(hSql(), "p_setAccessByAccmask(nAccN, nAcc)") and
   SqlPrepareAndExecute(hSql(), "update accounts set tobo=:sBranch where acc=:nAccN")
.head 9 -  Call SqlCommit(hSql())
.head 9 -  ! АвтоОткрытие сч. sNls/nKv
.head 9 -  Call SaveFInfoToLog(CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTMess3')||""||sNls||"/"||Str(nKv))
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 5 -  Return TRUE
.head 3 +  Function: IfMfoExists
.head 4 -  Description: Check to see if MFO valid
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sMfo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bNo
.head 4 +  Actions
.head 5 +  If sMfo and sMfo != GetBankMfo()
.head 6 -  Call SqlPrepareAndExecute(hSql(), 'SELECT 1 FROM banks WHERE mfo=:sMfo and NVL(blk,0)<>4 INTO :bNo')
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Невірний код МФО '|| sMfo, 'Помилка', MB_IconExclamation)
.head 5 -  Return bNo
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Call hWndParent.dlg_ProcAccounts.setEdited()
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_AccAcrn.setEdited()
.head 5 -  Return TRUE
.head 3 +  Function: setBank
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nAccess != ACCESS_READONLY
.head 6 +  If cbBank
.head 7 -  Call SalEnableWindow(dfMFO)
.head 7 -  Call SalEnableWindow(dfOkpo)
.head 7 -  Call SalEnableWindow(dfNamC)
.head 7 -  Set dfMFO = ''
.head 6 +  Else
.head 7 -  Call SalDisableWindow(dfMFO)
.head 7 -  Call SalDisableWindow(dfOkpo)
.head 7 -  Call SalDisableWindow(dfNamC)
.head 7 +  If dfNlsC
.head 8 -  Set dfMFO = GetBankMfo()
.head 7 +  Else
.head 8 -  Set dfMFO = ''
.head 6 -  Set dfOkpo = ''
.head 6 -  Set dfNamC = ''
.head 5 -  Return TRUE
.head 3 +  Function: getAcrnAccnParam
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Receive Number: nMetr
.head 5 -  Receive Number: nBaseM
.head 5 -  Receive Number: nBaseY
.head 5 -  Receive Number: nFreq
.head 5 -  Receive Date/Time: dStpDat
.head 5 -  Receive Date/Time: dAcrDat
.head 5 -  Receive Date/Time: dAplDat
.head 5 -  Receive String: sTt
.head 5 -  Receive Number: nAcrA
.head 5 -  Receive String: sNlsA
.head 5 -  Receive Number: nKvA
.head 5 -  Receive Number: nAcrB
.head 5 -  Receive String: sNlsB
.head 5 -  Receive Number: nKvB
.head 5 -  Receive String: sTtB
.head 5 -  Receive Number: nKvC
.head 5 -  Receive String: sNlsC
.head 5 -  Receive String: sNamC
.head 5 -  Receive String: sMfo
.head 5 -  Receive String: sOkpo
.head 5 -  Receive String: sNazn
.head 5 -  Receive Number: nIo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bRet
.head 4 +  Actions
.head 5 -  Set nMetr  = 0
.head 5 -  Set nBaseY = 0
.head 5 +  If SqlPrepareAndExecute(hSql(), "SELECT nvl(basey,0) INTO :nBaseY FROM tabval WHERE kv=:nKv")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set nBaseM = 0
.head 5 -  Set nFreq  = 1
.head 5 -  Set dStpDat = DATETIME_Null
.head 5 -  Set dAcrDat = DATETIME_Null
.head 5 -  Set dAplDat = DATETIME_Null
.head 5 -  Set sTt   = STRING_Null
.head 5 -  Set nAcrA = NUMBER_Null
.head 5 -  Set sNlsA = STRING_Null
.head 5 -  Set nKvA  = NUMBER_Null
.head 5 -  Set nAcrB = NUMBER_Null
.head 5 -  Set sNlsB = STRING_Null
.head 5 -  Set nKvB  = NUMBER_Null
.head 5 -  Set sTtB  = STRING_Null
.head 5 -  Set nKvC  = NUMBER_Null
.head 5 -  Set sNlsC = STRING_Null
.head 5 -  Set sNamC = STRING_Null
.head 5 -  Set sMfo  = STRING_Null
.head 5 -  Set sOkpo = STRING_Null
.head 5 -  Set sNazn = STRING_Null
.head 5 +  If sWindow = 'DLG'
.head 6 -  Set bRet = hWndParent.dlg_ProcAccounts.getAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvC, sNlsC, sNamC, sMfo, sOkpo, sNazn, nIo)
.head 5 +  Else
.head 6 -  Set bRet = hWndParent.Dlg_AccAcrn.getAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvC, sNlsC, sNamC, sMfo, sOkpo, sNazn, nIo)
.head 5 +  If not bRet
.head 6 -  Set nMetr  = 0
.head 6 -  Set nBaseY = 0
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT nvl(basey,0) INTO :nBaseY FROM tabval WHERE kv=:nKv")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set nBaseM = 0
.head 6 -  Set nFreq  = 1
.head 6 -  Set dStpDat = DATETIME_Null
.head 6 -  Set dAcrDat = DATETIME_Null
.head 6 -  Set dAplDat = DATETIME_Null
.head 6 -  Set sTt   = STRING_Null
.head 6 -  Set nAcrA = NUMBER_Null
.head 6 -  Set sNlsA = STRING_Null
.head 6 -  Set nKvA  = NUMBER_Null
.head 6 -  Set nAcrB = NUMBER_Null
.head 6 -  Set sNlsB = STRING_Null
.head 6 -  Set nKvB  = NUMBER_Null
.head 6 -  Set sTtB  = STRING_Null
.head 6 -  Set nKvC  = NUMBER_Null
.head 6 -  Set sNlsC = STRING_Null
.head 6 -  Set sNamC = STRING_Null
.head 6 -  Set sMfo  = STRING_Null
.head 6 -  Set sOkpo = STRING_Null
.head 6 -  Set sNazn = STRING_Null
.head 5 +  If nAcrA
.head 6 -  Call SqlPrepareAndExecute(hSql(), "SELECT nls,kv INTO :sNlsA,:nKvA FROM accounts WHERE acc=:nAcrA")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nAcrB
.head 6 -  Call SqlPrepareAndExecute(hSql(), "SELECT nls,kv INTO :sNlsB,:nKvB FROM accounts WHERE acc=:nAcrB")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call cmbMetr.SetSelectById(nMetr)
.head 5 -  Call cmbBaseY.SetSelectById(nBaseY)
.head 5 -  Call cmbFreq.SetSelectById(nFreq)
.head 5 -  Call cmbOstat.SetSelectById(nIo)
.head 5 +  If sMfo and sMfo != GetBankMfo()
.head 6 -  Set cbBank = TRUE
.head 5 -  Call setBank()
.head 5 -  Return TRUE
.head 3 +  Function: setAcrnAccnParam
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nMetr
.head 5 -  Number: nBaseM
.head 5 -  Number: nBaseY
.head 5 -  Number: nFreq
.head 5 -  Date/Time: dStpDat
.head 5 -  Date/Time: dAcrDat
.head 5 -  Date/Time: dAplDat
.head 5 -  String: sTt
.head 5 -  Number: nAcrA
.head 5 -  Number: nAcrB
.head 5 -  String: sTtB
.head 5 -  Number: nKvB
.head 5 -  String: sNlsB
.head 5 -  String: sNamB
.head 5 -  String: sMfo
.head 5 -  String: sOkpo
.head 5 -  String: sNazn
.head 5 -  Number: nIo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Call hWndParent.dlg_ProcAccounts.setAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dfStpDat, dfAcrDat, dfAplDat, 
     dfTT1, nAcrA, nAcrB, dfTT2, dfKvC, dfNlsC, dfNamC, dfMFO, dfOkpo, dfNazn, nIo)
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_AccAcrn.setAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dfStpDat, dfAcrDat, dfAplDat, 
     dfTT1, nAcrA, nAcrB, dfTT2, dfKvC, dfNlsC, dfNamC, dfMFO, dfOkpo, dfNazn, nIo)
.head 5 -  Return TRUE
.head 3 +  Function: getAcrnRatnParam
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 5 -  Receive Date/Time: dBDat
.head 5 -  Receive Number: nIr
.head 5 -  Receive Number: nBr
.head 5 -  Receive Number: nOp
.head 5 -  Receive Boolean: bIns
.head 5 -  Receive Boolean: bUpd
.head 5 -  Receive Boolean: bDel
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Call hWndParent.dlg_ProcAccounts.getAcrnRatn(nId, nRatnIndex, dBDat, nIr, nBr, nOp, bIns, bUpd, bDel)
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_AccAcrn.getAcrnRatn(nId, nRatnIndex, dBDat, nIr, nBr, nOp, bIns, bUpd, bDel)
.head 5 -  Return TRUE
.head 3 +  Function: l_getAcrnParNumRatn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNum
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Set nNum = hWndParent.dlg_ProcAccounts.getAcrnParNumRatn(nId)
.head 5 +  Else
.head 6 -  Set nNum = hWndParent.Dlg_AccAcrn.getAcrnParNumRatn(nId)
.head 5 -  Return nNum
.head 3 +  Function: l_dropAcrnRatn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Call hWndParent.dlg_ProcAccounts.dropAcrnRatn(nId, nRatnIndex)
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_AccAcrn.dropAcrnRatn(nId, nRatnIndex)
.head 5 -  Return TRUE
.head 3 +  Function: l_addAcrnRatn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Date/Time: dBDat
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 5 -  Receive Number: nRatnIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Call hWndParent.dlg_ProcAccounts.addAcrnRatn(nId, dBDat, nIr, nBr, nOp, nRatnIndex)
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_AccAcrn.addAcrnRatn(nId, dBDat, nIr, nBr, nOp, nRatnIndex)
.head 5 -  Return TRUE
.head 3 +  Function: l_setAcrnRatn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 5 -  Date/Time: dBDatNew
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sWindow = 'DLG'
.head 6 -  Call hWndParent.dlg_ProcAccounts.setAcrnRatn(nId, nRatnIndex, dBDatNew, nIr, nBr, nOp)
.head 5 +  Else
.head 6 -  Call hWndParent.Dlg_AccAcrn.setAcrnRatn(nId, nRatnIndex, dBDatNew, nIr, nBr, nOp)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nAcc !! Основной счет
.head 3 -  Number: nAccess  ! nAccess=ACCESS_READONLY   Только просмотр
                 ! иначе с РЕДАКТИРОВАНИЕМ
.head 3 -  String: sNlsSN0 !! Счет нач проц
.head 3 -  String: sNlsSD0 !! счет дох.расх.
.head 3 -  String: sNlsSN2 !! Счет нач проц
.head 3 -  String: sNlsSD2 !! счет дох.расх.
.head 3 -  String: sWindow ! 'FRM' - из карточки счета, 'DLG' - из отдельного диалога
.head 3 -  Window Handle: hWndParent
.head 2 +  Window Variables
.head 3 -  Number: nBaseVal
.head 3 -  Number: nId
.head 3 -  ! Для таблицы INT_ACC
.head 3 -  Number: nMetr
.head 3 -  Number: nBaseY
.head 3 -  Number: nBaseM
.head 3 -  Number: nFreq
.head 3 -  Number: nIo
.head 3 -  Number: nAcrA
.head 3 -  Number: nAcrB
.head 3 -  !
.head 3 -  Number: nPap
.head 3 -  String: sLcv
.head 3 -  Number: nKv
.head 3 -  String: sNls
.head 3 -  Number: nTmp
.head 3 -  Number: mBaseY[*]
.head 3 -  ! добавки Суховой
.head 3 -  Number: nLim
.head 3 -  String: sNBS
.head 3 -  String: sNlsSN
.head 3 -  Number: ACCN
.head 3 -  !
.head 3 -  String: sTip
.head 3 -  Boolean: bIo
.head 3 -  String: sPTt
.head 3 -  String: sPNbsn
.head 3 -  String: sSel
.head 3 -  ! Number: nNum
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  Set nBaseVal = GetBaseVal()
.head 4 -  !
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Call SalDisableWindow(pb_Copy)
.head 4 -  ! информация об осн счете
.head 4 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, a.kv, a.pap, a.nbs, t.lcv, a.tip, a.lim
   INTO :sNls, :nKv, :nPap, :sNBS, :sLcv, :sTip, :nLim
   FROM accounts a, tabval t
  WHERE a.kv=t.kv AND acc=:nAcc")
.head 5 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 6 -  ! Не открыт счет с внутренним № nAcc
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTErrAcc')||Str(nAcc),
     CurrentLangTable.GetAtomTitle('cTErr'),MB_IconExclamation)
.head 6 -  ! Call SalEndDialog( hWndForm, FALSE )
.head 6 -  ! Return FALSE
.head 4 -  !
.head 4 -  Set nIo = 0
.head 4 +  If GetGlobalOption('IO%') = 'Y'
.head 5 -  Set bIo = TRUE
.head 5 -  Call SalEnableWindow(cmbOstat)
.head 5 -  If SqlPrepareAndExecute(hSql(),"SELECT nvl(io,0) INTO :nIo FROM proc_dr WHERE nvl(rezid,0)=0 AND sour=4 AND nbs=:sNBS" )
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 +  Else
.head 5 -  Set bIo = FALSE
.head 5 -  Call SalDisableWindow(cmbOstat)
.head 4 +  If nAccess = ACCESS_READONLY
.head 5 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 4 -  !
.head 4 -  ! Установки
.head 4 +  If cmbGroups.Init(cmbGroups)
.head 5 +  If sNBS
.head 6 +  If nPap = 1 and nLim >= 0
.head 7 -  Set nId = 0
.head 7 -  Set sSel =
"(select ID, id||'-'||name NAME from int_idn where mod(id,2)=0 union all
  select id, id||'-Alt' from int_accn where acc="|| Str(nAcc) ||" and id not in (select id from int_idn)) "
.head 6 +  Else If nPap = 2 and nLim <= 0
.head 7 -  Set nId = 1
.head 7 -  Set sSel =
"(select ID, id||'-'||name NAME from int_idn where mod(id,2)=1 " || IifS(sNBS='2600', "or id=0 ", "") || "union all
  select id, id||'-Alt' from int_accn where acc="|| Str(nAcc) ||" and id not in (select id from int_idn)) "
.head 6 +  Else
.head 7 -  Set sSel =
"(select ID, id||'-'||name NAME from int_idn union all
  select id, id||'-Alt' from int_accn where acc="|| Str(nAcc) ||" and id not in (select id from int_idn)) "
.head 7 +  If nLim > 0
.head 8 -  Set nId = 0
.head 7 +  Else
.head 8 -  Set nId = 1
.head 5 -  ! пустой НБС - НБУ внесистемные счета
.head 5 +  Else
.head 6 -  Set sSel = "(select ID, id||'-'||name NAME from int_idn)"
.head 6 +  If nPap = 1 and nLim >= 0
.head 7 -  Set nId = 0
.head 6 +  Else If nPap = 2 and nLim <= 0
.head 7 -  Set nId = 1
.head 6 +  Else
.head 7 +  If nLim > 0
.head 8 -  Set nId = 0
.head 7 +  Else
.head 8 -  Set nId = 1
.head 5 -  Call cmbGroups.Populate(hSql(), "ID", "NAME", sSel, " ORDER BY abs(ID) ")
.head 5 -  Call cmbGroups.SetSelectById(nId)
.head 5 +  If nId  ! слабо-голубой
.head 6 -  Call SalColorSet( tbl, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  Else ! cлабо-розовый
.head 6 -  Call SalColorSet( tbl, COLOR_IndexWindow, SalColorFromRGB( 255,210,250 ) )
.head 4 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT nvl(decode(:nKv,:nBaseVal,tt,nvl(ttv,tt)),'%%1'), nbsn
   INTO :sPTt, :sPNbsn
   FROM proc_dr WHERE nbs=:sNBS AND sour=4")
or NOT SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set sPTt = '%%1'
.head 5 -  Set sPNbsn = ''
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call getAcrnAccnParam(nId, nMetr, nBaseM, nBaseY, nFreq, dfStpDat, dfAcrDat, dfAplDat, 
     dfTT1, nAcrA, dfNlsA, dfKvA, nAcrB, dfNlsB, dfKvB, dfTT2, dfKvC, dfNlsC, dfNamC, dfMFO, dfOkpo, dfNazn, nIo)
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalDisableWindow( pbIns )
.head 4 -  Call SalDisableWindow( pbDel )
.head 4 -  Call SalDisableWindow( dfAcrDat )
.head 4 -  Call SalDisableWindow( dfAplDat )
.head 4 -  Call SalDisableWindow( dfStpDat )
.head 4 -  Call SalDisableWindow( cmbMetr )
.head 4 -  Call SalDisableWindow( cmbBaseY )
.head 4 -  Call SalDisableWindow( cmbOstat )
.head 4 -  Call SalDisableWindow( dfTT1 )
.head 4 -  Call SalDisableWindow( dfKvA )
.head 4 -  Call SalDisableWindow( dfNlsA )
.head 4 -  Call SalDisableWindow( dfKvB )
.head 4 -  Call SalDisableWindow( dfNlsB )
.head 4 -  Call SalDisableWindow( dfTT2 )
.head 4 -  Call SalDisableWindow( dfKvC )
.head 4 -  Call SalDisableWindow( dfNlsC )
.head 4 -  Call SalDisableWindow( cbBank )
.head 4 -  Call SalDisableWindow( dfNamC )
.head 4 -  Call SalDisableWindow( dfMFO )
.head 4 -  Call SalDisableWindow( dfOkpo )
.head 4 -  Call SalDisableWindow( dfNazn )
.head 4 -  Call SalDisableWindow( cbBank )
.head 4 -  Call SalDisableWindow( tbl.dIntDat )
.head 4 -  Call SalDisableWindow( tbl.nIr )
.head 4 -  Call SalDisableWindow( tbl.sOp )
.head 4 -  Call SalDisableWindow( tbl.sBr )
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка
.head 4 +  If not SalIsNull(dfNlsC) and not SalIsNull(dfMFO)
.head 5 +  If dfNlsC != KeyAccount(dfMFO,dfNlsC) ! проверка КР
.head 6 -  ! Конр.разряд
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ProcAccounts.cTErrKR') ||
     ': ' || CurrentLangTable.GetAtomTitle('frm_ProcAccounts.bgNlsC'),
     CurrentLangTable.GetAtomTitle('cTErr'), 0 )
.head 6 -  Return 2
.head 4 -  Return 1
.head 4 +  ! If cbSPOpt
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tblSP, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(tblSP, nRow)
.head 6 +  If tblSP.colOpt = '1' AND tblSP.colZsp = ''
.head 7 -  ! Не заполнен реквизит <tblSP.colSem>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrRekv') || ' <' || tblSP.colSem || '>', 
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 7 -  Set nRowErr = nRow
.head 7 -  Return 2
.head 3 +  On UM_Update
.head 4 +  If nAccess != ACCESS_READONLY
.head 5 -  Call SalSendMsg(dfNlsA, SAM_Validate, 0, 0)
.head 5 -  Call SalSendMsg(dfNlsB, SAM_Validate, 0, 0)
.head 5 +  If not SalIsNull(dfStpDat) or not SalIsNull(dfAcrDat) or not SalIsNull(dfAplDat)
 or not SalIsNull(dfTT1) or nAcrA != NUMBER_Null or nAcrB != NUMBER_Null or not SalIsNull(dfNamC)
.head 6 -  Call setAcrnAccnParam(nId, nMetr, nBaseM, nBaseY, nFreq, dfStpDat, dfAcrDat, dfAplDat, 
     dfTT1, nAcrA, nAcrB, dfTT2, dfKvC, dfNlsC, dfNamC, dfMFO, dfOkpo, dfNazn, nIo)
.head 6 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 -  ! Call SalSendClassMessage(SAM_Destroy, 0, 0 )
.head 3 +  On UM_Close
.head 4 +  If SalTblAnyRows( tbl, ROW_Edited | ROW_MarkDeleted | ROW_New, 0 )
.head 5 -  Call SalMessageBeep( MB_IconQuestion )
.head 5 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('cGTQuestion'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) != IDYES
.head 6 -  Return FALSE
.head 4 -  ! Call SalEndDialog( hWndForm, 0)
.head 1 +  Dialog Box: dlg_ProcAccounts
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.7"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.4"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('dlg_ProcAccounts.cBTipSave')
.head 6 +  On SAM_Click
.head 7 +  If saveAcrn()
.head 8 -  Set fIsEdit = FALSE
.head 8 -  Call SalDisableWindow(hWndItem)
.head 4 +  Pushbutton: pbClose
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('dlg_ProcAccounts.cBTipClose')
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog(hWndForm, 0)
.head 2 +  Contents
.head 3 +  Custom Control: cSpl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not fIsEdit
.head 6 -  Set fIsEdit = TRUE
.head 6 -  Call SalEnableWindow(pbSave)
.head 3 +  Function: getAcrnAccn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Receive Number: nMetr
.head 5 -  Receive Number: nBaseM
.head 5 -  Receive Number: nBaseY
.head 5 -  Receive Number: nFreq
.head 5 -  Receive Date/Time: dStpDat
.head 5 -  Receive Date/Time: dAcrDat
.head 5 -  Receive Date/Time: dAplDat
.head 5 -  Receive String: sTt
.head 5 -  Receive Number: nAcrA
.head 5 -  Receive Number: nAcrB
.head 5 -  Receive String: sTtB
.head 5 -  Receive Number: nKvB
.head 5 -  Receive String: sNlsB
.head 5 -  Receive String: sNamB
.head 5 -  Receive String: sMfo
.head 5 -  Receive String: sOkpo
.head 5 -  Receive String: sNazn
.head 5 -  Receive Number: nIo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return cAccAcrn.getAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 3 +  Function: setAcrnAccn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nMetr
.head 5 -  Number: nBaseM
.head 5 -  Number: nBaseY
.head 5 -  Number: nFreq
.head 5 -  Date/Time: dStpDat
.head 5 -  Date/Time: dAcrDat
.head 5 -  Date/Time: dAplDat
.head 5 -  String: sTt
.head 5 -  Number: nAcrA
.head 5 -  Number: nAcrB
.head 5 -  String: sTtB
.head 5 -  Number: nKvB
.head 5 -  String: sNlsB
.head 5 -  String: sNamB
.head 5 -  String: sMfo
.head 5 -  String: sOkpo
.head 5 -  String: sNazn
.head 5 -  Number: nIo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call cAccAcrn.setAcrnAccn(nId, nMetr, nBaseM, nBaseY, nFreq, dStpDat, dAcrDat, dAplDat, 
sTt, nAcrA, nAcrB, sTtB, nKvB, sNlsB, sNamB, sMfo, sOkpo, sNazn, nIo)
.head 3 +  Function: getAcrnParNumRatn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nId
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return cAccAcrn.getAcrnParNumRatn(nId)
.head 3 +  Function: getAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 5 -  Receive Date/Time: dBDat
.head 5 -  Receive Number: nIr
.head 5 -  Receive Number: nBr
.head 5 -  Receive Number: nOp
.head 5 -  Receive Boolean: bIns
.head 5 -  Receive Boolean: bUpd
.head 5 -  Receive Boolean: bDel
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call cAccAcrn.getAcrnRatn(nId, nRatnIndex, dBDat, nIr, nBr, nOp, bIns, bUpd, bDel)
.head 3 +  Function: addAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Date/Time: dBDat
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 5 -  Receive Number: nRatnIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call cAccAcrn.addAcrnRatn(nId, dBDat, nIr, nBr, nOp, nRatnIndex)
.head 3 +  Function: setAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 5 -  ! Date/Time: dBDat
.head 5 -  Date/Time: dBDatNew
.head 5 -  Number: nIr
.head 5 -  Number: nBr
.head 5 -  Number: nOp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call hWndParent.Frm_Account.cAccount.setAcrnRatn(nId, dBDat, dBDatNew, nIr, nBr, nOp)
.head 5 -  Call cAccAcrn.setAcrnRatn(nId, nRatnIndex, dBDatNew, nIr, nBr, nOp)
.head 3 +  Function: dropAcrnRatn
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nId
.head 5 -  Number: nRatnIndex
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call cAccAcrn.dropAcrnRatn(nId, nRatnIndex)
.head 3 +  Function: saveAcrn
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalSendMsg(frm_ProcAccounts, UM_Update, 0, 0)
.head 5 +  If not cAccAcrn.saveAccAcrn()
.head 6 -  Return FALSE 
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nAcc !! Основной счет
.head 3 -  Number: nAccess  ! nAccess=ACCESS_READONLY   Только просмотр
                 ! иначе с РЕДАКТИРОВАНИЕМ
.head 3 -  String: sNlsSN0 !! Счет нач проц
.head 3 -  String: sNlsSD0 !! счет дох.расх.
.head 3 -  String: sNlsSN2 !! Счет нач проц
.head 3 -  String: sNlsSD2 !! счет дох.расх.
.head 2 +  Window Variables
.head 3 -  : cAccAcrn
.head 4 -  Class: AbstractAccount
.head 3 -  Boolean: fIsEdit	! Признак редактирования реквизитов
.head 3 -  String: sNls
.head 3 -  String: sLcv
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, t.lcv
   INTO :sNls, :sLcv
   FROM accounts a, tabval t
  WHERE a.kv=t.kv AND acc=:nAcc")
.head 5 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 4 -  ! Параметри нарахування %% по рахунку sLcv/sNls
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_ProcAccounts.cTWndTitle') || ' ' || sLcv || '/' || sNls)
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  !
.head 4 -  Set fIsEdit = FALSE
.head 4 -  Call SalDisableWindow(pbSave)
.head 4 -  !
.head 4 -  Call cAccAcrn.initAccount(hSql(), nAcc)
.head 4 +  If not cAccAcrn.populateAccAcrn()
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Call cSpl.setBarSize(5)
.head 4 -  Call cSpl.setTopFrame(SalCreateWindowEx(frm_ProcAccounts, hWndForm, 0,0,0,0, CREATE_AsChild,
nAcc, IifN(nAccess!=ACCESS_READONLY,1,ACCESS_READONLY), sNlsSN0, sNlsSD0, sNlsSN2, sNlsSD2, 'DLG', hWndForm))
.head 4 -  Call cSpl.setBarPosition(1000)
.head 4 -  Call SalSetFocus(pbClose)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: HLP
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет процентов для АКТИВНЫХ остатков
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.013"
.head 4 -  Top:    0.052"
.head 4 -  Width:  9.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.85"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.4"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb_Null
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\REFRESH.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Очистить'
.head 6 +  On SAM_Click
.head 7 -  Call F_Null()
.head 4 +  Pushbutton: pb_OK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.6"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать План.Остатки на счете начисленных %'
.head 6 +  On SAM_Click
.head 7 +  If NOT F_Ok()
.head 8 -  Set NLS_SS = sTmp_SS
.head 4 -  Line
.head 5 -  Resource Id: 43680
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.15"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.15"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.25"
.head 6 -  Top:    0.05"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выйти'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 -  Group Box: Ссудный счет
.head 4 -  Resource Id: 43675
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.05"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.35"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: NLS_SS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.3"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Ссудный счет' )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set ACC_SS = NUMBER_Null
.head 6 -  Call SalEnableWindow(pb_OK)
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp_SS = NLS_SS
.head 3 +  Data Field: KV_SS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    0.3"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты ссудного счета' )
.head 3 +  Data Field: NMS_SS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.6"
.head 6 -  Width:  4.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование ссудного счета' )
.head 3 +  Pushbutton: pb_Poisk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.867"
.head 5 -  Top:    0.226"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выбрать Ссудный счет'
.head 5 +  On SAM_Click
.head 6 -  Call F_Nls()
.head 6 +  If ACC_SS != NUMBER_Null
.head 7 -  Call SalEnableWindow(pb_OK)
.head 7 -  Call SalSendMsg(pb_OK, SAM_Click, 0, 0)
.head 3 -  !
.head 3 -  Group Box: Счет начисленных %%
.head 4 -  Resource Id: 43676
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.75"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.64"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: NLS_SN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.0"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Счет начисленных %' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = NLS_SN
.head 5 +  On SAM_AnyEdit
.head 6 -  Set NLS_SN = sTmp
.head 3 +  Data Field: KV_SN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    2.0"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты начисленных %' )
.head 3 -  !
.head 3 -  Background Text: % ставка на
.head 4 -  Resource Id: 43677
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.95"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: IR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    0.9"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '% ставка на '|| SalFmtFormatDateTime( tDat, 'dd/MM/yyyy' ) )
.head 3 -  Background Text: Базовый год
.head 4 -  Resource Id: 43674
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.25"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: nBasey
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.595"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код базового года' )
.head 3 +  Data Field: Basey_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    1.2"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование базового года' )
.head 3 -  !
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    0.1"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: FDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OST
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ост.на ссуд сч
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  ! ctb_pbFilter: pb_Igr
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.883"
.head 5 -  Top:    3.321"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.0"
.head 5 -  Height Editable? No
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name:
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\A_PROC.BMP
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Light Gray
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Расчитать %% в "игровом" режиме'
.head 5 +  On SAM_Click
.head 6 +  If ACC_SS != NUMBER_Null
.head 7 -  Call Sel010( hWndMDI, 0, 1," and s.acc=" || Str(ACC_SS) ," " )
.head 3 -  ! НЕ корректируется !  Дата-0, по которую %% уже начислены (ACR_DAT)
.head 3 +  Data Field: DAT0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    2.5"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-0, по которую %% уже начислены ' )
.head 3 +  Data Field: OST_SN0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    2.5"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Тек.Остаток на счете начисленных %% ' )
.head 3 -  Frame
.head 4 -  Resource Id: 43679
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.9"
.head 5 -  Width:  8.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  ! Расчетная Дата-1, "Предыдущий" день (от введенной даты, по умолчанию текущая-1)
.head 3 +  Data Field: D1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    3.0"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество дней (Дата-0 ... Дата-1]' )
.head 3 +  Data Field: DAT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    3.0"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-1, "Предыдущий" день ' )
.head 3 +  Data Field: DOS_SN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    3.0"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления %% по "Предыдущий" день Дата-1' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN1
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN1 = nTmp
.head 3 +  Data Field: OST_SN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    3.0"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных %% за "Предыдущий" день Дата-1' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN1
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN1 = nTmp
.head 3 -  ! Дата-2,  Вводим - для планового погашения, по умолчанию - текущая
.head 3 +  Data Field: D2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    3.3"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество дней (Дата-1 ... Дата-2]' )
.head 3 +  Data Field: DAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    3.3"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-2, "Текущая" - для планового погашения ' )
.head 3 +  Data Field: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.7"
.head 6 -  Top:    3.3"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План: Погасить - , Выдать (+) в Дату-2' )
.head 3 +  Data Field: DOS_SN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    3.3"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления %% по "Текущую" Дату-2 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN2
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN2 = nTmp
.head 3 +  Data Field: OST_SN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    3.3"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных %% за Дату-2 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN2
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN2 = nTmp
.head 3 -  ! Дата-3, Вводим Последняя календарная Дата месяца, или  др.контрольная дата
.head 3 +  Data Field: D3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    3.6"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество дней (Дата-2 ... Дата-3]' )
.head 3 +  Data Field: DAT3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    3.6"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-3, Последняя календарная Дата месяца
(или др.контрольная дата) ' )
.head 3 +  Data Field: DOS_SN3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    3.6"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления %% по Дату-3 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN3
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN3 = nTmp
.head 3 +  Data Field: OST_SN3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    3.6"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных %% за Дату-3 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN3
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN3 = nTmp
.head 2 +  Functions
.head 3 +  Function: F_Null
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set NLS_SS = STRING_Null
.head 5 -  Set KV_SS  = GetBaseVal()
.head 5 -  Set NMS_SS = STRING_Null
.head 5 -  Set NLS_SN = STRING_Null
.head 5 -  Set KV_SN = NUMBER_Null
.head 5 -  Set IR = NUMBER_Null
.head 5 -  Set nBasey = NUMBER_Null
.head 5 -  Set Basey_Name = STRING_Null
.head 5 -  Set DAT0 = DATETIME_Null
.head 5 -  Set OST_SN0 = NUMBER_Null
.head 5 -  Set S = 0
.head 5 -  Set DAT1 = DAT2 - 1
.head 5 -  Set DAT3 = DAT_31
.head 5 -  Set DOS_SN1 = NUMBER_Null
.head 5 -  Set DOS_SN2 = NUMBER_Null
.head 5 -  Set DOS_SN3 = NUMBER_Null
.head 5 -  Set OST_SN1 = NUMBER_Null
.head 5 -  Set OST_SN2 = NUMBER_Null
.head 5 -  Set OST_SN3 = NUMBER_Null
.head 5 -  Call SalTblReset(tbl1)
.head 5 -  Call SalDisableWindow(pb_OK)
.head 5 -  Call SalSetFocus(NLS_SS)
.head 5 -  Return TRUE
.head 3 +  Function: F_Nls
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp1
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Set sTmp_SS = NLS_SS
.head 5 -  Set ACC_SS = NUMBER_Null
.head 5 -  Set sTmp = STRING_Null
.head 5 -  ! Выбрать значение из фильтрованого справочника
.head 5 -  Call FunNSIGetFiltered("SALDO", "NLS", " acc in (select acc from int_accn where id=0) and dazs is null ", sTmp, sTmp1)
.head 5 +  If sTmp != STRING_Null
.head 6 -  Set ACC_SS = Val(sTmp)
.head 6 -  Set NLS_SS = sTmp1
.head 3 +  Function: F_Ok
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: p_Dat0
.head 5 -  Number: p_Ost0
.head 5 -  !
.head 5 -  Date/Time: p_Dat1
.head 5 -  Number: p_Dos1
.head 5 -  Number: p_Ost1
.head 5 -  !
.head 5 -  Date/Time: p_Dat2
.head 5 -  Number: p_S
.head 5 -  Number: p_Dos2
.head 5 -  Number: p_Ost2
.head 5 -  !
.head 5 -  Date/Time: p_Dat3
.head 5 -  Number: p_Dos3
.head 5 -  Number: p_Ost3
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  ! найти проц. карточку
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.acc, a.nms, acrn.FPROCN(a.acc,0, :DAT2 ), a.kv, a.nls, n.nls, n.kv, i.basey, y.name
   INTO :ACC_SS, :NMS_SS, :IR, :KV_SS, :NLS_SS,
        :NLS_SN, :KV_SN,  :nBasey,     :Basey_Name
   FROM saldo a ,  int_accn i, basey y, accounts n
  WHERE n.acc= i.acra and  i.basey = y.basey
    AND " || IifS(ACC_SS = NUMBER_Null, "a.nls=:NLS_SS and a.kv=:KV_SS", "a.acc=:ACC_SS") || "
    and i.acc=a.acc  and i.id=0 " )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox("Рахунок не знайдено !", "УВАГА !", MB_IconStop)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set p_Dat2 = DAT2
.head 5 -  Set p_S    = S
.head 5 -  Set p_Dat3 = DAT3
.head 5 -  Call SqlPLSQLCommand(hSql(), 
"int_mode (ACC_SS,0,
p_Dat0,            p_Ost0,
p_Dat1,    p_Dos1, p_Ost1,
p_Dat2,p_S,p_Dos2, p_Ost2,
p_Dat3,    p_Dos3, p_Ost3)")
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Set DAT0    = p_Dat0
.head 5 -  Set OST_SN0 = p_Ost0
.head 5 -  !
.head 5 -  Set DAT1    = p_Dat1
.head 5 -  Set D1      = p_Dat1 - p_Dat0
.head 5 -  Set DOS_SN1 = p_Dos1
.head 5 -  Set OST_SN1 = p_Ost1
.head 5 -  If DOS_SN1 < 0
.head 5 -  !
.head 5 -  Set D2      = p_Dat2 - p_Dat1
.head 5 -  Set DOS_SN2 = p_Dos2
.head 5 -  Set OST_SN2 = p_Ost2
.head 5 -  !
.head 5 -  Set D3      = p_Dat3 - p_Dat2
.head 5 -  Set DOS_SN3 = p_Dos3
.head 5 -  Set OST_SN3  = p_Ost3
.head 5 -  !
.head 5 -  ! Населить таблицу остатков по осн.счету
.head 5 -  Call SalTblPopulate(tbl1, hSql(),
"SELECT fdat, -ost/100  INTO :tbl1.FDAT, :tbl1.OST
   FROM sal
  WHERE acc = :ACC_SS and fdat >= :DAT0
  ORDER BY fdat desc", TBL_FillAll)
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  Number: ACC_SS
.head 3 -  Date/Time: tDat
.head 3 -  Date/Time: DAT_31
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  Date/Time: dTmp
.head 3 -  String: sTmp
.head 3 -  String: sTmp_SS
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set tDat = GetBankDate()
.head 4 -  Call SalSetWindowLabelText(bgRate, '% ставка на ' || SalFmtFormatDateTime(tDat, 'dd/MM/yyyy'))
.head 4 -  Set DAT2 = tDat
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select last_day(:tDat) into :DAT_31 from dual")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 4 -  Call F_Null()
.head 4 +  If nPar > 0
.head 5 -  Set ACC_SS = nPar
.head 5 -  Call SalEnableWindow(pb_OK)
.head 5 -  Call F_Ok()
.head 4 -  Call SalSetFocus(NLS_SS)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 1 +  ! Form Window: HLP_old
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет процентов для АКТИВНЫХ остатков
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.013"
.head 4 -  Top:    0.052"
.head 4 -  Width:  9.967"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.226"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Pushbutton: pb_Poisk
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.238"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выбрать Ссудный счет'
.head 5 +  On SAM_Click
.head 6 -  Call F_Nls()
.head 6 +  If ACC_SS != NUMBER_Null
.head 7 -  Call SalEnableWindow(pb_OK)
.head 7 -  Call SalSendMsg(pb_OK, SAM_Click, 0, 0)
.head 3 +  Data Field: NMS_SS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.238"
.head 6 -  Width:  3.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование ссудного счета' )
.head 3 +  Data Field: IR
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '% ставка на '|| SalFmtFormatDateTime( tDat, 'dd/MM/yyyy' ) )
.head 3 +  Data Field: NLS_SS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.238"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Ссудный счет' )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set ACC_SS = NUMBER_Null
.head 6 -  Call SalEnableWindow(pb_OK)
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp_SS = NLS_SS
.head 3 +  Data Field: KV_SS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты ссудного счета' )
.head 3 +  Data Field: nBasey
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    0.571"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код базового года' )
.head 3 +  Data Field: Basey_Name
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.571"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование базового года' )
.head 3 +  Child Table: tbl1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.655"
.head 6 -  Width:  4.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents 
.head 5 +  Column: FDAT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: OST
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ост.на ссуд сч
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 -  Message Actions 
.head 3 +  Data Field: NLS_SN
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.905"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Счет начисленных %' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = NLS_SN
.head 5 +  On SAM_AnyEdit
.head 6 -  Set NLS_SN = sTmp
.head 3 +  Data Field: KV_SN
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    0.905"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты начисленных %' )
.head 3 -  !
.head 3 +  Pushbutton: pb_OK
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.383"
.head 5 -  Top:    3.655"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Ok.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Расчитать План.Остатки на счете начисленных %'
.head 5 +  On SAM_Click
.head 6 +  If NOT F_Ok()
.head 7 -  Set NLS_SS = sTmp_SS
.head 3 +  ! ctb_pbFilter: pb_Igr
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Расчитать %% в "игровом" режиме'
.head 5 +  On SAM_Click
.head 6 +  If ACC_SS != NUMBER_Null
.head 7 -  Call Sel010( hWndMDI, 0, 1," and s.acc=" || Str(ACC_SS) ," " )
.head 3 +  Pushbutton: pb_Null
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    3.655"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\REFRESH.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Очистить'
.head 5 +  On SAM_Click
.head 6 -  Call F_Null()
.head 3 -  ! НЕ корректируется !  Дата-0, по которую %% уже начислены (ACR_DAT)
.head 3 +  Data Field: DAT0
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    3.655"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-0, по которую %% уже начислены ' )
.head 3 +  Data Field: OST_SN0
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    3.655"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Тек.Остаток на счете начисленных %% ' )
.head 3 -  ! Расчетная Дата-1, "Предыдущий" день (от введенной даты, по умолчанию текущая-1)
.head 3 +  Data Field: D1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    4.155"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество дней (Дата-0 ... Дата-1]' )
.head 3 +  Data Field: DAT1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    4.155"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-1, "Предыдущий" день ' )
.head 3 +  Data Field: DOS_SN1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    4.155"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления %% по "Предыдущий" день Дата-1' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN1
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN1 = nTmp
.head 3 +  Data Field: OST_SN1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    4.155"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных %% за "Предыдущий" день Дата-1' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN1
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN1 = nTmp
.head 3 -  ! Дата-2,  Вводим - для планового погашения, по умолчанию - текущая
.head 3 +  Data Field: D2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    4.488"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество дней (Дата-1 ... Дата-2]' )
.head 3 +  Data Field: DAT2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    4.488"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-2, "Текущая" - для планового погашения ' )
.head 3 +  Data Field: S
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.583"
.head 6 -  Top:    4.488"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План: Погасить - , Выдать (+) в Дату-2' )
.head 3 +  Data Field: DOS_SN2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    4.488"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления %% по "Текущую" Дату-2 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN2
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN2 = nTmp
.head 3 +  Data Field: OST_SN2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    4.488"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных %% за Дату-2 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN2
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN2 = nTmp
.head 3 -  ! Дата-3, Вводим Последняя календарная Дата месяца, или  др.контрольная дата
.head 3 +  Data Field: D3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    4.821"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Количество дней (Дата-2 ... Дата-3]' )
.head 3 +  Data Field: DAT3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    4.821"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата-3, Последняя календарная Дата месяца
(или др.контрольная дата) ' )
.head 3 +  Data Field: DOS_SN3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    4.821"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления %% по Дату-3 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN3
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN3 = nTmp
.head 3 +  Data Field: OST_SN3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    4.821"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных %% за Дату-3 ' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN3
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN3 = nTmp
.head 3 -  !
.head 3 -  Frame 
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    3.988"
.head 5 -  Width:  8.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.end
.head 2 +  Functions 
.head 3 +  Function: F_Null
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set IR = NUMBER_Null
.head 5 -  Set NLS_SS = STRING_Null
.head 5 -  Set KV_SS  = GetBaseVal()
.head 5 -  Set NMS_SS = STRING_Null
.head 5 -  Set NLS_SN = STRING_Null
.head 5 -  Set KV_SN = NUMBER_Null
.head 5 -  Set DAT0 = DATETIME_Null
.head 5 -  Set OST_SN0 = NUMBER_Null
.head 5 -  Set S = 0
.head 5 -  Set DAT1 = DAT2 - 1
.head 5 -  Set DAT3 = DAT_31
.head 5 -  Set DOS_SN2 = NUMBER_Null
.head 5 -  Set DOS_SN3 = NUMBER_Null
.head 5 -  Set OST_SN2 = NUMBER_Null
.head 5 -  Set OST_SN3 = NUMBER_Null
.head 5 -  Call SalTblReset(tbl1)
.head 5 -  Call SalDisableWindow(pb_OK)
.head 5 -  Call SalSetFocus(NLS_SS)
.head 5 -  Return TRUE
.head 3 +  Function: F_Nls
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmp1
.head 5 -  String: sTmp
.head 4 +  Actions 
.head 5 -  Set sTmp_SS = NLS_SS
.head 5 -  Set ACC_SS = NUMBER_Null
.head 5 -  Set sTmp = STRING_Null
.head 5 -  ! Выбрать значение из фильтрованого справочника
.head 5 -  Call FunNSIGetFiltered("SALDO", "NLS", " acc in (select acc from int_accn where id=0) and dazs is null ", sTmp, sTmp1)
.head 5 +  If sTmp != STRING_Null
.head 6 -  Set ACC_SS = Val(sTmp)
.head 6 -  Set NLS_SS = sTmp1
.head 3 +  Function: F_Ok
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Date/Time: p_Dat0
.head 5 -  Number: p_Ost0
.head 5 -  !
.head 5 -  Date/Time: p_Dat1
.head 5 -  Number: p_Dos1
.head 5 -  Number: p_Ost1
.head 5 -  !
.head 5 -  Date/Time: p_Dat2
.head 5 -  Number: p_S
.head 5 -  Number: p_Dos2
.head 5 -  Number: p_Ost2
.head 5 -  !
.head 5 -  Date/Time: p_Dat3
.head 5 -  Number: p_Dos3
.head 5 -  Number: p_Ost3
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  ! найти проц. карточку
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.acc, a.nms, acrn.FPROCN(a.acc,0, :DAT2 ), a.kv, a.nls, n.nls, n.kv, i.basey, y.name
   INTO :ACC_SS, :NMS_SS, :IR, :KV_SS, :NLS_SS,
        :NLS_SN, :KV_SN,  :nBasey,     :Basey_Name
   FROM saldo a ,  int_accn i, basey y, accounts n
  WHERE n.acc= i.acra and  i.basey = y.basey
    AND " || IifS(ACC_SS = NUMBER_Null, "a.nls=:NLS_SS and a.kv=:KV_SS", "a.acc=:ACC_SS") || "
    and i.acc=a.acc  and i.id=0 " )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox("Рахунок не знайдено !", "УВАГА !", MB_IconStop)
.head 6 -  Return FALSE
.head 5 -  ! Населить таблицу остатков по осн.счету
.head 5 -  Call SalTblPopulate(tbl1, hSql(),
"SELECT fdat, -ost/100  INTO :tbl1.FDAT, :tbl1.OST
   FROM sal
  WHERE acc = :ACC_SS and fdat >= :DAT0
  ORDER BY fdat desc", TBL_FillAll)
.head 5 -  ! ---------------------
.head 5 -  Set p_Dat2 = DAT2
.head 5 -  Set p_S    = S
.head 5 -  Set p_Dat3 = DAT3
.head 5 -  Call SqlPLSQLCommand(hSql(), 
"int_mode (ACC_SS,0,
p_Dat0,            p_Ost0,
p_Dat1,    p_Dos1, p_Ost1,
p_Dat2,p_S,p_Dos2, p_Ost2,
p_Dat3,    p_Dos3, p_Ost3)")
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Set DAT0    = p_Dat0
.head 5 -  Set OST_SN0 = p_Ost0
.head 5 -  !
.head 5 -  Set DAT1    = p_Dat1
.head 5 -  Set D1      = p_Dat1 - p_Dat0
.head 5 -  Set DOS_SN1 = p_Dos1
.head 5 -  Set OST_SN1 = p_Ost1
.head 5 -  If DOS_SN1 < 0
.head 5 -  !
.head 5 -  Set D2      = p_Dat2 - p_Dat1
.head 5 -  Set DOS_SN2 = p_Dos2
.head 5 -  Set OST_SN2 = p_Ost2
.head 5 -  !
.head 5 -  Set D3      = p_Dat3 - p_Dat2
.head 5 -  Set DOS_SN3 = p_Dos3
.head 5 -  Set OST_SN3  = p_Ost3
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 2 +  Window Parameters 
.head 3 -  Number: nPar
.head 2 +  Window Variables 
.head 3 -  Number: ACC_SS
.head 3 -  Date/Time: tDat
.head 3 -  Date/Time: DAT_31
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  Date/Time: dTmp
.head 3 -  String: sTmp
.head 3 -  String: sTmp_SS
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set tDat = GetBankDate()
.head 4 -  Set DAT2 = tDat
.head 4 -  Call SqlPrepareAndExecute(hSql(), "select last_day(:tDat) into :DAT_31 from dual")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes) 
.head 4 -  Call F_Null()
.head 4 +  If nPar > 0
.head 5 -  Set ACC_SS = nPar
.head 5 -  Call SalEnableWindow(pb_OK)
.head 5 -  Call F_Ok()
.head 4 -  Call SalSetFocus(NLS_SS)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 1 +  Dialog Box: dlgParHist
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.05"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 3.45"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set bSave = TRUE
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 6539
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6540
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If bSave
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"select " || cPar.sValName || "
   into :sRetValue
   from " || cPar.sTabName || "
  where " || cPar.sKeyName || " = :hWndForm.dlgParHist.cPar.nND
    and parid = :hWndForm.dlgParHist.cPar.nParId
    and bankdate between dat1 and dat2")
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sRetValue = ''
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 6541
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  4.133"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  4.133"
.head 6 -  End Y:  0.012"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblParam
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.8"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colDat1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: 99/99/9999
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If bEdit
.head 9 +  If not SalIsNull(colValue)
.head 10 +  If cPar.sType = 'N' and not SalIsValidNumber(colValue)
.head 11 -  ! cPar.sParSemantic : должно быть число!
.head 11 -  Call SalMessageBox(cPar.sParSemantic || ' : ' || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrNumber'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 11 -  Return VALIDATE_Cancel
.head 10 +  Else If cPar.sType = 'D' and not SalIsValidDateTime(colValue)
.head 11 -  ! cPar.sParSemantic : должна быть дата!
.head 11 -  Call SalMessageBox(cPar.sParSemantic || ' : ' || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrData'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconExclamation)
.head 11 -  Return VALIDATE_Cancel
.head 10 -  ! Проверка введенного значения на вхождение в указанный справочник
.head 10 +  If cPar.sNsiTabName and cPar.sNsiColumnCheck
.head 11 -  ! Set sNsiFilter = getNsiFilter(colNsiSqlWhere)
.head 11 -  Call SqlPrepareAndExecute(hSqlAux(),
"select count(*) into :nCount
   from " || cPar.sNsiTabName  || "
  where " || cPar.sNsiColumnCheck || " = :colValue")
.head 11 +  If SqlFetchNext(hSqlAux(), nFetchRes) and not nCount
.head 12 -  ! Неверное значение реквизита! Выбирите значение из справочника!
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrValOnNsi') || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('Dlg_CustDR.cTErrValOnNsi_'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 12 -  Set colValue = ''
.head 12 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_DoubleClick
.head 8 +  If bEdit and cPar.sNsiTabName
.head 9 -  Set nRow = SalTblQueryContext(hWndForm)
.head 9 -  ! Set sNsiFilter = getNsiFilter(colNsiSqlWhere)
.head 9 +  If cPar.sNsiPkName = ''
.head 10 +  If FunNSIGetFiltered(cPar.sNsiTabName, '', '', s1, s2)
.head 11 -  Set colValue = s1
.head 11 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 +  Else
.head 10 +  If FunNSIGetFilteredAltPK(cPar.sNsiTabName, cPar.sNsiPkName, '', '', s1, s2)
.head 11 -  Set colValue = s1
.head 11 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
.head 9 -  Call SalSetFocus(hWndForm)
.head 9 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 9 -  Call SalTblSetFocusCell(hWndForm, nRow, colValue, 0, 0)
.head 5 +  Column: colDatOld
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nCount
.head 5 -  String: s1
.head 5 -  String: s2
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set colDatOld = colDat1
.head 6 +  If bEdit and cPar.sNsiTabName
.head 7 -  Call XSalTblSetCellBackColor(colValue, SalColorFromRGB(230, 255, 255))
.head 5 +  On UM_Insert
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Set hCol = GetFirstEditableColumn(hWndForm)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRow, hCol, 0, 1)
.head 6 +  If cPar.sNsiTabName
.head 7 -  Call XSalTblSetCellBackColor(colValue, SalColorFromRGB(230, 255, 255))
.head 5 +  On UM_Update
.head 6 -  Call SalSendClassMessage(UM_Update, 0, 0)
.head 6 -  ! пересчет дат для nAcc
.head 6 -  ! call SqlPLSQLCommand(hSql(), "")
.head 6 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  : cPar
.head 4 -  Class: cParHist
.head 3 -  Boolean: bEdit
.head 3 -  Receive String: sRetValue
.head 2 +  Window Variables
.head 3 -  Boolean: bSave
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, cPar.sParSemantic)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set bSave = FALSE
.head 4 +  If not bEdit
.head 5 -  Set hWndForm.dlgParHist.nFlags = GT_ReadOnly
.head 5 -  Call SalDisableWindow(tblParam.colDat1)
.head 5 -  Call SalDisableWindow(tblParam.colValue)
.head 4 -  Set hWndForm.dlgParHist.strSqlPopulate = 
"select dat1, substr(" || cPar.sValName || ",1,254)
   into :hWndForm.tblParam.colDat1, :hWndForm.tblParam.colValue
   from " || cPar.sTabName || "
  where " || cPar.sKeyName || " = " || Str(cPar.nND) || "
    and parid = " || Str(cPar.nParId) || "
  order by dat1"
.head 4 -  Set hWndForm.dlgParHist.strSqlInsert = 
"insert into " || cPar.sTabName || "(" || cPar.sKeyName || ", dat1, parid, " || cPar.sValName || ")
 values (:dlgParHist.cPar.nND, :hWndForm.tblParam.colDat1, :dlgParHist.cPar.nParId, :hWndForm.tblParam.colValue)"
.head 4 -  Set hWndForm.dlgParHist.strSqlUpdate = 
"update " || cPar.sTabName || "
    set dat1 = :tblParam.colDat1,
        " || cPar.sValName || " = :tblParam.colValue
  where " || cPar.sKeyName || " = :dlgParHist.cPar.nND
    and dat1 = :tblParam.colDatOld
    and parid = :dlgParHist.cPar.nParId"
.head 4 -  Set hWndForm.dlgParHist.strSqlDelete = 
"delete from " || cPar.sTabName || "
  where " || cPar.sKeyName || " = :dlgParHist.cPar.nND
    and dat1 = :tblParam.colDatOld
    and parid = :dlgParHist.cPar.nParId"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 -  On SAM_DoubleClick
.head 1 +  Dialog Box: Dlg_ChooseCustRel
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выбор клиента/связанного лица
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.1"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! Line
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.0"
.head 5 -  End X:  10.6"
.head 5 -  End Y:  0.0"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.end
.head 3 +  Radio Button: rbPerson
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Физическое лицо
.head 4 -  Window Location and Size
.head 5 -  Left:   4.3"
.head 5 -  Top:    0.15"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbCorp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Юридическое лицо
.head 4 -  Window Location and Size
.head 5 -  Left:   4.3"
.head 5 -  Top:    0.45"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 11156
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  0.85"
.head 5 -  End X:  10.6"
.head 5 -  End Y:  0.85"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Picture: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.4"
.head 5 -  Top:    1.0"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\SEARCH.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Поиск
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('Dlg_ChooseCustRel.pbSearch'))
.head 5 +  On SAM_Click
.head 6 -  ! wParam=1, если ввели ОКПО, а клиентов с таким ОКПО несколько
.head 6 +  If FunNSIGetFiltered('v_customerrel_list', 'rnk', "v_customerrel_list.custtype=" || IifS(rbPerson=TRUE, "2","1") ||
   IifS(wParam=1, " and okpo='" || dfOkpo || "'", ""), sPK, sSem)
.head 7 -  Set dfRnk = Val(sPK)
.head 7 -  Call SearchCustomer(dfRnk, '')
.head 3 -  Background Text: Рег.номер клиента/связ.лица
.head 4 -  Resource Id: 11159
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.05"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    1.0"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfOkpo = ''
.head 6 -  Set dfFio  = ''
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(dfRnk)
.head 7 +  If not SearchCustomer(dfRnk, '')
.head 8 -  Set dfRnk  = NUMBER_Null
.head 8 -  Set dfOkpo = ''
.head 8 +  If SalMessageBox('Клієнта не знайдено! Вибрати з довідника?', 'Увага!', MB_IconExclamation | MB_YesNo) = IDYES
.head 9 -  Call SalSendMsg(pbSearch, SAM_Click, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: ОКПО клиента/связ.лица
.head 4 -  Resource Id: 11160
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.35"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    1.3"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfRnk = NUMBER_Null
.head 6 -  Set dfFio = ''
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(dfOkpo)
.head 7 -  Call SqlPrepareAndExecute(hSql(), "select count(*) into :nCount from v_customerrel_list where okpo=:dfOkpo and " || "v_customerrel_list.custtype=" || IifS(rbPerson=TRUE, "2","1"))
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If nCount = 0
.head 8 -  Set dfRnk  = NUMBER_Null
.head 8 -  Set dfOkpo = ''
.head 8 -  Set dfFio  = ''
.head 8 +  If SalMessageBox('Клієнта не знайдено! Вибрати з довідника?', 'Увага!', MB_IconExclamation | MB_YesNo) = IDYES
.head 9 -  Call SalSendMsg(pbSearch, SAM_Click, 0, 0)
.head 7 +  Else If nCount = 1
.head 8 -  Call SearchCustomer(NUMBER_Null, dfOkpo)
.head 7 +  Else
.head 8 +  If SalMessageBox("Знайдено декілька клієнтів з ЗКПО " || dfOkpo || "! Вибрати з довідника по ЗКПО?", "Увага!", MB_IconExclamation | MB_YesNo) = IDYES
.head 9 -  Call SalSendMsg(pbSearch, SAM_Click, 1, 0)
.head 8 +  Else
.head 9 -  Set dfRnk  = NUMBER_Null
.head 9 -  Set dfOkpo = ''
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: ФИО/наим. клиента/связ.лица
.head 4 -  Resource Id: 11161
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.65"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    1.6"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 11158
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  2.0"
.head 5 -  End X:  10.6"
.head 5 -  End Y:  2.0"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   7.7"
.head 5 -  Top:    2.15"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! 1-ЮЛ, 2-ФЛ
.head 6 -  Set nCusttype = IifN(rbPerson=TRUE, 2, 1)
.head 6 -  Set nRnk = dfRnk
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.0"
.head 5 -  Top:    2.15"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  ! Line
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.0"
.head 5 -  Begin Y:  2.75"
.head 5 -  End X:  10.6"
.head 5 -  End Y:  2.75"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.end
.head 2 +  Functions
.head 3 +  Function: SearchCustomer
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 5 -  String: sOkpo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If not SqlPrepareAndExecute(hSql(),
"select rnk, okpo, nmk
   into :dfRnk, :dfOkpo, :dfFio
   from v_customerrel_list
  where " || IifS(nRnk!=NUMBER_Null,
        "rnk  = :nRnk",
        "okpo = :sOkpo") || "
    and " || "v_customerrel_list.custtype=" || IifS(rbPerson=TRUE, "2","1"))
.head 6 -  Return FALSE
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Receive Number: nCusttype
.head 3 -  Receive Number: nRnk
.head 2 +  Window Variables
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 3 -  Number: nCount
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Dlg_ChooseCustRel.cTWndTitle'))
.head 4 -  Call SalSetFocus(dfRnk)
.head 1 +  Dialog Box: dlgCheckOkpo
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Проверка ОКПО
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.7"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.9"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 28305
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.06"
.head 5 -  Width:  6.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.65"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMsg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.2"
.head 6 -  Width:  6.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Идентификационный код:
.head 4 -  Resource Id: 28309
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.6"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.55"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата рождения:
.head 4 -  Resource Id: 28307
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.9"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBday
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBday
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.85"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 -  Message Actions
.head 3 -  Background Text: Пол:
.head 4 -  Resource Id: 28308
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.2"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    1.15"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbSex.Init(hWndItem)
.head 7 -  Call cmbSex.Populate(hSql(), 'id', 'name', 'sex', 'order by id')
.head 7 -  Call cmbSex.SetSelectById(Val(sSex))
.head 3 -  Frame
.head 4 -  Resource Id: 28306
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    1.76"
.head 5 -  Width:  6.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сохранить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    1.9"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull(dfOkpo)
.head 7 -  Call SalEndDialog(hWndForm, FALSE)
.head 6 +  Else If sOkpo = dfOkpo
.head 7 -  Set sOkpo = dfOkpo
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 6 +  Else
.head 7 +  If CheckPersonOkpo(dfOkpo, dBDay, sSex, sMsg)
.head 8 -  Set sOkpo = dfOkpo
.head 8 -  Call SalEndDialog(hWndForm, TRUE)
.head 7 +  Else
.head 8 -  ! Введите правильный Идентификационный код клиента ( ОКПО )!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.cTErrIdk'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
.head 8 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.9"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: sOkpo
.head 3 -  Date/Time: dBDay
.head 3 -  String: sSex
.head 3 -  String: sMsg
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgCheckOkpo.cTWndTitle'))
.head 4 -  Call SalSetWindowLabelText(bgOkpo, CurrentLangTable.GetAtomTitle('Dlg_CustGeneral.bgOkpo'))
.head 4 -  Call SalSetWindowLabelText(bgBday, CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgBday'))
.head 4 -  Call SalSetWindowLabelText(bgSex,  CurrentLangTable.GetAtomTitle('Dlg_CustPerson.bgSex'))
.head 4 -  Call SalSetFocus(dfOkpo)
.head 4 -  Set dfMsg = sMsg
.head 4 -  Set dfBday = dBDay
.head 4 -  Call SalDisableWindow(dfBday)
.head 4 -  Call SalDisableWindow(cmbSex)
.head 1 +  Dialog Box: Dlg_CustAdr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.3"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 8562
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.06"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Адрес клиента:
.head 4 -  Resource Id: 8556
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.0"
.head 5 -  Top:    0.25"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAdr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.2"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfAdr = sTmpAdr
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpAdr = dfAdr
.head 3 -  Background Text: Страна:
.head 4 -  Resource Id: 8564
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.55"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCountry
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbCountry
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    0.5"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.905"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbCountry.Init(hWndItem)
.head 7 -  Call cmbCountry.Populate(hSql(), "country", "lpad(country,3,' ') || '  ' || name", "country", "order by name")
.head 7 -  Call cmbCountry.SetSelectById(cAdr.nCountry)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 3 -  Background Text: Индекс:
.head 4 -  Resource Id: 8557
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.85"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIndex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIndex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.8"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Background Text: Код территории:
.head 4 -  Resource Id: 8565
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.2"
.head 5 -  Top:    0.85"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTerritoryId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pbTerritoryId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.2"
.head 5 -  Top:    0.8"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\HELP.BMP
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Выбрать из справочника
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTGetFromNsi'))
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGetFiltered('TERRITORY', 'CITY', '', sPK, sSem)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select id, region, district, city 
   into :dfTerritoryId, :dfObl, :dfReg, :dfCity 
   from territory where id=:sPK")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If dfTerritoryId
.head 8 -  Call cmbCountry.SetSelectById(GetBankCountryCode())
.head 8 -  Call SalEnableWindow(dfObl)
.head 8 -  Call SalEnableWindow(dfReg)
.head 8 -  Call SalEnableWindow(dfCity)
.head 7 -  Call setAdress()
.head 7 -  Call setEdited()
.head 3 +  Data Field: dfTerritoryId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.8"
.head 6 -  Top:    0.8"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Область:
.head 4 -  Resource Id: 8558
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.15"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgObl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfObl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    1.1"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Район:
.head 4 -  Resource Id: 8559
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.45"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgReg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfReg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    1.4"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Населенный пункт:
.head 4 -  Resource Id: 8560
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.75"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCity
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbCity
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    1.7"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.048"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbCity.Init(hWndItem)
.head 7 -  Call cmbCity.Populate(hSql(), "id", "value", "address_locality_type", "order by value")
.head 7 -  Call cmbCity.SetSelectById(cAdr.nLocalityType)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Call setAdress()
.head 3 +  Data Field: dfCity
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 60
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.1"
.head 6 -  Top:    1.7"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Улица, просп., б-р.:
.head 4 -  Resource Id: 8561
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.05"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgStreet
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbStreet
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    2.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.738"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbStreet.Init(hWndItem)
.head 7 -  Call cmbStreet.Populate(hSql(), "id", "value", "address_street_type", "order by value")
.head 7 -  Call cmbStreet.SetSelectById(cAdr.nStreetType)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Call setAdress()
.head 3 +  Data Field: dfStreet
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.1"
.head 6 -  Top:    2.0"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: № буд., д/в:
.head 4 -  Resource Id: 37380
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.35"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbHome
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    2.3"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbHome.Init(hWndItem)
.head 7 -  Call cmbHome.Populate(hSql(), "id", "substr(value,1,10)", "address_home_type", "order by value")
.head 7 -  Call cmbHome.SetSelectById(cAdr.nHomeType)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Call setAdress()
.head 3 +  Data Field: dfHome
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.1"
.head 6 -  Top:    2.3"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: № корп., секц.:
.head 4 -  Resource Id: 37381
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.65"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbHomepart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    2.6"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.119"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbHomepart.Init(hWndItem)
.head 7 -  Call cmbHomepart.Populate(hSql(), "id", "substr(value,1,10)", "address_homepart_type", "order by value")
.head 7 -  Call cmbHomepart.SetSelectById(cAdr.nHomepartType)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Call setAdress()
.head 3 +  Data Field: dfHomepart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.1"
.head 6 -  Top:    2.6"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: № кв., кімн., оф.:
.head 4 -  Resource Id: 9066
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.95"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbRoom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    2.9"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbRoom.Init(hWndItem)
.head 7 -  Call cmbRoom.Populate(hSql(), "id", "substr(value,1,10)", "address_room_type", "order by value")
.head 7 -  Call cmbRoom.SetSelectById(cAdr.nRoomType)
.head 5 +  On SAM_Click
.head 6 -  Call setEdited()
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Call setAdress()
.head 3 +  Data Field: dfRoom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.1"
.head 6 -  Top:    2.9"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 5 +  On SAM_Validate
.head 6 -  Call setAdress()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Примітка:
.head 4 -  Resource Id: 9067
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.25"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlComm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    3.2"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.7"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call setEdited()
.head 3 -  Frame
.head 4 -  Resource Id: 8563
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    4.1"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbDubl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Заполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\EDIT.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call cmbCountry.SetSelectById(cAdr1.nCountry)
.head 6 -  Set dfTerritoryId = cAdr1.nTerritoryId
.head 6 -  Set dfIndex = cAdr1.sZip
.head 6 -  Set dfObl = cAdr1.sDomain
.head 6 -  Set dfReg = cAdr1.sRegion
.head 6 -  Call cmbCity.SetSelectById(cAdr1.nLocalityType)
.head 6 -  Set dfCity = cAdr1.sLocality
.head 6 -  Call cmbStreet.SetSelectById(cAdr1.nStreetType)
.head 6 -  Set dfStreet = cAdr1.sStreet
.head 6 -  Call cmbHome.SetSelectById(cAdr1.nHomeType)
.head 6 -  Set dfHome = cAdr1.sHome
.head 6 -  Call cmbHomepart.SetSelectById(cAdr1.nHomepartType)
.head 6 -  Set dfHomepart = cAdr1.sHomepart
.head 6 -  Call cmbRoom.SetSelectById(cAdr1.nRoomType)
.head 6 -  Set dfRoom = cAdr1.sRoom
.head 6 -  Call setAdress()
.head 6 -  Call setEdited()
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   7.0"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not checkAdress()
.head 7 -  Return FALSE
.head 6 -  Set cAdr.nCountry = cmbCountry.nCurrentId
.head 6 -  Set cAdr.sZip = dfIndex
.head 6 -  Set cAdr.sDomain = dfObl
.head 6 -  Set cAdr.sRegion = dfReg
.head 6 -  Set cAdr.nLocalityType = cmbCity.nCurrentId
.head 6 -  Set cAdr.sLocality = dfCity
.head 6 -  Set cAdr.nStreetType = cmbStreet.nCurrentId
.head 6 -  Set cAdr.sStreet = dfStreet
.head 6 -  Set cAdr.nHomeType = cmbHome.nCurrentId
.head 6 -  Set cAdr.sHome = dfHome
.head 6 -  Set cAdr.nHomepartType = cmbHomepart.nCurrentId
.head 6 -  Set cAdr.sHomepart = dfHomepart
.head 6 -  Set cAdr.nRoomType = cmbRoom.nCurrentId
.head 6 -  Set cAdr.sRoom = dfRoom
.head 6 -  Set cAdr.sAddress = Subs(SalStrTrimX(
  IifS(SalIsNull(dfStreet),  '', SalStrTrimX(cmbStreet || ' ' || SalStrTrimX(dfStreet)) || ' ') ||
  IifS(SalIsNull(dfHome),    '', SalStrTrimX(cmbHome || ' ' || SalStrTrimX(dfHome)) || ' ') ||
  IifS(SalIsNull(dfHomepart),'', SalStrTrimX(cmbHomepart || ' ' || SalStrTrimX(dfHomepart)) || ' ') ||
  IifS(SalIsNull(dfRoom),    '', SalStrTrimX(cmbRoom || ' ' || SalStrTrimX(dfRoom)))), 1, 100)
.head 6 -  Set cAdr.nTerritoryId = dfTerritoryId
.head 6 -  Set cAdr.sComm = mlComm
.head 6 -  Set sAdr = dfAdr
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancelLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.3"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalEnableWindow(pbOk)
.head 3 +  Function: checkAdress
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If cAdr.nTypeId = 1
.head 6 +  If SalIsNull(dfCity)
or SalIsNull(dfStreet)
or SalIsNull(dfHome)
.head 7 -  Call SalMessageBox("Не заповнено обов'язковы реквізити адреси!", "Увага!", MB_IconExclamation | MB_Ok)
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: setAdress
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sAdress
.head 4 +  Actions
.head 5 -  Set sAdress = SalStrTrimX(
  IifS(SalIsNull(dfObl),     '', SalStrTrimX(dfObl) || ' ') || 
  IifS(SalIsNull(dfReg),     '', SalStrTrimX(dfReg) || ' ') || 
  IifS(SalIsNull(dfCity),    '', SalStrTrimX(cmbCity || ' ' || SalStrTrimX(dfCity)) || ' ') || 
  IifS(SalIsNull(dfStreet),  '', SalStrTrimX(cmbStreet || ' ' || SalStrTrimX(dfStreet)) || ' ') ||
  IifS(SalIsNull(dfHome),    '', SalStrTrimX(cmbHome || ' ' || SalStrTrimX(dfHome)) || ' ') ||
  IifS(SalIsNull(dfHomepart),'', SalStrTrimX(cmbHomepart || ' ' || SalStrTrimX(dfHomepart)) || ' ') ||
  IifS(SalIsNull(dfRoom),    '', SalStrTrimX(cmbRoom || ' ' || SalStrTrimX(dfRoom))))
.head 5 +  If Len(sAdress) > 70
.head 6 -  Set sAdress = SalStrTrimX(
  IifS(SalIsNull(dfObl),     '', SalStrTrimX(dfObl) || ' ') || 
  IifS(SalIsNull(dfCity),    '', SalStrTrimX(cmbCity || ' ' || SalStrTrimX(dfCity)) || ' ') || 
  IifS(SalIsNull(dfStreet),  '', SalStrTrimX(cmbStreet || ' ' || SalStrTrimX(dfStreet)) || ' ') ||
  IifS(SalIsNull(dfHome),    '', SalStrTrimX(cmbHome || ' ' || SalStrTrimX(dfHome)) || ' ') ||
  IifS(SalIsNull(dfHomepart),'', SalStrTrimX(cmbHomepart || ' ' || SalStrTrimX(dfHomepart)) || ' ') ||
  IifS(SalIsNull(dfRoom),    '', SalStrTrimX(cmbRoom || ' ' || SalStrTrimX(dfRoom))))
.head 6 +  If Len(sAdress) > 70
.head 7 -  Set sAdress = Subs(SalStrTrimX(
  IifS(SalIsNull(dfCity),    '', SalStrTrimX(cmbCity || ' ' || SalStrTrimX(dfCity)) || ' ') || 
  IifS(SalIsNull(dfStreet),  '', SalStrTrimX(cmbStreet || ' ' || SalStrTrimX(dfStreet)) || ' ') ||
  IifS(SalIsNull(dfHome),    '', SalStrTrimX(cmbHome || ' ' || SalStrTrimX(dfHome)) || ' ') ||
  IifS(SalIsNull(dfHomepart),'', SalStrTrimX(cmbHomepart || ' ' || SalStrTrimX(dfHomepart)) || ' ') ||
  IifS(SalIsNull(dfRoom),    '', SalStrTrimX(cmbRoom || ' ' || SalStrTrimX(dfRoom)))), 1, 70)
.head 5 -  Set dfAdr = sAdress
.head 2 +  Window Parameters
.head 3 -  Boolean: bEdit
.head 3 -  String: sTitle
.head 3 -  : cAdr
.head 4 -  Class: cCustAddress
.head 3 -  : cAdr1
.head 4 -  Class: cCustAddress
.head 3 -  Receive String: sAdr
.head 2 +  Window Variables
.head 3 -  String: sTmpAdr
.head 3 -  String: sPK
.head 3 -  String: sSem
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, sTitle)
.head 4 -  Call SalDisableWindow(pbOk)
.head 4 -  Set dfAdr = sAdr
.head 4 +  If cAdr.nTypeId = 1
.head 5 -  Call SalDisableWindow(cmbCountry)
.head 5 -  Call SalHideWindow(pbDubl)
.head 4 -  Set dfTerritoryId = cAdr.nTerritoryId
.head 4 -  Set dfIndex = cAdr.sZip
.head 4 -  Set dfObl = cAdr.sDomain
.head 4 -  Set dfReg = cAdr.sRegion
.head 4 -  Set dfCity = cAdr.sLocality
.head 4 -  Set dfStreet = cAdr.sStreet
.head 4 -  Set dfHome = cAdr.sHome
.head 4 -  Set dfHomepart = cAdr.sHomepart
.head 4 -  Set dfRoom = cAdr.sRoom
.head 4 -  Set mlComm = cAdr.sComm
.head 4 -  Call SalSetFocus(dfIndex)
.head 4 +  If not bEdit
.head 5 -  Call SalDisableWindow(cmbCountry)
.head 5 -  Call SalDisableWindow(dfIndex)
.head 5 -  Call SalDisableWindow(dfObl)
.head 5 -  Call SalDisableWindow(dfReg)
.head 5 -  Call SalDisableWindow(cmbCity)
.head 5 -  Call SalDisableWindow(dfCity)
.head 5 -  Call SalDisableWindow(cmbStreet)
.head 5 -  Call SalDisableWindow(dfStreet)
.head 5 -  Call SalDisableWindow(cmbHome)
.head 5 -  Call SalDisableWindow(dfHome)
.head 5 -  Call SalDisableWindow(cmbHomepart)
.head 5 -  Call SalDisableWindow(dfHomepart)
.head 5 -  Call SalDisableWindow(cmbRoom)
.head 5 -  Call SalDisableWindow(dfRoom)
.head 5 -  Call SalDisableWindow(mlComm)
.head 5 -  Call SalDisableWindow(dfTerritoryId)
.head 5 -  Call SalDisableWindow(pbTerritoryId)
.head 5 -  Call SalDisableWindow(pbDubl)
.head 5 -  Call SalDisableWindow(pbOk)
.head 1 +  Dialog Box: Dlg_CustCriteria
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.467"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.798"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblCriteria
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.08"
.head 6 -  Top:    0.1"
.head 6 -  Width:  10.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.643"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
риска
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название
риска
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 1000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Class Default
.head 6 -  Width:  7.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Popup Edit
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colName
.head 7 +  On SAM_AnyEdit
.head 8 -  Set colName = sTmp
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Установить
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call setEdited()
.head 8 -  Return VALIDATE_Ok
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nRowErr
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  String: sTmp
.head 5 -  ! String: sTmp1
.head 5 -  ! String: sTmp2
.head 5 -  ! Number: nCount
.head 5 -  !
.head 5 -  ! Boolean: bTmp
.head 5 -  ! Long String: lsTmp
.head 5 -  !
.head 5 -  ! cParHist: cPar
.winattr class :
.head 6 -  Class: cParHist
.end
.head 5 -  ! String: sVal
.head 5 -  !
.head 5 -  String: strSqlPopulate
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Присваиваем значения многоязыковым объектам
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 +  If sCriteriaCode = Criteria_CustRisk
.head 7 -  Set strSqlPopulate = 
"select id, name into :colId, :colName
   from fm_risk_criteria
  where inuse = 1
  order by id"
.head 6 +  Else If sCriteriaCode = Criteria_CustRept
.head 7 -  Set strSqlPopulate = 
"select id, name into :colId, :colName
   from fm_rept_criteria
  where inuse = 1
  order by id"
.head 6 +  Else If sCriteriaCode = Criteria_CustCtg
.head 7 -  Set strSqlPopulate = 
"select id, name into :colId, :colName
   from fm_category
  where inuse = 1
    and nvl(rezid,:nRezid) = :nRezid
  order by id"
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), strSqlPopulate, TBL_FillAll)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If sCriteriaCode = Criteria_CustRisk
.head 7 -  Set colValue = hWndC.AbstractCustomer..getRiskValue(colId)
.head 7 +  If hWndC.AbstractCustomer..getRiskEditFlag(colId)
.head 8 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 6 +  Else If sCriteriaCode = Criteria_CustRept
.head 7 -  Set colValue = hWndC.AbstractCustomer..getReptValue(colId)
.head 7 +  If hWndC.AbstractCustomer..getReptEditFlag(colId)
.head 8 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 6 +  Else If sCriteriaCode = Criteria_CustCtg
.head 7 -  Set colValue = hWndC.AbstractCustomer..getCategoryValue(colId)
.head 7 +  If hWndC.AbstractCustomer..getCategoryEditFlag(colId)
.head 8 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = NOT nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On UM_BeforeClose
.head 6 -  ! Проверка на обязательное заполнение
.head 6 +  If sCriteriaCode = Criteria_CustRisk and PAR_CUSTRISK = 2
.head 7 -  Set nRowErr = 0
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Set nRowErr = nRow
.head 8 +  If colValue
.head 9 -  Set nRowErr = 0
.head 9 -  Break
.head 7 +  If nRowErr
.head 8 -  ! Необходимо указать критерии риска клиента!
.head 8 -  Call SalMessageBox('Необходимо указать критерии риска клиента!',
     CurrentLangTable.GetAtomTitle('cTErrRekv'), MB_Ok)
.head 8 -  Set nRowErr = 0
.head 8 -  Return 2
.head 6 -  Return 1
.head 5 +  On UM_Clear
.head 6 -  Call SalSetFocus(hWndForm)
.head 6 -  Call SalTblSetFocusRow(hWndForm, nRowErr)
.head 6 -  Call SalTblSetFocusCell(hWndForm, nRowErr, colValue, 0, 0)
.head 5 +  On UM_Update
.head 6 +  If sCriteriaCode = Criteria_CustRisk
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call hWndC.AbstractCustomer..setRiskValue(colId, colValue)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 6 +  Else If sCriteriaCode = Criteria_CustRept
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call hWndC.AbstractCustomer..setReptValue(colId, colValue)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 6 +  Else If sCriteriaCode = Criteria_CustCtg
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call hWndC.AbstractCustomer..setCategoryValue(colId, colValue)
.head 8 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 5 +  On SAM_DoInit
.head 6 -  Set hColumn = SalGetFirstChild(hWndForm, TYPE_TableColumn)
.head 6 +  While hColumn != hWndNULL
.head 7 -  Call SalDisableWindow(hColumn)
.head 7 -  Set hColumn = SalGetNextChild(hColumn, TYPE_TableColumn)
.head 2 +  Functions
.head 3 +  Function: setEdited
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sCriteriaCode = Criteria_CustRisk
.head 6 -  Set hWndParent.Frm_Customer.cTabCustRisk.isEdited = TRUE
.head 5 +  Else If sCriteriaCode = Criteria_CustRept
.head 6 -  Set hWndParent.Frm_Customer.cTabCustRept.isEdited = TRUE
.head 5 +  Else If sCriteriaCode = Criteria_CustCtg
.head 6 -  Set hWndParent.Frm_Customer.cTabCustCtg.isEdited = TRUE
.head 5 -  Call hWndParent.Frm_Customer.setEdited()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nCType
.head 3 -  Window Handle: hWndParent
.head 3 -  Window Handle: hWndC
.head 3 -  String: strPassPar
.head 3 -  String: InParam[4]
.head 3 -  Number: nFlagEdit
.head 3 -  Boolean: bPossibleToEdit
.head 3 -  Number: nRezid
.head 3 -  !
.head 3 -  String: sCriteriaCode
.head 3 -  !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeight
.head 3 -  Number: nTblX0
.head 3 -  Number: nTblY0
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeight
.head 3 -  Number: nColWidth
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Call Debug('CustRisk')
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString(lParam)
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 4
.head 5 -  Return FALSE
.head 4 -  Set nRNK       = SalStrToNumber(InParam[0])
.head 4 -  Set nCType     = SalStrToNumber(InParam[1])
.head 4 -  Set hWndParent = SalNumberToWindowHandle(SalStrToNumber(InParam[2]))
.head 4 -  Set hWndC      = SalNumberToWindowHandle(SalStrToNumber(InParam[3]))
.head 4 -  !
.head 4 -  Set nRezid     = hWndParent.Frm_Customer.nCRezid
.head 4 -  !
.head 4 -  Set hWndObject = SalGetFirstChild(hWndForm, TYPE_Any)
.head 4 +  While hWndObject != hWndNULL
.head 5 -  Call SalSendMsg(hWndObject, UM_ObjActivate, 0, 0)
.head 5 -  Set hWndObject = SalGetNextChild(hWndObject, TYPE_Any)
.head 4 -  !
.head 4 -  Call SalSendMsg(hWndForm, WM_Size, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Set sCriteriaCode = hWndParent.Frm_Customer.sCriteriaCode
.head 4 +  If sCriteriaCode = Criteria_CustRisk
.head 5 -  Set nFlagEdit = hWndParent.Frm_Customer.cTabCustRisk.EditMode
.head 5 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 5 +  If not bPossibleToEdit
.head 6 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 5 -  !
.head 5 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustCriteria.tblCriteria.colId, CurrentLangTable.GetAtomTitle('Dlg_CustCriteria.tblCriteria.colRiskId'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustCriteria.tblCriteria.colName, CurrentLangTable.GetAtomTitle('Dlg_CustCriteria.tblCriteria.colRiskName'))
.head 4 +  Else If sCriteriaCode = Criteria_CustRept
.head 5 -  Set nFlagEdit = hWndParent.Frm_Customer.cTabCustRept.EditMode
.head 5 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 5 +  If not bPossibleToEdit
.head 6 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 5 -  !
.head 5 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustCriteria.tblCriteria.colId, CurrentLangTable.GetAtomTitle('Dlg_CustCriteria.tblCriteria.colReptId'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustCriteria.tblCriteria.colName, CurrentLangTable.GetAtomTitle('Dlg_CustCriteria.tblCriteria.colReptName'))
.head 4 +  Else If sCriteriaCode = Criteria_CustCtg
.head 5 -  Set nFlagEdit = hWndParent.Frm_Customer.cTabCustCtg.EditMode
.head 5 -  Set bPossibleToEdit = nFlagEdit=TAB_Edit
.head 5 +  If not bPossibleToEdit
.head 6 -  Call SalSendMsg(hWndForm, SAM_DoInit, 0, 0)
.head 5 -  !
.head 5 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustCriteria.tblCriteria.colId, CurrentLangTable.GetAtomTitle('Dlg_CustCriteria.tblCriteria.colCategoryId'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.Dlg_CustCriteria.tblCriteria.colName, CurrentLangTable.GetAtomTitle('Dlg_CustCriteria.tblCriteria.colCategoryName'))
.head 4 -  Call SalSendMsg(hWndForm.Dlg_CustCriteria.tblCriteria, UM_Populate, 0, 0)
.head 3 +  On SAM_DoInit
.head 4 -  Call SalSendMsg(tblCriteria, SAM_DoInit, 0, 0)
.head 3 +  On UM_Update
.head 4 -  Set sCriteriaCode = hWndParent.Frm_Customer.sCriteriaCode
.head 4 -  Call SalSendMsg(tblCriteria, UM_Update, 0, 0)
.head 3 +  On UM_BeforeClose
.head 4 -  ! Проверка на обязательное заполнение
.head 4 -  Return SalSendMsg(tblCriteria, UM_BeforeClose, 0, 0)
.head 3 +  On UM_Clear
.head 4 -  Call SalSendMsg(tblCriteria, UM_Clear, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_CustCriteria.tblCriteria,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCriteria.tblCriteria, nWinWidth, FALSE)-0.2,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCriteria.tblCriteria, nWinHeight, TRUE)-0.2)
.head 4 -  Call GetClientRect(hWndForm.Dlg_CustCriteria.tblCriteria, nTblX0, nTblY0, nTblWidth, nTblHeight)
.head 4 -  Call SalTblSetColumnWidth(hWndForm.Dlg_CustCriteria.tblCriteria.colName,
     SalPixelsToFormUnits(hWndForm.Dlg_CustCriteria.tblCriteria, nTblWidth, FALSE)-3)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_PhonePIN
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Відправка/ввод кода підтвердження за SMS
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: System Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.617"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.952"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ввести код підтвердження з SMS
.head 4 -  Window Location and Size
.head 5 -  Left:   1.883"
.head 5 -  Top:    2.071"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\ARR2TOD.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not SqlPLSQLCommand(hSql(), "KL_SMSCODE(pRNK, pCellNumber, PIN, pres, pmsg)")
.head 7 -  Call SqlRollbackEx(hSql(), "РНК " || Str(pRNK) || ": ошибка выполнения отправки SMS на номер клиента")
.head 7 -  Set pres = 1
.head 6 +  Else
.head 7 -  Call SqlCommit(hSql())
.head 6 +  If pres = 0
.head 7 -  Call SalEndDialog(hWndForm, 1)
.head 6 +  Else
.head 7 -  Call MessageInfo('Введений код не співпадає з відправленим на номер.')
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмінити
.head 4 -  Window Location and Size
.head 5 -  Left:   6.2"
.head 5 -  Top:    2.083"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Data Field: PIN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    1.655"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 999999
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbSendSMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOkLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відправити SMS повідомлення
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.774"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.464"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not SqlPLSQLCommand(hSql(), "KL_SMSCODE(pRNK, pCellNumber, NUMBER_Null, pres, pmsg)")
.head 7 -  Call SqlRollbackEx(hSql(), "РНК " || Str(pRNK) || ": ошибка выполнения отправки SMS на номер клиента "|| pCellNumber)
.head 6 +  Else
.head 7 -  Call SqlCommit(hSql())
.head 6 -  Call SalTimerSet(hWndForm, 1, 1000)
.head 3 -  Background Text: Введіть код, отриманий клієнтом на мобільний телефон:
.head 4 -  Resource Id: 37924
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    1.345"
.head 5 -  Width:  6.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Моб. телефон:
.head 4 -  Resource Id: 37925
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTelm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Відправити SMS повідомлення на мобільний номер клієнта
.head 4 -  Resource Id: 37927
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  8.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCellN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.429"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.19"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    0.738"
.head 6 -  Width:  3.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTimeLeft
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.483"
.head 6 -  Top:    0.429"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Минуло часу (сек.):
.head 4 -  Resource Id: 14199
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.683"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: RefreshSMSStatus
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: pCellNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStatus
.head 5 -  String: sSql
.head 4 +  Actions
.head 5 -  ! Set sSql = "SELECT 'Ідентифікатор SMS:' || to_char(MSG_ID) || '  Статус:' ||to_char(status) || last_error
     INTO :sStatus
     FROM msg_submit_data
     WHERE PHONE = :pCellNum"
.head 5 -  Call SqlPrepareAndExecute(hSql(), "SELECT 'Ідент.SMS ' || to_char(MSG_ID)|| ' Статус:' || status || '//'||substr(last_error,1,50)
     INTO :sStatus
     FROM msg_submit_data
     WHERE PHONE = :pCellNum")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! Call Debug(sStatus)
.head 5 -  Return sStatus
.head 2 +  Window Parameters
.head 3 -  Number: pRNK
.head 3 -  String: pCellNumber
.head 3 -  Number: pPIN
.head 3 -  Number: pres
.head 3 -  String: pmsg
.head 2 +  Window Variables
.head 3 -  Number: nTimer
.head 3 -  Number: nContinueTime
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set dfCellN =  pCellNumber
.head 4 -  Set nTimer = 1000
.head 4 -  Set nContinueTime = 300000
.head 4 -  Set dfTimeLeft = Str(0)
.head 3 +  On SAM_Timer
.head 4 +  If nContinueTime > 0
.head 5 -  Set nContinueTime = nContinueTime - nTimer
.head 5 -  Set dfStatus = RefreshSMSStatus(pCellNumber)
.head 5 -  Set nTimer = nTimer + 1000
.head 5 -  Set dfTimeLeft = Str(nTimer/1000)
